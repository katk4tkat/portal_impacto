function QP(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function mS(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var gS={exports:{}},I0={},vS={exports:{}},Ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sf=Symbol.for("react.element"),JP=Symbol.for("react.portal"),ZP=Symbol.for("react.fragment"),eN=Symbol.for("react.strict_mode"),tN=Symbol.for("react.profiler"),rN=Symbol.for("react.provider"),nN=Symbol.for("react.context"),iN=Symbol.for("react.forward_ref"),sN=Symbol.for("react.suspense"),aN=Symbol.for("react.memo"),oN=Symbol.for("react.lazy"),Uy=Symbol.iterator;function cN(e){return e===null||typeof e!="object"?null:(e=Uy&&e[Uy]||e["@@iterator"],typeof e=="function"?e:null)}var xS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_S=Object.assign,yS={};function Mc(e,t,r){this.props=e,this.context=t,this.refs=yS,this.updater=r||xS}Mc.prototype.isReactComponent={};Mc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Mc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function ES(){}ES.prototype=Mc.prototype;function Sv(e,t,r){this.props=e,this.context=t,this.refs=yS,this.updater=r||xS}var Av=Sv.prototype=new ES;Av.constructor=Sv;_S(Av,Mc.prototype);Av.isPureReactComponent=!0;var $y=Array.isArray,wS=Object.prototype.hasOwnProperty,kv={current:null},TS={key:!0,ref:!0,__self:!0,__source:!0};function SS(e,t,r){var n,i={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)wS.call(t,n)&&!TS.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var c=Array(o),l=0;l<o;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:sf,type:e,key:s,ref:a,props:i,_owner:kv.current}}function lN(e,t){return{$$typeof:sf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Cv(e){return typeof e=="object"&&e!==null&&e.$$typeof===sf}function uN(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Hy=/\/+/g;function Jp(e,t){return typeof e=="object"&&e!==null&&e.key!=null?uN(""+e.key):t.toString(36)}function Nh(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case sf:case JP:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+Jp(a,0):n,$y(i)?(r="",e!=null&&(r=e.replace(Hy,"$&/")+"/"),Nh(i,t,r,"",function(l){return l})):i!=null&&(Cv(i)&&(i=lN(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Hy,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",$y(e))for(var o=0;o<e.length;o++){s=e[o];var c=n+Jp(s,o);a+=Nh(s,t,r,c,i)}else if(c=cN(e),typeof c=="function")for(e=c.call(e),o=0;!(s=e.next()).done;)s=s.value,c=n+Jp(s,o++),a+=Nh(s,t,r,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function zf(e,t,r){if(e==null)return e;var n=[],i=0;return Nh(e,n,"","",function(s){return t.call(r,s,i++)}),n}function fN(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ln={current:null},Dh={transition:null},hN={ReactCurrentDispatcher:ln,ReactCurrentBatchConfig:Dh,ReactCurrentOwner:kv};Ye.Children={map:zf,forEach:function(e,t,r){zf(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return zf(e,function(){t++}),t},toArray:function(e){return zf(e,function(t){return t})||[]},only:function(e){if(!Cv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ye.Component=Mc;Ye.Fragment=ZP;Ye.Profiler=tN;Ye.PureComponent=Sv;Ye.StrictMode=eN;Ye.Suspense=sN;Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hN;Ye.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=_S({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=kv.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)wS.call(t,c)&&!TS.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var l=0;l<c;l++)o[l]=arguments[l+2];n.children=o}return{$$typeof:sf,type:e.type,key:i,ref:s,props:n,_owner:a}};Ye.createContext=function(e){return e={$$typeof:nN,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:rN,_context:e},e.Consumer=e};Ye.createElement=SS;Ye.createFactory=function(e){var t=SS.bind(null,e);return t.type=e,t};Ye.createRef=function(){return{current:null}};Ye.forwardRef=function(e){return{$$typeof:iN,render:e}};Ye.isValidElement=Cv;Ye.lazy=function(e){return{$$typeof:oN,_payload:{_status:-1,_result:e},_init:fN}};Ye.memo=function(e,t){return{$$typeof:aN,type:e,compare:t===void 0?null:t}};Ye.startTransition=function(e){var t=Dh.transition;Dh.transition={};try{e()}finally{Dh.transition=t}};Ye.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ye.useCallback=function(e,t){return ln.current.useCallback(e,t)};Ye.useContext=function(e){return ln.current.useContext(e)};Ye.useDebugValue=function(){};Ye.useDeferredValue=function(e){return ln.current.useDeferredValue(e)};Ye.useEffect=function(e,t){return ln.current.useEffect(e,t)};Ye.useId=function(){return ln.current.useId()};Ye.useImperativeHandle=function(e,t,r){return ln.current.useImperativeHandle(e,t,r)};Ye.useInsertionEffect=function(e,t){return ln.current.useInsertionEffect(e,t)};Ye.useLayoutEffect=function(e,t){return ln.current.useLayoutEffect(e,t)};Ye.useMemo=function(e,t){return ln.current.useMemo(e,t)};Ye.useReducer=function(e,t,r){return ln.current.useReducer(e,t,r)};Ye.useRef=function(e){return ln.current.useRef(e)};Ye.useState=function(e){return ln.current.useState(e)};Ye.useSyncExternalStore=function(e,t,r){return ln.current.useSyncExternalStore(e,t,r)};Ye.useTransition=function(){return ln.current.useTransition()};Ye.version="18.2.0";vS.exports=Ye;var F=vS.exports;const ke=mS(F),Cg=QP({__proto__:null,default:ke},[F]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dN=F,pN=Symbol.for("react.element"),mN=Symbol.for("react.fragment"),gN=Object.prototype.hasOwnProperty,vN=dN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xN={key:!0,ref:!0,__self:!0,__source:!0};function AS(e,t,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)gN.call(t,n)&&!xN.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:pN,type:e,key:s,ref:a,props:i,_owner:vN.current}}I0.Fragment=mN;I0.jsx=AS;I0.jsxs=AS;gS.exports=I0;var h=gS.exports,kS={exports:{}},jn={},CS={exports:{}},IS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(re,B){var ae=re.length;re.push(B);e:for(;0<ae;){var xe=ae-1>>>1,I=re[xe];if(0<i(I,B))re[xe]=B,re[ae]=I,ae=xe;else break e}}function r(re){return re.length===0?null:re[0]}function n(re){if(re.length===0)return null;var B=re[0],ae=re.pop();if(ae!==B){re[0]=ae;e:for(var xe=0,I=re.length,W=I>>>1;xe<W;){var z=2*(xe+1)-1,U=re[z],ee=z+1,oe=re[ee];if(0>i(U,ae))ee<I&&0>i(oe,U)?(re[xe]=oe,re[ee]=ae,xe=ee):(re[xe]=U,re[z]=ae,xe=z);else if(ee<I&&0>i(oe,ae))re[xe]=oe,re[ee]=ae,xe=ee;else break e}}return B}function i(re,B){var ae=re.sortIndex-B.sortIndex;return ae!==0?ae:re.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var c=[],l=[],u=1,f=null,d=3,p=!1,g=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(re){for(var B=r(l);B!==null;){if(B.callback===null)n(l);else if(B.startTime<=re)n(l),B.sortIndex=B.expirationTime,t(c,B);else break;B=r(l)}}function w(re){if(m=!1,y(re),!g)if(r(c)!==null)g=!0,Z(T);else{var B=r(l);B!==null&&ie(w,B.startTime-re)}}function T(re,B){g=!1,m&&(m=!1,_(k),k=-1),p=!0;var ae=d;try{for(y(B),f=r(c);f!==null&&(!(f.expirationTime>B)||re&&!H());){var xe=f.callback;if(typeof xe=="function"){f.callback=null,d=f.priorityLevel;var I=xe(f.expirationTime<=B);B=e.unstable_now(),typeof I=="function"?f.callback=I:f===r(c)&&n(c),y(B)}else n(c);f=r(c)}if(f!==null)var W=!0;else{var z=r(l);z!==null&&ie(w,z.startTime-B),W=!1}return W}finally{f=null,d=ae,p=!1}}var S=!1,E=null,k=-1,b=5,j=-1;function H(){return!(e.unstable_now()-j<b)}function O(){if(E!==null){var re=e.unstable_now();j=re;var B=!0;try{B=E(!0,re)}finally{B?V():(S=!1,E=null)}}else S=!1}var V;if(typeof x=="function")V=function(){x(O)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,X=G.port2;G.port1.onmessage=O,V=function(){X.postMessage(null)}}else V=function(){v(O,0)};function Z(re){E=re,S||(S=!0,V())}function ie(re,B){k=v(function(){re(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(re){re.callback=null},e.unstable_continueExecution=function(){g||p||(g=!0,Z(T))},e.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<re?Math.floor(1e3/re):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(re){switch(d){case 1:case 2:case 3:var B=3;break;default:B=d}var ae=d;d=B;try{return re()}finally{d=ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(re,B){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var ae=d;d=re;try{return B()}finally{d=ae}},e.unstable_scheduleCallback=function(re,B,ae){var xe=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?xe+ae:xe):ae=xe,re){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=ae+I,re={id:u++,callback:B,priorityLevel:re,startTime:ae,expirationTime:I,sortIndex:-1},ae>xe?(re.sortIndex=ae,t(l,re),r(c)===null&&re===r(l)&&(m?(_(k),k=-1):m=!0,ie(w,ae-xe))):(re.sortIndex=I,t(c,re),g||p||(g=!0,Z(T))),re},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(re){var B=d;return function(){var ae=d;d=B;try{return re.apply(this,arguments)}finally{d=ae}}}})(IS);CS.exports=IS;var _N=CS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RS=F,On=_N;function he(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var bS=new Set,uu={};function po(e,t){_c(e,t),_c(e+"Capture",t)}function _c(e,t){for(uu[e]=t,e=0;e<t.length;e++)bS.add(t[e])}var us=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ig=Object.prototype.hasOwnProperty,yN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,zy={},Wy={};function EN(e){return Ig.call(Wy,e)?!0:Ig.call(zy,e)?!1:yN.test(e)?Wy[e]=!0:(zy[e]=!0,!1)}function wN(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function TN(e,t,r,n){if(t===null||typeof t>"u"||wN(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function un(e,t,r,n,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var Rr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Rr[e]=new un(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Rr[t]=new un(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Rr[e]=new un(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Rr[e]=new un(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Rr[e]=new un(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Rr[e]=new un(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Rr[e]=new un(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Rr[e]=new un(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Rr[e]=new un(e,5,!1,e.toLowerCase(),null,!1,!1)});var Iv=/[\-:]([a-z])/g;function Rv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Iv,Rv);Rr[t]=new un(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Iv,Rv);Rr[t]=new un(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Iv,Rv);Rr[t]=new un(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Rr[e]=new un(e,1,!1,e.toLowerCase(),null,!1,!1)});Rr.xlinkHref=new un("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Rr[e]=new un(e,1,!1,e.toLowerCase(),null,!0,!0)});function bv(e,t,r,n){var i=Rr.hasOwnProperty(t)?Rr[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(TN(t,r,i,n)&&(r=null),n||i===null?EN(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var _s=RS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wf=Symbol.for("react.element"),jo=Symbol.for("react.portal"),Bo=Symbol.for("react.fragment"),Fv=Symbol.for("react.strict_mode"),Rg=Symbol.for("react.profiler"),FS=Symbol.for("react.provider"),PS=Symbol.for("react.context"),Pv=Symbol.for("react.forward_ref"),bg=Symbol.for("react.suspense"),Fg=Symbol.for("react.suspense_list"),Nv=Symbol.for("react.memo"),ks=Symbol.for("react.lazy"),NS=Symbol.for("react.offscreen"),Gy=Symbol.iterator;function sl(e){return e===null||typeof e!="object"?null:(e=Gy&&e[Gy]||e["@@iterator"],typeof e=="function"?e:null)}var bt=Object.assign,Zp;function yl(e){if(Zp===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Zp=t&&t[1]||""}return`
`+Zp+e}var em=!1;function tm(e,t){if(!e||em)return"";em=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var n=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){n=l}e.call(t.prototype)}else{try{throw Error()}catch(l){n=l}e()}}catch(l){if(l&&n&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var c=`
`+i[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=o);break}}}finally{em=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?yl(e):""}function SN(e){switch(e.tag){case 5:return yl(e.type);case 16:return yl("Lazy");case 13:return yl("Suspense");case 19:return yl("SuspenseList");case 0:case 2:case 15:return e=tm(e.type,!1),e;case 11:return e=tm(e.type.render,!1),e;case 1:return e=tm(e.type,!0),e;default:return""}}function Pg(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Bo:return"Fragment";case jo:return"Portal";case Rg:return"Profiler";case Fv:return"StrictMode";case bg:return"Suspense";case Fg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case PS:return(e.displayName||"Context")+".Consumer";case FS:return(e._context.displayName||"Context")+".Provider";case Pv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Nv:return t=e.displayName||null,t!==null?t:Pg(e.type)||"Memo";case ks:t=e._payload,e=e._init;try{return Pg(e(t))}catch{}}return null}function AN(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pg(t);case 8:return t===Fv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function sa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function DS(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function kN(e){var t=DS(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Gf(e){e._valueTracker||(e._valueTracker=kN(e))}function OS(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=DS(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function sd(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ng(e,t){var r=t.checked;return bt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function qy(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=sa(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function LS(e,t){t=t.checked,t!=null&&bv(e,"checked",t,!1)}function Dg(e,t){LS(e,t);var r=sa(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Og(e,t.type,r):t.hasOwnProperty("defaultValue")&&Og(e,t.type,sa(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ky(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Og(e,t,r){(t!=="number"||sd(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var El=Array.isArray;function nc(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+sa(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Lg(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(he(91));return bt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Xy(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(he(92));if(El(r)){if(1<r.length)throw Error(he(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:sa(r)}}function MS(e,t){var r=sa(t.value),n=sa(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Yy(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function VS(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Mg(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?VS(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var qf,jS=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(qf=qf||document.createElement("div"),qf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=qf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function fu(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Ml={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},CN=["Webkit","ms","Moz","O"];Object.keys(Ml).forEach(function(e){CN.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ml[t]=Ml[e]})});function BS(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Ml.hasOwnProperty(e)&&Ml[e]?(""+t).trim():t+"px"}function US(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=BS(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var IN=bt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vg(e,t){if(t){if(IN[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(he(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(he(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(he(61))}if(t.style!=null&&typeof t.style!="object")throw Error(he(62))}}function jg(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bg=null;function Dv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ug=null,ic=null,sc=null;function Qy(e){if(e=cf(e)){if(typeof Ug!="function")throw Error(he(280));var t=e.stateNode;t&&(t=N0(t),Ug(e.stateNode,e.type,t))}}function $S(e){ic?sc?sc.push(e):sc=[e]:ic=e}function HS(){if(ic){var e=ic,t=sc;if(sc=ic=null,Qy(e),t)for(e=0;e<t.length;e++)Qy(t[e])}}function zS(e,t){return e(t)}function WS(){}var rm=!1;function GS(e,t,r){if(rm)return e(t,r);rm=!0;try{return zS(e,t,r)}finally{rm=!1,(ic!==null||sc!==null)&&(WS(),HS())}}function hu(e,t){var r=e.stateNode;if(r===null)return null;var n=N0(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(he(231,t,typeof r));return r}var $g=!1;if(us)try{var al={};Object.defineProperty(al,"passive",{get:function(){$g=!0}}),window.addEventListener("test",al,al),window.removeEventListener("test",al,al)}catch{$g=!1}function RN(e,t,r,n,i,s,a,o,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(r,l)}catch(u){this.onError(u)}}var Vl=!1,ad=null,od=!1,Hg=null,bN={onError:function(e){Vl=!0,ad=e}};function FN(e,t,r,n,i,s,a,o,c){Vl=!1,ad=null,RN.apply(bN,arguments)}function PN(e,t,r,n,i,s,a,o,c){if(FN.apply(this,arguments),Vl){if(Vl){var l=ad;Vl=!1,ad=null}else throw Error(he(198));od||(od=!0,Hg=l)}}function mo(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function qS(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Jy(e){if(mo(e)!==e)throw Error(he(188))}function NN(e){var t=e.alternate;if(!t){if(t=mo(e),t===null)throw Error(he(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Jy(i),e;if(s===n)return Jy(i),t;s=s.sibling}throw Error(he(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(he(189))}}if(r.alternate!==n)throw Error(he(190))}if(r.tag!==3)throw Error(he(188));return r.stateNode.current===r?e:t}function KS(e){return e=NN(e),e!==null?XS(e):null}function XS(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=XS(e);if(t!==null)return t;e=e.sibling}return null}var YS=On.unstable_scheduleCallback,Zy=On.unstable_cancelCallback,DN=On.unstable_shouldYield,ON=On.unstable_requestPaint,Ut=On.unstable_now,LN=On.unstable_getCurrentPriorityLevel,Ov=On.unstable_ImmediatePriority,QS=On.unstable_UserBlockingPriority,cd=On.unstable_NormalPriority,MN=On.unstable_LowPriority,JS=On.unstable_IdlePriority,R0=null,Di=null;function VN(e){if(Di&&typeof Di.onCommitFiberRoot=="function")try{Di.onCommitFiberRoot(R0,e,void 0,(e.current.flags&128)===128)}catch{}}var hi=Math.clz32?Math.clz32:UN,jN=Math.log,BN=Math.LN2;function UN(e){return e>>>=0,e===0?32:31-(jN(e)/BN|0)|0}var Kf=64,Xf=4194304;function wl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ld(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=wl(o):(s&=a,s!==0&&(n=wl(s)))}else a=r&~i,a!==0?n=wl(a):s!==0&&(n=wl(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-hi(t),i=1<<r,n|=e[r],t&=~i;return n}function $N(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function HN(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-hi(s),o=1<<a,c=i[a];c===-1?(!(o&r)||o&n)&&(i[a]=$N(o,t)):c<=t&&(e.expiredLanes|=o),s&=~o}}function zg(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ZS(){var e=Kf;return Kf<<=1,!(Kf&4194240)&&(Kf=64),e}function nm(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function af(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-hi(t),e[t]=r}function zN(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-hi(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function Lv(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-hi(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var ut=0;function eA(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var tA,Mv,rA,nA,iA,Wg=!1,Yf=[],Gs=null,qs=null,Ks=null,du=new Map,pu=new Map,Is=[],WN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function eE(e,t){switch(e){case"focusin":case"focusout":Gs=null;break;case"dragenter":case"dragleave":qs=null;break;case"mouseover":case"mouseout":Ks=null;break;case"pointerover":case"pointerout":du.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":pu.delete(t.pointerId)}}function ol(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=cf(t),t!==null&&Mv(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function GN(e,t,r,n,i){switch(t){case"focusin":return Gs=ol(Gs,e,t,r,n,i),!0;case"dragenter":return qs=ol(qs,e,t,r,n,i),!0;case"mouseover":return Ks=ol(Ks,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return du.set(s,ol(du.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,pu.set(s,ol(pu.get(s)||null,e,t,r,n,i)),!0}return!1}function sA(e){var t=Da(e.target);if(t!==null){var r=mo(t);if(r!==null){if(t=r.tag,t===13){if(t=qS(r),t!==null){e.blockedOn=t,iA(e.priority,function(){rA(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Oh(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Gg(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Bg=n,r.target.dispatchEvent(n),Bg=null}else return t=cf(r),t!==null&&Mv(t),e.blockedOn=r,!1;t.shift()}return!0}function tE(e,t,r){Oh(e)&&r.delete(t)}function qN(){Wg=!1,Gs!==null&&Oh(Gs)&&(Gs=null),qs!==null&&Oh(qs)&&(qs=null),Ks!==null&&Oh(Ks)&&(Ks=null),du.forEach(tE),pu.forEach(tE)}function cl(e,t){e.blockedOn===t&&(e.blockedOn=null,Wg||(Wg=!0,On.unstable_scheduleCallback(On.unstable_NormalPriority,qN)))}function mu(e){function t(i){return cl(i,e)}if(0<Yf.length){cl(Yf[0],e);for(var r=1;r<Yf.length;r++){var n=Yf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Gs!==null&&cl(Gs,e),qs!==null&&cl(qs,e),Ks!==null&&cl(Ks,e),du.forEach(t),pu.forEach(t),r=0;r<Is.length;r++)n=Is[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Is.length&&(r=Is[0],r.blockedOn===null);)sA(r),r.blockedOn===null&&Is.shift()}var ac=_s.ReactCurrentBatchConfig,ud=!0;function KN(e,t,r,n){var i=ut,s=ac.transition;ac.transition=null;try{ut=1,Vv(e,t,r,n)}finally{ut=i,ac.transition=s}}function XN(e,t,r,n){var i=ut,s=ac.transition;ac.transition=null;try{ut=4,Vv(e,t,r,n)}finally{ut=i,ac.transition=s}}function Vv(e,t,r,n){if(ud){var i=Gg(e,t,r,n);if(i===null)dm(e,t,n,fd,r),eE(e,n);else if(GN(i,e,t,r,n))n.stopPropagation();else if(eE(e,n),t&4&&-1<WN.indexOf(e)){for(;i!==null;){var s=cf(i);if(s!==null&&tA(s),s=Gg(e,t,r,n),s===null&&dm(e,t,n,fd,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else dm(e,t,n,null,r)}}var fd=null;function Gg(e,t,r,n){if(fd=null,e=Dv(n),e=Da(e),e!==null)if(t=mo(e),t===null)e=null;else if(r=t.tag,r===13){if(e=qS(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return fd=e,null}function aA(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(LN()){case Ov:return 1;case QS:return 4;case cd:case MN:return 16;case JS:return 536870912;default:return 16}default:return 16}}var Ms=null,jv=null,Lh=null;function oA(){if(Lh)return Lh;var e,t=jv,r=t.length,n,i="value"in Ms?Ms.value:Ms.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[s-n];n++);return Lh=i.slice(e,1<n?1-n:void 0)}function Mh(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Qf(){return!0}function rE(){return!1}function Bn(e){function t(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Qf:rE,this.isPropagationStopped=rE,this}return bt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Qf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Qf)},persist:function(){},isPersistent:Qf}),t}var Vc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bv=Bn(Vc),of=bt({},Vc,{view:0,detail:0}),YN=Bn(of),im,sm,ll,b0=bt({},of,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uv,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ll&&(ll&&e.type==="mousemove"?(im=e.screenX-ll.screenX,sm=e.screenY-ll.screenY):sm=im=0,ll=e),im)},movementY:function(e){return"movementY"in e?e.movementY:sm}}),nE=Bn(b0),QN=bt({},b0,{dataTransfer:0}),JN=Bn(QN),ZN=bt({},of,{relatedTarget:0}),am=Bn(ZN),eD=bt({},Vc,{animationName:0,elapsedTime:0,pseudoElement:0}),tD=Bn(eD),rD=bt({},Vc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),nD=Bn(rD),iD=bt({},Vc,{data:0}),iE=Bn(iD),sD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cD(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=oD[e])?!!t[e]:!1}function Uv(){return cD}var lD=bt({},of,{key:function(e){if(e.key){var t=sD[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Mh(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?aD[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uv,charCode:function(e){return e.type==="keypress"?Mh(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Mh(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),uD=Bn(lD),fD=bt({},b0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sE=Bn(fD),hD=bt({},of,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uv}),dD=Bn(hD),pD=bt({},Vc,{propertyName:0,elapsedTime:0,pseudoElement:0}),mD=Bn(pD),gD=bt({},b0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),vD=Bn(gD),xD=[9,13,27,32],$v=us&&"CompositionEvent"in window,jl=null;us&&"documentMode"in document&&(jl=document.documentMode);var _D=us&&"TextEvent"in window&&!jl,cA=us&&(!$v||jl&&8<jl&&11>=jl),aE=String.fromCharCode(32),oE=!1;function lA(e,t){switch(e){case"keyup":return xD.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uA(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Uo=!1;function yD(e,t){switch(e){case"compositionend":return uA(t);case"keypress":return t.which!==32?null:(oE=!0,aE);case"textInput":return e=t.data,e===aE&&oE?null:e;default:return null}}function ED(e,t){if(Uo)return e==="compositionend"||!$v&&lA(e,t)?(e=oA(),Lh=jv=Ms=null,Uo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return cA&&t.locale!=="ko"?null:t.data;default:return null}}var wD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cE(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!wD[e.type]:t==="textarea"}function fA(e,t,r,n){$S(n),t=hd(t,"onChange"),0<t.length&&(r=new Bv("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Bl=null,gu=null;function TD(e){wA(e,0)}function F0(e){var t=zo(e);if(OS(t))return e}function SD(e,t){if(e==="change")return t}var hA=!1;if(us){var om;if(us){var cm="oninput"in document;if(!cm){var lE=document.createElement("div");lE.setAttribute("oninput","return;"),cm=typeof lE.oninput=="function"}om=cm}else om=!1;hA=om&&(!document.documentMode||9<document.documentMode)}function uE(){Bl&&(Bl.detachEvent("onpropertychange",dA),gu=Bl=null)}function dA(e){if(e.propertyName==="value"&&F0(gu)){var t=[];fA(t,gu,e,Dv(e)),GS(TD,t)}}function AD(e,t,r){e==="focusin"?(uE(),Bl=t,gu=r,Bl.attachEvent("onpropertychange",dA)):e==="focusout"&&uE()}function kD(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return F0(gu)}function CD(e,t){if(e==="click")return F0(t)}function ID(e,t){if(e==="input"||e==="change")return F0(t)}function RD(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var gi=typeof Object.is=="function"?Object.is:RD;function vu(e,t){if(gi(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Ig.call(t,i)||!gi(e[i],t[i]))return!1}return!0}function fE(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hE(e,t){var r=fE(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=fE(r)}}function pA(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?pA(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function mA(){for(var e=window,t=sd();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=sd(e.document)}return t}function Hv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function bD(e){var t=mA(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&pA(r.ownerDocument.documentElement,r)){if(n!==null&&Hv(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=hE(r,s);var a=hE(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var FD=us&&"documentMode"in document&&11>=document.documentMode,$o=null,qg=null,Ul=null,Kg=!1;function dE(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Kg||$o==null||$o!==sd(n)||(n=$o,"selectionStart"in n&&Hv(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ul&&vu(Ul,n)||(Ul=n,n=hd(qg,"onSelect"),0<n.length&&(t=new Bv("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=$o)))}function Jf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ho={animationend:Jf("Animation","AnimationEnd"),animationiteration:Jf("Animation","AnimationIteration"),animationstart:Jf("Animation","AnimationStart"),transitionend:Jf("Transition","TransitionEnd")},lm={},gA={};us&&(gA=document.createElement("div").style,"AnimationEvent"in window||(delete Ho.animationend.animation,delete Ho.animationiteration.animation,delete Ho.animationstart.animation),"TransitionEvent"in window||delete Ho.transitionend.transition);function P0(e){if(lm[e])return lm[e];if(!Ho[e])return e;var t=Ho[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in gA)return lm[e]=t[r];return e}var vA=P0("animationend"),xA=P0("animationiteration"),_A=P0("animationstart"),yA=P0("transitionend"),EA=new Map,pE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ma(e,t){EA.set(e,t),po(t,[e])}for(var um=0;um<pE.length;um++){var fm=pE[um],PD=fm.toLowerCase(),ND=fm[0].toUpperCase()+fm.slice(1);ma(PD,"on"+ND)}ma(vA,"onAnimationEnd");ma(xA,"onAnimationIteration");ma(_A,"onAnimationStart");ma("dblclick","onDoubleClick");ma("focusin","onFocus");ma("focusout","onBlur");ma(yA,"onTransitionEnd");_c("onMouseEnter",["mouseout","mouseover"]);_c("onMouseLeave",["mouseout","mouseover"]);_c("onPointerEnter",["pointerout","pointerover"]);_c("onPointerLeave",["pointerout","pointerover"]);po("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));po("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));po("onBeforeInput",["compositionend","keypress","textInput","paste"]);po("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));po("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));po("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),DD=new Set("cancel close invalid load scroll toggle".split(" ").concat(Tl));function mE(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,PN(n,t,void 0,e),e.currentTarget=null}function wA(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],c=o.instance,l=o.currentTarget;if(o=o.listener,c!==s&&i.isPropagationStopped())break e;mE(i,o,l),s=c}else for(a=0;a<n.length;a++){if(o=n[a],c=o.instance,l=o.currentTarget,o=o.listener,c!==s&&i.isPropagationStopped())break e;mE(i,o,l),s=c}}}if(od)throw e=Hg,od=!1,Hg=null,e}function vt(e,t){var r=t[Zg];r===void 0&&(r=t[Zg]=new Set);var n=e+"__bubble";r.has(n)||(TA(t,e,2,!1),r.add(n))}function hm(e,t,r){var n=0;t&&(n|=4),TA(r,e,n,t)}var Zf="_reactListening"+Math.random().toString(36).slice(2);function xu(e){if(!e[Zf]){e[Zf]=!0,bS.forEach(function(r){r!=="selectionchange"&&(DD.has(r)||hm(r,!1,e),hm(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Zf]||(t[Zf]=!0,hm("selectionchange",!1,t))}}function TA(e,t,r,n){switch(aA(t)){case 1:var i=KN;break;case 4:i=XN;break;default:i=Vv}r=i.bind(null,t,r,e),i=void 0,!$g||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function dm(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Da(o),a===null)return;if(c=a.tag,c===5||c===6){n=s=a;continue e}o=o.parentNode}}n=n.return}GS(function(){var l=s,u=Dv(r),f=[];e:{var d=EA.get(e);if(d!==void 0){var p=Bv,g=e;switch(e){case"keypress":if(Mh(r)===0)break e;case"keydown":case"keyup":p=uD;break;case"focusin":g="focus",p=am;break;case"focusout":g="blur",p=am;break;case"beforeblur":case"afterblur":p=am;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=nE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=JN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=dD;break;case vA:case xA:case _A:p=tD;break;case yA:p=mD;break;case"scroll":p=YN;break;case"wheel":p=vD;break;case"copy":case"cut":case"paste":p=nD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=sE}var m=(t&4)!==0,v=!m&&e==="scroll",_=m?d!==null?d+"Capture":null:d;m=[];for(var x=l,y;x!==null;){y=x;var w=y.stateNode;if(y.tag===5&&w!==null&&(y=w,_!==null&&(w=hu(x,_),w!=null&&m.push(_u(x,w,y)))),v)break;x=x.return}0<m.length&&(d=new p(d,g,null,r,u),f.push({event:d,listeners:m}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",d&&r!==Bg&&(g=r.relatedTarget||r.fromElement)&&(Da(g)||g[fs]))break e;if((p||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=l,g=g?Da(g):null,g!==null&&(v=mo(g),g!==v||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=l),p!==g)){if(m=nE,w="onMouseLeave",_="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(m=sE,w="onPointerLeave",_="onPointerEnter",x="pointer"),v=p==null?d:zo(p),y=g==null?d:zo(g),d=new m(w,x+"leave",p,r,u),d.target=v,d.relatedTarget=y,w=null,Da(u)===l&&(m=new m(_,x+"enter",g,r,u),m.target=y,m.relatedTarget=v,w=m),v=w,p&&g)t:{for(m=p,_=g,x=0,y=m;y;y=bo(y))x++;for(y=0,w=_;w;w=bo(w))y++;for(;0<x-y;)m=bo(m),x--;for(;0<y-x;)_=bo(_),y--;for(;x--;){if(m===_||_!==null&&m===_.alternate)break t;m=bo(m),_=bo(_)}m=null}else m=null;p!==null&&gE(f,d,p,m,!1),g!==null&&v!==null&&gE(f,v,g,m,!0)}}e:{if(d=l?zo(l):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var T=SD;else if(cE(d))if(hA)T=ID;else{T=kD;var S=AD}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(T=CD);if(T&&(T=T(e,l))){fA(f,T,r,u);break e}S&&S(e,d,l),e==="focusout"&&(S=d._wrapperState)&&S.controlled&&d.type==="number"&&Og(d,"number",d.value)}switch(S=l?zo(l):window,e){case"focusin":(cE(S)||S.contentEditable==="true")&&($o=S,qg=l,Ul=null);break;case"focusout":Ul=qg=$o=null;break;case"mousedown":Kg=!0;break;case"contextmenu":case"mouseup":case"dragend":Kg=!1,dE(f,r,u);break;case"selectionchange":if(FD)break;case"keydown":case"keyup":dE(f,r,u)}var E;if($v)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Uo?lA(e,r)&&(k="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(k="onCompositionStart");k&&(cA&&r.locale!=="ko"&&(Uo||k!=="onCompositionStart"?k==="onCompositionEnd"&&Uo&&(E=oA()):(Ms=u,jv="value"in Ms?Ms.value:Ms.textContent,Uo=!0)),S=hd(l,k),0<S.length&&(k=new iE(k,e,null,r,u),f.push({event:k,listeners:S}),E?k.data=E:(E=uA(r),E!==null&&(k.data=E)))),(E=_D?yD(e,r):ED(e,r))&&(l=hd(l,"onBeforeInput"),0<l.length&&(u=new iE("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:l}),u.data=E))}wA(f,t)})}function _u(e,t,r){return{instance:e,listener:t,currentTarget:r}}function hd(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=hu(e,r),s!=null&&n.unshift(_u(e,s,i)),s=hu(e,t),s!=null&&n.push(_u(e,s,i))),e=e.return}return n}function bo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function gE(e,t,r,n,i){for(var s=t._reactName,a=[];r!==null&&r!==n;){var o=r,c=o.alternate,l=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&l!==null&&(o=l,i?(c=hu(r,s),c!=null&&a.unshift(_u(r,c,o))):i||(c=hu(r,s),c!=null&&a.push(_u(r,c,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var OD=/\r\n?/g,LD=/\u0000|\uFFFD/g;function vE(e){return(typeof e=="string"?e:""+e).replace(OD,`
`).replace(LD,"")}function eh(e,t,r){if(t=vE(t),vE(e)!==t&&r)throw Error(he(425))}function dd(){}var Xg=null,Yg=null;function Qg(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Jg=typeof setTimeout=="function"?setTimeout:void 0,MD=typeof clearTimeout=="function"?clearTimeout:void 0,xE=typeof Promise=="function"?Promise:void 0,VD=typeof queueMicrotask=="function"?queueMicrotask:typeof xE<"u"?function(e){return xE.resolve(null).then(e).catch(jD)}:Jg;function jD(e){setTimeout(function(){throw e})}function pm(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),mu(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);mu(t)}function Xs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function _E(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var jc=Math.random().toString(36).slice(2),Ii="__reactFiber$"+jc,yu="__reactProps$"+jc,fs="__reactContainer$"+jc,Zg="__reactEvents$"+jc,BD="__reactListeners$"+jc,UD="__reactHandles$"+jc;function Da(e){var t=e[Ii];if(t)return t;for(var r=e.parentNode;r;){if(t=r[fs]||r[Ii]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=_E(e);e!==null;){if(r=e[Ii])return r;e=_E(e)}return t}e=r,r=e.parentNode}return null}function cf(e){return e=e[Ii]||e[fs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function zo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(he(33))}function N0(e){return e[yu]||null}var e1=[],Wo=-1;function ga(e){return{current:e}}function Et(e){0>Wo||(e.current=e1[Wo],e1[Wo]=null,Wo--)}function mt(e,t){Wo++,e1[Wo]=e.current,e.current=t}var aa={},Gr=ga(aa),_n=ga(!1),Xa=aa;function yc(e,t){var r=e.type.contextTypes;if(!r)return aa;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function yn(e){return e=e.childContextTypes,e!=null}function pd(){Et(_n),Et(Gr)}function yE(e,t,r){if(Gr.current!==aa)throw Error(he(168));mt(Gr,t),mt(_n,r)}function SA(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(he(108,AN(e)||"Unknown",i));return bt({},r,n)}function md(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||aa,Xa=Gr.current,mt(Gr,e),mt(_n,_n.current),!0}function EE(e,t,r){var n=e.stateNode;if(!n)throw Error(he(169));r?(e=SA(e,t,Xa),n.__reactInternalMemoizedMergedChildContext=e,Et(_n),Et(Gr),mt(Gr,e)):Et(_n),mt(_n,r)}var Zi=null,D0=!1,mm=!1;function AA(e){Zi===null?Zi=[e]:Zi.push(e)}function $D(e){D0=!0,AA(e)}function va(){if(!mm&&Zi!==null){mm=!0;var e=0,t=ut;try{var r=Zi;for(ut=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Zi=null,D0=!1}catch(i){throw Zi!==null&&(Zi=Zi.slice(e+1)),YS(Ov,va),i}finally{ut=t,mm=!1}}return null}var Go=[],qo=0,gd=null,vd=0,qn=[],Kn=0,Ya=null,es=1,ts="";function Ia(e,t){Go[qo++]=vd,Go[qo++]=gd,gd=e,vd=t}function kA(e,t,r){qn[Kn++]=es,qn[Kn++]=ts,qn[Kn++]=Ya,Ya=e;var n=es;e=ts;var i=32-hi(n)-1;n&=~(1<<i),r+=1;var s=32-hi(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,es=1<<32-hi(t)+i|r<<i|n,ts=s+e}else es=1<<s|r<<i|n,ts=e}function zv(e){e.return!==null&&(Ia(e,1),kA(e,1,0))}function Wv(e){for(;e===gd;)gd=Go[--qo],Go[qo]=null,vd=Go[--qo],Go[qo]=null;for(;e===Ya;)Ya=qn[--Kn],qn[Kn]=null,ts=qn[--Kn],qn[Kn]=null,es=qn[--Kn],qn[Kn]=null}var Nn=null,Rn=null,At=!1,ci=null;function CA(e,t){var r=Qn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function wE(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Nn=e,Rn=Xs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Nn=e,Rn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ya!==null?{id:es,overflow:ts}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Qn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Nn=e,Rn=null,!0):!1;default:return!1}}function t1(e){return(e.mode&1)!==0&&(e.flags&128)===0}function r1(e){if(At){var t=Rn;if(t){var r=t;if(!wE(e,t)){if(t1(e))throw Error(he(418));t=Xs(r.nextSibling);var n=Nn;t&&wE(e,t)?CA(n,r):(e.flags=e.flags&-4097|2,At=!1,Nn=e)}}else{if(t1(e))throw Error(he(418));e.flags=e.flags&-4097|2,At=!1,Nn=e}}}function TE(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Nn=e}function th(e){if(e!==Nn)return!1;if(!At)return TE(e),At=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Qg(e.type,e.memoizedProps)),t&&(t=Rn)){if(t1(e))throw IA(),Error(he(418));for(;t;)CA(e,t),t=Xs(t.nextSibling)}if(TE(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(he(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Rn=Xs(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Rn=null}}else Rn=Nn?Xs(e.stateNode.nextSibling):null;return!0}function IA(){for(var e=Rn;e;)e=Xs(e.nextSibling)}function Ec(){Rn=Nn=null,At=!1}function Gv(e){ci===null?ci=[e]:ci.push(e)}var HD=_s.ReactCurrentBatchConfig;function ai(e,t){if(e&&e.defaultProps){t=bt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}var xd=ga(null),_d=null,Ko=null,qv=null;function Kv(){qv=Ko=_d=null}function Xv(e){var t=xd.current;Et(xd),e._currentValue=t}function n1(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function oc(e,t){_d=e,qv=Ko=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(vn=!0),e.firstContext=null)}function Zn(e){var t=e._currentValue;if(qv!==e)if(e={context:e,memoizedValue:t,next:null},Ko===null){if(_d===null)throw Error(he(308));Ko=e,_d.dependencies={lanes:0,firstContext:e}}else Ko=Ko.next=e;return t}var Oa=null;function Yv(e){Oa===null?Oa=[e]:Oa.push(e)}function RA(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,Yv(t)):(r.next=i.next,i.next=r),t.interleaved=r,hs(e,n)}function hs(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Cs=!1;function Qv(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bA(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function as(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ys(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,it&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,hs(e,r)}return i=n.interleaved,i===null?(t.next=t,Yv(n)):(t.next=i.next,i.next=t),n.interleaved=t,hs(e,r)}function Vh(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Lv(e,r)}}function SE(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function yd(e,t,r,n){var i=e.updateQueue;Cs=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var c=o,l=c.next;c.next=null,a===null?s=l:a.next=l,a=c;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=l:o.next=l,u.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;a=0,u=l=c=null,o=s;do{var d=o.lane,p=o.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,m=o;switch(d=t,p=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){f=g.call(p,f,d);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,d=typeof g=="function"?g.call(p,f,d):g,d==null)break e;f=bt({},f,d);break e;case 2:Cs=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(l=u=p,c=f):u=u.next=p,a|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(1);if(u===null&&(c=f),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Ja|=a,e.lanes=a,e.memoizedState=f}}function AE(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(he(191,i));i.call(n)}}}var FA=new RS.Component().refs;function i1(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:bt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var O0={isMounted:function(e){return(e=e._reactInternals)?mo(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=an(),i=Js(e),s=as(n,i);s.payload=t,r!=null&&(s.callback=r),t=Ys(e,s,i),t!==null&&(di(t,e,i,n),Vh(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=an(),i=Js(e),s=as(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Ys(e,s,i),t!==null&&(di(t,e,i,n),Vh(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=an(),n=Js(e),i=as(r,n);i.tag=2,t!=null&&(i.callback=t),t=Ys(e,i,n),t!==null&&(di(t,e,n,r),Vh(t,e,n))}};function kE(e,t,r,n,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!vu(r,n)||!vu(i,s):!0}function PA(e,t,r){var n=!1,i=aa,s=t.contextType;return typeof s=="object"&&s!==null?s=Zn(s):(i=yn(t)?Xa:Gr.current,n=t.contextTypes,s=(n=n!=null)?yc(e,i):aa),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=O0,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function CE(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&O0.enqueueReplaceState(t,t.state,null)}function s1(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=FA,Qv(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Zn(s):(s=yn(t)?Xa:Gr.current,i.context=yc(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(i1(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&O0.enqueueReplaceState(i,i.state,null),yd(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function ul(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(he(309));var n=r.stateNode}if(!n)throw Error(he(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=i.refs;o===FA&&(o=i.refs={}),a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(he(284));if(!r._owner)throw Error(he(290,e))}return e}function rh(e,t){throw e=Object.prototype.toString.call(t),Error(he(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function IE(e){var t=e._init;return t(e._payload)}function NA(e){function t(_,x){if(e){var y=_.deletions;y===null?(_.deletions=[x],_.flags|=16):y.push(x)}}function r(_,x){if(!e)return null;for(;x!==null;)t(_,x),x=x.sibling;return null}function n(_,x){for(_=new Map;x!==null;)x.key!==null?_.set(x.key,x):_.set(x.index,x),x=x.sibling;return _}function i(_,x){return _=Zs(_,x),_.index=0,_.sibling=null,_}function s(_,x,y){return _.index=y,e?(y=_.alternate,y!==null?(y=y.index,y<x?(_.flags|=2,x):y):(_.flags|=2,x)):(_.flags|=1048576,x)}function a(_){return e&&_.alternate===null&&(_.flags|=2),_}function o(_,x,y,w){return x===null||x.tag!==6?(x=wm(y,_.mode,w),x.return=_,x):(x=i(x,y),x.return=_,x)}function c(_,x,y,w){var T=y.type;return T===Bo?u(_,x,y.props.children,w,y.key):x!==null&&(x.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===ks&&IE(T)===x.type)?(w=i(x,y.props),w.ref=ul(_,x,y),w.return=_,w):(w=zh(y.type,y.key,y.props,null,_.mode,w),w.ref=ul(_,x,y),w.return=_,w)}function l(_,x,y,w){return x===null||x.tag!==4||x.stateNode.containerInfo!==y.containerInfo||x.stateNode.implementation!==y.implementation?(x=Tm(y,_.mode,w),x.return=_,x):(x=i(x,y.children||[]),x.return=_,x)}function u(_,x,y,w,T){return x===null||x.tag!==7?(x=Ha(y,_.mode,w,T),x.return=_,x):(x=i(x,y),x.return=_,x)}function f(_,x,y){if(typeof x=="string"&&x!==""||typeof x=="number")return x=wm(""+x,_.mode,y),x.return=_,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Wf:return y=zh(x.type,x.key,x.props,null,_.mode,y),y.ref=ul(_,null,x),y.return=_,y;case jo:return x=Tm(x,_.mode,y),x.return=_,x;case ks:var w=x._init;return f(_,w(x._payload),y)}if(El(x)||sl(x))return x=Ha(x,_.mode,y,null),x.return=_,x;rh(_,x)}return null}function d(_,x,y,w){var T=x!==null?x.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return T!==null?null:o(_,x,""+y,w);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Wf:return y.key===T?c(_,x,y,w):null;case jo:return y.key===T?l(_,x,y,w):null;case ks:return T=y._init,d(_,x,T(y._payload),w)}if(El(y)||sl(y))return T!==null?null:u(_,x,y,w,null);rh(_,y)}return null}function p(_,x,y,w,T){if(typeof w=="string"&&w!==""||typeof w=="number")return _=_.get(y)||null,o(x,_,""+w,T);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Wf:return _=_.get(w.key===null?y:w.key)||null,c(x,_,w,T);case jo:return _=_.get(w.key===null?y:w.key)||null,l(x,_,w,T);case ks:var S=w._init;return p(_,x,y,S(w._payload),T)}if(El(w)||sl(w))return _=_.get(y)||null,u(x,_,w,T,null);rh(x,w)}return null}function g(_,x,y,w){for(var T=null,S=null,E=x,k=x=0,b=null;E!==null&&k<y.length;k++){E.index>k?(b=E,E=null):b=E.sibling;var j=d(_,E,y[k],w);if(j===null){E===null&&(E=b);break}e&&E&&j.alternate===null&&t(_,E),x=s(j,x,k),S===null?T=j:S.sibling=j,S=j,E=b}if(k===y.length)return r(_,E),At&&Ia(_,k),T;if(E===null){for(;k<y.length;k++)E=f(_,y[k],w),E!==null&&(x=s(E,x,k),S===null?T=E:S.sibling=E,S=E);return At&&Ia(_,k),T}for(E=n(_,E);k<y.length;k++)b=p(E,_,k,y[k],w),b!==null&&(e&&b.alternate!==null&&E.delete(b.key===null?k:b.key),x=s(b,x,k),S===null?T=b:S.sibling=b,S=b);return e&&E.forEach(function(H){return t(_,H)}),At&&Ia(_,k),T}function m(_,x,y,w){var T=sl(y);if(typeof T!="function")throw Error(he(150));if(y=T.call(y),y==null)throw Error(he(151));for(var S=T=null,E=x,k=x=0,b=null,j=y.next();E!==null&&!j.done;k++,j=y.next()){E.index>k?(b=E,E=null):b=E.sibling;var H=d(_,E,j.value,w);if(H===null){E===null&&(E=b);break}e&&E&&H.alternate===null&&t(_,E),x=s(H,x,k),S===null?T=H:S.sibling=H,S=H,E=b}if(j.done)return r(_,E),At&&Ia(_,k),T;if(E===null){for(;!j.done;k++,j=y.next())j=f(_,j.value,w),j!==null&&(x=s(j,x,k),S===null?T=j:S.sibling=j,S=j);return At&&Ia(_,k),T}for(E=n(_,E);!j.done;k++,j=y.next())j=p(E,_,k,j.value,w),j!==null&&(e&&j.alternate!==null&&E.delete(j.key===null?k:j.key),x=s(j,x,k),S===null?T=j:S.sibling=j,S=j);return e&&E.forEach(function(O){return t(_,O)}),At&&Ia(_,k),T}function v(_,x,y,w){if(typeof y=="object"&&y!==null&&y.type===Bo&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Wf:e:{for(var T=y.key,S=x;S!==null;){if(S.key===T){if(T=y.type,T===Bo){if(S.tag===7){r(_,S.sibling),x=i(S,y.props.children),x.return=_,_=x;break e}}else if(S.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===ks&&IE(T)===S.type){r(_,S.sibling),x=i(S,y.props),x.ref=ul(_,S,y),x.return=_,_=x;break e}r(_,S);break}else t(_,S);S=S.sibling}y.type===Bo?(x=Ha(y.props.children,_.mode,w,y.key),x.return=_,_=x):(w=zh(y.type,y.key,y.props,null,_.mode,w),w.ref=ul(_,x,y),w.return=_,_=w)}return a(_);case jo:e:{for(S=y.key;x!==null;){if(x.key===S)if(x.tag===4&&x.stateNode.containerInfo===y.containerInfo&&x.stateNode.implementation===y.implementation){r(_,x.sibling),x=i(x,y.children||[]),x.return=_,_=x;break e}else{r(_,x);break}else t(_,x);x=x.sibling}x=Tm(y,_.mode,w),x.return=_,_=x}return a(_);case ks:return S=y._init,v(_,x,S(y._payload),w)}if(El(y))return g(_,x,y,w);if(sl(y))return m(_,x,y,w);rh(_,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,x!==null&&x.tag===6?(r(_,x.sibling),x=i(x,y),x.return=_,_=x):(r(_,x),x=wm(y,_.mode,w),x.return=_,_=x),a(_)):r(_,x)}return v}var wc=NA(!0),DA=NA(!1),lf={},Oi=ga(lf),Eu=ga(lf),wu=ga(lf);function La(e){if(e===lf)throw Error(he(174));return e}function Jv(e,t){switch(mt(wu,t),mt(Eu,e),mt(Oi,lf),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Mg(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Mg(t,e)}Et(Oi),mt(Oi,t)}function Tc(){Et(Oi),Et(Eu),Et(wu)}function OA(e){La(wu.current);var t=La(Oi.current),r=Mg(t,e.type);t!==r&&(mt(Eu,e),mt(Oi,r))}function Zv(e){Eu.current===e&&(Et(Oi),Et(Eu))}var It=ga(0);function Ed(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var gm=[];function ex(){for(var e=0;e<gm.length;e++)gm[e]._workInProgressVersionPrimary=null;gm.length=0}var jh=_s.ReactCurrentDispatcher,vm=_s.ReactCurrentBatchConfig,Qa=0,Rt=null,er=null,fr=null,wd=!1,$l=!1,Tu=0,zD=0;function Fr(){throw Error(he(321))}function tx(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!gi(e[r],t[r]))return!1;return!0}function rx(e,t,r,n,i,s){if(Qa=s,Rt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,jh.current=e===null||e.memoizedState===null?KD:XD,e=r(n,i),$l){s=0;do{if($l=!1,Tu=0,25<=s)throw Error(he(301));s+=1,fr=er=null,t.updateQueue=null,jh.current=YD,e=r(n,i)}while($l)}if(jh.current=Td,t=er!==null&&er.next!==null,Qa=0,fr=er=Rt=null,wd=!1,t)throw Error(he(300));return e}function nx(){var e=Tu!==0;return Tu=0,e}function Ai(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fr===null?Rt.memoizedState=fr=e:fr=fr.next=e,fr}function ei(){if(er===null){var e=Rt.alternate;e=e!==null?e.memoizedState:null}else e=er.next;var t=fr===null?Rt.memoizedState:fr.next;if(t!==null)fr=t,er=e;else{if(e===null)throw Error(he(310));er=e,e={memoizedState:er.memoizedState,baseState:er.baseState,baseQueue:er.baseQueue,queue:er.queue,next:null},fr===null?Rt.memoizedState=fr=e:fr=fr.next=e}return fr}function Su(e,t){return typeof t=="function"?t(e):t}function xm(e){var t=ei(),r=t.queue;if(r===null)throw Error(he(311));r.lastRenderedReducer=e;var n=er,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,c=null,l=s;do{var u=l.lane;if((Qa&u)===u)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),n=l.hasEagerState?l.eagerState:e(n,l.action);else{var f={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(o=c=f,a=n):c=c.next=f,Rt.lanes|=u,Ja|=u}l=l.next}while(l!==null&&l!==s);c===null?a=n:c.next=o,gi(n,t.memoizedState)||(vn=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Rt.lanes|=s,Ja|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function _m(e){var t=ei(),r=t.queue;if(r===null)throw Error(he(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);gi(s,t.memoizedState)||(vn=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function LA(){}function MA(e,t){var r=Rt,n=ei(),i=t(),s=!gi(n.memoizedState,i);if(s&&(n.memoizedState=i,vn=!0),n=n.queue,ix(BA.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||fr!==null&&fr.memoizedState.tag&1){if(r.flags|=2048,Au(9,jA.bind(null,r,n,i,t),void 0,null),hr===null)throw Error(he(349));Qa&30||VA(r,t,i)}return i}function VA(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Rt.updateQueue,t===null?(t={lastEffect:null,stores:null},Rt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function jA(e,t,r,n){t.value=r,t.getSnapshot=n,UA(t)&&$A(e)}function BA(e,t,r){return r(function(){UA(t)&&$A(e)})}function UA(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!gi(e,r)}catch{return!0}}function $A(e){var t=hs(e,1);t!==null&&di(t,e,1,-1)}function RE(e){var t=Ai();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Su,lastRenderedState:e},t.queue=e,e=e.dispatch=qD.bind(null,Rt,e),[t.memoizedState,e]}function Au(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Rt.updateQueue,t===null?(t={lastEffect:null,stores:null},Rt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function HA(){return ei().memoizedState}function Bh(e,t,r,n){var i=Ai();Rt.flags|=e,i.memoizedState=Au(1|t,r,void 0,n===void 0?null:n)}function L0(e,t,r,n){var i=ei();n=n===void 0?null:n;var s=void 0;if(er!==null){var a=er.memoizedState;if(s=a.destroy,n!==null&&tx(n,a.deps)){i.memoizedState=Au(t,r,s,n);return}}Rt.flags|=e,i.memoizedState=Au(1|t,r,s,n)}function bE(e,t){return Bh(8390656,8,e,t)}function ix(e,t){return L0(2048,8,e,t)}function zA(e,t){return L0(4,2,e,t)}function WA(e,t){return L0(4,4,e,t)}function GA(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function qA(e,t,r){return r=r!=null?r.concat([e]):null,L0(4,4,GA.bind(null,t,e),r)}function sx(){}function KA(e,t){var r=ei();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&tx(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function XA(e,t){var r=ei();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&tx(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function YA(e,t,r){return Qa&21?(gi(r,t)||(r=ZS(),Rt.lanes|=r,Ja|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,vn=!0),e.memoizedState=r)}function WD(e,t){var r=ut;ut=r!==0&&4>r?r:4,e(!0);var n=vm.transition;vm.transition={};try{e(!1),t()}finally{ut=r,vm.transition=n}}function QA(){return ei().memoizedState}function GD(e,t,r){var n=Js(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},JA(e))ZA(t,r);else if(r=RA(e,t,r,n),r!==null){var i=an();di(r,e,n,i),ek(r,t,n)}}function qD(e,t,r){var n=Js(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(JA(e))ZA(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,gi(o,a)){var c=t.interleaved;c===null?(i.next=i,Yv(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}r=RA(e,t,i,n),r!==null&&(i=an(),di(r,e,n,i),ek(r,t,n))}}function JA(e){var t=e.alternate;return e===Rt||t!==null&&t===Rt}function ZA(e,t){$l=wd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function ek(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Lv(e,r)}}var Td={readContext:Zn,useCallback:Fr,useContext:Fr,useEffect:Fr,useImperativeHandle:Fr,useInsertionEffect:Fr,useLayoutEffect:Fr,useMemo:Fr,useReducer:Fr,useRef:Fr,useState:Fr,useDebugValue:Fr,useDeferredValue:Fr,useTransition:Fr,useMutableSource:Fr,useSyncExternalStore:Fr,useId:Fr,unstable_isNewReconciler:!1},KD={readContext:Zn,useCallback:function(e,t){return Ai().memoizedState=[e,t===void 0?null:t],e},useContext:Zn,useEffect:bE,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Bh(4194308,4,GA.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Bh(4194308,4,e,t)},useInsertionEffect:function(e,t){return Bh(4,2,e,t)},useMemo:function(e,t){var r=Ai();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ai();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=GD.bind(null,Rt,e),[n.memoizedState,e]},useRef:function(e){var t=Ai();return e={current:e},t.memoizedState=e},useState:RE,useDebugValue:sx,useDeferredValue:function(e){return Ai().memoizedState=e},useTransition:function(){var e=RE(!1),t=e[0];return e=WD.bind(null,e[1]),Ai().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Rt,i=Ai();if(At){if(r===void 0)throw Error(he(407));r=r()}else{if(r=t(),hr===null)throw Error(he(349));Qa&30||VA(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,bE(BA.bind(null,n,s,e),[e]),n.flags|=2048,Au(9,jA.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Ai(),t=hr.identifierPrefix;if(At){var r=ts,n=es;r=(n&~(1<<32-hi(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Tu++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=zD++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},XD={readContext:Zn,useCallback:KA,useContext:Zn,useEffect:ix,useImperativeHandle:qA,useInsertionEffect:zA,useLayoutEffect:WA,useMemo:XA,useReducer:xm,useRef:HA,useState:function(){return xm(Su)},useDebugValue:sx,useDeferredValue:function(e){var t=ei();return YA(t,er.memoizedState,e)},useTransition:function(){var e=xm(Su)[0],t=ei().memoizedState;return[e,t]},useMutableSource:LA,useSyncExternalStore:MA,useId:QA,unstable_isNewReconciler:!1},YD={readContext:Zn,useCallback:KA,useContext:Zn,useEffect:ix,useImperativeHandle:qA,useInsertionEffect:zA,useLayoutEffect:WA,useMemo:XA,useReducer:_m,useRef:HA,useState:function(){return _m(Su)},useDebugValue:sx,useDeferredValue:function(e){var t=ei();return er===null?t.memoizedState=e:YA(t,er.memoizedState,e)},useTransition:function(){var e=_m(Su)[0],t=ei().memoizedState;return[e,t]},useMutableSource:LA,useSyncExternalStore:MA,useId:QA,unstable_isNewReconciler:!1};function Sc(e,t){try{var r="",n=t;do r+=SN(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function ym(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function a1(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var QD=typeof WeakMap=="function"?WeakMap:Map;function tk(e,t,r){r=as(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ad||(Ad=!0,g1=n),a1(e,t)},r}function rk(e,t,r){r=as(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){a1(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){a1(e,t),typeof n!="function"&&(Qs===null?Qs=new Set([this]):Qs.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function FE(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new QD;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=fO.bind(null,e,t,r),t.then(e,e))}function PE(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function NE(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=as(-1,1),t.tag=2,Ys(r,t,1))),r.lanes|=1),e)}var JD=_s.ReactCurrentOwner,vn=!1;function Zr(e,t,r,n){t.child=e===null?DA(t,null,r,n):wc(t,e.child,r,n)}function DE(e,t,r,n,i){r=r.render;var s=t.ref;return oc(t,i),n=rx(e,t,r,n,s,i),r=nx(),e!==null&&!vn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ds(e,t,i)):(At&&r&&zv(t),t.flags|=1,Zr(e,t,n,i),t.child)}function OE(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!dx(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,nk(e,t,s,n,i)):(e=zh(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:vu,r(a,n)&&e.ref===t.ref)return ds(e,t,i)}return t.flags|=1,e=Zs(s,n),e.ref=t.ref,e.return=t,t.child=e}function nk(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(vu(s,n)&&e.ref===t.ref)if(vn=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(vn=!0);else return t.lanes=e.lanes,ds(e,t,i)}return o1(e,t,r,n,i)}function ik(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt(Yo,An),An|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,mt(Yo,An),An|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,mt(Yo,An),An|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,mt(Yo,An),An|=n;return Zr(e,t,i,r),t.child}function sk(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function o1(e,t,r,n,i){var s=yn(r)?Xa:Gr.current;return s=yc(t,s),oc(t,i),r=rx(e,t,r,n,s,i),n=nx(),e!==null&&!vn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ds(e,t,i)):(At&&n&&zv(t),t.flags|=1,Zr(e,t,r,i),t.child)}function LE(e,t,r,n,i){if(yn(r)){var s=!0;md(t)}else s=!1;if(oc(t,i),t.stateNode===null)Uh(e,t),PA(t,r,n),s1(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var c=a.context,l=r.contextType;typeof l=="object"&&l!==null?l=Zn(l):(l=yn(r)?Xa:Gr.current,l=yc(t,l));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||c!==l)&&CE(t,a,n,l),Cs=!1;var d=t.memoizedState;a.state=d,yd(t,n,a,i),c=t.memoizedState,o!==n||d!==c||_n.current||Cs?(typeof u=="function"&&(i1(t,r,u,n),c=t.memoizedState),(o=Cs||kE(t,r,o,n,d,c,l))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),a.props=n,a.state=c,a.context=l,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,bA(e,t),o=t.memoizedProps,l=t.type===t.elementType?o:ai(t.type,o),a.props=l,f=t.pendingProps,d=a.context,c=r.contextType,typeof c=="object"&&c!==null?c=Zn(c):(c=yn(r)?Xa:Gr.current,c=yc(t,c));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==f||d!==c)&&CE(t,a,n,c),Cs=!1,d=t.memoizedState,a.state=d,yd(t,n,a,i);var g=t.memoizedState;o!==f||d!==g||_n.current||Cs?(typeof p=="function"&&(i1(t,r,p,n),g=t.memoizedState),(l=Cs||kE(t,r,l,n,d,g,c)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,g,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,g,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),a.props=n,a.state=g,a.context=c,n=l):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return c1(e,t,r,n,s,i)}function c1(e,t,r,n,i,s){sk(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&EE(t,r,!1),ds(e,t,s);n=t.stateNode,JD.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=wc(t,e.child,null,s),t.child=wc(t,null,o,s)):Zr(e,t,o,s),t.memoizedState=n.state,i&&EE(t,r,!0),t.child}function ak(e){var t=e.stateNode;t.pendingContext?yE(e,t.pendingContext,t.pendingContext!==t.context):t.context&&yE(e,t.context,!1),Jv(e,t.containerInfo)}function ME(e,t,r,n,i){return Ec(),Gv(i),t.flags|=256,Zr(e,t,r,n),t.child}var l1={dehydrated:null,treeContext:null,retryLane:0};function u1(e){return{baseLanes:e,cachePool:null,transitions:null}}function ok(e,t,r){var n=t.pendingProps,i=It.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),mt(It,i&1),e===null)return r1(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=j0(a,n,0,null),e=Ha(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=u1(r),t.memoizedState=l1,e):ax(t,a));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return ZD(e,t,a,n,o,i,r);if(s){s=n.fallback,a=t.mode,i=e.child,o=i.sibling;var c={mode:"hidden",children:n.children};return!(a&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Zs(i,c),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Zs(o,s):(s=Ha(s,a,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?u1(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=l1,n}return s=e.child,e=s.sibling,n=Zs(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function ax(e,t){return t=j0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function nh(e,t,r,n){return n!==null&&Gv(n),wc(t,e.child,null,r),e=ax(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function ZD(e,t,r,n,i,s,a){if(r)return t.flags&256?(t.flags&=-257,n=ym(Error(he(422))),nh(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=j0({mode:"visible",children:n.children},i,0,null),s=Ha(s,i,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&wc(t,e.child,null,a),t.child.memoizedState=u1(a),t.memoizedState=l1,s);if(!(t.mode&1))return nh(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(he(419)),n=ym(s,n,void 0),nh(e,t,a,n)}if(o=(a&e.childLanes)!==0,vn||o){if(n=hr,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,hs(e,i),di(n,e,i,-1))}return hx(),n=ym(Error(he(421))),nh(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=hO.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,Rn=Xs(i.nextSibling),Nn=t,At=!0,ci=null,e!==null&&(qn[Kn++]=es,qn[Kn++]=ts,qn[Kn++]=Ya,es=e.id,ts=e.overflow,Ya=t),t=ax(t,n.children),t.flags|=4096,t)}function VE(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),n1(e.return,t,r)}function Em(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function ck(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Zr(e,t,n.children,r),n=It.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&VE(e,r,t);else if(e.tag===19)VE(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(mt(It,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Ed(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Em(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Ed(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Em(t,!0,r,null,s);break;case"together":Em(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Uh(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ds(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ja|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(he(153));if(t.child!==null){for(e=t.child,r=Zs(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Zs(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function eO(e,t,r){switch(t.tag){case 3:ak(t),Ec();break;case 5:OA(t);break;case 1:yn(t.type)&&md(t);break;case 4:Jv(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;mt(xd,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(mt(It,It.current&1),t.flags|=128,null):r&t.child.childLanes?ok(e,t,r):(mt(It,It.current&1),e=ds(e,t,r),e!==null?e.sibling:null);mt(It,It.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return ck(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),mt(It,It.current),n)break;return null;case 22:case 23:return t.lanes=0,ik(e,t,r)}return ds(e,t,r)}var lk,f1,uk,fk;lk=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};f1=function(){};uk=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,La(Oi.current);var s=null;switch(r){case"input":i=Ng(e,i),n=Ng(e,n),s=[];break;case"select":i=bt({},i,{value:void 0}),n=bt({},n,{value:void 0}),s=[];break;case"textarea":i=Lg(e,i),n=Lg(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=dd)}Vg(r,n);var a;r=null;for(l in i)if(!n.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var o=i[l];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(uu.hasOwnProperty(l)?s||(s=[]):(s=s||[]).push(l,null));for(l in n){var c=n[l];if(o=i!=null?i[l]:void 0,n.hasOwnProperty(l)&&c!==o&&(c!=null||o!=null))if(l==="style")if(o){for(a in o)!o.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&o[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(s||(s=[]),s.push(l,r)),r=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(s=s||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(uu.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&vt("scroll",e),s||o===c||(s=[])):(s=s||[]).push(l,c))}r&&(s=s||[]).push("style",r);var l=s;(t.updateQueue=l)&&(t.flags|=4)}};fk=function(e,t,r,n){r!==n&&(t.flags|=4)};function fl(e,t){if(!At)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Pr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function tO(e,t,r){var n=t.pendingProps;switch(Wv(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pr(t),null;case 1:return yn(t.type)&&pd(),Pr(t),null;case 3:return n=t.stateNode,Tc(),Et(_n),Et(Gr),ex(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(th(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ci!==null&&(_1(ci),ci=null))),f1(e,t),Pr(t),null;case 5:Zv(t);var i=La(wu.current);if(r=t.type,e!==null&&t.stateNode!=null)uk(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(he(166));return Pr(t),null}if(e=La(Oi.current),th(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Ii]=t,n[yu]=s,e=(t.mode&1)!==0,r){case"dialog":vt("cancel",n),vt("close",n);break;case"iframe":case"object":case"embed":vt("load",n);break;case"video":case"audio":for(i=0;i<Tl.length;i++)vt(Tl[i],n);break;case"source":vt("error",n);break;case"img":case"image":case"link":vt("error",n),vt("load",n);break;case"details":vt("toggle",n);break;case"input":qy(n,s),vt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},vt("invalid",n);break;case"textarea":Xy(n,s),vt("invalid",n)}Vg(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&eh(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&eh(n.textContent,o,e),i=["children",""+o]):uu.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&vt("scroll",n)}switch(r){case"input":Gf(n),Ky(n,s,!0);break;case"textarea":Gf(n),Yy(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=dd)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=VS(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[Ii]=t,e[yu]=n,lk(e,t,!1,!1),t.stateNode=e;e:{switch(a=jg(r,n),r){case"dialog":vt("cancel",e),vt("close",e),i=n;break;case"iframe":case"object":case"embed":vt("load",e),i=n;break;case"video":case"audio":for(i=0;i<Tl.length;i++)vt(Tl[i],e);i=n;break;case"source":vt("error",e),i=n;break;case"img":case"image":case"link":vt("error",e),vt("load",e),i=n;break;case"details":vt("toggle",e),i=n;break;case"input":qy(e,n),i=Ng(e,n),vt("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=bt({},n,{value:void 0}),vt("invalid",e);break;case"textarea":Xy(e,n),i=Lg(e,n),vt("invalid",e);break;default:i=n}Vg(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var c=o[s];s==="style"?US(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&jS(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&fu(e,c):typeof c=="number"&&fu(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(uu.hasOwnProperty(s)?c!=null&&s==="onScroll"&&vt("scroll",e):c!=null&&bv(e,s,c,a))}switch(r){case"input":Gf(e),Ky(e,n,!1);break;case"textarea":Gf(e),Yy(e);break;case"option":n.value!=null&&e.setAttribute("value",""+sa(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?nc(e,!!n.multiple,s,!1):n.defaultValue!=null&&nc(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=dd)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Pr(t),null;case 6:if(e&&t.stateNode!=null)fk(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(he(166));if(r=La(wu.current),La(Oi.current),th(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ii]=t,(s=n.nodeValue!==r)&&(e=Nn,e!==null))switch(e.tag){case 3:eh(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&eh(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ii]=t,t.stateNode=n}return Pr(t),null;case 13:if(Et(It),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(At&&Rn!==null&&t.mode&1&&!(t.flags&128))IA(),Ec(),t.flags|=98560,s=!1;else if(s=th(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(he(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(he(317));s[Ii]=t}else Ec(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Pr(t),s=!1}else ci!==null&&(_1(ci),ci=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||It.current&1?tr===0&&(tr=3):hx())),t.updateQueue!==null&&(t.flags|=4),Pr(t),null);case 4:return Tc(),f1(e,t),e===null&&xu(t.stateNode.containerInfo),Pr(t),null;case 10:return Xv(t.type._context),Pr(t),null;case 17:return yn(t.type)&&pd(),Pr(t),null;case 19:if(Et(It),s=t.memoizedState,s===null)return Pr(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)fl(s,!1);else{if(tr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Ed(e),a!==null){for(t.flags|=128,fl(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return mt(It,It.current&1|2),t.child}e=e.sibling}s.tail!==null&&Ut()>Ac&&(t.flags|=128,n=!0,fl(s,!1),t.lanes=4194304)}else{if(!n)if(e=Ed(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),fl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!At)return Pr(t),null}else 2*Ut()-s.renderingStartTime>Ac&&r!==1073741824&&(t.flags|=128,n=!0,fl(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ut(),t.sibling=null,r=It.current,mt(It,n?r&1|2:r&1),t):(Pr(t),null);case 22:case 23:return fx(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?An&1073741824&&(Pr(t),t.subtreeFlags&6&&(t.flags|=8192)):Pr(t),null;case 24:return null;case 25:return null}throw Error(he(156,t.tag))}function rO(e,t){switch(Wv(t),t.tag){case 1:return yn(t.type)&&pd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Tc(),Et(_n),Et(Gr),ex(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Zv(t),null;case 13:if(Et(It),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(he(340));Ec()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Et(It),null;case 4:return Tc(),null;case 10:return Xv(t.type._context),null;case 22:case 23:return fx(),null;case 24:return null;default:return null}}var ih=!1,jr=!1,nO=typeof WeakSet=="function"?WeakSet:Set,Ae=null;function Xo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Nt(e,t,n)}else r.current=null}function h1(e,t,r){try{r()}catch(n){Nt(e,t,n)}}var jE=!1;function iO(e,t){if(Xg=ud,e=mA(),Hv(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,c=-1,l=0,u=0,f=e,d=null;t:for(;;){for(var p;f!==r||i!==0&&f.nodeType!==3||(o=a+i),f!==s||n!==0&&f.nodeType!==3||(c=a+n),f.nodeType===3&&(a+=f.nodeValue.length),(p=f.firstChild)!==null;)d=f,f=p;for(;;){if(f===e)break t;if(d===r&&++l===i&&(o=a),d===s&&++u===n&&(c=a),(p=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=p}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Yg={focusedElem:e,selectionRange:r},ud=!1,Ae=t;Ae!==null;)if(t=Ae,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ae=e;else for(;Ae!==null;){t=Ae;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,v=g.memoizedState,_=t.stateNode,x=_.getSnapshotBeforeUpdate(t.elementType===t.type?m:ai(t.type,m),v);_.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(he(163))}}catch(w){Nt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,Ae=e;break}Ae=t.return}return g=jE,jE=!1,g}function Hl(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&h1(t,r,s)}i=i.next}while(i!==n)}}function M0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function d1(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function hk(e){var t=e.alternate;t!==null&&(e.alternate=null,hk(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ii],delete t[yu],delete t[Zg],delete t[BD],delete t[UD])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function dk(e){return e.tag===5||e.tag===3||e.tag===4}function BE(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||dk(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function p1(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=dd));else if(n!==4&&(e=e.child,e!==null))for(p1(e,t,r),e=e.sibling;e!==null;)p1(e,t,r),e=e.sibling}function m1(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(m1(e,t,r),e=e.sibling;e!==null;)m1(e,t,r),e=e.sibling}var xr=null,oi=!1;function ws(e,t,r){for(r=r.child;r!==null;)pk(e,t,r),r=r.sibling}function pk(e,t,r){if(Di&&typeof Di.onCommitFiberUnmount=="function")try{Di.onCommitFiberUnmount(R0,r)}catch{}switch(r.tag){case 5:jr||Xo(r,t);case 6:var n=xr,i=oi;xr=null,ws(e,t,r),xr=n,oi=i,xr!==null&&(oi?(e=xr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):xr.removeChild(r.stateNode));break;case 18:xr!==null&&(oi?(e=xr,r=r.stateNode,e.nodeType===8?pm(e.parentNode,r):e.nodeType===1&&pm(e,r),mu(e)):pm(xr,r.stateNode));break;case 4:n=xr,i=oi,xr=r.stateNode.containerInfo,oi=!0,ws(e,t,r),xr=n,oi=i;break;case 0:case 11:case 14:case 15:if(!jr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&h1(r,t,a),i=i.next}while(i!==n)}ws(e,t,r);break;case 1:if(!jr&&(Xo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Nt(r,t,o)}ws(e,t,r);break;case 21:ws(e,t,r);break;case 22:r.mode&1?(jr=(n=jr)||r.memoizedState!==null,ws(e,t,r),jr=n):ws(e,t,r);break;default:ws(e,t,r)}}function UE(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new nO),t.forEach(function(n){var i=dO.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ni(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:xr=o.stateNode,oi=!1;break e;case 3:xr=o.stateNode.containerInfo,oi=!0;break e;case 4:xr=o.stateNode.containerInfo,oi=!0;break e}o=o.return}if(xr===null)throw Error(he(160));pk(s,a,i),xr=null,oi=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(l){Nt(i,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)mk(t,e),t=t.sibling}function mk(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ni(t,e),Ei(e),n&4){try{Hl(3,e,e.return),M0(3,e)}catch(m){Nt(e,e.return,m)}try{Hl(5,e,e.return)}catch(m){Nt(e,e.return,m)}}break;case 1:ni(t,e),Ei(e),n&512&&r!==null&&Xo(r,r.return);break;case 5:if(ni(t,e),Ei(e),n&512&&r!==null&&Xo(r,r.return),e.flags&32){var i=e.stateNode;try{fu(i,"")}catch(m){Nt(e,e.return,m)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&LS(i,s),jg(o,a);var l=jg(o,s);for(a=0;a<c.length;a+=2){var u=c[a],f=c[a+1];u==="style"?US(i,f):u==="dangerouslySetInnerHTML"?jS(i,f):u==="children"?fu(i,f):bv(i,u,f,l)}switch(o){case"input":Dg(i,s);break;case"textarea":MS(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?nc(i,!!s.multiple,p,!1):d!==!!s.multiple&&(s.defaultValue!=null?nc(i,!!s.multiple,s.defaultValue,!0):nc(i,!!s.multiple,s.multiple?[]:"",!1))}i[yu]=s}catch(m){Nt(e,e.return,m)}}break;case 6:if(ni(t,e),Ei(e),n&4){if(e.stateNode===null)throw Error(he(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(m){Nt(e,e.return,m)}}break;case 3:if(ni(t,e),Ei(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{mu(t.containerInfo)}catch(m){Nt(e,e.return,m)}break;case 4:ni(t,e),Ei(e);break;case 13:ni(t,e),Ei(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(lx=Ut())),n&4&&UE(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(jr=(l=jr)||u,ni(t,e),jr=l):ni(t,e),Ei(e),n&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!u&&e.mode&1)for(Ae=e,u=e.child;u!==null;){for(f=Ae=u;Ae!==null;){switch(d=Ae,p=d.child,d.tag){case 0:case 11:case 14:case 15:Hl(4,d,d.return);break;case 1:Xo(d,d.return);var g=d.stateNode;if(typeof g.componentWillUnmount=="function"){n=d,r=d.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Nt(n,r,m)}}break;case 5:Xo(d,d.return);break;case 22:if(d.memoizedState!==null){HE(f);continue}}p!==null?(p.return=d,Ae=p):HE(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,l?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,c=f.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=BS("display",a))}catch(m){Nt(e,e.return,m)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=l?"":f.memoizedProps}catch(m){Nt(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:ni(t,e),Ei(e),n&4&&UE(e);break;case 21:break;default:ni(t,e),Ei(e)}}function Ei(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(dk(r)){var n=r;break e}r=r.return}throw Error(he(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(fu(i,""),n.flags&=-33);var s=BE(e);m1(e,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=BE(e);p1(e,o,a);break;default:throw Error(he(161))}}catch(c){Nt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function sO(e,t,r){Ae=e,gk(e)}function gk(e,t,r){for(var n=(e.mode&1)!==0;Ae!==null;){var i=Ae,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||ih;if(!a){var o=i.alternate,c=o!==null&&o.memoizedState!==null||jr;o=ih;var l=jr;if(ih=a,(jr=c)&&!l)for(Ae=i;Ae!==null;)a=Ae,c=a.child,a.tag===22&&a.memoizedState!==null?zE(i):c!==null?(c.return=a,Ae=c):zE(i);for(;s!==null;)Ae=s,gk(s),s=s.sibling;Ae=i,ih=o,jr=l}$E(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Ae=s):$E(e)}}function $E(e){for(;Ae!==null;){var t=Ae;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:jr||M0(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!jr)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:ai(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&AE(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}AE(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&mu(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(he(163))}jr||t.flags&512&&d1(t)}catch(d){Nt(t,t.return,d)}}if(t===e){Ae=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ae=r;break}Ae=t.return}}function HE(e){for(;Ae!==null;){var t=Ae;if(t===e){Ae=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ae=r;break}Ae=t.return}}function zE(e){for(;Ae!==null;){var t=Ae;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{M0(4,t)}catch(c){Nt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){Nt(t,i,c)}}var s=t.return;try{d1(t)}catch(c){Nt(t,s,c)}break;case 5:var a=t.return;try{d1(t)}catch(c){Nt(t,a,c)}}}catch(c){Nt(t,t.return,c)}if(t===e){Ae=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ae=o;break}Ae=t.return}}var aO=Math.ceil,Sd=_s.ReactCurrentDispatcher,ox=_s.ReactCurrentOwner,Jn=_s.ReactCurrentBatchConfig,it=0,hr=null,Yt=null,Sr=0,An=0,Yo=ga(0),tr=0,ku=null,Ja=0,V0=0,cx=0,zl=null,mn=null,lx=0,Ac=1/0,Ji=null,Ad=!1,g1=null,Qs=null,sh=!1,Vs=null,kd=0,Wl=0,v1=null,$h=-1,Hh=0;function an(){return it&6?Ut():$h!==-1?$h:$h=Ut()}function Js(e){return e.mode&1?it&2&&Sr!==0?Sr&-Sr:HD.transition!==null?(Hh===0&&(Hh=ZS()),Hh):(e=ut,e!==0||(e=window.event,e=e===void 0?16:aA(e.type)),e):1}function di(e,t,r,n){if(50<Wl)throw Wl=0,v1=null,Error(he(185));af(e,r,n),(!(it&2)||e!==hr)&&(e===hr&&(!(it&2)&&(V0|=r),tr===4&&Rs(e,Sr)),En(e,n),r===1&&it===0&&!(t.mode&1)&&(Ac=Ut()+500,D0&&va()))}function En(e,t){var r=e.callbackNode;HN(e,t);var n=ld(e,e===hr?Sr:0);if(n===0)r!==null&&Zy(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Zy(r),t===1)e.tag===0?$D(WE.bind(null,e)):AA(WE.bind(null,e)),VD(function(){!(it&6)&&va()}),r=null;else{switch(eA(n)){case 1:r=Ov;break;case 4:r=QS;break;case 16:r=cd;break;case 536870912:r=JS;break;default:r=cd}r=Sk(r,vk.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function vk(e,t){if($h=-1,Hh=0,it&6)throw Error(he(327));var r=e.callbackNode;if(cc()&&e.callbackNode!==r)return null;var n=ld(e,e===hr?Sr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Cd(e,n);else{t=n;var i=it;it|=2;var s=_k();(hr!==e||Sr!==t)&&(Ji=null,Ac=Ut()+500,$a(e,t));do try{lO();break}catch(o){xk(e,o)}while(1);Kv(),Sd.current=s,it=i,Yt!==null?t=0:(hr=null,Sr=0,t=tr)}if(t!==0){if(t===2&&(i=zg(e),i!==0&&(n=i,t=x1(e,i))),t===1)throw r=ku,$a(e,0),Rs(e,n),En(e,Ut()),r;if(t===6)Rs(e,n);else{if(i=e.current.alternate,!(n&30)&&!oO(i)&&(t=Cd(e,n),t===2&&(s=zg(e),s!==0&&(n=s,t=x1(e,s))),t===1))throw r=ku,$a(e,0),Rs(e,n),En(e,Ut()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(he(345));case 2:Ra(e,mn,Ji);break;case 3:if(Rs(e,n),(n&130023424)===n&&(t=lx+500-Ut(),10<t)){if(ld(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){an(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Jg(Ra.bind(null,e,mn,Ji),t);break}Ra(e,mn,Ji);break;case 4:if(Rs(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-hi(n);s=1<<a,a=t[a],a>i&&(i=a),n&=~s}if(n=i,n=Ut()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*aO(n/1960))-n,10<n){e.timeoutHandle=Jg(Ra.bind(null,e,mn,Ji),n);break}Ra(e,mn,Ji);break;case 5:Ra(e,mn,Ji);break;default:throw Error(he(329))}}}return En(e,Ut()),e.callbackNode===r?vk.bind(null,e):null}function x1(e,t){var r=zl;return e.current.memoizedState.isDehydrated&&($a(e,t).flags|=256),e=Cd(e,t),e!==2&&(t=mn,mn=r,t!==null&&_1(t)),e}function _1(e){mn===null?mn=e:mn.push.apply(mn,e)}function oO(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!gi(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Rs(e,t){for(t&=~cx,t&=~V0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-hi(t),n=1<<r;e[r]=-1,t&=~n}}function WE(e){if(it&6)throw Error(he(327));cc();var t=ld(e,0);if(!(t&1))return En(e,Ut()),null;var r=Cd(e,t);if(e.tag!==0&&r===2){var n=zg(e);n!==0&&(t=n,r=x1(e,n))}if(r===1)throw r=ku,$a(e,0),Rs(e,t),En(e,Ut()),r;if(r===6)throw Error(he(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ra(e,mn,Ji),En(e,Ut()),null}function ux(e,t){var r=it;it|=1;try{return e(t)}finally{it=r,it===0&&(Ac=Ut()+500,D0&&va())}}function Za(e){Vs!==null&&Vs.tag===0&&!(it&6)&&cc();var t=it;it|=1;var r=Jn.transition,n=ut;try{if(Jn.transition=null,ut=1,e)return e()}finally{ut=n,Jn.transition=r,it=t,!(it&6)&&va()}}function fx(){An=Yo.current,Et(Yo)}function $a(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,MD(r)),Yt!==null)for(r=Yt.return;r!==null;){var n=r;switch(Wv(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&pd();break;case 3:Tc(),Et(_n),Et(Gr),ex();break;case 5:Zv(n);break;case 4:Tc();break;case 13:Et(It);break;case 19:Et(It);break;case 10:Xv(n.type._context);break;case 22:case 23:fx()}r=r.return}if(hr=e,Yt=e=Zs(e.current,null),Sr=An=t,tr=0,ku=null,cx=V0=Ja=0,mn=zl=null,Oa!==null){for(t=0;t<Oa.length;t++)if(r=Oa[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}Oa=null}return e}function xk(e,t){do{var r=Yt;try{if(Kv(),jh.current=Td,wd){for(var n=Rt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}wd=!1}if(Qa=0,fr=er=Rt=null,$l=!1,Tu=0,ox.current=null,r===null||r.return===null){tr=1,ku=t,Yt=null;break}e:{var s=e,a=r.return,o=r,c=t;if(t=Sr,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=PE(a);if(p!==null){p.flags&=-257,NE(p,a,o,s,t),p.mode&1&&FE(s,l,t),t=p,c=l;var g=t.updateQueue;if(g===null){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}else{if(!(t&1)){FE(s,l,t),hx();break e}c=Error(he(426))}}else if(At&&o.mode&1){var v=PE(a);if(v!==null){!(v.flags&65536)&&(v.flags|=256),NE(v,a,o,s,t),Gv(Sc(c,o));break e}}s=c=Sc(c,o),tr!==4&&(tr=2),zl===null?zl=[s]:zl.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var _=tk(s,c,t);SE(s,_);break e;case 1:o=c;var x=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Qs===null||!Qs.has(y)))){s.flags|=65536,t&=-t,s.lanes|=t;var w=rk(s,o,t);SE(s,w);break e}}s=s.return}while(s!==null)}Ek(r)}catch(T){t=T,Yt===r&&r!==null&&(Yt=r=r.return);continue}break}while(1)}function _k(){var e=Sd.current;return Sd.current=Td,e===null?Td:e}function hx(){(tr===0||tr===3||tr===2)&&(tr=4),hr===null||!(Ja&268435455)&&!(V0&268435455)||Rs(hr,Sr)}function Cd(e,t){var r=it;it|=2;var n=_k();(hr!==e||Sr!==t)&&(Ji=null,$a(e,t));do try{cO();break}catch(i){xk(e,i)}while(1);if(Kv(),it=r,Sd.current=n,Yt!==null)throw Error(he(261));return hr=null,Sr=0,tr}function cO(){for(;Yt!==null;)yk(Yt)}function lO(){for(;Yt!==null&&!DN();)yk(Yt)}function yk(e){var t=Tk(e.alternate,e,An);e.memoizedProps=e.pendingProps,t===null?Ek(e):Yt=t,ox.current=null}function Ek(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=rO(r,t),r!==null){r.flags&=32767,Yt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{tr=6,Yt=null;return}}else if(r=tO(r,t,An),r!==null){Yt=r;return}if(t=t.sibling,t!==null){Yt=t;return}Yt=t=e}while(t!==null);tr===0&&(tr=5)}function Ra(e,t,r){var n=ut,i=Jn.transition;try{Jn.transition=null,ut=1,uO(e,t,r,n)}finally{Jn.transition=i,ut=n}return null}function uO(e,t,r,n){do cc();while(Vs!==null);if(it&6)throw Error(he(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(he(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(zN(e,s),e===hr&&(Yt=hr=null,Sr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||sh||(sh=!0,Sk(cd,function(){return cc(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Jn.transition,Jn.transition=null;var a=ut;ut=1;var o=it;it|=4,ox.current=null,iO(e,r),mk(r,e),bD(Yg),ud=!!Xg,Yg=Xg=null,e.current=r,sO(r),ON(),it=o,ut=a,Jn.transition=s}else e.current=r;if(sh&&(sh=!1,Vs=e,kd=i),s=e.pendingLanes,s===0&&(Qs=null),VN(r.stateNode),En(e,Ut()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Ad)throw Ad=!1,e=g1,g1=null,e;return kd&1&&e.tag!==0&&cc(),s=e.pendingLanes,s&1?e===v1?Wl++:(Wl=0,v1=e):Wl=0,va(),null}function cc(){if(Vs!==null){var e=eA(kd),t=Jn.transition,r=ut;try{if(Jn.transition=null,ut=16>e?16:e,Vs===null)var n=!1;else{if(e=Vs,Vs=null,kd=0,it&6)throw Error(he(331));var i=it;for(it|=4,Ae=e.current;Ae!==null;){var s=Ae,a=s.child;if(Ae.flags&16){var o=s.deletions;if(o!==null){for(var c=0;c<o.length;c++){var l=o[c];for(Ae=l;Ae!==null;){var u=Ae;switch(u.tag){case 0:case 11:case 15:Hl(8,u,s)}var f=u.child;if(f!==null)f.return=u,Ae=f;else for(;Ae!==null;){u=Ae;var d=u.sibling,p=u.return;if(hk(u),u===l){Ae=null;break}if(d!==null){d.return=p,Ae=d;break}Ae=p}}}var g=s.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}Ae=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Ae=a;else e:for(;Ae!==null;){if(s=Ae,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Hl(9,s,s.return)}var _=s.sibling;if(_!==null){_.return=s.return,Ae=_;break e}Ae=s.return}}var x=e.current;for(Ae=x;Ae!==null;){a=Ae;var y=a.child;if(a.subtreeFlags&2064&&y!==null)y.return=a,Ae=y;else e:for(a=x;Ae!==null;){if(o=Ae,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:M0(9,o)}}catch(T){Nt(o,o.return,T)}if(o===a){Ae=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,Ae=w;break e}Ae=o.return}}if(it=i,va(),Di&&typeof Di.onPostCommitFiberRoot=="function")try{Di.onPostCommitFiberRoot(R0,e)}catch{}n=!0}return n}finally{ut=r,Jn.transition=t}}return!1}function GE(e,t,r){t=Sc(r,t),t=tk(e,t,1),e=Ys(e,t,1),t=an(),e!==null&&(af(e,1,t),En(e,t))}function Nt(e,t,r){if(e.tag===3)GE(e,e,r);else for(;t!==null;){if(t.tag===3){GE(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Qs===null||!Qs.has(n))){e=Sc(r,e),e=rk(t,e,1),t=Ys(t,e,1),e=an(),t!==null&&(af(t,1,e),En(t,e));break}}t=t.return}}function fO(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=an(),e.pingedLanes|=e.suspendedLanes&r,hr===e&&(Sr&r)===r&&(tr===4||tr===3&&(Sr&130023424)===Sr&&500>Ut()-lx?$a(e,0):cx|=r),En(e,t)}function wk(e,t){t===0&&(e.mode&1?(t=Xf,Xf<<=1,!(Xf&130023424)&&(Xf=4194304)):t=1);var r=an();e=hs(e,t),e!==null&&(af(e,t,r),En(e,r))}function hO(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),wk(e,r)}function dO(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(he(314))}n!==null&&n.delete(t),wk(e,r)}var Tk;Tk=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||_n.current)vn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return vn=!1,eO(e,t,r);vn=!!(e.flags&131072)}else vn=!1,At&&t.flags&1048576&&kA(t,vd,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Uh(e,t),e=t.pendingProps;var i=yc(t,Gr.current);oc(t,r),i=rx(null,t,n,e,i,r);var s=nx();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,yn(n)?(s=!0,md(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Qv(t),i.updater=O0,t.stateNode=i,i._reactInternals=t,s1(t,n,e,r),t=c1(null,t,n,!0,s,r)):(t.tag=0,At&&s&&zv(t),Zr(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Uh(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=mO(n),e=ai(n,e),i){case 0:t=o1(null,t,n,e,r);break e;case 1:t=LE(null,t,n,e,r);break e;case 11:t=DE(null,t,n,e,r);break e;case 14:t=OE(null,t,n,ai(n.type,e),r);break e}throw Error(he(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ai(n,i),o1(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ai(n,i),LE(e,t,n,i,r);case 3:e:{if(ak(t),e===null)throw Error(he(387));n=t.pendingProps,s=t.memoizedState,i=s.element,bA(e,t),yd(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Sc(Error(he(423)),t),t=ME(e,t,n,r,i);break e}else if(n!==i){i=Sc(Error(he(424)),t),t=ME(e,t,n,r,i);break e}else for(Rn=Xs(t.stateNode.containerInfo.firstChild),Nn=t,At=!0,ci=null,r=DA(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ec(),n===i){t=ds(e,t,r);break e}Zr(e,t,n,r)}t=t.child}return t;case 5:return OA(t),e===null&&r1(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,Qg(n,i)?a=null:s!==null&&Qg(n,s)&&(t.flags|=32),sk(e,t),Zr(e,t,a,r),t.child;case 6:return e===null&&r1(t),null;case 13:return ok(e,t,r);case 4:return Jv(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=wc(t,null,n,r):Zr(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ai(n,i),DE(e,t,n,i,r);case 7:return Zr(e,t,t.pendingProps,r),t.child;case 8:return Zr(e,t,t.pendingProps.children,r),t.child;case 12:return Zr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,mt(xd,n._currentValue),n._currentValue=a,s!==null)if(gi(s.value,a)){if(s.children===i.children&&!_n.current){t=ds(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=as(-1,r&-r),c.tag=2;var l=s.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?c.next=c:(c.next=u.next,u.next=c),l.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),n1(s.return,r,t),o.lanes|=r;break}c=c.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(he(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),n1(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Zr(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,oc(t,r),i=Zn(i),n=n(i),t.flags|=1,Zr(e,t,n,r),t.child;case 14:return n=t.type,i=ai(n,t.pendingProps),i=ai(n.type,i),OE(e,t,n,i,r);case 15:return nk(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ai(n,i),Uh(e,t),t.tag=1,yn(n)?(e=!0,md(t)):e=!1,oc(t,r),PA(t,n,i),s1(t,n,i,r),c1(null,t,n,!0,e,r);case 19:return ck(e,t,r);case 22:return ik(e,t,r)}throw Error(he(156,t.tag))};function Sk(e,t){return YS(e,t)}function pO(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qn(e,t,r,n){return new pO(e,t,r,n)}function dx(e){return e=e.prototype,!(!e||!e.isReactComponent)}function mO(e){if(typeof e=="function")return dx(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Pv)return 11;if(e===Nv)return 14}return 2}function Zs(e,t){var r=e.alternate;return r===null?(r=Qn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function zh(e,t,r,n,i,s){var a=2;if(n=e,typeof e=="function")dx(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Bo:return Ha(r.children,i,s,t);case Fv:a=8,i|=8;break;case Rg:return e=Qn(12,r,t,i|2),e.elementType=Rg,e.lanes=s,e;case bg:return e=Qn(13,r,t,i),e.elementType=bg,e.lanes=s,e;case Fg:return e=Qn(19,r,t,i),e.elementType=Fg,e.lanes=s,e;case NS:return j0(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case FS:a=10;break e;case PS:a=9;break e;case Pv:a=11;break e;case Nv:a=14;break e;case ks:a=16,n=null;break e}throw Error(he(130,e==null?e:typeof e,""))}return t=Qn(a,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function Ha(e,t,r,n){return e=Qn(7,e,n,t),e.lanes=r,e}function j0(e,t,r,n){return e=Qn(22,e,n,t),e.elementType=NS,e.lanes=r,e.stateNode={isHidden:!1},e}function wm(e,t,r){return e=Qn(6,e,null,t),e.lanes=r,e}function Tm(e,t,r){return t=Qn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function gO(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nm(0),this.expirationTimes=nm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nm(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function px(e,t,r,n,i,s,a,o,c){return e=new gO(e,t,r,o,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Qn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qv(s),e}function vO(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:jo,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Ak(e){if(!e)return aa;e=e._reactInternals;e:{if(mo(e)!==e||e.tag!==1)throw Error(he(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(yn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(he(171))}if(e.tag===1){var r=e.type;if(yn(r))return SA(e,r,t)}return t}function kk(e,t,r,n,i,s,a,o,c){return e=px(r,n,!0,e,i,s,a,o,c),e.context=Ak(null),r=e.current,n=an(),i=Js(r),s=as(n,i),s.callback=t??null,Ys(r,s,i),e.current.lanes=i,af(e,i,n),En(e,n),e}function B0(e,t,r,n){var i=t.current,s=an(),a=Js(i);return r=Ak(r),t.context===null?t.context=r:t.pendingContext=r,t=as(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ys(i,t,a),e!==null&&(di(e,i,a,s),Vh(e,i,a)),a}function Id(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function qE(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function mx(e,t){qE(e,t),(e=e.alternate)&&qE(e,t)}function xO(){return null}var Ck=typeof reportError=="function"?reportError:function(e){console.error(e)};function gx(e){this._internalRoot=e}U0.prototype.render=gx.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(he(409));B0(e,t,null,null)};U0.prototype.unmount=gx.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Za(function(){B0(null,e,null,null)}),t[fs]=null}};function U0(e){this._internalRoot=e}U0.prototype.unstable_scheduleHydration=function(e){if(e){var t=nA();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Is.length&&t!==0&&t<Is[r].priority;r++);Is.splice(r,0,e),r===0&&sA(e)}};function vx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function $0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function KE(){}function _O(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var l=Id(a);s.call(l)}}var a=kk(t,n,e,0,null,!1,!1,"",KE);return e._reactRootContainer=a,e[fs]=a.current,xu(e.nodeType===8?e.parentNode:e),Za(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var l=Id(c);o.call(l)}}var c=px(e,0,!1,null,null,!1,!1,"",KE);return e._reactRootContainer=c,e[fs]=c.current,xu(e.nodeType===8?e.parentNode:e),Za(function(){B0(t,c,r,n)}),c}function H0(e,t,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var c=Id(a);o.call(c)}}B0(t,a,e,i)}else a=_O(r,t,e,i,n);return Id(a)}tA=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=wl(t.pendingLanes);r!==0&&(Lv(t,r|1),En(t,Ut()),!(it&6)&&(Ac=Ut()+500,va()))}break;case 13:Za(function(){var n=hs(e,1);if(n!==null){var i=an();di(n,e,1,i)}}),mx(e,1)}};Mv=function(e){if(e.tag===13){var t=hs(e,134217728);if(t!==null){var r=an();di(t,e,134217728,r)}mx(e,134217728)}};rA=function(e){if(e.tag===13){var t=Js(e),r=hs(e,t);if(r!==null){var n=an();di(r,e,t,n)}mx(e,t)}};nA=function(){return ut};iA=function(e,t){var r=ut;try{return ut=e,t()}finally{ut=r}};Ug=function(e,t,r){switch(t){case"input":if(Dg(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=N0(n);if(!i)throw Error(he(90));OS(n),Dg(n,i)}}}break;case"textarea":MS(e,r);break;case"select":t=r.value,t!=null&&nc(e,!!r.multiple,t,!1)}};zS=ux;WS=Za;var yO={usingClientEntryPoint:!1,Events:[cf,zo,N0,$S,HS,ux]},hl={findFiberByHostInstance:Da,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},EO={bundleType:hl.bundleType,version:hl.version,rendererPackageName:hl.rendererPackageName,rendererConfig:hl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_s.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=KS(e),e===null?null:e.stateNode},findFiberByHostInstance:hl.findFiberByHostInstance||xO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ah=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ah.isDisabled&&ah.supportsFiber)try{R0=ah.inject(EO),Di=ah}catch{}}jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yO;jn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vx(t))throw Error(he(200));return vO(e,t,null,r)};jn.createRoot=function(e,t){if(!vx(e))throw Error(he(299));var r=!1,n="",i=Ck;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=px(e,1,!1,null,null,r,!1,n,i),e[fs]=t.current,xu(e.nodeType===8?e.parentNode:e),new gx(t)};jn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(he(188)):(e=Object.keys(e).join(","),Error(he(268,e)));return e=KS(t),e=e===null?null:e.stateNode,e};jn.flushSync=function(e){return Za(e)};jn.hydrate=function(e,t,r){if(!$0(t))throw Error(he(200));return H0(null,e,t,!0,r)};jn.hydrateRoot=function(e,t,r){if(!vx(e))throw Error(he(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=Ck;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=kk(t,null,e,1,r??null,i,!1,s,a),e[fs]=t.current,xu(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new U0(t)};jn.render=function(e,t,r){if(!$0(t))throw Error(he(200));return H0(null,e,t,!1,r)};jn.unmountComponentAtNode=function(e){if(!$0(e))throw Error(he(40));return e._reactRootContainer?(Za(function(){H0(null,null,e,!1,function(){e._reactRootContainer=null,e[fs]=null})}),!0):!1};jn.unstable_batchedUpdates=ux;jn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!$0(r))throw Error(he(200));if(e==null||e._reactInternals===void 0)throw Error(he(38));return H0(e,t,r,!1,n)};jn.version="18.2.0-next-9e3b772b8-20220608";function Ik(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ik)}catch(e){console.error(e)}}Ik(),kS.exports=jn;var Rk=kS.exports,bk,XE=Rk;bk=XE.createRoot,XE.hydrateRoot;/**
 * @remix-run/router v1.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Cu(){return Cu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cu.apply(this,arguments)}var js;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(js||(js={}));const YE="popstate";function wO(e){e===void 0&&(e={});function t(n,i){let{pathname:s,search:a,hash:o}=n.location;return y1("",{pathname:s,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Rd(i)}return SO(t,r,null,e)}function $t(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function xx(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function TO(){return Math.random().toString(36).substr(2,8)}function QE(e,t){return{usr:e.state,key:e.key,idx:t}}function y1(e,t,r,n){return r===void 0&&(r=null),Cu({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Bc(t):t,{state:r,key:t&&t.key||n||TO()})}function Rd(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Bc(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function SO(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,a=i.history,o=js.Pop,c=null,l=u();l==null&&(l=0,a.replaceState(Cu({},a.state,{idx:l}),""));function u(){return(a.state||{idx:null}).idx}function f(){o=js.Pop;let v=u(),_=v==null?null:v-l;l=v,c&&c({action:o,location:m.location,delta:_})}function d(v,_){o=js.Push;let x=y1(m.location,v,_);r&&r(x,v),l=u()+1;let y=QE(x,l),w=m.createHref(x);try{a.pushState(y,"",w)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;i.location.assign(w)}s&&c&&c({action:o,location:m.location,delta:1})}function p(v,_){o=js.Replace;let x=y1(m.location,v,_);r&&r(x,v),l=u();let y=QE(x,l),w=m.createHref(x);a.replaceState(y,"",w),s&&c&&c({action:o,location:m.location,delta:0})}function g(v){let _=i.location.origin!=="null"?i.location.origin:i.location.href,x=typeof v=="string"?v:Rd(v);return $t(_,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,_)}let m={get action(){return o},get location(){return e(i,a)},listen(v){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(YE,f),c=v,()=>{i.removeEventListener(YE,f),c=null}},createHref(v){return t(i,v)},createURL:g,encodeLocation(v){let _=g(v);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:d,replace:p,go(v){return a.go(v)}};return m}var JE;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(JE||(JE={}));function AO(e,t,r){r===void 0&&(r="/");let n=typeof t=="string"?Bc(t):t,i=_x(n.pathname||"/",r);if(i==null)return null;let s=Fk(e);kO(s);let a=null;for(let o=0;a==null&&o<s.length;++o)a=OO(s[o],VO(i));return a}function Fk(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,a,o)=>{let c={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};c.relativePath.startsWith("/")&&($t(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let l=ea([n,c.relativePath]),u=r.concat(c);s.children&&s.children.length>0&&($t(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),Fk(s.children,t,u,l)),!(s.path==null&&!s.index)&&t.push({path:l,score:NO(l,s.index),routesMeta:u})};return e.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let c of Pk(s.path))i(s,a,c)}),t}function Pk(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let a=Pk(n.join("/")),o=[];return o.push(...a.map(c=>c===""?s:[s,c].join("/"))),i&&o.push(...a),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function kO(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:DO(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const CO=/^:\w+$/,IO=3,RO=2,bO=1,FO=10,PO=-2,ZE=e=>e==="*";function NO(e,t){let r=e.split("/"),n=r.length;return r.some(ZE)&&(n+=PO),t&&(n+=RO),r.filter(i=>!ZE(i)).reduce((i,s)=>i+(CO.test(s)?IO:s===""?bO:FO),n)}function DO(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function OO(e,t){let{routesMeta:r}=e,n={},i="/",s=[];for(let a=0;a<r.length;++a){let o=r[a],c=a===r.length-1,l=i==="/"?t:t.slice(i.length)||"/",u=LO({path:o.relativePath,caseSensitive:o.caseSensitive,end:c},l);if(!u)return null;Object.assign(n,u.params);let f=o.route;s.push({params:n,pathname:ea([i,u.pathname]),pathnameBase:$O(ea([i,u.pathnameBase])),route:f}),u.pathnameBase!=="/"&&(i=ea([i,u.pathnameBase]))}return s}function LO(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=MO(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((l,u,f)=>{let{paramName:d,isOptional:p}=u;if(d==="*"){let m=o[f]||"";a=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const g=o[f];return p&&!g?l[d]=void 0:l[d]=jO(g||"",d),l},{}),pathname:s,pathnameBase:a,pattern:e}}function MO(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),xx(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(a,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function VO(e){try{return decodeURI(e)}catch(t){return xx(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function jO(e,t){try{return decodeURIComponent(e)}catch(r){return xx(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),e}}function _x(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function BO(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?Bc(e):e;return{pathname:r?r.startsWith("/")?r:UO(r,t):t,search:HO(n),hash:zO(i)}}function UO(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Sm(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function yx(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Ex(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=Bc(e):(i=Cu({},e),$t(!i.pathname||!i.pathname.includes("?"),Sm("?","pathname","search",i)),$t(!i.pathname||!i.pathname.includes("#"),Sm("#","pathname","hash",i)),$t(!i.search||!i.search.includes("#"),Sm("#","search","hash",i)));let s=e===""||i.pathname==="",a=s?"/":i.pathname,o;if(n||a==null)o=r;else{let f=t.length-1;if(a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),f-=1;i.pathname=d.join("/")}o=f>=0?t[f]:"/"}let c=BO(i,o),l=a&&a!=="/"&&a.endsWith("/"),u=(s||a===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(l||u)&&(c.pathname+="/"),c}const ea=e=>e.join("/").replace(/\/\/+/g,"/"),$O=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),HO=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,zO=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function WO(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Nk=["post","put","patch","delete"];new Set(Nk);const GO=["get",...Nk];new Set(GO);/**
 * React Router v6.18.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bd(){return bd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bd.apply(this,arguments)}const wx=F.createContext(null),qO=F.createContext(null),Uc=F.createContext(null),z0=F.createContext(null),ys=F.createContext({outlet:null,matches:[],isDataRoute:!1}),Dk=F.createContext(null);function KO(e,t){let{relative:r}=t===void 0?{}:t;$c()||$t(!1);let{basename:n,navigator:i}=F.useContext(Uc),{hash:s,pathname:a,search:o}=Lk(e,{relative:r}),c=a;return n!=="/"&&(c=a==="/"?n:ea([n,a])),i.createHref({pathname:c,search:o,hash:s})}function $c(){return F.useContext(z0)!=null}function uf(){return $c()||$t(!1),F.useContext(z0).location}function Ok(e){F.useContext(Uc).static||F.useLayoutEffect(e)}function ar(){let{isDataRoute:e}=F.useContext(ys);return e?o3():XO()}function XO(){$c()||$t(!1);let e=F.useContext(wx),{basename:t,navigator:r}=F.useContext(Uc),{matches:n}=F.useContext(ys),{pathname:i}=uf(),s=JSON.stringify(yx(n).map(c=>c.pathnameBase)),a=F.useRef(!1);return Ok(()=>{a.current=!0}),F.useCallback(function(c,l){if(l===void 0&&(l={}),!a.current)return;if(typeof c=="number"){r.go(c);return}let u=Ex(c,JSON.parse(s),i,l.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:ea([t,u.pathname])),(l.replace?r.replace:r.push)(u,l.state,l)},[t,r,s,i,e])}function ff(){let{matches:e}=F.useContext(ys),t=e[e.length-1];return t?t.params:{}}function Lk(e,t){let{relative:r}=t===void 0?{}:t,{matches:n}=F.useContext(ys),{pathname:i}=uf(),s=JSON.stringify(yx(n).map(a=>a.pathnameBase));return F.useMemo(()=>Ex(e,JSON.parse(s),i,r==="path"),[e,s,i,r])}function YO(e,t){return QO(e,t)}function QO(e,t,r){$c()||$t(!1);let{navigator:n}=F.useContext(Uc),{matches:i}=F.useContext(ys),s=i[i.length-1],a=s?s.params:{};s&&s.pathname;let o=s?s.pathnameBase:"/";s&&s.route;let c=uf(),l;if(t){var u;let m=typeof t=="string"?Bc(t):t;o==="/"||(u=m.pathname)!=null&&u.startsWith(o)||$t(!1),l=m}else l=c;let f=l.pathname||"/",d=o==="/"?f:f.slice(o.length)||"/",p=AO(e,{pathname:d}),g=r3(p&&p.map(m=>Object.assign({},m,{params:Object.assign({},a,m.params),pathname:ea([o,n.encodeLocation?n.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?o:ea([o,n.encodeLocation?n.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),i,r);return t&&g?F.createElement(z0.Provider,{value:{location:bd({pathname:"/",search:"",hash:"",state:null,key:"default"},l),navigationType:js.Pop}},g):g}function JO(){let e=a3(),t=WO(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return F.createElement(F.Fragment,null,F.createElement("h2",null,"Unexpected Application Error!"),F.createElement("h3",{style:{fontStyle:"italic"}},t),r?F.createElement("pre",{style:i},r):null,s)}const ZO=F.createElement(JO,null);class e3 extends F.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error||r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error?F.createElement(ys.Provider,{value:this.props.routeContext},F.createElement(Dk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function t3(e){let{routeContext:t,match:r,children:n}=e,i=F.useContext(wx);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),F.createElement(ys.Provider,{value:t},n)}function r3(e,t,r){var n;if(t===void 0&&(t=[]),r===void 0&&(r=null),e==null){var i;if((i=r)!=null&&i.errors)e=r.matches;else return null}let s=e,a=(n=r)==null?void 0:n.errors;if(a!=null){let o=s.findIndex(c=>c.route.id&&(a==null?void 0:a[c.route.id]));o>=0||$t(!1),s=s.slice(0,Math.min(s.length,o+1))}return s.reduceRight((o,c,l)=>{let u=c.route.id?a==null?void 0:a[c.route.id]:null,f=null;r&&(f=c.route.errorElement||ZO);let d=t.concat(s.slice(0,l+1)),p=()=>{let g;return u?g=f:c.route.Component?g=F.createElement(c.route.Component,null):c.route.element?g=c.route.element:g=o,F.createElement(t3,{match:c,routeContext:{outlet:o,matches:d,isDataRoute:r!=null},children:g})};return r&&(c.route.ErrorBoundary||c.route.errorElement||l===0)?F.createElement(e3,{location:r.location,revalidation:r.revalidation,component:f,error:u,children:p(),routeContext:{outlet:null,matches:d,isDataRoute:!0}}):p()},null)}var Mk=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Mk||{}),Fd=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Fd||{});function n3(e){let t=F.useContext(wx);return t||$t(!1),t}function i3(e){let t=F.useContext(qO);return t||$t(!1),t}function s3(e){let t=F.useContext(ys);return t||$t(!1),t}function Vk(e){let t=s3(),r=t.matches[t.matches.length-1];return r.route.id||$t(!1),r.route.id}function a3(){var e;let t=F.useContext(Dk),r=i3(Fd.UseRouteError),n=Vk(Fd.UseRouteError);return t||((e=r.errors)==null?void 0:e[n])}function o3(){let{router:e}=n3(Mk.UseNavigateStable),t=Vk(Fd.UseNavigateStable),r=F.useRef(!1);return Ok(()=>{r.current=!0}),F.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,bd({fromRouteId:t},s)))},[e,t])}function E1(e){let{to:t,replace:r,state:n,relative:i}=e;$c()||$t(!1);let{matches:s}=F.useContext(ys),{pathname:a}=uf(),o=ar(),c=Ex(t,yx(s).map(u=>u.pathnameBase),a,i==="path"),l=JSON.stringify(c);return F.useEffect(()=>o(JSON.parse(l),{replace:r,state:n,relative:i}),[o,l,i,r,n]),null}function Sn(e){$t(!1)}function c3(e){let{basename:t="/",children:r=null,location:n,navigationType:i=js.Pop,navigator:s,static:a=!1}=e;$c()&&$t(!1);let o=t.replace(/^\/*/,"/"),c=F.useMemo(()=>({basename:o,navigator:s,static:a}),[o,s,a]);typeof n=="string"&&(n=Bc(n));let{pathname:l="/",search:u="",hash:f="",state:d=null,key:p="default"}=n,g=F.useMemo(()=>{let m=_x(l,o);return m==null?null:{location:{pathname:m,search:u,hash:f,state:d,key:p},navigationType:i}},[o,l,u,f,d,p,i]);return g==null?null:F.createElement(Uc.Provider,{value:c},F.createElement(z0.Provider,{children:r,value:g}))}function l3(e){let{children:t,location:r}=e;return YO(w1(t),r)}new Promise(()=>{});function w1(e,t){t===void 0&&(t=[]);let r=[];return F.Children.forEach(e,(n,i)=>{if(!F.isValidElement(n))return;let s=[...t,i];if(n.type===F.Fragment){r.push.apply(r,w1(n.props.children,s));return}n.type!==Sn&&$t(!1),!n.props.index||!n.props.children||$t(!1);let a={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=w1(n.props.children,s)),r.push(a)}),r}/**
 * React Router DOM v6.18.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function T1(){return T1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},T1.apply(this,arguments)}function u3(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function f3(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function h3(e,t){return e.button===0&&(!t||t==="_self")&&!f3(e)}const d3=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],p3="startTransition",ew=Cg[p3];function m3(e){let{basename:t,children:r,future:n,window:i}=e,s=F.useRef();s.current==null&&(s.current=wO({window:i,v5Compat:!0}));let a=s.current,[o,c]=F.useState({action:a.action,location:a.location}),{v7_startTransition:l}=n||{},u=F.useCallback(f=>{l&&ew?ew(()=>c(f)):c(f)},[c,l]);return F.useLayoutEffect(()=>a.listen(u),[a,u]),F.createElement(c3,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:a})}const g3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",v3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Pa=F.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:s,replace:a,state:o,target:c,to:l,preventScrollReset:u,unstable_viewTransition:f}=t,d=u3(t,d3),{basename:p}=F.useContext(Uc),g,m=!1;if(typeof l=="string"&&v3.test(l)&&(g=l,g3))try{let y=new URL(window.location.href),w=l.startsWith("//")?new URL(y.protocol+l):new URL(l),T=_x(w.pathname,p);w.origin===y.origin&&T!=null?l=T+w.search+w.hash:m=!0}catch{}let v=KO(l,{relative:i}),_=x3(l,{replace:a,state:o,target:c,preventScrollReset:u,relative:i,unstable_viewTransition:f});function x(y){n&&n(y),y.defaultPrevented||_(y)}return F.createElement("a",T1({},d,{href:g||v,onClick:m||s?n:x,ref:r,target:c}))});var tw;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(tw||(tw={}));var rw;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(rw||(rw={}));function x3(e,t){let{target:r,replace:n,state:i,preventScrollReset:s,relative:a,unstable_viewTransition:o}=t===void 0?{}:t,c=ar(),l=uf(),u=Lk(e,{relative:a});return F.useCallback(f=>{if(h3(f,r)){f.preventDefault();let d=n!==void 0?n:Rd(l)===Rd(u);c(e,{replace:d,state:i,preventScrollReset:s,relative:a,unstable_viewTransition:o})}},[l,c,u,n,i,r,e,s,a,o])}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jk=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=i&63|128):(i&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=i&63|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=i&63|128)}return t},_3=function(e){const t=[];let r=0,n=0;for(;r<e.length;){const i=e[r++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[r++];t[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=e[r++],a=e[r++],o=e[r++],c=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;t[n++]=String.fromCharCode(55296+(c>>10)),t[n++]=String.fromCharCode(56320+(c&1023))}else{const s=e[r++],a=e[r++];t[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return t.join("")},Bk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<e.length;i+=3){const s=e[i],a=i+1<e.length,o=a?e[i+1]:0,c=i+2<e.length,l=c?e[i+2]:0,u=s>>2,f=(s&3)<<4|o>>4;let d=(o&15)<<2|l>>6,p=l&63;c||(p=64,a||(d=64)),n.push(r[u],r[f],r[d],r[p])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(jk(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):_3(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<e.length;){const s=r[e.charAt(i++)],o=i<e.length?r[e.charAt(i)]:0;++i;const l=i<e.length?r[e.charAt(i)]:64;++i;const f=i<e.length?r[e.charAt(i)]:64;if(++i,s==null||o==null||l==null||f==null)throw new y3;const d=s<<2|o>>4;if(n.push(d),l!==64){const p=o<<4&240|l>>2;if(n.push(p),f!==64){const g=l<<6&192|f;n.push(g)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class y3 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const E3=function(e){const t=jk(e);return Bk.encodeByteArray(t,!0)},Pd=function(e){return E3(e).replace(/\./g,"")},Uk=function(e){try{return Bk.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w3(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T3=()=>w3().__FIREBASE_DEFAULTS__,S3=()=>{if(typeof process>"u"||typeof process.env>"u")return;const e={}.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},A3=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&Uk(e[1]);return t&&JSON.parse(t)},W0=()=>{try{return T3()||S3()||A3()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},$k=e=>{var t,r;return(r=(t=W0())===null||t===void 0?void 0:t.emulatorHosts)===null||r===void 0?void 0:r[e]},Hk=e=>{const t=$k(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),n]:[t.substring(0,r),n]},zk=()=>{var e;return(e=W0())===null||e===void 0?void 0:e.config},Wk=e=>{var t;return(t=W0())===null||t===void 0?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k3{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gk(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e),o="";return[Pd(JSON.stringify(r)),Pd(JSON.stringify(a)),o].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function C3(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(qr())}function I3(){var e;const t=(e=W0())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function R3(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function b3(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function F3(){const e=qr();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function P3(){try{return typeof indexedDB=="object"}catch{return!1}}function N3(){return new Promise((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;t(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D3="FirebaseError";class Wi extends Error{constructor(t,r,n){super(r),this.code=t,this.customData=n,this.name=D3,Object.setPrototypeOf(this,Wi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,hf.prototype.create)}}class hf{constructor(t,r,n){this.service=t,this.serviceName=r,this.errors=n}create(t,...r){const n=r[0]||{},i=`${this.service}/${t}`,s=this.errors[t],a=s?O3(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Wi(i,o,n)}}function O3(e,t){return e.replace(L3,(r,n)=>{const i=t[n];return i!=null?String(i):`<${n}?>`})}const L3=/\{\$([^}]+)}/g;function M3(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Nd(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const i of r){if(!n.includes(i))return!1;const s=e[i],a=t[i];if(nw(s)&&nw(a)){if(!Nd(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function nw(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function df(e){const t=[];for(const[r,n]of Object.entries(e))Array.isArray(n)?n.forEach(i=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function Sl(e){const t={};return e.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");t[decodeURIComponent(i)]=decodeURIComponent(s)}}),t}function Al(e){const t=e.indexOf("?");if(!t)return"";const r=e.indexOf("#",t);return e.substring(t,r>0?r:void 0)}function V3(e,t){const r=new j3(e,t);return r.subscribe.bind(r)}class j3{constructor(t,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{t(this)}).catch(n=>{this.error(n)})}next(t){this.forEachObserver(r=>{r.next(t)})}error(t){this.forEachObserver(r=>{r.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,r,n){let i;if(t===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");B3(t,["next","error","complete"])?i=t:i={next:t,error:r,complete:n},i.next===void 0&&(i.next=Am),i.error===void 0&&(i.error=Am),i.complete===void 0&&(i.complete=Am);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,t)}sendOne(t,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{r(this.observers[t])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function B3(e,t){if(typeof e!="object"||e===null)return!1;for(const r of t)if(r in e&&typeof e[r]=="function")return!0;return!1}function Am(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(e){return e&&e._delegate?e._delegate:e}class oa{constructor(t,r,n){this.name=t,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const n=new k3;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){var r;const n=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(r=t==null?void 0:t.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(H3(t))try{this.getOrInitializeService({instanceIdentifier:ba})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(t=ba){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=ba){return this.instances.has(t)}getOptions(t=ba){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(t,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&t(a,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:$3(t),options:r}),this.instances.set(t,n),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=ba){return this.component?this.component.multipleInstances?t:ba:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function $3(e){return e===ba?void 0:e}function H3(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z3{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new U3(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qe;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Qe||(Qe={}));const W3={debug:Qe.DEBUG,verbose:Qe.VERBOSE,info:Qe.INFO,warn:Qe.WARN,error:Qe.ERROR,silent:Qe.SILENT},G3=Qe.INFO,q3={[Qe.DEBUG]:"log",[Qe.VERBOSE]:"log",[Qe.INFO]:"info",[Qe.WARN]:"warn",[Qe.ERROR]:"error"},K3=(e,t,...r)=>{if(t<e.logLevel)return;const n=new Date().toISOString(),i=q3[t];if(i)console[i](`[${n}]  ${e.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Tx{constructor(t){this.name=t,this._logLevel=G3,this._logHandler=K3,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Qe))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?W3[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Qe.DEBUG,...t),this._logHandler(this,Qe.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Qe.VERBOSE,...t),this._logHandler(this,Qe.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Qe.INFO,...t),this._logHandler(this,Qe.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Qe.WARN,...t),this._logHandler(this,Qe.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Qe.ERROR,...t),this._logHandler(this,Qe.ERROR,...t)}}const X3=(e,t)=>t.some(r=>e instanceof r);let iw,sw;function Y3(){return iw||(iw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Q3(){return sw||(sw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const qk=new WeakMap,S1=new WeakMap,Kk=new WeakMap,km=new WeakMap,Sx=new WeakMap;function J3(e){const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",a)},s=()=>{r(ta(e.result)),i()},a=()=>{n(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",a)});return t.then(r=>{r instanceof IDBCursor&&qk.set(r,e)}).catch(()=>{}),Sx.set(t,e),t}function Z3(e){if(S1.has(e))return;const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",a),e.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",a),e.addEventListener("abort",a)});S1.set(e,t)}let A1={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return S1.get(e);if(t==="objectStoreNames")return e.objectStoreNames||Kk.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ta(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function eL(e){A1=e(A1)}function tL(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const n=e.call(Cm(this),t,...r);return Kk.set(n,t.sort?t.sort():[t]),ta(n)}:Q3().includes(e)?function(...t){return e.apply(Cm(this),t),ta(qk.get(this))}:function(...t){return ta(e.apply(Cm(this),t))}}function rL(e){return typeof e=="function"?tL(e):(e instanceof IDBTransaction&&Z3(e),X3(e,Y3())?new Proxy(e,A1):e)}function ta(e){if(e instanceof IDBRequest)return J3(e);if(km.has(e))return km.get(e);const t=rL(e);return t!==e&&(km.set(e,t),Sx.set(t,e)),t}const Cm=e=>Sx.get(e);function nL(e,t,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(e,t),o=ta(a);return n&&a.addEventListener("upgradeneeded",c=>{n(ta(a.result),c.oldVersion,c.newVersion,ta(a.transaction),c)}),r&&a.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),o.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),o}const iL=["get","getKey","getAll","getAllKeys","count"],sL=["put","add","delete","clear"],Im=new Map;function aw(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(Im.get(t))return Im.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,i=sL.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||iL.includes(r)))return;const s=async function(a,...o){const c=this.transaction(a,i?"readwrite":"readonly");let l=c.store;return n&&(l=l.index(o.shift())),(await Promise.all([l[r](...o),i&&c.done]))[0]};return Im.set(t,s),s}eL(e=>({...e,get:(t,r,n)=>aw(t,r)||e.get(t,r,n),has:(t,r)=>!!aw(t,r)||e.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(oL(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function oL(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const k1="@firebase/app",ow="0.9.22";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eo=new Tx("@firebase/app"),cL="@firebase/app-compat",lL="@firebase/analytics-compat",uL="@firebase/analytics",fL="@firebase/app-check-compat",hL="@firebase/app-check",dL="@firebase/auth",pL="@firebase/auth-compat",mL="@firebase/database",gL="@firebase/database-compat",vL="@firebase/functions",xL="@firebase/functions-compat",_L="@firebase/installations",yL="@firebase/installations-compat",EL="@firebase/messaging",wL="@firebase/messaging-compat",TL="@firebase/performance",SL="@firebase/performance-compat",AL="@firebase/remote-config",kL="@firebase/remote-config-compat",CL="@firebase/storage",IL="@firebase/storage-compat",RL="@firebase/firestore",bL="@firebase/firestore-compat",FL="firebase",PL="10.5.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C1="[DEFAULT]",NL={[k1]:"fire-core",[cL]:"fire-core-compat",[uL]:"fire-analytics",[lL]:"fire-analytics-compat",[hL]:"fire-app-check",[fL]:"fire-app-check-compat",[dL]:"fire-auth",[pL]:"fire-auth-compat",[mL]:"fire-rtdb",[gL]:"fire-rtdb-compat",[vL]:"fire-fn",[xL]:"fire-fn-compat",[_L]:"fire-iid",[yL]:"fire-iid-compat",[EL]:"fire-fcm",[wL]:"fire-fcm-compat",[TL]:"fire-perf",[SL]:"fire-perf-compat",[AL]:"fire-rc",[kL]:"fire-rc-compat",[CL]:"fire-gcs",[IL]:"fire-gcs-compat",[RL]:"fire-fst",[bL]:"fire-fst-compat","fire-js":"fire-js",[FL]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dd=new Map,I1=new Map;function DL(e,t){try{e.container.addComponent(t)}catch(r){eo.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function to(e){const t=e.name;if(I1.has(t))return eo.debug(`There were multiple attempts to register component ${t}.`),!1;I1.set(t,e);for(const r of Dd.values())DL(r,e);return!0}function G0(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OL={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},ra=new hf("app","Firebase",OL);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL{constructor(t,r,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new oa("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw ra.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const go=PL;function Xk(e,t={}){let r=e;typeof t!="object"&&(t={name:t});const n=Object.assign({name:C1,automaticDataCollectionEnabled:!1},t),i=n.name;if(typeof i!="string"||!i)throw ra.create("bad-app-name",{appName:String(i)});if(r||(r=zk()),!r)throw ra.create("no-options");const s=Dd.get(i);if(s){if(Nd(r,s.options)&&Nd(n,s.config))return s;throw ra.create("duplicate-app",{appName:i})}const a=new z3(i);for(const c of I1.values())a.addComponent(c);const o=new LL(r,n,a);return Dd.set(i,o),o}function Ax(e=C1){const t=Dd.get(e);if(!t&&e===C1&&zk())return Xk();if(!t)throw ra.create("no-app",{appName:e});return t}function Li(e,t,r){var n;let i=(n=NL[e])!==null&&n!==void 0?n:e;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${t}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),eo.warn(o.join(" "));return}to(new oa(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ML="firebase-heartbeat-database",VL=1,Iu="firebase-heartbeat-store";let Rm=null;function Yk(){return Rm||(Rm=nL(ML,VL,{upgrade:(e,t)=>{switch(t){case 0:e.createObjectStore(Iu)}}}).catch(e=>{throw ra.create("idb-open",{originalErrorMessage:e.message})})),Rm}async function jL(e){try{return await(await Yk()).transaction(Iu).objectStore(Iu).get(Qk(e))}catch(t){if(t instanceof Wi)eo.warn(t.message);else{const r=ra.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});eo.warn(r.message)}}}async function cw(e,t){try{const n=(await Yk()).transaction(Iu,"readwrite");await n.objectStore(Iu).put(t,Qk(e)),await n.done}catch(r){if(r instanceof Wi)eo.warn(r.message);else{const n=ra.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});eo.warn(n.message)}}}function Qk(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BL=1024,UL=30*24*60*60*1e3;class $L{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new zL(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=lw();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n)))return this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const s=new Date(i.date).valueOf();return Date.now()-s<=UL}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const t=lw(),{heartbeatsToSend:r,unsentEntries:n}=HL(this._heartbeatsCache.heartbeats),i=Pd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function lw(){return new Date().toISOString().substring(0,10)}function HL(e,t=BL){const r=[];let n=e.slice();for(const i of e){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),uw(r)>t){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),uw(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class zL{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return P3()?N3().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await jL(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(t){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return cw(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return cw(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function uw(e){return Pd(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WL(e){to(new oa("platform-logger",t=>new aL(t),"PRIVATE")),to(new oa("heartbeat",t=>new $L(t),"PRIVATE")),Li(k1,ow,e),Li(k1,ow,"esm2017"),Li("fire-js","")}WL("");function kx(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Jk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const GL=Jk,Zk=new hf("auth","Firebase",Jk());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Od=new Tx("@firebase/auth");function qL(e,...t){Od.logLevel<=Qe.WARN&&Od.warn(`Auth (${go}): ${e}`,...t)}function Wh(e,...t){Od.logLevel<=Qe.ERROR&&Od.error(`Auth (${go}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vi(e,...t){throw Cx(e,...t)}function Mi(e,...t){return Cx(e,...t)}function KL(e,t,r){const n=Object.assign(Object.assign({},GL()),{[t]:r});return new hf("auth","Firebase",n).create(t,{appName:e.name})}function Cx(e,...t){if(typeof e!="string"){const r=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(r,...n)}return Zk.create(e,...t)}function Oe(e,t,...r){if(!e)throw Cx(t,...r)}function rs(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Wh(t),new Error(t)}function ps(e,t){e||rs(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R1(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.href)||""}function XL(){return fw()==="http:"||fw()==="https:"}function fw(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(XL()||R3()||"connection"in navigator)?navigator.onLine:!0}function QL(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(t,r){this.shortDelay=t,this.longDelay=r,ps(r>t,"Short delay should be less than long delay!"),this.isMobile=C3()||b3()}get(){return YL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ix(e,t){ps(e.emulator,"Emulator should always be set here");const{url:r}=e.emulator;return t?`${r}${t.startsWith("/")?t.slice(1):t}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{static initialize(t,r,n){this.fetchImpl=t,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;rs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;rs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;rs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZL=new pf(3e4,6e4);function vo(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function xo(e,t,r,n,i={}){return tC(e,i,async()=>{let s={},a={};n&&(t==="GET"?a=n:s={body:JSON.stringify(n)});const o=df(Object.assign({key:e.config.apiKey},a)).slice(1),c=await e._getAdditionalHeaders();return c["Content-Type"]="application/json",e.languageCode&&(c["X-Firebase-Locale"]=e.languageCode),eC.fetch()(rC(e,e.config.apiHost,r,o),Object.assign({method:t,headers:c,referrerPolicy:"no-referrer"},s))})}async function tC(e,t,r){e._canInitEmulator=!1;const n=Object.assign(Object.assign({},JL),t);try{const i=new tM(e),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw oh(e,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[c,l]=o.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw oh(e,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw oh(e,"email-already-in-use",a);if(c==="USER_DISABLED")throw oh(e,"user-disabled",a);const u=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw KL(e,u,l);vi(e,u)}}catch(i){if(i instanceof Wi)throw i;vi(e,"network-request-failed",{message:String(i)})}}async function mf(e,t,r,n,i={}){const s=await xo(e,t,r,n,i);return"mfaPendingCredential"in s&&vi(e,"multi-factor-auth-required",{_serverResponse:s}),s}function rC(e,t,r,n){const i=`${t}${r}?${n}`;return e.config.emulator?Ix(e.config,i):`${e.config.apiScheme}://${i}`}function eM(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class tM{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Mi(this.auth,"network-request-failed")),ZL.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function oh(e,t,r){const n={appName:e.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Mi(e,t,n);return i.customData._tokenResponse=r,i}function hw(e){return e!==void 0&&e.enterprise!==void 0}class rM{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],t.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===t)return eM(r.enforcementState);return null}isProviderEnabled(t){return this.getProviderEnforcementState(t)==="ENFORCE"||this.getProviderEnforcementState(t)==="AUDIT"}}async function nM(e,t){return xo(e,"GET","/v2/recaptchaConfig",vo(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iM(e,t){return xo(e,"POST","/v1/accounts:delete",t)}async function sM(e,t){return xo(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gl(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function aM(e,t=!1){const r=Ht(e),n=await r.getIdToken(t),i=Rx(n);Oe(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:Gl(bm(i.auth_time)),issuedAtTime:Gl(bm(i.iat)),expirationTime:Gl(bm(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function bm(e){return Number(e)*1e3}function Rx(e){const[t,r,n]=e.split(".");if(t===void 0||r===void 0||n===void 0)return Wh("JWT malformed, contained fewer than 3 sections"),null;try{const i=Uk(r);return i?JSON.parse(i):(Wh("Failed to decode base64 JWT payload"),null)}catch(i){return Wh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function oM(e){const t=Rx(e);return Oe(t,"internal-error"),Oe(typeof t.exp<"u","internal-error"),Oe(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ru(e,t,r=!1){if(r)return t;try{return await t}catch(n){throw n instanceof Wi&&cM(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}function cM({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lM{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var r;if(t){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(t=!1){if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(t,r){this.createdAt=t,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Gl(this.lastLoginAt),this.creationTime=Gl(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ld(e){var t;const r=e.auth,n=await e.getIdToken(),i=await Ru(e,sM(r,{idToken:n}));Oe(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const a=!((t=s.providerUserInfo)===null||t===void 0)&&t.length?hM(s.providerUserInfo):[],o=fM(e.providerData,a),c=e.isAnonymous,l=!(e.email&&s.passwordHash)&&!(o!=null&&o.length),u=c?l:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new nC(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(e,f)}async function uM(e){const t=Ht(e);await Ld(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function fM(e,t){return[...e.filter(n=>!t.some(i=>i.providerId===n.providerId)),...t]}function hM(e){return e.map(t=>{var{providerId:r}=t,n=kx(t,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dM(e,t){const r=await tC(e,{},async()=>{const n=df({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:s}=e.config,a=rC(e,i,"/v1/token",`key=${s}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",eC.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Oe(t.idToken,"internal-error"),Oe(typeof t.idToken<"u","internal-error"),Oe(typeof t.refreshToken<"u","internal-error");const r="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):oM(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,r)}async getToken(t,r=!1){return Oe(!this.accessToken||this.refreshToken,t,"user-token-expired"),!r&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(t,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await dM(t,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(t,r,n){this.refreshToken=r||null,this.accessToken=t||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(t,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new bu;return n&&(Oe(typeof n=="string","internal-error",{appName:t}),a.refreshToken=n),i&&(Oe(typeof i=="string","internal-error",{appName:t}),a.accessToken=i),s&&(Oe(typeof s=="number","internal-error",{appName:t}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new bu,this.toJSON())}_performRefresh(){return rs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ts(e,t){Oe(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class za{constructor(t){var{uid:r,auth:n,stsTokenManager:i}=t,s=kx(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new lM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new nC(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const r=await Ru(this,this.stsTokenManager.getToken(this.auth,t));return Oe(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(t){return aM(this,t)}reload(){return uM(this)}_assign(t){this!==t&&(Oe(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(r=>Object.assign({},r)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const r=new za(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(t){Oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,r=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),r&&await Ld(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await Ru(this,iM(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,r){var n,i,s,a,o,c,l,u;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,d=(i=r.email)!==null&&i!==void 0?i:void 0,p=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,g=(a=r.photoURL)!==null&&a!==void 0?a:void 0,m=(o=r.tenantId)!==null&&o!==void 0?o:void 0,v=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,_=(l=r.createdAt)!==null&&l!==void 0?l:void 0,x=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:y,emailVerified:w,isAnonymous:T,providerData:S,stsTokenManager:E}=r;Oe(y&&E,t,"internal-error");const k=bu.fromJSON(this.name,E);Oe(typeof y=="string",t,"internal-error"),Ts(f,t.name),Ts(d,t.name),Oe(typeof w=="boolean",t,"internal-error"),Oe(typeof T=="boolean",t,"internal-error"),Ts(p,t.name),Ts(g,t.name),Ts(m,t.name),Ts(v,t.name),Ts(_,t.name),Ts(x,t.name);const b=new za({uid:y,auth:t,email:d,emailVerified:w,displayName:f,isAnonymous:T,photoURL:g,phoneNumber:p,tenantId:m,stsTokenManager:k,createdAt:_,lastLoginAt:x});return S&&Array.isArray(S)&&(b.providerData=S.map(j=>Object.assign({},j))),v&&(b._redirectEventId=v),b}static async _fromIdTokenResponse(t,r,n=!1){const i=new bu;i.updateFromServerResponse(r);const s=new za({uid:r.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await Ld(s),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dw=new Map;function ns(e){ps(e instanceof Function,"Expected a class definition");let t=dw.get(e);return t?(ps(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,dw.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){const r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}iC.type="NONE";const pw=iC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gh(e,t,r){return`firebase:${e}:${t}:${r}`}class lc{constructor(t,r,n){this.persistence=t,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Gh(this.userKey,i.apiKey,s),this.fullPersistenceKey=Gh("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?za._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,r,n="authUser"){if(!r.length)return new lc(ns(pw),t,n);const i=(await Promise.all(r.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let s=i[0]||ns(pw);const a=Gh(n,t.config.apiKey,t.name);let o=null;for(const l of r)try{const u=await l._get(a);if(u){const f=za._fromJSON(t,u);l!==s&&(o=f),s=l;break}}catch{}const c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new lc(s,t,n):(s=c[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async l=>{if(l!==s)try{await l._remove(a)}catch{}})),new lc(s,t,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(oC(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(sC(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(lC(t))return"Blackberry";if(uC(t))return"Webos";if(bx(t))return"Safari";if((t.includes("chrome/")||aC(t))&&!t.includes("edge/"))return"Chrome";if(cC(t))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function sC(e=qr()){return/firefox\//i.test(e)}function bx(e=qr()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function aC(e=qr()){return/crios\//i.test(e)}function oC(e=qr()){return/iemobile/i.test(e)}function cC(e=qr()){return/android/i.test(e)}function lC(e=qr()){return/blackberry/i.test(e)}function uC(e=qr()){return/webos/i.test(e)}function q0(e=qr()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function pM(e=qr()){var t;return q0(e)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function mM(){return F3()&&document.documentMode===10}function fC(e=qr()){return q0(e)||cC(e)||uC(e)||lC(e)||/windows phone/i.test(e)||oC(e)}function gM(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hC(e,t=[]){let r;switch(e){case"Browser":r=mw(qr());break;case"Worker":r=`${mw(qr())}-${e}`;break;default:r=e}const n=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${go}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,r){const n=s=>new Promise((a,o)=>{try{const c=t(s);a(c)}catch(c){o(c)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const r=[];try{for(const n of this.queue)await n(t),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xM(e,t={}){return xo(e,"GET","/v2/passwordPolicy",vo(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _M=6;class yM{constructor(t){var r,n,i,s;const a=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:_M,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=t.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=t.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var r,n,i,s,a,o;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,c),this.validatePasswordCharacterOptions(t,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsNumericCharacter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(o=c.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),c}validatePasswordLengthOptions(t,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=t.length>=n),i&&(r.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<t.length;i++)n=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EM{constructor(t,r,n,i){this.app=t,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gw(this),this.idTokenSubscription=new gw(this),this.beforeStateQueue=new vM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Zk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,r){return r&&(this._popupRedirectResolver=ns(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await lc.create(this,t),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUser(t){var r;const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(t);(!a||a===o)&&(c!=null&&c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(t){try{await Ld(t)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=QL()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const r=t?Ht(t):null;return r&&Oe(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(t,r=!1){if(!this._deleted)return t&&Oe(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(t){return this.queue(async()=>{await this.assertedPersistence.setPersistence(ns(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await xM(this),r=new yM(t);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new hf("auth","Firebase",t())}onAuthStateChanged(t,r,n){return this.registerStateListener(this.authStateSubscription,t,r,n)}beforeAuthStateChanged(t,r){return this.beforeStateQueue.pushCallback(t,r)}onIdTokenChanged(t,r,n){return this.registerStateListener(this.idTokenSubscription,t,r,n)}authStateReady(){return new Promise((t,r)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged(()=>{n(),t()},r)}})}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,r){const n=await this.getOrInitRedirectPersistenceManager(r);return t===null?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const r=t&&ns(t)||this._popupRedirectResolver;Oe(r,this,"argument-error"),this.redirectPersistenceManager=await lc.create(this,[ns(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===t?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Oe(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const c=t.addObserver(r,n,i);return()=>{a=!0,c()}}else{const c=t.addObserver(r);return()=>{a=!0,c()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=hC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var t;const r=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return r!=null&&r.error&&qL(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function _o(e){return Ht(e)}class gw{constructor(t){this.auth=t,this.observer=null,this.addObserver=V3(r=>this.observer=r)}get next(){return Oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wM(){var e,t;return(t=(e=document.getElementsByTagName("head"))===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:document}function dC(e){return new Promise((t,r)=>{const n=document.createElement("script");n.setAttribute("src",e),n.onload=t,n.onerror=i=>{const s=Mi("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",wM().appendChild(n)})}function TM(e){return`__${e}${Math.floor(Math.random()*1e6)}`}const SM="https://www.google.com/recaptcha/enterprise.js?render=",AM="recaptcha-enterprise",kM="NO_RECAPTCHA";class CM{constructor(t){this.type=AM,this.auth=_o(t)}async verify(t="verify",r=!1){async function n(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,o)=>{nM(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const l=new rM(c);return s.tenantId==null?s._agentRecaptchaConfig=l:s._tenantRecaptchaConfigs[s.tenantId]=l,a(l.siteKey)}}).catch(c=>{o(c)})})}function i(s,a,o){const c=window.grecaptcha;hw(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:t}).then(l=>{a(l)}).catch(()=>{a(kM)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{n(this.auth).then(o=>{if(!r&&hw(window.grecaptcha))i(o,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}dC(SM+o).then(()=>{i(o,s,a)}).catch(c=>{a(c)})}}).catch(o=>{a(o)})})}}async function vw(e,t,r,n=!1){const i=new CM(e);let s;try{s=await i.verify(r)}catch{s=await i.verify(r,!0)}const a=Object.assign({},t);return n?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function pC(e,t,r,n){var i;if(!((i=e._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await vw(e,t,r,r==="getOobCode");return n(e,s)}else return n(e,t).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await vw(e,t,r,r==="getOobCode");return n(e,a)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IM(e,t){const r=G0(e,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(Nd(s,t??{}))return i;vi(i,"already-initialized")}return r.initialize({options:t})}function RM(e,t){const r=(t==null?void 0:t.persistence)||[],n=(Array.isArray(r)?r:[r]).map(ns);t!=null&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(n,t==null?void 0:t.popupRedirectResolver)}function bM(e,t,r){const n=_o(e);Oe(n._canInitEmulator,n,"emulator-config-failed"),Oe(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");const i=!!(r!=null&&r.disableWarnings),s=mC(t),{host:a,port:o}=FM(t),c=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${c}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||PM()}function mC(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function FM(e){const t=mC(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:xw(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:xw(a)}}}function xw(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function PM(){function e(){const t=document.createElement("p"),r=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fx{constructor(t,r){this.providerId=t,this.signInMethod=r}toJSON(){return rs("not implemented")}_getIdTokenResponse(t){return rs("not implemented")}_linkToIdToken(t,r){return rs("not implemented")}_getReauthenticationResolver(t){return rs("not implemented")}}async function NM(e,t){return xo(e,"POST","/v1/accounts:update",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DM(e,t){return mf(e,"POST","/v1/accounts:signInWithPassword",vo(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OM(e,t){return mf(e,"POST","/v1/accounts:signInWithEmailLink",vo(e,t))}async function LM(e,t){return mf(e,"POST","/v1/accounts:signInWithEmailLink",vo(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu extends Fx{constructor(t,r,n,i=null){super("password",n),this._email=t,this._password=r,this._tenantId=i}static _fromEmailAndPassword(t,r){return new Fu(t,r,"password")}static _fromEmailAndCode(t,r,n=null){return new Fu(t,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return pC(t,r,"signInWithPassword",DM);case"emailLink":return OM(t,{email:this._email,oobCode:this._password});default:vi(t,"internal-error")}}async _linkToIdToken(t,r){switch(this.signInMethod){case"password":return NM(t,{idToken:r,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return LM(t,{idToken:r,email:this._email,oobCode:this._password});default:vi(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uc(e,t){return mf(e,"POST","/v1/accounts:signInWithIdp",vo(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MM="http://localhost";class ro extends Fx{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const r=new ro(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(r.idToken=t.idToken),t.accessToken&&(r.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(r.nonce=t.nonce),t.pendingToken&&(r.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(r.accessToken=t.oauthToken,r.secret=t.oauthTokenSecret):vi("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t,{providerId:n,signInMethod:i}=r,s=kx(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new ro(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(t){const r=this.buildRequest();return uc(t,r)}_linkToIdToken(t,r){const n=this.buildRequest();return n.idToken=r,uc(t,n)}_getReauthenticationResolver(t){const r=this.buildRequest();return r.autoCreate=!1,uc(t,r)}buildRequest(){const t={requestUri:MM,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),t.postBody=df(r)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VM(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function jM(e){const t=Sl(Al(e)).link,r=t?Sl(Al(t)).deep_link_id:null,n=Sl(Al(e)).deep_link_id;return(n?Sl(Al(n)).link:null)||n||r||t||e}class Px{constructor(t){var r,n,i,s,a,o;const c=Sl(Al(t)),l=(r=c.apiKey)!==null&&r!==void 0?r:null,u=(n=c.oobCode)!==null&&n!==void 0?n:null,f=VM((i=c.mode)!==null&&i!==void 0?i:null);Oe(l&&u&&f,"argument-error"),this.apiKey=l,this.operation=f,this.code=u,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=c.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(o=c.tenantId)!==null&&o!==void 0?o:null}static parseLink(t){const r=jM(t);try{return new Px(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{constructor(){this.providerId=Hc.PROVIDER_ID}static credential(t,r){return Fu._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){const n=Px.parseLink(r);return Oe(n,"argument-error"),Fu._fromEmailAndCode(t,n.code,n.tenantId)}}Hc.PROVIDER_ID="password";Hc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Hc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf extends gC{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs extends gf{constructor(){super("facebook.com")}static credential(t){return ro._fromParams({providerId:bs.PROVIDER_ID,signInMethod:bs.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return bs.credentialFromTaggedObject(t)}static credentialFromError(t){return bs.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return bs.credential(t.oauthAccessToken)}catch{return null}}}bs.FACEBOOK_SIGN_IN_METHOD="facebook.com";bs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs extends gf{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return ro._fromParams({providerId:Fs.PROVIDER_ID,signInMethod:Fs.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return Fs.credentialFromTaggedObject(t)}static credentialFromError(t){return Fs.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:r,oauthAccessToken:n}=t;if(!r&&!n)return null;try{return Fs.credential(r,n)}catch{return null}}}Fs.GOOGLE_SIGN_IN_METHOD="google.com";Fs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps extends gf{constructor(){super("github.com")}static credential(t){return ro._fromParams({providerId:Ps.PROVIDER_ID,signInMethod:Ps.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Ps.credentialFromTaggedObject(t)}static credentialFromError(t){return Ps.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Ps.credential(t.oauthAccessToken)}catch{return null}}}Ps.GITHUB_SIGN_IN_METHOD="github.com";Ps.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns extends gf{constructor(){super("twitter.com")}static credential(t,r){return ro._fromParams({providerId:Ns.PROVIDER_ID,signInMethod:Ns.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return Ns.credentialFromTaggedObject(t)}static credentialFromError(t){return Ns.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=t;if(!r||!n)return null;try{return Ns.credential(r,n)}catch{return null}}}Ns.TWITTER_SIGN_IN_METHOD="twitter.com";Ns.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BM(e,t){return mf(e,"POST","/v1/accounts:signUp",vo(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,r,n,i=!1){const s=await za._fromIdTokenResponse(t,n,i),a=_w(n);return new no({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(t,r,n){await t._updateTokensIfNecessary(n,!0);const i=_w(n);return new no({user:t,providerId:i,_tokenResponse:n,operationType:r})}}function _w(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md extends Wi{constructor(t,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Md.prototype),this.customData={appName:t.name,tenantId:(s=t.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,r,n,i){return new Md(t,r,n,i)}}function vC(e,t,r,n){return(t==="reauthenticate"?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Md._fromErrorAndOperation(e,s,t,n):s})}async function UM(e,t,r=!1){const n=await Ru(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return no._forOperation(e,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $M(e,t,r=!1){const{auth:n}=e,i="reauthenticate";try{const s=await Ru(e,vC(n,i,t,e),r);Oe(s.idToken,n,"internal-error");const a=Rx(s.idToken);Oe(a,n,"internal-error");const{sub:o}=a;return Oe(e.uid===o,n,"user-mismatch"),no._forOperation(e,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&vi(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xC(e,t,r=!1){const n="signIn",i=await vC(e,n,t),s=await no._fromIdTokenResponse(e,n,i);return r||await e._updateCurrentUser(s.user),s}async function HM(e,t){return xC(_o(e),t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _C(e){const t=_o(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function zM(e,t,r){const n=_o(e),a=await pC(n,{returnSecureToken:!0,email:t,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",BM).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&_C(e),c}),o=await no._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(o.user),o}function WM(e,t,r){return HM(Ht(e),Hc.credential(t,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&_C(e),n})}function GM(e,t,r,n){return Ht(e).onIdTokenChanged(t,r,n)}function qM(e,t,r){return Ht(e).beforeAuthStateChanged(t,r)}function KM(e){return Ht(e).signOut()}const Vd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(t,r){this.storageRetriever=t,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Vd,"1"),this.storage.removeItem(Vd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,r){return this.storage.setItem(t,JSON.stringify(r)),Promise.resolve()}_get(t){const r=this.storage.getItem(t);return Promise.resolve(r?JSON.parse(r):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XM(){const e=qr();return bx(e)||q0(e)}const YM=1e3,QM=10;class EC extends yC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=XM()&&gM(),this.fallbackToPolling=fC(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&t(r,i,n)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,o,c)=>{this.notifyListeners(a,c)});return}const n=t.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(n);if(t.newValue!==a)t.newValue!==null?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!r)return}const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);mM()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,QM):i()}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:n}),!0)})},YM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){const r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}EC.type="LOCAL";const JM=EC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC extends yC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}wC.type="SESSION";const TC=wC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZM(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const r=this.receivers.find(i=>i.isListeningto(t));if(r)return r;const n=new K0(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const r=t,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async l=>l(r.origin,s)),c=await ZM(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:c})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}K0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nx(e="",t=10){let r="";for(let n=0;n<t;n++)r+=Math.floor(Math.random()*10);return e+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,c)=>{const l=Nx("",20);i.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(f){const d=f;if(d.data.eventId===l)switch(d.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(d.data.response);break;default:clearTimeout(u),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:t,eventId:l,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vi(){return window}function t6(e){Vi().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SC(){return typeof Vi().WorkerGlobalScope<"u"&&typeof Vi().importScripts=="function"}async function r6(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function n6(){var e;return((e=navigator==null?void 0:navigator.serviceWorker)===null||e===void 0?void 0:e.controller)||null}function i6(){return SC()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC="firebaseLocalStorageDb",s6=1,jd="firebaseLocalStorage",kC="fbase_key";class vf{constructor(t){this.request=t}toPromise(){return new Promise((t,r)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function X0(e,t){return e.transaction([jd],t?"readwrite":"readonly").objectStore(jd)}function a6(){const e=indexedDB.deleteDatabase(AC);return new vf(e).toPromise()}function b1(){const e=indexedDB.open(AC,s6);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{const n=e.result;try{n.createObjectStore(jd,{keyPath:kC})}catch(i){r(i)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(jd)?t(n):(n.close(),await a6(),t(await b1()))})})}async function yw(e,t,r){const n=X0(e,!0).put({[kC]:t,value:r});return new vf(n).toPromise()}async function o6(e,t){const r=X0(e,!1).get(t),n=await new vf(r).toPromise();return n===void 0?null:n.value}function Ew(e,t){const r=X0(e,!0).delete(t);return new vf(r).toPromise()}const c6=800,l6=3;class CC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await b1(),this.db)}async _withRetries(t){let r=0;for(;;)try{const n=await this._openDb();return await t(n)}catch(n){if(r++>l6)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return SC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=K0._getInstance(i6()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await r6(),!this.activeServiceWorker)return;this.sender=new e6(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((t=n[0])===null||t===void 0)&&t.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||n6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await b1();return await yw(t,Vd,"1"),await Ew(t,Vd),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>yw(n,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){const r=await this._withRetries(n=>o6(n,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Ew(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(i=>{const s=X0(i,!1).getAll();return new vf(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;for(const{fbase_key:i,value:s}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),c6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}CC.type="LOCAL";const u6=CC;new pf(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f6(e,t){return t?ns(t):(Oe(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx extends Fx{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return uc(t,this._buildIdpRequest())}_linkToIdToken(t,r){return uc(t,this._buildIdpRequest(r))}_getReauthenticationResolver(t){return uc(t,this._buildIdpRequest())}_buildIdpRequest(t){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(r.idToken=t),r}}function h6(e){return xC(e.auth,new Dx(e),e.bypassAuthState)}function d6(e){const{auth:t,user:r}=e;return Oe(r,t,"internal-error"),$M(r,new Dx(e),e.bypassAuthState)}async function p6(e){const{auth:t,user:r}=e;return Oe(r,t,"internal-error"),UM(r,new Dx(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(t,r,n,i,s=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(t,r)=>{this.pendingPromise={resolve:t,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(t){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=t;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(c))}catch(l){this.reject(l)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return h6;case"linkViaPopup":case"linkViaRedirect":return p6;case"reauthViaPopup":case"reauthViaRedirect":return d6;default:vi(this.auth,"internal-error")}}resolve(t){ps(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){ps(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m6=new pf(2e3,1e4);class Qo extends IC{constructor(t,r,n,i,s){super(t,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Qo.currentPopupAction&&Qo.currentPopupAction.cancel(),Qo.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Oe(t,this.auth,"internal-error"),t}async onExecution(){ps(this.filter.length===1,"Popup operations only handle one event");const t=Nx();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Mi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(Mi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qo.currentPopupAction=null}pollUserCancellation(){const t=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Mi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,m6.get())};t()}}Qo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g6="pendingRedirect",qh=new Map;class v6 extends IC{constructor(t,r,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let t=qh.get(this.auth._key());if(!t){try{const n=await x6(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(n)}catch(r){t=()=>Promise.reject(r)}qh.set(this.auth._key(),t)}return this.bypassAuthState||qh.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const r=await this.auth._redirectUserForId(t.eventId);if(r)return this.user=r,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function x6(e,t){const r=E6(t),n=y6(e);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function _6(e,t){qh.set(e._key(),t)}function y6(e){return ns(e._redirectPersistence)}function E6(e){return Gh(g6,e.config.apiKey,e.name)}async function w6(e,t,r=!1){const n=_o(e),i=f6(n,t),a=await new v6(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,t)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T6=10*60*1e3;class S6{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(r=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!A6(t)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=t,r=!0)),r}sendToConsumer(t,r){var n;if(t.error&&!RC(t)){const i=((n=t.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Mi(this.auth,i))}else r.onAuthEvent(t)}isEventForConsumer(t,r){const n=r.eventId===null||!!t.eventId&&t.eventId===r.eventId;return r.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=T6&&this.cachedEventUids.clear(),this.cachedEventUids.has(ww(t))}saveEventToCache(t){this.cachedEventUids.add(ww(t)),this.lastProcessedEventTime=Date.now()}}function ww(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function RC({type:e,error:t}){return e==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function A6(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return RC(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k6(e,t={}){return xo(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C6=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,I6=/^https?/;async function R6(e){if(e.config.emulator)return;const{authorizedDomains:t}=await k6(e);for(const r of t)try{if(b6(r))return}catch{}vi(e,"unauthorized-domain")}function b6(e){const t=R1(),{protocol:r,hostname:n}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return a.hostname===""&&n===""?r==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!I6.test(r))return!1;if(C6.test(e))return n===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F6=new pf(3e4,6e4);function Tw(){const e=Vi().___jsl;if(e!=null&&e.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}}function P6(e){return new Promise((t,r)=>{var n,i,s;function a(){Tw(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Tw(),r(Mi(e,"network-request-failed"))},timeout:F6.get()})}if(!((i=(n=Vi().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)t(gapi.iframes.getContext());else if(!((s=Vi().gapi)===null||s===void 0)&&s.load)a();else{const o=TM("iframefcb");return Vi()[o]=()=>{gapi.load?a():r(Mi(e,"network-request-failed"))},dC(`https://apis.google.com/js/api.js?onload=${o}`).catch(c=>r(c))}}).catch(t=>{throw Kh=null,t})}let Kh=null;function N6(e){return Kh=Kh||P6(e),Kh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D6=new pf(5e3,15e3),O6="__/auth/iframe",L6="emulator/auth/iframe",M6={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},V6=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function j6(e){const t=e.config;Oe(t.authDomain,e,"auth-domain-config-required");const r=t.emulator?Ix(t,L6):`https://${e.config.authDomain}/${O6}`,n={apiKey:t.apiKey,appName:e.name,v:go},i=V6.get(e.config.apiHost);i&&(n.eid=i);const s=e._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${df(n).slice(1)}`}async function B6(e){const t=await N6(e),r=Vi().gapi;return Oe(r,e,"internal-error"),t.open({where:document.body,url:j6(e),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:M6,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=Mi(e,"network-request-failed"),o=Vi().setTimeout(()=>{s(a)},D6.get());function c(){Vi().clearTimeout(o),i(n)}n.ping(c).then(c,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U6={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},$6=500,H6=600,z6="_blank",W6="http://localhost";class Sw{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function G6(e,t,r,n=$6,i=H6){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const c=Object.assign(Object.assign({},U6),{width:n.toString(),height:i.toString(),top:s,left:a}),l=qr().toLowerCase();r&&(o=aC(l)?z6:r),sC(l)&&(t=t||W6,c.scrollbars="yes");const u=Object.entries(c).reduce((d,[p,g])=>`${d}${p}=${g},`,"");if(pM(l)&&o!=="_self")return q6(t||"",o),new Sw(null);const f=window.open(t||"",o,u);Oe(f,e,"popup-blocked");try{f.focus()}catch{}return new Sw(f)}function q6(e,t){const r=document.createElement("a");r.href=e,r.target=t;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K6="__/auth/handler",X6="emulator/auth/handler",Y6=encodeURIComponent("fac");async function Aw(e,t,r,n,i,s){Oe(e.config.authDomain,e,"auth-domain-config-required"),Oe(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:n,v:go,eventId:i};if(t instanceof gC){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",M3(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,f]of Object.entries(s||{}))a[u]=f}if(t instanceof gf){const u=t.getScopes().filter(f=>f!=="");u.length>0&&(a.scopes=u.join(","))}e.tenantId&&(a.tid=e.tenantId);const o=a;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const c=await e._getAppCheckToken(),l=c?`#${Y6}=${encodeURIComponent(c)}`:"";return`${Q6(e)}?${df(o).slice(1)}${l}`}function Q6({config:e}){return e.emulator?Ix(e,X6):`https://${e.authDomain}/${K6}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm="webStorageSupport";class J6{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=TC,this._completeRedirectFn=w6,this._overrideRedirectResult=_6}async _openPopup(t,r,n,i){var s;ps((s=this.eventManagers[t._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await Aw(t,r,n,R1(),i);return G6(t,a,Nx())}async _openRedirect(t,r,n,i){await this._originValidation(t);const s=await Aw(t,r,n,R1(),i);return t6(s),new Promise(()=>{})}_initialize(t){const r=t._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(ps(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(t);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(t){const r=await B6(t),n=new S6(t);return r.register("authEvent",i=>(Oe(i==null?void 0:i.authEvent,t,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=r,n}_isIframeWebStorageSupported(t,r){this.iframes[t._key()].send(Fm,{type:Fm},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Fm];a!==void 0&&r(!!a),vi(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const r=t._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=R6(t)),this.originValidationPromises[r]}get _shouldInitProactively(){return fC()||bx()||q0()}}const Z6=J6;var kw="@firebase/auth",Cw="1.3.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e5{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const r=this.auth.onIdTokenChanged(n=>{t((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,r),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const r=this.internalListeners.get(t);r&&(this.internalListeners.delete(t),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t5(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function r5(e){to(new oa("auth",(t,{options:r})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Oe(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:a,authDomain:o,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hC(e)},l=new EM(n,i,s,c);return RM(l,r),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,r,n)=>{t.getProvider("auth-internal").initialize()})),to(new oa("auth-internal",t=>{const r=_o(t.getProvider("auth").getImmediate());return(n=>new e5(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Li(kw,Cw,t5(e)),Li(kw,Cw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n5=5*60,i5=Wk("authIdTokenMaxAge")||n5;let Iw=null;const s5=e=>async t=>{const r=t&&await t.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>i5)return;const i=r==null?void 0:r.token;Iw!==i&&(Iw=i,await fetch(e,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function a5(e=Ax()){const t=G0(e,"auth");if(t.isInitialized())return t.getImmediate();const r=IM(e,{popupRedirectResolver:Z6,persistence:[u6,JM,TC]}),n=Wk("authTokenSyncURL");if(n){const s=s5(n);qM(r,s,()=>s(r.currentUser)),GM(r,a=>s(a))}const i=$k("auth");return i&&bM(r,`http://${i}`),r}r5("Browser");var o5="firebase",c5="10.5.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Li(o5,c5,"app");var l5=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ee,Ox=Ox||{},Me=l5||self;function Y0(e){var t=typeof e;return t=t!="object"?t:e?Array.isArray(e)?"array":t:"null",t=="array"||t=="object"&&typeof e.length=="number"}function xf(e){var t=typeof e;return t=="object"&&e!=null||t=="function"}function u5(e){return Object.prototype.hasOwnProperty.call(e,Pm)&&e[Pm]||(e[Pm]=++f5)}var Pm="closure_uid_"+(1e9*Math.random()>>>0),f5=0;function h5(e,t,r){return e.call.apply(e.bind,arguments)}function d5(e,t,r){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),e.apply(t,i)}}return function(){return e.apply(t,arguments)}}function Hr(e,t,r){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Hr=h5:Hr=d5,Hr.apply(null,arguments)}function ch(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var n=r.slice();return n.push.apply(n,arguments),e.apply(this,n)}}function mr(e,t){function r(){}r.prototype=t.prototype,e.$=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.ac=function(n,i,s){for(var a=Array(arguments.length-2),o=2;o<arguments.length;o++)a[o-2]=arguments[o];return t.prototype[i].apply(n,a)}}function xa(){this.s=this.s,this.o=this.o}var p5=0;xa.prototype.s=!1;xa.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),p5!=0)&&u5(this)};xa.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const bC=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(typeof e=="string")return typeof t!="string"||t.length!=1?-1:e.indexOf(t,0);for(let r=0;r<e.length;r++)if(r in e&&e[r]===t)return r;return-1};function Lx(e){const t=e.length;if(0<t){const r=Array(t);for(let n=0;n<t;n++)r[n]=e[n];return r}return[]}function Rw(e,t){for(let r=1;r<arguments.length;r++){const n=arguments[r];if(Y0(n)){const i=e.length||0,s=n.length||0;e.length=i+s;for(let a=0;a<s;a++)e[i+a]=n[a]}else e.push(n)}}function zr(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}zr.prototype.h=function(){this.defaultPrevented=!0};var m5=function(){if(!Me.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Me.addEventListener("test",()=>{},t),Me.removeEventListener("test",()=>{},t)}catch{}return e}();function Pu(e){return/^[\s\xa0]*$/.test(e)}function Q0(){var e=Me.navigator;return e&&(e=e.userAgent)?e:""}function Ri(e){return Q0().indexOf(e)!=-1}function Mx(e){return Mx[" "](e),e}Mx[" "]=function(){};function g5(e,t){var r=c8;return Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=t(e)}var v5=Ri("Opera"),kc=Ri("Trident")||Ri("MSIE"),FC=Ri("Edge"),F1=FC||kc,PC=Ri("Gecko")&&!(Q0().toLowerCase().indexOf("webkit")!=-1&&!Ri("Edge"))&&!(Ri("Trident")||Ri("MSIE"))&&!Ri("Edge"),x5=Q0().toLowerCase().indexOf("webkit")!=-1&&!Ri("Edge");function NC(){var e=Me.document;return e?e.documentMode:void 0}var P1;e:{var Nm="",Dm=function(){var e=Q0();if(PC)return/rv:([^\);]+)(\)|;)/.exec(e);if(FC)return/Edge\/([\d\.]+)/.exec(e);if(kc)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(x5)return/WebKit\/(\S+)/.exec(e);if(v5)return/(?:Version)[ \/]?(\S+)/.exec(e)}();if(Dm&&(Nm=Dm?Dm[1]:""),kc){var Om=NC();if(Om!=null&&Om>parseFloat(Nm)){P1=String(Om);break e}}P1=Nm}var N1;if(Me.document&&kc){var bw=NC();N1=bw||parseInt(P1,10)||void 0}else N1=void 0;var _5=N1;function Nu(e,t){if(zr.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var r=this.type=e.type,n=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(PC){e:{try{Mx(t.nodeName);var i=!0;break e}catch{}i=!1}i||(t=null)}}else r=="mouseover"?t=e.fromElement:r=="mouseout"&&(t=e.toElement);this.relatedTarget=t,n?(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=e.clientX!==void 0?e.clientX:e.pageX,this.clientY=e.clientY!==void 0?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=typeof e.pointerType=="string"?e.pointerType:y5[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Nu.$.h.call(this)}}mr(Nu,zr);var y5={2:"touch",3:"pen",4:"mouse"};Nu.prototype.h=function(){Nu.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var _f="closure_listenable_"+(1e6*Math.random()|0),E5=0;function w5(e,t,r,n,i){this.listener=e,this.proxy=null,this.src=t,this.type=r,this.capture=!!n,this.la=i,this.key=++E5,this.fa=this.ia=!1}function J0(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function Vx(e,t,r){for(const n in e)t.call(r,e[n],n,e)}function T5(e,t){for(const r in e)t.call(void 0,e[r],r,e)}function DC(e){const t={};for(const r in e)t[r]=e[r];return t}const Fw="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function OC(e,t){let r,n;for(let i=1;i<arguments.length;i++){n=arguments[i];for(r in n)e[r]=n[r];for(let s=0;s<Fw.length;s++)r=Fw[s],Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}}function Z0(e){this.src=e,this.g={},this.h=0}Z0.prototype.add=function(e,t,r,n,i){var s=e.toString();e=this.g[s],e||(e=this.g[s]=[],this.h++);var a=O1(e,t,n,i);return-1<a?(t=e[a],r||(t.ia=!1)):(t=new w5(t,this.src,s,!!n,i),t.ia=r,e.push(t)),t};function D1(e,t){var r=t.type;if(r in e.g){var n=e.g[r],i=bC(n,t),s;(s=0<=i)&&Array.prototype.splice.call(n,i,1),s&&(J0(t),e.g[r].length==0&&(delete e.g[r],e.h--))}}function O1(e,t,r,n){for(var i=0;i<e.length;++i){var s=e[i];if(!s.fa&&s.listener==t&&s.capture==!!r&&s.la==n)return i}return-1}var jx="closure_lm_"+(1e6*Math.random()|0),Lm={};function LC(e,t,r,n,i){if(n&&n.once)return VC(e,t,r,n,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)LC(e,t[s],r,n,i);return null}return r=$x(r),e&&e[_f]?e.O(t,r,xf(n)?!!n.capture:!!n,i):MC(e,t,r,!1,n,i)}function MC(e,t,r,n,i,s){if(!t)throw Error("Invalid event type");var a=xf(i)?!!i.capture:!!i,o=Ux(e);if(o||(e[jx]=o=new Z0(e)),r=o.add(t,r,n,a,s),r.proxy)return r;if(n=S5(),r.proxy=n,n.src=e,n.listener=r,e.addEventListener)m5||(i=a),i===void 0&&(i=!1),e.addEventListener(t.toString(),n,i);else if(e.attachEvent)e.attachEvent(BC(t.toString()),n);else if(e.addListener&&e.removeListener)e.addListener(n);else throw Error("addEventListener and attachEvent are unavailable.");return r}function S5(){function e(r){return t.call(e.src,e.listener,r)}const t=A5;return e}function VC(e,t,r,n,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)VC(e,t[s],r,n,i);return null}return r=$x(r),e&&e[_f]?e.P(t,r,xf(n)?!!n.capture:!!n,i):MC(e,t,r,!0,n,i)}function jC(e,t,r,n,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)jC(e,t[s],r,n,i);else n=xf(n)?!!n.capture:!!n,r=$x(r),e&&e[_f]?(e=e.i,t=String(t).toString(),t in e.g&&(s=e.g[t],r=O1(s,r,n,i),-1<r&&(J0(s[r]),Array.prototype.splice.call(s,r,1),s.length==0&&(delete e.g[t],e.h--)))):e&&(e=Ux(e))&&(t=e.g[t.toString()],e=-1,t&&(e=O1(t,r,n,i)),(r=-1<e?t[e]:null)&&Bx(r))}function Bx(e){if(typeof e!="number"&&e&&!e.fa){var t=e.src;if(t&&t[_f])D1(t.i,e);else{var r=e.type,n=e.proxy;t.removeEventListener?t.removeEventListener(r,n,e.capture):t.detachEvent?t.detachEvent(BC(r),n):t.addListener&&t.removeListener&&t.removeListener(n),(r=Ux(t))?(D1(r,e),r.h==0&&(r.src=null,t[jx]=null)):J0(e)}}}function BC(e){return e in Lm?Lm[e]:Lm[e]="on"+e}function A5(e,t){if(e.fa)e=!0;else{t=new Nu(t,this);var r=e.listener,n=e.la||e.src;e.ia&&Bx(e),e=r.call(n,t)}return e}function Ux(e){return e=e[jx],e instanceof Z0?e:null}var Mm="__closure_events_fn_"+(1e9*Math.random()>>>0);function $x(e){return typeof e=="function"?e:(e[Mm]||(e[Mm]=function(t){return e.handleEvent(t)}),e[Mm])}function pr(){xa.call(this),this.i=new Z0(this),this.S=this,this.J=null}mr(pr,xa);pr.prototype[_f]=!0;pr.prototype.removeEventListener=function(e,t,r,n){jC(this,e,t,r,n)};function Ar(e,t){var r,n=e.J;if(n)for(r=[];n;n=n.J)r.push(n);if(e=e.S,n=t.type||t,typeof t=="string")t=new zr(t,e);else if(t instanceof zr)t.target=t.target||e;else{var i=t;t=new zr(n,e),OC(t,i)}if(i=!0,r)for(var s=r.length-1;0<=s;s--){var a=t.g=r[s];i=lh(a,n,!0,t)&&i}if(a=t.g=e,i=lh(a,n,!0,t)&&i,i=lh(a,n,!1,t)&&i,r)for(s=0;s<r.length;s++)a=t.g=r[s],i=lh(a,n,!1,t)&&i}pr.prototype.N=function(){if(pr.$.N.call(this),this.i){var e=this.i,t;for(t in e.g){for(var r=e.g[t],n=0;n<r.length;n++)J0(r[n]);delete e.g[t],e.h--}}this.J=null};pr.prototype.O=function(e,t,r,n){return this.i.add(String(e),t,!1,r,n)};pr.prototype.P=function(e,t,r,n){return this.i.add(String(e),t,!0,r,n)};function lh(e,t,r,n){if(t=e.i.g[String(t)],!t)return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var a=t[s];if(a&&!a.fa&&a.capture==r){var o=a.listener,c=a.la||a.src;a.ia&&D1(e.i,a),i=o.call(c,n)!==!1&&i}}return i&&!n.defaultPrevented}var Hx=Me.JSON.stringify;class k5{constructor(t,r){this.i=t,this.j=r,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}function C5(){var e=zx;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}class I5{constructor(){this.h=this.g=null}add(t,r){const n=UC.get();n.set(t,r),this.h?this.h.next=n:this.g=n,this.h=n}}var UC=new k5(()=>new R5,e=>e.reset());class R5{constructor(){this.next=this.g=this.h=null}set(t,r){this.h=t,this.g=r,this.next=null}reset(){this.next=this.g=this.h=null}}function b5(e){var t=1;e=e.split(":");const r=[];for(;0<t&&e.length;)r.push(e.shift()),t--;return e.length&&r.push(e.join(":")),r}function F5(e){Me.setTimeout(()=>{throw e},0)}let Du,Ou=!1,zx=new I5,$C=()=>{const e=Me.Promise.resolve(void 0);Du=()=>{e.then(P5)}};var P5=()=>{for(var e;e=C5();){try{e.h.call(e.g)}catch(r){F5(r)}var t=UC;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Ou=!1};function ep(e,t){pr.call(this),this.h=e||1,this.g=t||Me,this.j=Hr(this.qb,this),this.l=Date.now()}mr(ep,pr);Ee=ep.prototype;Ee.ga=!1;Ee.T=null;Ee.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Ar(this,"tick"),this.ga&&(Wx(this),this.start()))}};Ee.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Wx(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}Ee.N=function(){ep.$.N.call(this),Wx(this),delete this.g};function Gx(e,t,r){if(typeof e=="function")r&&(e=Hr(e,r));else if(e&&typeof e.handleEvent=="function")e=Hr(e.handleEvent,e);else throw Error("Invalid listener argument");return 2147483647<Number(t)?-1:Me.setTimeout(e,t||0)}function HC(e){e.g=Gx(()=>{e.g=null,e.i&&(e.i=!1,HC(e))},e.j);const t=e.h;e.h=null,e.m.apply(null,t)}class N5 extends xa{constructor(t,r){super(),this.m=t,this.j=r,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:HC(this)}N(){super.N(),this.g&&(Me.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Lu(e){xa.call(this),this.h=e,this.g={}}mr(Lu,xa);var Pw=[];function zC(e,t,r,n){Array.isArray(r)||(r&&(Pw[0]=r.toString()),r=Pw);for(var i=0;i<r.length;i++){var s=LC(t,r[i],n||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function WC(e){Vx(e.g,function(t,r){this.g.hasOwnProperty(r)&&Bx(t)},e),e.g={}}Lu.prototype.N=function(){Lu.$.N.call(this),WC(this)};Lu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function tp(){this.g=!0}tp.prototype.Ea=function(){this.g=!1};function D5(e,t,r,n,i,s){e.info(function(){if(e.g)if(s)for(var a="",o=s.split("&"),c=0;c<o.length;c++){var l=o[c].split("=");if(1<l.length){var u=l[0];l=l[1];var f=u.split("_");a=2<=f.length&&f[1]=="type"?a+(u+"="+l+"&"):a+(u+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+n+") [attempt "+i+"]: "+t+`
`+r+`
`+a})}function O5(e,t,r,n,i,s,a){e.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+i+"]: "+t+`
`+r+`
`+s+" "+a})}function Jo(e,t,r,n){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+M5(e,r)+(n?" "+n:"")})}function L5(e,t){e.info(function(){return"TIMEOUT: "+t})}tp.prototype.info=function(){};function M5(e,t){if(!e.g)return t;if(!t)return null;try{var r=JSON.parse(t);if(r){for(e=0;e<r.length;e++)if(Array.isArray(r[e])){var n=r[e];if(!(2>n.length)){var i=n[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var a=1;a<i.length;a++)i[a]=""}}}}return Hx(r)}catch{return t}}var yo={},Nw=null;function rp(){return Nw=Nw||new pr}yo.Ta="serverreachability";function GC(e){zr.call(this,yo.Ta,e)}mr(GC,zr);function Mu(e){const t=rp();Ar(t,new GC(t))}yo.STAT_EVENT="statevent";function qC(e,t){zr.call(this,yo.STAT_EVENT,e),this.stat=t}mr(qC,zr);function nn(e){const t=rp();Ar(t,new qC(t,e))}yo.Ua="timingevent";function KC(e,t){zr.call(this,yo.Ua,e),this.size=t}mr(KC,zr);function yf(e,t){if(typeof e!="function")throw Error("Fn must not be null and must be a function");return Me.setTimeout(function(){e()},t)}var np={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},XC={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function qx(){}qx.prototype.h=null;function Dw(e){return e.h||(e.h=e.i())}function YC(){}var Ef={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Kx(){zr.call(this,"d")}mr(Kx,zr);function Xx(){zr.call(this,"c")}mr(Xx,zr);var L1;function ip(){}mr(ip,qx);ip.prototype.g=function(){return new XMLHttpRequest};ip.prototype.i=function(){return{}};L1=new ip;function wf(e,t,r,n){this.l=e,this.j=t,this.m=r,this.W=n||1,this.U=new Lu(this),this.P=V5,e=F1?125:void 0,this.V=new ep(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new QC}function QC(){this.i=null,this.g="",this.h=!1}var V5=45e3,M1={},Bd={};Ee=wf.prototype;Ee.setTimeout=function(e){this.P=e};function V1(e,t,r){e.L=1,e.v=ap(ms(t)),e.s=r,e.S=!0,JC(e,null)}function JC(e,t){e.G=Date.now(),Tf(e),e.A=ms(e.v);var r=e.A,n=e.W;Array.isArray(n)||(n=[String(n)]),aI(r.i,"t",n),e.C=0,r=e.l.J,e.h=new QC,e.g=CI(e.l,r?t:null,!e.s),0<e.O&&(e.M=new N5(Hr(e.Pa,e,e.g),e.O)),zC(e.U,e.g,"readystatechange",e.nb),t=e.I?DC(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),Mu(),D5(e.j,e.u,e.A,e.m,e.W,e.s)}Ee.nb=function(e){e=e.target;const t=this.M;t&&bi(e)==3?t.l():this.Pa(e)};Ee.Pa=function(e){try{if(e==this.g)e:{const u=bi(this.g);var t=this.g.Ia();const f=this.g.da();if(!(3>u)&&(u!=3||F1||this.g&&(this.h.h||this.g.ja()||Vw(this.g)))){this.J||u!=4||t==7||(t==8||0>=f?Mu(3):Mu(2)),sp(this);var r=this.g.da();this.ca=r;t:if(ZC(this)){var n=Vw(this.g);e="";var i=n.length,s=bi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ma(this),ql(this);var a="";break t}this.h.i=new Me.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(n[t],{stream:s&&t==i-1});n.splice(0,i),this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.ja();if(this.i=r==200,O5(this.j,this.u,this.A,this.m,this.W,u,r),this.i){if(this.aa&&!this.K){t:{if(this.g){var o,c=this.g;if((o=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Pu(o)){var l=o;break t}}l=null}if(r=l)Jo(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,j1(this,r);else{this.i=!1,this.o=3,nn(12),Ma(this),ql(this);break e}}this.S?(eI(this,u,a),F1&&this.i&&u==3&&(zC(this.U,this.V,"tick",this.mb),this.V.start())):(Jo(this.j,this.m,a,null),j1(this,a)),u==4&&Ma(this),this.i&&!this.J&&(u==4?TI(this.l,this):(this.i=!1,Tf(this)))}else s8(this.g),r==400&&0<a.indexOf("Unknown SID")?(this.o=3,nn(12)):(this.o=0,nn(13)),Ma(this),ql(this)}}}catch{}finally{}};function ZC(e){return e.g?e.u=="GET"&&e.L!=2&&e.l.Ha:!1}function eI(e,t,r){let n=!0,i;for(;!e.J&&e.C<r.length;)if(i=j5(e,r),i==Bd){t==4&&(e.o=4,nn(14),n=!1),Jo(e.j,e.m,null,"[Incomplete Response]");break}else if(i==M1){e.o=4,nn(15),Jo(e.j,e.m,r,"[Invalid Chunk]"),n=!1;break}else Jo(e.j,e.m,i,null),j1(e,i);ZC(e)&&i!=Bd&&i!=M1&&(e.h.g="",e.C=0),t!=4||r.length!=0||e.h.h||(e.o=1,nn(16),n=!1),e.i=e.i&&n,n?0<r.length&&!e.ba&&(e.ba=!0,t=e.l,t.g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+r.length),t_(t),t.M=!0,nn(11))):(Jo(e.j,e.m,r,"[Invalid Chunked Response]"),Ma(e),ql(e))}Ee.mb=function(){if(this.g){var e=bi(this.g),t=this.g.ja();this.C<t.length&&(sp(this),eI(this,e,t),this.i&&e!=4&&Tf(this))}};function j5(e,t){var r=e.C,n=t.indexOf(`
`,r);return n==-1?Bd:(r=Number(t.substring(r,n)),isNaN(r)?M1:(n+=1,n+r>t.length?Bd:(t=t.slice(n,n+r),e.C=n+r,t)))}Ee.cancel=function(){this.J=!0,Ma(this)};function Tf(e){e.Y=Date.now()+e.P,tI(e,e.P)}function tI(e,t){if(e.B!=null)throw Error("WatchDog timer not null");e.B=yf(Hr(e.lb,e),t)}function sp(e){e.B&&(Me.clearTimeout(e.B),e.B=null)}Ee.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(L5(this.j,this.A),this.L!=2&&(Mu(),nn(17)),Ma(this),this.o=2,ql(this)):tI(this,this.Y-e)};function ql(e){e.l.H==0||e.J||TI(e.l,e)}function Ma(e){sp(e);var t=e.M;t&&typeof t.sa=="function"&&t.sa(),e.M=null,Wx(e.V),WC(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function j1(e,t){try{var r=e.l;if(r.H!=0&&(r.g==e||B1(r.i,e))){if(!e.K&&B1(r.i,e)&&r.H==3){try{var n=r.Ja.g.parse(t)}catch{n=null}if(Array.isArray(n)&&n.length==3){var i=n;if(i[0]==0){e:if(!r.u){if(r.g)if(r.g.G+3e3<e.G)Hd(r),lp(r);else break e;e_(r),nn(18)}}else r.Fa=i[1],0<r.Fa-r.V&&37500>i[2]&&r.G&&r.A==0&&!r.v&&(r.v=yf(Hr(r.ib,r),6e3));if(1>=lI(r.i)&&r.oa){try{r.oa()}catch{}r.oa=void 0}}else Va(r,11)}else if((e.K||r.g==e)&&Hd(r),!Pu(t))for(i=r.Ja.g.parse(t),t=0;t<i.length;t++){let l=i[t];if(r.V=l[0],l=l[1],r.H==2)if(l[0]=="c"){r.K=l[1],r.pa=l[2];const u=l[3];u!=null&&(r.ra=u,r.l.info("VER="+r.ra));const f=l[4];f!=null&&(r.Ga=f,r.l.info("SVER="+r.Ga));const d=l[5];d!=null&&typeof d=="number"&&0<d&&(n=1.5*d,r.L=n,r.l.info("backChannelRequestTimeoutMs_="+n)),n=r;const p=e.g;if(p){const g=p.g?p.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(g){var s=n.i;s.g||g.indexOf("spdy")==-1&&g.indexOf("quic")==-1&&g.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Yx(s,s.h),s.h=null))}if(n.F){const m=p.g?p.g.getResponseHeader("X-HTTP-Session-Id"):null;m&&(n.Da=m,_t(n.I,n.F,m))}}r.H=3,r.h&&r.h.Ba(),r.ca&&(r.S=Date.now()-e.G,r.l.info("Handshake RTT: "+r.S+"ms")),n=r;var a=e;if(n.wa=kI(n,n.J?n.pa:null,n.Y),a.K){uI(n.i,a);var o=a,c=n.L;c&&o.setTimeout(c),o.B&&(sp(o),Tf(o)),n.g=a}else EI(n);0<r.j.length&&up(r)}else l[0]!="stop"&&l[0]!="close"||Va(r,7);else r.H==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?Va(r,7):Zx(r):l[0]!="noop"&&r.h&&r.h.Aa(l),r.A=0)}}Mu(4)}catch{}}function B5(e){if(e.Z&&typeof e.Z=="function")return e.Z();if(typeof Map<"u"&&e instanceof Map||typeof Set<"u"&&e instanceof Set)return Array.from(e.values());if(typeof e=="string")return e.split("");if(Y0(e)){for(var t=[],r=e.length,n=0;n<r;n++)t.push(e[n]);return t}t=[],r=0;for(n in e)t[r++]=e[n];return t}function U5(e){if(e.ta&&typeof e.ta=="function")return e.ta();if(!e.Z||typeof e.Z!="function"){if(typeof Map<"u"&&e instanceof Map)return Array.from(e.keys());if(!(typeof Set<"u"&&e instanceof Set)){if(Y0(e)||typeof e=="string"){var t=[];e=e.length;for(var r=0;r<e;r++)t.push(r);return t}t=[],r=0;for(const n in e)t[r++]=n;return t}}}function rI(e,t){if(e.forEach&&typeof e.forEach=="function")e.forEach(t,void 0);else if(Y0(e)||typeof e=="string")Array.prototype.forEach.call(e,t,void 0);else for(var r=U5(e),n=B5(e),i=n.length,s=0;s<i;s++)t.call(void 0,n[s],r&&r[s],e)}var nI=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function $5(e,t){if(e){e=e.split("&");for(var r=0;r<e.length;r++){var n=e[r].indexOf("="),i=null;if(0<=n){var s=e[r].substring(0,n);i=e[r].substring(n+1)}else s=e[r];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Wa(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Wa){this.h=e.h,Ud(this,e.j),this.s=e.s,this.g=e.g,$d(this,e.m),this.l=e.l;var t=e.i,r=new Vu;r.i=t.i,t.g&&(r.g=new Map(t.g),r.h=t.h),Ow(this,r),this.o=e.o}else e&&(t=String(e).match(nI))?(this.h=!1,Ud(this,t[1]||"",!0),this.s=kl(t[2]||""),this.g=kl(t[3]||"",!0),$d(this,t[4]),this.l=kl(t[5]||"",!0),Ow(this,t[6]||"",!0),this.o=kl(t[7]||"")):(this.h=!1,this.i=new Vu(null,this.h))}Wa.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Cl(t,Lw,!0),":");var r=this.g;return(r||t=="file")&&(e.push("//"),(t=this.s)&&e.push(Cl(t,Lw,!0),"@"),e.push(encodeURIComponent(String(r)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),r=this.m,r!=null&&e.push(":",String(r))),(r=this.l)&&(this.g&&r.charAt(0)!="/"&&e.push("/"),e.push(Cl(r,r.charAt(0)=="/"?W5:z5,!0))),(r=this.i.toString())&&e.push("?",r),(r=this.o)&&e.push("#",Cl(r,q5)),e.join("")};function ms(e){return new Wa(e)}function Ud(e,t,r){e.j=r?kl(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function $d(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Ow(e,t,r){t instanceof Vu?(e.i=t,K5(e.i,e.h)):(r||(t=Cl(t,G5)),e.i=new Vu(t,e.h))}function _t(e,t,r){e.i.set(t,r)}function ap(e){return _t(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function kl(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Cl(e,t,r){return typeof e=="string"?(e=encodeURI(e).replace(t,H5),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function H5(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)}var Lw=/[#\/\?@]/g,z5=/[#\?:]/g,W5=/[#\?]/g,G5=/[#\?@]/g,q5=/#/g;function Vu(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function _a(e){e.g||(e.g=new Map,e.h=0,e.i&&$5(e.i,function(t,r){e.add(decodeURIComponent(t.replace(/\+/g," ")),r)}))}Ee=Vu.prototype;Ee.add=function(e,t){_a(this),this.i=null,e=zc(this,e);var r=this.g.get(e);return r||this.g.set(e,r=[]),r.push(t),this.h+=1,this};function iI(e,t){_a(e),t=zc(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function sI(e,t){return _a(e),t=zc(e,t),e.g.has(t)}Ee.forEach=function(e,t){_a(this),this.g.forEach(function(r,n){r.forEach(function(i){e.call(t,i,n,this)},this)},this)};Ee.ta=function(){_a(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),r=[];for(let n=0;n<t.length;n++){const i=e[n];for(let s=0;s<i.length;s++)r.push(t[n])}return r};Ee.Z=function(e){_a(this);let t=[];if(typeof e=="string")sI(this,e)&&(t=t.concat(this.g.get(zc(this,e))));else{e=Array.from(this.g.values());for(let r=0;r<e.length;r++)t=t.concat(e[r])}return t};Ee.set=function(e,t){return _a(this),this.i=null,e=zc(this,e),sI(this,e)&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this};Ee.get=function(e,t){return e?(e=this.Z(e),0<e.length?String(e[0]):t):t};function aI(e,t,r){iI(e,t),0<r.length&&(e.i=null,e.g.set(zc(e,t),Lx(r)),e.h+=r.length)}Ee.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var r=0;r<t.length;r++){var n=t[r];const s=encodeURIComponent(String(n)),a=this.Z(n);for(n=0;n<a.length;n++){var i=s;a[n]!==""&&(i+="="+encodeURIComponent(String(a[n]))),e.push(i)}}return this.i=e.join("&")};function zc(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function K5(e,t){t&&!e.j&&(_a(e),e.i=null,e.g.forEach(function(r,n){var i=n.toLowerCase();n!=i&&(iI(this,n),aI(this,i,r))},e)),e.j=t}var X5=class{constructor(e,t){this.g=e,this.map=t}};function oI(e){this.l=e||Y5,Me.PerformanceNavigationTiming?(e=Me.performance.getEntriesByType("navigation"),e=0<e.length&&(e[0].nextHopProtocol=="hq"||e[0].nextHopProtocol=="h2")):e=!!(Me.g&&Me.g.Ka&&Me.g.Ka()&&Me.g.Ka().dc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Y5=10;function cI(e){return e.h?!0:e.g?e.g.size>=e.j:!1}function lI(e){return e.h?1:e.g?e.g.size:0}function B1(e,t){return e.h?e.h==t:e.g?e.g.has(t):!1}function Yx(e,t){e.g?e.g.add(t):e.h=t}function uI(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}oI.prototype.cancel=function(){if(this.i=fI(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const e of this.g.values())e.cancel();this.g.clear()}};function fI(e){if(e.h!=null)return e.i.concat(e.h.F);if(e.g!=null&&e.g.size!==0){let t=e.i;for(const r of e.g.values())t=t.concat(r.F);return t}return Lx(e.i)}var Q5=class{stringify(e){return Me.JSON.stringify(e,void 0)}parse(e){return Me.JSON.parse(e,void 0)}};function J5(){this.g=new Q5}function Z5(e,t,r){const n=r||"";try{rI(e,function(i,s){let a=i;xf(i)&&(a=Hx(i)),t.push(n+s+"="+encodeURIComponent(a))})}catch(i){throw t.push(n+"type="+encodeURIComponent("_badmap")),i}}function e8(e,t){const r=new tp;if(Me.Image){const n=new Image;n.onload=ch(uh,r,n,"TestLoadImage: loaded",!0,t),n.onerror=ch(uh,r,n,"TestLoadImage: error",!1,t),n.onabort=ch(uh,r,n,"TestLoadImage: abort",!1,t),n.ontimeout=ch(uh,r,n,"TestLoadImage: timeout",!1,t),Me.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=e}else t(!1)}function uh(e,t,r,n,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(n)}catch{}}function Sf(e){this.l=e.ec||null,this.j=e.ob||!1}mr(Sf,qx);Sf.prototype.g=function(){return new op(this.l,this.j)};Sf.prototype.i=function(e){return function(){return e}}({});function op(e,t){pr.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=Qx,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}mr(op,pr);var Qx=0;Ee=op.prototype;Ee.open=function(e,t){if(this.readyState!=Qx)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,ju(this)};Ee.send=function(e){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||Me).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))};Ee.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Af(this)),this.readyState=Qx};Ee.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,ju(this)),this.g&&(this.readyState=3,ju(this),this.g)))if(this.responseType==="arraybuffer")e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Me.ReadableStream<"u"&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;hI(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))};function hI(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}Ee.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Af(this):ju(this),this.readyState==3&&hI(this)}};Ee.Za=function(e){this.g&&(this.response=this.responseText=e,Af(this))};Ee.Ya=function(e){this.g&&(this.response=e,Af(this))};Ee.ka=function(){this.g&&Af(this)};function Af(e){e.readyState=4,e.l=null,e.j=null,e.A=null,ju(e)}Ee.setRequestHeader=function(e,t){this.v.append(e,t)};Ee.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""};Ee.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var r=t.next();!r.done;)r=r.value,e.push(r[0]+": "+r[1]),r=t.next();return e.join(`\r
`)};function ju(e){e.onreadystatechange&&e.onreadystatechange.call(e)}Object.defineProperty(op.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(e){this.m=e?"include":"same-origin"}});var t8=Me.JSON.parse;function Lt(e){pr.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=dI,this.L=this.M=!1}mr(Lt,pr);var dI="",r8=/^https?$/i,n8=["POST","PUT"];Ee=Lt.prototype;Ee.Oa=function(e){this.M=e};Ee.ha=function(e,t,r,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():L1.g(),this.C=this.u?Dw(this.u):Dw(L1),this.g.onreadystatechange=Hr(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(s){Mw(this,s);return}if(e=r||"",r=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var i in n)r.set(i,n[i]);else if(typeof n.keys=="function"&&typeof n.get=="function")for(const s of n.keys())r.set(s,n.get(s));else throw Error("Unknown input type for opt_headers: "+String(n));n=Array.from(r.keys()).find(s=>s.toLowerCase()=="content-type"),i=Me.FormData&&e instanceof Me.FormData,!(0<=bC(n8,t))||n||i||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of r)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{gI(this),0<this.B&&((this.L=i8(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Hr(this.ua,this)):this.A=Gx(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){Mw(this,s)}};function i8(e){return kc&&typeof e.timeout=="number"&&e.ontimeout!==void 0}Ee.ua=function(){typeof Ox<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ar(this,"timeout"),this.abort(8))};function Mw(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,pI(e),cp(e)}function pI(e){e.F||(e.F=!0,Ar(e,"complete"),Ar(e,"error"))}Ee.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Ar(this,"complete"),Ar(this,"abort"),cp(this))};Ee.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),cp(this,!0)),Lt.$.N.call(this)};Ee.La=function(){this.s||(this.G||this.v||this.l?mI(this):this.kb())};Ee.kb=function(){mI(this)};function mI(e){if(e.h&&typeof Ox<"u"&&(!e.C[1]||bi(e)!=4||e.da()!=2)){if(e.v&&bi(e)==4)Gx(e.La,0,e);else if(Ar(e,"readystatechange"),bi(e)==4){e.h=!1;try{const a=e.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var r;if(!(r=t)){var n;if(n=a===0){var i=String(e.I).match(nI)[1]||null;!i&&Me.self&&Me.self.location&&(i=Me.self.location.protocol.slice(0,-1)),n=!r8.test(i?i.toLowerCase():"")}r=n}if(r)Ar(e,"complete"),Ar(e,"success");else{e.m=6;try{var s=2<bi(e)?e.g.statusText:""}catch{s=""}e.j=s+" ["+e.da()+"]",pI(e)}}finally{cp(e)}}}}function cp(e,t){if(e.g){gI(e);const r=e.g,n=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||Ar(e,"ready");try{r.onreadystatechange=n}catch{}}}function gI(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(Me.clearTimeout(e.A),e.A=null)}Ee.isActive=function(){return!!this.g};function bi(e){return e.g?e.g.readyState:0}Ee.da=function(){try{return 2<bi(this)?this.g.status:-1}catch{return-1}};Ee.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};Ee.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&t.indexOf(e)==0&&(t=t.substring(e.length)),t8(t)}};function Vw(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case dI:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}function s8(e){const t={};e=(e.g&&2<=bi(e)&&e.g.getAllResponseHeaders()||"").split(`\r
`);for(let n=0;n<e.length;n++){if(Pu(e[n]))continue;var r=b5(e[n]);const i=r[0];if(r=r[1],typeof r!="string")continue;r=r.trim();const s=t[i]||[];t[i]=s,s.push(r)}T5(t,function(n){return n.join(", ")})}Ee.Ia=function(){return this.m};Ee.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function vI(e){let t="";return Vx(e,function(r,n){t+=n,t+=":",t+=r,t+=`\r
`}),t}function Jx(e,t,r){e:{for(n in r){var n=!1;break e}n=!0}n||(r=vI(r),typeof e=="string"?r!=null&&encodeURIComponent(String(r)):_t(e,t,r))}function dl(e,t,r){return r&&r.internalChannelParams&&r.internalChannelParams[e]||t}function xI(e){this.Ga=0,this.j=[],this.l=new tp,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=dl("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=dl("baseRetryDelayMs",5e3,e),this.hb=dl("retryDelaySeedMs",1e4,e),this.eb=dl("forwardChannelMaxRetries",2,e),this.xa=dl("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new oI(e&&e.concurrentRequestLimit),this.Ja=new J5,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}Ee=xI.prototype;Ee.ra=8;Ee.H=1;function Zx(e){if(_I(e),e.H==3){var t=e.W++,r=ms(e.I);if(_t(r,"SID",e.K),_t(r,"RID",t),_t(r,"TYPE","terminate"),kf(e,r),t=new wf(e,e.l,t),t.L=2,t.v=ap(ms(r)),r=!1,Me.navigator&&Me.navigator.sendBeacon)try{r=Me.navigator.sendBeacon(t.v.toString(),"")}catch{}!r&&Me.Image&&(new Image().src=t.v,r=!0),r||(t.g=CI(t.l,null),t.g.ha(t.v)),t.G=Date.now(),Tf(t)}AI(e)}function lp(e){e.g&&(t_(e),e.g.cancel(),e.g=null)}function _I(e){lp(e),e.u&&(Me.clearTimeout(e.u),e.u=null),Hd(e),e.i.cancel(),e.m&&(typeof e.m=="number"&&Me.clearTimeout(e.m),e.m=null)}function up(e){if(!cI(e.i)&&!e.m){e.m=!0;var t=e.Na;Du||$C(),Ou||(Du(),Ou=!0),zx.add(t,e),e.C=0}}function a8(e,t){return lI(e.i)>=e.i.j-(e.m?1:0)?!1:e.m?(e.j=t.F.concat(e.j),!0):e.H==1||e.H==2||e.C>=(e.cb?0:e.eb)?!1:(e.m=yf(Hr(e.Na,e,t),SI(e,e.C)),e.C++,!0)}Ee.Na=function(e){if(this.m)if(this.m=null,this.H==1){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const i=new wf(this,this.l,e);let s=this.s;if(this.U&&(s?(s=DC(s),OC(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var t=0,r=0;r<this.j.length;r++){t:{var n=this.j[r];if("__data__"in n.map&&(n=n.map.__data__,typeof n=="string")){n=n.length;break t}n=void 0}if(n===void 0)break;if(t+=n,4096<t){t=r;break e}if(t===4096||r===this.j.length-1){t=r+1;break e}}t=1e3}else t=1e3;t=yI(this,i,t),r=ms(this.I),_t(r,"RID",e),_t(r,"CVER",22),this.F&&_t(r,"X-HTTP-Session-Id",this.F),kf(this,r),s&&(this.O?t="headers="+encodeURIComponent(String(vI(s)))+"&"+t:this.o&&Jx(r,this.o,s)),Yx(this.i,i),this.bb&&_t(r,"TYPE","init"),this.P?(_t(r,"$req",t),_t(r,"SID","null"),i.aa=!0,V1(i,r,null)):V1(i,r,t),this.H=2}}else this.H==3&&(e?jw(this,e):this.j.length==0||cI(this.i)||jw(this))};function jw(e,t){var r;t?r=t.m:r=e.W++;const n=ms(e.I);_t(n,"SID",e.K),_t(n,"RID",r),_t(n,"AID",e.V),kf(e,n),e.o&&e.s&&Jx(n,e.o,e.s),r=new wf(e,e.l,r,e.C+1),e.o===null&&(r.I=e.s),t&&(e.j=t.F.concat(e.j)),t=yI(e,r,1e3),r.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),Yx(e.i,r),V1(r,n,t)}function kf(e,t){e.na&&Vx(e.na,function(r,n){_t(t,n,r)}),e.h&&rI({},function(r,n){_t(t,n,r)})}function yI(e,t,r){r=Math.min(e.j.length,r);var n=e.h?Hr(e.h.Va,e.h,e):null;e:{var i=e.j;let s=-1;for(;;){const a=["count="+r];s==-1?0<r?(s=i[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let o=!0;for(let c=0;c<r;c++){let l=i[c].g;const u=i[c].map;if(l-=s,0>l)s=Math.max(0,i[c].g-100),o=!1;else try{Z5(u,a,"req"+l+"_")}catch{n&&n(u)}}if(o){n=a.join("&");break e}}}return e=e.j.splice(0,r),t.F=e,n}function EI(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Du||$C(),Ou||(Du(),Ou=!0),zx.add(t,e),e.A=0}}function e_(e){return e.g||e.u||3<=e.A?!1:(e.ba++,e.u=yf(Hr(e.Ma,e),SI(e,e.A)),e.A++,!0)}Ee.Ma=function(){if(this.u=null,wI(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=yf(Hr(this.jb,this),e)}};Ee.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,nn(10),lp(this),wI(this))};function t_(e){e.B!=null&&(Me.clearTimeout(e.B),e.B=null)}function wI(e){e.g=new wf(e,e.l,"rpc",e.ba),e.o===null&&(e.g.I=e.s),e.g.O=0;var t=ms(e.wa);_t(t,"RID","rpc"),_t(t,"SID",e.K),_t(t,"AID",e.V),_t(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&_t(t,"TO",e.qa),_t(t,"TYPE","xmlhttp"),kf(e,t),e.o&&e.s&&Jx(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var r=e.g;e=e.pa,r.L=1,r.v=ap(ms(t)),r.s=null,r.S=!0,JC(r,e)}Ee.ib=function(){this.v!=null&&(this.v=null,lp(this),e_(this),nn(19))};function Hd(e){e.v!=null&&(Me.clearTimeout(e.v),e.v=null)}function TI(e,t){var r=null;if(e.g==t){Hd(e),t_(e),e.g=null;var n=2}else if(B1(e.i,t))r=t.F,uI(e.i,t),n=1;else return;if(e.H!=0){if(t.i)if(n==1){r=t.s?t.s.length:0,t=Date.now()-t.G;var i=e.C;n=rp(),Ar(n,new KC(n,r)),up(e)}else EI(e);else if(i=t.o,i==3||i==0&&0<t.ca||!(n==1&&a8(e,t)||n==2&&e_(e)))switch(r&&0<r.length&&(t=e.i,t.i=t.i.concat(r)),i){case 1:Va(e,5);break;case 4:Va(e,10);break;case 3:Va(e,6);break;default:Va(e,2)}}}function SI(e,t){let r=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(r*=2),r*t}function Va(e,t){if(e.l.info("Error code "+t),t==2){var r=null;e.h&&(r=null);var n=Hr(e.pb,e);r||(r=new Wa("//www.google.com/images/cleardot.gif"),Me.location&&Me.location.protocol=="http"||Ud(r,"https"),ap(r)),e8(r.toString(),n)}else nn(2);e.H=0,e.h&&e.h.za(t),AI(e),_I(e)}Ee.pb=function(e){e?(this.l.info("Successfully pinged google.com"),nn(2)):(this.l.info("Failed to ping google.com"),nn(1))};function AI(e){if(e.H=0,e.ma=[],e.h){const t=fI(e.i);(t.length!=0||e.j.length!=0)&&(Rw(e.ma,t),Rw(e.ma,e.j),e.i.i.length=0,Lx(e.j),e.j.length=0),e.h.ya()}}function kI(e,t,r){var n=r instanceof Wa?ms(r):new Wa(r);if(n.g!="")t&&(n.g=t+"."+n.g),$d(n,n.m);else{var i=Me.location;n=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new Wa(null);n&&Ud(s,n),t&&(s.g=t),i&&$d(s,i),r&&(s.l=r),n=s}return r=e.F,t=e.Da,r&&t&&_t(n,r,t),_t(n,"VER",e.ra),kf(e,n),n}function CI(e,t,r){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return t=r&&e.Ha&&!e.va?new Lt(new Sf({ob:!0})):new Lt(e.va),t.Oa(e.J),t}Ee.isActive=function(){return!!this.h&&this.h.isActive(this)};function II(){}Ee=II.prototype;Ee.Ba=function(){};Ee.Aa=function(){};Ee.za=function(){};Ee.ya=function(){};Ee.isActive=function(){return!0};Ee.Va=function(){};function zd(){if(kc&&!(10<=Number(_5)))throw Error("Environmental error: no available transport.")}zd.prototype.g=function(e,t){return new Ln(e,t)};function Ln(e,t){pr.call(this),this.g=new xI(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!Pu(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Pu(t)&&(this.g.F=t,e=this.h,e!==null&&t in e&&(e=this.h,t in e&&delete e[t])),this.j=new Wc(this)}mr(Ln,pr);Ln.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,r=this.h||void 0;nn(0),e.Y=t,e.na=r||{},e.G=e.aa,e.I=kI(e,null,e.Y),up(e)};Ln.prototype.close=function(){Zx(this.g)};Ln.prototype.u=function(e){var t=this.g;if(typeof e=="string"){var r={};r.__data__=e,e=r}else this.v&&(r={},r.__data__=Hx(e),e=r);t.j.push(new X5(t.fb++,e)),t.H==3&&up(t)};Ln.prototype.N=function(){this.g.h=null,delete this.j,Zx(this.g),delete this.g,Ln.$.N.call(this)};function RI(e){Kx.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const r in t){e=r;break e}e=void 0}(this.i=e)&&(e=this.i,t=t!==null&&e in t?t[e]:void 0),this.data=t}else this.data=e}mr(RI,Kx);function bI(){Xx.call(this),this.status=1}mr(bI,Xx);function Wc(e){this.g=e}mr(Wc,II);Wc.prototype.Ba=function(){Ar(this.g,"a")};Wc.prototype.Aa=function(e){Ar(this.g,new RI(e))};Wc.prototype.za=function(e){Ar(this.g,new bI)};Wc.prototype.ya=function(){Ar(this.g,"b")};function o8(){this.blockSize=-1}function xi(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}mr(xi,o8);xi.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Vm(e,t,r){r||(r=0);var n=Array(16);if(typeof t=="string")for(var i=0;16>i;++i)n[i]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(i=0;16>i;++i)n[i]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],i=e.g[2];var s=e.g[3],a=t+(s^r&(i^s))+n[0]+3614090360&4294967295;t=r+(a<<7&4294967295|a>>>25),a=s+(i^t&(r^i))+n[1]+3905402710&4294967295,s=t+(a<<12&4294967295|a>>>20),a=i+(r^s&(t^r))+n[2]+606105819&4294967295,i=s+(a<<17&4294967295|a>>>15),a=r+(t^i&(s^t))+n[3]+3250441966&4294967295,r=i+(a<<22&4294967295|a>>>10),a=t+(s^r&(i^s))+n[4]+4118548399&4294967295,t=r+(a<<7&4294967295|a>>>25),a=s+(i^t&(r^i))+n[5]+1200080426&4294967295,s=t+(a<<12&4294967295|a>>>20),a=i+(r^s&(t^r))+n[6]+2821735955&4294967295,i=s+(a<<17&4294967295|a>>>15),a=r+(t^i&(s^t))+n[7]+4249261313&4294967295,r=i+(a<<22&4294967295|a>>>10),a=t+(s^r&(i^s))+n[8]+1770035416&4294967295,t=r+(a<<7&4294967295|a>>>25),a=s+(i^t&(r^i))+n[9]+2336552879&4294967295,s=t+(a<<12&4294967295|a>>>20),a=i+(r^s&(t^r))+n[10]+4294925233&4294967295,i=s+(a<<17&4294967295|a>>>15),a=r+(t^i&(s^t))+n[11]+2304563134&4294967295,r=i+(a<<22&4294967295|a>>>10),a=t+(s^r&(i^s))+n[12]+1804603682&4294967295,t=r+(a<<7&4294967295|a>>>25),a=s+(i^t&(r^i))+n[13]+4254626195&4294967295,s=t+(a<<12&4294967295|a>>>20),a=i+(r^s&(t^r))+n[14]+2792965006&4294967295,i=s+(a<<17&4294967295|a>>>15),a=r+(t^i&(s^t))+n[15]+1236535329&4294967295,r=i+(a<<22&4294967295|a>>>10),a=t+(i^s&(r^i))+n[1]+4129170786&4294967295,t=r+(a<<5&4294967295|a>>>27),a=s+(r^i&(t^r))+n[6]+3225465664&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^r&(s^t))+n[11]+643717713&4294967295,i=s+(a<<14&4294967295|a>>>18),a=r+(s^t&(i^s))+n[0]+3921069994&4294967295,r=i+(a<<20&4294967295|a>>>12),a=t+(i^s&(r^i))+n[5]+3593408605&4294967295,t=r+(a<<5&4294967295|a>>>27),a=s+(r^i&(t^r))+n[10]+38016083&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^r&(s^t))+n[15]+3634488961&4294967295,i=s+(a<<14&4294967295|a>>>18),a=r+(s^t&(i^s))+n[4]+3889429448&4294967295,r=i+(a<<20&4294967295|a>>>12),a=t+(i^s&(r^i))+n[9]+568446438&4294967295,t=r+(a<<5&4294967295|a>>>27),a=s+(r^i&(t^r))+n[14]+3275163606&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^r&(s^t))+n[3]+4107603335&4294967295,i=s+(a<<14&4294967295|a>>>18),a=r+(s^t&(i^s))+n[8]+1163531501&4294967295,r=i+(a<<20&4294967295|a>>>12),a=t+(i^s&(r^i))+n[13]+2850285829&4294967295,t=r+(a<<5&4294967295|a>>>27),a=s+(r^i&(t^r))+n[2]+4243563512&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^r&(s^t))+n[7]+1735328473&4294967295,i=s+(a<<14&4294967295|a>>>18),a=r+(s^t&(i^s))+n[12]+2368359562&4294967295,r=i+(a<<20&4294967295|a>>>12),a=t+(r^i^s)+n[5]+4294588738&4294967295,t=r+(a<<4&4294967295|a>>>28),a=s+(t^r^i)+n[8]+2272392833&4294967295,s=t+(a<<11&4294967295|a>>>21),a=i+(s^t^r)+n[11]+1839030562&4294967295,i=s+(a<<16&4294967295|a>>>16),a=r+(i^s^t)+n[14]+4259657740&4294967295,r=i+(a<<23&4294967295|a>>>9),a=t+(r^i^s)+n[1]+2763975236&4294967295,t=r+(a<<4&4294967295|a>>>28),a=s+(t^r^i)+n[4]+1272893353&4294967295,s=t+(a<<11&4294967295|a>>>21),a=i+(s^t^r)+n[7]+4139469664&4294967295,i=s+(a<<16&4294967295|a>>>16),a=r+(i^s^t)+n[10]+3200236656&4294967295,r=i+(a<<23&4294967295|a>>>9),a=t+(r^i^s)+n[13]+681279174&4294967295,t=r+(a<<4&4294967295|a>>>28),a=s+(t^r^i)+n[0]+3936430074&4294967295,s=t+(a<<11&4294967295|a>>>21),a=i+(s^t^r)+n[3]+3572445317&4294967295,i=s+(a<<16&4294967295|a>>>16),a=r+(i^s^t)+n[6]+76029189&4294967295,r=i+(a<<23&4294967295|a>>>9),a=t+(r^i^s)+n[9]+3654602809&4294967295,t=r+(a<<4&4294967295|a>>>28),a=s+(t^r^i)+n[12]+3873151461&4294967295,s=t+(a<<11&4294967295|a>>>21),a=i+(s^t^r)+n[15]+530742520&4294967295,i=s+(a<<16&4294967295|a>>>16),a=r+(i^s^t)+n[2]+3299628645&4294967295,r=i+(a<<23&4294967295|a>>>9),a=t+(i^(r|~s))+n[0]+4096336452&4294967295,t=r+(a<<6&4294967295|a>>>26),a=s+(r^(t|~i))+n[7]+1126891415&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~r))+n[14]+2878612391&4294967295,i=s+(a<<15&4294967295|a>>>17),a=r+(s^(i|~t))+n[5]+4237533241&4294967295,r=i+(a<<21&4294967295|a>>>11),a=t+(i^(r|~s))+n[12]+1700485571&4294967295,t=r+(a<<6&4294967295|a>>>26),a=s+(r^(t|~i))+n[3]+2399980690&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~r))+n[10]+4293915773&4294967295,i=s+(a<<15&4294967295|a>>>17),a=r+(s^(i|~t))+n[1]+2240044497&4294967295,r=i+(a<<21&4294967295|a>>>11),a=t+(i^(r|~s))+n[8]+1873313359&4294967295,t=r+(a<<6&4294967295|a>>>26),a=s+(r^(t|~i))+n[15]+4264355552&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~r))+n[6]+2734768916&4294967295,i=s+(a<<15&4294967295|a>>>17),a=r+(s^(i|~t))+n[13]+1309151649&4294967295,r=i+(a<<21&4294967295|a>>>11),a=t+(i^(r|~s))+n[4]+4149444226&4294967295,t=r+(a<<6&4294967295|a>>>26),a=s+(r^(t|~i))+n[11]+3174756917&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~r))+n[2]+718787259&4294967295,i=s+(a<<15&4294967295|a>>>17),a=r+(s^(i|~t))+n[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}xi.prototype.j=function(e,t){t===void 0&&(t=e.length);for(var r=t-this.blockSize,n=this.m,i=this.h,s=0;s<t;){if(i==0)for(;s<=r;)Vm(this,e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(n[i++]=e.charCodeAt(s++),i==this.blockSize){Vm(this,n),i=0;break}}else for(;s<t;)if(n[i++]=e[s++],i==this.blockSize){Vm(this,n),i=0;break}}this.h=i,this.i+=t};xi.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var r=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=r&255,r/=256;for(this.j(e),e=Array(16),t=r=0;4>t;++t)for(var n=0;32>n;n+=8)e[r++]=this.g[t]>>>n&255;return e};function ft(e,t){this.h=t;for(var r=[],n=!0,i=e.length-1;0<=i;i--){var s=e[i]|0;n&&s==t||(r[i]=s,n=!1)}this.g=r}var c8={};function r_(e){return-128<=e&&128>e?g5(e,function(t){return new ft([t|0],0>t?-1:0)}):new ft([e|0],0>e?-1:0)}function Fi(e){if(isNaN(e)||!isFinite(e))return fc;if(0>e)return wr(Fi(-e));for(var t=[],r=1,n=0;e>=r;n++)t[n]=e/r|0,r*=U1;return new ft(t,0)}function FI(e,t){if(e.length==0)throw Error("number format error: empty string");if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(e.charAt(0)=="-")return wr(FI(e.substring(1),t));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=Fi(Math.pow(t,8)),n=fc,i=0;i<e.length;i+=8){var s=Math.min(8,e.length-i),a=parseInt(e.substring(i,i+s),t);8>s?(s=Fi(Math.pow(t,s)),n=n.R(s).add(Fi(a))):(n=n.R(r),n=n.add(Fi(a)))}return n}var U1=4294967296,fc=r_(0),$1=r_(1),Bw=r_(16777216);Ee=ft.prototype;Ee.ea=function(){if(Xn(this))return-wr(this).ea();for(var e=0,t=1,r=0;r<this.g.length;r++){var n=this.D(r);e+=(0<=n?n:U1+n)*t,t*=U1}return e};Ee.toString=function(e){if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(is(this))return"0";if(Xn(this))return"-"+wr(this).toString(e);for(var t=Fi(Math.pow(e,6)),r=this,n="";;){var i=Gd(r,t).g;r=Wd(r,i.R(t));var s=((0<r.g.length?r.g[0]:r.h)>>>0).toString(e);if(r=i,is(r))return s+n;for(;6>s.length;)s="0"+s;n=s+n}};Ee.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h};function is(e){if(e.h!=0)return!1;for(var t=0;t<e.g.length;t++)if(e.g[t]!=0)return!1;return!0}function Xn(e){return e.h==-1}Ee.X=function(e){return e=Wd(this,e),Xn(e)?-1:is(e)?0:1};function wr(e){for(var t=e.g.length,r=[],n=0;n<t;n++)r[n]=~e.g[n];return new ft(r,~e.h).add($1)}Ee.abs=function(){return Xn(this)?wr(this):this};Ee.add=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0,i=0;i<=t;i++){var s=n+(this.D(i)&65535)+(e.D(i)&65535),a=(s>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);n=a>>>16,s&=65535,a&=65535,r[i]=a<<16|s}return new ft(r,r[r.length-1]&-2147483648?-1:0)};function Wd(e,t){return e.add(wr(t))}Ee.R=function(e){if(is(this)||is(e))return fc;if(Xn(this))return Xn(e)?wr(this).R(wr(e)):wr(wr(this).R(e));if(Xn(e))return wr(this.R(wr(e)));if(0>this.X(Bw)&&0>e.X(Bw))return Fi(this.ea()*e.ea());for(var t=this.g.length+e.g.length,r=[],n=0;n<2*t;n++)r[n]=0;for(n=0;n<this.g.length;n++)for(var i=0;i<e.g.length;i++){var s=this.D(n)>>>16,a=this.D(n)&65535,o=e.D(i)>>>16,c=e.D(i)&65535;r[2*n+2*i]+=a*c,fh(r,2*n+2*i),r[2*n+2*i+1]+=s*c,fh(r,2*n+2*i+1),r[2*n+2*i+1]+=a*o,fh(r,2*n+2*i+1),r[2*n+2*i+2]+=s*o,fh(r,2*n+2*i+2)}for(n=0;n<t;n++)r[n]=r[2*n+1]<<16|r[2*n];for(n=t;n<2*t;n++)r[n]=0;return new ft(r,0)};function fh(e,t){for(;(e[t]&65535)!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function pl(e,t){this.g=e,this.h=t}function Gd(e,t){if(is(t))throw Error("division by zero");if(is(e))return new pl(fc,fc);if(Xn(e))return t=Gd(wr(e),t),new pl(wr(t.g),wr(t.h));if(Xn(t))return t=Gd(e,wr(t)),new pl(wr(t.g),t.h);if(30<e.g.length){if(Xn(e)||Xn(t))throw Error("slowDivide_ only works with positive integers.");for(var r=$1,n=t;0>=n.X(e);)r=Uw(r),n=Uw(n);var i=Fo(r,1),s=Fo(n,1);for(n=Fo(n,2),r=Fo(r,2);!is(n);){var a=s.add(n);0>=a.X(e)&&(i=i.add(r),s=a),n=Fo(n,1),r=Fo(r,1)}return t=Wd(e,i.R(t)),new pl(i,t)}for(i=fc;0<=e.X(t);){for(r=Math.max(1,Math.floor(e.ea()/t.ea())),n=Math.ceil(Math.log(r)/Math.LN2),n=48>=n?1:Math.pow(2,n-48),s=Fi(r),a=s.R(t);Xn(a)||0<a.X(e);)r-=n,s=Fi(r),a=s.R(t);is(s)&&(s=$1),i=i.add(s),e=Wd(e,a)}return new pl(i,e)}Ee.gb=function(e){return Gd(this,e).h};Ee.and=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.D(n)&e.D(n);return new ft(r,this.h&e.h)};Ee.or=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.D(n)|e.D(n);return new ft(r,this.h|e.h)};Ee.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.D(n)^e.D(n);return new ft(r,this.h^e.h)};function Uw(e){for(var t=e.g.length+1,r=[],n=0;n<t;n++)r[n]=e.D(n)<<1|e.D(n-1)>>>31;return new ft(r,e.h)}function Fo(e,t){var r=t>>5;t%=32;for(var n=e.g.length-r,i=[],s=0;s<n;s++)i[s]=0<t?e.D(s+r)>>>t|e.D(s+r+1)<<32-t:e.D(s+r);return new ft(i,e.h)}zd.prototype.createWebChannel=zd.prototype.g;Ln.prototype.send=Ln.prototype.u;Ln.prototype.open=Ln.prototype.m;Ln.prototype.close=Ln.prototype.close;np.NO_ERROR=0;np.TIMEOUT=8;np.HTTP_ERROR=6;XC.COMPLETE="complete";YC.EventType=Ef;Ef.OPEN="a";Ef.CLOSE="b";Ef.ERROR="c";Ef.MESSAGE="d";pr.prototype.listen=pr.prototype.O;Lt.prototype.listenOnce=Lt.prototype.P;Lt.prototype.getLastError=Lt.prototype.Sa;Lt.prototype.getLastErrorCode=Lt.prototype.Ia;Lt.prototype.getStatus=Lt.prototype.da;Lt.prototype.getResponseJson=Lt.prototype.Wa;Lt.prototype.getResponseText=Lt.prototype.ja;Lt.prototype.send=Lt.prototype.ha;Lt.prototype.setWithCredentials=Lt.prototype.Oa;xi.prototype.digest=xi.prototype.l;xi.prototype.reset=xi.prototype.reset;xi.prototype.update=xi.prototype.j;ft.prototype.add=ft.prototype.add;ft.prototype.multiply=ft.prototype.R;ft.prototype.modulo=ft.prototype.gb;ft.prototype.compare=ft.prototype.X;ft.prototype.toNumber=ft.prototype.ea;ft.prototype.toString=ft.prototype.toString;ft.prototype.getBits=ft.prototype.D;ft.fromNumber=Fi;ft.fromString=FI;var l8=function(){return new zd},u8=function(){return rp()},jm=np,f8=XC,h8=yo,$w={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},d8=Sf,hh=YC,p8=Lt,m8=xi,hc=ft;const Hw="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Lr.UNAUTHENTICATED=new Lr(null),Lr.GOOGLE_CREDENTIALS=new Lr("google-credentials-uid"),Lr.FIRST_PARTY=new Lr("first-party-uid"),Lr.MOCK_USER=new Lr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gc="10.5.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const io=new Tx("@firebase/firestore");function ml(){return io.logLevel}function Ce(e,...t){if(io.logLevel<=Qe.DEBUG){const r=t.map(n_);io.debug(`Firestore (${Gc}): ${e}`,...r)}}function gs(e,...t){if(io.logLevel<=Qe.ERROR){const r=t.map(n_);io.error(`Firestore (${Gc}): ${e}`,...r)}}function Cc(e,...t){if(io.logLevel<=Qe.WARN){const r=t.map(n_);io.warn(`Firestore (${Gc}): ${e}`,...r)}}function n_(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(e="Unexpected state"){const t=`FIRESTORE (${Gc}) INTERNAL ASSERTION FAILED: `+e;throw gs(t),new Error(t)}function wt(e,t){e||Le()}function He(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends Wi{constructor(t,r){super(t,r),this.code=t,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(){this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(t,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class g8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,r){t.enqueueRetryable(()=>r(Lr.UNAUTHENTICATED))}shutdown(){}}class v8{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,r){this.changeListener=r,t.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class x8{constructor(t){this.t=t,this.currentUser=Lr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,r){let n=this.i;const i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let s=new os;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new os,t.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const c=s;t.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},o=c=>{Ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?o(c):(Ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new os)}},0),a()}getToken(){const t=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==t?(Ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(wt(typeof n.accessToken=="string"),new PI(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return wt(t===null||typeof t=="string"),new Lr(t)}}class _8{constructor(t,r,n){this.l=t,this.h=r,this.P=n,this.type="FirstParty",this.user=Lr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class y8{constructor(t,r,n){this.l=t,this.h=r,this.P=n}getToken(){return Promise.resolve(new _8(this.l,this.h,this.P))}start(t,r){t.enqueueRetryable(()=>r(Lr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class E8{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class w8{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,r){const n=s=>{s.error!=null&&Ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Ce("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>n(s))};const i=s=>{Ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(r=>r?(wt(typeof r.token=="string"),this.R=r.token,new E8(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T8(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(r);else for(let n=0;n<e;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NI{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const i=T8(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=t.charAt(i[s]%t.length))}return n}}function lt(e,t){return e<t?-1:e>t?1:0}function Ic(e,t,r){return e.length===t.length&&e.every((n,i)=>r(n,t[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(t,r){if(this.seconds=t,this.nanoseconds=r,r<0)throw new Te(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Te(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(t<-62135596800)throw new Te(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Te(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return nr.fromMillis(Date.now())}static fromDate(t){return nr.fromMillis(t.getTime())}static fromMillis(t){const r=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*r));return new nr(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?lt(this.nanoseconds,t.nanoseconds):lt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(t){this.timestamp=t}static fromTimestamp(t){return new je(t)}static min(){return new je(new nr(0,0))}static max(){return new je(new nr(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(t,r,n){r===void 0?r=0:r>t.length&&Le(),n===void 0?n=t.length-r:n>t.length-r&&Le(),this.segments=t,this.offset=r,this.len=n}get length(){return this.len}isEqual(t){return Bu.comparator(this,t)===0}child(t){const r=this.segments.slice(this.offset,this.limit());return t instanceof Bu?t.forEach(n=>{r.push(n)}):r.push(t),this.construct(r)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}forEach(t){for(let r=this.offset,n=this.limit();r<n;r++)t(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,r){const n=Math.min(t.length,r.length);for(let i=0;i<n;i++){const s=t.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return t.length<r.length?-1:t.length>r.length?1:0}}class yt extends Bu{construct(t,r,n){return new yt(t,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const r=[];for(const n of t){if(n.indexOf("//")>=0)throw new Te(se.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new yt(r)}static emptyPath(){return new yt([])}}const S8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Tr extends Bu{construct(t,r,n){return new Tr(t,r,n)}static isValidIdentifier(t){return S8.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Tr.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Tr(["__name__"])}static fromServerFormat(t){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new Te(se.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<t.length;){const o=t[i];if(o==="\\"){if(i+1===t.length)throw new Te(se.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const c=t[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Te(se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=c,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new Te(se.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Tr(r)}static emptyPath(){return new Tr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(t){this.path=t}static fromPath(t){return new be(yt.fromString(t))}static fromName(t){return new be(yt.fromString(t).popFirst(5))}static empty(){return new be(yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&yt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,r){return yt.comparator(t.path,r.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new be(new yt(t.slice()))}}function A8(e,t){const r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1,i=je.fromTimestamp(n===1e9?new nr(r+1,0):new nr(r,n));return new ca(i,be.empty(),t)}function k8(e){return new ca(e.readTime,e.key,-1)}class ca{constructor(t,r,n){this.readTime=t,this.documentKey=r,this.largestBatchId=n}static min(){return new ca(je.min(),be.empty(),-1)}static max(){return new ca(je.max(),be.empty(),-1)}}function C8(e,t){let r=e.readTime.compareTo(t.readTime);return r!==0?r:(r=be.comparator(e.documentKey,t.documentKey),r!==0?r:lt(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I8="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class R8{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cf(e){if(e.code!==se.FAILED_PRECONDITION||e.message!==I8)throw e;Ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(t){return this.next(void 0,t)}next(t,r){return this.callbackAttached&&Le(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(t,this.result):new le((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((t,r)=>{this.next(t,r)})}wrapUserFunction(t){try{const r=t();return r instanceof le?r:le.resolve(r)}catch(r){return le.reject(r)}}wrapSuccess(t,r){return t?this.wrapUserFunction(()=>t(r)):le.resolve(r)}wrapFailure(t,r){return t?this.wrapUserFunction(()=>t(r)):le.reject(r)}static resolve(t){return new le((r,n)=>{r(t)})}static reject(t){return new le((r,n)=>{n(t)})}static waitFor(t){return new le((r,n)=>{let i=0,s=0,a=!1;t.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},c=>n(c))}),a=!0,s===i&&r()})}static or(t){let r=le.resolve(!1);for(const n of t)r=r.next(i=>i?le.resolve(i):n());return r}static forEach(t,r){const n=[];return t.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(t,r){return new le((n,i)=>{const s=t.length,a=new Array(s);let o=0;for(let c=0;c<s;c++){const l=c;r(t[l]).next(u=>{a[l]=u,++o,o===s&&n(a)},u=>i(u))}})}static doWhile(t,r){return new le((n,i)=>{const s=()=>{t()===!0?r().next(()=>{s()},i):n()};s()})}}function If(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=n=>this.se(n),this.oe=n=>r.writeSequenceNumber(n))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}i_._e=-1;function fp(e){return e==null}function qd(e){return e===0&&1/e==-1/0}function b8(e){return typeof e=="number"&&Number.isInteger(e)&&!qd(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zw(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function Eo(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function DI(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(t,r){this.comparator=t,this.root=r||_r.EMPTY}insert(t,r){return new Ft(this.comparator,this.root.insert(t,r,this.comparator).copy(null,null,_r.BLACK,null,null))}remove(t){return new Ft(this.comparator,this.root.remove(t,this.comparator).copy(null,null,_r.BLACK,null,null))}get(t){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(t,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(t){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((r,n)=>(t(r,n),!1))}toString(){const t=[];return this.inorderTraversal((r,n)=>(t.push(`${r}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new dh(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new dh(this.root,t,this.comparator,!1)}getReverseIterator(){return new dh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new dh(this.root,t,this.comparator,!0)}}class dh{constructor(t,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=r?n(t.key,r):1,r&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const r={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class _r{constructor(t,r,n,i,s){this.key=t,this.value=r,this.color=n??_r.RED,this.left=i??_r.EMPTY,this.right=s??_r.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,n,i,s){return new _r(t??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,n){let i=this;const s=n(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(t,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return _r.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let n,i=this;if(r(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(t,i.key)===0){if(i.right.isEmpty())return _r.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,_r.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,_r.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Le();const t=this.left.check();if(t!==this.right.check())throw Le();return t+(this.isRed()?0:1)}}_r.EMPTY=null,_r.RED=!0,_r.BLACK=!1;_r.EMPTY=new class{constructor(){this.size=0}get key(){throw Le()}get value(){throw Le()}get color(){throw Le()}get left(){throw Le()}get right(){throw Le()}copy(t,r,n,i,s){return this}insert(t,r,n){return new _r(t,r)}remove(t,r){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(t){this.comparator=t,this.data=new Ft(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((r,n)=>(t(r),!1))}forEachInRange(t,r){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;r(i.key)}}forEachWhile(t,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const r=this.data.getIteratorFrom(t);return r.hasNext()?r.getNext().key:null}getIterator(){return new Ww(this.data.getIterator())}getIteratorFrom(t){return new Ww(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let r=this;return r.size<t.size&&(r=t,t=this),t.forEach(n=>{r=r.add(n)}),r}isEqual(t){if(!(t instanceof kr)||this.size!==t.size)return!1;const r=this.data.getIterator(),n=t.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(r=>{t.push(r)}),t}toString(){const t=[];return this.forEach(r=>t.push(r)),"SortedSet("+t.toString()+")"}copy(t){const r=new kr(this.comparator);return r.data=t,r}}class Ww{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(t){this.fields=t,t.sort(Tr.comparator)}static empty(){return new bn([])}unionWith(t){let r=new kr(Tr.comparator);for(const n of this.fields)r=r.add(n);for(const n of t)r=r.add(n);return new bn(r.toArray())}covers(t){for(const r of this.fields)if(r.isPrefixOf(t))return!0;return!1}isEqual(t){return Ic(this.fields,t.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(t){this.binaryString=t}static fromBase64String(t){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new OI("Invalid base64 string: "+s):s}}(t);return new Kr(r)}static fromUint8Array(t){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(t);return new Kr(r)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return lt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Kr.EMPTY_BYTE_STRING=new Kr("");const F8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function la(e){if(wt(!!e),typeof e=="string"){let t=0;const r=F8.exec(e);if(wt(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),t=Number(i)}const n=new Date(e);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:Kt(e.seconds),nanos:Kt(e.nanos)}}function Kt(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function so(e){return typeof e=="string"?Kr.fromBase64String(e):Kr.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s_(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function a_(e){const t=e.mapValue.fields.__previous_value__;return s_(t)?a_(t):t}function Uu(e){const t=la(e.mapValue.fields.__local_write_time__.timestampValue);return new nr(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P8{constructor(t,r,n,i,s,a,o,c,l){this.databaseId=t,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=l}}class $u{constructor(t,r){this.projectId=t,this.database=r||"(default)"}static empty(){return new $u("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof $u&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ph={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function ao(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?s_(e)?4:N8(e)?9007199254740991:10:Le()}function Hi(e,t){if(e===t)return!0;const r=ao(e);if(r!==ao(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Uu(e).isEqual(Uu(t));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=la(i.timestampValue),o=la(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(i,s){return so(i.bytesValue).isEqual(so(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(i,s){return Kt(i.geoPointValue.latitude)===Kt(s.geoPointValue.latitude)&&Kt(i.geoPointValue.longitude)===Kt(s.geoPointValue.longitude)}(e,t);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Kt(i.integerValue)===Kt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Kt(i.doubleValue),o=Kt(s.doubleValue);return a===o?qd(a)===qd(o):isNaN(a)&&isNaN(o)}return!1}(e,t);case 9:return Ic(e.arrayValue.values||[],t.arrayValue.values||[],Hi);case 10:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(zw(a)!==zw(o))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(o[c]===void 0||!Hi(a[c],o[c])))return!1;return!0}(e,t);default:return Le()}}function Hu(e,t){return(e.values||[]).find(r=>Hi(r,t))!==void 0}function Rc(e,t){if(e===t)return 0;const r=ao(e),n=ao(t);if(r!==n)return lt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return lt(e.booleanValue,t.booleanValue);case 2:return function(s,a){const o=Kt(s.integerValue||s.doubleValue),c=Kt(a.integerValue||a.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(e,t);case 3:return Gw(e.timestampValue,t.timestampValue);case 4:return Gw(Uu(e),Uu(t));case 5:return lt(e.stringValue,t.stringValue);case 6:return function(s,a){const o=so(s),c=so(a);return o.compareTo(c)}(e.bytesValue,t.bytesValue);case 7:return function(s,a){const o=s.split("/"),c=a.split("/");for(let l=0;l<o.length&&l<c.length;l++){const u=lt(o[l],c[l]);if(u!==0)return u}return lt(o.length,c.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,a){const o=lt(Kt(s.latitude),Kt(a.latitude));return o!==0?o:lt(Kt(s.longitude),Kt(a.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(s,a){const o=s.values||[],c=a.values||[];for(let l=0;l<o.length&&l<c.length;++l){const u=Rc(o[l],c[l]);if(u)return u}return lt(o.length,c.length)}(e.arrayValue,t.arrayValue);case 10:return function(s,a){if(s===ph.mapValue&&a===ph.mapValue)return 0;if(s===ph.mapValue)return 1;if(a===ph.mapValue)return-1;const o=s.fields||{},c=Object.keys(o),l=a.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let f=0;f<c.length&&f<u.length;++f){const d=lt(c[f],u[f]);if(d!==0)return d;const p=Rc(o[c[f]],l[u[f]]);if(p!==0)return p}return lt(c.length,u.length)}(e.mapValue,t.mapValue);default:throw Le()}}function Gw(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return lt(e,t);const r=la(e),n=la(t),i=lt(r.seconds,n.seconds);return i!==0?i:lt(r.nanos,n.nanos)}function bc(e){return H1(e)}function H1(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(r){const n=la(r);return`time(${n.seconds},${n.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(r){return so(r).toBase64()}(e.bytesValue):"referenceValue"in e?function(r){return be.fromName(r).toString()}(e.referenceValue):"geoPointValue"in e?function(r){return`geo(${r.latitude},${r.longitude})`}(e.geoPointValue):"arrayValue"in e?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=H1(s);return n+"]"}(e.arrayValue):"mapValue"in e?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${H1(r.fields[a])}`;return i+"}"}(e.mapValue):Le()}function qw(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function z1(e){return!!e&&"integerValue"in e}function o_(e){return!!e&&"arrayValue"in e}function Kw(e){return!!e&&"nullValue"in e}function Xw(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Xh(e){return!!e&&"mapValue"in e}function Kl(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Eo(e.mapValue.fields,(r,n)=>t.mapValue.fields[r]=Kl(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=Kl(e.arrayValue.values[r]);return t}return Object.assign({},e)}function N8(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(t){this.value=t}static empty(){return new gn({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let r=this.value;for(let n=0;n<t.length-1;++n)if(r=(r.mapValue.fields||{})[t.get(n)],!Xh(r))return null;return r=(r.mapValue.fields||{})[t.lastSegment()],r||null}}set(t,r){this.getFieldsMap(t.popLast())[t.lastSegment()]=Kl(r)}setAll(t){let r=Tr.emptyPath(),n={},i=[];t.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=Kl(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(t){const r=this.field(t.popLast());Xh(r)&&r.mapValue.fields&&delete r.mapValue.fields[t.lastSegment()]}isEqual(t){return Hi(this.value,t.value)}getFieldsMap(t){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=r.mapValue.fields[t.get(n)];Xh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[t.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(t,r,n){Eo(r,(i,s)=>t[i]=s);for(const i of n)delete t[i]}clone(){return new gn(Kl(this.value))}}function LI(e){const t=[];return Eo(e.fields,(r,n)=>{const i=new Tr([r]);if(Xh(n)){const s=LI(n.mapValue).fields;if(s.length===0)t.push(i);else for(const a of s)t.push(i.child(a))}else t.push(i)}),new bn(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(t,r,n,i,s,a,o){this.key=t,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(t){return new Br(t,0,je.min(),je.min(),je.min(),gn.empty(),0)}static newFoundDocument(t,r,n,i){return new Br(t,1,r,je.min(),n,i,0)}static newNoDocument(t,r){return new Br(t,2,r,je.min(),je.min(),gn.empty(),0)}static newUnknownDocument(t,r){return new Br(t,3,r,je.min(),je.min(),gn.empty(),2)}convertToFoundDocument(t,r){return!this.createTime.isEqual(je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=gn.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=gn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=je.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Br&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Br(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(t,r){this.position=t,this.inclusive=r}}function Yw(e,t,r){let n=0;for(let i=0;i<e.position.length;i++){const s=t[i],a=e.position[i];if(s.field.isKeyField()?n=be.comparator(be.fromName(a.referenceValue),r.key):n=Rc(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function Qw(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!Hi(e.position[r],t.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(t,r="asc"){this.field=t,this.dir=r}}function D8(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{}class Qt extends MI{constructor(t,r,n){super(),this.field=t,this.op=r,this.value=n}static create(t,r,n){return t.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(t,r,n):new L8(t,r,n):r==="array-contains"?new j8(t,n):r==="in"?new B8(t,n):r==="not-in"?new U8(t,n):r==="array-contains-any"?new $8(t,n):new Qt(t,r,n)}static createKeyFieldInFilter(t,r,n){return r==="in"?new M8(t,n):new V8(t,n)}matches(t){const r=t.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Rc(r,this.value)):r!==null&&ao(this.value)===ao(r)&&this.matchesComparison(Rc(r,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Le()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class _i extends MI{constructor(t,r){super(),this.filters=t,this.op=r,this.ue=null}static create(t,r){return new _i(t,r)}matches(t){return VI(this)?this.filters.find(r=>!r.matches(t))===void 0:this.filters.find(r=>r.matches(t))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((t,r)=>t.concat(r.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function VI(e){return e.op==="and"}function jI(e){return O8(e)&&VI(e)}function O8(e){for(const t of e.filters)if(t instanceof _i)return!1;return!0}function W1(e){if(e instanceof Qt)return e.field.canonicalString()+e.op.toString()+bc(e.value);if(jI(e))return e.filters.map(t=>W1(t)).join(",");{const t=e.filters.map(r=>W1(r)).join(",");return`${e.op}(${t})`}}function BI(e,t){return e instanceof Qt?function(n,i){return i instanceof Qt&&n.op===i.op&&n.field.isEqual(i.field)&&Hi(n.value,i.value)}(e,t):e instanceof _i?function(n,i){return i instanceof _i&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&BI(a,i.filters[o]),!0):!1}(e,t):void Le()}function UI(e){return e instanceof Qt?function(r){return`${r.field.canonicalString()} ${r.op} ${bc(r.value)}`}(e):e instanceof _i?function(r){return r.op.toString()+" {"+r.getFilters().map(UI).join(" ,")+"}"}(e):"Filter"}class L8 extends Qt{constructor(t,r,n){super(t,r,n),this.key=be.fromName(n.referenceValue)}matches(t){const r=be.comparator(t.key,this.key);return this.matchesComparison(r)}}class M8 extends Qt{constructor(t,r){super(t,"in",r),this.keys=$I("in",r)}matches(t){return this.keys.some(r=>r.isEqual(t.key))}}class V8 extends Qt{constructor(t,r){super(t,"not-in",r),this.keys=$I("not-in",r)}matches(t){return!this.keys.some(r=>r.isEqual(t.key))}}function $I(e,t){var r;return(((r=t.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>be.fromName(n.referenceValue))}class j8 extends Qt{constructor(t,r){super(t,"array-contains",r)}matches(t){const r=t.data.field(this.field);return o_(r)&&Hu(r.arrayValue,this.value)}}class B8 extends Qt{constructor(t,r){super(t,"in",r)}matches(t){const r=t.data.field(this.field);return r!==null&&Hu(this.value.arrayValue,r)}}class U8 extends Qt{constructor(t,r){super(t,"not-in",r)}matches(t){if(Hu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=t.data.field(this.field);return r!==null&&!Hu(this.value.arrayValue,r)}}class $8 extends Qt{constructor(t,r){super(t,"array-contains-any",r)}matches(t){const r=t.data.field(this.field);return!(!o_(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Hu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H8{constructor(t,r=null,n=[],i=[],s=null,a=null,o=null){this.path=t,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ce=null}}function Jw(e,t=null,r=[],n=[],i=null,s=null,a=null){return new H8(e,t,r,n,i,s,a)}function c_(e){const t=He(e);if(t.ce===null){let r=t.path.canonicalString();t.collectionGroup!==null&&(r+="|cg:"+t.collectionGroup),r+="|f:",r+=t.filters.map(n=>W1(n)).join(","),r+="|ob:",r+=t.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),fp(t.limit)||(r+="|l:",r+=t.limit),t.startAt&&(r+="|lb:",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(n=>bc(n)).join(",")),t.endAt&&(r+="|ub:",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(n=>bc(n)).join(",")),t.ce=r}return t.ce}function l_(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!D8(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!BI(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Qw(e.startAt,t.startAt)&&Qw(e.endAt,t.endAt)}function G1(e){return be.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(t,r=null,n=[],i=[],s=null,a="F",o=null,c=null){this.path=t,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=c,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function z8(e,t,r,n,i,s,a,o){return new qc(e,t,r,n,i,s,a,o)}function u_(e){return new qc(e)}function Zw(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function HI(e){return e.collectionGroup!==null}function Xl(e){const t=He(e);if(t.le===null){t.le=[];const r=new Set;for(const s of t.explicitOrderBy)t.le.push(s),r.add(s.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new kr(Tr.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(o=o.add(l.field))})}),o})(t).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||t.le.push(new zu(s,n))}),r.has(Tr.keyField().canonicalString())||t.le.push(new zu(Tr.keyField(),n))}return t.le}function ji(e){const t=He(e);return t.he||(t.he=W8(t,Xl(e))),t.he}function W8(e,t){if(e.limitType==="F")return Jw(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new zu(i.field,s)});const r=e.endAt?new Kd(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new Kd(e.startAt.position,e.startAt.inclusive):null;return Jw(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function q1(e,t){const r=e.filters.concat([t]);return new qc(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function Xd(e,t,r){return new qc(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function hp(e,t){return l_(ji(e),ji(t))&&e.limitType===t.limitType}function zI(e){return`${c_(ji(e))}|lt:${e.limitType}`}function Oo(e){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>UI(i)).join(", ")}]`),fp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>bc(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>bc(i)).join(",")),`Target(${n})`}(ji(e))}; limitType=${e.limitType})`}function dp(e,t){return t.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):be.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(e,t)&&function(n,i){for(const s of Xl(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(e,t)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(e,t)&&function(n,i){return!(n.startAt&&!function(a,o,c){const l=Yw(a,o,c);return a.inclusive?l<=0:l<0}(n.startAt,Xl(n),i)||n.endAt&&!function(a,o,c){const l=Yw(a,o,c);return a.inclusive?l>=0:l>0}(n.endAt,Xl(n),i))}(e,t)}function G8(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function WI(e){return(t,r)=>{let n=!1;for(const i of Xl(e)){const s=q8(i,t,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function q8(e,t,r){const n=e.field.isKeyField()?be.comparator(t.key,r.key):function(s,a,o){const c=a.data.field(s),l=o.data.field(s);return c!==null&&l!==null?Rc(c,l):Le()}(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return Le()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(t,r){this.mapKeyFn=t,this.equalsFn=r,this.inner={},this.innerSize=0}get(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,t))return s}}has(t){return this.get(t)!==void 0}set(t,r){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return this.inner[n]=[[t,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,r]);i.push([t,r]),this.innerSize++}delete(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Eo(this.inner,(r,n)=>{for(const[i,s]of n)t(i,s)})}isEmpty(){return DI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K8=new Ft(be.comparator);function vs(){return K8}const GI=new Ft(be.comparator);function Il(...e){let t=GI;for(const r of e)t=t.insert(r.key,r);return t}function qI(e){let t=GI;return e.forEach((r,n)=>t=t.insert(r,n.overlayedDocument)),t}function ja(){return Yl()}function KI(){return Yl()}function Yl(){return new Kc(e=>e.toString(),(e,t)=>e.isEqual(t))}const X8=new Ft(be.comparator),Y8=new kr(be.comparator);function Xe(...e){let t=Y8;for(const r of e)t=t.add(r);return t}const Q8=new kr(lt);function J8(){return Q8}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XI(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qd(t)?"-0":t}}function YI(e){return{integerValue:""+e}}function Z8(e,t){return b8(t)?YI(t):XI(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(){this._=void 0}}function eV(e,t,r){return e instanceof Yd?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&s_(s)&&(s=a_(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,t):e instanceof Wu?JI(e,t):e instanceof Gu?ZI(e,t):function(i,s){const a=QI(i,s),o=e2(a)+e2(i.Ie);return z1(a)&&z1(i.Ie)?YI(o):XI(i.serializer,o)}(e,t)}function tV(e,t,r){return e instanceof Wu?JI(e,t):e instanceof Gu?ZI(e,t):r}function QI(e,t){return e instanceof Qd?function(n){return z1(n)||function(s){return!!s&&"doubleValue"in s}(n)}(t)?t:{integerValue:0}:null}class Yd extends pp{}class Wu extends pp{constructor(t){super(),this.elements=t}}function JI(e,t){const r=eR(t);for(const n of e.elements)r.some(i=>Hi(i,n))||r.push(n);return{arrayValue:{values:r}}}class Gu extends pp{constructor(t){super(),this.elements=t}}function ZI(e,t){let r=eR(t);for(const n of e.elements)r=r.filter(i=>!Hi(i,n));return{arrayValue:{values:r}}}class Qd extends pp{constructor(t,r){super(),this.serializer=t,this.Ie=r}}function e2(e){return Kt(e.integerValue||e.doubleValue)}function eR(e){return o_(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function rV(e,t){return e.field.isEqual(t.field)&&function(n,i){return n instanceof Wu&&i instanceof Wu||n instanceof Gu&&i instanceof Gu?Ic(n.elements,i.elements,Hi):n instanceof Qd&&i instanceof Qd?Hi(n.Ie,i.Ie):n instanceof Yd&&i instanceof Yd}(e.transform,t.transform)}class nV{constructor(t,r){this.version=t,this.transformResults=r}}class Bi{constructor(t,r){this.updateTime=t,this.exists=r}static none(){return new Bi}static exists(t){return new Bi(void 0,t)}static updateTime(t){return new Bi(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Yh(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class mp{}function tR(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new nR(e.key,Bi.none()):new Rf(e.key,e.data,Bi.none());{const r=e.data,n=gn.empty();let i=new kr(Tr.comparator);for(let s of t.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new ya(e.key,n,new bn(i.toArray()),Bi.none())}}function iV(e,t,r){e instanceof Rf?function(i,s,a){const o=i.value.clone(),c=r2(i.fieldTransforms,s,a.transformResults);o.setAll(c),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(e,t,r):e instanceof ya?function(i,s,a){if(!Yh(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=r2(i.fieldTransforms,s,a.transformResults),c=s.data;c.setAll(rR(i)),c.setAll(o),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(e,t,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,t,r)}function Ql(e,t,r,n){return e instanceof Rf?function(s,a,o,c){if(!Yh(s.precondition,a))return o;const l=s.value.clone(),u=n2(s.fieldTransforms,c,a);return l.setAll(u),a.convertToFoundDocument(a.version,l).setHasLocalMutations(),null}(e,t,r,n):e instanceof ya?function(s,a,o,c){if(!Yh(s.precondition,a))return o;const l=n2(s.fieldTransforms,c,a),u=a.data;return u.setAll(rR(s)),u.setAll(l),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(e,t,r,n):function(s,a,o){return Yh(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(e,t,r)}function sV(e,t){let r=null;for(const n of e.fieldTransforms){const i=t.data.field(n.field),s=QI(n.transform,i||null);s!=null&&(r===null&&(r=gn.empty()),r.set(n.field,s))}return r||null}function t2(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Ic(n,i,(s,a)=>rV(s,a))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Rf extends mp{constructor(t,r,n,i=[]){super(),this.key=t,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ya extends mp{constructor(t,r,n,i,s=[]){super(),this.key=t,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function rR(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=e.data.field(r);t.set(r,n)}}),t}function r2(e,t,r){const n=new Map;wt(e.length===r.length);for(let i=0;i<r.length;i++){const s=e[i],a=s.transform,o=t.data.field(s.field);n.set(s.field,tV(a,o,r[i]))}return n}function n2(e,t,r){const n=new Map;for(const i of e){const s=i.transform,a=r.data.field(i.field);n.set(i.field,eV(s,a,t))}return n}class nR extends mp{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class aV extends mp{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(t,r,n,i){this.batchId=t,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(t.key)&&iV(s,t,n[i])}}applyToLocalView(t,r){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(r=Ql(n,t,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(r=Ql(n,t,r,this.localWriteTime));return r}applyToLocalDocumentSet(t,r){const n=KI();return this.mutations.forEach(i=>{const s=t.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const c=tR(a,o);c!==null&&n.set(i.key,c),a.isValidDocument()||a.convertToNoDocument(je.min())}),n}keys(){return this.mutations.reduce((t,r)=>t.add(r.key),Xe())}isEqual(t){return this.batchId===t.batchId&&Ic(this.mutations,t.mutations,(r,n)=>t2(r,n))&&Ic(this.baseMutations,t.baseMutations,(r,n)=>t2(r,n))}}class f_{constructor(t,r,n,i){this.batch=t,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(t,r,n){wt(t.mutations.length===n.length);let i=function(){return X8}();const s=t.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new f_(t,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(t,r){this.largestBatchId=t,this.mutation=r}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(t,r){this.count=t,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wt,et;function uV(e){switch(e){default:return Le();case se.CANCELLED:case se.UNKNOWN:case se.DEADLINE_EXCEEDED:case se.RESOURCE_EXHAUSTED:case se.INTERNAL:case se.UNAVAILABLE:case se.UNAUTHENTICATED:return!1;case se.INVALID_ARGUMENT:case se.NOT_FOUND:case se.ALREADY_EXISTS:case se.PERMISSION_DENIED:case se.FAILED_PRECONDITION:case se.ABORTED:case se.OUT_OF_RANGE:case se.UNIMPLEMENTED:case se.DATA_LOSS:return!0}}function iR(e){if(e===void 0)return gs("GRPC error has no .code"),se.UNKNOWN;switch(e){case Wt.OK:return se.OK;case Wt.CANCELLED:return se.CANCELLED;case Wt.UNKNOWN:return se.UNKNOWN;case Wt.DEADLINE_EXCEEDED:return se.DEADLINE_EXCEEDED;case Wt.RESOURCE_EXHAUSTED:return se.RESOURCE_EXHAUSTED;case Wt.INTERNAL:return se.INTERNAL;case Wt.UNAVAILABLE:return se.UNAVAILABLE;case Wt.UNAUTHENTICATED:return se.UNAUTHENTICATED;case Wt.INVALID_ARGUMENT:return se.INVALID_ARGUMENT;case Wt.NOT_FOUND:return se.NOT_FOUND;case Wt.ALREADY_EXISTS:return se.ALREADY_EXISTS;case Wt.PERMISSION_DENIED:return se.PERMISSION_DENIED;case Wt.FAILED_PRECONDITION:return se.FAILED_PRECONDITION;case Wt.ABORTED:return se.ABORTED;case Wt.OUT_OF_RANGE:return se.OUT_OF_RANGE;case Wt.UNIMPLEMENTED:return se.UNIMPLEMENTED;case Wt.DATA_LOSS:return se.DATA_LOSS;default:return Le()}}(et=Wt||(Wt={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hV=new hc([4294967295,4294967295],0);function i2(e){const t=fV().encode(e),r=new m8;return r.update(t),new Uint8Array(r.digest())}function s2(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new hc([r,n],0),new hc([i,s],0)]}class h_{constructor(t,r,n){if(this.bitmap=t,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Rl(`Invalid padding: ${r}`);if(n<0)throw new Rl(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new Rl(`Invalid hash count: ${n}`);if(t.length===0&&r!==0)throw new Rl(`Invalid padding when bitmap length is 0: ${r}`);this.Te=8*t.length-r,this.Ee=hc.fromNumber(this.Te)}de(t,r,n){let i=t.add(r.multiply(hc.fromNumber(n)));return i.compare(hV)===1&&(i=new hc([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Te===0)return!1;const r=i2(t),[n,i]=s2(r);for(let s=0;s<this.hashCount;s++){const a=this.de(n,i,s);if(!this.Ae(a))return!1}return!0}static create(t,r,n){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),a=new h_(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(t){if(this.Te===0)return;const r=i2(t),[n,i]=s2(r);for(let s=0;s<this.hashCount;s++){const a=this.de(n,i,s);this.Re(a)}}Re(t){const r=Math.floor(t/8),n=t%8;this.bitmap[r]|=1<<n}}class Rl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(t,r,n,i,s){this.snapshotVersion=t,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,r,n){const i=new Map;return i.set(t,bf.createSynthesizedTargetChangeForCurrentChange(t,r,n)),new gp(je.min(),i,new Ft(lt),vs(),Xe())}}class bf{constructor(t,r,n,i,s){this.resumeToken=t,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,r,n){return new bf(n,r,Xe(),Xe(),Xe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(t,r,n,i){this.Ve=t,this.removedTargetIds=r,this.key=n,this.me=i}}class sR{constructor(t,r){this.targetId=t,this.fe=r}}class aR{constructor(t,r,n=Kr.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=r,this.resumeToken=n,this.cause=i}}class a2{constructor(){this.ge=0,this.pe=c2(),this.ye=Kr.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=Xe(),r=Xe(),n=Xe();return this.pe.forEach((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Le()}}),new bf(this.ye,this.we,t,r,n)}Fe(){this.Se=!1,this.pe=c2()}Me(t,r){this.Se=!0,this.pe=this.pe.insert(t,r)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1}Be(){this.Se=!0,this.we=!0}}class dV{constructor(t){this.Le=t,this.ke=new Map,this.qe=vs(),this.Qe=o2(),this.Ke=new Ft(lt)}$e(t){for(const r of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(r,t.me):this.We(r,t.key,t.me);for(const r of t.removedTargetIds)this.We(r,t.key,t.me)}Ge(t){this.forEachTarget(t,r=>{const n=this.ze(r);switch(t.state){case 0:this.je(r)&&n.Ce(t.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(t.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(r);break;case 3:this.je(r)&&(n.Be(),n.Ce(t.resumeToken));break;case 4:this.je(r)&&(this.He(r),n.Ce(t.resumeToken));break;default:Le()}})}forEachTarget(t,r){t.targetIds.length>0?t.targetIds.forEach(r):this.ke.forEach((n,i)=>{this.je(i)&&r(i)})}Je(t){const r=t.targetId,n=t.fe.count,i=this.Ye(r);if(i){const s=i.target;if(G1(s))if(n===0){const a=new be(s.path);this.We(r,a,Br.newNoDocument(a,je.min()))}else wt(n===1);else{const a=this.Ze(r);if(a!==n){const o=this.Xe(t),c=o?this.et(o,t,a):1;if(c!==0){this.He(r);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(r,l)}}}}}Xe(t){const r=t.fe.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=so(n).toUint8Array()}catch(c){if(c instanceof OI)return Cc("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{o=new h_(a,i,s)}catch(c){return Cc(c instanceof Rl?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return o.Te===0?null:o}et(t,r,n){return r.fe.count===n-this.rt(t,r.targetId)?0:2}rt(t,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.nt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;t.mightContain(o)||(this.We(r,s,null),i++)}),i}it(t){const r=new Map;this.ke.forEach((s,a)=>{const o=this.Ye(a);if(o){if(s.current&&G1(o.target)){const c=new be(o.target.path);this.qe.get(c)!==null||this.st(a,c)||this.We(a,c,Br.newNoDocument(c,t))}s.De&&(r.set(a,s.ve()),s.Fe())}});let n=Xe();this.Qe.forEach((s,a)=>{let o=!0;a.forEachWhile(c=>{const l=this.Ye(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.qe.forEach((s,a)=>a.setReadTime(t));const i=new gp(t,r,this.Ke,this.qe,n);return this.qe=vs(),this.Qe=o2(),this.Ke=new Ft(lt),i}Ue(t,r){if(!this.je(t))return;const n=this.st(t,r.key)?2:0;this.ze(t).Me(r.key,n),this.qe=this.qe.insert(r.key,r),this.Qe=this.Qe.insert(r.key,this.ot(r.key).add(t))}We(t,r,n){if(!this.je(t))return;const i=this.ze(t);this.st(t,r)?i.Me(r,1):i.xe(r),this.Qe=this.Qe.insert(r,this.ot(r).delete(t)),n&&(this.qe=this.qe.insert(r,n))}removeTarget(t){this.ke.delete(t)}Ze(t){const r=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+r.addedDocuments.size-r.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let r=this.ke.get(t);return r||(r=new a2,this.ke.set(t,r)),r}ot(t){let r=this.Qe.get(t);return r||(r=new kr(lt),this.Qe=this.Qe.insert(t,r)),r}je(t){const r=this.Ye(t)!==null;return r||Ce("WatchChangeAggregator","Detected inactive target",t),r}Ye(t){const r=this.ke.get(t);return r&&r.be?null:this.Le._t(t)}He(t){this.ke.set(t,new a2),this.Le.getRemoteKeysForTarget(t).forEach(r=>{this.We(t,r,null)})}st(t,r){return this.Le.getRemoteKeysForTarget(t).has(r)}}function o2(){return new Ft(be.comparator)}function c2(){return new Ft(be.comparator)}const pV=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),mV=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),gV=(()=>({and:"AND",or:"OR"}))();class vV{constructor(t,r){this.databaseId=t,this.useProto3Json=r}}function K1(e,t){return e.useProto3Json||fp(t)?t:{value:t}}function Jd(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function oR(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function xV(e,t){return Jd(e,t.toTimestamp())}function Ui(e){return wt(!!e),je.fromTimestamp(function(r){const n=la(r);return new nr(n.seconds,n.nanos)}(e))}function d_(e,t){return function(n){return new yt(["projects",n.projectId,"databases",n.database])}(e).child("documents").child(t).canonicalString()}function cR(e){const t=yt.fromString(e);return wt(hR(t)),t}function X1(e,t){return d_(e.databaseId,t.path)}function Bm(e,t){const r=cR(t);if(r.get(1)!==e.databaseId.projectId)throw new Te(se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new Te(se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new be(lR(r))}function Y1(e,t){return d_(e.databaseId,t)}function _V(e){const t=cR(e);return t.length===4?yt.emptyPath():lR(t)}function Q1(e){return new yt(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function lR(e){return wt(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function l2(e,t,r){return{name:X1(e,t),fields:r.value.mapValue.fields}}function yV(e,t){let r;if("targetChange"in t){t.targetChange;const n=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:Le()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(l,u){return l.useProto3Json?(wt(u===void 0||typeof u=="string"),Kr.fromBase64String(u||"")):(wt(u===void 0||u instanceof Uint8Array),Kr.fromUint8Array(u||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,o=a&&function(l){const u=l.code===void 0?se.UNKNOWN:iR(l.code);return new Te(u,l.message||"")}(a);r=new aR(n,i,s,o||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const i=Bm(e,n.document.name),s=Ui(n.document.updateTime),a=n.document.createTime?Ui(n.document.createTime):je.min(),o=new gn({mapValue:{fields:n.document.fields}}),c=Br.newFoundDocument(i,s,a,o),l=n.targetIds||[],u=n.removedTargetIds||[];r=new Qh(l,u,c.key,c)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const i=Bm(e,n.document),s=n.readTime?Ui(n.readTime):je.min(),a=Br.newNoDocument(i,s),o=n.removedTargetIds||[];r=new Qh([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const i=Bm(e,n.document),s=n.removedTargetIds||[];r=new Qh([],s,i,null)}else{if(!("filter"in t))return Le();{t.filter;const n=t.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new lV(i,s),o=n.targetId;r=new sR(o,a)}}return r}function EV(e,t){let r;if(t instanceof Rf)r={update:l2(e,t.key,t.value)};else if(t instanceof nR)r={delete:X1(e,t.key)};else if(t instanceof ya)r={update:l2(e,t.key,t.data),updateMask:bV(t.fieldMask)};else{if(!(t instanceof aV))return Le();r={verify:X1(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof Yd)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Wu)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Gu)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Qd)return{fieldPath:a.field.canonicalString(),increment:o.Ie};throw Le()}(0,n))),t.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:xV(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Le()}(e,t.precondition)),r}function wV(e,t){return e&&e.length>0?(wt(t!==void 0),e.map(r=>function(i,s){let a=i.updateTime?Ui(i.updateTime):Ui(s);return a.isEqual(je.min())&&(a=Ui(s)),new nV(a,i.transformResults||[])}(r,t))):[]}function TV(e,t){return{documents:[Y1(e,t.path)]}}function SV(e,t){const r={structuredQuery:{}},n=t.path;t.collectionGroup!==null?(r.parent=Y1(e,n),r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r.parent=Y1(e,n.popLast()),r.structuredQuery.from=[{collectionId:n.lastSegment()}]);const i=function(c){if(c.length!==0)return fR(_i.create(c,"and"))}(t.filters);i&&(r.structuredQuery.where=i);const s=function(c){if(c.length!==0)return c.map(l=>function(f){return{field:Lo(f.field),direction:CV(f.dir)}}(l))}(t.orderBy);s&&(r.structuredQuery.orderBy=s);const a=K1(e,t.limit);return a!==null&&(r.structuredQuery.limit=a),t.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),r}function AV(e){let t=_V(e.parent);const r=e.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){wt(n===1);const u=r.from[0];u.allDescendants?i=u.collectionId:t=t.child(u.collectionId)}let s=[];r.where&&(s=function(f){const d=uR(f);return d instanceof _i&&jI(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(f){return f.map(d=>function(g){return new zu(Mo(g.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(f){let d;return d=typeof f=="object"?f.value:f,fp(d)?null:d}(r.limit));let c=null;r.startAt&&(c=function(f){const d=!!f.before,p=f.values||[];return new Kd(p,d)}(r.startAt));let l=null;return r.endAt&&(l=function(f){const d=!f.before,p=f.values||[];return new Kd(p,d)}(r.endAt)),z8(t,i,a,s,o,"F",c,l)}function kV(e,t){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le()}}(t.purpose);return r==null?null:{"goog-listen-tags":r}}function uR(e){return e.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Mo(r.unaryFilter.field);return Qt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Mo(r.unaryFilter.field);return Qt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Mo(r.unaryFilter.field);return Qt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Mo(r.unaryFilter.field);return Qt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Le()}}(e):e.fieldFilter!==void 0?function(r){return Qt.create(Mo(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Le()}}(r.fieldFilter.op),r.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(r){return _i.create(r.compositeFilter.filters.map(n=>uR(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Le()}}(r.compositeFilter.op))}(e):Le()}function CV(e){return pV[e]}function IV(e){return mV[e]}function RV(e){return gV[e]}function Lo(e){return{fieldPath:e.canonicalString()}}function Mo(e){return Tr.fromServerFormat(e.fieldPath)}function fR(e){return e instanceof Qt?function(r){if(r.op==="=="){if(Xw(r.value))return{unaryFilter:{field:Lo(r.field),op:"IS_NAN"}};if(Kw(r.value))return{unaryFilter:{field:Lo(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Xw(r.value))return{unaryFilter:{field:Lo(r.field),op:"IS_NOT_NAN"}};if(Kw(r.value))return{unaryFilter:{field:Lo(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Lo(r.field),op:IV(r.op),value:r.value}}}(e):e instanceof _i?function(r){const n=r.getFilters().map(i=>fR(i));return n.length===1?n[0]:{compositeFilter:{op:RV(r.op),filters:n}}}(e):Le()}function bV(e){const t=[];return e.fields.forEach(r=>t.push(r.canonicalString())),{fieldPaths:t}}function hR(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(t,r,n,i,s=je.min(),a=je.min(),o=Kr.EMPTY_BYTE_STRING,c=null){this.target=t,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=c}withSequenceNumber(t){return new Bs(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,r){return new Bs(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Bs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Bs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FV{constructor(t){this.ut=t}}function PV(e){const t=AV({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Xd(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NV{constructor(){this.on=new DV}addToCollectionParentIndex(t,r){return this.on.add(r),le.resolve()}getCollectionParents(t,r){return le.resolve(this.on.getEntries(r))}addFieldIndex(t,r){return le.resolve()}deleteFieldIndex(t,r){return le.resolve()}deleteAllFieldIndexes(t){return le.resolve()}createTargetIndexes(t,r){return le.resolve()}getDocumentsMatchingTarget(t,r){return le.resolve(null)}getIndexType(t,r){return le.resolve(0)}getFieldIndexes(t,r){return le.resolve([])}getNextCollectionGroupToUpdate(t){return le.resolve(null)}getMinOffset(t,r){return le.resolve(ca.min())}getMinOffsetFromCollectionGroup(t,r){return le.resolve(ca.min())}updateCollectionGroup(t,r,n){return le.resolve()}updateIndexEntries(t,r){return le.resolve()}}class DV{constructor(){this.index={}}add(t){const r=t.lastSegment(),n=t.popLast(),i=this.index[r]||new kr(yt.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(t){const r=t.lastSegment(),n=t.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(t){return(this.index[t]||new kr(yt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(t){this.xn=t}next(){return this.xn+=2,this.xn}static On(){return new Fc(0)}static Nn(){return new Fc(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OV{constructor(){this.changes=new Kc(t=>t.toString(),(t,r)=>t.isEqual(r)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,r){this.assertNotApplied(),this.changes.set(t,Br.newInvalidDocument(t).setReadTime(r))}getEntry(t,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?le.resolve(n):this.getFromCache(t,r)}getEntries(t,r){return this.getAllFromCache(t,r)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{constructor(t,r){this.overlayedDocument=t,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MV{constructor(t,r,n,i){this.remoteDocumentCache=t,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,r){let n=null;return this.documentOverlayCache.getOverlay(t,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(t,r))).next(i=>(n!==null&&Ql(n.mutation,i,bn.empty(),nr.now()),i))}getDocuments(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.getLocalViewOfDocuments(t,n,Xe()).next(()=>n))}getLocalViewOfDocuments(t,r,n=Xe()){const i=ja();return this.populateOverlays(t,i,r).next(()=>this.computeViews(t,r,i,n).next(s=>{let a=Il();return s.forEach((o,c)=>{a=a.insert(o,c.overlayedDocument)}),a}))}getOverlayedDocuments(t,r){const n=ja();return this.populateOverlays(t,n,r).next(()=>this.computeViews(t,r,n,Xe()))}populateOverlays(t,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(t,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(t,r,n,i){let s=vs();const a=Yl(),o=function(){return Yl()}();return r.forEach((c,l)=>{const u=n.get(l.key);i.has(l.key)&&(u===void 0||u.mutation instanceof ya)?s=s.insert(l.key,l):u!==void 0?(a.set(l.key,u.mutation.getFieldMask()),Ql(u.mutation,l,u.mutation.getFieldMask(),nr.now())):a.set(l.key,bn.empty())}),this.recalculateAndSaveOverlays(t,s).next(c=>(c.forEach((l,u)=>a.set(l,u)),r.forEach((l,u)=>{var f;return o.set(l,new LV(u,(f=a.get(l))!==null&&f!==void 0?f:null))}),o))}recalculateAndSaveOverlays(t,r){const n=Yl();let i=new Ft((a,o)=>a-o),s=Xe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(a=>{for(const o of a)o.keys().forEach(c=>{const l=r.get(c);if(l===null)return;let u=n.get(c)||bn.empty();u=o.applyToLocalView(l,u),n.set(c,u);const f=(i.get(o.batchId)||Xe()).add(c);i=i.insert(o.batchId,f)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const c=o.getNext(),l=c.key,u=c.value,f=KI();u.forEach(d=>{if(!s.has(d)){const p=tR(r.get(d),n.get(d));p!==null&&f.set(d,p),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(t,l,f))}return le.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.recalculateAndSaveOverlays(t,n))}getDocumentsMatchingQuery(t,r,n,i){return function(a){return be.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(t,r.path):HI(r)?this.getDocumentsMatchingCollectionGroupQuery(t,r,n,i):this.getDocumentsMatchingCollectionQuery(t,r,n,i)}getNextDocuments(t,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,r,n.largestBatchId,i-s.size):le.resolve(ja());let o=-1,c=s;return a.next(l=>le.forEach(l,(u,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),s.get(u)?le.resolve():this.remoteDocumentCache.getEntry(t,u).next(d=>{c=c.insert(u,d)}))).next(()=>this.populateOverlays(t,l,s)).next(()=>this.computeViews(t,c,l,Xe())).next(u=>({batchId:o,changes:qI(u)})))})}getDocumentsMatchingDocumentQuery(t,r){return this.getDocument(t,new be(r)).next(n=>{let i=Il();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(t,r,n,i){const s=r.collectionGroup;let a=Il();return this.indexManager.getCollectionParents(t,s).next(o=>le.forEach(o,c=>{const l=function(f,d){return new qc(d,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,c.child(s));return this.getDocumentsMatchingCollectionQuery(t,l,n,i).next(u=>{u.forEach((f,d)=>{a=a.insert(f,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(t,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(t,r,n,s,i))).next(a=>{s.forEach((c,l)=>{const u=l.getKey();a.get(u)===null&&(a=a.insert(u,Br.newInvalidDocument(u)))});let o=Il();return a.forEach((c,l)=>{const u=s.get(c);u!==void 0&&Ql(u.mutation,l,bn.empty(),nr.now()),dp(r,l)&&(o=o.insert(c,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VV{constructor(t){this.serializer=t,this.ur=new Map,this.cr=new Map}getBundleMetadata(t,r){return le.resolve(this.ur.get(r))}saveBundleMetadata(t,r){return this.ur.set(r.id,function(i){return{id:i.id,version:i.version,createTime:Ui(i.createTime)}}(r)),le.resolve()}getNamedQuery(t,r){return le.resolve(this.cr.get(r))}saveNamedQuery(t,r){return this.cr.set(r.name,function(i){return{name:i.name,query:PV(i.bundledQuery),readTime:Ui(i.readTime)}}(r)),le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jV{constructor(){this.overlays=new Ft(be.comparator),this.lr=new Map}getOverlay(t,r){return le.resolve(this.overlays.get(r))}getOverlays(t,r){const n=ja();return le.forEach(r,i=>this.getOverlay(t,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(t,r,n){return n.forEach((i,s)=>{this.lt(t,r,s)}),le.resolve()}removeOverlaysForBatchId(t,r,n){const i=this.lr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(n)),le.resolve()}getOverlaysForCollection(t,r,n){const i=ja(),s=r.length+1,a=new be(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const c=o.getNext().value,l=c.getKey();if(!r.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>n&&i.set(c.getKey(),c)}return le.resolve(i)}getOverlaysForCollectionGroup(t,r,n,i){let s=new Ft((l,u)=>l-u);const a=this.overlays.getIterator();for(;a.hasNext();){const l=a.getNext().value;if(l.getKey().getCollectionGroup()===r&&l.largestBatchId>n){let u=s.get(l.largestBatchId);u===null&&(u=ja(),s=s.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const o=ja(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>o.set(l,u)),!(o.size()>=i)););return le.resolve(o)}lt(t,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.lr.get(i.largestBatchId).delete(n.key);this.lr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new cV(r,n));let s=this.lr.get(r);s===void 0&&(s=Xe(),this.lr.set(r,s)),this.lr.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(){this.hr=new kr(cr.Pr),this.Ir=new kr(cr.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(t,r){const n=new cr(t,r);this.hr=this.hr.add(n),this.Ir=this.Ir.add(n)}Er(t,r){t.forEach(n=>this.addReference(n,r))}removeReference(t,r){this.dr(new cr(t,r))}Ar(t,r){t.forEach(n=>this.removeReference(n,r))}Rr(t){const r=new be(new yt([])),n=new cr(r,t),i=new cr(r,t+1),s=[];return this.Ir.forEachInRange([n,i],a=>{this.dr(a),s.push(a.key)}),s}Vr(){this.hr.forEach(t=>this.dr(t))}dr(t){this.hr=this.hr.delete(t),this.Ir=this.Ir.delete(t)}mr(t){const r=new be(new yt([])),n=new cr(r,t),i=new cr(r,t+1);let s=Xe();return this.Ir.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(t){const r=new cr(t,0),n=this.hr.firstAfterOrEqual(r);return n!==null&&t.isEqual(n.key)}}class cr{constructor(t,r){this.key=t,this.gr=r}static Pr(t,r){return be.comparator(t.key,r.key)||lt(t.gr,r.gr)}static Tr(t,r){return lt(t.gr,r.gr)||be.comparator(t.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BV{constructor(t,r){this.indexManager=t,this.referenceDelegate=r,this.mutationQueue=[],this.pr=1,this.yr=new kr(cr.Pr)}checkEmpty(t){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(t,r,n,i){const s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new oV(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.yr=this.yr.add(new cr(o.key,s)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return le.resolve(a)}lookupMutationBatch(t,r){return le.resolve(this.wr(r))}getNextMutationBatchAfterBatchId(t,r){const n=r+1,i=this.Sr(n),s=i<0?0:i;return le.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(t){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,r){const n=new cr(r,0),i=new cr(r,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([n,i],a=>{const o=this.wr(a.gr);s.push(o)}),le.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,r){let n=new kr(lt);return r.forEach(i=>{const s=new cr(i,0),a=new cr(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,a],o=>{n=n.add(o.gr)})}),le.resolve(this.br(n))}getAllMutationBatchesAffectingQuery(t,r){const n=r.path,i=n.length+1;let s=n;be.isDocumentKey(s)||(s=s.child(""));const a=new cr(new be(s),0);let o=new kr(lt);return this.yr.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(o=o.add(c.gr)),!0)},a),le.resolve(this.br(o))}br(t){const r=[];return t.forEach(n=>{const i=this.wr(n);i!==null&&r.push(i)}),r}removeMutationBatch(t,r){wt(this.Dr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.yr;return le.forEach(r.mutations,i=>{const s=new cr(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.yr=n})}Fn(t){}containsKey(t,r){const n=new cr(r,0),i=this.yr.firstAfterOrEqual(n);return le.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,le.resolve()}Dr(t,r){return this.Sr(t)}Sr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}wr(t){const r=this.Sr(t);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UV{constructor(t){this.Cr=t,this.docs=function(){return new Ft(be.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Cr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const r=this.docs.get(t);r&&(this.docs=this.docs.remove(t),this.size-=r.size)}getEntry(t,r){const n=this.docs.get(r);return le.resolve(n?n.document.mutableCopy():Br.newInvalidDocument(r))}getEntries(t,r){let n=vs();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Br.newInvalidDocument(i))}),le.resolve(n)}getDocumentsMatchingQuery(t,r,n,i){let s=vs();const a=r.path,o=new be(a.child("")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){const{key:l,value:{document:u}}=c.getNext();if(!a.isPrefixOf(l.path))break;l.path.length>a.length+1||C8(k8(u),n)<=0||(i.has(u.key)||dp(r,u))&&(s=s.insert(u.key,u.mutableCopy()))}return le.resolve(s)}getAllFromCollectionGroup(t,r,n,i){Le()}vr(t,r){return le.forEach(this.docs,n=>r(n))}newChangeBuffer(t){return new $V(this)}getSize(t){return le.resolve(this.size)}}class $V extends OV{constructor(t){super(),this._r=t}applyChanges(t){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this._r.addEntry(t,i)):this._r.removeEntry(n)}),le.waitFor(r)}getFromCache(t,r){return this._r.getEntry(t,r)}getAllFromCache(t,r){return this._r.getEntries(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(t){this.persistence=t,this.Fr=new Kc(r=>c_(r),l_),this.lastRemoteSnapshotVersion=je.min(),this.highestTargetId=0,this.Mr=0,this.Or=new p_,this.targetCount=0,this.Nr=Fc.On()}forEachTarget(t,r){return this.Fr.forEach((n,i)=>r(i)),le.resolve()}getLastRemoteSnapshotVersion(t){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return le.resolve(this.Mr)}allocateTargetId(t){return this.highestTargetId=this.Nr.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(t,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Mr&&(this.Mr=r),le.resolve()}kn(t){this.Fr.set(t.target,t);const r=t.targetId;r>this.highestTargetId&&(this.Nr=new Fc(r),this.highestTargetId=r),t.sequenceNumber>this.Mr&&(this.Mr=t.sequenceNumber)}addTargetData(t,r){return this.kn(r),this.targetCount+=1,le.resolve()}updateTargetData(t,r){return this.kn(r),le.resolve()}removeTargetData(t,r){return this.Fr.delete(r.target),this.Or.Rr(r.targetId),this.targetCount-=1,le.resolve()}removeTargets(t,r,n){let i=0;const s=[];return this.Fr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Fr.delete(a),s.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)}),le.waitFor(s).next(()=>i)}getTargetCount(t){return le.resolve(this.targetCount)}getTargetData(t,r){const n=this.Fr.get(r)||null;return le.resolve(n)}addMatchingKeys(t,r,n){return this.Or.Er(r,n),le.resolve()}removeMatchingKeys(t,r,n){this.Or.Ar(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(t,a))}),le.waitFor(s)}removeMatchingKeysForTargetId(t,r){return this.Or.Rr(r),le.resolve()}getMatchingKeysForTargetId(t,r){const n=this.Or.mr(r);return le.resolve(n)}containsKey(t,r){return le.resolve(this.Or.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(t,r){this.Br={},this.overlays={},this.Lr=new i_(0),this.kr=!1,this.kr=!0,this.referenceDelegate=t(this),this.qr=new HV(this),this.indexManager=new NV,this.remoteDocumentCache=function(i){return new UV(i)}(n=>this.referenceDelegate.Qr(n)),this.serializer=new FV(r),this.Kr=new VV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let r=this.overlays[t.toKey()];return r||(r=new jV,this.overlays[t.toKey()]=r),r}getMutationQueue(t,r){let n=this.Br[t.toKey()];return n||(n=new BV(r,this.referenceDelegate),this.Br[t.toKey()]=n),n}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(t,r,n){Ce("MemoryPersistence","Starting transaction:",t);const i=new WV(this.Lr.next());return this.referenceDelegate.$r(),n(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(t,r){return le.or(Object.values(this.Br).map(n=>()=>n.containsKey(t,r)))}}class WV extends R8{constructor(t){super(),this.currentSequenceNumber=t}}class m_{constructor(t){this.persistence=t,this.Gr=new p_,this.zr=null}static jr(t){return new m_(t)}get Hr(){if(this.zr)return this.zr;throw Le()}addReference(t,r,n){return this.Gr.addReference(n,r),this.Hr.delete(n.toString()),le.resolve()}removeReference(t,r,n){return this.Gr.removeReference(n,r),this.Hr.add(n.toString()),le.resolve()}markPotentiallyOrphaned(t,r){return this.Hr.add(r.toString()),le.resolve()}removeTarget(t,r){this.Gr.Rr(r.targetId).forEach(i=>this.Hr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,r.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>n.removeTargetData(t,r))}$r(){this.zr=new Set}Ur(t){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.Hr,n=>{const i=be.fromPath(n);return this.Jr(t,i).next(s=>{s||r.removeEntry(i,je.min())})}).next(()=>(this.zr=null,r.apply(t)))}updateLimboDocument(t,r){return this.Jr(t,r).next(n=>{n?this.Hr.delete(r.toString()):this.Hr.add(r.toString())})}Qr(t){return 0}Jr(t,r){return le.or([()=>le.resolve(this.Gr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(t,r),()=>this.persistence.Wr(t,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g_{constructor(t,r,n,i){this.targetId=t,this.fromCache=r,this.ki=n,this.qi=i}static Qi(t,r){let n=Xe(),i=Xe();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new g_(t,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qV{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(t,r){this.Gi=t,this.indexManager=r,this.Ki=!0}getDocumentsMatchingQuery(t,r,n,i){const s={result:null};return this.zi(t,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ji(t,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new GV;return this.Hi(t,r,a).next(o=>{if(s.result=o,this.$i)return this.Ji(t,r,a,o.size)})}).next(()=>s.result)}Ji(t,r,n,i){return n.documentReadCount<this.Ui?(ml()<=Qe.DEBUG&&Ce("QueryEngine","SDK will not create cache indexes for query:",Oo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),le.resolve()):(ml()<=Qe.DEBUG&&Ce("QueryEngine","Query:",Oo(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Wi*i?(ml()<=Qe.DEBUG&&Ce("QueryEngine","The SDK decides to create cache indexes for query:",Oo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,ji(r))):le.resolve())}zi(t,r){if(Zw(r))return le.resolve(null);let n=ji(r);return this.indexManager.getIndexType(t,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Xd(r,null,"F"),n=ji(r)),this.indexManager.getDocumentsMatchingTarget(t,n).next(s=>{const a=Xe(...s);return this.Gi.getDocuments(t,a).next(o=>this.indexManager.getMinOffset(t,n).next(c=>{const l=this.Yi(r,o);return this.Zi(r,l,a,c.readTime)?this.zi(t,Xd(r,null,"F")):this.Xi(t,l,r,c)}))})))}ji(t,r,n,i){return Zw(r)||i.isEqual(je.min())?le.resolve(null):this.Gi.getDocuments(t,n).next(s=>{const a=this.Yi(r,s);return this.Zi(r,a,n,i)?le.resolve(null):(ml()<=Qe.DEBUG&&Ce("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Oo(r)),this.Xi(t,a,r,A8(i,-1)).next(o=>o))})}Yi(t,r){let n=new kr(WI(t));return r.forEach((i,s)=>{dp(t,s)&&(n=n.add(s))}),n}Zi(t,r,n,i){if(t.limit===null)return!1;if(n.size!==r.size)return!0;const s=t.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(t,r,n){return ml()<=Qe.DEBUG&&Ce("QueryEngine","Using full collection scan to execute query:",Oo(r)),this.Gi.getDocumentsMatchingQuery(t,r,ca.min(),n)}Xi(t,r,n,i){return this.Gi.getDocumentsMatchingQuery(t,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(t,r,n,i){this.persistence=t,this.es=r,this.serializer=i,this.ts=new Ft(lt),this.ns=new Kc(s=>c_(s),l_),this.rs=new Map,this.ss=t.getRemoteDocumentCache(),this.qr=t.getTargetCache(),this.Kr=t.getBundleCache(),this.os(n)}os(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new MV(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>t.collect(r,this.ts))}}function XV(e,t,r,n){return new KV(e,t,r,n)}async function dR(e,t){const r=He(e);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.os(t),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let c=Xe();for(const l of i){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of s){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return r.localDocuments.getDocuments(n,c).next(l=>({_s:l,removedBatchIds:a,addedBatchIds:o}))})})}function YV(e,t){const r=He(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=t.batch.keys(),s=r.ss.newChangeBuffer({trackRemovals:!0});return function(o,c,l,u){const f=l.batch,d=f.keys();let p=le.resolve();return d.forEach(g=>{p=p.next(()=>u.getEntry(c,g)).next(m=>{const v=l.docVersions.get(g);wt(v!==null),m.version.compareTo(v)<0&&(f.applyToRemoteDocument(m,l),m.isValidDocument()&&(m.setReadTime(l.commitVersion),u.addEntry(m)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(c,f))}(r,n,t,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=Xe();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(c=c.add(o.batch.mutations[l].key));return c}(t))).next(()=>r.localDocuments.getDocuments(n,i))})}function pR(e){const t=He(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",r=>t.qr.getLastRemoteSnapshotVersion(r))}function QV(e,t){const r=He(e),n=t.snapshotVersion;let i=r.ts;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.ss.newChangeBuffer({trackRemovals:!0});i=r.ts;const o=[];t.targetChanges.forEach((u,f)=>{const d=i.get(f);if(!d)return;o.push(r.qr.removeMatchingKeys(s,u.removedDocuments,f).next(()=>r.qr.addMatchingKeys(s,u.addedDocuments,f)));let p=d.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(f)!==null?p=p.withResumeToken(Kr.EMPTY_BYTE_STRING,je.min()).withLastLimboFreeSnapshotVersion(je.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),i=i.insert(f,p),function(m,v,_){return m.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(d,p,u)&&o.push(r.qr.updateTargetData(s,p))});let c=vs(),l=Xe();if(t.documentUpdates.forEach(u=>{t.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,u))}),o.push(JV(s,a,t.documentUpdates).next(u=>{c=u.us,l=u.cs})),!n.isEqual(je.min())){const u=r.qr.getLastRemoteSnapshotVersion(s).next(f=>r.qr.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(u)}return le.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(r.ts=i,s))}function JV(e,t,r){let n=Xe(),i=Xe();return r.forEach(s=>n=n.add(s)),t.getEntries(e,n).next(s=>{let a=vs();return r.forEach((o,c)=>{const l=s.get(o);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(o)),c.isNoDocument()&&c.version.isEqual(je.min())?(t.removeEntry(o,c.readTime),a=a.insert(o,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(t.addEntry(c),a=a.insert(o,c)):Ce("LocalStore","Ignoring outdated watch update for ",o,". Current version:",l.version," Watch version:",c.version)}),{us:a,cs:i}})}function ZV(e,t){const r=He(e);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(t===void 0&&(t=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,t)))}function e9(e,t){const r=He(e);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.qr.getTargetData(n,t).next(s=>s?(i=s,le.resolve(i)):r.qr.allocateTargetId(n).next(a=>(i=new Bs(t,a,"TargetPurposeListen",n.currentSequenceNumber),r.qr.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.ts.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.ts=r.ts.insert(n.targetId,n),r.ns.set(t,n.targetId)),n})}async function J1(e,t,r){const n=He(e),i=n.ts.get(t),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!If(a))throw a;Ce("LocalStore",`Failed to update sequence numbers for target ${t}: ${a}`)}n.ts=n.ts.remove(t),n.ns.delete(i.target)}function u2(e,t,r){const n=He(e);let i=je.min(),s=Xe();return n.persistence.runTransaction("Execute query","readwrite",a=>function(c,l,u){const f=He(c),d=f.ns.get(u);return d!==void 0?le.resolve(f.ts.get(d)):f.qr.getTargetData(l,u)}(n,a,ji(t)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.qr.getMatchingKeysForTargetId(a,o.targetId).next(c=>{s=c})}).next(()=>n.es.getDocumentsMatchingQuery(a,t,r?i:je.min(),r?s:Xe())).next(o=>(t9(n,G8(t),o),{documents:o,ls:s})))}function t9(e,t,r){let n=e.rs.get(t)||je.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),e.rs.set(t,n)}class f2{constructor(){this.activeTargetIds=J8()}ds(t){this.activeTargetIds=this.activeTargetIds.add(t)}As(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Es(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class r9{constructor(){this.eo=new f2,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,r,n){}addLocalQueryTarget(t){return this.eo.ds(t),this.no[t]||"not-current"}updateQueryState(t,r,n){this.no[t]=r}removeLocalQueryTarget(t){this.eo.As(t)}isLocalQueryTarget(t){return this.eo.activeTargetIds.has(t)}clearQueryState(t){delete this.no[t]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(t){return this.eo.activeTargetIds.has(t)}start(){return this.eo=new f2,Promise.resolve()}handleUserChange(t,r,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n9{ro(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(t){this.ao.push(t)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){Ce("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ao)t(0)}_o(){Ce("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ao)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mh=null;function Um(){return mh===null?mh=function(){return 268435456+Math.round(2147483648*Math.random())}():mh++,"0x"+mh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i9={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s9{constructor(t){this.co=t.co,this.lo=t.lo}ho(t){this.Po=t}Io(t){this.To=t}onMessage(t){this.Eo=t}close(){this.lo()}send(t){this.co(t)}Ao(){this.Po()}Ro(t){this.To(t)}Vo(t){this.Eo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nr="WebChannelConnection";class a9 extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=n+"://"+r.host,this.fo=`projects/${i}/databases/${s}`,this.po=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(r,n,i,s,a){const o=Um(),c=this.So(r,n);Ce("RestConnection",`Sending RPC '${r}' ${o}:`,c,i);const l={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(l,s,a),this.Do(r,c,l,i).then(u=>(Ce("RestConnection",`Received RPC '${r}' ${o}: `,u),u),u=>{throw Cc("RestConnection",`RPC '${r}' ${o} failed with error: `,u,"url: ",c,"request:",i),u})}Co(r,n,i,s,a,o){return this.wo(r,n,i,s,a)}bo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Gc}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}So(r,n){const i=i9[r];return`${this.mo}/v1/${n}:${i}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Do(t,r,n,i){const s=Um();return new Promise((a,o)=>{const c=new p8;c.setWithCredentials(!0),c.listenOnce(f8.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case jm.NO_ERROR:const u=c.getResponseJson();Ce(Nr,`XHR for RPC '${t}' ${s} received:`,JSON.stringify(u)),a(u);break;case jm.TIMEOUT:Ce(Nr,`RPC '${t}' ${s} timed out`),o(new Te(se.DEADLINE_EXCEEDED,"Request time out"));break;case jm.HTTP_ERROR:const f=c.getStatus();if(Ce(Nr,`RPC '${t}' ${s} failed with status:`,f,"response text:",c.getResponseText()),f>0){let d=c.getResponseJson();Array.isArray(d)&&(d=d[0]);const p=d==null?void 0:d.error;if(p&&p.status&&p.message){const g=function(v){const _=v.toLowerCase().replace(/_/g,"-");return Object.values(se).indexOf(_)>=0?_:se.UNKNOWN}(p.status);o(new Te(g,p.message))}else o(new Te(se.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new Te(se.UNAVAILABLE,"Connection failed."));break;default:Le()}}finally{Ce(Nr,`RPC '${t}' ${s} completed.`)}});const l=JSON.stringify(i);Ce(Nr,`RPC '${t}' ${s} sending request:`,i),c.send(r,"POST",l,n,15)})}vo(t,r,n){const i=Um(),s=[this.mo,"/","google.firestore.v1.Firestore","/",t,"/channel"],a=l8(),o=u8(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new d8({})),this.bo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const u=s.join("");Ce(Nr,`Creating RPC '${t}' stream ${i}: ${u}`,c);const f=a.createWebChannel(u,c);let d=!1,p=!1;const g=new s9({co:v=>{p?Ce(Nr,`Not sending because RPC '${t}' stream ${i} is closed:`,v):(d||(Ce(Nr,`Opening RPC '${t}' stream ${i} transport.`),f.open(),d=!0),Ce(Nr,`RPC '${t}' stream ${i} sending:`,v),f.send(v))},lo:()=>f.close()}),m=(v,_,x)=>{v.listen(_,y=>{try{x(y)}catch(w){setTimeout(()=>{throw w},0)}})};return m(f,hh.EventType.OPEN,()=>{p||Ce(Nr,`RPC '${t}' stream ${i} transport opened.`)}),m(f,hh.EventType.CLOSE,()=>{p||(p=!0,Ce(Nr,`RPC '${t}' stream ${i} transport closed`),g.Ro())}),m(f,hh.EventType.ERROR,v=>{p||(p=!0,Cc(Nr,`RPC '${t}' stream ${i} transport errored:`,v),g.Ro(new Te(se.UNAVAILABLE,"The operation could not be completed")))}),m(f,hh.EventType.MESSAGE,v=>{var _;if(!p){const x=v.data[0];wt(!!x);const y=x,w=y.error||((_=y[0])===null||_===void 0?void 0:_.error);if(w){Ce(Nr,`RPC '${t}' stream ${i} received error:`,w);const T=w.status;let S=function(b){const j=Wt[b];if(j!==void 0)return iR(j)}(T),E=w.message;S===void 0&&(S=se.INTERNAL,E="Unknown error status: "+T+" with message "+w.message),p=!0,g.Ro(new Te(S,E)),f.close()}else Ce(Nr,`RPC '${t}' stream ${i} received:`,x),g.Vo(x)}}),m(o,h8.STAT_EVENT,v=>{v.stat===$w.PROXY?Ce(Nr,`RPC '${t}' stream ${i} detected buffering proxy`):v.stat===$w.NOPROXY&&Ce(Nr,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{g.Ao()},0),g}}function $m(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vp(e){return new vV(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR{constructor(t,r,n=1e3,i=1.5,s=6e4){this.si=t,this.timerId=r,this.Fo=n,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(t){this.cancel();const r=Math.floor(this.Oo+this.qo()),n=Math.max(0,Date.now()-this.Bo),i=Math.max(0,r-n);i>0&&Ce("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),t())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{constructor(t,r,n,i,s,a,o,c){this.si=t,this.Ko=n,this.$o=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new mR(t,r)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(t){this.t_(),this.stream.send(t)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(t,r){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,t!==4?this.zo.reset():r&&r.code===se.RESOURCE_EXHAUSTED?(gs(r.toString()),gs("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):r&&r.code===se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Io(r)}r_(){}auth(){this.state=1;const t=this.i_(this.Uo),r=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Uo===r&&this.s_(n,i)},n=>{t(()=>{const i=new Te(se.UNKNOWN,"Fetching auth token failed: "+n.message);return this.o_(i)})})}s_(t,r){const n=this.i_(this.Uo);this.stream=this.__(t,r),this.stream.ho(()=>{n(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{n(()=>this.o_(i))}),this.stream.onMessage(i=>{n(()=>this.onMessage(i))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(t){return Ce("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}i_(t){return r=>{this.si.enqueueAndForget(()=>this.Uo===t?r():(Ce("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class o9 extends gR{constructor(t,r,n,i,s,a){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}__(t,r){return this.connection.vo("Listen",t,r)}onMessage(t){this.zo.reset();const r=yV(this.serializer,t),n=function(s){if(!("targetChange"in s))return je.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?je.min():a.readTime?Ui(a.readTime):je.min()}(t);return this.listener.a_(r,n)}u_(t){const r={};r.database=Q1(this.serializer),r.addTarget=function(s,a){let o;const c=a.target;if(o=G1(c)?{documents:TV(s,c)}:{query:SV(s,c)},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=oR(s,a.resumeToken);const l=K1(s,a.expectedCount);l!==null&&(o.expectedCount=l)}else if(a.snapshotVersion.compareTo(je.min())>0){o.readTime=Jd(s,a.snapshotVersion.toTimestamp());const l=K1(s,a.expectedCount);l!==null&&(o.expectedCount=l)}return o}(this.serializer,t);const n=kV(this.serializer,t);n&&(r.labels=n),this.e_(r)}c_(t){const r={};r.database=Q1(this.serializer),r.removeTarget=t,this.e_(r)}}class c9 extends gR{constructor(t,r,n,i,s,a){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(t,r){return this.connection.vo("Write",t,r)}onMessage(t){if(wt(!!t.streamToken),this.lastStreamToken=t.streamToken,this.l_){this.zo.reset();const r=wV(t.writeResults,t.commitTime),n=Ui(t.commitTime);return this.listener.I_(n,r)}return wt(!t.writeResults||t.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const t={};t.database=Q1(this.serializer),this.e_(t)}P_(t){const r={streamToken:this.lastStreamToken,writes:t.map(n=>EV(this.serializer,n))};this.e_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l9 extends class{}{constructor(t,r,n,i){super(),this.authCredentials=t,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new Te(se.FAILED_PRECONDITION,"The client has already been terminated.")}wo(t,r,n){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(t,r,n,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Te(se.UNKNOWN,i.toString())})}Co(t,r,n,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(t,r,n,s,a,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Te(se.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class u9{constructor(t,r){this.asyncQueue=t,this.onlineStateHandler=r,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(t){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.p_("Offline")))}set(t){this.S_(),this.V_=0,t==="Online"&&(this.f_=!1),this.p_(t)}p_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}y_(t){const r=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(gs(r),this.f_=!1):Ce("OnlineStateTracker",r)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f9{constructor(t,r,n,i,s){this.localStore=t,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{n.enqueueAndForget(async()=>{wo(this)&&(Ce("RemoteStore","Restarting streams for network reachability change."),await async function(c){const l=He(c);l.C_.add(4),await Ff(l),l.M_.set("Unknown"),l.C_.delete(4),await xp(l)}(this))})}),this.M_=new u9(n,i)}}async function xp(e){if(wo(e))for(const t of e.v_)await t(!0)}async function Ff(e){for(const t of e.v_)await t(!1)}function vR(e,t){const r=He(e);r.D_.has(t.targetId)||(r.D_.set(t.targetId,t),__(r)?x_(r):Xc(r).Ho()&&v_(r,t))}function xR(e,t){const r=He(e),n=Xc(r);r.D_.delete(t),n.Ho()&&_R(r,t),r.D_.size===0&&(n.Ho()?n.Zo():wo(r)&&r.M_.set("Unknown"))}function v_(e,t){if(e.x_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(je.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}Xc(e).u_(t)}function _R(e,t){e.x_.Oe(t),Xc(e).c_(t)}function x_(e){e.x_=new dV({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>e.D_.get(t)||null,nt:()=>e.datastore.serializer.databaseId}),Xc(e).start(),e.M_.g_()}function __(e){return wo(e)&&!Xc(e).jo()&&e.D_.size>0}function wo(e){return He(e).C_.size===0}function yR(e){e.x_=void 0}async function h9(e){e.D_.forEach((t,r)=>{v_(e,t)})}async function d9(e,t){yR(e),__(e)?(e.M_.w_(t),x_(e)):e.M_.set("Unknown")}async function p9(e,t,r){if(e.M_.set("Online"),t instanceof aR&&t.state===2&&t.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.D_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.D_.delete(o),i.x_.removeTarget(o))}(e,t)}catch(n){Ce("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Zd(e,n)}else if(t instanceof Qh?e.x_.$e(t):t instanceof sR?e.x_.Je(t):e.x_.Ge(t),!r.isEqual(je.min()))try{const n=await pR(e.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.x_.it(a);return o.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const u=s.D_.get(l);u&&s.D_.set(l,u.withResumeToken(c.resumeToken,a))}}),o.targetMismatches.forEach((c,l)=>{const u=s.D_.get(c);if(!u)return;s.D_.set(c,u.withResumeToken(Kr.EMPTY_BYTE_STRING,u.snapshotVersion)),_R(s,c);const f=new Bs(u.target,c,l,u.sequenceNumber);v_(s,f)}),s.remoteSyncer.applyRemoteEvent(o)}(e,r)}catch(n){Ce("RemoteStore","Failed to raise snapshot:",n),await Zd(e,n)}}async function Zd(e,t,r){if(!If(t))throw t;e.C_.add(1),await Ff(e),e.M_.set("Offline"),r||(r=()=>pR(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Ce("RemoteStore","Retrying IndexedDB access"),await r(),e.C_.delete(1),await xp(e)})}function ER(e,t){return t().catch(r=>Zd(e,r,t))}async function _p(e){const t=He(e),r=ua(t);let n=t.b_.length>0?t.b_[t.b_.length-1].batchId:-1;for(;m9(t);)try{const i=await ZV(t.localStore,n);if(i===null){t.b_.length===0&&r.Zo();break}n=i.batchId,g9(t,i)}catch(i){await Zd(t,i)}wR(t)&&TR(t)}function m9(e){return wo(e)&&e.b_.length<10}function g9(e,t){e.b_.push(t);const r=ua(e);r.Ho()&&r.h_&&r.P_(t.mutations)}function wR(e){return wo(e)&&!ua(e).jo()&&e.b_.length>0}function TR(e){ua(e).start()}async function v9(e){ua(e).E_()}async function x9(e){const t=ua(e);for(const r of e.b_)t.P_(r.mutations)}async function _9(e,t,r){const n=e.b_.shift(),i=f_.from(n,t,r);await ER(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await _p(e)}async function y9(e,t){t&&ua(e).h_&&await async function(n,i){if(function(a){return uV(a)&&a!==se.ABORTED}(i.code)){const s=n.b_.shift();ua(n).Yo(),await ER(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await _p(n)}}(e,t),wR(e)&&TR(e)}async function d2(e,t){const r=He(e);r.asyncQueue.verifyOperationInProgress(),Ce("RemoteStore","RemoteStore received new credentials");const n=wo(r);r.C_.add(3),await Ff(r),n&&r.M_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.C_.delete(3),await xp(r)}async function E9(e,t){const r=He(e);t?(r.C_.delete(2),await xp(r)):t||(r.C_.add(2),await Ff(r),r.M_.set("Unknown"))}function Xc(e){return e.O_||(e.O_=function(r,n,i){const s=He(r);return s.A_(),new o9(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{ho:h9.bind(null,e),Io:d9.bind(null,e),a_:p9.bind(null,e)}),e.v_.push(async t=>{t?(e.O_.Yo(),__(e)?x_(e):e.M_.set("Unknown")):(await e.O_.stop(),yR(e))})),e.O_}function ua(e){return e.N_||(e.N_=function(r,n,i){const s=He(r);return s.A_(),new c9(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{ho:v9.bind(null,e),Io:y9.bind(null,e),T_:x9.bind(null,e),I_:_9.bind(null,e)}),e.v_.push(async t=>{t?(e.N_.Yo(),await _p(e)):(await e.N_.stop(),e.b_.length>0&&(Ce("RemoteStore",`Stopping write stream with ${e.b_.length} pending writes`),e.b_=[]))})),e.N_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(t,r,n,i,s){this.asyncQueue=t,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new os,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,r,n,i,s){const a=Date.now()+n,o=new y_(t,r,a,i,s);return o.start(n),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Te(se.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function E_(e,t){if(gs("AsyncQueue",`${t}: ${e}`),If(e))return new Te(se.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(t){this.comparator=t?(r,n)=>t(r,n)||be.comparator(r.key,n.key):(r,n)=>be.comparator(r.key,n.key),this.keyedMap=Il(),this.sortedSet=new Ft(this.comparator)}static emptySet(t){return new dc(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const r=this.keyedMap.get(t);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((r,n)=>(t(r),!1))}add(t){const r=this.delete(t.key);return r.copy(r.keyedMap.insert(t.key,t),r.sortedSet.insert(t,null))}delete(t){const r=this.get(t);return r?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(r)):this}isEqual(t){if(!(t instanceof dc)||this.size!==t.size)return!1;const r=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(r=>{t.push(r.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,r){const n=new dc;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2{constructor(){this.B_=new Ft(be.comparator)}track(t){const r=t.doc.key,n=this.B_.get(r);n?t.type!==0&&n.type===3?this.B_=this.B_.insert(r,t):t.type===3&&n.type!==1?this.B_=this.B_.insert(r,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.B_=this.B_.insert(r,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.B_=this.B_.insert(r,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.B_=this.B_.remove(r):t.type===1&&n.type===2?this.B_=this.B_.insert(r,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.B_=this.B_.insert(r,{type:2,doc:t.doc}):Le():this.B_=this.B_.insert(r,t)}L_(){const t=[];return this.B_.inorderTraversal((r,n)=>{t.push(n)}),t}}class Pc{constructor(t,r,n,i,s,a,o,c,l){this.query=t,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(t,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Pc(t,r,dc.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&hp(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const r=this.docChanges,n=t.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w9{constructor(){this.k_=void 0,this.listeners=[]}}class T9{constructor(){this.queries=new Kc(t=>zI(t),hp),this.onlineState="Unknown",this.q_=new Set}}async function SR(e,t){const r=He(e),n=t.query;let i=!1,s=r.queries.get(n);if(s||(i=!0,s=new w9),i)try{s.k_=await r.onListen(n)}catch(a){const o=E_(a,`Initialization of query '${Oo(t.query)}' failed`);return void t.onError(o)}r.queries.set(n,s),s.listeners.push(t),t.Q_(r.onlineState),s.k_&&t.K_(s.k_)&&w_(r)}async function AR(e,t){const r=He(e),n=t.query;let i=!1;const s=r.queries.get(n);if(s){const a=s.listeners.indexOf(t);a>=0&&(s.listeners.splice(a,1),i=s.listeners.length===0)}if(i)return r.queries.delete(n),r.onUnlisten(n)}function S9(e,t){const r=He(e);let n=!1;for(const i of t){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.listeners)o.K_(i)&&(n=!0);a.k_=i}}n&&w_(r)}function A9(e,t,r){const n=He(e),i=n.queries.get(t);if(i)for(const s of i.listeners)s.onError(r);n.queries.delete(t)}function w_(e){e.q_.forEach(t=>{t.next()})}class kR{constructor(t,r,n){this.query=t,this.U_=r,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=n||{}}K_(t){if(!this.options.includeMetadataChanges){const n=[];for(const i of t.docChanges)i.type!==3&&n.push(i);t=new Pc(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let r=!1;return this.W_?this.z_(t)&&(this.U_.next(t),r=!0):this.j_(t,this.onlineState)&&(this.H_(t),r=!0),this.G_=t,r}onError(t){this.U_.error(t)}Q_(t){this.onlineState=t;let r=!1;return this.G_&&!this.W_&&this.j_(this.G_,t)&&(this.H_(this.G_),r=!0),r}j_(t,r){if(!t.fromCache)return!0;const n=r!=="Offline";return(!this.options.J_||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||r==="Offline")}z_(t){if(t.docChanges.length>0)return!0;const r=this.G_&&this.G_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}H_(t){t=Pc.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.W_=!0,this.U_.next(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(t){this.key=t}}class IR{constructor(t){this.key=t}}class k9{constructor(t,r){this.query=t,this.ia=r,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=Xe(),this.mutatedKeys=Xe(),this._a=WI(t),this.aa=new dc(this._a)}get ua(){return this.ia}ca(t,r){const n=r?r.la:new p2,i=r?r.aa:this.aa;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((u,f)=>{const d=i.get(u),p=dp(this.query,f)?f:null,g=!!d&&this.mutatedKeys.has(d.key),m=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let v=!1;d&&p?d.data.isEqual(p.data)?g!==m&&(n.track({type:3,doc:p}),v=!0):this.ha(d,p)||(n.track({type:2,doc:p}),v=!0,(c&&this._a(p,c)>0||l&&this._a(p,l)<0)&&(o=!0)):!d&&p?(n.track({type:0,doc:p}),v=!0):d&&!p&&(n.track({type:1,doc:d}),v=!0,(c||l)&&(o=!0)),v&&(p?(a=a.add(p),s=m?s.add(u):s.delete(u)):(a=a.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),s=s.delete(u.key),n.track({type:1,doc:u})}return{aa:a,la:n,Zi:o,mutatedKeys:s}}ha(t,r){return t.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(t,r,n){const i=this.aa;this.aa=t.aa,this.mutatedKeys=t.mutatedKeys;const s=t.la.L_();s.sort((l,u)=>function(d,p){const g=m=>{switch(m){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le()}};return g(d)-g(p)}(l.type,u.type)||this._a(l.doc,u.doc)),this.Pa(n);const a=r?this.Ia():[],o=this.oa.size===0&&this.current?1:0,c=o!==this.sa;return this.sa=o,s.length!==0||c?{snapshot:new Pc(this.query,t.aa,i,s,t.mutatedKeys,o===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ta:a}:{Ta:a}}Q_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new p2,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(t){return!this.ia.has(t)&&!!this.aa.has(t)&&!this.aa.get(t).hasLocalMutations}Pa(t){t&&(t.addedDocuments.forEach(r=>this.ia=this.ia.add(r)),t.modifiedDocuments.forEach(r=>{}),t.removedDocuments.forEach(r=>this.ia=this.ia.delete(r)),this.current=t.current)}Ia(){if(!this.current)return[];const t=this.oa;this.oa=Xe(),this.aa.forEach(n=>{this.Ea(n.key)&&(this.oa=this.oa.add(n.key))});const r=[];return t.forEach(n=>{this.oa.has(n)||r.push(new IR(n))}),this.oa.forEach(n=>{t.has(n)||r.push(new CR(n))}),r}da(t){this.ia=t.ls,this.oa=Xe();const r=this.ca(t.documents);return this.applyChanges(r,!0)}Aa(){return Pc.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class C9{constructor(t,r,n){this.query=t,this.targetId=r,this.view=n}}class I9{constructor(t){this.key=t,this.Ra=!1}}class R9{constructor(t,r,n,i,s,a){this.localStore=t,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Va={},this.ma=new Kc(o=>zI(o),hp),this.fa=new Map,this.ga=new Set,this.pa=new Ft(be.comparator),this.ya=new Map,this.wa=new p_,this.Sa={},this.ba=new Map,this.Da=Fc.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function b9(e,t){const r=B9(e);let n,i;const s=r.ma.get(t);if(s)n=s.targetId,r.sharedClientState.addLocalQueryTarget(n),i=s.view.Aa();else{const a=await e9(r.localStore,ji(t)),o=r.sharedClientState.addLocalQueryTarget(a.targetId);n=a.targetId,i=await F9(r,t,n,o==="current",a.resumeToken),r.isPrimaryClient&&vR(r.remoteStore,a)}return i}async function F9(e,t,r,n,i){e.va=(f,d,p)=>async function(m,v,_,x){let y=v.view.ca(_);y.Zi&&(y=await u2(m.localStore,v.query,!1).then(({documents:S})=>v.view.ca(S,y)));const w=x&&x.targetChanges.get(v.targetId),T=v.view.applyChanges(y,m.isPrimaryClient,w);return g2(m,v.targetId,T.Ta),T.snapshot}(e,f,d,p);const s=await u2(e.localStore,t,!0),a=new k9(t,s.ls),o=a.ca(s.documents),c=bf.createSynthesizedTargetChangeForCurrentChange(r,n&&e.onlineState!=="Offline",i),l=a.applyChanges(o,e.isPrimaryClient,c);g2(e,r,l.Ta);const u=new C9(t,r,a);return e.ma.set(t,u),e.fa.has(r)?e.fa.get(r).push(t):e.fa.set(r,[t]),l.snapshot}async function P9(e,t){const r=He(e),n=r.ma.get(t),i=r.fa.get(n.targetId);if(i.length>1)return r.fa.set(n.targetId,i.filter(s=>!hp(s,t))),void r.ma.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(n.targetId),r.sharedClientState.isActiveQueryTarget(n.targetId)||await J1(r.localStore,n.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(n.targetId),xR(r.remoteStore,n.targetId),Z1(r,n.targetId)}).catch(Cf)):(Z1(r,n.targetId),await J1(r.localStore,n.targetId,!0))}async function N9(e,t,r){const n=U9(e);try{const i=await function(a,o){const c=He(a),l=nr.now(),u=o.reduce((p,g)=>p.add(g.key),Xe());let f,d;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let g=vs(),m=Xe();return c.ss.getEntries(p,u).next(v=>{g=v,g.forEach((_,x)=>{x.isValidDocument()||(m=m.add(_))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,g)).next(v=>{f=v;const _=[];for(const x of o){const y=sV(x,f.get(x.key).overlayedDocument);y!=null&&_.push(new ya(x.key,y,LI(y.value.mapValue),Bi.exists(!0)))}return c.mutationQueue.addMutationBatch(p,l,_,o)}).next(v=>{d=v;const _=v.applyToLocalDocumentSet(f,m);return c.documentOverlayCache.saveOverlays(p,v.batchId,_)})}).then(()=>({batchId:d.batchId,changes:qI(f)}))}(n.localStore,t);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,c){let l=a.Sa[a.currentUser.toKey()];l||(l=new Ft(lt)),l=l.insert(o,c),a.Sa[a.currentUser.toKey()]=l}(n,i.batchId,r),await Pf(n,i.changes),await _p(n.remoteStore)}catch(i){const s=E_(i,"Failed to persist write");r.reject(s)}}async function RR(e,t){const r=He(e);try{const n=await QV(r.localStore,t);t.targetChanges.forEach((i,s)=>{const a=r.ya.get(s);a&&(wt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.Ra=!0:i.modifiedDocuments.size>0?wt(a.Ra):i.removedDocuments.size>0&&(wt(a.Ra),a.Ra=!1))}),await Pf(r,n,t)}catch(n){await Cf(n)}}function m2(e,t,r){const n=He(e);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.ma.forEach((s,a)=>{const o=a.view.Q_(t);o.snapshot&&i.push(o.snapshot)}),function(a,o){const c=He(a);c.onlineState=o;let l=!1;c.queries.forEach((u,f)=>{for(const d of f.listeners)d.Q_(o)&&(l=!0)}),l&&w_(c)}(n.eventManager,t),i.length&&n.Va.a_(i),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function D9(e,t,r){const n=He(e);n.sharedClientState.updateQueryState(t,"rejected",r);const i=n.ya.get(t),s=i&&i.key;if(s){let a=new Ft(be.comparator);a=a.insert(s,Br.newNoDocument(s,je.min()));const o=Xe().add(s),c=new gp(je.min(),new Map,new Ft(lt),a,o);await RR(n,c),n.pa=n.pa.remove(s),n.ya.delete(t),T_(n)}else await J1(n.localStore,t,!1).then(()=>Z1(n,t,r)).catch(Cf)}async function O9(e,t){const r=He(e),n=t.batch.batchId;try{const i=await YV(r.localStore,t);FR(r,n,null),bR(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Pf(r,i)}catch(i){await Cf(i)}}async function L9(e,t,r){const n=He(e);try{const i=await function(a,o){const c=He(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return c.mutationQueue.lookupMutationBatch(l,o).next(f=>(wt(f!==null),u=f.keys(),c.mutationQueue.removeMutationBatch(l,f))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,u,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>c.localDocuments.getDocuments(l,u))})}(n.localStore,t);FR(n,t,r),bR(n,t),n.sharedClientState.updateMutationState(t,"rejected",r),await Pf(n,i)}catch(i){await Cf(i)}}function bR(e,t){(e.ba.get(t)||[]).forEach(r=>{r.resolve()}),e.ba.delete(t)}function FR(e,t,r){const n=He(e);let i=n.Sa[n.currentUser.toKey()];if(i){const s=i.get(t);s&&(r?s.reject(r):s.resolve(),i=i.remove(t)),n.Sa[n.currentUser.toKey()]=i}}function Z1(e,t,r=null){e.sharedClientState.removeLocalQueryTarget(t);for(const n of e.fa.get(t))e.ma.delete(n),r&&e.Va.Fa(n,r);e.fa.delete(t),e.isPrimaryClient&&e.wa.Rr(t).forEach(n=>{e.wa.containsKey(n)||PR(e,n)})}function PR(e,t){e.ga.delete(t.path.canonicalString());const r=e.pa.get(t);r!==null&&(xR(e.remoteStore,r),e.pa=e.pa.remove(t),e.ya.delete(r),T_(e))}function g2(e,t,r){for(const n of r)n instanceof CR?(e.wa.addReference(n.key,t),M9(e,n)):n instanceof IR?(Ce("SyncEngine","Document no longer in limbo: "+n.key),e.wa.removeReference(n.key,t),e.wa.containsKey(n.key)||PR(e,n.key)):Le()}function M9(e,t){const r=t.key,n=r.path.canonicalString();e.pa.get(r)||e.ga.has(n)||(Ce("SyncEngine","New document in limbo: "+r),e.ga.add(n),T_(e))}function T_(e){for(;e.ga.size>0&&e.pa.size<e.maxConcurrentLimboResolutions;){const t=e.ga.values().next().value;e.ga.delete(t);const r=new be(yt.fromString(t)),n=e.Da.next();e.ya.set(n,new I9(r)),e.pa=e.pa.insert(r,n),vR(e.remoteStore,new Bs(ji(u_(r.path)),n,"TargetPurposeLimboResolution",i_._e))}}async function Pf(e,t,r){const n=He(e),i=[],s=[],a=[];n.ma.isEmpty()||(n.ma.forEach((o,c)=>{a.push(n.va(c,t,r).then(l=>{if((l||r)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(c.targetId,l!=null&&l.fromCache?"not-current":"current"),l){i.push(l);const u=g_.Qi(c.targetId,l);s.push(u)}}))}),await Promise.all(a),n.Va.a_(i),await async function(c,l){const u=He(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>le.forEach(l,d=>le.forEach(d.ki,p=>u.persistence.referenceDelegate.addReference(f,d.targetId,p)).next(()=>le.forEach(d.qi,p=>u.persistence.referenceDelegate.removeReference(f,d.targetId,p)))))}catch(f){if(!If(f))throw f;Ce("LocalStore","Failed to update sequence numbers: "+f)}for(const f of l){const d=f.targetId;if(!f.fromCache){const p=u.ts.get(d),g=p.snapshotVersion,m=p.withLastLimboFreeSnapshotVersion(g);u.ts=u.ts.insert(d,m)}}}(n.localStore,s))}async function V9(e,t){const r=He(e);if(!r.currentUser.isEqual(t)){Ce("SyncEngine","User change. New user:",t.toKey());const n=await dR(r.localStore,t);r.currentUser=t,function(s,a){s.ba.forEach(o=>{o.forEach(c=>{c.reject(new Te(se.CANCELLED,a))})}),s.ba.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await Pf(r,n._s)}}function j9(e,t){const r=He(e),n=r.ya.get(t);if(n&&n.Ra)return Xe().add(n.key);{let i=Xe();const s=r.fa.get(t);if(!s)return i;for(const a of s){const o=r.ma.get(a);i=i.unionWith(o.view.ua)}return i}}function B9(e){const t=He(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=RR.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=j9.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=D9.bind(null,t),t.Va.a_=S9.bind(null,t.eventManager),t.Va.Fa=A9.bind(null,t.eventManager),t}function U9(e){const t=He(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=O9.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=L9.bind(null,t),t}class v2{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=vp(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,r){return null}createIndexBackfillerScheduler(t,r){return null}createLocalStore(t){return XV(this.persistence,new qV,t.initialUser,this.serializer)}createPersistence(t){return new zV(m_.jr,this.serializer)}createSharedClientState(t){return new r9}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class $9{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>m2(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=V9.bind(null,this.syncEngine),await E9(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new T9}()}createDatastore(t){const r=vp(t.databaseInfo.databaseId),n=function(s){return new a9(s)}(t.databaseInfo);return function(s,a,o,c){return new l9(s,a,o,c)}(t.authCredentials,t.appCheckCredentials,n,r)}createRemoteStore(t){return function(n,i,s,a,o){return new f9(n,i,s,a,o)}(this.localStore,this.datastore,t.asyncQueue,r=>m2(this.syncEngine,r,0),function(){return h2.D()?new h2:new n9}())}createSyncEngine(t,r){return function(i,s,a,o,c,l,u){const f=new R9(i,s,a,o,c,l);return u&&(f.Ca=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return async function(r){const n=He(r);Ce("RemoteStore","RemoteStore shutting down."),n.C_.add(5),await Ff(n),n.F_.shutdown(),n.M_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NR{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Oa(this.observer.next,t)}error(t){this.observer.error?this.Oa(this.observer.error,t):gs("Uncaught Error in snapshot listener:",t.toString())}Na(){this.muted=!0}Oa(t,r){this.muted||setTimeout(()=>{this.muted||t(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H9{constructor(t,r,n,i){this.authCredentials=t,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Lr.UNAUTHENTICATED,this.clientId=NI.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,async s=>{Ce("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(Ce("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Te(se.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new os;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(r){const n=E_(r,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function Hm(e,t){e.asyncQueue.verifyOperationInProgress(),Ce("FirestoreClient","Initializing OfflineComponentProvider");const r=await e.getConfiguration();await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async i=>{n.isEqual(i)||(await dR(t.localStore,i),n=i)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function x2(e,t){e.asyncQueue.verifyOperationInProgress();const r=await W9(e);Ce("FirestoreClient","Initializing OnlineComponentProvider");const n=await e.getConfiguration();await t.initialize(r,n),e.setCredentialChangeListener(i=>d2(t.remoteStore,i)),e.setAppCheckTokenChangeListener((i,s)=>d2(t.remoteStore,s)),e._onlineComponents=t}function z9(e){return e.name==="FirebaseError"?e.code===se.FAILED_PRECONDITION||e.code===se.UNIMPLEMENTED:!(typeof DOMException<"u"&&e instanceof DOMException)||e.code===22||e.code===20||e.code===11}async function W9(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Ce("FirestoreClient","Using user provided OfflineComponentProvider");try{await Hm(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!z9(r))throw r;Cc("Error using user provided cache. Falling back to memory cache: "+r),await Hm(e,new v2)}}else Ce("FirestoreClient","Using default OfflineComponentProvider"),await Hm(e,new v2);return e._offlineComponents}async function DR(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Ce("FirestoreClient","Using user provided OnlineComponentProvider"),await x2(e,e._uninitializedComponentsProvider._online)):(Ce("FirestoreClient","Using default OnlineComponentProvider"),await x2(e,new $9))),e._onlineComponents}function G9(e){return DR(e).then(t=>t.syncEngine)}async function OR(e){const t=await DR(e),r=t.eventManager;return r.onListen=b9.bind(null,t.syncEngine),r.onUnlisten=P9.bind(null,t.syncEngine),r}function q9(e,t,r={}){const n=new os;return e.asyncQueue.enqueueAndForget(async()=>function(s,a,o,c,l){const u=new NR({next:d=>{a.enqueueAndForget(()=>AR(s,f));const p=d.docs.has(o);!p&&d.fromCache?l.reject(new Te(se.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&d.fromCache&&c&&c.source==="server"?l.reject(new Te(se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(d)},error:d=>l.reject(d)}),f=new kR(u_(o.path),u,{includeMetadataChanges:!0,J_:!0});return SR(s,f)}(await OR(e),e.asyncQueue,t,r,n)),n.promise}function K9(e,t,r={}){const n=new os;return e.asyncQueue.enqueueAndForget(async()=>function(s,a,o,c,l){const u=new NR({next:d=>{a.enqueueAndForget(()=>AR(s,f)),d.fromCache&&c.source==="server"?l.reject(new Te(se.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(d)},error:d=>l.reject(d)}),f=new kR(o,u,{includeMetadataChanges:!0,J_:!0});return SR(s,f)}(await OR(e),e.asyncQueue,t,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LR(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _2=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MR(e,t,r){if(!r)throw new Te(se.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function X9(e,t,r,n){if(t===!0&&n===!0)throw new Te(se.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)}function y2(e){if(!be.isDocumentKey(e))throw new Te(se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function E2(e){if(be.isDocumentKey(e))throw new Te(se.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function yp(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(n){return n.constructor?n.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":Le()}function fa(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Te(se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=yp(e);throw new Te(se.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}function Y9(e,t){if(t<=0)throw new Te(se.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{constructor(t){var r,n;if(t.host===void 0){if(t.ssl!==void 0)throw new Te(se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(r=t.ssl)===null||r===void 0||r;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new Te(se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}X9("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=LR((n=t.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Te(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Te(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Te(se.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Ep{constructor(t,r,n,i){this._authCredentials=t,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new w2({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Te(se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(t){if(this._settingsFrozen)throw new Te(se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new w2(t),t.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new g8;switch(n.type){case"firstParty":return new y8(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Te(se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=_2.get(r);n&&(Ce("ComponentProvider","Removing Datastore"),_2.delete(r),n.terminate())}(this),Promise.resolve()}}function Q9(e,t,r,n={}){var i;const s=(e=fa(e,Ep))._getSettings(),a=`${t}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Cc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,c;if(typeof n.mockUserToken=="string")o=n.mockUserToken,c=Lr.MOCK_USER;else{o=Gk(n.mockUserToken,(i=e._app)===null||i===void 0?void 0:i.options.projectId);const l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new Te(se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Lr(l)}e._authCredentials=new v8(new PI(o,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(t,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Ea(this.firestore,t,this._query)}}class wn{constructor(t,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new na(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new wn(this.firestore,t,this._key)}}class na extends Ea{constructor(t,r,n){super(t,r,u_(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new wn(this.firestore,null,new be(t))}withConverter(t){return new na(this.firestore,t,this._path)}}function fn(e,t,...r){if(e=Ht(e),MR("collection","path",t),e instanceof Ep){const n=yt.fromString(t,...r);return E2(n),new na(e,null,n)}{if(!(e instanceof wn||e instanceof na))throw new Te(se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(yt.fromString(t,...r));return E2(n),new na(e.firestore,null,n)}}function wp(e,t,...r){if(e=Ht(e),arguments.length===1&&(t=NI.newId()),MR("doc","path",t),e instanceof Ep){const n=yt.fromString(t,...r);return y2(n),new wn(e,null,new be(n))}{if(!(e instanceof wn||e instanceof na))throw new Te(se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(yt.fromString(t,...r));return y2(n),new wn(e.firestore,e instanceof na?e.converter:null,new be(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J9{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new mR(this,"async_queue_retry"),this.iu=()=>{const r=$m();r&&Ce("AsyncQueue","Visibility state changed to "+r.visibilityState),this.zo.Qo()};const t=$m();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.su(),this.ou(t)}enterRestrictedMode(t){if(!this.Za){this.Za=!0,this.nu=t||!1;const r=$m();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.iu)}}enqueue(t){if(this.su(),this.Za)return new Promise(()=>{});const r=new os;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Ya.push(t),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(t){if(!If(t))throw t;Ce("AsyncQueue","Operation failed with retryable error: "+t)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(t){const r=this.Ja.then(()=>(this.tu=!0,t().catch(n=>{this.eu=n,this.tu=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw gs("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.tu=!1,n))));return this.Ja=r,r}enqueueAfterDelay(t,r,n){this.su(),this.ru.indexOf(t)>-1&&(r=0);const i=y_.createAndSchedule(this,t,r,n,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&Le()}verifyOperationInProgress(){}async uu(){let t;do t=this.Ja,await t;while(t!==this.Ja)}cu(t){for(const r of this.Xa)if(r.timerId===t)return!0;return!1}lu(t){return this.uu().then(()=>{this.Xa.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Xa)if(r.skipDelay(),t!=="all"&&r.timerId===t)break;return this.uu()})}hu(t){this.ru.push(t)}au(t){const r=this.Xa.indexOf(t);this.Xa.splice(r,1)}}class Nf extends Ep{constructor(t,r,n,i){super(t,r,n,i),this.type="firestore",this._queue=function(){return new J9}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||VR(this),this._firestoreClient.terminate()}}function Z9(e,t){const r=typeof e=="object"?e:Ax(),n=typeof e=="string"?e:t||"(default)",i=G0(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=Hk("firestore");s&&Q9(i,...s)}return i}function S_(e){return e._firestoreClient||VR(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function VR(e){var t,r,n;const i=e._freezeSettings(),s=function(o,c,l,u){return new P8(o,c,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,LR(u.experimentalLongPollingOptions),u.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new H9(e._authCredentials,e._appCheckCredentials,e._queue,s),!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nc{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Nc(Kr.fromBase64String(t))}catch(r){throw new Te(se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(t){return new Nc(Kr.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(...t){for(let r=0;r<t.length;++r)if(t[r].length===0)throw new Te(se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Tr(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A_{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_{constructor(t,r){if(!isFinite(t)||t<-90||t>90)throw new Te(se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(r)||r<-180||r>180)throw new Te(se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=t,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return lt(this._lat,t._lat)||lt(this._long,t._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ej=/^__.*__$/;class tj{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return this.fieldMask!==null?new ya(t,this.data,this.fieldMask,r,this.fieldTransforms):new Rf(t,this.data,r,this.fieldTransforms)}}class jR{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return new ya(t,this.data,this.fieldMask,r,this.fieldTransforms)}}function BR(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le()}}class C_{constructor(t,r,n,i,s,a){this.settings=t,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(t){return new C_(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),i=this.Tu({path:n,du:!1});return i.Au(t),i}Ru(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),i=this.Tu({path:n,du:!1});return i.Pu(),i}Vu(t){return this.Tu({path:void 0,du:!0})}mu(t){return e0(t,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(t){return this.fieldMask.find(r=>t.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>t.isPrefixOf(r.field))!==void 0}Pu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Au(this.path.get(t))}Au(t){if(t.length===0)throw this.mu("Document fields must not be empty");if(BR(this.Iu)&&ej.test(t))throw this.mu('Document fields cannot begin and end with "__"')}}class rj{constructor(t,r,n){this.databaseId=t,this.ignoreUndefinedProperties=r,this.serializer=n||vp(t)}pu(t,r,n,i=!1){return new C_({Iu:t,methodName:r,gu:n,path:Tr.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function I_(e){const t=e._freezeSettings(),r=vp(e._databaseId);return new rj(e._databaseId,!!t.ignoreUndefinedProperties,r)}function nj(e,t,r,n,i,s={}){const a=e.pu(s.merge||s.mergeFields?2:0,t,r,i);R_("Data must be an object, but it was:",a,n);const o=UR(n,a);let c,l;if(s.merge)c=new bn(a.fieldMask),l=a.fieldTransforms;else if(s.mergeFields){const u=[];for(const f of s.mergeFields){const d=ev(t,f,r);if(!a.contains(d))throw new Te(se.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);HR(u,d)||u.push(d)}c=new bn(u),l=a.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,l=a.fieldTransforms;return new tj(new gn(o),c,l)}class Sp extends A_{_toFieldTransform(t){if(t.Iu!==2)throw t.Iu===1?t.mu(`${this._methodName}() can only appear at the top level of your update data`):t.mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Sp}}function ij(e,t,r,n){const i=e.pu(1,t,r);R_("Data must be an object, but it was:",i,n);const s=[],a=gn.empty();Eo(n,(c,l)=>{const u=b_(t,c,r);l=Ht(l);const f=i.Ru(u);if(l instanceof Sp)s.push(u);else{const d=Df(l,f);d!=null&&(s.push(u),a.set(u,d))}});const o=new bn(s);return new jR(a,o,i.fieldTransforms)}function sj(e,t,r,n,i,s){const a=e.pu(1,t,r),o=[ev(t,n,r)],c=[i];if(s.length%2!=0)throw new Te(se.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)o.push(ev(t,s[d])),c.push(s[d+1]);const l=[],u=gn.empty();for(let d=o.length-1;d>=0;--d)if(!HR(l,o[d])){const p=o[d];let g=c[d];g=Ht(g);const m=a.Ru(p);if(g instanceof Sp)l.push(p);else{const v=Df(g,m);v!=null&&(l.push(p),u.set(p,v))}}const f=new bn(l);return new jR(u,f,a.fieldTransforms)}function aj(e,t,r,n=!1){return Df(r,e.pu(n?4:3,t))}function Df(e,t){if($R(e=Ht(e)))return R_("Unsupported field value:",t,e),UR(e,t);if(e instanceof A_)return function(n,i){if(!BR(i.Iu))throw i.mu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.du&&t.Iu!==4)throw t.mu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let c=Df(o,i.Vu(a));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),a++}return{arrayValue:{values:s}}}(e,t)}return function(n,i){if((n=Ht(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Z8(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=nr.fromDate(n);return{timestampValue:Jd(i.serializer,s)}}if(n instanceof nr){const s=new nr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Jd(i.serializer,s)}}if(n instanceof k_)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Nc)return{bytesValue:oR(i.serializer,n._byteString)};if(n instanceof wn){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:d_(n.firestore._databaseId||i.databaseId,n._key.path)}}throw i.mu(`Unsupported field value: ${yp(n)}`)}(e,t)}function UR(e,t){const r={};return DI(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Eo(e,(n,i)=>{const s=Df(i,t.Eu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function $R(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof nr||e instanceof k_||e instanceof Nc||e instanceof wn||e instanceof A_)}function R_(e,t,r){if(!$R(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=yp(r);throw n==="an object"?t.mu(e+" a custom object"):t.mu(e+" "+n)}}function ev(e,t,r){if((t=Ht(t))instanceof Tp)return t._internalPath;if(typeof t=="string")return b_(e,t);throw e0("Field path arguments must be of type string or ",e,!1,void 0,r)}const oj=new RegExp("[~\\*/\\[\\]]");function b_(e,t,r){if(t.search(oj)>=0)throw e0(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new Tp(...t.split("."))._internalPath}catch{throw e0(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function e0(e,t,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(s||a)&&(c+=" (found",s&&(c+=` in field ${n}`),a&&(c+=` in document ${i}`),c+=")"),new Te(se.INVALID_ARGUMENT,o+e+c)}function HR(e,t){return e.some(r=>r.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(t,r,n,i,s){this._firestore=t,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new wn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new cj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const r=this._document.data.field(Ap("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r)}}}class cj extends zR{data(){return super.data()}}function Ap(e,t){return typeof t=="string"?b_(e,t):t instanceof Tp?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lj(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new Te(se.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class F_{}class P_ extends F_{}function Yc(e,t,...r){let n=[];t instanceof F_&&n.push(t),n=n.concat(r),function(s){const a=s.filter(c=>c instanceof N_).length,o=s.filter(c=>c instanceof kp).length;if(a>1||a>0&&o>0)throw new Te(se.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)e=i._apply(e);return e}class kp extends P_{constructor(t,r,n){super(),this._field=t,this._op=r,this._value=n,this.type="where"}static _create(t,r,n){return new kp(t,r,n)}_apply(t){const r=this._parse(t);return GR(t._query,r),new Ea(t.firestore,t.converter,q1(t._query,r))}_parse(t){const r=I_(t.firestore);return function(s,a,o,c,l,u,f){let d;if(l.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Te(se.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){S2(f,u);const p=[];for(const g of f)p.push(T2(c,s,g));d={arrayValue:{values:p}}}else d=T2(c,s,f)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||S2(f,u),d=aj(o,a,f,u==="in"||u==="not-in");return Qt.create(l,u,d)}(t._query,"where",r,t.firestore._databaseId,this._field,this._op,this._value)}}function Cp(e,t,r){const n=t,i=Ap("where",e);return kp._create(i,n,r)}class N_ extends F_{constructor(t,r){super(),this.type=t,this._queryConstraints=r}static _create(t,r){return new N_(t,r)}_parse(t){const r=this._queryConstraints.map(n=>n._parse(t)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:_i.create(r,this._getOperator())}_apply(t){const r=this._parse(t);return r.getFilters().length===0?t:(function(i,s){let a=i;const o=s.getFlattenedFilters();for(const c of o)GR(a,c),a=q1(a,c)}(t._query,r),new Ea(t.firestore,t.converter,q1(t._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class D_ extends P_{constructor(t,r){super(),this._field=t,this._direction=r,this.type="orderBy"}static _create(t,r){return new D_(t,r)}_apply(t){const r=function(i,s,a){if(i.startAt!==null)throw new Te(se.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Te(se.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new zu(s,a)}(t._query,this._field,this._direction);return new Ea(t.firestore,t.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new qc(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(t._query,r))}}function uj(e,t="asc"){const r=t,n=Ap("orderBy",e);return D_._create(n,r)}class O_ extends P_{constructor(t,r,n){super(),this.type=t,this._limit=r,this._limitType=n}static _create(t,r,n){return new O_(t,r,n)}_apply(t){return new Ea(t.firestore,t.converter,Xd(t._query,this._limit,this._limitType))}}function WR(e){return Y9("limit",e),O_._create("limit",e,"F")}function T2(e,t,r){if(typeof(r=Ht(r))=="string"){if(r==="")throw new Te(se.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!HI(t)&&r.indexOf("/")!==-1)throw new Te(se.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=t.path.child(yt.fromString(r));if(!be.isDocumentKey(n))throw new Te(se.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return qw(e,new be(n))}if(r instanceof wn)return qw(e,r._key);throw new Te(se.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${yp(r)}.`)}function S2(e,t){if(!Array.isArray(e)||e.length===0)throw new Te(se.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function GR(e,t){const r=function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(e.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(r!==null)throw r===t.op?new Te(se.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Te(se.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}class fj{convertValue(t,r="none"){switch(ao(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Kt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,r);case 5:return t.stringValue;case 6:return this.convertBytes(so(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,r);case 10:return this.convertObject(t.mapValue,r);default:throw Le()}}convertObject(t,r){return this.convertObjectMap(t.fields,r)}convertObjectMap(t,r="none"){const n={};return Eo(t,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertGeoPoint(t){return new k_(Kt(t.latitude),Kt(t.longitude))}convertArray(t,r){return(t.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(t,r){switch(r){case"previous":const n=a_(t);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Uu(t));default:return null}}convertTimestamp(t){const r=la(t);return new nr(r.seconds,r.nanos)}convertDocumentKey(t,r){const n=yt.fromString(t);wt(hR(n));const i=new $u(n.get(1),n.get(3)),s=new be(n.popFirst(5));return i.isEqual(r)||gs(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hj(e,t,r){let n;return n=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(t,r){this.hasPendingWrites=t,this.fromCache=r}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class qR extends zR{constructor(t,r,n,i,s,a){super(t,r,n,i,a),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const r=new Jh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,r={}){if(this._document){const n=this._document.data.field(Ap("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Jh extends qR{data(t={}){return super.data(t)}}class dj{constructor(t,r,n,i){this._firestore=t,this._userDataWriter=r,this._snapshot=i,this.metadata=new bl(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach(r=>t.push(r)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,r){this._snapshot.docs.forEach(n=>{t.call(r,new Jh(this._firestore,this._userDataWriter,n.key,n,new bl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const r=!!t.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Te(se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const c=new Jh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new bl(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const c=new Jh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new bl(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,u=-1;return o.type!==0&&(l=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),u=a.indexOf(o.doc.key)),{type:pj(o.type),doc:c,oldIndex:l,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function pj(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_(e){e=fa(e,wn);const t=fa(e.firestore,Nf);return q9(S_(t),e._key).then(r=>mj(t,e,r))}class KR extends fj{constructor(t){super(),this.firestore=t}convertBytes(t){return new Nc(t)}convertReference(t){const r=this.convertDocumentKey(t,this.firestore._databaseId);return new wn(this.firestore,null,r)}}function To(e){e=fa(e,Ea);const t=fa(e.firestore,Nf),r=S_(t),n=new KR(t);return lj(e._query),K9(r,e._query).then(i=>new dj(t,n,e,i))}function XR(e,t,r,...n){e=fa(e,wn);const i=fa(e.firestore,Nf),s=I_(i);let a;return a=typeof(t=Ht(t))=="string"||t instanceof Tp?sj(s,"updateDoc",e._key,t,r,n):ij(s,"updateDoc",e._key,t),YR(i,[a.toMutation(e._key,Bi.exists(!0))])}function wa(e,t){const r=fa(e.firestore,Nf),n=wp(e),i=hj(e.converter,t);return YR(r,[nj(I_(e.firestore),"addDoc",n._key,i,e.converter!==null,{}).toMutation(n._key,Bi.exists(!1))]).then(()=>n)}function YR(e,t){return function(n,i){const s=new os;return n.asyncQueue.enqueueAndForget(async()=>N9(await G9(n),i,s)),s.promise}(S_(e),t)}function mj(e,t,r){const n=r.docs.get(t._key),i=new KR(e);return new qR(e,i,t._key,n,new bl(r.hasPendingWrites,r.fromCache),t.converter)}(function(t,r=!0){(function(i){Gc=i})(go),to(new oa("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new Nf(new x8(n.getProvider("auth-internal")),new w8(n.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new Te(se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $u(l.options.projectId,u)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),Li(Hw,"4.3.2",t),Li(Hw,"4.3.2","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR="firebasestorage.googleapis.com",JR="storageBucket",gj=2*60*1e3,vj=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt extends Wi{constructor(t,r,n=0){super(zm(t),`Firebase Storage: ${r} (${zm(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,jt.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return zm(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Mt;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Mt||(Mt={}));function zm(e){return"storage/"+e}function M_(){const e="An unknown error occurred, please check the error payload for server response.";return new jt(Mt.UNKNOWN,e)}function xj(e){return new jt(Mt.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")}function _j(e){return new jt(Mt.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function yj(){const e="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new jt(Mt.UNAUTHENTICATED,e)}function Ej(){return new jt(Mt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function wj(e){return new jt(Mt.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function Tj(){return new jt(Mt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Sj(){return new jt(Mt.CANCELED,"User canceled the upload/download.")}function Aj(e){return new jt(Mt.INVALID_URL,"Invalid URL '"+e+"'.")}function kj(e){return new jt(Mt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function Cj(){return new jt(Mt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+JR+"' property when initializing the app?")}function Ij(){return new jt(Mt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Rj(){return new jt(Mt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function bj(e){return new jt(Mt.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function tv(e){return new jt(Mt.INVALID_ARGUMENT,e)}function ZR(){return new jt(Mt.APP_DELETED,"The Firebase app was deleted.")}function Fj(e){return new jt(Mt.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Jl(e,t){return new jt(Mt.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function gl(e){throw new jt(Mt.INTERNAL_ERROR,"Internal error: "+e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(t,r){this.bucket=t,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,r){let n;try{n=Fn.makeFromUrl(t,r)}catch{return new Fn(t,"")}if(n.path==="")return n;throw kj(t)}static makeFromUrl(t,r){let n=null;const i="([A-Za-z0-9.\\-_]+)";function s(w){w.path.charAt(w.path.length-1)==="/"&&(w.path_=w.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),c={bucket:1,path:3};function l(w){w.path_=decodeURIComponent(w.path)}const u="v[A-Za-z0-9_]+",f=r.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",p=new RegExp(`^https?://${f}/${u}/b/${i}/o${d}`,"i"),g={bucket:1,path:3},m=r===QR?"(?:storage.googleapis.com|storage.cloud.google.com)":r,v="([^?#]*)",_=new RegExp(`^https?://${m}/${i}/${v}`,"i"),y=[{regex:o,indices:c,postModify:s},{regex:p,indices:g,postModify:l},{regex:_,indices:{bucket:1,path:2},postModify:l}];for(let w=0;w<y.length;w++){const T=y[w],S=T.regex.exec(t);if(S){const E=S[T.indices.bucket];let k=S[T.indices.path];k||(k=""),n=new Fn(E,k),T.postModify(n);break}}if(n==null)throw Aj(t);return n}}class Pj{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nj(e,t,r){let n=1,i=null,s=null,a=!1,o=0;function c(){return o===2}let l=!1;function u(...v){l||(l=!0,t.apply(null,v))}function f(v){i=setTimeout(()=>{i=null,e(p,c())},v)}function d(){s&&clearTimeout(s)}function p(v,..._){if(l){d();return}if(v){d(),u.call(null,v,..._);return}if(c()||a){d(),u.call(null,v,..._);return}n<64&&(n*=2);let y;o===1?(o=2,y=0):y=(n+Math.random())*1e3,f(y)}let g=!1;function m(v){g||(g=!0,d(),!l&&(i!==null?(v||(o=2),clearTimeout(i),f(0)):v||(o=1)))}return f(0),s=setTimeout(()=>{a=!0,m(!0)},r),m}function Dj(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oj(e){return e!==void 0}function Lj(e){return typeof e=="object"&&!Array.isArray(e)}function V_(e){return typeof e=="string"||e instanceof String}function A2(e){return j_()&&e instanceof Blob}function j_(){return typeof Blob<"u"&&!I3()}function k2(e,t,r,n){if(n<t)throw tv(`Invalid value for '${e}'. Expected ${t} or greater.`);if(n>r)throw tv(`Invalid value for '${e}'. Expected ${r} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B_(e,t,r){let n=t;return r==null&&(n=`https://${t}`),`${r}://${n}/v0${e}`}function e4(e){const t=encodeURIComponent;let r="?";for(const n in e)if(e.hasOwnProperty(n)){const i=t(n)+"="+t(e[n]);r=r+i+"&"}return r=r.slice(0,-1),r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ga;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(Ga||(Ga={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mj(e,t){const r=e>=500&&e<600,i=[408,429].indexOf(e)!==-1,s=t.indexOf(e)!==-1;return r||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vj{constructor(t,r,n,i,s,a,o,c,l,u,f,d=!0){this.url_=t,this.method_=r,this.headers_=n,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=f,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,g)=>{this.resolve_=p,this.reject_=g,this.start_()})}start_(){const t=(n,i)=>{if(i){n(!1,new gh(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const c=o.loaded,l=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===Ga.NO_ERROR,c=s.getStatus();if(!o||Mj(c,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===Ga.ABORT;n(!1,new gh(!1,null,u));return}const l=this.successCodes_.indexOf(c)!==-1;n(!0,new gh(l,s))})},r=(n,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(o,o.getResponse());Oj(c)?s(c):s()}catch(c){a(c)}else if(o!==null){const c=M_();c.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,c)):a(c)}else if(i.canceled){const c=this.appDelete_?ZR():Sj();a(c)}else{const c=Tj();a(c)}};this.canceled_?r(!1,new gh(!1,null,!0)):this.backoffId_=Nj(t,r,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&Dj(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class gh{constructor(t,r,n){this.wasSuccessCode=t,this.connection=r,this.canceled=!!n}}function jj(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function Bj(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function Uj(e,t){t&&(e["X-Firebase-GMPID"]=t)}function $j(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function Hj(e,t,r,n,i,s,a=!0){const o=e4(e.urlParams),c=e.url+o,l=Object.assign({},e.headers);return Uj(l,t),jj(l,r),Bj(l,s),$j(l,n),new Vj(c,e.method,l,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zj(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Wj(...e){const t=zj();if(t!==void 0){const r=new t;for(let n=0;n<e.length;n++)r.append(e[n]);return r.getBlob()}else{if(j_())return new Blob(e);throw new jt(Mt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Gj(e,t,r){return e.webkitSlice?e.webkitSlice(t,r):e.mozSlice?e.mozSlice(t,r):e.slice?e.slice(t,r):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qj(e){if(typeof atob>"u")throw bj("base-64");return atob(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Wm{constructor(t,r){this.data=t,this.contentType=r||null}}function Kj(e,t){switch(e){case Pi.RAW:return new Wm(t4(t));case Pi.BASE64:case Pi.BASE64URL:return new Wm(r4(e,t));case Pi.DATA_URL:return new Wm(Yj(t),Qj(t))}throw M_()}function t4(e){const t=[];for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);if(n<=127)t.push(n);else if(n<=2047)t.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(r<e.length-1&&(e.charCodeAt(r+1)&64512)===56320))t.push(239,191,189);else{const s=n,a=e.charCodeAt(++r);n=65536|(s&1023)<<10|a&1023,t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?t.push(239,191,189):t.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(t)}function Xj(e){let t;try{t=decodeURIComponent(e)}catch{throw Jl(Pi.DATA_URL,"Malformed data URL.")}return t4(t)}function r4(e,t){switch(e){case Pi.BASE64:{const i=t.indexOf("-")!==-1,s=t.indexOf("_")!==-1;if(i||s)throw Jl(e,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Pi.BASE64URL:{const i=t.indexOf("+")!==-1,s=t.indexOf("/")!==-1;if(i||s)throw Jl(e,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=qj(t)}catch(i){throw i.message.includes("polyfill")?i:Jl(e,"Invalid character found")}const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}class n4{constructor(t){this.base64=!1,this.contentType=null;const r=t.match(/^data:([^,]+)?,/);if(r===null)throw Jl(Pi.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=r[1]||null;n!=null&&(this.base64=Jj(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=t.substring(t.indexOf(",")+1)}}function Yj(e){const t=new n4(e);return t.base64?r4(Pi.BASE64,t.rest):Xj(t.rest)}function Qj(e){return new n4(e).contentType}function Jj(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(t,r){let n=0,i="";A2(t)?(this.data_=t,n=t.size,i=t.type):t instanceof ArrayBuffer?(r?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(r?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=i}size(){return this.size_}type(){return this.type_}slice(t,r){if(A2(this.data_)){const n=this.data_,i=Gj(n,t,r);return i===null?null:new Ds(i)}else{const n=new Uint8Array(this.data_.buffer,t,r-t);return new Ds(n,!0)}}static getBlob(...t){if(j_()){const r=t.map(n=>n instanceof Ds?n.data_:n);return new Ds(Wj.apply(null,r))}else{const r=t.map(a=>V_(a)?Kj(Pi.RAW,a).data:a.data_);let n=0;r.forEach(a=>{n+=a.byteLength});const i=new Uint8Array(n);let s=0;return r.forEach(a=>{for(let o=0;o<a.length;o++)i[s++]=a[o]}),new Ds(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i4(e){let t;try{t=JSON.parse(e)}catch{return null}return Lj(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zj(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function eB(e,t){const r=t.split("/").filter(n=>n.length>0).join("/");return e.length===0?r:e+"/"+r}function s4(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tB(e,t){return t}class Jr{constructor(t,r,n,i){this.server=t,this.local=r||t,this.writable=!!n,this.xform=i||tB}}let vh=null;function rB(e){return!V_(e)||e.length<2?e:s4(e)}function a4(){if(vh)return vh;const e=[];e.push(new Jr("bucket")),e.push(new Jr("generation")),e.push(new Jr("metageneration")),e.push(new Jr("name","fullPath",!0));function t(s,a){return rB(a)}const r=new Jr("name");r.xform=t,e.push(r);function n(s,a){return a!==void 0?Number(a):a}const i=new Jr("size");return i.xform=n,e.push(i),e.push(new Jr("timeCreated")),e.push(new Jr("updated")),e.push(new Jr("md5Hash",null,!0)),e.push(new Jr("cacheControl",null,!0)),e.push(new Jr("contentDisposition",null,!0)),e.push(new Jr("contentEncoding",null,!0)),e.push(new Jr("contentLanguage",null,!0)),e.push(new Jr("contentType",null,!0)),e.push(new Jr("metadata","customMetadata",!0)),vh=e,vh}function nB(e,t){function r(){const n=e.bucket,i=e.fullPath,s=new Fn(n,i);return t._makeStorageReference(s)}Object.defineProperty(e,"ref",{get:r})}function iB(e,t,r){const n={};n.type="file";const i=r.length;for(let s=0;s<i;s++){const a=r[s];n[a.local]=a.xform(n,t[a.server])}return nB(n,e),n}function o4(e,t,r){const n=i4(t);return n===null?null:iB(e,n,r)}function sB(e,t,r,n){const i=i4(t);if(i===null||!V_(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const a=encodeURIComponent;return s.split(",").map(l=>{const u=e.bucket,f=e.fullPath,d="/b/"+a(u)+"/o/"+a(f),p=B_(d,r,n),g=e4({alt:"media",token:l});return p+g})[0]}function aB(e,t){const r={},n=t.length;for(let i=0;i<n;i++){const s=t[i];s.writable&&(r[s.server]=e[s.local])}return JSON.stringify(r)}class c4{constructor(t,r,n,i){this.url=t,this.method=r,this.handler=n,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l4(e){if(!e)throw M_()}function oB(e,t){function r(n,i){const s=o4(e,i,t);return l4(s!==null),s}return r}function cB(e,t){function r(n,i){const s=o4(e,i,t);return l4(s!==null),sB(s,i,e.host,e._protocol)}return r}function u4(e){function t(r,n){let i;return r.getStatus()===401?r.getErrorText().includes("Firebase App Check token is invalid")?i=Ej():i=yj():r.getStatus()===402?i=_j(e.bucket):r.getStatus()===403?i=wj(e.path):i=n,i.status=r.getStatus(),i.serverResponse=n.serverResponse,i}return t}function lB(e){const t=u4(e);function r(n,i){let s=t(n,i);return n.getStatus()===404&&(s=xj(e.path)),s.serverResponse=i.serverResponse,s}return r}function uB(e,t,r){const n=t.fullServerUrl(),i=B_(n,e.host,e._protocol),s="GET",a=e.maxOperationRetryTime,o=new c4(i,s,cB(e,r),a);return o.errorHandler=lB(t),o}function fB(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function hB(e,t,r){const n=Object.assign({},r);return n.fullPath=e.path,n.size=t.size(),n.contentType||(n.contentType=fB(null,t)),n}function dB(e,t,r,n,i){const s=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function o(){let y="";for(let w=0;w<2;w++)y=y+Math.random().toString().slice(2);return y}const c=o();a["Content-Type"]="multipart/related; boundary="+c;const l=hB(t,n,i),u=aB(l,r),f="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,d=`\r
--`+c+"--",p=Ds.getBlob(f,n,d);if(p===null)throw Ij();const g={name:l.fullPath},m=B_(s,e.host,e._protocol),v="POST",_=e.maxUploadRetryTime,x=new c4(m,v,oB(e,r),_);return x.urlParams=g,x.headers=a,x.body=p.uploadData(),x.errorHandler=u4(t),x}class pB{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ga.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ga.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ga.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,r,n,i){if(this.sent_)throw gl("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(r,t,!0),i!==void 0)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return n!==void 0?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw gl("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw gl("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw gl("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw gl("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class mB extends pB{initXhr(){this.xhr_.responseType="text"}}function f4(){return new mB}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(t,r){this._service=t,r instanceof Fn?this._location=r:this._location=Fn.makeFromUrl(r,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,r){return new oo(t,r)}get root(){const t=new Fn(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return s4(this._location.path)}get storage(){return this._service}get parent(){const t=Zj(this._location.path);if(t===null)return null;const r=new Fn(this._location.bucket,t);return new oo(this._service,r)}_throwIfRoot(t){if(this._location.path==="")throw Fj(t)}}function gB(e,t,r){e._throwIfRoot("uploadBytes");const n=dB(e.storage,e._location,a4(),new Ds(t,!0),r);return e.storage.makeRequestWithTokens(n,f4).then(i=>({metadata:i,ref:e}))}function vB(e){e._throwIfRoot("getDownloadURL");const t=uB(e.storage,e._location,a4());return e.storage.makeRequestWithTokens(t,f4).then(r=>{if(r===null)throw Rj();return r})}function xB(e,t){const r=eB(e._location.path,t),n=new Fn(e._location.bucket,r);return new oo(e.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _B(e){return/^[A-Za-z]+:\/\//.test(e)}function yB(e,t){return new oo(e,t)}function h4(e,t){if(e instanceof U_){const r=e;if(r._bucket==null)throw Cj();const n=new oo(r,r._bucket);return t!=null?h4(n,t):n}else return t!==void 0?xB(e,t):e}function EB(e,t){if(t&&_B(t)){if(e instanceof U_)return yB(e,t);throw tv("To use ref(service, url), the first argument must be a Storage instance.")}else return h4(e,t)}function C2(e,t){const r=t==null?void 0:t[JR];return r==null?null:Fn.makeFromBucketSpec(r,e)}function wB(e,t,r,n={}){e.host=`${t}:${r}`,e._protocol="http";const{mockUserToken:i}=n;i&&(e._overrideAuthToken=typeof i=="string"?i:Gk(i,e.app.options.projectId))}class U_{constructor(t,r,n,i,s){this.app=t,this._authProvider=r,this._appCheckProvider=n,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=QR,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=gj,this._maxUploadRetryTime=vj,this._requests=new Set,i!=null?this._bucket=Fn.makeFromBucketSpec(i,this._host):this._bucket=C2(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=Fn.makeFromBucketSpec(this._url,t):this._bucket=C2(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){k2("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){k2("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const r=await t.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new oo(this,t)}_makeRequest(t,r,n,i,s=!0){if(this._deleted)return new Pj(ZR());{const a=Hj(t,this._appId,n,i,r,this._firebaseVersion,s);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(t,r){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,r,n,i).getPromise()}}const I2="@firebase/storage",R2="0.11.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d4="storage";function p4(e,t,r){return e=Ht(e),gB(e,t,r)}function TB(e){return e=Ht(e),vB(e)}function $_(e,t){return e=Ht(e),EB(e,t)}function SB(e=Ax(),t){e=Ht(e);const n=G0(e,d4).getImmediate({identifier:t}),i=Hk("storage");return i&&AB(n,...i),n}function AB(e,t,r,n={}){wB(e,t,r,n)}function kB(e,{instanceIdentifier:t}){const r=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new U_(r,n,i,t,go)}function CB(){to(new oa(d4,kB,"PUBLIC").setMultipleInstances(!0)),Li(I2,R2,""),Li(I2,R2,"esm2017")}CB();const IB={apiKey:"AIzaSyBktaPDjpc5sEMyZN7RCrlPPrupX9aFAOo",authDomain:"portal-impacto-ba606.firebaseapp.com",projectId:"portal-impacto-ba606",storageBucket:"portal-impacto-ba606.appspot.com",messagingSenderId:{}.VITE_FIREBASE_MESSAGING_ID,appId:"1:973609007998:web:41d149e29165aecdb1912f"},H_=Xk(IB),Gi=a5(H_),gr=Z9(H_),z_=SB(H_),RB=async(e,t)=>{try{return(await zM(Gi,e,t)).user}catch(r){const n=r.code,i=r.message;throw console.error("Error creating user:",n,i),r}},bB=async(e,t)=>{const n=(await WM(Gi,e,t)).user,i=await n.getIdToken();return localStorage.setItem("userToken",i),n},m4=()=>{const e=localStorage.getItem("userToken");return e!=null},FB=async()=>{try{await KM(Gi),localStorage.removeItem("userToken")}catch(e){console.error("logout",e)}},PB=async e=>{try{const t=await wa(fn(gr,"Users"),{...e});console.log("Document written with ID: ",t.id)}catch(t){console.error("Error adding document: ",t)}},g4=async e=>{try{return await wa(fn(gr,"Week"),{...e,userId:Gi.currentUser.uid})}catch(t){console.error("Error adding document: ",t)}},v4=async e=>{try{return await wa(fn(gr,"Activity"),{...e,userId:Gi.currentUser.uid})}catch(t){console.error("Error adding document: ",t)}},x4=async e=>{try{return await wa(fn(gr,"ActivityStatusHistory"),{...e,userId:Gi.currentUser.uid})}catch(t){console.error("Error adding document: ",t)}},NB=async e=>{try{return await wa(fn(gr,"ActivityPlanning"),{...e,userId:Gi.currentUser.uid})}catch(t){console.error("Error adding document: ",t)}},DB=async e=>{try{const t=fn(gr,"ActivityLog"),r={...e,userId:Gi.currentUser.uid},n=await wa(t,r);return console.log("Document updated successfully with ID: ",n.id),n.id}catch(t){console.error("Error updating the document:",t)}},OB=async e=>{try{return await wa(fn(gr,"ActivityHistoryLog"),{...e,userId:Gi.currentUser.uid})}catch(t){throw console.error("Error adding document: ",t),t}},LB=async({itemsPerPage:e})=>{try{const t=Yc(fn(gr,"Activity"),uj("week_name","desc"),WR(e)),r=await To(t),n=[];return r.forEach(i=>{const s=i.data();n.push({id:i.id,data:s})}),n}catch(t){throw console.error("Error al obtener actividades: ",t),t}},MB=async({itemsPerPage:e})=>{try{const t=Yc(fn(gr,"Users"),WR(e)),r=await To(t),n=[];return r.forEach(i=>{const s=i.data();n.push({id:i.id,data:s})}),console.log(n),n}catch(t){throw console.error("Error al obtener actividades: ",t),t}},_4=async e=>{try{const t=Yc(fn(gr,"ActivityStatusHistory"),Cp("activity","==",e)),r=await To(t),n=[];return r.forEach(i=>{const s=i.data();n.push({id:i.id,data:{...s,activity:s.activity}})}),n}catch(t){throw console.error("Error al obtener estados: ",t),t}},VB=async e=>{try{const t=fn(gr,"ActivityStatusHistory"),r={...e,userId:Gi.currentUser.uid},n=await wa(t,r);console.log("Document updated successfully with ID: ",n.id)}catch(t){console.error("Error updating the document:",t)}},jB=async(e,t)=>{try{const r=wp(gr,"Activity",e),n=await L_(r);if(n.exists()){const s={...n.data(),current_status:t};await XR(r,s),console.log("Campo 'current_status' actualizado en la colección 'Activity'")}else console.error("Error: Documento no encontrado en la colección 'Activity'")}catch(r){console.error("Error:",r)}};async function BB(e,t){const r=$_(z_,`${t}.xlsx`);await p4(r,e)}async function UB(e){const t=$_(z_,`activity_logs/${e[0].name}`);await p4(t,e[0])}const y4=async e=>{try{return(await To(fn(gr,e))).docs.map(n=>({id:n.id,data:n.data()}))}catch(t){throw console.error("Error al obtener documentos: ",t),t}},E4=async()=>y4("Week"),W_=async()=>y4("Activity"),$B=async e=>{try{const t=Yc(fn(gr,"ActivityLog"),Cp("activity","==",e)),r=await To(t),n=[];return r.forEach(i=>{const s=i.data();n.push({id:i.id,data:{...s,activity:s.activity}})}),n}catch(t){throw console.error("Error al obtener estados: ",t),t}},w4=async e=>{try{const t=Yc(fn(gr,"ActivityPlanning"),Cp("activity","==",e)),r=await To(t),n=[];return r.forEach(i=>{const s=i.data();n.push({id:i.id,data:{...s,activity:s.activity}})}),n}catch(t){throw console.error("Error al obtener estados: ",t),t}},HB=async e=>{try{const t=Yc(fn(gr,"ActivityHistoryLog"),Cp("activity","==",e)),r=await To(t),n=[];return r.forEach(i=>{const s=i.data();n.push({id:i.id,data:{...s,activity:s.activity}})}),n}catch(t){throw console.error("Error al obtener estados: ",t),t}},T4=async e=>{try{const t=$_(z_,"gs://portal-impacto-ba606.appspot.com/activity_logs"+e);return await TB(t)}catch(t){throw console.error("Error al obtener la URL de descarga:",t),t}},zB=async e=>{try{return(await W_()).filter(n=>{const i=n.data.u_tecnica||"",s=e.toLowerCase();return i.toLowerCase().includes(s)}).map(n=>n.data.u_tecnica)}catch(t){throw console.error("Error al buscar unidad técnica:",t),t}},WB=async e=>{try{const t=wp(gr,"Activity",e),r=await L_(t);if(r.exists())return{data:{...r.data()}}}catch(t){throw console.error("Error al obtener el documento: ",t),t}},GB=async(e,t,r)=>{try{const n=wp(gr,"Activity",e),i=await L_(n);if(i.exists()){const a={...i.data(),[t]:r};await XR(n,a),console.log("Campo 'current_status' actualizado en la colección 'Activity'")}else console.error("Error: Documento no encontrado en la colección 'Activity'")}catch(n){throw console.error("Error:",n),n}};var Of=e=>e.type==="checkbox",Zo=e=>e instanceof Date,en=e=>e==null;const S4=e=>typeof e=="object";var sr=e=>!en(e)&&!Array.isArray(e)&&S4(e)&&!Zo(e),A4=e=>sr(e)&&e.target?Of(e.target)?e.target.checked:e.target.value:e,qB=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,k4=(e,t)=>e.has(qB(t)),KB=e=>{const t=e.constructor&&e.constructor.prototype;return sr(t)&&t.hasOwnProperty("isPrototypeOf")},G_=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Mr(e){let t;const r=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(G_&&(e instanceof Blob||e instanceof FileList))&&(r||sr(e)))if(t=r?[]:{},!r&&!KB(e))t=e;else for(const n in e)e.hasOwnProperty(n)&&(t[n]=Mr(e[n]));else return e;return t}var Qc=e=>Array.isArray(e)?e.filter(Boolean):[],xt=e=>e===void 0,ye=(e,t,r)=>{if(!t||!sr(e))return r;const n=Qc(t.split(/[,[\].]+?/)).reduce((i,s)=>en(i)?i:i[s],e);return xt(n)||n===e?xt(e[t])?r:e[t]:n},Us=e=>typeof e=="boolean";const t0={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Yn={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Qi={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},XB=ke.createContext(null),Ip=()=>ke.useContext(XB);var C4=(e,t,r,n=!0)=>{const i={defaultValues:t._defaultValues};for(const s in e)Object.defineProperty(i,s,{get:()=>{const a=s;return t._proxyFormState[a]!==Yn.all&&(t._proxyFormState[a]=!n||Yn.all),r&&(r[a]=!0),e[a]}});return i},kn=e=>sr(e)&&!Object.keys(e).length,I4=(e,t,r,n)=>{r(e);const{name:i,...s}=e;return kn(s)||Object.keys(s).length>=Object.keys(t).length||Object.keys(s).find(a=>t[a]===(!n||Yn.all))},Pn=e=>Array.isArray(e)?e:[e],R4=(e,t,r)=>!e||!t||e===t||Pn(e).some(n=>n&&(r?n===t:n.startsWith(t)||t.startsWith(n)));function Rp(e){const t=ke.useRef(e);t.current=e,ke.useEffect(()=>{const r=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{r&&r.unsubscribe()}},[e.disabled])}function YB(e){const t=Ip(),{control:r=t.control,disabled:n,name:i,exact:s}=e||{},[a,o]=ke.useState(r._formState),c=ke.useRef(!0),l=ke.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),u=ke.useRef(i);return u.current=i,Rp({disabled:n,next:f=>c.current&&R4(u.current,f.name,s)&&I4(f,l.current,r._updateFormState)&&o({...r._formState,...f}),subject:r._subjects.state}),ke.useEffect(()=>(c.current=!0,l.current.isValid&&r._updateValid(!0),()=>{c.current=!1}),[r]),C4(a,r,l.current,!1)}var Ni=e=>typeof e=="string",b4=(e,t,r,n,i)=>Ni(e)?(n&&t.watch.add(e),ye(r,e,i)):Array.isArray(e)?e.map(s=>(n&&t.watch.add(s),ye(r,s))):(n&&(t.watchAll=!0),r);function QB(e){const t=Ip(),{control:r=t.control,name:n,defaultValue:i,disabled:s,exact:a}=e||{},o=ke.useRef(n);o.current=n,Rp({disabled:s,subject:r._subjects.values,next:u=>{R4(o.current,u.name,a)&&l(Mr(b4(o.current,r._names,u.values||r._formValues,!1,i)))}});const[c,l]=ke.useState(r._getWatch(n,i));return ke.useEffect(()=>r._removeUnmounted()),c}var q_=e=>/^\w*$/.test(e),F4=e=>Qc(e.replace(/["|']|\]/g,"").split(/\.|\[/));function pt(e,t,r){let n=-1;const i=q_(t)?[t]:F4(t),s=i.length,a=s-1;for(;++n<s;){const o=i[n];let c=r;if(n!==a){const l=e[o];c=sr(l)||Array.isArray(l)?l:isNaN(+i[n+1])?{}:[]}e[o]=c,e=e[o]}return e}function JB(e){const t=Ip(),{name:r,disabled:n,control:i=t.control,shouldUnregister:s}=e,a=k4(i._names.array,r),o=QB({control:i,name:r,defaultValue:ye(i._formValues,r,ye(i._defaultValues,r,e.defaultValue)),exact:!0}),c=YB({control:i,name:r}),l=ke.useRef(i.register(r,{...e.rules,value:o}));return l.current=i.register(r,e.rules),ke.useEffect(()=>{const u=i._options.shouldUnregister||s,f=(d,p)=>{const g=ye(i._fields,d);g&&(g._f.mount=p)};if(f(r,!0),u){const d=Mr(ye(i._options.defaultValues,r));pt(i._defaultValues,r,d),xt(ye(i._formValues,r))&&pt(i._formValues,r,d)}return()=>{(a?u&&!i._state.action:u)?i.unregister(r):f(r,!1)}},[r,i,a,s]),ke.useEffect(()=>{ye(i._fields,r)&&i._updateDisabledField({disabled:n,fields:i._fields,name:r})},[n,r,i]),{field:{name:r,value:o,...Us(n)?{disabled:n}:{},onChange:ke.useCallback(u=>l.current.onChange({target:{value:A4(u),name:r},type:t0.CHANGE}),[r]),onBlur:ke.useCallback(()=>l.current.onBlur({target:{value:ye(i._formValues,r),name:r},type:t0.BLUR}),[r,i]),ref:u=>{const f=ye(i._fields,r);f&&u&&(f._f.ref={focus:()=>u.focus(),select:()=>u.select(),setCustomValidity:d=>u.setCustomValidity(d),reportValidity:()=>u.reportValidity()})}},formState:c,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!ye(c.errors,r)},isDirty:{enumerable:!0,get:()=>!!ye(c.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!ye(c.touchedFields,r)},error:{enumerable:!0,get:()=>ye(c.errors,r)}})}}const Ve=e=>e.render(JB(e));var ZB=(e,t,r,n,i)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[n]:i||!0}}:{};const r0=(e,t,r)=>{for(const n of r||Object.keys(e)){const i=ye(e,n);if(i){const{_f:s,...a}=i;if(s&&t(s.name)){if(s.ref.focus){s.ref.focus();break}else if(s.refs&&s.refs[0].focus){s.refs[0].focus();break}}else sr(a)&&r0(a,t)}}};var Ss=()=>{const e=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const r=(Math.random()*16+e)%16|0;return(t=="x"?r:r&3|8).toString(16)})},Gm=(e,t,r={})=>r.shouldFocus||xt(r.shouldFocus)?r.focusName||`${e}.${xt(r.focusIndex)?t:r.focusIndex}.`:"",rv=e=>({isOnSubmit:!e||e===Yn.onSubmit,isOnBlur:e===Yn.onBlur,isOnChange:e===Yn.onChange,isOnAll:e===Yn.all,isOnTouch:e===Yn.onTouched}),nv=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length)))),P4=(e,t,r)=>{const n=Qc(ye(e,r));return pt(n,"root",t[r]),pt(e,r,n),e},K_=e=>e.type==="file",$s=e=>typeof e=="function",n0=e=>{if(!G_)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},Zh=e=>Ni(e),X_=e=>e.type==="radio",i0=e=>e instanceof RegExp;const b2={value:!1,isValid:!1},F2={value:!0,isValid:!0};var N4=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!xt(e[0].attributes.value)?xt(e[0].value)||e[0].value===""?F2:{value:e[0].value,isValid:!0}:F2:b2}return b2};const P2={isValid:!1,value:null};var D4=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,P2):P2;function N2(e,t,r="validate"){if(Zh(e)||Array.isArray(e)&&e.every(Zh)||Us(e)&&!e)return{type:r,message:Zh(e)?e:"",ref:t}}var Po=e=>sr(e)&&!i0(e)?e:{value:e,message:""},iv=async(e,t,r,n,i)=>{const{ref:s,refs:a,required:o,maxLength:c,minLength:l,min:u,max:f,pattern:d,validate:p,name:g,valueAsNumber:m,mount:v,disabled:_}=e._f,x=ye(t,g);if(!v||_)return{};const y=a?a[0]:s,w=O=>{n&&y.reportValidity&&(y.setCustomValidity(Us(O)?"":O||""),y.reportValidity())},T={},S=X_(s),E=Of(s),k=S||E,b=(m||K_(s))&&xt(s.value)&&xt(x)||n0(s)&&s.value===""||x===""||Array.isArray(x)&&!x.length,j=ZB.bind(null,g,r,T),H=(O,V,G,X=Qi.maxLength,Z=Qi.minLength)=>{const ie=O?V:G;T[g]={type:O?X:Z,message:ie,ref:s,...j(O?X:Z,ie)}};if(i?!Array.isArray(x)||!x.length:o&&(!k&&(b||en(x))||Us(x)&&!x||E&&!N4(a).isValid||S&&!D4(a).isValid)){const{value:O,message:V}=Zh(o)?{value:!!o,message:o}:Po(o);if(O&&(T[g]={type:Qi.required,message:V,ref:y,...j(Qi.required,V)},!r))return w(V),T}if(!b&&(!en(u)||!en(f))){let O,V;const G=Po(f),X=Po(u);if(!en(x)&&!isNaN(x)){const Z=s.valueAsNumber||x&&+x;en(G.value)||(O=Z>G.value),en(X.value)||(V=Z<X.value)}else{const Z=s.valueAsDate||new Date(x),ie=ae=>new Date(new Date().toDateString()+" "+ae),re=s.type=="time",B=s.type=="week";Ni(G.value)&&x&&(O=re?ie(x)>ie(G.value):B?x>G.value:Z>new Date(G.value)),Ni(X.value)&&x&&(V=re?ie(x)<ie(X.value):B?x<X.value:Z<new Date(X.value))}if((O||V)&&(H(!!O,G.message,X.message,Qi.max,Qi.min),!r))return w(T[g].message),T}if((c||l)&&!b&&(Ni(x)||i&&Array.isArray(x))){const O=Po(c),V=Po(l),G=!en(O.value)&&x.length>+O.value,X=!en(V.value)&&x.length<+V.value;if((G||X)&&(H(G,O.message,V.message),!r))return w(T[g].message),T}if(d&&!b&&Ni(x)){const{value:O,message:V}=Po(d);if(i0(O)&&!x.match(O)&&(T[g]={type:Qi.pattern,message:V,ref:s,...j(Qi.pattern,V)},!r))return w(V),T}if(p){if($s(p)){const O=await p(x,t),V=N2(O,y);if(V&&(T[g]={...V,...j(Qi.validate,V.message)},!r))return w(V.message),T}else if(sr(p)){let O={};for(const V in p){if(!kn(O)&&!r)break;const G=N2(await p[V](x,t),y,V);G&&(O={...G,...j(V,G.message)},w(G.message),r&&(T[g]=O))}if(!kn(O)&&(T[g]={ref:y,...O},!r))return T}}return w(!0),T};function qm(e,t){return[...e,...Pn(t)]}var Km=e=>Array.isArray(e)?e.map(()=>{}):void 0;function Xm(e,t,r){return[...e.slice(0,t),...Pn(r),...e.slice(t)]}var Ym=(e,t,r)=>Array.isArray(e)?(xt(e[r])&&(e[r]=void 0),e.splice(r,0,e.splice(t,1)[0]),e):[];function Qm(e,t){return[...Pn(t),...Pn(e)]}function e7(e,t){let r=0;const n=[...e];for(const i of t)n.splice(i-r,1),r++;return Qc(n).length?n:[]}var Jm=(e,t)=>xt(t)?[]:e7(e,Pn(t).sort((r,n)=>r-n)),Zm=(e,t,r)=>{e[t]=[e[r],e[r]=e[t]][0]};function t7(e,t){const r=t.slice(0,-1).length;let n=0;for(;n<r;)e=xt(e)?n++:e[t[n++]];return e}function r7(e){for(const t in e)if(e.hasOwnProperty(t)&&!xt(e[t]))return!1;return!0}function or(e,t){const r=Array.isArray(t)?t:q_(t)?[t]:F4(t),n=r.length===1?e:t7(e,r),i=r.length-1,s=r[i];return n&&delete n[s],i!==0&&(sr(n)&&kn(n)||Array.isArray(n)&&r7(n))&&or(e,r.slice(0,-1)),e}var D2=(e,t,r)=>(e[t]=r,e);function n7(e){const t=Ip(),{control:r=t.control,name:n,keyName:i="id",shouldUnregister:s}=e,[a,o]=ke.useState(r._getFieldArray(n)),c=ke.useRef(r._getFieldArray(n).map(Ss)),l=ke.useRef(a),u=ke.useRef(n),f=ke.useRef(!1);u.current=n,l.current=a,r._names.array.add(n),e.rules&&r.register(n,e.rules),Rp({next:({values:T,name:S})=>{if(S===u.current||!S){const E=ye(T,u.current);Array.isArray(E)&&(o(E),c.current=E.map(Ss))}},subject:r._subjects.array});const d=ke.useCallback(T=>{f.current=!0,r._updateFieldArray(n,T)},[r,n]),p=(T,S)=>{const E=Pn(Mr(T)),k=qm(r._getFieldArray(n),E);r._names.focus=Gm(n,k.length-1,S),c.current=qm(c.current,E.map(Ss)),d(k),o(k),r._updateFieldArray(n,k,qm,{argA:Km(T)})},g=(T,S)=>{const E=Pn(Mr(T)),k=Qm(r._getFieldArray(n),E);r._names.focus=Gm(n,0,S),c.current=Qm(c.current,E.map(Ss)),d(k),o(k),r._updateFieldArray(n,k,Qm,{argA:Km(T)})},m=T=>{const S=Jm(r._getFieldArray(n),T);c.current=Jm(c.current,T),d(S),o(S),r._updateFieldArray(n,S,Jm,{argA:T})},v=(T,S,E)=>{const k=Pn(Mr(S)),b=Xm(r._getFieldArray(n),T,k);r._names.focus=Gm(n,T,E),c.current=Xm(c.current,T,k.map(Ss)),d(b),o(b),r._updateFieldArray(n,b,Xm,{argA:T,argB:Km(S)})},_=(T,S)=>{const E=r._getFieldArray(n);Zm(E,T,S),Zm(c.current,T,S),d(E),o(E),r._updateFieldArray(n,E,Zm,{argA:T,argB:S},!1)},x=(T,S)=>{const E=r._getFieldArray(n);Ym(E,T,S),Ym(c.current,T,S),d(E),o(E),r._updateFieldArray(n,E,Ym,{argA:T,argB:S},!1)},y=(T,S)=>{const E=Mr(S),k=D2(r._getFieldArray(n),T,E);c.current=[...k].map((b,j)=>!b||j===T?Ss():c.current[j]),d(k),o([...k]),r._updateFieldArray(n,k,D2,{argA:T,argB:E},!0,!1)},w=T=>{const S=Pn(Mr(T));c.current=S.map(Ss),d([...S]),o([...S]),r._updateFieldArray(n,[...S],E=>E,{},!0,!1)};return ke.useEffect(()=>{if(r._state.action=!1,nv(n,r._names)&&r._subjects.state.next({...r._formState}),f.current&&(!rv(r._options.mode).isOnSubmit||r._formState.isSubmitted))if(r._options.resolver)r._executeSchema([n]).then(T=>{const S=ye(T.errors,n),E=ye(r._formState.errors,n);(E?!S&&E.type||S&&(E.type!==S.type||E.message!==S.message):S&&S.type)&&(S?pt(r._formState.errors,n,S):or(r._formState.errors,n),r._subjects.state.next({errors:r._formState.errors}))});else{const T=ye(r._fields,n);T&&T._f&&iv(T,r._formValues,r._options.criteriaMode===Yn.all,r._options.shouldUseNativeValidation,!0).then(S=>!kn(S)&&r._subjects.state.next({errors:P4(r._formState.errors,S,n)}))}r._subjects.values.next({name:n,values:{...r._formValues}}),r._names.focus&&r0(r._fields,T=>!!T&&T.startsWith(r._names.focus||"")),r._names.focus="",r._updateValid(),f.current=!1},[a,n,r]),ke.useEffect(()=>(!ye(r._formValues,n)&&r._updateFieldArray(n),()=>{(r._options.shouldUnregister||s)&&r.unregister(n)}),[n,r,i,s]),{swap:ke.useCallback(_,[d,n,r]),move:ke.useCallback(x,[d,n,r]),prepend:ke.useCallback(g,[d,n,r]),append:ke.useCallback(p,[d,n,r]),remove:ke.useCallback(m,[d,n,r]),insert:ke.useCallback(v,[d,n,r]),update:ke.useCallback(y,[d,n,r]),replace:ke.useCallback(w,[d,n,r]),fields:ke.useMemo(()=>a.map((T,S)=>({...T,[i]:c.current[S]||Ss()})),[a,i])}}function eg(){let e=[];return{get observers(){return e},next:i=>{for(const s of e)s.next&&s.next(i)},subscribe:i=>(e.push(i),{unsubscribe:()=>{e=e.filter(s=>s!==i)}}),unsubscribe:()=>{e=[]}}}var s0=e=>en(e)||!S4(e);function Ba(e,t){if(s0(e)||s0(t))return e===t;if(Zo(e)&&Zo(t))return e.getTime()===t.getTime();const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const i of r){const s=e[i];if(!n.includes(i))return!1;if(i!=="ref"){const a=t[i];if(Zo(s)&&Zo(a)||sr(s)&&sr(a)||Array.isArray(s)&&Array.isArray(a)?!Ba(s,a):s!==a)return!1}}return!0}var O4=e=>e.type==="select-multiple",i7=e=>X_(e)||Of(e),tg=e=>n0(e)&&e.isConnected,L4=e=>{for(const t in e)if($s(e[t]))return!0;return!1};function a0(e,t={}){const r=Array.isArray(e);if(sr(e)||r)for(const n in e)Array.isArray(e[n])||sr(e[n])&&!L4(e[n])?(t[n]=Array.isArray(e[n])?[]:{},a0(e[n],t[n])):en(e[n])||(t[n]=!0);return t}function M4(e,t,r){const n=Array.isArray(e);if(sr(e)||n)for(const i in e)Array.isArray(e[i])||sr(e[i])&&!L4(e[i])?xt(t)||s0(r[i])?r[i]=Array.isArray(e[i])?a0(e[i],[]):{...a0(e[i])}:M4(e[i],en(t)?{}:t[i],r[i]):r[i]=!Ba(e[i],t[i]);return r}var rg=(e,t)=>M4(e,t,a0(t)),V4=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:n})=>xt(e)?e:t?e===""?NaN:e&&+e:r&&Ni(e)?new Date(e):n?n(e):e;function ng(e){const t=e.ref;if(!(e.refs?e.refs.every(r=>r.disabled):t.disabled))return K_(t)?t.files:X_(t)?D4(e.refs).value:O4(t)?[...t.selectedOptions].map(({value:r})=>r):Of(t)?N4(e.refs).value:V4(xt(t.value)?e.ref.value:t.value,e)}var s7=(e,t,r,n)=>{const i={};for(const s of e){const a=ye(t,s);a&&pt(i,s,a._f)}return{criteriaMode:r,names:[...e],fields:i,shouldUseNativeValidation:n}},vl=e=>xt(e)?e:i0(e)?e.source:sr(e)?i0(e.value)?e.value.source:e.value:e,a7=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function O2(e,t,r){const n=ye(e,r);if(n||q_(r))return{error:n,name:r};const i=r.split(".");for(;i.length;){const s=i.join("."),a=ye(t,s),o=ye(e,s);if(a&&!Array.isArray(a)&&r!==s)return{name:r};if(o&&o.type)return{name:s,error:o};i.pop()}return{name:r}}var o7=(e,t,r,n,i)=>i.isOnAll?!1:!r&&i.isOnTouch?!(t||e):(r?n.isOnBlur:i.isOnBlur)?!e:(r?n.isOnChange:i.isOnChange)?e:!0,c7=(e,t)=>!Qc(ye(e,t)).length&&or(e,t);const l7={mode:Yn.onSubmit,reValidateMode:Yn.onChange,shouldFocusError:!0};function u7(e={},t){let r={...l7,...e},n={submitCount:0,isDirty:!1,isLoading:$s(r.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{}},i={},s=sr(r.defaultValues)||sr(r.values)?Mr(r.defaultValues||r.values)||{}:{},a=r.shouldUnregister?{}:Mr(s),o={action:!1,mount:!1,watch:!1},c={mount:new Set,unMount:new Set,array:new Set,watch:new Set},l,u=0;const f={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},d={values:eg(),array:eg(),state:eg()},p=e.resetOptions&&e.resetOptions.keepDirtyValues,g=rv(r.mode),m=rv(r.reValidateMode),v=r.criteriaMode===Yn.all,_=P=>q=>{clearTimeout(u),u=setTimeout(P,q)},x=async P=>{if(f.isValid||P){const q=r.resolver?kn((await b()).errors):await H(i,!0);q!==n.isValid&&d.state.next({isValid:q})}},y=P=>f.isValidating&&d.state.next({isValidating:P}),w=(P,q=[],te,ge,ve=!0,ue=!0)=>{if(ge&&te){if(o.action=!0,ue&&Array.isArray(ye(i,P))){const Ie=te(ye(i,P),ge.argA,ge.argB);ve&&pt(i,P,Ie)}if(ue&&Array.isArray(ye(n.errors,P))){const Ie=te(ye(n.errors,P),ge.argA,ge.argB);ve&&pt(n.errors,P,Ie),c7(n.errors,P)}if(f.touchedFields&&ue&&Array.isArray(ye(n.touchedFields,P))){const Ie=te(ye(n.touchedFields,P),ge.argA,ge.argB);ve&&pt(n.touchedFields,P,Ie)}f.dirtyFields&&(n.dirtyFields=rg(s,a)),d.state.next({name:P,isDirty:V(P,q),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else pt(a,P,q)},T=(P,q)=>{pt(n.errors,P,q),d.state.next({errors:n.errors})},S=(P,q,te,ge)=>{const ve=ye(i,P);if(ve){const ue=ye(a,P,xt(te)?ye(s,P):te);xt(ue)||ge&&ge.defaultChecked||q?pt(a,P,q?ue:ng(ve._f)):Z(P,ue),o.mount&&x()}},E=(P,q,te,ge,ve)=>{let ue=!1,Ie=!1;const Ke={name:P};if(!te||ge){f.isDirty&&(Ie=n.isDirty,n.isDirty=Ke.isDirty=V(),ue=Ie!==Ke.isDirty);const at=Ba(ye(s,P),q);Ie=ye(n.dirtyFields,P),at?or(n.dirtyFields,P):pt(n.dirtyFields,P,!0),Ke.dirtyFields=n.dirtyFields,ue=ue||f.dirtyFields&&Ie!==!at}if(te){const at=ye(n.touchedFields,P);at||(pt(n.touchedFields,P,te),Ke.touchedFields=n.touchedFields,ue=ue||f.touchedFields&&at!==te)}return ue&&ve&&d.state.next(Ke),ue?Ke:{}},k=(P,q,te,ge)=>{const ve=ye(n.errors,P),ue=f.isValid&&Us(q)&&n.isValid!==q;if(e.delayError&&te?(l=_(()=>T(P,te)),l(e.delayError)):(clearTimeout(u),l=null,te?pt(n.errors,P,te):or(n.errors,P)),(te?!Ba(ve,te):ve)||!kn(ge)||ue){const Ie={...ge,...ue&&Us(q)?{isValid:q}:{},errors:n.errors,name:P};n={...n,...Ie},d.state.next(Ie)}y(!1)},b=async P=>r.resolver(a,r.context,s7(P||c.mount,i,r.criteriaMode,r.shouldUseNativeValidation)),j=async P=>{const{errors:q}=await b(P);if(P)for(const te of P){const ge=ye(q,te);ge?pt(n.errors,te,ge):or(n.errors,te)}else n.errors=q;return q},H=async(P,q,te={valid:!0})=>{for(const ge in P){const ve=P[ge];if(ve){const{_f:ue,...Ie}=ve;if(ue){const Ke=c.array.has(ue.name),at=await iv(ve,a,v,r.shouldUseNativeValidation&&!q,Ke);if(at[ue.name]&&(te.valid=!1,q))break;!q&&(ye(at,ue.name)?Ke?P4(n.errors,at,ue.name):pt(n.errors,ue.name,at[ue.name]):or(n.errors,ue.name))}Ie&&await H(Ie,q,te)}}return te.valid},O=()=>{for(const P of c.unMount){const q=ye(i,P);q&&(q._f.refs?q._f.refs.every(te=>!tg(te)):!tg(q._f.ref))&&ee(P)}c.unMount=new Set},V=(P,q)=>(P&&q&&pt(a,P,q),!Ba(xe(),s)),G=(P,q,te)=>b4(P,c,{...o.mount?a:xt(q)?s:Ni(P)?{[P]:q}:q},te,q),X=P=>Qc(ye(o.mount?a:s,P,e.shouldUnregister?ye(s,P,[]):[])),Z=(P,q,te={})=>{const ge=ye(i,P);let ve=q;if(ge){const ue=ge._f;ue&&(!ue.disabled&&pt(a,P,V4(q,ue)),ve=n0(ue.ref)&&en(q)?"":q,O4(ue.ref)?[...ue.ref.options].forEach(Ie=>Ie.selected=ve.includes(Ie.value)):ue.refs?Of(ue.ref)?ue.refs.length>1?ue.refs.forEach(Ie=>(!Ie.defaultChecked||!Ie.disabled)&&(Ie.checked=Array.isArray(ve)?!!ve.find(Ke=>Ke===Ie.value):ve===Ie.value)):ue.refs[0]&&(ue.refs[0].checked=!!ve):ue.refs.forEach(Ie=>Ie.checked=Ie.value===ve):K_(ue.ref)?ue.ref.value="":(ue.ref.value=ve,ue.ref.type||d.values.next({name:P,values:{...a}})))}(te.shouldDirty||te.shouldTouch)&&E(P,ve,te.shouldTouch,te.shouldDirty,!0),te.shouldValidate&&ae(P)},ie=(P,q,te)=>{for(const ge in q){const ve=q[ge],ue=`${P}.${ge}`,Ie=ye(i,ue);(c.array.has(P)||!s0(ve)||Ie&&!Ie._f)&&!Zo(ve)?ie(ue,ve,te):Z(ue,ve,te)}},re=(P,q,te={})=>{const ge=ye(i,P),ve=c.array.has(P),ue=Mr(q);pt(a,P,ue),ve?(d.array.next({name:P,values:{...a}}),(f.isDirty||f.dirtyFields)&&te.shouldDirty&&d.state.next({name:P,dirtyFields:rg(s,a),isDirty:V(P,ue)})):ge&&!ge._f&&!en(ue)?ie(P,ue,te):Z(P,ue,te),nv(P,c)&&d.state.next({...n}),d.values.next({name:P,values:{...a}}),!o.mount&&t()},B=async P=>{const q=P.target;let te=q.name,ge=!0;const ve=ye(i,te),ue=()=>q.type?ng(ve._f):A4(P);if(ve){let Ie,Ke;const at=ue(),Qr=P.type===t0.BLUR||P.type===t0.FOCUS_OUT,Aa=!a7(ve._f)&&!r.resolver&&!ye(n.errors,te)&&!ve._f.deps||o7(Qr,ye(n.touchedFields,te),n.isSubmitted,m,g),Jt=nv(te,c,Qr);pt(a,te,at),Qr?(ve._f.onBlur&&ve._f.onBlur(P),l&&l(0)):ve._f.onChange&&ve._f.onChange(P);const hn=E(te,at,Qr,!1),Ge=!kn(hn)||Jt;if(!Qr&&d.values.next({name:te,type:P.type,values:{...a}}),Aa)return f.isValid&&x(),Ge&&d.state.next({name:te,...Jt?{}:hn});if(!Qr&&Jt&&d.state.next({...n}),y(!0),r.resolver){const{errors:Tt}=await b([te]),dn=O2(n.errors,i,te),Pt=O2(Tt,i,dn.name||te);Ie=Pt.error,te=Pt.name,Ke=kn(Tt)}else Ie=(await iv(ve,a,v,r.shouldUseNativeValidation))[te],ge=Number.isNaN(at)||at===ye(a,te,at),ge&&(Ie?Ke=!1:f.isValid&&(Ke=await H(i,!0)));ge&&(ve._f.deps&&ae(ve._f.deps),k(te,Ke,Ie,hn))}},ae=async(P,q={})=>{let te,ge;const ve=Pn(P);if(y(!0),r.resolver){const ue=await j(xt(P)?P:ve);te=kn(ue),ge=P?!ve.some(Ie=>ye(ue,Ie)):te}else P?(ge=(await Promise.all(ve.map(async ue=>{const Ie=ye(i,ue);return await H(Ie&&Ie._f?{[ue]:Ie}:Ie)}))).every(Boolean),!(!ge&&!n.isValid)&&x()):ge=te=await H(i);return d.state.next({...!Ni(P)||f.isValid&&te!==n.isValid?{}:{name:P},...r.resolver||!P?{isValid:te}:{},errors:n.errors,isValidating:!1}),q.shouldFocus&&!ge&&r0(i,ue=>ue&&ye(n.errors,ue),P?ve:c.mount),ge},xe=P=>{const q={...s,...o.mount?a:{}};return xt(P)?q:Ni(P)?ye(q,P):P.map(te=>ye(q,te))},I=(P,q)=>({invalid:!!ye((q||n).errors,P),isDirty:!!ye((q||n).dirtyFields,P),isTouched:!!ye((q||n).touchedFields,P),error:ye((q||n).errors,P)}),W=P=>{P&&Pn(P).forEach(q=>or(n.errors,q)),d.state.next({errors:P?n.errors:{}})},z=(P,q,te)=>{const ge=(ye(i,P,{_f:{}})._f||{}).ref;pt(n.errors,P,{...q,ref:ge}),d.state.next({name:P,errors:n.errors,isValid:!1}),te&&te.shouldFocus&&ge&&ge.focus&&ge.focus()},U=(P,q)=>$s(P)?d.values.subscribe({next:te=>P(G(void 0,q),te)}):G(P,q,!0),ee=(P,q={})=>{for(const te of P?Pn(P):c.mount)c.mount.delete(te),c.array.delete(te),q.keepValue||(or(i,te),or(a,te)),!q.keepError&&or(n.errors,te),!q.keepDirty&&or(n.dirtyFields,te),!q.keepTouched&&or(n.touchedFields,te),!r.shouldUnregister&&!q.keepDefaultValue&&or(s,te);d.values.next({values:{...a}}),d.state.next({...n,...q.keepDirty?{isDirty:V()}:{}}),!q.keepIsValid&&x()},oe=({disabled:P,name:q,field:te,fields:ge})=>{if(Us(P)){const ve=P?void 0:ye(a,q,ng(te?te._f:ye(ge,q)._f));pt(a,q,ve),E(q,ve,!1,!1,!0)}},me=(P,q={})=>{let te=ye(i,P);const ge=Us(q.disabled);return pt(i,P,{...te||{},_f:{...te&&te._f?te._f:{ref:{name:P}},name:P,mount:!0,...q}}),c.mount.add(P),te?oe({field:te,disabled:q.disabled,name:P}):S(P,!0,q.value),{...ge?{disabled:q.disabled}:{},...r.progressive?{required:!!q.required,min:vl(q.min),max:vl(q.max),minLength:vl(q.minLength),maxLength:vl(q.maxLength),pattern:vl(q.pattern)}:{},name:P,onChange:B,onBlur:B,ref:ve=>{if(ve){me(P,q),te=ye(i,P);const ue=xt(ve.value)&&ve.querySelectorAll&&ve.querySelectorAll("input,select,textarea")[0]||ve,Ie=i7(ue),Ke=te._f.refs||[];if(Ie?Ke.find(at=>at===ue):ue===te._f.ref)return;pt(i,P,{_f:{...te._f,...Ie?{refs:[...Ke.filter(tg),ue,...Array.isArray(ye(s,P))?[{}]:[]],ref:{type:ue.type,name:P}}:{ref:ue}}}),S(P,!1,void 0,ue)}else te=ye(i,P,{}),te._f&&(te._f.mount=!1),(r.shouldUnregister||q.shouldUnregister)&&!(k4(c.array,P)&&o.action)&&c.unMount.add(P)}}},de=()=>r.shouldFocusError&&r0(i,P=>P&&ye(n.errors,P),c.mount),ce=(P,q)=>async te=>{te&&(te.preventDefault&&te.preventDefault(),te.persist&&te.persist());let ge=Mr(a);if(d.state.next({isSubmitting:!0}),r.resolver){const{errors:ve,values:ue}=await b();n.errors=ve,ge=ue}else await H(i);or(n.errors,"root"),kn(n.errors)?(d.state.next({errors:{}}),await P(ge,te)):(q&&await q({...n.errors},te),de(),setTimeout(de)),d.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:kn(n.errors),submitCount:n.submitCount+1,errors:n.errors})},ze=(P,q={})=>{ye(i,P)&&(xt(q.defaultValue)?re(P,ye(s,P)):(re(P,q.defaultValue),pt(s,P,q.defaultValue)),q.keepTouched||or(n.touchedFields,P),q.keepDirty||(or(n.dirtyFields,P),n.isDirty=q.defaultValue?V(P,ye(s,P)):V()),q.keepError||(or(n.errors,P),f.isValid&&x()),d.state.next({...n}))},M=(P,q={})=>{const te=P?Mr(P):s,ge=Mr(te),ve=P&&!kn(P)?ge:s;if(q.keepDefaultValues||(s=te),!q.keepValues){if(q.keepDirtyValues||p)for(const ue of c.mount)ye(n.dirtyFields,ue)?pt(ve,ue,ye(a,ue)):re(ue,ye(ve,ue));else{if(G_&&xt(P))for(const ue of c.mount){const Ie=ye(i,ue);if(Ie&&Ie._f){const Ke=Array.isArray(Ie._f.refs)?Ie._f.refs[0]:Ie._f.ref;if(n0(Ke)){const at=Ke.closest("form");if(at){at.reset();break}}}}i={}}a=e.shouldUnregister?q.keepDefaultValues?Mr(s):{}:Mr(ve),d.array.next({values:{...ve}}),d.values.next({values:{...ve}})}c={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!o.mount&&t(),o.mount=!f.isValid||!!q.keepIsValid,o.watch=!!e.shouldUnregister,d.state.next({submitCount:q.keepSubmitCount?n.submitCount:0,isDirty:q.keepDirty?n.isDirty:!!(q.keepDefaultValues&&!Ba(P,s)),isSubmitted:q.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:q.keepDirtyValues?n.dirtyFields:q.keepDefaultValues&&P?rg(s,P):{},touchedFields:q.keepTouched?n.touchedFields:{},errors:q.keepErrors?n.errors:{},isSubmitSuccessful:q.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1})},dt=(P,q)=>M($s(P)?P(a):P,q);return{control:{register:me,unregister:ee,getFieldState:I,handleSubmit:ce,setError:z,_executeSchema:b,_getWatch:G,_getDirty:V,_updateValid:x,_removeUnmounted:O,_updateFieldArray:w,_updateDisabledField:oe,_getFieldArray:X,_reset:M,_resetDefaultValues:()=>$s(r.defaultValues)&&r.defaultValues().then(P=>{dt(P,r.resetOptions),d.state.next({isLoading:!1})}),_updateFormState:P=>{n={...n,...P}},_subjects:d,_proxyFormState:f,get _fields(){return i},get _formValues(){return a},get _state(){return o},set _state(P){o=P},get _defaultValues(){return s},get _names(){return c},set _names(P){c=P},get _formState(){return n},set _formState(P){n=P},get _options(){return r},set _options(P){r={...r,...P}}},trigger:ae,register:me,handleSubmit:ce,watch:U,setValue:re,getValues:xe,reset:dt,resetField:ze,clearErrors:W,unregister:ee,setError:z,setFocus:(P,q={})=>{const te=ye(i,P),ge=te&&te._f;if(ge){const ve=ge.refs?ge.refs[0]:ge.ref;ve.focus&&(ve.focus(),q.shouldSelect&&ve.select())}},getFieldState:I}}function Ta(e={}){const t=ke.useRef(),r=ke.useRef(),[n,i]=ke.useState({isDirty:!1,isValidating:!1,isLoading:$s(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},defaultValues:$s(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...u7(e,()=>i(a=>({...a}))),formState:n});const s=t.current.control;return s._options=e,Rp({subject:s._subjects.state,next:a=>{I4(a,s._proxyFormState,s._updateFormState,!0)&&i({...s._formState})}}),ke.useEffect(()=>{e.values&&!Ba(e.values,r.current)?(s._reset(e.values,s._options.resetOptions),r.current=e.values):s._resetDefaultValues()},[e.values,s]),ke.useEffect(()=>{s._state.mount||(s._updateValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),t.current.formState=C4(n,s),t.current}const f7=e=>{console.log(e.code);const t=e.code;return t==="auth/invalid-login-credentials"?"Verifique que su usuario y/o contraseña sean correctos.":t==="auth/too-many-requests"?"Se han realizado demasiados intentos fállidos.":"Ha ocurrido un error en el inicio de sesión."};function h7(){const[e,t]=F.useState(null),{register:r,handleSubmit:n,formState:{errors:i}}=Ta(),s=ar(),a=async o=>{try{await bB(o.email,o.password),s("/home")}catch(c){const l=f7(c);t(l)}};return h.jsx("section",{id:"login",className:"d-flex align-items-center justify-content-center bg-white",style:{height:"100vh"},children:h.jsxs("div",{className:"container p-5 text-center bg-light shadow-sm rounded border",style:{maxWidth:"500px"},children:[h.jsx("h2",{children:"PORTAL IMPACTO"}),h.jsxs("form",{onSubmit:n(a),className:"needs-validation",noValidate:!0,children:[h.jsxs("div",{className:"mb-3",children:[h.jsx("label",{htmlFor:"email",className:"form-label",children:"Correo electrónico"}),h.jsx("input",{type:"email",className:`form-control ${i.email?"is-invalid":""}`,id:"email",placeholder:"ejemplo@mail.com",...r("email",{required:"Ingrese su correo electrónico"})}),i.email&&h.jsx("div",{className:"invalid-feedback",children:i.email.message})]}),h.jsxs("div",{className:"mb-3",children:[h.jsx("label",{htmlFor:"password",className:"form-label",children:"Contraseña"}),h.jsx("input",{type:"password",className:`form-control ${i.password?"is-invalid":""}`,id:"password",placeholder:"******",...r("password",{required:"Ingrese su contraseña"})}),i.password&&h.jsx("div",{className:"invalid-feedback",children:i.password.message})]}),h.jsx("div",{className:"form-group",children:h.jsx("button",{type:"submit",className:"btn btn-dark btn-block w-100",children:"INGRESAR"})})]}),e&&h.jsx("div",{className:"alert alert-danger mt-3",role:"alert",children:e})]})})}function qi(){const e=ar(),t=async()=>{try{e("/home")}catch(i){console.log(i)}},r=async()=>{try{e("/admin")}catch(i){console.log(i)}},n=async()=>{try{await FB(),e("/login")}catch(i){console.log(i)}};return h.jsx("nav",{className:"navbar navbar-expand-md navbar-dark",style:{backgroundColor:"#4b4a4a"},children:h.jsxs("div",{className:"container-fluid",children:[h.jsx("a",{className:"navbar-brand",children:"PORTAL IMPACTO"}),h.jsx("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation",children:h.jsx("span",{className:"navbar-toggler-icon"})}),h.jsx("div",{className:"collapse navbar-collapse justify-content-end",id:"navbarNav",children:h.jsxs("ul",{className:"navbar-nav",children:[h.jsx("li",{className:"nav-item",children:h.jsx("button",{type:"button",className:"btn text-white",onClick:t,children:"INICIO"})}),h.jsx("li",{className:"nav-item",children:h.jsx("button",{type:"button",className:"btn text-white",onClick:r,children:"ADMINISTRACIÓN"})}),h.jsx("li",{className:"nav-item",children:h.jsxs("button",{type:"button",className:"btn text-white",onClick:n,children:["CERRAR SESIÓN",h.jsx("i",{className:"bi bi-box-arrow-right ms-2"})]})})]})})]})})}var j4={exports:{}},d7="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",p7=d7,m7=p7;function B4(){}function U4(){}U4.resetWarningCache=B4;var g7=function(){function e(n,i,s,a,o,c){if(c!==m7){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:U4,resetWarningCache:B4};return r.PropTypes=r,r};j4.exports=g7();var v7=j4.exports;const rt=mS(v7);function Mn({onClick:e,text:t,icon:r,marginClassName:n,btnClassName:i}){return h.jsxs("button",{type:"button",className:`btn ${i} ${n}`,onClick:e,children:[t," ",r&&h.jsx("i",{className:`bi ${r}`,style:{marginLeft:"4px"}})]})}Mn.propTypes={text:rt.string.isRequired,icon:rt.string,marginClassName:rt.string,btnClassName:rt.string,onClick:rt.func.isRequired};function $4({handleFilterChange:e}){return h.jsx(h.Fragment,{children:h.jsxs("form",{className:"row gx-3 gy-1 align-items-center",children:[h.jsxs("div",{className:"col-sm-1",children:[h.jsx("label",{className:"visually-hidden",htmlFor:"week-input",children:"Semana"}),h.jsx("input",{type:"text",className:"form-control",id:"week-input",placeholder:"Semana",onChange:t=>e("week_name",t.target.value)})]}),h.jsxs("div",{className:"col-sm-2",children:[h.jsx("label",{className:"visually-hidden",htmlFor:"vulnerability-input",children:"Vulnerabilidad"}),h.jsx("input",{type:"text",className:"form-control",id:"vulnerability-input",placeholder:"Vulnerabilidad",onChange:t=>e("vulnerabilidad_1",t.target.value)})]}),h.jsxs("div",{className:"col-sm-2",children:[h.jsx("label",{className:"visually-hidden",htmlFor:"technical-unit-input",children:"Unidad Técnica"}),h.jsx("input",{type:"text",className:"form-control",id:"technical-unit-input",placeholder:"Unidad Técnica",onChange:t=>e("u_tecnica",t.target.value)})]}),h.jsxs("div",{className:"col-sm-2",children:[h.jsx("label",{className:"visually-hidden",htmlFor:"equipment-system-input",children:"Equipo Sistema"}),h.jsx("input",{type:"text",className:"form-control",id:"equipment-system-input",placeholder:"Equipo Sistema",onChange:t=>e("equipo_o_sistema",t.target.value)})]}),h.jsxs("div",{className:"col-sm-2",children:[h.jsx("label",{className:"visually-hidden",htmlFor:"description",children:"Descripción"}),h.jsx("input",{type:"text",className:"form-control",id:"description",placeholder:"Descripción",onChange:t=>e("description",t.target.value)})]}),h.jsxs("div",{className:"col-sm-2",children:[h.jsx("label",{className:"visually-hidden",htmlFor:"current-status",children:"Estado"}),h.jsx("input",{type:"text",className:"form-control",id:"current-status",placeholder:"Estado",onChange:t=>e("current_status",t.target.value)})]})]})})}$4.propTypes={handleFilterChange:rt.func.isRequired};function ec(e=""){return e.replace(/[^\p{L}\d\s]/gu,"").normalize("NFD").replace(/\p{Diacritic}/gu,"")}function Y_({currentPage:e,totalPages:t,handlePageChange:r}){return h.jsx("div",{className:"d-flex justify-content-center",children:h.jsx("ul",{className:"pagination",children:Array(t).fill(0).map((n,i)=>h.jsx("li",{className:`page-item ${i+1===e?"active":""}`,children:h.jsx("button",{className:"page-link",onClick:()=>r(i+1),children:i+1})},i))})})}Y_.propTypes={currentPage:rt.number.isRequired,totalPages:rt.number.isRequired,handlePageChange:rt.func.isRequired};function Un(){return h.jsx("div",{className:"d-flex justify-content-center",children:h.jsx("div",{className:"spinner-border text-secondary",role:"status",children:h.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}function H4({filters:e}){const[t,r]=F.useState([]),[n,i]=F.useState(1),[s,a]=F.useState(!0),o=20,c=d=>{d>0&&d<=u&&i(d)};F.useEffect(()=>{Object.values(e).some(d=>d!=="")&&i(1)},[e]),F.useEffect(()=>{(async()=>{try{const p=(n-1)*o,m=(await LB({limit:o,offset:p})).map(v=>({id:v.id,...v.data}));r(m),a(!1)}catch(p){console.error("Error al obtener documentos: ",p)}})()},[n,o,e]);const l=t.filter(d=>Object.keys(e).every(p=>{const g=ec(e[p]).toLowerCase(),m=ec(d[p]).toLowerCase();if(p==="week_name"&&g){if(m.slice(-2)!==g)return!1}else if(p==="description"&&g){if(!((ec(d.descripcion_del_trabajo)||"N/A")+(ec(d.descripcion_del_aviso)||"N/A")).toLowerCase().includes(g))return!1}else if(g&&m&&!m.includes(g))return!1;return!0})),u=Math.ceil(l.length/o),f=l.slice((n-1)*o,n*o);return h.jsxs(h.Fragment,{children:[s?h.jsx(Un,{}):h.jsx("div",{className:"table-responsive-xxl",children:h.jsxs("table",{className:"table table-hover",children:[h.jsx("thead",{className:"table-secondary",children:h.jsxs("tr",{className:"align-middle",children:[h.jsx("th",{scope:"col",children:"N°"}),h.jsx("th",{scope:"col",children:"Sem"}),h.jsx("th",{scope:"col",children:"Vulnerabilidad"}),h.jsx("th",{scope:"col",children:"Unidad Técnica"}),h.jsx("th",{scope:"col",children:"Equipo Sistema"}),h.jsx("th",{scope:"col",children:"Descripción del trabajo"}),h.jsx("th",{scope:"col",children:"Descripción del aviso"}),h.jsx("th",{scope:"col",children:"Estado Impacto"}),h.jsx("th",{scope:"col",children:"Estado Final"}),h.jsx("th",{scope:"col",colSpan:"5",className:"text-center",children:"Acciones"})]})}),h.jsx("tbody",{children:f.map((d,p)=>{const g=(n-1)*o+p+1;return h.jsxs("tr",{children:[h.jsx("td",{children:g}),h.jsx("td",{children:d.week_name.slice(-2)||"N/A"}),h.jsx("td",{children:d.vulnerabilidad_1||"N/A"}),h.jsx("td",{children:d.u_tecnica||"N/A"}),h.jsx("td",{children:d.equipo_o_sistema||"N/A"}),h.jsx("td",{children:d.descripcion_del_trabajo||"N/A"}),h.jsx("td",{children:d.descripcion_del_aviso||"N/A"}),h.jsx("td",{children:d.current_status}),h.jsx("td",{children:"documento"}),h.jsx("td",{children:h.jsx(Pa,{to:`/update-activity-status/${d.id}`,children:"E.I"})}),h.jsx("td",{children:h.jsx(Pa,{to:`/upload-activity-log/${d.id}`,children:"I.R."})}),h.jsx("td",{children:h.jsx(Pa,{to:`/activity-planning/${d.id}`,children:"P.A."})}),h.jsx("td",{children:h.jsx(Pa,{to:`/view-activity-info/${d.id}`,children:"V.A."})}),h.jsx("td",{children:h.jsx(Pa,{to:`/view-activity-dossier/${d.id}`,children:"V.D."})})]},p)})})]})}),h.jsx(Y_,{currentPage:n,totalPages:u,handlePageChange:c})]})}H4.propTypes={filters:rt.object};function x7(){const e=ar(),[t,r]=F.useState(""),n=l=>{const u=new Date(l.getFullYear(),0,1),f=864e5;return Math.ceil(((l-u)/f+u.getDay()+1)/7)||1};F.useEffect(()=>{const u=n(new Date);r(`semana ${u}`)},[]);const[i,s]=F.useState({week:"",vulnerability:"",technicalUnit:"",equipmentSystem:"",description:"",status:""}),a=(l,u)=>{s({...i,[l]:u})},o=()=>{e("/upload-activities")},c=()=>{e("/create-activity")};return h.jsx(h.Fragment,{children:h.jsxs("section",{id:"week",children:[h.jsx("h1",{className:"my-2 text-center mt-3",children:"PRIORIZACIÓN DE ACTIVIDADES"}),h.jsx("div",{className:"container-sm bg-info p-3 text-white text-center mb-3",children:h.jsxs("p",{className:"m-0",children:["Actualmente estamos en la ",t]})}),h.jsx("div",{className:"row",children:h.jsxs("div",{className:"col d-flex mb-3 justify-content-start gap-3",children:[h.jsx(Mn,{text:"CARGAR PRIORIZACIÓN",icon:"bi bi-upload",btnClassName:"btn-dark",onClick:o}),h.jsx(Mn,{text:"CREAR ACTIVIDAD",icon:"bi bi-plus-circle",btnClassName:"btn-dark",onClick:c})]})}),h.jsx("div",{className:"row mb-3",children:h.jsx("div",{className:"col",children:h.jsx($4,{filters:i,handleFilterChange:a})})}),h.jsx(H4,{filters:i})]})})}function _7(){return h.jsxs(h.Fragment,{children:[h.jsx(qi,{}),h.jsx("div",{className:"container",children:h.jsx(x7,{})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var z4=1252,y7=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Q_={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},J_=function(e){y7.indexOf(e)!=-1&&(z4=Q_[0]=e)};function E7(){J_(1252)}var ui=function(e){J_(e)};function W4(){ui(1200),E7()}function L2(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function w7(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function G4(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Fl=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?w7(e.slice(2)):t==254&&r==255?G4(e.slice(2)):t==65279?e.slice(1):e},xh=function(t){return String.fromCharCode(t)},M2=function(t){return String.fromCharCode(t)},Os,Hs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function V2(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0,c=0,l=0;l<e.length;)r=e.charCodeAt(l++),s=r>>2,n=e.charCodeAt(l++),a=(r&3)<<4|n>>4,i=e.charCodeAt(l++),o=(n&15)<<2|i>>6,c=i&63,isNaN(n)?o=c=64:isNaN(i)&&(c=64),t+=Hs.charAt(s)+Hs.charAt(a)+Hs.charAt(o)+Hs.charAt(c);return t}function Vn(e){var t="",r=0,n=0,i=0,s=0,a=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)s=Hs.indexOf(e.charAt(l++)),a=Hs.indexOf(e.charAt(l++)),r=s<<2|a>>4,t+=String.fromCharCode(r),o=Hs.indexOf(e.charAt(l++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=Hs.indexOf(e.charAt(l++)),i=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(i));return t}var Je=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),So=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ha(e){return Je?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function j2(e){return Je?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var li=function(t){return Je?So(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ao(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Z_(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Z_(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Ls=Je?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:So(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function T7(e){for(var t=[],r=0,n=e.length+250,i=ha(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(t.push(i.slice(0,r)),r=0,i=ha(65535),n=65530)}return t.push(i.slice(0,r)),Ls(t)}var on=/\u0000/g,Pl=/[\u0001-\u0006]/g;function pc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function fi(e,t){var r=""+e;return r.length>=t?r:Dt("0",t-r.length)+r}function ey(e,t){var r=""+e;return r.length>=t?r:Dt(" ",t-r.length)+r}function o0(e,t){var r=""+e;return r.length>=t?r:r+Dt(" ",t-r.length)}function S7(e,t){var r=""+Math.round(e);return r.length>=t?r:Dt("0",t-r.length)+r}function A7(e,t){var r=""+e;return r.length>=t?r:Dt("0",t-r.length)+r}var B2=Math.pow(2,32);function No(e,t){if(e>B2||e<-B2)return S7(e,t);var r=Math.round(e);return A7(r,t)}function c0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var U2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ig=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function k7(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var $e={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},$2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},C7={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function l0(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,a=1,o=0,c=1,l=0,u=0,f=Math.floor(i);l<t&&(f=Math.floor(i),o=f*a+s,u=f*l+c,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,c=l,l=u;if(u>t&&(l>t?(u=c,o=s):(u=l,o=a)),!r)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function Ua(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,a=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=N7(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var q4=new Date(1899,11,31,0,0,0),I7=q4.getTime(),R7=new Date(1900,2,1,0,0,0);function K4(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=R7&&(r+=24*60*60*1e3),(r-(I7+(e.getTimezoneOffset()-q4.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ty(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function b7(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function F7(e){var t=e<0?12:11,r=ty(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function P7(e){var t=ty(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function qu(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=F7(e):t===10?r=e.toFixed(10).substr(0,12):r=P7(e),ty(b7(r.toUpperCase()))}function co(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):qu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ti(14,K4(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function N7(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function D7(e,t,r,n){var i="",s=0,a=0,o=r.y,c,l=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,l=t.length;break;case 3:return ig[r.m-1][1];case 5:return ig[r.m-1][0];default:return ig[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,l=t.length;break;case 3:return U2[r.q][0];default:return U2[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?fi(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=fi(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}l=t.length===3?1:2;break;case 101:c=o,l=1;break}var u=l>0?fi(c,l):"";return u}function zs(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var X4=/%/g;function O7(e,t,r){var n=t.replace(X4,""),i=t.length-n.length;return cs(e,n,r*Math.pow(10,2*i))+Dt("%",i)}function L7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return cs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Y4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Y4(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,u){return c+l+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Q4=/# (\?+)( ?)\/( ?)(\d+)/;function M7(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Dt(" ",e[1].length+1+e[4].length):ey(a,e[1].length)+e[2]+"/"+e[3]+fi(o,e[4].length))}function V7(e,t,r){return r+(t===0?"":""+t)+Dt(" ",e[1].length+2+e[4].length)}var J4=/^#*0*\.([0#]+)/,Z4=/\).*[0#]/,eb=/\(###\) ###\\?-####/;function tn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function H2(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function z2(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function j7(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function B7(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function zn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Z4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?zn("n",n,r):"("+zn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return L7(e,t,r);if(t.indexOf("%")!==-1)return O7(e,t,r);if(t.indexOf("E")!==-1)return Y4(t,r);if(t.charCodeAt(0)===36)return"$"+zn(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+No(c,t.length);if(t.match(/^[#?]+$/))return i=No(r,0),i==="0"&&(i=""),i.length>t.length?i:tn(t.substr(0,t.length-i.length))+i;if(s=t.match(Q4))return M7(s,c,l);if(t.match(/^#+0+$/))return l+No(c,t.length-t.indexOf("0"));if(s=t.match(J4))return i=H2(r,s[1].length).replace(/^([^\.]+)$/,"$1."+tn(s[1])).replace(/\.$/,"."+tn(s[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+Dt("0",tn(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+H2(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+zs(No(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+zn(e,t,-r):zs(""+(Math.floor(r)+j7(r,s[1].length)))+"."+fi(z2(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return zn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=pc(zn(e,t.replace(/[\\-]/g,""),r)),a=0,pc(pc(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(t.match(eb))return i=zn(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=l0(c,Math.pow(10,a)-1,!1),i=""+l,u=cs("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=o0(o[2],a),u.length<s[4].length&&(u=tn(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=l0(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ey(o[1],a)+s[2]+"/"+s[3]+o0(o[2],a):Dt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=No(r,0),t.length<=i.length?i:tn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=t.indexOf(".")-a,d=t.length-i.length-f;return tn(t.substr(0,f)+i+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=z2(r,s[1].length),r<0?"-"+zn(e,t,-r):zs(B7(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?fi(0,3-g.length):"")+g})+"."+fi(a,s[1].length);switch(t){case"###,##0.00":return zn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=zs(No(c,0));return p!=="0"?l+p:"";case"###,###.00":return zn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return zn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function U7(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return cs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function $7(e,t,r){var n=t.replace(X4,""),i=t.length-n.length;return cs(e,n,r*Math.pow(10,2*i))+Dt("%",i)}function tb(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+tb(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,u){return c+l+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Si(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Z4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Si("n",n,r):"("+Si("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return U7(e,t,r);if(t.indexOf("%")!==-1)return $7(e,t,r);if(t.indexOf("E")!==-1)return tb(t,r);if(t.charCodeAt(0)===36)return"$"+Si(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+fi(c,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:tn(t.substr(0,t.length-i.length))+i;if(s=t.match(Q4))return V7(s,c,l);if(t.match(/^#+0+$/))return l+fi(c,t.length-t.indexOf("0"));if(s=t.match(J4))return i=(""+r).replace(/^([^\.]+)$/,"$1."+tn(s[1])).replace(/\.$/,"."+tn(s[1])),i=i.replace(/\.(\d*)$/,function(g,m){return"."+m+Dt("0",tn(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+zs(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Si(e,t,-r):zs(""+r)+"."+Dt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Si(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=pc(Si(e,t.replace(/[\\-]/g,""),r)),a=0,pc(pc(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(t.match(eb))return i=Si(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=l0(c,Math.pow(10,a)-1,!1),i=""+l,u=cs("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=o0(o[2],a),u.length<s[4].length&&(u=tn(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=l0(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ey(o[1],a)+s[2]+"/"+s[3]+o0(o[2],a):Dt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:tn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=t.indexOf(".")-a,d=t.length-i.length-f;return tn(t.substr(0,f)+i+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Si(e,t,-r):zs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?fi(0,3-g.length):"")+g})+"."+fi(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=zs(""+c);return p!=="0"?l+p:"";default:if(t.match(/\.[0#?]*$/))return Si(e,t.slice(0,t.lastIndexOf(".")),r)+tn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function cs(e,t,r){return(r|0)===r?Si(e,t,r):zn(e,t,r)}function H7(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var rb=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Jc(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":c0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(rb))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function z7(e,t,r,n){for(var i=[],s="",a=0,o="",c="t",l,u,f,d="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!c0(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var p=e.charAt(++a),g=p==="("||p===")"?p:"t";i[i.length]={t:g,v:p},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(l==null&&(l=Ua(t,r,e.charAt(a+1)==="2"),l==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||l==null&&(l=Ua(t,r),l==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},c=o;break;case"A":case"a":case"上":var m={t:o,v:o};if(l==null&&(l=Ua(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(l!=null&&(m.v=l.H>=12?"P":"A"),m.t="T",d="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(l!=null&&(m.v=l.H>=12?"PM":"AM"),m.t="T",a+=5,d="h"):e.substr(a,5).toUpperCase()==="上午/下午"?(l!=null&&(m.v=l.H>=12?"下午":"上午"),m.t="T",a+=5,d="h"):(m.t="t",++a),l==null&&m.t==="T")return"";i[i.length]=m,c=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(rb)){if(l==null&&(l=Ua(t,r),l==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Jc(e)||(i[i.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},c=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var v=0,_=0,x;for(a=i.length-1,c="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=d,c="h",v<1&&(v=1);break;case"s":(x=i[a].v.match(/\.0+$/))&&(_=Math.max(_,x[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":c=i[a].t;break;case"m":c==="s"&&(i[a].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&i[a].v.match(/[Hh]/)&&(v=1),v<2&&i[a].v.match(/[Mm]/)&&(v=2),v<3&&i[a].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var y="",w;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=D7(i[a].t.charCodeAt(0),i[a].v,l,_),i[a].t="t";break;case"n":case"?":for(w=a+1;i[w]!=null&&((o=i[w].t)==="?"||o==="D"||(o===" "||o==="t")&&i[w+1]!=null&&(i[w+1].t==="?"||i[w+1].t==="t"&&i[w+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[w].v==="/"||i[w].v===" "&&i[w+1]!=null&&i[w+1].t=="?"));)i[a].v+=i[w].v,i[w]={v:"",t:";"},++w;y+=i[a].v,a=w-1;break;case"G":i[a].t="t",i[a].v=co(t,r);break}var T="",S,E;if(y.length>0){y.charCodeAt(0)==40?(S=t<0&&y.charCodeAt(0)===45?-t:t,E=cs("n",y,S)):(S=t<0&&n>1?-t:t,E=cs("n",y,S),S<0&&i[0]&&i[0].t=="t"&&(E=E.substr(1),i[0].v="-"+i[0].v)),w=E.length-1;var k=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){k=a;break}var b=i.length;if(k===i.length&&E.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(w>=i[a].v.length-1?(w-=i[a].v.length,i[a].v=E.substr(w+1,i[a].v.length)):w<0?i[a].v="":(i[a].v=E.substr(0,w+1),w=-1),i[a].t="t",b=a);w>=0&&b<i.length&&(i[b].v=E.substr(0,w+1)+i[b].v)}else if(k!==i.length&&E.indexOf("E")===-1){for(w=E.indexOf(".")-1,a=k;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(u=i[a].v.indexOf(".")>-1&&a===k?i[a].v.indexOf(".")-1:i[a].v.length-1,T=i[a].v.substr(u+1);u>=0;--u)w>=0&&(i[a].v.charAt(u)==="0"||i[a].v.charAt(u)==="#")&&(T=E.charAt(w--)+T);i[a].v=T,i[a].t="t",b=a}for(w>=0&&b<i.length&&(i[b].v=E.substr(0,w+1)+i[b].v),w=E.indexOf(".")+1,a=k;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==k)){for(u=i[a].v.indexOf(".")>-1&&a===k?i[a].v.indexOf(".")+1:0,T=i[a].v.substr(0,u);u<i[a].v.length;++u)w<E.length&&(T+=E.charAt(w++));i[a].v=T,i[a].t="t",b=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(S=n>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=cs(i[a].t,i[a].v,S),i[a].t="t");var j="";for(a=0;a!==i.length;++a)i[a]!=null&&(j+=i[a].v);return j}var W2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function G2(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function W7(e,t){var r=H7(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(W2),o=r[1].match(W2);return G2(t,a)?[n,r[0]]:G2(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function ti(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:$e)[e],n==null&&(n=r.table&&r.table[$2[e]]||$e[$2[e]]),n==null&&(n=C7[e]||"General");break}if(c0(n,0))return co(t,r);t instanceof Date&&(t=K4(t,r.date1904));var i=W7(n,t);if(c0(i[1]))return co(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return z7(i[1],t,r,i[0])}function qa(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if($e[r]==null){t<0&&(t=r);continue}if($e[r]==e){t=r;break}}t<0&&(t=391)}return $e[t]=e,t}function nb(){$e=k7()}var G7={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ib=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function q7(e){var t=typeof e=="number"?$e[e]:e;return t=t.replace(ib,"(\\d+)"),new RegExp("^"+t+"$")}function K7(e,t,r){var n=-1,i=-1,s=-1,a=-1,o=-1,c=-1;(t.match(ib)||[]).forEach(function(f,d){var p=parseInt(r[d+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":a=p;break;case"s":c=p;break;case"m":a>=0?o=p:i=p;break}}),c>=0&&o==-1&&i>=0&&(o=i,i=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?l:n==-1&&i==-1&&s==-1?u:l+"T"+u}var X7=function(){var e={};e.version="1.2.0";function t(){for(var E=0,k=new Array(256),b=0;b!=256;++b)E=b,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,k[b]=E;return typeof Int32Array<"u"?new Int32Array(k):k}var r=t();function n(E){var k=0,b=0,j=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(j=0;j!=256;++j)H[j]=E[j];for(j=0;j!=256;++j)for(b=E[j],k=256+j;k<4096;k+=256)b=H[k]=b>>>8^E[b&255];var O=[];for(j=1;j!=16;++j)O[j-1]=typeof Int32Array<"u"?H.subarray(j*256,j*256+256):H.slice(j*256,j*256+256);return O}var i=n(r),s=i[0],a=i[1],o=i[2],c=i[3],l=i[4],u=i[5],f=i[6],d=i[7],p=i[8],g=i[9],m=i[10],v=i[11],_=i[12],x=i[13],y=i[14];function w(E,k){for(var b=k^-1,j=0,H=E.length;j<H;)b=b>>>8^r[(b^E.charCodeAt(j++))&255];return~b}function T(E,k){for(var b=k^-1,j=E.length-15,H=0;H<j;)b=y[E[H++]^b&255]^x[E[H++]^b>>8&255]^_[E[H++]^b>>16&255]^v[E[H++]^b>>>24]^m[E[H++]]^g[E[H++]]^p[E[H++]]^d[E[H++]]^f[E[H++]]^u[E[H++]]^l[E[H++]]^c[E[H++]]^o[E[H++]]^a[E[H++]]^s[E[H++]]^r[E[H++]];for(j+=15;H<j;)b=b>>>8^r[(b^E[H++])&255];return~b}function S(E,k){for(var b=k^-1,j=0,H=E.length,O=0,V=0;j<H;)O=E.charCodeAt(j++),O<128?b=b>>>8^r[(b^O)&255]:O<2048?(b=b>>>8^r[(b^(192|O>>6&31))&255],b=b>>>8^r[(b^(128|O&63))&255]):O>=55296&&O<57344?(O=(O&1023)+64,V=E.charCodeAt(j++)&1023,b=b>>>8^r[(b^(240|O>>8&7))&255],b=b>>>8^r[(b^(128|O>>2&63))&255],b=b>>>8^r[(b^(128|V>>6&15|(O&3)<<4))&255],b=b>>>8^r[(b^(128|V&63))&255]):(b=b>>>8^r[(b^(224|O>>12&15))&255],b=b>>>8^r[(b^(128|O>>6&63))&255],b=b>>>8^r[(b^(128|O&63))&255]);return~b}return e.table=r,e.bstr=w,e.buf=T,e.str=S,e}(),tt=function(){var t={};t.version="1.2.1";function r(A,N){for(var C=A.split("/"),R=N.split("/"),D=0,L=0,Y=Math.min(C.length,R.length);D<Y;++D){if(L=C[D].length-R[D].length)return L;if(C[D]!=R[D])return C[D]<R[D]?-1:1}return C.length-R.length}function n(A){if(A.charAt(A.length-1)=="/")return A.slice(0,-1).indexOf("/")===-1?A:n(A.slice(0,-1));var N=A.lastIndexOf("/");return N===-1?A:A.slice(0,N+1)}function i(A){if(A.charAt(A.length-1)=="/")return i(A.slice(0,-1));var N=A.lastIndexOf("/");return N===-1?A:A.slice(N+1)}function s(A,N){typeof N=="string"&&(N=new Date(N));var C=N.getHours();C=C<<6|N.getMinutes(),C=C<<5|N.getSeconds()>>>1,A.write_shift(2,C);var R=N.getFullYear()-1980;R=R<<4|N.getMonth()+1,R=R<<5|N.getDate(),A.write_shift(2,R)}function a(A){var N=A.read_shift(2)&65535,C=A.read_shift(2)&65535,R=new Date,D=C&31;C>>>=5;var L=C&15;C>>>=4,R.setMilliseconds(0),R.setFullYear(C+1980),R.setMonth(L-1),R.setDate(D);var Y=N&31;N>>>=5;var ne=N&63;return N>>>=6,R.setHours(N),R.setMinutes(ne),R.setSeconds(Y<<1),R}function o(A){yr(A,0);for(var N={},C=0;A.l<=A.length-4;){var R=A.read_shift(2),D=A.read_shift(2),L=A.l+D,Y={};switch(R){case 21589:C=A.read_shift(1),C&1&&(Y.mtime=A.read_shift(4)),D>5&&(C&2&&(Y.atime=A.read_shift(4)),C&4&&(Y.ctime=A.read_shift(4))),Y.mtime&&(Y.mt=new Date(Y.mtime*1e3));break}A.l=L,N[R]=Y}return N}var c;function l(){return c||(c={})}function u(A,N){if(A[0]==80&&A[1]==75)return By(A,N);if((A[0]|32)==109&&(A[1]|32)==105)return WP(A,N);if(A.length<512)throw new Error("CFB file size "+A.length+" < 512");var C=3,R=512,D=0,L=0,Y=0,ne=0,K=0,Q=[],J=A.slice(0,512);yr(J,0);var fe=f(J);switch(C=fe[0],C){case 3:R=512;break;case 4:R=4096;break;case 0:if(fe[1]==0)return By(A,N);default:throw new Error("Major Version: Expected 3 or 4 saw "+C)}R!==512&&(J=A.slice(0,R),yr(J,28));var _e=A.slice(0,R);d(J,C);var Se=J.read_shift(4,"i");if(C===3&&Se!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Se);J.l+=4,Y=J.read_shift(4,"i"),J.l+=4,J.chk("00100000","Mini Stream Cutoff Size: "),ne=J.read_shift(4,"i"),D=J.read_shift(4,"i"),K=J.read_shift(4,"i"),L=J.read_shift(4,"i");for(var pe=-1,we=0;we<109&&(pe=J.read_shift(4,"i"),!(pe<0));++we)Q[we]=pe;var Ue=p(A,R);v(K,L,Ue,R,Q);var kt=x(Ue,Y,Q,R);kt[Y].name="!Directory",D>0&&ne!==V&&(kt[ne].name="!MiniFAT"),kt[Q[0]].name="!FAT",kt.fat_addrs=Q,kt.ssz=R;var Ct={},br=[],rl=[],nl=[];y(Y,kt,Ue,br,D,Ct,rl,ne),g(rl,nl,br),br.shift();var il={FileIndex:rl,FullPaths:nl};return N&&N.raw&&(il.raw={header:_e,sectors:Ue}),il}function f(A){if(A[A.l]==80&&A[A.l+1]==75)return[0,0];A.chk(G,"Header Signature: "),A.l+=16;var N=A.read_shift(2,"u");return[A.read_shift(2,"u"),N]}function d(A,N){var C=9;switch(A.l+=2,C=A.read_shift(2)){case 9:if(N!=3)throw new Error("Sector Shift: Expected 9 saw "+C);break;case 12:if(N!=4)throw new Error("Sector Shift: Expected 12 saw "+C);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+C)}A.chk("0600","Mini Sector Shift: "),A.chk("000000000000","Reserved: ")}function p(A,N){for(var C=Math.ceil(A.length/N)-1,R=[],D=1;D<C;++D)R[D-1]=A.slice(D*N,(D+1)*N);return R[C-1]=A.slice(C*N),R}function g(A,N,C){for(var R=0,D=0,L=0,Y=0,ne=0,K=C.length,Q=[],J=[];R<K;++R)Q[R]=J[R]=R,N[R]=C[R];for(;ne<J.length;++ne)R=J[ne],D=A[R].L,L=A[R].R,Y=A[R].C,Q[R]===R&&(D!==-1&&Q[D]!==D&&(Q[R]=Q[D]),L!==-1&&Q[L]!==L&&(Q[R]=Q[L])),Y!==-1&&(Q[Y]=R),D!==-1&&R!=Q[R]&&(Q[D]=Q[R],J.lastIndexOf(D)<ne&&J.push(D)),L!==-1&&R!=Q[R]&&(Q[L]=Q[R],J.lastIndexOf(L)<ne&&J.push(L));for(R=1;R<K;++R)Q[R]===R&&(L!==-1&&Q[L]!==L?Q[R]=Q[L]:D!==-1&&Q[D]!==D&&(Q[R]=Q[D]));for(R=1;R<K;++R)if(A[R].type!==0){if(ne=R,ne!=Q[ne])do ne=Q[ne],N[R]=N[ne]+"/"+N[R];while(ne!==0&&Q[ne]!==-1&&ne!=Q[ne]);Q[R]=-1}for(N[0]+="/",R=1;R<K;++R)A[R].type!==2&&(N[R]+="/")}function m(A,N,C){for(var R=A.start,D=A.size,L=[],Y=R;C&&D>0&&Y>=0;)L.push(N.slice(Y*O,Y*O+O)),D-=O,Y=Na(C,Y*4);return L.length===0?Zt(0):Ls(L).slice(0,A.size)}function v(A,N,C,R,D){var L=V;if(A===V){if(N!==0)throw new Error("DIFAT chain shorter than expected")}else if(A!==-1){var Y=C[A],ne=(R>>>2)-1;if(!Y)return;for(var K=0;K<ne&&(L=Na(Y,K*4))!==V;++K)D.push(L);v(Na(Y,R-4),N-1,C,R,D)}}function _(A,N,C,R,D){var L=[],Y=[];D||(D=[]);var ne=R-1,K=0,Q=0;for(K=N;K>=0;){D[K]=!0,L[L.length]=K,Y.push(A[K]);var J=C[Math.floor(K*4/R)];if(Q=K*4&ne,R<4+Q)throw new Error("FAT boundary crossed: "+K+" 4 "+R);if(!A[J])break;K=Na(A[J],Q)}return{nodes:L,data:rT([Y])}}function x(A,N,C,R){var D=A.length,L=[],Y=[],ne=[],K=[],Q=R-1,J=0,fe=0,_e=0,Se=0;for(J=0;J<D;++J)if(ne=[],_e=J+N,_e>=D&&(_e-=D),!Y[_e]){K=[];var pe=[];for(fe=_e;fe>=0;){pe[fe]=!0,Y[fe]=!0,ne[ne.length]=fe,K.push(A[fe]);var we=C[Math.floor(fe*4/R)];if(Se=fe*4&Q,R<4+Se)throw new Error("FAT boundary crossed: "+fe+" 4 "+R);if(!A[we]||(fe=Na(A[we],Se),pe[fe]))break}L[_e]={nodes:ne,data:rT([K])}}return L}function y(A,N,C,R,D,L,Y,ne){for(var K=0,Q=R.length?2:0,J=N[A].data,fe=0,_e=0,Se;fe<J.length;fe+=128){var pe=J.slice(fe,fe+128);yr(pe,64),_e=pe.read_shift(2),Se=ay(pe,0,_e-Q),R.push(Se);var we={name:Se,type:pe.read_shift(1),color:pe.read_shift(1),L:pe.read_shift(4,"i"),R:pe.read_shift(4,"i"),C:pe.read_shift(4,"i"),clsid:pe.read_shift(16),state:pe.read_shift(4,"i"),start:0,size:0},Ue=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);Ue!==0&&(we.ct=w(pe,pe.l-8));var kt=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);kt!==0&&(we.mt=w(pe,pe.l-8)),we.start=pe.read_shift(4,"i"),we.size=pe.read_shift(4,"i"),we.size<0&&we.start<0&&(we.size=we.type=0,we.start=V,we.name=""),we.type===5?(K=we.start,D>0&&K!==V&&(N[K].name="!StreamData")):we.size>=4096?(we.storage="fat",N[we.start]===void 0&&(N[we.start]=_(C,we.start,N.fat_addrs,N.ssz)),N[we.start].name=we.name,we.content=N[we.start].data.slice(0,we.size)):(we.storage="minifat",we.size<0?we.size=0:K!==V&&we.start!==V&&N[K]&&(we.content=m(we,N[K].data,(N[ne]||{}).data))),we.content&&yr(we.content,0),L[Se]=we,Y.push(we)}}function w(A,N){return new Date((Cn(A,N+4)/1e7*Math.pow(2,32)+Cn(A,N)/1e7-11644473600)*1e3)}function T(A,N){return l(),u(c.readFileSync(A),N)}function S(A,N){var C=N&&N.type;switch(C||Je&&Buffer.isBuffer(A)&&(C="buffer"),C||"base64"){case"file":return T(A,N);case"base64":return u(li(Vn(A)),N);case"binary":return u(li(A),N)}return u(A,N)}function E(A,N){var C=N||{},R=C.root||"Root Entry";if(A.FullPaths||(A.FullPaths=[]),A.FileIndex||(A.FileIndex=[]),A.FullPaths.length!==A.FileIndex.length)throw new Error("inconsistent CFB structure");A.FullPaths.length===0&&(A.FullPaths[0]=R+"/",A.FileIndex[0]={name:R,type:5}),C.CLSID&&(A.FileIndex[0].clsid=C.CLSID),k(A)}function k(A){var N="Sh33tJ5";if(!tt.find(A,"/"+N)){var C=Zt(4);C[0]=55,C[1]=C[3]=50,C[2]=54,A.FileIndex.push({name:N,type:2,content:C,size:4,L:69,R:69,C:69}),A.FullPaths.push(A.FullPaths[0]+N),b(A)}}function b(A,N){E(A);for(var C=!1,R=!1,D=A.FullPaths.length-1;D>=0;--D){var L=A.FileIndex[D];switch(L.type){case 0:R?C=!0:(A.FileIndex.pop(),A.FullPaths.pop());break;case 1:case 2:case 5:R=!0,isNaN(L.R*L.L*L.C)&&(C=!0),L.R>-1&&L.L>-1&&L.R==L.L&&(C=!0);break;default:C=!0;break}}if(!(!C&&!N)){var Y=new Date(1987,1,19),ne=0,K=Object.create?Object.create(null):{},Q=[];for(D=0;D<A.FullPaths.length;++D)K[A.FullPaths[D]]=!0,A.FileIndex[D].type!==0&&Q.push([A.FullPaths[D],A.FileIndex[D]]);for(D=0;D<Q.length;++D){var J=n(Q[D][0]);R=K[J],R||(Q.push([J,{name:i(J).replace("/",""),type:1,clsid:Z,ct:Y,mt:Y,content:null}]),K[J]=!0)}for(Q.sort(function(Se,pe){return r(Se[0],pe[0])}),A.FullPaths=[],A.FileIndex=[],D=0;D<Q.length;++D)A.FullPaths[D]=Q[D][0],A.FileIndex[D]=Q[D][1];for(D=0;D<Q.length;++D){var fe=A.FileIndex[D],_e=A.FullPaths[D];if(fe.name=i(_e).replace("/",""),fe.L=fe.R=fe.C=-(fe.color=1),fe.size=fe.content?fe.content.length:0,fe.start=0,fe.clsid=fe.clsid||Z,D===0)fe.C=Q.length>1?1:-1,fe.size=0,fe.type=5;else if(_e.slice(-1)=="/"){for(ne=D+1;ne<Q.length&&n(A.FullPaths[ne])!=_e;++ne);for(fe.C=ne>=Q.length?-1:ne,ne=D+1;ne<Q.length&&n(A.FullPaths[ne])!=n(_e);++ne);fe.R=ne>=Q.length?-1:ne,fe.type=1}else n(A.FullPaths[D+1]||"")==n(_e)&&(fe.R=D+1),fe.type=2}}}function j(A,N){var C=N||{};if(C.fileType=="mad")return GP(A,C);switch(b(A),C.fileType){case"zip":return jP(A,C)}var R=function(Se){for(var pe=0,we=0,Ue=0;Ue<Se.FileIndex.length;++Ue){var kt=Se.FileIndex[Ue];if(kt.content){var Ct=kt.content.length;Ct>0&&(Ct<4096?pe+=Ct+63>>6:we+=Ct+511>>9)}}for(var br=Se.FullPaths.length+3>>2,rl=pe+7>>3,nl=pe+127>>7,il=rl+we+br+nl,Ca=il+127>>7,Qp=Ca<=109?0:Math.ceil((Ca-109)/127);il+Ca+Qp+127>>7>Ca;)Qp=++Ca<=109?0:Math.ceil((Ca-109)/127);var Yi=[1,Qp,Ca,nl,br,we,pe,0];return Se.FileIndex[0].size=pe<<6,Yi[7]=(Se.FileIndex[0].start=Yi[0]+Yi[1]+Yi[2]+Yi[3]+Yi[4]+Yi[5])+(Yi[6]+7>>3),Yi}(A),D=Zt(R[7]<<9),L=0,Y=0;{for(L=0;L<8;++L)D.write_shift(1,X[L]);for(L=0;L<8;++L)D.write_shift(2,0);for(D.write_shift(2,62),D.write_shift(2,3),D.write_shift(2,65534),D.write_shift(2,9),D.write_shift(2,6),L=0;L<3;++L)D.write_shift(2,0);for(D.write_shift(4,0),D.write_shift(4,R[2]),D.write_shift(4,R[0]+R[1]+R[2]+R[3]-1),D.write_shift(4,0),D.write_shift(4,4096),D.write_shift(4,R[3]?R[0]+R[1]+R[2]-1:V),D.write_shift(4,R[3]),D.write_shift(-4,R[1]?R[0]-1:V),D.write_shift(4,R[1]),L=0;L<109;++L)D.write_shift(-4,L<R[2]?R[1]+L:-1)}if(R[1])for(Y=0;Y<R[1];++Y){for(;L<236+Y*127;++L)D.write_shift(-4,L<R[2]?R[1]+L:-1);D.write_shift(-4,Y===R[1]-1?V:Y+1)}var ne=function(Se){for(Y+=Se;L<Y-1;++L)D.write_shift(-4,L+1);Se&&(++L,D.write_shift(-4,V))};for(Y=L=0,Y+=R[1];L<Y;++L)D.write_shift(-4,ie.DIFSECT);for(Y+=R[2];L<Y;++L)D.write_shift(-4,ie.FATSECT);ne(R[3]),ne(R[4]);for(var K=0,Q=0,J=A.FileIndex[0];K<A.FileIndex.length;++K)J=A.FileIndex[K],J.content&&(Q=J.content.length,!(Q<4096)&&(J.start=Y,ne(Q+511>>9)));for(ne(R[6]+7>>3);D.l&511;)D.write_shift(-4,ie.ENDOFCHAIN);for(Y=L=0,K=0;K<A.FileIndex.length;++K)J=A.FileIndex[K],J.content&&(Q=J.content.length,!(!Q||Q>=4096)&&(J.start=Y,ne(Q+63>>6)));for(;D.l&511;)D.write_shift(-4,ie.ENDOFCHAIN);for(L=0;L<R[4]<<2;++L){var fe=A.FullPaths[L];if(!fe||fe.length===0){for(K=0;K<17;++K)D.write_shift(4,0);for(K=0;K<3;++K)D.write_shift(4,-1);for(K=0;K<12;++K)D.write_shift(4,0);continue}J=A.FileIndex[L],L===0&&(J.start=J.size?J.start-1:V);var _e=L===0&&C.root||J.name;if(Q=2*(_e.length+1),D.write_shift(64,_e,"utf16le"),D.write_shift(2,Q),D.write_shift(1,J.type),D.write_shift(1,J.color),D.write_shift(-4,J.L),D.write_shift(-4,J.R),D.write_shift(-4,J.C),J.clsid)D.write_shift(16,J.clsid,"hex");else for(K=0;K<4;++K)D.write_shift(4,0);D.write_shift(4,J.state||0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,0),D.write_shift(4,J.start),D.write_shift(4,J.size),D.write_shift(4,0)}for(L=1;L<A.FileIndex.length;++L)if(J=A.FileIndex[L],J.size>=4096)if(D.l=J.start+1<<9,Je&&Buffer.isBuffer(J.content))J.content.copy(D,D.l,0,J.size),D.l+=J.size+511&-512;else{for(K=0;K<J.size;++K)D.write_shift(1,J.content[K]);for(;K&511;++K)D.write_shift(1,0)}for(L=1;L<A.FileIndex.length;++L)if(J=A.FileIndex[L],J.size>0&&J.size<4096)if(Je&&Buffer.isBuffer(J.content))J.content.copy(D,D.l,0,J.size),D.l+=J.size+63&-64;else{for(K=0;K<J.size;++K)D.write_shift(1,J.content[K]);for(;K&63;++K)D.write_shift(1,0)}if(Je)D.l=D.length;else for(;D.l<D.length;)D.write_shift(1,0);return D}function H(A,N){var C=A.FullPaths.map(function(K){return K.toUpperCase()}),R=C.map(function(K){var Q=K.split("/");return Q[Q.length-(K.slice(-1)=="/"?2:1)]}),D=!1;N.charCodeAt(0)===47?(D=!0,N=C[0].slice(0,-1)+N):D=N.indexOf("/")!==-1;var L=N.toUpperCase(),Y=D===!0?C.indexOf(L):R.indexOf(L);if(Y!==-1)return A.FileIndex[Y];var ne=!L.match(Pl);for(L=L.replace(on,""),ne&&(L=L.replace(Pl,"!")),Y=0;Y<C.length;++Y)if((ne?C[Y].replace(Pl,"!"):C[Y]).replace(on,"")==L||(ne?R[Y].replace(Pl,"!"):R[Y]).replace(on,"")==L)return A.FileIndex[Y];return null}var O=64,V=-2,G="d0cf11e0a1b11ae1",X=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",ie={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function re(A,N,C){l();var R=j(A,C);c.writeFileSync(N,R)}function B(A){for(var N=new Array(A.length),C=0;C<A.length;++C)N[C]=String.fromCharCode(A[C]);return N.join("")}function ae(A,N){var C=j(A,N);switch(N&&N.type||"buffer"){case"file":return l(),c.writeFileSync(N.filename,C),C;case"binary":return typeof C=="string"?C:B(C);case"base64":return V2(typeof C=="string"?C:B(C));case"buffer":if(Je)return Buffer.isBuffer(C)?C:So(C);case"array":return typeof C=="string"?li(C):C}return C}var xe;function I(A){try{var N=A.InflateRaw,C=new N;if(C._processChunk(new Uint8Array([3,0]),C._finishFlushFlag),C.bytesRead)xe=A;else throw new Error("zlib does not expose bytesRead")}catch(R){console.error("cannot use native zlib: "+(R.message||R))}}function W(A,N){if(!xe)return Vy(A,N);var C=xe.InflateRaw,R=new C,D=R._processChunk(A.slice(A.l),R._finishFlushFlag);return A.l+=R.bytesRead,D}function z(A){return xe?xe.deflateRawSync(A):Ge(A)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function me(A){var N=(A<<1|A<<11)&139536|(A<<5|A<<15)&558144;return(N>>16|N>>8|N)&255}for(var de=typeof Uint8Array<"u",ce=de?new Uint8Array(256):[],ze=0;ze<256;++ze)ce[ze]=me(ze);function M(A,N){var C=ce[A&255];return N<=8?C>>>8-N:(C=C<<8|ce[A>>8&255],N<=16?C>>>16-N:(C=C<<8|ce[A>>16&255],C>>>24-N))}function dt(A,N){var C=N&7,R=N>>>3;return(A[R]|(C<=6?0:A[R+1]<<8))>>>C&3}function qe(A,N){var C=N&7,R=N>>>3;return(A[R]|(C<=5?0:A[R+1]<<8))>>>C&7}function Ze(A,N){var C=N&7,R=N>>>3;return(A[R]|(C<=4?0:A[R+1]<<8))>>>C&15}function We(A,N){var C=N&7,R=N>>>3;return(A[R]|(C<=3?0:A[R+1]<<8))>>>C&31}function P(A,N){var C=N&7,R=N>>>3;return(A[R]|(C<=1?0:A[R+1]<<8))>>>C&127}function q(A,N,C){var R=N&7,D=N>>>3,L=(1<<C)-1,Y=A[D]>>>R;return C<8-R||(Y|=A[D+1]<<8-R,C<16-R)||(Y|=A[D+2]<<16-R,C<24-R)||(Y|=A[D+3]<<24-R),Y&L}function te(A,N,C){var R=N&7,D=N>>>3;return R<=5?A[D]|=(C&7)<<R:(A[D]|=C<<R&255,A[D+1]=(C&7)>>8-R),N+3}function ge(A,N,C){var R=N&7,D=N>>>3;return C=(C&1)<<R,A[D]|=C,N+1}function ve(A,N,C){var R=N&7,D=N>>>3;return C<<=R,A[D]|=C&255,C>>>=8,A[D+1]=C,N+8}function ue(A,N,C){var R=N&7,D=N>>>3;return C<<=R,A[D]|=C&255,C>>>=8,A[D+1]=C&255,A[D+2]=C>>>8,N+16}function Ie(A,N){var C=A.length,R=2*C>N?2*C:N+5,D=0;if(C>=N)return A;if(Je){var L=j2(R);if(A.copy)A.copy(L);else for(;D<A.length;++D)L[D]=A[D];return L}else if(de){var Y=new Uint8Array(R);if(Y.set)Y.set(A);else for(;D<C;++D)Y[D]=A[D];return Y}return A.length=R,A}function Ke(A){for(var N=new Array(A),C=0;C<A;++C)N[C]=0;return N}function at(A,N,C){var R=1,D=0,L=0,Y=0,ne=0,K=A.length,Q=de?new Uint16Array(32):Ke(32);for(L=0;L<32;++L)Q[L]=0;for(L=K;L<C;++L)A[L]=0;K=A.length;var J=de?new Uint16Array(K):Ke(K);for(L=0;L<K;++L)Q[D=A[L]]++,R<D&&(R=D),J[L]=0;for(Q[0]=0,L=1;L<=R;++L)Q[L+16]=ne=ne+Q[L-1]<<1;for(L=0;L<K;++L)ne=A[L],ne!=0&&(J[L]=Q[ne+16]++);var fe=0;for(L=0;L<K;++L)if(fe=A[L],fe!=0)for(ne=M(J[L],R)>>R-fe,Y=(1<<R+4-fe)-1;Y>=0;--Y)N[ne|Y<<fe]=fe&15|L<<4;return R}var Qr=de?new Uint16Array(512):Ke(512),Aa=de?new Uint16Array(32):Ke(32);if(!de){for(var Jt=0;Jt<512;++Jt)Qr[Jt]=0;for(Jt=0;Jt<32;++Jt)Aa[Jt]=0}(function(){for(var A=[],N=0;N<32;N++)A.push(5);at(A,Aa,32);var C=[];for(N=0;N<=143;N++)C.push(8);for(;N<=255;N++)C.push(9);for(;N<=279;N++)C.push(7);for(;N<=287;N++)C.push(8);at(C,Qr,288)})();var hn=function(){for(var N=de?new Uint8Array(32768):[],C=0,R=0;C<oe.length-1;++C)for(;R<oe[C+1];++R)N[R]=C;for(;R<32768;++R)N[R]=29;var D=de?new Uint8Array(259):[];for(C=0,R=0;C<ee.length-1;++C)for(;R<ee[C+1];++R)D[R]=C;function L(ne,K){for(var Q=0;Q<ne.length;){var J=Math.min(65535,ne.length-Q),fe=Q+J==ne.length;for(K.write_shift(1,+fe),K.write_shift(2,J),K.write_shift(2,~J&65535);J-- >0;)K[K.l++]=ne[Q++]}return K.l}function Y(ne,K){for(var Q=0,J=0,fe=de?new Uint16Array(32768):[];J<ne.length;){var _e=Math.min(65535,ne.length-J);if(_e<10){for(Q=te(K,Q,+(J+_e==ne.length)),Q&7&&(Q+=8-(Q&7)),K.l=Q/8|0,K.write_shift(2,_e),K.write_shift(2,~_e&65535);_e-- >0;)K[K.l++]=ne[J++];Q=K.l*8;continue}Q=te(K,Q,+(J+_e==ne.length)+2);for(var Se=0;_e-- >0;){var pe=ne[J];Se=(Se<<5^pe)&32767;var we=-1,Ue=0;if((we=fe[Se])&&(we|=J&-32768,we>J&&(we-=32768),we<J))for(;ne[we+Ue]==ne[J+Ue]&&Ue<250;)++Ue;if(Ue>2){pe=D[Ue],pe<=22?Q=ve(K,Q,ce[pe+1]>>1)-1:(ve(K,Q,3),Q+=5,ve(K,Q,ce[pe-23]>>5),Q+=3);var kt=pe<8?0:pe-4>>2;kt>0&&(ue(K,Q,Ue-ee[pe]),Q+=kt),pe=N[J-we],Q=ve(K,Q,ce[pe]>>3),Q-=3;var Ct=pe<4?0:pe-2>>1;Ct>0&&(ue(K,Q,J-we-oe[pe]),Q+=Ct);for(var br=0;br<Ue;++br)fe[Se]=J&32767,Se=(Se<<5^ne[J])&32767,++J;_e-=Ue-1}else pe<=143?pe=pe+48:Q=ge(K,Q,1),Q=ve(K,Q,ce[pe]),fe[Se]=J&32767,++J}Q=ve(K,Q,0)-1}return K.l=(Q+7)/8|0,K.l}return function(K,Q){return K.length<8?L(K,Q):Y(K,Q)}}();function Ge(A){var N=Zt(50+Math.floor(A.length*1.1)),C=hn(A,N);return N.slice(0,C)}var Tt=de?new Uint16Array(32768):Ke(32768),dn=de?new Uint16Array(32768):Ke(32768),Pt=de?new Uint16Array(128):Ke(128),ka=1,My=1;function LP(A,N){var C=We(A,N)+257;N+=5;var R=We(A,N)+1;N+=5;var D=Ze(A,N)+4;N+=4;for(var L=0,Y=de?new Uint8Array(19):Ke(19),ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],K=1,Q=de?new Uint8Array(8):Ke(8),J=de?new Uint8Array(8):Ke(8),fe=Y.length,_e=0;_e<D;++_e)Y[U[_e]]=L=qe(A,N),K<L&&(K=L),Q[L]++,N+=3;var Se=0;for(Q[0]=0,_e=1;_e<=K;++_e)J[_e]=Se=Se+Q[_e-1]<<1;for(_e=0;_e<fe;++_e)(Se=Y[_e])!=0&&(ne[_e]=J[Se]++);var pe=0;for(_e=0;_e<fe;++_e)if(pe=Y[_e],pe!=0){Se=ce[ne[_e]]>>8-pe;for(var we=(1<<7-pe)-1;we>=0;--we)Pt[Se|we<<pe]=pe&7|_e<<3}var Ue=[];for(K=1;Ue.length<C+R;)switch(Se=Pt[P(A,N)],N+=Se&7,Se>>>=3){case 16:for(L=3+dt(A,N),N+=2,Se=Ue[Ue.length-1];L-- >0;)Ue.push(Se);break;case 17:for(L=3+qe(A,N),N+=3;L-- >0;)Ue.push(0);break;case 18:for(L=11+P(A,N),N+=7;L-- >0;)Ue.push(0);break;default:Ue.push(Se),K<Se&&(K=Se);break}var kt=Ue.slice(0,C),Ct=Ue.slice(C);for(_e=C;_e<286;++_e)kt[_e]=0;for(_e=R;_e<30;++_e)Ct[_e]=0;return ka=at(kt,Tt,286),My=at(Ct,dn,30),N}function MP(A,N){if(A[0]==3&&!(A[1]&3))return[ha(N),2];for(var C=0,R=0,D=j2(N||1<<18),L=0,Y=D.length>>>0,ne=0,K=0;!(R&1);){if(R=qe(A,C),C+=3,R>>>1)R>>1==1?(ne=9,K=5):(C=LP(A,C),ne=ka,K=My);else{C&7&&(C+=8-(C&7));var Q=A[C>>>3]|A[(C>>>3)+1]<<8;if(C+=32,Q>0)for(!N&&Y<L+Q&&(D=Ie(D,L+Q),Y=D.length);Q-- >0;)D[L++]=A[C>>>3],C+=8;continue}for(;;){!N&&Y<L+32767&&(D=Ie(D,L+32767),Y=D.length);var J=q(A,C,ne),fe=R>>>1==1?Qr[J]:Tt[J];if(C+=fe&15,fe>>>=4,!(fe>>>8&255))D[L++]=fe;else{if(fe==256)break;fe-=257;var _e=fe<8?0:fe-4>>2;_e>5&&(_e=0);var Se=L+ee[fe];_e>0&&(Se+=q(A,C,_e),C+=_e),J=q(A,C,K),fe=R>>>1==1?Aa[J]:dn[J],C+=fe&15,fe>>>=4;var pe=fe<4?0:fe-2>>1,we=oe[fe];for(pe>0&&(we+=q(A,C,pe),C+=pe),!N&&Y<Se&&(D=Ie(D,Se+100),Y=D.length);L<Se;)D[L]=D[L-we],++L}}}return N?[D,C+7>>>3]:[D.slice(0,L),C+7>>>3]}function Vy(A,N){var C=A.slice(A.l||0),R=MP(C,N);return A.l+=R[1],R[0]}function jy(A,N){if(A)typeof console<"u"&&console.error(N);else throw new Error(N)}function By(A,N){var C=A;yr(C,0);var R=[],D=[],L={FileIndex:R,FullPaths:D};E(L,{root:N.root});for(var Y=C.length-4;(C[Y]!=80||C[Y+1]!=75||C[Y+2]!=5||C[Y+3]!=6)&&Y>=0;)--Y;C.l=Y+4,C.l+=4;var ne=C.read_shift(2);C.l+=6;var K=C.read_shift(4);for(C.l=K,Y=0;Y<ne;++Y){C.l+=20;var Q=C.read_shift(4),J=C.read_shift(4),fe=C.read_shift(2),_e=C.read_shift(2),Se=C.read_shift(2);C.l+=8;var pe=C.read_shift(4),we=o(C.slice(C.l+fe,C.l+fe+_e));C.l+=fe+_e+Se;var Ue=C.l;C.l=pe+4,VP(C,Q,J,L,we),C.l=Ue}return L}function VP(A,N,C,R,D){A.l+=2;var L=A.read_shift(2),Y=A.read_shift(2),ne=a(A);if(L&8257)throw new Error("Unsupported ZIP encryption");for(var K=A.read_shift(4),Q=A.read_shift(4),J=A.read_shift(4),fe=A.read_shift(2),_e=A.read_shift(2),Se="",pe=0;pe<fe;++pe)Se+=String.fromCharCode(A[A.l++]);if(_e){var we=o(A.slice(A.l,A.l+_e));(we[21589]||{}).mt&&(ne=we[21589].mt),((D||{})[21589]||{}).mt&&(ne=D[21589].mt)}A.l+=_e;var Ue=A.slice(A.l,A.l+Q);switch(Y){case 8:Ue=W(A,J);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Y)}var kt=!1;L&8&&(K=A.read_shift(4),K==134695760&&(K=A.read_shift(4),kt=!0),Q=A.read_shift(4),J=A.read_shift(4)),Q!=N&&jy(kt,"Bad compressed size: "+N+" != "+Q),J!=C&&jy(kt,"Bad uncompressed size: "+C+" != "+J),Yp(R,Se,Ue,{unsafe:!0,mt:ne})}function jP(A,N){var C=N||{},R=[],D=[],L=Zt(1),Y=C.compression?8:0,ne=0,K=0,Q=0,J=0,fe=0,_e=A.FullPaths[0],Se=_e,pe=A.FileIndex[0],we=[],Ue=0;for(K=1;K<A.FullPaths.length;++K)if(Se=A.FullPaths[K].slice(_e.length),pe=A.FileIndex[K],!(!pe.size||!pe.content||Se=="Sh33tJ5")){var kt=J,Ct=Zt(Se.length);for(Q=0;Q<Se.length;++Q)Ct.write_shift(1,Se.charCodeAt(Q)&127);Ct=Ct.slice(0,Ct.l),we[fe]=X7.buf(pe.content,0);var br=pe.content;Y==8&&(br=z(br)),L=Zt(30),L.write_shift(4,67324752),L.write_shift(2,20),L.write_shift(2,ne),L.write_shift(2,Y),pe.mt?s(L,pe.mt):L.write_shift(4,0),L.write_shift(-4,we[fe]),L.write_shift(4,br.length),L.write_shift(4,pe.content.length),L.write_shift(2,Ct.length),L.write_shift(2,0),J+=L.length,R.push(L),J+=Ct.length,R.push(Ct),J+=br.length,R.push(br),L=Zt(46),L.write_shift(4,33639248),L.write_shift(2,0),L.write_shift(2,20),L.write_shift(2,ne),L.write_shift(2,Y),L.write_shift(4,0),L.write_shift(-4,we[fe]),L.write_shift(4,br.length),L.write_shift(4,pe.content.length),L.write_shift(2,Ct.length),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(4,0),L.write_shift(4,kt),Ue+=L.l,D.push(L),Ue+=Ct.length,D.push(Ct),++fe}return L=Zt(22),L.write_shift(4,101010256),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,fe),L.write_shift(2,fe),L.write_shift(4,Ue),L.write_shift(4,J),L.write_shift(2,0),Ls([Ls(R),Ls(D),L])}var Hf={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function BP(A,N){if(A.ctype)return A.ctype;var C=A.name||"",R=C.match(/\.([^\.]+)$/);return R&&Hf[R[1]]||N&&(R=(C=N).match(/[\.\\]([^\.\\])+$/),R&&Hf[R[1]])?Hf[R[1]]:"application/octet-stream"}function UP(A){for(var N=V2(A),C=[],R=0;R<N.length;R+=76)C.push(N.slice(R,R+76));return C.join(`\r
`)+`\r
`}function $P(A){var N=A.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Q){var J=Q.charCodeAt(0).toString(16).toUpperCase();return"="+(J.length==1?"0"+J:J)});N=N.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),N.charAt(0)==`
`&&(N="=0D"+N.slice(1)),N=N.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var C=[],R=N.split(`\r
`),D=0;D<R.length;++D){var L=R[D];if(L.length==0){C.push("");continue}for(var Y=0;Y<L.length;){var ne=76,K=L.slice(Y,Y+ne);K.charAt(ne-1)=="="?ne--:K.charAt(ne-2)=="="?ne-=2:K.charAt(ne-3)=="="&&(ne-=3),K=L.slice(Y,Y+ne),Y+=ne,Y<L.length&&(K+="="),C.push(K)}}return C.join(`\r
`)}function HP(A){for(var N=[],C=0;C<A.length;++C){for(var R=A[C];C<=A.length&&R.charAt(R.length-1)=="=";)R=R.slice(0,R.length-1)+A[++C];N.push(R)}for(var D=0;D<N.length;++D)N[D]=N[D].replace(/[=][0-9A-Fa-f]{2}/g,function(L){return String.fromCharCode(parseInt(L.slice(1),16))});return li(N.join(`\r
`))}function zP(A,N,C){for(var R="",D="",L="",Y,ne=0;ne<10;++ne){var K=N[ne];if(!K||K.match(/^\s*$/))break;var Q=K.match(/^(.*?):\s*([^\s].*)$/);if(Q)switch(Q[1].toLowerCase()){case"content-location":R=Q[2].trim();break;case"content-type":L=Q[2].trim();break;case"content-transfer-encoding":D=Q[2].trim();break}}switch(++ne,D.toLowerCase()){case"base64":Y=li(Vn(N.slice(ne).join("")));break;case"quoted-printable":Y=HP(N.slice(ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+D)}var J=Yp(A,R.slice(C.length),Y,{unsafe:!0});L&&(J.ctype=L)}function WP(A,N){if(B(A.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var C=N&&N.root||"",R=(Je&&Buffer.isBuffer(A)?A.toString("binary"):B(A)).split(`\r
`),D=0,L="";for(D=0;D<R.length;++D)if(L=R[D],!!/^Content-Location:/i.test(L)&&(L=L.slice(L.indexOf("file")),C||(C=L.slice(0,L.lastIndexOf("/")+1)),L.slice(0,C.length)!=C))for(;C.length>0&&(C=C.slice(0,C.length-1),C=C.slice(0,C.lastIndexOf("/")+1),L.slice(0,C.length)!=C););var Y=(R[1]||"").match(/boundary="(.*?)"/);if(!Y)throw new Error("MAD cannot find boundary");var ne="--"+(Y[1]||""),K=[],Q=[],J={FileIndex:K,FullPaths:Q};E(J);var fe,_e=0;for(D=0;D<R.length;++D){var Se=R[D];Se!==ne&&Se!==ne+"--"||(_e++&&zP(J,R.slice(fe,D),C),fe=D)}return J}function GP(A,N){var C=N||{},R=C.boundary||"SheetJS";R="------="+R;for(var D=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+R.slice(2)+'"',"","",""],L=A.FullPaths[0],Y=L,ne=A.FileIndex[0],K=1;K<A.FullPaths.length;++K)if(Y=A.FullPaths[K].slice(L.length),ne=A.FileIndex[K],!(!ne.size||!ne.content||Y=="Sh33tJ5")){Y=Y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ue){return"_x"+Ue.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ue){return"_u"+Ue.charCodeAt(0).toString(16)+"_"});for(var Q=ne.content,J=Je&&Buffer.isBuffer(Q)?Q.toString("binary"):B(Q),fe=0,_e=Math.min(1024,J.length),Se=0,pe=0;pe<=_e;++pe)(Se=J.charCodeAt(pe))>=32&&Se<128&&++fe;var we=fe>=_e*4/5;D.push(R),D.push("Content-Location: "+(C.root||"file:///C:/SheetJS/")+Y),D.push("Content-Transfer-Encoding: "+(we?"quoted-printable":"base64")),D.push("Content-Type: "+BP(ne,Y)),D.push(""),D.push(we?$P(J):UP(J))}return D.push(R+`--\r
`),D.join(`\r
`)}function qP(A){var N={};return E(N,A),N}function Yp(A,N,C,R){var D=R&&R.unsafe;D||E(A);var L=!D&&tt.find(A,N);if(!L){var Y=A.FullPaths[0];N.slice(0,Y.length)==Y?Y=N:(Y.slice(-1)!="/"&&(Y+="/"),Y=(Y+N).replace("//","/")),L={name:i(N),type:2},A.FileIndex.push(L),A.FullPaths.push(Y),D||tt.utils.cfb_gc(A)}return L.content=C,L.size=C?C.length:0,R&&(R.CLSID&&(L.clsid=R.CLSID),R.mt&&(L.mt=R.mt),R.ct&&(L.ct=R.ct)),L}function KP(A,N){E(A);var C=tt.find(A,N);if(C){for(var R=0;R<A.FileIndex.length;++R)if(A.FileIndex[R]==C)return A.FileIndex.splice(R,1),A.FullPaths.splice(R,1),!0}return!1}function XP(A,N,C){E(A);var R=tt.find(A,N);if(R){for(var D=0;D<A.FileIndex.length;++D)if(A.FileIndex[D]==R)return A.FileIndex[D].name=i(C),A.FullPaths[D]=C,!0}return!1}function YP(A){b(A,!0)}return t.find=H,t.read=S,t.parse=u,t.write=ae,t.writeFile=re,t.utils={cfb_new:qP,cfb_add:Yp,cfb_del:KP,cfb_mov:XP,cfb_gc:YP,ReadShift:Zl,CheckField:Cb,prep_blob:yr,bconcat:Ls,use_zlib:I,_deflateRaw:Ge,_inflateRaw:Vy,consts:ie},t}();function Y7(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function zi(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function ry(e){for(var t=[],r=zi(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var u0=new Date(1899,11,30,0,0,0);function cn(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=u0.getTime()+(e.getTimezoneOffset()-u0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var sb=new Date,Q7=u0.getTime()+(sb.getTimezoneOffset()-u0.getTimezoneOffset())*6e4,q2=sb.getTimezoneOffset();function bp(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Q7),t.getTimezoneOffset()!==q2&&t.setTime(t.getTime()+(t.getTimezoneOffset()-q2)*6e4),t}function J7(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var K2=new Date("2017-02-19T19:06:09.000Z"),ab=isNaN(K2.getFullYear())?new Date("2/19/17"):K2,Z7=ab.getFullYear()==2017;function dr(e,t){var r=new Date(e);if(Z7)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(ab.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function lo(e,t){if(Je&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Dl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Dl(G4(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Dl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Dl(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Cr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Cr(e[r]));return t}function Dt(e,t){for(var r="";r.length<t;)r+=e;return r}function pi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var eU=["january","february","march","april","may","june","july","august","september","october","november","december"];function Dc(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&eU.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var tU=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function ob(e){return e?e.content&&e.type?lo(e.content,!0):e.data?Fl(e.data):e.asNodeBuffer&&Je?Fl(e.asNodeBuffer().toString("binary")):e.asBinary?Fl(e.asBinary()):e._data&&e._data.getContent?Fl(lo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function cb(e){if(!e)return null;if(e.data)return L2(e.data);if(e.asNodeBuffer&&Je)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?L2(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function rU(e){return e&&e.name.slice(-4)===".bin"?cb(e):ob(e)}function Wn(e,t){for(var r=e.FullPaths||zi(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function ny(e,t){var r=Wn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Gt(e,t,r){if(!r)return rU(ny(e,t));if(!t)return null;try{return Gt(e,t)}catch{return null}}function In(e,t,r){if(!r)return ob(ny(e,t));if(!t)return null;try{return In(e,t)}catch{return null}}function lb(e,t,r){if(!r)return cb(ny(e,t));if(!t)return null;try{return lb(e,t)}catch{return null}}function X2(e){for(var t=e.FullPaths||zi(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function nU(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Je?n=So(r):n=T7(r),tt.utils.cfb_add(e,t,n)}tt.utils.cfb_add(e,t,r)}else e.file(t,r)}function ub(e,t){switch(t.type){case"base64":return tt.read(e,{type:"base64"});case"binary":return tt.read(e,{type:"binary"});case"buffer":case"array":return tt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Nl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var fb=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,iU=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Y2=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,sU=/<[^>]*>/g,Yr=fb.match(Y2)?Y2:sU,aU=/<\w*:/,oU=/<(\/?)\w+:/;function De(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var a=e.match(iU),o=0,c="",l=0,u="",f="",d=1;if(a)for(l=0;l!=a.length;++l){for(f=a[l],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(u=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(d=(i=f.charCodeAt(s+1))==34||i==39?1:0,c=f.slice(s+1+d,f.length-d),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,r||(n[u.toLowerCase()]=c);else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=c,r||(n[p.toLowerCase()]=c)}}return n}function Ki(e){return e.replace(oU,"<$1")}var hb={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},cU=ry(hb),st=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(o,c){return hb[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),lU=/[&<>'"]/g,uU=/[\u0000-\u001f]/g;function iy(e){var t=e+"";return t.replace(lU,function(r){return cU[r]}).replace(/\n/g,"<br/>").replace(uU,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Q2=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function St(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function sg(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function J2(e){var t=ha(2*e.length),r,n,i=1,s=0,a=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Z2(e){return So(e,"binary").toString("utf8")}var _h="foo bar bazâð£",gt=Je&&(Z2(_h)==sg(_h)&&Z2||J2(_h)==sg(_h)&&J2)||sg,Dl=Je?function(e){return So(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Ku=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),db=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),fU=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),hU=/<\/?(?:vt:)?variant>/g,dU=/<(?:vt:)([^>]*)>([\s\S]*)</;function eT(e,t){var r=De(e),n=e.match(fU(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(hU,"").match(dU);a&&i.push({v:gt(a[2]),t:a[1]})}),i}var pU=/(^\s|\s$|\n)/;function mU(e){return zi(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function gU(e,t,r){return"<"+e+(r!=null?mU(r):"")+(t!=null?(t.match(pU)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function sy(e){if(Je&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return gt(Ao(Z_(e)));throw new Error("Bad input format: expected Buffer or string")}var Xu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,vU={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},xU=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function _U(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function yU(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=n?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var tT=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},rT=Je?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:So(t)})):tT(e)}:tT,nT=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(ss(e,i)));return n.join("").replace(on,"")},ay=Je?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(on,""):nT(e,t,r)}:nT,iT=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},pb=Je?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):iT(e,t,r)}:iT,sT=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Vo(e,i)));return n.join("")},Lf=Je?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):sT(t,r,n)}:sT,mb=function(e,t){var r=Cn(e,t);return r>0?Lf(e,t+4,t+4+r-1):""},gb=mb,vb=function(e,t){var r=Cn(e,t);return r>0?Lf(e,t+4,t+4+r-1):""},xb=vb,_b=function(e,t){var r=2*Cn(e,t);return r>0?Lf(e,t+4,t+4+r-1):""},yb=_b,Eb=function(t,r){var n=Cn(t,r);return n>0?ay(t,r+4,r+4+n):""},wb=Eb,Tb=function(e,t){var r=Cn(e,t);return r>0?Lf(e,t+4,t+4+r):""},Sb=Tb,Ab=function(e,t){return _U(e,t)},f0=Ab,kb=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Je&&(gb=function(t,r){if(!Buffer.isBuffer(t))return mb(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},xb=function(t,r){if(!Buffer.isBuffer(t))return vb(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},yb=function(t,r){if(!Buffer.isBuffer(t))return _b(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},wb=function(t,r){if(!Buffer.isBuffer(t))return Eb(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Sb=function(t,r){if(!Buffer.isBuffer(t))return Tb(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},f0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Ab(t,r)},kb=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Vo=function(e,t){return e[t]},ss=function(e,t){return e[t+1]*256+e[t]},EU=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Cn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Na=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},wU=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Zl(e,t){var r="",n,i,s=[],a,o,c,l;switch(t){case"dbcs":if(l=this.l,Je&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(ss(this,l)),l+=2;e*=2;break;case"utf8":r=Lf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=ay(this,this.l,this.l+e);break;case"wstr":return Zl.call(this,e,"dbcs");case"lpstr-ansi":r=gb(this,this.l),e=4+Cn(this,this.l);break;case"lpstr-cp":r=xb(this,this.l),e=4+Cn(this,this.l);break;case"lpwstr":r=yb(this,this.l),e=4+2*Cn(this,this.l);break;case"lpp4":e=4+Cn(this,this.l),r=wb(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Cn(this,this.l),r=Sb(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=Vo(this,this.l+e++))!==0;)s.push(xh(a));r=s.join("");break;case"_wstr":for(e=0,r="";(a=ss(this,this.l+e))!==0;)s.push(xh(a)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",l=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=Vo(this,l),this.l=l+1,o=Zl.call(this,e-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(xh(ss(this,l))),l+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",l=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=Vo(this,l),this.l=l+1,o=Zl.call(this,e-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(xh(Vo(this,l))),l+=1}r=s.join("");break;default:switch(e){case 1:return n=Vo(this,this.l),this.l++,n;case 2:return n=(t==="i"?EU:ss)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Na:wU)(this,this.l),this.l+=4,n):(i=Cn(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=f0(this,this.l):i=f0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=pb(this,this.l,e);break}}return this.l+=e,r}var TU=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},SU=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},AU=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function kU(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)AU(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,TU(this,t,this.l);break;case 8:if(n=8,r==="f"){yU(this,t,this.l);break}case 16:break;case-4:n=4,SU(this,t,this.l);break}return this.l+=n,this}function Cb(e,t){var r=pb(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function yr(e,t){e.l=t,e.read_shift=Zl,e.chk=Cb,e.write_shift=kU}function Xr(e,t){e.l+=t}function Zt(e){var t=ha(e);return yr(t,0),t}function Es(e,t,r){if(e){var n,i,s;yr(e,e.l||0);for(var a=e.length,o=0,c=0;e.l<a;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var l=v0[o]||v0[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;c=e.l+s;var u=l.f&&l.f(e,s,r);if(e.l=c,t(u,l,o))return}}}function sv(){var e=[],t=Je?256:2048,r=function(l){var u=Zt(l);return yr(u,0),u},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(l){return n&&l<n.length-n.l?n:(i(),n=r(Math.max(l+1,t)))},a=function(){return i(),Ls(e)},o=function(l){i(),n=l,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function eu(e,t,r){var n=Cr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function aT(e,t,r){var n=Cr(e);return n.s=eu(n.s,t.s,r),n.e=eu(n.e,t.s,r),n}function tu(e,t){if(e.cRel&&e.c<0)for(e=Cr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Cr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Be(e);return!e.cRel&&e.cRel!=null&&(r=RU(r)),!e.rRel&&e.rRel!=null&&(r=CU(r)),r}function ag(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+rr(e.s.c)+":"+(e.e.cRel?"":"$")+rr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ir(e.s.r)+":"+(e.e.rRel?"":"$")+Ir(e.e.r):tu(e.s,t.biff)+":"+tu(e.e,t.biff)}function oy(e){return parseInt(IU(e),10)-1}function Ir(e){return""+(e+1)}function CU(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function IU(e){return e.replace(/\$(\d+)$/,"$1")}function cy(e){for(var t=bU(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function rr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function RU(e){return e.replace(/^([A-Z])/,"$$$1")}function bU(e){return e.replace(/^\$([A-Z])/,"$1")}function FU(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function sn(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Be(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Zc(e){var t=e.indexOf(":");return t==-1?{s:sn(e),e:sn(e)}:{s:sn(e.slice(0,t)),e:sn(e.slice(t+1))}}function nt(e,t){return typeof t>"u"||typeof t=="number"?nt(e.s,e.e):(typeof e!="string"&&(e=Be(e)),typeof t!="string"&&(t=Be(t)),e==t?e:e+":"+t)}function Vt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function oT(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ti(e.z,r?cn(t):t)}catch{}try{return e.w=ti((e.XF||{}).numFmtId||(r?14:0),r?cn(t):t)}catch{return""+t}}function xs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Io[e.v]||e.v:t==null?oT(e,e.v):oT(e,t))}function Sa(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Ib(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?sn(n.origin):n.origin;a=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Vt(s["!ref"]);l.s.c=u.s.c,l.s.r=u.s.r,l.e.c=Math.max(l.e.c,u.e.c),l.e.r=Math.max(l.e.r,u.e.r),a==-1&&(l.e.r=a=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[f].length;++d)if(!(typeof t[f][d]>"u")){var p={v:t[f][d]},g=a+f,m=o+d;if(l.s.r>g&&(l.s.r=g),l.s.c>m&&(l.s.c=m),l.e.r<g&&(l.e.r=g),l.e.c<m&&(l.e.c=m),t[f][d]&&typeof t[f][d]=="object"&&!Array.isArray(t[f][d])&&!(t[f][d]instanceof Date))p=t[f][d];else if(Array.isArray(p.v)&&(p.f=t[f][d][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||$e[14],n.cellDates?(p.t="d",p.w=ti(p.z,cn(p.v))):(p.t="n",p.v=cn(p.v),p.w=ti(p.z,p.v))):p.t="s";if(i)s[g]||(s[g]=[]),s[g][m]&&s[g][m].z&&(p.z=s[g][m].z),s[g][m]=p;else{var v=Be({c:m,r:g});s[v]&&s[v].z&&(p.z=s[v].z),s[v]=p}}}return l.s.c<1e7&&(s["!ref"]=nt(l)),s}function el(e,t){return Ib(null,e,t)}function PU(e){return e.read_shift(4,"i")}function Wr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function NU(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ly(e,t){var r=e.l,n=e.read_shift(1),i=Wr(e),s=[],a={t:i,h:i};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)s.push(NU(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}var DU=ly;function ri(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ko(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var OU=Wr;function uy(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var LU=Wr,av=uy;function fy(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?f0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Na(t,0)>>2;return r?i/100:i}function Rb(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Co=Rb;function Ur(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function MU(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var l=Ka[i];l&&(t.rgb=Qu(l));break;case 2:t.rgb=Qu([a,o,c]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function VU(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function bb(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function jU(e){return bb(e,1)}function BU(e){return bb(e,2)}var hy=2,pn=3,yh=11,cT=12,h0=19,Eh=64,UU=65,$U=71,HU=4108,zU=4126,lr=80,Fb=81,WU=[lr,Fb],GU={1:{n:"CodePage",t:hy},2:{n:"Category",t:lr},3:{n:"PresentationFormat",t:lr},4:{n:"ByteCount",t:pn},5:{n:"LineCount",t:pn},6:{n:"ParagraphCount",t:pn},7:{n:"SlideCount",t:pn},8:{n:"NoteCount",t:pn},9:{n:"HiddenCount",t:pn},10:{n:"MultimediaClipCount",t:pn},11:{n:"ScaleCrop",t:yh},12:{n:"HeadingPairs",t:HU},13:{n:"TitlesOfParts",t:zU},14:{n:"Manager",t:lr},15:{n:"Company",t:lr},16:{n:"LinksUpToDate",t:yh},17:{n:"CharacterCount",t:pn},19:{n:"SharedDoc",t:yh},22:{n:"HyperlinksChanged",t:yh},23:{n:"AppVersion",t:pn,p:"version"},24:{n:"DigSig",t:UU},26:{n:"ContentType",t:lr},27:{n:"ContentStatus",t:lr},28:{n:"Language",t:lr},29:{n:"Version",t:lr},255:{},2147483648:{n:"Locale",t:h0},2147483651:{n:"Behavior",t:h0},1919054434:{}},qU={1:{n:"CodePage",t:hy},2:{n:"Title",t:lr},3:{n:"Subject",t:lr},4:{n:"Author",t:lr},5:{n:"Keywords",t:lr},6:{n:"Comments",t:lr},7:{n:"Template",t:lr},8:{n:"LastAuthor",t:lr},9:{n:"RevNumber",t:lr},10:{n:"EditTime",t:Eh},11:{n:"LastPrinted",t:Eh},12:{n:"CreatedDate",t:Eh},13:{n:"ModifiedDate",t:Eh},14:{n:"PageCount",t:pn},15:{n:"WordCount",t:pn},16:{n:"CharCount",t:pn},17:{n:"Thumbnail",t:$U},18:{n:"Application",t:lr},19:{n:"DocSecurity",t:pn},255:{},2147483648:{n:"Locale",t:h0},2147483651:{n:"Behavior",t:h0},1919054434:{}},lT={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},KU=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function XU(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var YU=XU([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ka=Cr(YU),Io={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Pb={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},uT={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function QU(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function JU(e){var t=QU();if(!e||!e.match)return t;var r={};if((e.match(Yr)||[]).forEach(function(n){var i=De(n);switch(i[0].replace(aU,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[uT[i.ContentType]]!==void 0&&t[uT[i.ContentType]].push(i.PartName);break}}),t.xmlns!==vU.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var tc={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ov(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ru(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Yr)||[]).forEach(function(i){var s=De(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Nl(s.Target,t);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}var ZU="application/vnd.oasis.opendocument.spreadsheet";function e$(e,t){for(var r=sy(e),n,i;n=Xu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=De(n[0],!1),i.path=="/"&&i.type!==ZU)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var nu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],t$=function(){for(var e=new Array(nu.length),t=0;t<nu.length;++t){var r=nu[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Nb(e){var t={};e=gt(e);for(var r=0;r<nu.length;++r){var n=nu[r],i=e.match(t$[r]);i!=null&&i.length>0&&(t[n[1]]=st(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=dr(t[n[1]]))}return t}var r$=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Db(e,t,r,n){var i=[];if(typeof e=="string")i=eT(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(u){return{v:u}}));var a=typeof t=="string"?eT(t,n).map(function(u){return u.v}):t,o=0,c=0;if(a.length>0)for(var l=0;l!==i.length;l+=2){switch(c=+i[l+1].v,i[l].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=a.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=c,r.DefinedNames=a.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=a.slice(o,o+c);break}o+=c}}function n$(e,t,r){var n={};return t||(t={}),e=gt(e),r$.forEach(function(i){var s=(e.match(Ku(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=st(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var a=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Db(n.HeadingPairs,n.TitlesOfParts,t,r),t}var i$=/<[^>]+>[^<]*/g;function s$(e,t){var r={},n="",i=e.match(i$);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=De(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=st(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var c=a.split(">"),l=c[0].slice(4),u=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":r[n]=st(u);break;case"bool":r[n]=St(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=dr(u);break;case"cy":case"error":r[n]=st(u);break;default:if(l.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",a,l,c)}}else if(a.slice(0,2)!=="</"){if(t.WTF)throw new Error(a)}}}return r}var a$={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},og;function o$(e,t,r){og||(og=ry(a$)),t=og[t]||t,e[t]=r}function dy(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Ob(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function Lb(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function Mb(e,t,r){return t===31?Lb(e):Ob(e,t,r)}function cv(e,t,r){return Mb(e,t,r===!1?0:4)}function c$(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Mb(e,t,0)}function l$(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(on,""),e.l-i&2&&(e.l+=2)}return r}function u$(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(on,"");return r}function f$(e){var t=e.l,r=d0(e,Fb);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=d0(e,pn);return[r,n]}function h$(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(f$(e));return r}function fT(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),a=e.read_shift(4);n[s]=e.read_shift(a,t===1200?"utf16le":"utf8").replace(on,"").replace(Pl,"!"),t===1200&&a%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function Vb(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function d$(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function d0(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==cT&&n!==t&&WU.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===cT?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return Ob(e,n,4).replace(on,"");case 31:return Lb(e);case 64:return dy(e);case 65:return Vb(e);case 71:return d$(e);case 80:return cv(e,n,!s.raw).replace(on,"");case 81:return c$(e,n).replace(on,"");case 4108:return h$(e);case 4126:case 4127:return n==4127?l$(e):u$(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function hT(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],a=0,o=0,c=-1,l={};for(a=0;a!=i;++a){var u=e.read_shift(4),f=e.read_shift(4);s[a]=[u,f+r]}s.sort(function(x,y){return x[1]-y[1]});var d={};for(a=0;a!=i;++a){if(e.l!==s[a][1]){var p=!0;if(a>0&&t)switch(t[s[a-1][0]].t){case 2:e.l+2===s[a][1]&&(e.l+=2,p=!1);break;case 80:e.l<=s[a][1]&&(e.l=s[a][1],p=!1);break;case 4108:e.l<=s[a][1]&&(e.l=s[a][1],p=!1);break}if((!t||a==0)&&e.l<=s[a][1]&&(p=!1,e.l=s[a][1]),p)throw new Error("Read Error: Expected address "+s[a][1]+" at "+e.l+" :"+a)}if(t){var g=t[s[a][0]];if(d[g.n]=d0(e,g.t,{raw:!0}),g.p==="version"&&(d[g.n]=String(d[g.n]>>16)+"."+("0000"+String(d[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(d[g.n]){case 0:d[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ui(o=d[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[g.n])}}else if(s[a][0]===1){if(o=d.CodePage=d0(e,hy),ui(o),c!==-1){var m=e.l;e.l=s[c][1],l=fT(e,o),e.l=m}}else if(s[a][0]===0){if(o===0){c=a,e.l=s[a+1][1];continue}l=fT(e,o)}else{var v=l[s[a][0]],_;switch(e[e.l]){case 65:e.l+=4,_=Vb(e);break;case 30:e.l+=4,_=cv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,_=cv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=Bt(e,4);break;case 64:e.l+=4,_=dr(dy(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[v]=_}}return e.l=r+n,d}function dT(e,t,r){var n=e.content;if(!n)return{};yr(n,0);var i,s,a,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),u=n.read_shift(16);if(u!==tt.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),c=n.read_shift(4));var f=hT(n,t),d={SystemIdentifier:l};for(var p in f)d[p]=f[p];if(d.FMTID=s,i===1)return d;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var g;try{g=hT(n,null)}catch{}for(p in g)d[p]=g[p];return d.FMTID=[s,a],d}function As(e,t){return e.read_shift(t),null}function p$(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Bt(e,t){return e.read_shift(t)===1}function qt(e){return e.read_shift(2,"u")}function jb(e,t){return p$(e,t,qt)}function m$(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Mf(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return a}function g$(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,c={};i&&(a=e.read_shift(2)),n&&(o=e.read_shift(4));var l=s==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,l);return i&&(e.l+=4*a),n&&(e.l+=o),c.t=u,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function uo(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Vf(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):uo(e,n,r)}function Ro(e,t,r){if(r.biff>5)return Vf(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function v$(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function x$(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(on,"");return n&&(e.l+=24),i}function _$(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=e.read_shift(s>>1,"utf16le").replace(on,"");return r+a}function y$(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return x$(e);case"0303000000000000c000000000000046":return _$(e);default:throw new Error("Unsupported Moniker "+r)}}function wh(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(on,""):"";return r}function E$(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,a,o,c,l="",u,f;i&16&&(s=wh(e,r-e.l)),i&128&&(a=wh(e,r-e.l)),(i&257)===257&&(o=wh(e,r-e.l)),(i&257)===1&&(c=y$(e,r-e.l)),i&8&&(l=wh(e,r-e.l)),i&32&&(u=e.read_shift(16)),i&64&&(f=dy(e)),e.l=r;var d=a||o||c||"";d&&l&&(d+="#"+l),d||(d="#"+l),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var p={Target:d};return u&&(p.guid=u),f&&(p.time=f),s&&(p.Tooltip=s),p}function Bb(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function Ub(e,t){var r=Bb(e);return r[3]=0,r}function Xi(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function w$(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function T$(e,t,r){return t===0?"":Ro(e,t,r)}function S$(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[i,s,a]}function $b(e){var t=e.read_shift(2),r=fy(e);return[t,r]}function A$(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=Mf(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function Fp(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function Hb(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var k$=Hb;function zb(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function C$(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function I$(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Dr(e){e.l+=2,e.l+=e.read_shift(2)}var R$={0:Dr,4:Dr,5:Dr,6:Dr,7:I$,8:Dr,9:Dr,10:Dr,11:Dr,12:Dr,13:C$,14:Dr,15:Dr,16:Dr,17:Dr,18:Dr,19:Dr,20:Dr,21:zb};function b$(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(R$[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Th(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function F$(e,t){return t===0||e.read_shift(2),1200}function P$(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Ro(e,0,r);return e.read_shift(t+n-e.l),i}function N$(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function D$(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Mf(e,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function O$(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],a=0;a!=i&&e.l<r;++a)s.push(g$(e));return s.Count=n,s.Unique=i,s}function L$(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function M$(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function V$(e){var t=w$(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function j$(e){return e.read_shift(2),e.read_shift(4)}function pT(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function B$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:c,TabRatio:l}}function U$(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function $$(){}function H$(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Mf(e,0,r),n}function z$(e){var t=Xi(e);return t.isst=e.read_shift(4),t}function W$(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=Xi(e);r.biff==2&&e.l++;var s=Vf(e,n-e.l,r);return i.val=s,i}function G$(e,t,r){var n=e.read_shift(2),i=Ro(e,0,r);return[n,i]}var q$=Ro;function mT(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),a=e.read_shift(i),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:a,c}}}function K$(e){var t=e.read_shift(2),r=e.read_shift(2),n=$b(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function X$(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push($b(e));if(e.l!==r)throw new Error("MulRK read error");var a=e.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function Y$(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var a=e.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function Q$(e,t,r,n){var i={},s=e.read_shift(4),a=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return i.patternType=KU[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=c&127,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}function J$(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Q$(e,t,n.fStyle,r),n}function Z$(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function gT(e,t,r){var n=Xi(e);(r.biff==2||t==9)&&++e.l;var i=m$(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function eH(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Xi(e),i=Ur(e);return n.val=i,n}var vT=T$;function tH(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=uo(e,s),o=[];n>e.l;)o.push(Vf(e));return[s,i,a,o]}function xT(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=A$(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var rH=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function _T(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),a=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var l=uo(e,a,r);i&32&&(l=rH[l.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var f=n==e.l||o===0||!(u>0)?[]:MG(e,u,r,o);return{chKey:s,Name:l,itab:c,rgce:f}}function Wb(e,t,r){if(r.biff<8)return nH(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(S$(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function nH(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Mf(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function iH(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=uo(e,n,r),a=uo(e,i,r);return[s,a]}function sH(e,t,r){var n=Hb(e);e.l++;var i=e.read_shift(1);return t-=8,[VG(e,t,r),i,n]}function yT(e,t,r){var n=k$(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,OG(e,t,r)]}function aH(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function oH(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=Ro(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,a,s]}}function cH(e,t,r){return oH(e,t,r)}function lH(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Fp(e));return r}function uH(e,t,r){if(r&&r.biff<8)return hH(e,t,r);var n=zb(e),i=b$(e,t-22,n[1]);return{cmo:n,ft:i}}var fH={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function hH(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var a=[];return a.push((fH[n]||Xr)(e,t,r)),{cmo:[i,n,s],ft:a}}function dH(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:a=v$(e,6,r);var o=e.read_shift(2);e.read_shift(2),qt(e,2);var c=e.read_shift(2);e.l+=c;for(var l=1;l<e.lens.length-1;++l){if(e.l-n!=e.lens[l])throw new Error("TxO: bad continue record");var u=e[e.l],f=uo(e,e.lens[l+1]-e.lens[l]-1);if(i+=f,i.length>=(u?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function pH(e,t){var r=Fp(e);e.l+=16;var n=E$(e,t-24);return[r,n]}function mH(e,t){e.read_shift(2);var r=Fp(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(on,""),[r,n]}function gH(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=lT[r]||r,r=e.read_shift(2),t[1]=lT[r]||r,t}function vH(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Ub(e));return r}function xH(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Ub(e));return r}function _H(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Gb(e,t,r){if(!r.cellStyles)return Xr(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var l={s:i,e:s,w:a,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(l.level=c>>8&7),l}function yH(e,t){var r={};return t<32||(e.l+=16,r.header=Ur(e),r.footer=Ur(e),e.l+=2),r}function EH(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var wH=Xi,TH=jb,SH=Vf;function AH(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function kH(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Xi(e);++e.l;var i=Ro(e,t-7,r);return n.t="str",n.val=i,n}function CH(e){var t=Xi(e);++e.l;var r=Ur(e);return t.t="n",t.val=r,t}function IH(e){var t=Xi(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function RH(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function bH(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function FH(e,t,r){var n=e.l+t,i=Xi(e),s=e.read_shift(2),a=uo(e,s,r);return e.l=n,i.t="str",i.val=a,i}var PH=[2,3,48,49,131,139,140,245],ET=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ry({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var l=[],u=ha(1);switch(c.type){case"base64":u=li(Vn(o));break;case"binary":u=li(o);break;case"buffer":case"array":u=o;break}yr(u,0);var f=u.read_shift(1),d=!!(f&136),p=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,d=!0;break;case 49:p=!0,d=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,v=521;f==2&&(m=u.read_shift(2)),u.l+=3,f!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(v=u.read_shift(2));var _=u.read_shift(2),x=c.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(x=e[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var y=[],w={},T=Math.min(u.length,f==2?521:v-10-(p?264:0)),S=g?32:11;u.l<T&&u[u.l]!=13;)switch(w={},w.name=Os.utils.decode(x,u.slice(u.l,u.l+S)).replace(/[\u0000\r\n].*$/g,""),u.l+=S,w.type=String.fromCharCode(u.read_shift(1)),f!=2&&!g&&(w.offset=u.read_shift(4)),w.len=u.read_shift(1),f==2&&(w.offset=u.read_shift(2)),w.dec=u.read_shift(1),w.name.length&&y.push(w),f!=2&&(u.l+=g?13:14),w.type){case"B":(!p||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(u[u.l]!==13&&(u.l=v-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=v;var E=0,k=0;for(l[0]=[],k=0;k!=y.length;++k)l[0][k]=y[k].name;for(;m-- >0;){if(u[u.l]===42){u.l+=_;continue}for(++u.l,l[++E]=[],k=0,k=0;k!=y.length;++k){var b=u.slice(u.l,u.l+y[k].len);u.l+=y[k].len,yr(b,0);var j=Os.utils.decode(x,b);switch(y[k].type){case"C":j.trim().length&&(l[E][k]=j.replace(/\s+$/,""));break;case"D":j.length===8?l[E][k]=new Date(+j.slice(0,4),+j.slice(4,6)-1,+j.slice(6,8)):l[E][k]=j;break;case"F":l[E][k]=parseFloat(j.trim());break;case"+":case"I":l[E][k]=g?b.read_shift(-4,"i")^2147483648:b.read_shift(4,"i");break;case"L":switch(j.trim().toUpperCase()){case"Y":case"T":l[E][k]=!0;break;case"N":case"F":l[E][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+j+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));l[E][k]="##MEMO##"+(g?parseInt(j.trim(),10):b.read_shift(4));break;case"N":j=j.replace(/\u0000/g,"").trim(),j&&j!="."&&(l[E][k]=+j||0);break;case"@":l[E][k]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":l[E][k]=new Date((b.read_shift(4)-2440588)*864e5+b.read_shift(4));break;case"Y":l[E][k]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[E][k]=-b.read_shift(-8,"f");break;case"B":if(p&&y[k].len==8){l[E][k]=b.read_shift(8,"f");break}case"G":case"P":b.l+=y[k].len;break;case"0":if(y[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[k].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=y,l}function n(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var u=el(r(o,l),l);return u["!cols"]=l.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete l.DBF,u}function i(o,c){try{return Sa(n(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var l=c||{};if(+l.codepage>=0&&ui(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var u=sv(),f=mv(o,{header:1,raw:!0,cellDates:!0}),d=f[0],p=f.slice(1),g=o["!cols"]||[],m=0,v=0,_=0,x=1;for(m=0;m<d.length;++m){if(((g[m]||{}).DBF||{}).name){d[m]=g[m].DBF.name,++_;continue}if(d[m]!=null){if(++_,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(v=0;v<1024;++v)if(d.indexOf(d[m]+"_"+v)==-1){d[m]+="_"+v;break}}}}var y=Vt(o["!ref"]),w=[],T=[],S=[];for(m=0;m<=y.e.c-y.s.c;++m){var E="",k="",b=0,j=[];for(v=0;v<p.length;++v)p[v][m]!=null&&j.push(p[v][m]);if(j.length==0||d[m]==null){w[m]="?";continue}for(v=0;v<j.length;++v){switch(typeof j[v]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=j[v]instanceof Date?"D":"C";break;default:k="C"}b=Math.max(b,String(j[v]).length),E=E&&E!=k?"C":k}b>250&&(b=250),k=((g[m]||{}).DBF||{}).type,k=="C"&&g[m].DBF.len>b&&(b=g[m].DBF.len),E=="B"&&k=="N"&&(E="N",S[m]=g[m].DBF.dec,b=g[m].DBF.len),T[m]=E=="C"||k=="N"?b:s[E]||0,x+=T[m],w[m]=E}var H=u.next(32);for(H.write_shift(4,318902576),H.write_shift(4,p.length),H.write_shift(2,296+32*_),H.write_shift(2,x),m=0;m<4;++m)H.write_shift(4,0);for(H.write_shift(4,0|(+t[z4]||3)<<8),m=0,v=0;m<d.length;++m)if(d[m]!=null){var O=u.next(32),V=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);O.write_shift(1,V,"sbcs"),O.write_shift(1,w[m]=="?"?"C":w[m],"sbcs"),O.write_shift(4,v),O.write_shift(1,T[m]||s[w[m]]||0),O.write_shift(1,S[m]||0),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(1,0),O.write_shift(4,0),O.write_shift(4,0),v+=T[m]||s[w[m]]||0}var G=u.next(264);for(G.write_shift(4,13),m=0;m<65;++m)G.write_shift(4,0);for(m=0;m<p.length;++m){var X=u.next(x);for(X.write_shift(1,0),v=0;v<d.length;++v)if(d[v]!=null)switch(w[v]){case"L":X.write_shift(1,p[m][v]==null?63:p[m][v]?84:70);break;case"B":X.write_shift(8,p[m][v]||0,"f");break;case"N":var Z="0";for(typeof p[m][v]=="number"&&(Z=p[m][v].toFixed(S[v]||0)),_=0;_<T[v]-Z.length;++_)X.write_shift(1,32);X.write_shift(1,Z,"sbcs");break;case"D":p[m][v]?(X.write_shift(4,("0000"+p[m][v].getFullYear()).slice(-4),"sbcs"),X.write_shift(2,("00"+(p[m][v].getMonth()+1)).slice(-2),"sbcs"),X.write_shift(2,("00"+p[m][v].getDate()).slice(-2),"sbcs")):X.write_shift(8,"00000000","sbcs");break;case"C":var ie=String(p[m][v]!=null?p[m][v]:"").slice(0,T[v]);for(X.write_shift(1,ie,"sbcs"),_=0;_<T[v]-ie.length;++_)X.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),NH=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+zi(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,p){var g=e[p];return typeof g=="number"?M2(g):g},n=function(d,p,g){var m=p.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?d:M2(m)};e["|"]=254;function i(d,p){switch(p.type){case"base64":return s(Vn(d),p);case"binary":return s(d,p);case"buffer":return s(Je&&Buffer.isBuffer(d)?d.toString("binary"):Ao(d),p);case"array":return s(lo(d),p)}throw new Error("Unrecognized type "+p.type)}function s(d,p){var g=d.split(/[\n\r]+/),m=-1,v=-1,_=0,x=0,y=[],w=[],T=null,S={},E=[],k=[],b=[],j=0,H;for(+p.codepage>=0&&ui(+p.codepage);_!==g.length;++_){j=0;var O=g[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),V=O.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),G=V[0],X;if(O.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&w.push(O.slice(3).replace(/;;/g,";"));break;case"C":var Z=!1,ie=!1,re=!1,B=!1,ae=-1,xe=-1;for(x=1;x<V.length;++x)switch(V[x].charAt(0)){case"A":break;case"X":v=parseInt(V[x].slice(1))-1,ie=!0;break;case"Y":for(m=parseInt(V[x].slice(1))-1,ie||(v=0),H=y.length;H<=m;++H)y[H]=[];break;case"K":X=V[x].slice(1),X.charAt(0)==='"'?X=X.slice(1,X.length-1):X==="TRUE"?X=!0:X==="FALSE"?X=!1:isNaN(pi(X))?isNaN(Dc(X).getDate())||(X=dr(X)):(X=pi(X),T!==null&&Jc(T)&&(X=bp(X))),Z=!0;break;case"E":B=!0;var I=mc(V[x].slice(1),{r:m,c:v});y[m][v]=[y[m][v],I];break;case"S":re=!0,y[m][v]=[y[m][v],"S5S"];break;case"G":break;case"R":ae=parseInt(V[x].slice(1))-1;break;case"C":xe=parseInt(V[x].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+O)}if(Z&&(y[m][v]&&y[m][v].length==2?y[m][v][0]=X:y[m][v]=X,T=null),re){if(B)throw new Error("SYLK shared formula cannot have own formula");var W=ae>-1&&y[ae][xe];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");y[m][v][1]=rF(W[1],{r:m-ae,c:v-xe})}break;case"F":var z=0;for(x=1;x<V.length;++x)switch(V[x].charAt(0)){case"X":v=parseInt(V[x].slice(1))-1,++z;break;case"Y":for(m=parseInt(V[x].slice(1))-1,H=y.length;H<=m;++H)y[H]=[];break;case"M":j=parseInt(V[x].slice(1))/20;break;case"F":break;case"G":break;case"P":T=w[parseInt(V[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(b=V[x].slice(1).split(" "),H=parseInt(b[0],10);H<=parseInt(b[1],10);++H)j=parseInt(b[2],10),k[H-1]=j===0?{hidden:!0}:{wch:j},Oc(k[H-1]);break;case"C":v=parseInt(V[x].slice(1))-1,k[v]||(k[v]={});break;case"R":m=parseInt(V[x].slice(1))-1,E[m]||(E[m]={}),j>0?(E[m].hpt=j,E[m].hpx=Ju(j)):j===0&&(E[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+O)}z<1&&(T=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+O)}}return E.length>0&&(S["!rows"]=E),k.length>0&&(S["!cols"]=k),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,S]}function a(d,p){var g=i(d,p),m=g[0],v=g[1],_=el(m,p);return zi(v).forEach(function(x){_[x]=v[x]}),_}function o(d,p){return Sa(a(d,p),p)}function c(d,p,g,m){var v="C;Y"+(g+1)+";X"+(m+1)+";K";switch(d.t){case"n":v+=d.v||0,d.f&&!d.F&&(v+=";E"+_W(d.f,{r:g,c:m}));break;case"b":v+=d.v?"TRUE":"FALSE";break;case"e":v+=d.w||d.v;break;case"d":v+='"'+(d.w||d.v)+'"';break;case"s":v+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function l(d,p){p.forEach(function(g,m){var v="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?v+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=m0(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=g0(g.wpx)),typeof g.wch=="number"&&(v+=Math.round(g.wch))),v.charAt(v.length-1)!=" "&&d.push(v)})}function u(d,p){p.forEach(function(g,m){var v="F;";g.hidden?v+="M0;":g.hpt?v+="M"+20*g.hpt+";":g.hpx&&(v+="M"+20*Zb(g.hpx)+";"),v.length>2&&d.push(v+"R"+(m+1))})}function f(d,p){var g=["ID;PWXL;N;E"],m=[],v=Vt(d["!ref"]),_,x=Array.isArray(d),y=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),d["!cols"]&&l(g,d["!cols"]),d["!rows"]&&u(g,d["!rows"]),g.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var w=v.s.r;w<=v.e.r;++w)for(var T=v.s.c;T<=v.e.c;++T){var S=Be({r:w,c:T});_=x?(d[w]||[])[T]:d[S],!(!_||_.v==null&&(!_.f||_.F))&&m.push(c(_,d,w,T))}return g.join(y)+y+m.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),DH=function(){function e(s,a){switch(a.type){case"base64":return t(Vn(s),a);case"binary":return t(s,a);case"buffer":return t(Je&&Buffer.isBuffer(s)?s.toString("binary"):Ao(s),a);case"array":return t(lo(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),c=-1,l=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++c]=[],l=0;continue}if(!(c<0)){var d=o[u].trim().split(","),p=d[0],g=d[1];++u;for(var m=o[u]||"";(m.match(/["]/g)||[]).length&1&&u<o.length-1;)m+=`
`+o[++u];switch(m=m.trim(),+p){case-1:if(m==="BOT"){f[++c]=[],l=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[c][l]=!0:m==="FALSE"?f[c][l]=!1:isNaN(pi(g))?isNaN(Dc(g).getDate())?f[c][l]=g:f[c][l]=dr(g):f[c][l]=pi(g),++l;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[c][l++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(s,a){return el(e(s,a),a)}function n(s,a){return Sa(r(s,a),a)}var i=function(){var s=function(c,l,u,f,d){c.push(l),c.push(u+","+f),c.push('"'+d.replace(/"/g,'""')+'"')},a=function(c,l,u,f){c.push(l+","+u),c.push(l==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var l=[],u=Vt(c["!ref"]),f,d=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,u.e.r-u.s.r+1,""),s(l,"TUPLES",0,u.e.c-u.s.c+1,""),s(l,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){a(l,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var m=Be({r:p,c:g});if(f=d?(c[p]||[])[g]:c[m],!f){a(l,1,0,"");continue}switch(f.t){case"n":var v=f.w;!v&&f.v!=null&&(v=f.v),v==null?f.f&&!f.F?a(l,1,0,"="+f.f):a(l,1,0,""):a(l,0,v,"V");break;case"b":a(l,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(l,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=ti(f.z||$e[14],cn(dr(f.v)))),a(l,0,f.w,"V");break;default:a(l,1,0,"")}}}a(l,-1,0,"EOD");var _=`\r
`,x=l.join(_);return x}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),OH=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,d){for(var p=f.split(`
`),g=-1,m=-1,v=0,_=[];v!==p.length;++v){var x=p[v].trim().split(":");if(x[0]==="cell"){var y=sn(x[1]);if(_.length<=y.r)for(g=_.length;g<=y.r;++g)_[g]||(_[g]=[]);switch(g=y.r,m=y.c,x[2]){case"t":_[g][m]=e(x[3]);break;case"v":_[g][m]=+x[3];break;case"vtf":var w=x[x.length-1];case"vtc":switch(x[3]){case"nl":_[g][m]=!!+x[4];break;default:_[g][m]=+x[4];break}x[2]=="vtf"&&(_[g][m]=[_[g][m],w])}}}return d&&d.sheetRows&&(_=_.slice(0,d.sheetRows)),_}function n(f,d){return el(r(f,d),d)}function i(f,d){return Sa(n(f,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(f){if(!f||!f["!ref"])return"";for(var d=[],p=[],g,m="",v=Zc(f["!ref"]),_=Array.isArray(f),x=v.s.r;x<=v.e.r;++x)for(var y=v.s.c;y<=v.e.c;++y)if(m=Be({r:x,c:y}),g=_?(f[x]||[])[y]:f[m],!(!g||g.v==null||g.t==="z")){switch(p=["cell",m,"t"],g.t){case"s":case"str":p.push(t(g.v));break;case"n":g.f?(p[2]="vtf",p[3]="n",p[4]=g.v,p[5]=t(g.f)):(p[2]="v",p[3]=g.v);break;case"b":p[2]="vt"+(g.f?"f":"c"),p[3]="nl",p[4]=g.v?"1":"0",p[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var w=cn(dr(g.v));p[2]="vtc",p[3]="nd",p[4]=""+w,p[5]=g.w||ti(g.z||$e[14],w);break;case"e":continue}d.push(p.join(":"))}return d.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(f){return[s,a,o,a,l(f),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),Yu=function(){function e(u,f,d,p,g){g.raw?f[d][p]=u:u===""||(u==="TRUE"?f[d][p]=!0:u==="FALSE"?f[d][p]=!1:isNaN(pi(u))?isNaN(Dc(u).getDate())?f[d][p]=u:f[d][p]=dr(u):f[d][p]=pi(u))}function t(u,f){var d=f||{},p=[];if(!u||u.length===0)return p;for(var g=u.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var v=10,_=0,x=0;x<=m;++x)_=g[x].indexOf(" "),_==-1?_=g[x].length:_++,v=Math.max(v,_);for(x=0;x<=m;++x){p[x]=[];var y=0;for(e(g[x].slice(0,v).trim(),p,x,y,d),y=1;y<=(g[x].length-v)/10+1;++y)e(g[x].slice(v+(y-1)*10,v+y*10).trim(),p,x,y,d)}return d.sheetRows&&(p=p.slice(0,d.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var f={},d=!1,p=0,g=0;p<u.length;++p)(g=u.charCodeAt(p))==34?d=!d:!d&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&g.push([f[p],p]);if(!g.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&g.push([f[p],p])}return g.sort(function(m,v){return m[0]-v[0]||n[m[1]]-n[v[1]]}),r[g.pop()[1]]||44}function s(u,f){var d=f||{},p="",g=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=i(u.slice(0,1024)):d&&d.FS?p=d.FS:p=i(u.slice(0,1024));var v=0,_=0,x=0,y=0,w=0,T=p.charCodeAt(0),S=!1,E=0,k=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var b=d.dateNF!=null?q7(d.dateNF):null;function j(){var H=u.slice(y,w),O={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)O.t="z";else if(d.raw)O.t="s",O.v=H;else if(H.trim().length===0)O.t="s",O.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(O.t="s",O.v=H.slice(2,-1).replace(/""/g,'"')):EW(H)?(O.t="n",O.f=H.slice(1)):(O.t="s",O.v=H);else if(H=="TRUE")O.t="b",O.v=!0;else if(H=="FALSE")O.t="b",O.v=!1;else if(!isNaN(x=pi(H)))O.t="n",d.cellText!==!1&&(O.w=H),O.v=x;else if(!isNaN(Dc(H).getDate())||b&&H.match(b)){O.z=d.dateNF||$e[14];var V=0;b&&H.match(b)&&(H=K7(H,d.dateNF,H.match(b)||[]),V=1),d.cellDates?(O.t="d",O.v=dr(H,V)):(O.t="n",O.v=cn(dr(H,V))),d.cellText!==!1&&(O.w=ti(O.z,O.v instanceof Date?cn(O.v):O.v)),d.cellNF||delete O.z}else O.t="s",O.v=H;if(O.t=="z"||(d.dense?(g[v]||(g[v]=[]),g[v][_]=O):g[Be({c:_,r:v})]=O),y=w+1,k=u.charCodeAt(y),m.e.c<_&&(m.e.c=_),m.e.r<v&&(m.e.r=v),E==T)++_;else if(_=0,++v,d.sheetRows&&d.sheetRows<=v)return!0}e:for(;w<u.length;++w)switch(E=u.charCodeAt(w)){case 34:k===34&&(S=!S);break;case T:case 10:case 13:if(!S&&j())break e;break}return w-y>0&&j(),g["!ref"]=nt(m),g}function a(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,f):el(t(u,f),f)}function o(u,f){var d="",p=f.type=="string"?[0,0,0,0]:Ey(u,f);switch(f.type){case"base64":d=Vn(u);break;case"binary":d=u;break;case"buffer":f.codepage==65001?d=u.toString("utf8"):f.codepage&&typeof Os<"u"?d=Os.utils.decode(f.codepage,u):d=Je&&Buffer.isBuffer(u)?u.toString("binary"):Ao(u);break;case"array":d=lo(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?d=gt(d.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?d=gt(d):f.type=="binary"&&typeof Os<"u"&&f.codepage&&(d=Os.utils.decode(f.codepage,Os.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?OH.to_sheet(f.type=="string"?d:gt(d),f):a(d,f)}function c(u,f){return Sa(o(u,f),f)}function l(u){for(var f=[],d=Vt(u["!ref"]),p,g=Array.isArray(u),m=d.s.r;m<=d.e.r;++m){for(var v=[],_=d.s.c;_<=d.e.c;++_){var x=Be({r:m,c:_});if(p=g?(u[m]||[])[_]:u[x],!p||p.v==null){v.push("          ");continue}for(var y=(p.w||(xs(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";v.push(y+(_===0?" ":""))}f.push(v.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();function LH(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=NH.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Yu.to_workbook(e,t)}}var iu=function(){function e(I,W,z){if(I){yr(I,I.l||0);for(var U=z.Enum||ae;I.l<I.length;){var ee=I.read_shift(2),oe=U[ee]||U[65535],me=I.read_shift(2),de=I.l+me,ce=oe.f&&oe.f(I,me,z);if(I.l=de,W(ce,oe,ee))return}}}function t(I,W){switch(W.type){case"base64":return r(li(Vn(I)),W);case"binary":return r(li(I),W);case"buffer":case"array":return r(I,W)}throw"Unsupported type "+W.type}function r(I,W){if(!I)return I;var z=W||{},U=z.dense?[]:{},ee="Sheet1",oe="",me=0,de={},ce=[],ze=[],M={s:{r:0,c:0},e:{r:0,c:0}},dt=z.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)z.Enum=ae,e(I,function(P,q,te){switch(te){case 0:z.vers=P,P>=4096&&(z.qpro=!0);break;case 6:M=P;break;case 204:P&&(oe=P);break;case 222:oe=P;break;case 15:case 51:z.qpro||(P[1].v=P[1].v.slice(1));case 13:case 14:case 16:te==14&&(P[2]&112)==112&&(P[2]&15)>1&&(P[2]&15)<15&&(P[1].z=z.dateNF||$e[14],z.cellDates&&(P[1].t="d",P[1].v=bp(P[1].v))),z.qpro&&P[3]>me&&(U["!ref"]=nt(M),de[ee]=U,ce.push(ee),U=z.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},me=P[3],ee=oe||"Sheet"+(me+1),oe="");var ge=z.dense?(U[P[0].r]||[])[P[0].c]:U[Be(P[0])];if(ge){ge.t=P[1].t,ge.v=P[1].v,P[1].z!=null&&(ge.z=P[1].z),P[1].f!=null&&(ge.f=P[1].f);break}z.dense?(U[P[0].r]||(U[P[0].r]=[]),U[P[0].r][P[0].c]=P[1]):U[Be(P[0])]=P[1];break}},z);else if(I[2]==26||I[2]==14)z.Enum=xe,I[2]==14&&(z.qpro=!0,I.l=0),e(I,function(P,q,te){switch(te){case 204:ee=P;break;case 22:P[1].v=P[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(P[3]>me&&(U["!ref"]=nt(M),de[ee]=U,ce.push(ee),U=z.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},me=P[3],ee="Sheet"+(me+1)),dt>0&&P[0].r>=dt)break;z.dense?(U[P[0].r]||(U[P[0].r]=[]),U[P[0].r][P[0].c]=P[1]):U[Be(P[0])]=P[1],M.e.c<P[0].c&&(M.e.c=P[0].c),M.e.r<P[0].r&&(M.e.r=P[0].r);break;case 27:P[14e3]&&(ze[P[14e3][0]]=P[14e3][1]);break;case 1537:ze[P[0]]=P[1],P[0]==me&&(ee=P[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(U["!ref"]=nt(M),de[oe||ee]=U,ce.push(oe||ee),!ze.length)return{SheetNames:ce,Sheets:de};for(var qe={},Ze=[],We=0;We<ze.length;++We)de[ce[We]]?(Ze.push(ze[We]||ce[We]),qe[ze[We]]=de[ze[We]]||de[ce[We]]):(Ze.push(ze[We]),qe[ze[We]]={"!ref":"A1"});return{SheetNames:Ze,Sheets:qe}}function n(I,W){var z=W||{};if(+z.codepage>=0&&ui(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var U=sv(),ee=Vt(I["!ref"]),oe=Array.isArray(I),me=[];si(U,0,s(1030)),si(U,6,c(ee));for(var de=Math.min(ee.e.r,8191),ce=ee.s.r;ce<=de;++ce)for(var ze=Ir(ce),M=ee.s.c;M<=ee.e.c;++M){ce===ee.s.r&&(me[M]=rr(M));var dt=me[M]+ze,qe=oe?(I[ce]||[])[M]:I[dt];if(!(!qe||qe.t=="z"))if(qe.t=="n")(qe.v|0)==qe.v&&qe.v>=-32768&&qe.v<=32767?si(U,13,p(ce,M,qe.v)):si(U,14,m(ce,M,qe.v));else{var Ze=xs(qe);si(U,15,f(ce,M,Ze.slice(0,239)))}}return si(U,1),U.end()}function i(I,W){var z=W||{};if(+z.codepage>=0&&ui(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var U=sv();si(U,0,a(I));for(var ee=0,oe=0;ee<I.SheetNames.length;++ee)(I.Sheets[I.SheetNames[ee]]||{})["!ref"]&&si(U,27,B(I.SheetNames[ee],oe++));var me=0;for(ee=0;ee<I.SheetNames.length;++ee){var de=I.Sheets[I.SheetNames[ee]];if(!(!de||!de["!ref"])){for(var ce=Vt(de["!ref"]),ze=Array.isArray(de),M=[],dt=Math.min(ce.e.r,8191),qe=ce.s.r;qe<=dt;++qe)for(var Ze=Ir(qe),We=ce.s.c;We<=ce.e.c;++We){qe===ce.s.r&&(M[We]=rr(We));var P=M[We]+Ze,q=ze?(de[qe]||[])[We]:de[P];if(!(!q||q.t=="z"))if(q.t=="n")si(U,23,j(qe,We,me,q.v));else{var te=xs(q);si(U,22,E(qe,We,me,te.slice(0,239)))}}++me}}return si(U,1),U.end()}function s(I){var W=Zt(2);return W.write_shift(2,I),W}function a(I){var W=Zt(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var z=0,U=0,ee=0,oe=0;oe<I.SheetNames.length;++oe){var me=I.SheetNames[oe],de=I.Sheets[me];if(!(!de||!de["!ref"])){++ee;var ce=Zc(de["!ref"]);z<ce.e.r&&(z=ce.e.r),U<ce.e.c&&(U=ce.e.c)}}return z>8191&&(z=8191),W.write_shift(2,z),W.write_shift(1,ee),W.write_shift(1,U),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function o(I,W,z){var U={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&z.qpro?(U.s.c=I.read_shift(1),I.l++,U.s.r=I.read_shift(2),U.e.c=I.read_shift(1),I.l++,U.e.r=I.read_shift(2),U):(U.s.c=I.read_shift(2),U.s.r=I.read_shift(2),W==12&&z.qpro&&(I.l+=2),U.e.c=I.read_shift(2),U.e.r=I.read_shift(2),W==12&&z.qpro&&(I.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function c(I){var W=Zt(8);return W.write_shift(2,I.s.c),W.write_shift(2,I.s.r),W.write_shift(2,I.e.c),W.write_shift(2,I.e.r),W}function l(I,W,z){var U=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(U[0].c=I.read_shift(1),U[3]=I.read_shift(1),U[0].r=I.read_shift(2),I.l+=2):(U[2]=I.read_shift(1),U[0].c=I.read_shift(2),U[0].r=I.read_shift(2)),U}function u(I,W,z){var U=I.l+W,ee=l(I,W,z);if(ee[1].t="s",z.vers==20768){I.l++;var oe=I.read_shift(1);return ee[1].v=I.read_shift(oe,"utf8"),ee}return z.qpro&&I.l++,ee[1].v=I.read_shift(U-I.l,"cstr"),ee}function f(I,W,z){var U=Zt(7+z.length);U.write_shift(1,255),U.write_shift(2,W),U.write_shift(2,I),U.write_shift(1,39);for(var ee=0;ee<U.length;++ee){var oe=z.charCodeAt(ee);U.write_shift(1,oe>=128?95:oe)}return U.write_shift(1,0),U}function d(I,W,z){var U=l(I,W,z);return U[1].v=I.read_shift(2,"i"),U}function p(I,W,z){var U=Zt(7);return U.write_shift(1,255),U.write_shift(2,W),U.write_shift(2,I),U.write_shift(2,z,"i"),U}function g(I,W,z){var U=l(I,W,z);return U[1].v=I.read_shift(8,"f"),U}function m(I,W,z){var U=Zt(13);return U.write_shift(1,255),U.write_shift(2,W),U.write_shift(2,I),U.write_shift(8,z,"f"),U}function v(I,W,z){var U=I.l+W,ee=l(I,W,z);if(ee[1].v=I.read_shift(8,"f"),z.qpro)I.l=U;else{var oe=I.read_shift(2);w(I.slice(I.l,I.l+oe),ee),I.l+=oe}return ee}function _(I,W,z){var U=W&32768;return W&=-32769,W=(U?I:0)+(W>=8192?W-16384:W),(U?"":"$")+(z?rr(W):Ir(W))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(I,W){yr(I,0);for(var z=[],U=0,ee="",oe="",me="",de="";I.l<I.length;){var ce=I[I.l++];switch(ce){case 0:z.push(I.read_shift(8,"f"));break;case 1:oe=_(W[0].c,I.read_shift(2),!0),ee=_(W[0].r,I.read_shift(2),!1),z.push(oe+ee);break;case 2:{var ze=_(W[0].c,I.read_shift(2),!0),M=_(W[0].r,I.read_shift(2),!1);oe=_(W[0].c,I.read_shift(2),!0),ee=_(W[0].r,I.read_shift(2),!1),z.push(ze+M+":"+oe+ee)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(I.read_shift(2));break;case 6:{for(var dt="";ce=I[I.l++];)dt+=String.fromCharCode(ce);z.push('"'+dt.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:de=z.pop(),me=z.pop(),z.push(["AND","OR"][ce-20]+"("+me+","+de+")");break;default:if(ce<32&&y[ce])de=z.pop(),me=z.pop(),z.push(me+y[ce]+de);else if(x[ce]){if(U=x[ce][1],U==69&&(U=I[I.l++]),U>z.length){console.error("WK1 bad formula parse 0x"+ce.toString(16)+":|"+z.join("|")+"|");return}var qe=z.slice(-U);z.length-=U,z.push(x[ce][0]+"("+qe.join(",")+")")}else return ce<=7?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=24?console.error("WK1 unsupported op "+ce.toString(16)):ce<=30?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=115?console.error("WK1 unsupported function opcode "+ce.toString(16)):console.error("WK1 unrecognized opcode "+ce.toString(16))}}z.length==1?W[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function T(I){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=I.read_shift(2),W[3]=I[I.l++],W[0].c=I[I.l++],W}function S(I,W){var z=T(I);return z[1].t="s",z[1].v=I.read_shift(W-4,"cstr"),z}function E(I,W,z,U){var ee=Zt(6+U.length);ee.write_shift(2,I),ee.write_shift(1,z),ee.write_shift(1,W),ee.write_shift(1,39);for(var oe=0;oe<U.length;++oe){var me=U.charCodeAt(oe);ee.write_shift(1,me>=128?95:me)}return ee.write_shift(1,0),ee}function k(I,W){var z=T(I);z[1].v=I.read_shift(2);var U=z[1].v>>1;if(z[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return z[1].v=U,z}function b(I,W){var z=T(I),U=I.read_shift(4),ee=I.read_shift(4),oe=I.read_shift(2);if(oe==65535)return U===0&&ee===3221225472?(z[1].t="e",z[1].v=15):U===0&&ee===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var me=oe&32768;return oe=(oe&32767)-16446,z[1].v=(1-me*2)*(ee*Math.pow(2,oe+32)+U*Math.pow(2,oe)),z}function j(I,W,z,U){var ee=Zt(14);if(ee.write_shift(2,I),ee.write_shift(1,z),ee.write_shift(1,W),U==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var oe=0,me=0,de=0,ce=0;return U<0&&(oe=1,U=-U),me=Math.log2(U)|0,U/=Math.pow(2,me-31),ce=U>>>0,ce&2147483648||(U/=2,++me,ce=U>>>0),U-=ce,ce|=2147483648,ce>>>=0,U*=Math.pow(2,32),de=U>>>0,ee.write_shift(4,de),ee.write_shift(4,ce),me+=16383+(oe?32768:0),ee.write_shift(2,me),ee}function H(I,W){var z=b(I);return I.l+=W-14,z}function O(I,W){var z=T(I),U=I.read_shift(4);return z[1].v=U>>6,z}function V(I,W){var z=T(I),U=I.read_shift(8,"f");return z[1].v=U,z}function G(I,W){var z=V(I);return I.l+=W-10,z}function X(I,W){return I[I.l+W-1]==0?I.read_shift(W,"cstr"):""}function Z(I,W){var z=I[I.l++];z>W-1&&(z=W-1);for(var U="";U.length<z;)U+=String.fromCharCode(I[I.l++]);return U}function ie(I,W,z){if(!(!z.qpro||W<21)){var U=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var ee=I.read_shift(W-21,"cstr");return[U,ee]}}function re(I,W){for(var z={},U=I.l+W;I.l<U;){var ee=I.read_shift(2);if(ee==14e3){for(z[ee]=[0,""],z[ee][0]=I.read_shift(2);I[I.l];)z[ee][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return z}function B(I,W){var z=Zt(5+I.length);z.write_shift(2,14e3),z.write_shift(2,W);for(var U=0;U<I.length;++U){var ee=I.charCodeAt(U);z[z.l++]=ee>127?95:ee}return z[z.l++]=0,z}var ae={0:{n:"BOF",f:qt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:X},222:{n:"SHEETNAMELP",f:Z},65535:{n:""}},xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:S},23:{n:"NUMBER17",f:b},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:O},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:X},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ie},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function MH(e){var t={},r=e.match(Yr),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=De(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Q_[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var VH=function(){var e=Ku("t"),t=Ku("rPr");function r(s){var a=s.match(e);if(!a)return{t:"s",v:""};var o={t:"s",v:st(a[1])},c=s.match(t);return c&&(o.s=MH(c[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),jH=function(){var t=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var c=i.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),a.push("</"+c+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),BH=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,UH=/<(?:\w+:)?r>/,$H=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function py(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=st(gt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=gt(e),r&&(n.h=iy(n.t))):e.match(UH)&&(n.r=gt(e),n.t=st(gt((e.replace($H,"").match(BH)||[]).join("").replace(Yr,""))),r&&(n.h=jH(VH(n.r)))),n):{t:""}}var HH=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,zH=/<(?:\w+:)?(?:si|sstItem)>/g,WH=/<\/(?:\w+:)?(?:si|sstItem)>/;function GH(e,t){var r=[],n="";if(!e)return r;var i=e.match(HH);if(i){n=i[2].replace(zH,"").split(WH);for(var s=0;s!=n.length;++s){var a=py(n[s].trim(),t);a!=null&&(r[r.length]=a)}i=De(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function qH(e){return[e.read_shift(4),e.read_shift(4)]}function KH(e,t){var r=[],n=!1;return Es(e,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function qb(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ls(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function XH(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ls(e,4),t.U=ls(e,4),t.W=ls(e,4),t}function YH(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function QH(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(YH(e));return t}function JH(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function ZH(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ls(e,4),t.U=ls(e,4),t.W=ls(e,4),t}function ez(e){var t=ZH(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Kb(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Xb(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function tz(e){var t=ls(e);switch(t.Minor){case 2:return[t.Minor,rz(e)];case 3:return[t.Minor,nz()];case 4:return[t.Minor,iz(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function rz(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Kb(e,r),i=Xb(e,e.length-e.l);return{t:"Std",h:n,v:i}}function nz(){throw new Error("File is password-protected: ECMA-376 Extensible")}function iz(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Yr,function(s){var a=De(s);switch(Ki(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function sz(e,t){var r={},n=r.EncryptionVersionInfo=ls(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=Kb(e,i),t-=i,r.EncryptionVerifier=Xb(e,t),r}function az(e){var t={},r=t.EncryptionVersionInfo=ls(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function oz(e){var t=0,r,n=qb(e),i=n.length+1,s,a,o,c,l;for(r=ha(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=t&16384?1:0,c=t<<1&32767,l=o|c,t=l^a;return t^52811}var Yb=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=t[a.length-1],c=104,l=a.length-1;l>=0;--l)for(var u=a[l],f=0;f!=7;++f)u&64&&(o^=r[c]),u*=2,--c;return o};return function(a){for(var o=qb(a),c=s(o),l=o.length,u=ha(16),f=0;f!=16;++f)u[f]=0;var d,p,g;for((l&1)===1&&(d=c>>8,u[l]=i(e[0],d),--l,d=c&255,p=o[o.length-1],u[l]=i(p,d));l>0;)--l,d=c>>8,u[l]=i(o[l],d),--l,d=c&255,u[l]=i(o[l],d);for(l=15,g=15-o.length;g>0;)d=c>>8,u[l]=i(e[g],d),--l,--g,d=c&255,u[l]=i(o[l],d),--l,--g;return u}}(),cz=function(e,t,r,n,i){i||(i=t),n||(n=Yb(e));var s,a;for(s=0;s!=t.length;++s)a=t[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},lz=function(e){var t=0,r=Yb(e);return function(n){var i=cz("",n,t,r);return t=i[1],i[0]}};function uz(e,t,r,n){var i={key:qt(e),verificationBytes:qt(e)};return r.password&&(i.verifier=oz(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=lz(r.password)),i}function fz(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=az(e):n.Data=sz(e,t),n}function hz(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?fz(e,t-2,n):uz(e,r.biff>=8?t:t-2,r,n),n}var dz=function(){function e(i,s){switch(s.type){case"base64":return t(Vn(i),s);case"binary":return t(i,s);case"buffer":return t(Je&&Buffer.isBuffer(i)?i.toString("binary"):Ao(i),s);case"array":return t(lo(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var d=/\\\w+\b/g,p=0,g,m=-1;g=d.exec(u);){switch(g[0]){case"\\cell":var v=u.slice(p,d.lastIndex-g[0].length);if(v[0]==" "&&(v=v.slice(1)),++m,v.length){var _={v,t:"s"};Array.isArray(o)?o[f][m]=_:o[Be({r:f,c:m})]=_}break}p=d.lastIndex}m>l.e.c&&(l.e.c=m)}),o["!ref"]=nt(l),o}function r(i,s){return Sa(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Vt(i["!ref"]),o,c=Array.isArray(i),l=a.s.r;l<=a.e.r;++l){s.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var f=Be({r:l,c:u});o=c?(i[l]||[])[u]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(xs(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function pz(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Qu(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function mz(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),a=i-s;if(a===0)return[0,0,t];var o=0,c=0,l=i+s;switch(c=a/(l>1?2-l:l),i){case t:o=((r-n)/a+6)%6;break;case r:o=(n-t)/a+2;break;case n:o=(t-r)/a+4;break}return[o/6,c,l/2]}function gz(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=i*o,a[0]+=i,a[1]+=c;break;case 1:c=i*(2-o),a[0]+=c,a[1]+=i;break;case 2:c=i*(o-2),a[1]+=i,a[2]+=c;break;case 3:c=i*(4-o),a[1]+=c,a[2]+=i;break;case 4:c=i*(o-4),a[2]+=i,a[0]+=c;break;case 5:c=i*(6-o),a[2]+=c,a[0]+=i;break}for(var l=0;l!=3;++l)a[l]=Math.round(a[l]*255);return a}function p0(e,t){if(t===0)return e;var r=mz(pz(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Qu(gz(r))}var Qb=6,vz=15,xz=1,rn=Qb;function m0(e){return Math.floor((e+Math.round(128/rn)/256)*rn)}function g0(e){return Math.floor((e-5)/rn*100+.5)/100}function lv(e){return Math.round((e*rn+5)/rn*256)/256}function cg(e){return lv(g0(m0(e)))}function my(e){var t=Math.abs(e-cg(e)),r=rn;if(t>.005)for(rn=xz;rn<vz;++rn)Math.abs(e-cg(e))<=t&&(t=Math.abs(e-cg(e)),r=rn);rn=r}function Oc(e){e.width?(e.wpx=m0(e.width),e.wch=g0(e.wpx),e.MDW=rn):e.wpx?(e.wch=g0(e.wpx),e.width=lv(e.wch),e.MDW=rn):typeof e.wch=="number"&&(e.width=lv(e.wch),e.wpx=m0(e.width),e.MDW=rn),e.customWidth&&delete e.customWidth}var _z=96,Jb=_z;function Zb(e){return e*96/Jb}function Ju(e){return e*Jb/96}var yz={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Ez(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(Yr)||[]).forEach(function(a){var o=De(a);switch(Ki(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=St(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=St(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function wz(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(Yr)||[]).forEach(function(a){var o=De(a);switch(Ki(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function Tz(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(Yr)||[]).forEach(function(a){var o=De(a);switch(Ki(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=gt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?St(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?St(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?St(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?St(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?St(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?St(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?St(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Q_[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=St(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var c=Ka[i.color.index];i.color.index==81&&(c=Ka[1]),c||(c=Ka[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=p0(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function Sz(e,t,r){t.NumberFmt=[];for(var n=zi($e),i=0;i<n.length;++i)t.NumberFmt[n[i]]=$e[n[i]];var s=e[0].match(Yr);if(s)for(i=0;i<s.length;++i){var a=De(s[i]);switch(Ki(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=st(gt(a.formatCode)),c=parseInt(a.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}qa(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var Sh=["numFmtId","fillId","fontId","borderId","xfId"],Ah=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Az(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Yr)||[]).forEach(function(s){var a=De(s),o=0;switch(Ki(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Sh.length;++o)n[Sh[o]]&&(n[Sh[o]]=parseInt(n[Sh[o]],10));for(o=0;o<Ah.length;++o)n[Ah[o]]&&(n[Ah[o]]=St(n[Ah[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};a.vertical&&(c.vertical=a.vertical),a.horizontal&&(c.horizontal=a.horizontal),a.textRotation!=null&&(c.textRotation=a.textRotation),a.indent&&(c.indent=a.indent),a.wrapText&&(c.wrapText=St(a.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var kz=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&Sz(f,u,l),(f=o.match(i))&&Tz(f,u,c,l),(f=o.match(n))&&wz(f,u,c,l),(f=o.match(s))&&Ez(f,u,c,l),(f=o.match(r))&&Az(f,u,l),u}}();function Cz(e,t){var r=e.read_shift(2),n=Wr(e);return[r,n]}function Iz(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=VU(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=MU(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Wr(e),n}var Rz=Xr;function bz(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var Fz=Xr;function Pz(e,t,r){var n={};n.NumberFmt=[];for(var i in $e)n.NumberFmt[i]=$e[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return Es(e,function(c,l,u){switch(u){case 44:n.NumberFmt[c[0]]=c[1],qa(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=p0(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(u),a=!0;break;case 38:s.pop(),a=!1;break;default:if(l.T>0)s.push(u);else if(l.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var Nz=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Dz(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Yr)||[]).forEach(function(i){var s=De(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[Nz.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function Oz(){}function Lz(){}var Mz=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Vz=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,jz=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Bz(e,t,r){t.themeElements={};var n;[["clrScheme",Mz,Dz],["fontScheme",Vz,Oz],["fmtScheme",jz,Lz]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var Uz=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function eF(e,t){(!e||e.length===0)&&(e=$z());var r,n={};if(!(r=e.match(Uz)))throw new Error("themeElements not found in theme");return Bz(r[0],n,t),n.raw=e,n}function $z(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[fb];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Hz(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var a;try{a=ub(s,{type:"array"})}catch{return}var o=In(a,"theme/theme/theme1.xml",!0);if(o)return eF(o,r)}}function zz(e){return e.read_shift(4)}function Wz(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Gz(e,4);break;case 2:t.xclrValue=Bb(e);break;case 3:t.xclrValue=zz(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Gz(e,t){return Xr(e,t)}function qz(e,t){return Xr(e,t)}function Kz(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Wz(e);break;case 6:n[1]=qz(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Xz(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(Kz(e,r-e.l));return{ixfe:n,ext:s}}function Yz(e,t){t.forEach(function(r){switch(r[0]){}})}function Qz(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Wr(e)}}function Jz(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Zz(e){return e.l+=4,e.read_shift(4)!=0}function eW(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return Es(e,function(c,l,u){switch(u){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(u),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!l.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function tW(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,a;return e.replace(Yr,function(o){var c=De(o);switch(Ki(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<n.Types.length;++l)n.Types[l].name==c.name&&(a=n.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+c.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function rW(e){var t=[];if(!e)return t;var r=1;return(e.match(Yr)||[]).forEach(function(n){var i=De(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function nW(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Be(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function iW(e,t,r){var n=[];return Es(e,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function sW(e,t,r,n){if(!e)return e;var i=n||{},s=!1;Es(e,function(o,c,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},i)}function aW(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function wT(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(a){var o=sn(a.ref);if(i?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[a.ref],!s){s={t:"z"},i?e[o.r][o.c]=s:e[a.ref]=s;var c=Vt(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=nt(c);l!==e["!ref"]&&(e["!ref"]=l)}s.c||(s.c=[]);var u={a:a.author,t:a.t,r:a.r,T:r};a.h&&(u.h=a.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}s.c.push(u)})}function oW(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=De(o[0]),l={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=sn(c.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!f&&!!f[1]&&py(f[1])||{r:"",t:"",h:""};l.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),l.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(l.h=d.h),n.push(l)}}}}),n}function cW(e,t){var r=[],n=!1,i={},s=0;return e.replace(Yr,function(o,c){var l=De(o);switch(Ki(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":i.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function lW(e,t){var r=[],n=!1;return e.replace(Yr,function(s){var a=De(s);switch(Ki(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function uW(e){var t={};t.iauthor=e.read_shift(4);var r=Co(e);return t.rfx=r.s,t.ref=Be(r.s),e.l+=16,t}var fW=Wr;function hW(e,t){var r=[],n=[],i={},s=!1;return Es(e,function(o,c,l){switch(l){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),r}var dW="application/vnd.ms-office.vbaProject";function pW(e){var t=tt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");tt.utils.cfb_add(t,i,e.FileIndex[n].content)}}),tt.write(t)}function mW(){return{"!type":"dialog"}}function gW(){return{"!type":"dialog"}}function vW(){return{"!type":"macro"}}function xW(){return{"!type":"macro"}}var mc=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,a){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=t.c:--u,c?l+=t.r:--l,i+(o?"":"$")+rr(u)+(c?"":"$")+Ir(l)}return function(i,s){return t=s,i.replace(e,r)}}(),tF=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,_W=function(){return function(t,r){return t.replace(tF,function(n,i,s,a,o,c){var l=cy(a)-(s?0:r.c),u=oy(c)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",d=l==0?"":s?l+1:"["+l+"]";return i+"R"+f+"C"+d})}}();function rF(e,t){return e.replace(tF,function(r,n,i,s,a,o){return n+(i=="$"?i+s:rr(cy(s)+t.c))+(a=="$"?a+o:Ir(oy(o)+t.r))})}function yW(e,t,r){var n=Zc(t),i=n.s,s=sn(r),a={r:s.r-i.r,c:s.c-i.c};return rF(e,a)}function EW(e){return e.length!=1}function TT(e){return e.replace(/_xlfn\./g,"")}function zt(e){e.l+=1}function da(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function nF(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return iF(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),a=da(e,2),o=da(e,2);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function iF(e){var t=da(e,2),r=da(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function wW(e,t,r){if(r.biff<8)return iF(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=da(e,2),a=da(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function sF(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return TW(e);var n=e.read_shift(r&&r.biff==12?4:2),i=da(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function TW(e){var t=da(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function SW(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function AW(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return kW(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function kW(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function CW(e,t,r){var n=(e[e.l++]&96)>>5,i=nF(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function IW(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=nF(e,s,r);return[n,i,a]}function RW(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function bW(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function FW(e,t,r){var n=(e[e.l++]&96)>>5,i=wW(e,t-1,r);return[n,i]}function PW(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function ST(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function NW(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function DW(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function OW(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function LW(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function MW(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function aF(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function VW(e){return e.read_shift(2),aF(e)}function jW(e){return e.read_shift(2),aF(e)}function BW(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=sF(e,0,r);return[n,i]}function UW(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=AW(e,0,r);return[n,i]}function $W(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=sF(e,0,r);return[n,i,s]}function HW(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[zG[i],lF[i],n]}function zW(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:WW(e);return[i,(s[0]===0?lF:HG)[s[1]]]}function WW(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function GW(e,t,r){e.l+=r&&r.biff==2?3:4}function qW(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function KW(e){return e.l++,Io[e.read_shift(1)]}function XW(e){return e.l++,e.read_shift(2)}function YW(e){return e.l++,e.read_shift(1)!==0}function QW(e){return e.l++,Ur(e)}function JW(e,t,r){return e.l++,Mf(e,t-1,r)}function ZW(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Bt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Io[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ur(e);break;case 2:r[1]=Ro(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function eG(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Co:Fp)(e));return i}function tG(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=ZW(e,r.biff);return a}function rG(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function nG(e,t,r){if(r.biff==5)return iG(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function iG(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function sG(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function aG(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function oG(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function cG(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var lG=Xr,uG=Xr,fG=Xr;function jf(e,t,r){return e.l+=2,[SW(e)]}function gy(e){return e.l+=6,[]}var hG=jf,dG=gy,pG=gy,mG=jf;function oF(e){return e.l+=2,[qt(e),e.read_shift(2)&1]}var gG=jf,vG=oF,xG=gy,_G=jf,yG=jf,EG=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function wG(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=EG[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:i,C:s}}function TG(e){return e.l+=2,[e.read_shift(4)]}function SG(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function AG(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function kG(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function CG(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function IG(e){return e.l+=4,[0,0]}var AT={1:{n:"PtgExp",f:qW},2:{n:"PtgTbl",f:fG},3:{n:"PtgAdd",f:zt},4:{n:"PtgSub",f:zt},5:{n:"PtgMul",f:zt},6:{n:"PtgDiv",f:zt},7:{n:"PtgPower",f:zt},8:{n:"PtgConcat",f:zt},9:{n:"PtgLt",f:zt},10:{n:"PtgLe",f:zt},11:{n:"PtgEq",f:zt},12:{n:"PtgGe",f:zt},13:{n:"PtgGt",f:zt},14:{n:"PtgNe",f:zt},15:{n:"PtgIsect",f:zt},16:{n:"PtgUnion",f:zt},17:{n:"PtgRange",f:zt},18:{n:"PtgUplus",f:zt},19:{n:"PtgUminus",f:zt},20:{n:"PtgPercent",f:zt},21:{n:"PtgParen",f:zt},22:{n:"PtgMissArg",f:zt},23:{n:"PtgStr",f:JW},26:{n:"PtgSheet",f:SG},27:{n:"PtgEndSheet",f:AG},28:{n:"PtgErr",f:KW},29:{n:"PtgBool",f:YW},30:{n:"PtgInt",f:XW},31:{n:"PtgNum",f:QW},32:{n:"PtgArray",f:PW},33:{n:"PtgFunc",f:HW},34:{n:"PtgFuncVar",f:zW},35:{n:"PtgName",f:rG},36:{n:"PtgRef",f:BW},37:{n:"PtgArea",f:CW},38:{n:"PtgMemArea",f:sG},39:{n:"PtgMemErr",f:lG},40:{n:"PtgMemNoMem",f:uG},41:{n:"PtgMemFunc",f:aG},42:{n:"PtgRefErr",f:oG},43:{n:"PtgAreaErr",f:RW},44:{n:"PtgRefN",f:UW},45:{n:"PtgAreaN",f:FW},46:{n:"PtgMemAreaN",f:kG},47:{n:"PtgMemNoMemN",f:CG},57:{n:"PtgNameX",f:nG},58:{n:"PtgRef3d",f:$W},59:{n:"PtgArea3d",f:IW},60:{n:"PtgRefErr3d",f:cG},61:{n:"PtgAreaErr3d",f:bW},255:{}},RG={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},bG={1:{n:"PtgElfLel",f:oF},2:{n:"PtgElfRw",f:_G},3:{n:"PtgElfCol",f:hG},6:{n:"PtgElfRwV",f:yG},7:{n:"PtgElfColV",f:mG},10:{n:"PtgElfRadical",f:gG},11:{n:"PtgElfRadicalS",f:xG},13:{n:"PtgElfColS",f:dG},15:{n:"PtgElfColSV",f:pG},16:{n:"PtgElfRadicalLel",f:vG},25:{n:"PtgList",f:wG},29:{n:"PtgSxName",f:TG},255:{}},FG={0:{n:"PtgAttrNoop",f:IG},1:{n:"PtgAttrSemi",f:MW},2:{n:"PtgAttrIf",f:OW},4:{n:"PtgAttrChoose",f:NW},8:{n:"PtgAttrGoto",f:DW},16:{n:"PtgAttrSum",f:GW},32:{n:"PtgAttrBaxcel",f:ST},33:{n:"PtgAttrBaxcel",f:ST},64:{n:"PtgAttrSpace",f:VW},65:{n:"PtgAttrSpaceSemi",f:jW},128:{n:"PtgAttrIfError",f:LW},255:{}};function Bf(e,t,r,n){if(n.biff<8)return Xr(e,t);for(var i=e.l+t,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=tG(e,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=eG(e,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&s.push(Xr(e,t)),s}function Uf(e,t,r){for(var n=e.l+t,i,s,a=[];n!=e.l;)t=n-e.l,s=e[e.l],i=AT[s]||AT[RG[s]],(s===24||s===25)&&(i=(s===24?bG:FG)[e[e.l+1]]),!i||!i.f?Xr(e,t):a.push([i.n,i.f(e,t,r)]);return a}function PG(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var NG={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function DG(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function cF(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function kT(e,t,r){var n=cF(e,t,r);return n=="#REF"?n:DG(n,r)}function Vr(e,t,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,l,u,f=0,d=0,p,g="";if(!e[0]||!e[0][0])return"";for(var m=-1,v="",_=0,x=e[0].length;_<x;++_){var y=e[0][_];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:v=Dt(" ",e[0][m][1][1]);break;case 1:v=Dt("\r",e[0][m][1][1]);break;default:if(v="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}l=l+v,m=-1}o.push(l+NG[y[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=eu(y[1][1],a,i),o.push(tu(u,s));break;case"PtgRefN":u=r?eu(y[1][1],r,i):y[1][1],o.push(tu(u,s));break;case"PtgRef3d":f=y[1][1],u=eu(y[1][2],a,i),g=kT(n,f,i),o.push(g+"!"+tu(u,s));break;case"PtgFunc":case"PtgFuncVar":var w=y[1][0],T=y[1][1];w||(w=0),w&=127;var S=w==0?[]:o.slice(-w);o.length-=w,T==="User"&&(T=S.shift()),o.push(T+"("+S.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":p=aT(y[1][1],r?{s:r}:a,i),o.push(ag(p,i));break;case"PtgArea":p=aT(y[1][1],a,i),o.push(ag(p,i));break;case"PtgArea3d":f=y[1][1],p=y[1][2],g=kT(n,f,i),o.push(g+"!"+ag(p,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=y[1][2];var E=(n.names||[])[d-1]||(n[0]||[])[d],k=E?E.Name:"SH33TJSNAME"+String(d);k&&k.slice(0,6)=="_xlfn."&&!i.xlfn&&(k=k.slice(6)),o.push(k);break;case"PtgNameX":var b=y[1][1];d=y[1][2];var j;if(i.biff<=5)b<0&&(b=-b),n[b]&&(j=n[b][d]);else{var H="";if(((n[b]||[])[0]||[])[0]==14849||(((n[b]||[])[0]||[])[0]==1025?n[b][d]&&n[b][d].itab>0&&(H=n.SheetNames[n[b][d].itab-1]+"!"):H=n.SheetNames[d-1]+"!"),n[b]&&n[b][d])H+=n[b][d].Name;else if(n[0]&&n[0][d])H+=n[0][d].Name;else{var O=(cF(n,b,i)||"").split(";;");O[d-1]?H=O[d-1]:H+="SH33TJSERRX"}o.push(H);break}j||(j={Name:"SH33TJSERRY"}),o.push(j.Name);break;case"PtgParen":var V="(",G=")";if(m>=0){switch(v="",e[0][m][1][0]){case 2:V=Dt(" ",e[0][m][1][1])+V;break;case 3:V=Dt("\r",e[0][m][1][1])+V;break;case 4:G=Dt(" ",e[0][m][1][1])+G;break;case 5:G=Dt("\r",e[0][m][1][1])+G;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(V+o.pop()+G);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var X={c:r.c,r:r.r};if(n.sharedf[Be(u)]){var Z=n.sharedf[Be(u)];o.push(Vr(Z,a,X,n,i))}else{var ie=!1;for(c=0;c!=n.arrayf.length;++c)if(l=n.arrayf[c],!(u.c<l[0].s.c||u.c>l[0].e.c)&&!(u.r<l[0].s.r||u.r>l[0].e.r)){o.push(Vr(l[1],a,X,n,i)),ie=!0;break}ie||o.push(y[1])}break;case"PtgArray":o.push("{"+PG(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&re.indexOf(e[0][_][0])==-1){y=e[0][m];var B=!0;switch(y[1][0]){case 4:B=!1;case 0:v=Dt(" ",y[1][1]);break;case 5:B=!1;case 1:v=Dt("\r",y[1][1]);break;default:if(v="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((B?v:"")+o.pop()+(B?"":v)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function OG(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,a=e.read_shift(i);if(a==65535)return[[],Xr(e,t-2)];var o=Uf(e,a,r);return t!==a+i&&(s=Bf(e,t-a-i,o,r)),e.l=n,[o,s]}function LG(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,a=e.read_shift(i);if(a==65535)return[[],Xr(e,t-2)];var o=Uf(e,a,r);return t!==a+i&&(s=Bf(e,t-a-i,o,r)),e.l=n,[o,s]}function MG(e,t,r,n){var i=e.l+t,s=Uf(e,n,r),a;return i!==e.l&&(a=Bf(e,i-e.l,s,r)),[s,a]}function VG(e,t,r){var n=e.l+t,i,s=e.read_shift(2),a=Uf(e,s,r);return s==65535?[[],Xr(e,t-2)]:(t!==s+2&&(i=Bf(e,n-s-2,a,r)),[a,i])}function jG(e){var t;if(ss(e,e.l+6)!==65535)return[Ur(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function lg(e,t,r){var n=e.l+t,i=Xi(e);r.biff==2&&++e.l;var s=jG(e),a=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=LG(e,n-e.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function Pp(e,t,r){var n=e.read_shift(4),i=Uf(e,n,r),s=e.read_shift(4),a=s>0?Bf(e,s,i,r):null;return[i,a]}var BG=Pp,Np=Pp,UG=Pp,$G=Pp,HG={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},lF={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},zG={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function CT(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function ug(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var su={},gc={};function au(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function uF(e,t,r,n,i,s){try{n.cellNF&&(e.z=$e[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=dr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if($e[t]==null&&qa(G7[t]||"General",t),e.t==="e")e.w=e.w||Io[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=qu(e.v);else if(e.t==="d"){var a=cn(e.v);(a|0)===a?e.w=a.toString(10):e.w=qu(a)}else{if(e.v===void 0)return"";e.w=co(e.v,gc)}else e.t==="d"?e.w=ti(t,cn(e.v),gc):e.w=ti(t,e.v,gc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=p0(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=p0(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function WG(e,t){var r=Vt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=nt(r))}var GG=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,qG=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,KG=/<(?:\w:)?hyperlink [^>]*>/mg,XG=/"(\w*:\w*)"/,YG=/<(?:\w:)?col\b[^>]*[\/]?>/g,QG=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,JG=/<(?:\w:)?pageMargins[^>]*\/>/g,fF=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,ZG=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,eq=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function tq(e,t,r,n,i,s,a){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",u="",f=e.match(qG);f?(l=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):l=u=e;var d=l.match(fF);d?vy(d[0],o,i,r):(d=l.match(ZG))&&rq(d[0],d[1]||"",o,i,r);var p=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var g=l.slice(p,p+50).match(XG);g&&WG(o,g[1])}var m=l.match(eq);m&&m[1]&&cq(m[1],i);var v=[];if(t.cellStyles){var _=l.match(YG);_&&sq(v,_)}f&&lq(f[1],o,t,c,s,a);var x=u.match(QG);x&&(o["!autofilter"]=aq(x[0]));var y=[],w=u.match(GG);if(w)for(p=0;p!=w.length;++p)y[p]=Vt(w[p].slice(w[p].indexOf('"')+1));var T=u.match(KG);T&&nq(o,T,n);var S=u.match(JG);if(S&&(o["!margins"]=iq(De(S[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=nt(c)),t.sheetRows>0&&o["!ref"]){var E=Vt(o["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>c.e.r&&(E.e.r=c.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>c.e.c&&(E.e.c=c.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=nt(E))}return v.length>0&&(o["!cols"]=v),y.length>0&&(o["!merges"]=y),o}function vy(e,t,r,n){var i=De(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=st(gt(i.codeName)))}function rq(e,t,r,n,i){vy(e.slice(0,e.indexOf(">")),r,n,i)}function nq(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=De(gt(t[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+st(s.location))):(s.Target="#"+st(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Vt(s.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var u=Be({c:l,r:c});n?(e[c]||(e[c]=[]),e[c][l]||(e[c][l]={t:"z",v:void 0}),e[c][l].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function iq(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function sq(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=De(t[n],!0);i.hidden&&(i.hidden=St(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,my(i.width)),Oc(i);s<=a;)e[s++]=Cr(i)}}function aq(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var oq=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function cq(e,t){t.Views||(t.Views=[{}]),(e.match(oq)||[]).forEach(function(r,n){var i=De(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),St(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var lq=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Ku("v"),a=Ku("f");return function(c,l,u,f,d,p){for(var g=0,m="",v=[],_=[],x=0,y=0,w=0,T="",S,E,k=0,b=0,j,H,O=0,V=0,G=Array.isArray(p.CellXf),X,Z=[],ie=[],re=Array.isArray(l),B=[],ae={},xe=!1,I=!!u.sheetStubs,W=c.split(t),z=0,U=W.length;z!=U;++z){m=W[z].trim();var ee=m.length;if(ee!==0){var oe=0;e:for(g=0;g<ee;++g)switch(m[g]){case">":if(m[g-1]!="/"){++g;break e}if(u&&u.cellStyles){if(E=De(m.slice(oe,g),!0),k=E.r!=null?parseInt(E.r,10):k+1,b=-1,u.sheetRows&&u.sheetRows<k)continue;ae={},xe=!1,E.ht&&(xe=!0,ae.hpt=parseFloat(E.ht),ae.hpx=Ju(ae.hpt)),E.hidden=="1"&&(xe=!0,ae.hidden=!0),E.outlineLevel!=null&&(xe=!0,ae.level=+E.outlineLevel),xe&&(B[k-1]=ae)}break;case"<":oe=g;break}if(oe>=g)break;if(E=De(m.slice(oe,g),!0),k=E.r!=null?parseInt(E.r,10):k+1,b=-1,!(u.sheetRows&&u.sheetRows<k)){f.s.r>k-1&&(f.s.r=k-1),f.e.r<k-1&&(f.e.r=k-1),u&&u.cellStyles&&(ae={},xe=!1,E.ht&&(xe=!0,ae.hpt=parseFloat(E.ht),ae.hpx=Ju(ae.hpt)),E.hidden=="1"&&(xe=!0,ae.hidden=!0),E.outlineLevel!=null&&(xe=!0,ae.level=+E.outlineLevel),xe&&(B[k-1]=ae)),v=m.slice(g).split(e);for(var me=0;me!=v.length&&v[me].trim().charAt(0)=="<";++me);for(v=v.slice(me),g=0;g!=v.length;++g)if(m=v[g].trim(),m.length!==0){if(_=m.match(r),x=g,y=0,w=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,_!=null&&_.length===2){for(x=0,T=_[1],y=0;y!=T.length&&!((w=T.charCodeAt(y)-64)<1||w>26);++y)x=26*x+w;--x,b=x}else++b;for(y=0;y!=m.length&&m.charCodeAt(y)!==62;++y);if(++y,E=De(m.slice(0,y),!0),E.r||(E.r=Be({r:k-1,c:b})),T=m.slice(y),S={t:""},(_=T.match(s))!=null&&_[1]!==""&&(S.v=st(_[1])),u.cellFormula){if((_=T.match(a))!=null&&_[1]!==""){if(S.f=st(gt(_[1])).replace(/\r\n/g,`
`),u.xlfn||(S.f=TT(S.f)),_[0].indexOf('t="array"')>-1)S.F=(T.match(i)||[])[1],S.F.indexOf(":")>-1&&Z.push([Vt(S.F),S.F]);else if(_[0].indexOf('t="shared"')>-1){H=De(_[0]);var de=st(gt(_[1]));u.xlfn||(de=TT(de)),ie[parseInt(H.si,10)]=[H,de,E.r]}}else(_=T.match(/<f[^>]*\/>/))&&(H=De(_[0]),ie[H.si]&&(S.f=yW(ie[H.si][1],ie[H.si][2],E.r)));var ce=sn(E.r);for(y=0;y<Z.length;++y)ce.r>=Z[y][0].s.r&&ce.r<=Z[y][0].e.r&&ce.c>=Z[y][0].s.c&&ce.c<=Z[y][0].e.c&&(S.F=Z[y][1])}if(E.t==null&&S.v===void 0)if(S.f||S.F)S.v=0,S.t="n";else if(I)S.t="z";else continue;else S.t=E.t||"n";switch(f.s.c>b&&(f.s.c=b),f.e.c<b&&(f.e.c=b),S.t){case"n":if(S.v==""||S.v==null){if(!I)continue;S.t="z"}else S.v=parseFloat(S.v);break;case"s":if(typeof S.v>"u"){if(!I)continue;S.t="z"}else j=su[parseInt(S.v,10)],S.v=j.t,S.r=j.r,u.cellHTML&&(S.h=j.h);break;case"str":S.t="s",S.v=S.v!=null?gt(S.v):"",u.cellHTML&&(S.h=iy(S.v));break;case"inlineStr":_=T.match(n),S.t="s",_!=null&&(j=py(_[1]))?(S.v=j.t,u.cellHTML&&(S.h=j.h)):S.v="";break;case"b":S.v=St(S.v);break;case"d":u.cellDates?S.v=dr(S.v,1):(S.v=cn(dr(S.v,1)),S.t="n");break;case"e":(!u||u.cellText!==!1)&&(S.w=S.v),S.v=Pb[S.v];break}if(O=V=0,X=null,G&&E.s!==void 0&&(X=p.CellXf[E.s],X!=null&&(X.numFmtId!=null&&(O=X.numFmtId),u.cellStyles&&X.fillId!=null&&(V=X.fillId))),uF(S,O,V,u,d,p),u.cellDates&&G&&S.t=="n"&&Jc($e[O])&&(S.t="d",S.v=bp(S.v)),E.cm&&u.xlmeta){var ze=(u.xlmeta.Cell||[])[+E.cm-1];ze&&ze.type=="XLDAPR"&&(S.D=!0)}if(re){var M=sn(E.r);l[M.r]||(l[M.r]=[]),l[M.r][M.c]=S}else l[E.r]=S}}}}B.length>0&&(l["!rows"]=B)}}();function uq(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}var fq=Co;function hq(){}function dq(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=OU(e),r}function pq(e){var t=ri(e);return[t]}function mq(e){var t=ko(e);return[t]}function gq(e){var t=ri(e),r=e.read_shift(1);return[t,r,"b"]}function vq(e){var t=ko(e),r=e.read_shift(1);return[t,r,"b"]}function xq(e){var t=ri(e),r=e.read_shift(1);return[t,r,"e"]}function _q(e){var t=ko(e),r=e.read_shift(1);return[t,r,"e"]}function yq(e){var t=ri(e),r=e.read_shift(4);return[t,r,"s"]}function Eq(e){var t=ko(e),r=e.read_shift(4);return[t,r,"s"]}function wq(e){var t=ri(e),r=Ur(e);return[t,r,"n"]}function hF(e){var t=ko(e),r=Ur(e);return[t,r,"n"]}function Tq(e){var t=ri(e),r=fy(e);return[t,r,"n"]}function Sq(e){var t=ko(e),r=fy(e);return[t,r,"n"]}function Aq(e){var t=ri(e),r=ly(e);return[t,r,"is"]}function kq(e){var t=ri(e),r=Wr(e);return[t,r,"str"]}function Cq(e){var t=ko(e),r=Wr(e);return[t,r,"str"]}function Iq(e,t,r){var n=e.l+t,i=ri(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=Np(e,n-e.l,r);a[3]=Vr(o,null,i,r.supbooks,r)}else e.l=n;return a}function Rq(e,t,r){var n=e.l+t,i=ri(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=Np(e,n-e.l,r);a[3]=Vr(o,null,i,r.supbooks,r)}else e.l=n;return a}function bq(e,t,r){var n=e.l+t,i=ri(e);i.r=r["!row"];var s=Ur(e),a=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=Np(e,n-e.l,r);a[3]=Vr(o,null,i,r.supbooks,r)}else e.l=n;return a}function Fq(e,t,r){var n=e.l+t,i=ri(e);i.r=r["!row"];var s=Wr(e),a=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=Np(e,n-e.l,r);a[3]=Vr(o,null,i,r.supbooks,r)}else e.l=n;return a}var Pq=Co;function Nq(e,t){var r=e.l+t,n=Co(e),i=uy(e),s=Wr(e),a=Wr(e),o=Wr(e);e.l=r;var c={rfx:n,relId:i,loc:s,display:o};return a&&(c.Tooltip=a),c}function Dq(){}function Oq(e,t,r){var n=e.l+t,i=Rb(e),s=e.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=BG(e,n-e.l,r);a[1]=o}else e.l=n;return a}function Lq(e,t,r){var n=e.l+t,i=Co(e),s=[i];if(r.cellFormula){var a=$G(e,n-e.l,r);s[1]=a,e.l=n}else e.l=n;return s}var Mq=["left","right","top","bottom","header","footer"];function Vq(e){var t={};return Mq.forEach(function(r){t[r]=Ur(e)}),t}function jq(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Bq(){}function Uq(){}function $q(e,t,r,n,i,s,a){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},l,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,d=!1,p,g,m,v,_,x,y,w,T,S=[];o.biff=12,o["!row"]=0;var E=0,k=!1,b=[],j={},H=o.supbooks||i.supbooks||[[]];if(H.sharedf=j,H.arrayf=b,H.SheetNames=i.SheetNames||i.Sheets.map(function(re){return re.name}),!o.supbooks&&(o.supbooks=H,i.Names))for(var O=0;O<i.Names.length;++O)H[0][O+1]=i.Names[O];var V=[],G=[],X=!1;v0[16]={n:"BrtShortReal",f:hF};var Z;if(Es(e,function(B,ae,xe){if(!d)switch(xe){case 148:l=B;break;case 0:p=B,o.sheetRows&&o.sheetRows<=p.r&&(d=!0),w=Ir(v=p.r),o["!row"]=p.r,(B.hidden||B.hpt||B.level!=null)&&(B.hpt&&(B.hpx=Ju(B.hpt)),G[B.r]=B);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:B[2]},B[2]){case"n":g.v=B[1];break;case"s":y=su[B[1]],g.v=y.t,g.r=y.r;break;case"b":g.v=!!B[1];break;case"e":g.v=B[1],o.cellText!==!1&&(g.w=Io[g.v]);break;case"str":g.t="s",g.v=B[1];break;case"is":g.t="s",g.v=B[1].t;break}if((m=a.CellXf[B[0].iStyleRef])&&uF(g,m.numFmtId,null,o,s,a),_=B[0].c==-1?_+1:B[0].c,o.dense?(c[v]||(c[v]=[]),c[v][_]=g):c[rr(_)+w]=g,o.cellFormula){for(k=!1,E=0;E<b.length;++E){var I=b[E];p.r>=I[0].s.r&&p.r<=I[0].e.r&&_>=I[0].s.c&&_<=I[0].e.c&&(g.F=nt(I[0]),k=!0)}!k&&B.length>3&&(g.f=B[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>_&&(u.s.c=_),u.e.r<p.r&&(u.e.r=p.r),u.e.c<_&&(u.e.c=_),o.cellDates&&m&&g.t=="n"&&Jc($e[m.numFmtId])){var W=Ua(g.v);W&&(g.t="d",g.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}Z&&(Z.type=="XLDAPR"&&(g.D=!0),Z=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;g={t:"z",v:void 0},_=B[0].c==-1?_+1:B[0].c,o.dense?(c[v]||(c[v]=[]),c[v][_]=g):c[rr(_)+w]=g,u.s.r>p.r&&(u.s.r=p.r),u.s.c>_&&(u.s.c=_),u.e.r<p.r&&(u.e.r=p.r),u.e.c<_&&(u.e.c=_),Z&&(Z.type=="XLDAPR"&&(g.D=!0),Z=void 0);break;case 176:S.push(B);break;case 49:Z=((o.xlmeta||{}).Cell||[])[B-1];break;case 494:var z=n["!id"][B.relId];for(z?(B.Target=z.Target,B.loc&&(B.Target+="#"+B.loc),B.Rel=z):B.relId==""&&(B.Target="#"+B.loc),v=B.rfx.s.r;v<=B.rfx.e.r;++v)for(_=B.rfx.s.c;_<=B.rfx.e.c;++_)o.dense?(c[v]||(c[v]=[]),c[v][_]||(c[v][_]={t:"z",v:void 0}),c[v][_].l=B):(x=Be({c:_,r:v}),c[x]||(c[x]={t:"z",v:void 0}),c[x].l=B);break;case 426:if(!o.cellFormula)break;b.push(B),T=o.dense?c[v][_]:c[rr(_)+w],T.f=Vr(B[1],u,{r:p.r,c:_},H,o),T.F=nt(B[0]);break;case 427:if(!o.cellFormula)break;j[Be(B[0].s)]=B[1],T=o.dense?c[v][_]:c[rr(_)+w],T.f=Vr(B[1],u,{r:p.r,c:_},H,o);break;case 60:if(!o.cellStyles)break;for(;B.e>=B.s;)V[B.e--]={width:B.w/256,hidden:!!(B.flags&1),level:B.level},X||(X=!0,my(B.w/256)),Oc(V[B.e+1]);break;case 161:c["!autofilter"]={ref:nt(B)};break;case 476:c["!margins"]=B;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),B.name&&(i.Sheets[r].CodeName=B.name),(B.above||B.left)&&(c["!outline"]={above:B.above,left:B.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),B.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ae.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+xe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(u.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=nt(l||u)),o.sheetRows&&c["!ref"]){var ie=Vt(c["!ref"]);o.sheetRows<=+ie.e.r&&(ie.e.r=o.sheetRows-1,ie.e.r>u.e.r&&(ie.e.r=u.e.r),ie.e.r<ie.s.r&&(ie.s.r=ie.e.r),ie.e.c>u.e.c&&(ie.e.c=u.e.c),ie.e.c<ie.s.c&&(ie.s.c=ie.e.c),c["!fullref"]=c["!ref"],c["!ref"]=nt(ie))}return S.length>0&&(c["!merges"]=S),V.length>0&&(c["!cols"]=V),G.length>0&&(c["!rows"]=G),c}function Hq(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(t[+a[1]]=r?+a[2]:a[2])});var i=st((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function zq(e,t,r,n,i,s){var a=s||{"!type":"chart"};if(!e)return s;var o=0,c=0,l="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var d=Hq(f);u.s.r=u.s.c=0,u.e.c=o,l=rr(o),d[0].forEach(function(p,g){a[l+Ir(g)]={t:"n",v:p,z:d[1]},c=g}),u.e.r<c&&(u.e.r=c),++o}),o>0&&(a["!ref"]=nt(u)),a}function Wq(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=e.match(fF);return o&&vy(o[0],s,i,r),(a=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Gq(e,t){e.l+=10;var r=Wr(e);return{name:r}}function qq(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Es(e,function(c,l,u){switch(u){case 550:s["!rel"]=c;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),c.name&&(i.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var dF=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Kq=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Xq=[],Yq=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function IT(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=St(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function RT(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=St(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function pF(e){RT(e.WBProps,dF),RT(e.CalcPr,Yq),IT(e.WBView,Kq),IT(e.Sheets,Xq),gc.date1904=St(e.WBProps.date1904)}var Qq="][*?/\\".split("");function Jq(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return Qq.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var Zq=/<\w+:workbook/;function eK(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(e.replace(Yr,function(c,l){var u=De(c);switch(Ki(u[0])){case"<?xml":break;case"<workbook":c.match(Zq)&&(i="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":dF.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=St(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=gt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=st(gt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=gt(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),St(u.hidden||"0")&&(s.Hidden=!0),a=l+c.length;break;case"</definedName>":s.Ref=st(gt(e.slice(a,l))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),xU.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return pF(r),r}function tK(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=av(e),r.name=Wr(e),r}function rK(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Wr(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function nK(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function iK(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=LU(e),a=UG(e,0,r),o=uy(e);e.l=n;var c={Name:s,Ptg:a};return i<268435455&&(c.Sheet=i),o&&(c.Comment=o),c}function sK(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],v0[16]={n:"BrtFRTArchID$",f:nK},Es(e,function(c,l,u){switch(u){case 156:a.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Vr(c.Ptg,null,null,a,t),delete t.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,c]):a[0]=[u,c],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(c),a.XTI=a.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!l.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),pF(r),r.Names=s,r.supbooks=a,r}function aK(e,t,r){return t.slice(-4)===".bin"?sK(e,r):eK(e,r)}function oK(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?$q(e,n,r,i,s,a,o):tq(e,n,r,i,s,a,o)}function cK(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?qq(e,n,r,i,s):Wq(e,n,r,i,s)}function lK(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?vW():xW()}function uK(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?mW():gW()}function fK(e,t,r,n){return t.slice(-4)===".bin"?Pz(e,r,n):kz(e,r,n)}function hK(e,t,r){return eF(e,r)}function dK(e,t,r){return t.slice(-4)===".bin"?KH(e,r):GH(e,r)}function pK(e,t,r){return t.slice(-4)===".bin"?hW(e,r):oW(e,r)}function mK(e,t,r){return t.slice(-4)===".bin"?iW(e):rW(e)}function gK(e,t,r,n){return r.slice(-4)===".bin"?sW(e,t,r,n):void 0}function vK(e,t,r){return t.slice(-4)===".bin"?eW(e,t,r):tW(e,t,r)}var mF=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,gF=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ii(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var i=e.match(mF),s,a,o,c;if(i)for(c=0;c!=i.length;++c)s=i[c].match(gF),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function xK(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(mF),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(gF),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var ou;function _K(e,t){var r=ou[e]||st(e);return r==="General"?co(t):ti(r,t)}function yK(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=St(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=dr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[st(t)]=i}function EK(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Io[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=qu(e.v):e.w=co(e.v):e.w=_K(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=ou[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Jc(n)){var i=Ua(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function wK(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=yz[n.Pattern]||n.Pattern)}e[t.ID]=t}function TK(e,t,r,n,i,s,a,o,c,l){var u="General",f=n.StyleID,d={};l=l||{};var p=[],g=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&a&&(f=a.StyleID);s[f]!==void 0&&(s[f].nf&&(u=s[f].nf),s[f].Interior&&p.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=St(e);break;case"String":n.t="s",n.r=Q2(st(e)),n.v=e.indexOf("<")>-1?st(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(dr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=st(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Pb[e],l.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Q2(t||e));break}if(EK(n,u,l),l.cellFormula!==!1)if(n.Formula){var m=st(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=mc(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=mc("RC:RC",i):n.ArrayRange&&(n.F=mc(n.ArrayRange,i),c.push([Vt(n.F),n.F]))}else for(g=0;g<c.length;++g)i.r>=c[g][0].s.r&&i.r<=c[g][0].e.r&&i.c>=c[g][0].s.c&&i.c<=c[g][0].e.c&&(n.F=c[g][1]);l.cellStyles&&(p.forEach(function(v){!d.patternType&&v.patternType&&(d.patternType=v.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function SK(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function fg(e,t){var r=t||{};nb();var n=Fl(sy(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=gt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=Cr(r);return a.type="string",Yu.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(q){i.indexOf("<"+q)>=0&&(s=!0)}),s)return NK(n,r);ou={"General Number":"General","General Date":$e[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":$e[15],"Short Date":$e[14],"Long Time":$e[19],"Medium Time":$e[18],"Short Time":$e[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:$e[2],Standard:$e[4],Percent:$e[10],Scientific:$e[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l,u={},f=[],d=r.dense?[]:{},p="",g={},m={},v=ii('<Data ss:Type="String">'),_=0,x=0,y=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},S={},E="",k=0,b=[],j={},H={},O=0,V=[],G=[],X={},Z=[],ie,re=!1,B=[],ae=[],xe={},I=0,W=0,z={Sheets:[],WBProps:{date1904:!1}},U={};Xu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ee="";o=Xu.exec(n);)switch(o[3]=(ee=o[3]).toLowerCase()){case"data":if(ee=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?TK(n.slice(_,o.index),E,v,c[c.length-1][0]=="comment"?X:g,{c:x,r:y},T,Z[x],m,B,r):(E="",v=ii(o[0]),_=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(G.length>0&&(g.c=G),(!r.sheetRows||r.sheetRows>y)&&g.v!==void 0&&(r.dense?(d[y]||(d[y]=[]),d[y][x]=g):d[rr(x)+Ir(y)]=g),g.HRef&&(g.l={Target:st(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(I=x+(parseInt(g.MergeAcross,10)|0),W=y+(parseInt(g.MergeDown,10)|0),b.push({s:{c:x,r:y},e:{c:I,r:W}})),!r.sheetStubs)g.MergeAcross?x=I+1:++x;else if(g.MergeAcross||g.MergeDown){for(var oe=x;oe<=I;++oe)for(var me=y;me<=W;++me)(oe>x||me>y)&&(r.dense?(d[me]||(d[me]=[]),d[me][oe]={t:"z"}):d[rr(oe)+Ir(me)]={t:"z"});x=I+1}else++x;else g=xK(o[0]),g.Index&&(x=+g.Index-1),x<w.s.c&&(w.s.c=x),x>w.e.c&&(w.e.c=x),o[0].slice(-2)==="/>"&&++x,G=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<w.s.r&&(w.s.r=y),y>w.e.r&&(w.e.r=y),o[0].slice(-2)==="/>"&&(m=ii(o[0]),m.Index&&(y=+m.Index-1)),x=0,++y):(m=ii(o[0]),m.Index&&(y=+m.Index-1),xe={},(m.AutoFitHeight=="0"||m.Height)&&(xe.hpx=parseInt(m.Height,10),xe.hpt=Zb(xe.hpx),ae[y]=xe),m.Hidden=="1"&&(xe.hidden=!0,ae[y]=xe));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));f.push(p),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(d["!ref"]=nt(w),r.sheetRows&&r.sheetRows<=w.e.r&&(d["!fullref"]=d["!ref"],w.e.r=r.sheetRows-1,d["!ref"]=nt(w))),b.length&&(d["!merges"]=b),Z.length>0&&(d["!cols"]=Z),ae.length>0&&(d["!rows"]=ae),u[p]=d}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=x=0,c.push([o[3],!1]),l=ii(o[0]),p=st(l.Name),d=r.dense?[]:{},b=[],B=[],ae=[],U={name:p,Hidden:0},z.Sheets.push(U);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),Z=[],re=!1}break;case"style":o[1]==="/"?wK(T,S,r):S=ii(o[0]);break;case"numberformat":S.nf=st(ii(o[0]).Format||"General"),ou[S.nf]&&(S.nf=ou[S.nf]);for(var de=0;de!=392&&$e[de]!=S.nf;++de);if(de==392){for(de=57;de!=392;++de)if($e[de]==null){qa(S.nf,de);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ie=ii(o[0]),ie.Hidden&&(ie.hidden=!0,delete ie.Hidden),ie.Width&&(ie.wpx=parseInt(ie.Width,10)),!re&&ie.wpx>10){re=!0,rn=Qb;for(var ce=0;ce<Z.length;++ce)Z[ce]&&Oc(Z[ce])}re&&Oc(ie),Z[ie.Index-1||Z.length]=ie;for(var ze=0;ze<+ie.Span;++ze)Z[Z.length]=Cr(ie);break;case"namedrange":if(o[1]==="/")break;z.Names||(z.Names=[]);var M=De(o[0]),dt={Name:M.Name,Ref:mc(M.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(dt.Sheet=z.Sheets.length-1),z.Names.push(dt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?E+=n.slice(k,o.index):k=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;S.Interior=ii(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?o$(j,ee,n.slice(O,o.index)):O=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));SK(X),G.push(X)}else c.push([o[3],!1]),l=ii(o[0]),X={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var qe=ii(o[0]);d["!autofilter"]={ref:mc(qe.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return OT(n,r);var Ze=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ze=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ze=!1}break;case"excelworkbook":switch(o[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ze=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ze=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(O,o.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2;break}else O=o.index+o[0].length;break;case"header":d["!margins"]||au(d["!margins"]={},"xlml"),isNaN(+De(o[0]).Margin)||(d["!margins"].header=+De(o[0]).Margin);break;case"footer":d["!margins"]||au(d["!margins"]={},"xlml"),isNaN(+De(o[0]).Margin)||(d["!margins"].footer=+De(o[0]).Margin);break;case"pagemargins":var We=De(o[0]);d["!margins"]||au(d["!margins"]={},"xlml"),isNaN(+We.Top)||(d["!margins"].top=+We.Top),isNaN(+We.Left)||(d["!margins"].left=+We.Left),isNaN(+We.Right)||(d["!margins"].right=+We.Right),isNaN(+We.Bottom)||(d["!margins"].bottom=+We.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ze=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ze=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ze=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ze=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ze=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ze=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ze=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ze=!1}break;case"smarttags":break;default:Ze=!1;break}if(Ze||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?yK(H,ee,V,n.slice(O,o.index)):(V=o,O=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var P={};return!r.bookSheets&&!r.bookProps&&(P.Sheets=u),P.SheetNames=f,P.Workbook=z,P.SSF=Cr($e),P.Props=j,P.Custprops=H,P}function uv(e,t){switch(yy(t=t||{}),t.type||"base64"){case"base64":return fg(Vn(e),t);case"binary":case"buffer":case"file":return fg(e,t);case"array":return fg(Ao(e),t)}}function AK(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=jU(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=BU(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var kK=[60,1084,2066,2165,2175];function CK(e,t,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var c=ss(r,r.l),l=fv[c],u=0;l!=null&&kK.indexOf(c)>-1;)s=ss(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),o=r.slice(u,r.l+4+s),a.push(o),r.l+=4+s,l=fv[c=ss(r,r.l)];var f=Ls(a);yr(f,0);var d=0;f.lens=[];for(var p=0;p<a.length;++p)f.lens.push(d),d+=a[p].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,i)}function wi(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=$e[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Io[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=qu(e.v):e.w=co(e.v):e.w=ti(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Jc($e[n]||String(n))){var i=Ua(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function kh(e,t,r){return{v:e,ixfe:t,t:r}}function IK(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},a={},o=null,c=[],l="",u={},f,d="",p,g,m,v,_={},x=[],y,w,T=[],S=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},b=function(Ge){return Ge<8?Ka[Ge]:Ge<64&&S[Ge-8]||Ka[Ge]},j=function(Ge,Tt,dn){var Pt=Tt.XF.data;if(!(!Pt||!Pt.patternType||!dn||!dn.cellStyles)){Tt.s={},Tt.s.patternType=Pt.patternType;var ka;(ka=Qu(b(Pt.icvFore)))&&(Tt.s.fgColor={rgb:ka}),(ka=Qu(b(Pt.icvBack)))&&(Tt.s.bgColor={rgb:ka})}},H=function(Ge,Tt,dn){if(!(xe>1)&&!(dn.sheetRows&&Ge.r>=dn.sheetRows)){if(dn.cellStyles&&Tt.XF&&Tt.XF.data&&j(Ge,Tt,dn),delete Tt.ixfe,delete Tt.XF,f=Ge,d=Be(Ge),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),Ge.r<a.s.r&&(a.s.r=Ge.r),Ge.c<a.s.c&&(a.s.c=Ge.c),Ge.r+1>a.e.r&&(a.e.r=Ge.r+1),Ge.c+1>a.e.c&&(a.e.c=Ge.c+1),dn.cellFormula&&Tt.f){for(var Pt=0;Pt<x.length;++Pt)if(!(x[Pt][0].s.c>Ge.c||x[Pt][0].s.r>Ge.r)&&!(x[Pt][0].e.c<Ge.c||x[Pt][0].e.r<Ge.r)){Tt.F=nt(x[Pt][0]),(x[Pt][0].s.c!=Ge.c||x[Pt][0].s.r!=Ge.r)&&delete Tt.f,Tt.f&&(Tt.f=""+Vr(x[Pt][1],a,Ge,B,O));break}}dn.dense?(i[Ge.r]||(i[Ge.r]=[]),i[Ge.r][Ge.c]=Tt):i[d]=Tt}},O={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:x,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(O.password=t.password);var V,G=[],X=[],Z=[],ie=[],re=!1,B=[];B.SheetNames=O.snames,B.sharedf=O.sharedf,B.arrayf=O.arrayf,B.names=[],B.XTI=[];var ae=0,xe=0,I=0,W=[],z=[],U;O.codepage=1200,ui(1200);for(var ee=!1;e.l<e.length-1;){var oe=e.l,me=e.read_shift(2);if(me===0&&ae===10)break;var de=e.l===e.length?0:e.read_shift(2),ce=fv[me];if(ce&&ce.f){if(t.bookSheets&&ae===133&&me!==133)break;if(ae=me,ce.r===2||ce.r==12){var ze=e.read_shift(2);if(de-=2,!O.enc&&ze!==me&&((ze&255)<<8|ze>>8)!==me)throw new Error("rt mismatch: "+ze+"!="+me);ce.r==12&&(e.l+=10,de-=10)}var M={};if(me===10?M=ce.f(e,de,O):M=CK(me,ce,e,de,O),xe==0&&[9,521,1033,2057].indexOf(ae)===-1)continue;switch(me){case 34:r.opts.Date1904=E.WBProps.date1904=M;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(O.enc||(e.l=0),O.enc=M,!t.password)throw new Error("File is password-protected");if(M.valid==null)throw new Error("Encryption scheme unsupported");if(!M.valid)throw new Error("Password is incorrect");break;case 92:O.lastuser=M;break;case 66:var dt=Number(M);switch(dt){case 21010:dt=1200;break;case 32768:dt=1e4;break;case 32769:dt=1252;break}ui(O.codepage=dt),ee=!0;break;case 317:O.rrtabid=M;break;case 25:O.winlocked=M;break;case 439:r.opts.RefreshAll=M;break;case 12:r.opts.CalcCount=M;break;case 16:r.opts.CalcDelta=M;break;case 17:r.opts.CalcIter=M;break;case 13:r.opts.CalcMode=M;break;case 14:r.opts.CalcPrecision=M;break;case 95:r.opts.CalcSaveRecalc=M;break;case 15:O.CalcRefMode=M;break;case 2211:r.opts.FullCalc=M;break;case 129:M.fDialog&&(i["!type"]="dialog"),M.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),M.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:T.push(M);break;case 430:B.push([M]),B[B.length-1].XTI=[];break;case 35:case 547:B[B.length-1].push(M);break;case 24:case 536:U={Name:M.Name,Ref:Vr(M.rgce,a,null,B,O)},M.itab>0&&(U.Sheet=M.itab-1),B.names.push(U),B[0]||(B[0]=[],B[0].XTI=[]),B[B.length-1].push(M),M.Name=="_xlnm._FilterDatabase"&&M.itab>0&&M.rgce&&M.rgce[0]&&M.rgce[0][0]&&M.rgce[0][0][0]=="PtgArea3d"&&(z[M.itab-1]={ref:nt(M.rgce[0][0][1][2])});break;case 22:O.ExternCount=M;break;case 23:B.length==0&&(B[0]=[],B[0].XTI=[]),B[B.length-1].XTI=B[B.length-1].XTI.concat(M),B.XTI=B.XTI.concat(M);break;case 2196:if(O.biff<8)break;U!=null&&(U.Comment=M[1]);break;case 18:i["!protect"]=M;break;case 19:M!==0&&O.WTF&&console.error("Password verifier: "+M);break;case 133:s[M.pos]=M,O.snames.push(M.name);break;case 10:{if(--xe)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=nt(a),t.sheetRows&&t.sheetRows<=a.e.r){var qe=a.e.r;a.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=nt(a),a.e.r=qe}a.e.r++,a.e.c++}G.length>0&&(i["!merges"]=G),X.length>0&&(i["!objects"]=X),Z.length>0&&(i["!cols"]=Z),ie.length>0&&(i["!rows"]=ie),E.Sheets.push(k)}l===""?u=i:n[l]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(O.biff===8&&(O.biff={9:2,521:3,1033:4}[me]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[M.BIFFVer]||8),O.biffguess=M.BIFFVer==0,M.BIFFVer==0&&M.dt==4096&&(O.biff=5,ee=!0,ui(O.codepage=28591)),O.biff==8&&M.BIFFVer==0&&M.dt==16&&(O.biff=2),xe++)break;if(i=t.dense?[]:{},O.biff<8&&!ee&&(ee=!0,ui(O.codepage=t.codepage||1252)),O.biff<5||M.BIFFVer==0&&M.dt==4096){l===""&&(l="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Ze={pos:e.l-de,name:l};s[Ze.pos]=Ze,O.snames.push(l)}else l=(s[oe]||{name:""}).name;M.dt==32&&(i["!type"]="chart"),M.dt==64&&(i["!type"]="macro"),G=[],X=[],O.arrayf=x=[],Z=[],ie=[],re=!1,k={Hidden:(s[oe]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[M.r]||[])[M.c]:i[Be({c:M.c,r:M.r})])&&++M.c,y={ixfe:M.ixfe,XF:T[M.ixfe]||{},v:M.val,t:"n"},I>0&&(y.z=W[y.ixfe>>8&63]),wi(y,t,r.opts.Date1904),H({c:M.c,r:M.r},y,t);break;case 5:case 517:y={ixfe:M.ixfe,XF:T[M.ixfe],v:M.val,t:M.t},I>0&&(y.z=W[y.ixfe>>8&63]),wi(y,t,r.opts.Date1904),H({c:M.c,r:M.r},y,t);break;case 638:y={ixfe:M.ixfe,XF:T[M.ixfe],v:M.rknum,t:"n"},I>0&&(y.z=W[y.ixfe>>8&63]),wi(y,t,r.opts.Date1904),H({c:M.c,r:M.r},y,t);break;case 189:for(var We=M.c;We<=M.C;++We){var P=M.rkrec[We-M.c][0];y={ixfe:P,XF:T[P],v:M.rkrec[We-M.c][1],t:"n"},I>0&&(y.z=W[y.ixfe>>8&63]),wi(y,t,r.opts.Date1904),H({c:We,r:M.r},y,t)}break;case 6:case 518:case 1030:{if(M.val=="String"){o=M;break}if(y=kh(M.val,M.cell.ixfe,M.tt),y.XF=T[y.ixfe],t.cellFormula){var q=M.formula;if(q&&q[0]&&q[0][0]&&q[0][0][0]=="PtgExp"){var te=q[0][0][1][0],ge=q[0][0][1][1],ve=Be({r:te,c:ge});_[ve]?y.f=""+Vr(M.formula,a,M.cell,B,O):y.F=((t.dense?(i[te]||[])[ge]:i[ve])||{}).F}else y.f=""+Vr(M.formula,a,M.cell,B,O)}I>0&&(y.z=W[y.ixfe>>8&63]),wi(y,t,r.opts.Date1904),H(M.cell,y,t),o=M}break;case 7:case 519:if(o)o.val=M,y=kh(M,o.cell.ixfe,"s"),y.XF=T[y.ixfe],t.cellFormula&&(y.f=""+Vr(o.formula,a,o.cell,B,O)),I>0&&(y.z=W[y.ixfe>>8&63]),wi(y,t,r.opts.Date1904),H(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{x.push(M);var ue=Be(M[0].s);if(p=t.dense?(i[M[0].s.r]||[])[M[0].s.c]:i[ue],t.cellFormula&&p){if(!o||!ue||!p)break;p.f=""+Vr(M[1],a,M[0],B,O),p.F=nt(M[0])}}break;case 1212:{if(!t.cellFormula)break;if(d){if(!o)break;_[Be(o.cell)]=M[0],p=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[Be(o.cell)],(p||{}).f=""+Vr(M[0],a,f,B,O)}}break;case 253:y=kh(c[M.isst].t,M.ixfe,"s"),c[M.isst].h&&(y.h=c[M.isst].h),y.XF=T[y.ixfe],I>0&&(y.z=W[y.ixfe>>8&63]),wi(y,t,r.opts.Date1904),H({c:M.c,r:M.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:M.ixfe,XF:T[M.ixfe],t:"z"},I>0&&(y.z=W[y.ixfe>>8&63]),wi(y,t,r.opts.Date1904),H({c:M.c,r:M.r},y,t));break;case 190:if(t.sheetStubs)for(var Ie=M.c;Ie<=M.C;++Ie){var Ke=M.ixfe[Ie-M.c];y={ixfe:Ke,XF:T[Ke],t:"z"},I>0&&(y.z=W[y.ixfe>>8&63]),wi(y,t,r.opts.Date1904),H({c:Ie,r:M.r},y,t)}break;case 214:case 516:case 4:y=kh(M.val,M.ixfe,"s"),y.XF=T[y.ixfe],I>0&&(y.z=W[y.ixfe>>8&63]),wi(y,t,r.opts.Date1904),H({c:M.c,r:M.r},y,t);break;case 0:case 512:xe===1&&(a=M);break;case 252:c=M;break;case 1054:if(O.biff==4){W[I++]=M[1];for(var at=0;at<I+163&&$e[at]!=M[1];++at);at>=163&&qa(M[1],I+163)}else qa(M[1],M[0]);break;case 30:{W[I++]=M;for(var Qr=0;Qr<I+163&&$e[Qr]!=M;++Qr);Qr>=163&&qa(M,I+163)}break;case 229:G=G.concat(M);break;case 93:X[M.cmo[0]]=O.lastobj=M;break;case 438:O.lastobj.TxO=M;break;case 127:O.lastobj.ImData=M;break;case 440:for(v=M[0].s.r;v<=M[0].e.r;++v)for(m=M[0].s.c;m<=M[0].e.c;++m)p=t.dense?(i[v]||[])[m]:i[Be({c:m,r:v})],p&&(p.l=M[1]);break;case 2048:for(v=M[0].s.r;v<=M[0].e.r;++v)for(m=M[0].s.c;m<=M[0].e.c;++m)p=t.dense?(i[v]||[])[m]:i[Be({c:m,r:v})],p&&p.l&&(p.l.Tooltip=M[1]);break;case 28:{if(O.biff<=5&&O.biff>=2)break;p=t.dense?(i[M[0].r]||[])[M[0].c]:i[Be(M[0])];var Aa=X[M[2]];p||(t.dense?(i[M[0].r]||(i[M[0].r]=[]),p=i[M[0].r][M[0].c]={t:"z"}):p=i[Be(M[0])]={t:"z"},a.e.r=Math.max(a.e.r,M[0].r),a.s.r=Math.min(a.s.r,M[0].r),a.e.c=Math.max(a.e.c,M[0].c),a.s.c=Math.min(a.s.c,M[0].c)),p.c||(p.c=[]),g={a:M[1],t:Aa.TxO.t},p.c.push(g)}break;case 2173:Yz(T[M.ixfe],M.ext);break;case 125:{if(!O.cellStyles)break;for(;M.e>=M.s;)Z[M.e--]={width:M.w/256,level:M.level||0,hidden:!!(M.flags&1)},re||(re=!0,my(M.w/256)),Oc(Z[M.e+1])}break;case 520:{var Jt={};M.level!=null&&(ie[M.r]=Jt,Jt.level=M.level),M.hidden&&(ie[M.r]=Jt,Jt.hidden=!0),M.hpt&&(ie[M.r]=Jt,Jt.hpt=M.hpt,Jt.hpx=Ju(M.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||au(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[me]]=M;break;case 161:i["!margins"]||au(i["!margins"]={}),i["!margins"].header=M.header,i["!margins"].footer=M.footer;break;case 574:M.RTL&&(E.Views[0].RTL=!0);break;case 146:S=M;break;case 2198:V=M;break;case 140:w=M;break;case 442:l?k.CodeName=M||k.name:E.WBProps.CodeName=M||"ThisWorkbook";break}}else ce||console.error("Missing Info for XLS Record 0x"+me.toString(16)),e.l+=de}return r.SheetNames=zi(s).sort(function(hn,Ge){return Number(hn)-Number(Ge)}).map(function(hn){return s[hn].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&z.forEach(function(hn,Ge){r.Sheets[r.SheetNames[Ge]]["!autofilter"]=hn}),r.Strings=c,r.SSF=Cr($e),O.enc&&(r.Encryption=O.enc),V&&(r.Themes=V),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),B.names.length>0&&(E.Names=B.names),r.Workbook=E,r}var bT={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function RK(e,t,r){var n=tt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=dT(n,GU,bT.DSI);for(var s in i)t[s]=i[s]}catch(l){if(r.WTF)throw l}var a=tt.find(e,"/!SummaryInformation");if(a&&a.size>0)try{var o=dT(a,qU,bT.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(l){if(r.WTF)throw l}t.HeadingPairs&&t.TitlesOfParts&&(Db(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function vF(e,t){t||(t={}),yy(t),W4(),t.codepage&&J_(t.codepage);var r,n;if(e.FullPaths){if(tt.find(e,"/encryption"))throw new Error("File is password-protected");r=tt.find(e,"!CompObj"),n=tt.find(e,"/Workbook")||tt.find(e,"/Book")}else{switch(t.type){case"base64":e=li(Vn(e));break;case"binary":e=li(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}yr(e,0),n={content:e}}var i,s;if(r&&AK(r),t.bookProps&&!t.bookSheets)i={};else{var a=Je?"buffer":"array";if(n&&n.content)i=IK(n.content,t);else if((s=tt.find(e,"PerfectOffice_MAIN"))&&s.content)i=iu.to_workbook(s.content,(t.type=a,t));else if((s=tt.find(e,"NativeContent_MAIN"))&&s.content)i=iu.to_workbook(s.content,(t.type=a,t));else throw(s=tt.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&tt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=pW(e))}var o={};return e.FullPaths&&RK(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}var v0={0:{f:uq},1:{f:pq},2:{f:Tq},3:{f:xq},4:{f:gq},5:{f:wq},6:{f:kq},7:{f:yq},8:{f:Fq},9:{f:bq},10:{f:Iq},11:{f:Rq},12:{f:mq},13:{f:Sq},14:{f:_q},15:{f:vq},16:{f:hF},17:{f:Cq},18:{f:Eq},19:{f:ly},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:iK},40:{},42:{},43:{f:Iz},44:{f:Cz},45:{f:Rz},46:{f:Fz},47:{f:bz},48:{},49:{f:PU},50:{},51:{f:Jz},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Gb},62:{f:Aq},63:{f:nW},64:{f:Bq},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Xr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:jq},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:dq},148:{f:fq,p:16},151:{f:Dq},152:{},153:{f:rK},154:{},155:{},156:{f:tK},157:{},158:{},159:{T:1,f:qH},160:{T:-1},161:{T:1,f:Co},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Pq},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Qz},336:{T:-1},337:{f:Zz,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:av},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Wb},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Oq},427:{f:Lq},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Vq},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:hq},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Nq},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:av},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:fW},633:{T:1},634:{T:-1},635:{T:1,f:uW},636:{T:-1},637:{f:DU},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Gq},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Uq},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},fv={6:{f:lg},10:{f:As},12:{f:qt},13:{f:qt},14:{f:Bt},15:{f:Bt},16:{f:Ur},17:{f:Bt},18:{f:Bt},19:{f:qt},20:{f:vT},21:{f:vT},23:{f:Wb},24:{f:_T},25:{f:Bt},26:{},27:{},28:{f:cH},29:{},34:{f:Bt},35:{f:xT},38:{f:Ur},39:{f:Ur},40:{f:Ur},41:{f:Ur},42:{f:Bt},43:{f:Bt},47:{f:hz},49:{f:H$},51:{f:qt},60:{},61:{f:B$},64:{f:Bt},65:{f:$$},66:{f:qt},77:{},80:{},81:{},82:{},85:{f:qt},89:{},90:{},91:{},92:{f:P$},93:{f:uH},94:{},95:{f:Bt},96:{},97:{},99:{f:Bt},125:{f:Gb},128:{f:Z$},129:{f:N$},130:{f:qt},131:{f:Bt},132:{f:Bt},133:{f:D$},134:{},140:{f:gH},141:{f:qt},144:{},146:{f:xH},151:{},152:{},153:{},154:{},155:{},156:{f:qt},157:{},158:{},160:{f:TH},161:{f:yH},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:X$},190:{f:Y$},193:{f:As},197:{},198:{},199:{},200:{},201:{},202:{f:Bt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:qt},220:{},221:{f:Bt},222:{},224:{f:J$},225:{f:F$},226:{f:As},227:{},229:{f:lH},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:O$},253:{f:z$},255:{f:L$},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:jb},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Bt},353:{f:As},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:tH},431:{f:Bt},432:{},433:{},434:{},437:{},438:{f:dH},439:{f:Bt},440:{f:pH},441:{},442:{f:Vf},443:{},444:{f:qt},445:{},446:{},448:{f:As},449:{f:j$,r:2},450:{f:As},512:{f:mT},513:{f:wH},515:{f:eH},516:{f:W$},517:{f:gT},519:{f:SH},520:{f:M$},523:{},545:{f:yT},549:{f:pT},566:{},574:{f:U$},638:{f:K$},659:{},1048:{},1054:{f:G$},1084:{},1212:{f:sH},2048:{f:mH},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Th},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:As},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:_H,r:12},2173:{f:Xz,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Bt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:iH,r:12},2197:{},2198:{f:Hz,r:12},2199:{},2200:{},2201:{},2202:{f:aH,r:12},2203:{f:As},2204:{},2205:{},2206:{},2207:{},2211:{f:V$},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:qt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:EH},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:vH},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:mT},1:{},2:{f:IH},3:{f:CH},4:{f:kH},5:{f:gT},7:{f:RH},8:{},9:{f:Th},11:{},22:{f:qt},30:{f:q$},31:{},32:{},33:{f:yT},36:{},37:{f:pT},50:{f:bH},62:{},52:{},67:{},68:{f:qt},69:{},86:{},126:{},127:{f:AH},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:FH},223:{},234:{},354:{},421:{},518:{f:lg},521:{f:Th},536:{f:_T},547:{f:xT},561:{},579:{},1030:{f:lg},1033:{f:Th},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function si(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&kb(r)&&e.push(r)}}function FT(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),a=i.index,o=s&&s.index||e.length,c=tU(e.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,u=0,f=0,d=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(a=0;a<c.length;++a){var m=c[a].trim(),v=m.slice(0,3).toLowerCase();if(v=="<tr"){if(++l,r.sheetRows&&r.sheetRows<=l){--l;break}u=0;continue}if(!(v!="<td"&&v!="<th")){var _=m.split(/<\/t[dh]>/i);for(o=0;o<_.length;++o){var x=_[o].trim();if(x.match(/<t[dh]/i)){for(var y=x,w=0;y.charAt(0)=="<"&&(w=y.indexOf(">"))>-1;)y=y.slice(w+1);for(var T=0;T<g.length;++T){var S=g[T];S.s.c==u&&S.s.r<l&&l<=S.e.r&&(u=S.e.c+1,T=-1)}var E=De(x.slice(0,x.indexOf(">")));d=E.colspan?+E.colspan:1,((f=+E.rowspan)>1||d>1)&&g.push({s:{r:l,c:u},e:{r:l+(f||1)-1,c:u+d-1}});var k=E.t||E["data-t"]||"";if(!y.length){u+=d;continue}if(y=db(y),p.s.r>l&&(p.s.r=l),p.e.r<l&&(p.e.r=l),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!y.length){u+=d;continue}var b={t:"s",v:y};r.raw||!y.trim().length||k=="s"||(y==="TRUE"?b={t:"b",v:!0}:y==="FALSE"?b={t:"b",v:!1}:isNaN(pi(y))?isNaN(Dc(y).getDate())||(b={t:"d",v:dr(y)},r.cellDates||(b={t:"n",v:cn(b.v)}),b.z=r.dateNF||$e[14]):b={t:"n",v:pi(y)}),r.dense?(n[l]||(n[l]=[]),n[l][u]=b):n[Be({r:l,c:u})]=b,u+=d}}}}return n["!ref"]=nt(p),g.length&&(n["!merges"]=g),n}function bK(e,t,r,n){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,c=0,l=0;l<i.length;++l)if(!(i[l].s.r>r||i[l].s.c>a)&&!(i[l].e.r<r||i[l].e.c<a)){if(i[l].s.r<r||i[l].s.c<a){o=-1;break}o=i[l].e.r-i[l].s.r+1,c=i[l].e.c-i[l].s.c+1;break}if(!(o<0)){var u=Be({r,c:a}),f=n.dense?(e[r]||[])[a]:e[u],d=f&&f.v!=null&&(f.h||iy(f.w||(xs(f),f.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),n.editable?d='<span contenteditable="true">'+d+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+f.l.Target+'">'+d+"</a>")),p.id=(n.id||"sjs")+"-"+u,s.push(gU("td",d,p))}}var g="<tr>";return g+s.join("")+"</tr>"}var FK='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',PK="</body></html>";function NK(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Sa(FT(r[0],t),t);var n=wy();return r.forEach(function(i,s){Ty(n,FT(i,t),"Sheet"+(s+1))}),n}function DK(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function OK(e,t){var r=t||{},n=r.header!=null?r.header:FK,i=r.footer!=null?r.footer:PK,s=[n],a=Zc(e["!ref"]);r.dense=Array.isArray(e),s.push(DK(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(bK(e,a,o,r));return s.push("</table>"+i),s.join("")}function xF(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?sn(n.origin):n.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=Zc(e["!ref"]);l.s.r=Math.min(l.s.r,u.s.r),l.s.c=Math.min(l.s.c,u.s.c),l.e.r=Math.max(l.e.r,u.e.r),l.e.c=Math.max(l.e.c,u.e.c),i==-1&&(l.e.r=i=u.e.r+1)}var f=[],d=0,p=e["!rows"]||(e["!rows"]=[]),g=0,m=0,v=0,_=0,x=0,y=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&m<c;++g){var w=o[g];if(PT(w)){if(n.display)continue;p[m]={hidden:!0}}var T=w.children;for(v=_=0;v<T.length;++v){var S=T[v];if(!(n.display&&PT(S))){var E=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):db(S.innerHTML),k=S.getAttribute("data-z")||S.getAttribute("z");for(d=0;d<f.length;++d){var b=f[d];b.s.c==_+s&&b.s.r<m+i&&m+i<=b.e.r&&(_=b.e.c+1-s,d=-1)}y=+S.getAttribute("colspan")||1,((x=+S.getAttribute("rowspan")||1)>1||y>1)&&f.push({s:{r:m+i,c:_+s},e:{r:m+i+(x||1)-1,c:_+s+(y||1)-1}});var j={t:"s",v:E},H=S.getAttribute("data-t")||S.getAttribute("t")||"";E!=null&&(E.length==0?j.t=H||"z":n.raw||E.trim().length==0||H=="s"||(E==="TRUE"?j={t:"b",v:!0}:E==="FALSE"?j={t:"b",v:!1}:isNaN(pi(E))?isNaN(Dc(E).getDate())||(j={t:"d",v:dr(E)},n.cellDates||(j={t:"n",v:cn(j.v)}),j.z=n.dateNF||$e[14]):j={t:"n",v:pi(E)})),j.z===void 0&&k!=null&&(j.z=k);var O="",V=S.getElementsByTagName("A");if(V&&V.length)for(var G=0;G<V.length&&!(V[G].hasAttribute("href")&&(O=V[G].getAttribute("href"),O.charAt(0)!="#"));++G);O&&O.charAt(0)!="#"&&(j.l={Target:O}),n.dense?(e[m+i]||(e[m+i]=[]),e[m+i][_+s]=j):e[Be({c:_+s,r:m+i})]=j,l.e.c<_+s&&(l.e.c=_+s),_+=y}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),l.e.r=Math.max(l.e.r,m-1+i),e["!ref"]=nt(l),m>=c&&(e["!fullref"]=nt((l.e.r=o.length-g+m-1+i,l))),e}function _F(e,t){var r=t||{},n=r.dense?[]:{};return xF(n,e,t)}function LK(e,t){return Sa(_F(e,t),t)}function PT(e){var t="",r=MK(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function MK(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function VK(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=st(t.replace(/<[^>]*>/g,""));return[r]}var NT={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function yF(e,t){var r=t||{},n=sy(e),i=[],s,a,o={name:""},c="",l=0,u,f,d={},p=[],g=r.dense?[]:{},m,v,_={value:""},x="",y=0,w=[],T=-1,S=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,b={},j=[],H={},O=0,V=0,G=[],X=1,Z=1,ie=[],re={Names:[]},B={},ae=["",""],xe=[],I={},W="",z=0,U=!1,ee=!1,oe=0;for(Xu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Xu.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"工作表":m[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?g["!ref"]=nt(E):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(g["!fullref"]=g["!ref"],E.e.r=r.sheetRows-1,g["!ref"]=nt(E)),j.length&&(g["!merges"]=j),G.length&&(g["!rows"]=G),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),d[u.name]=g,ee=!1):m[0].charAt(m[0].length-2)!=="/"&&(u=De(m[0],!1),T=S=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,g=r.dense?[]:{},j=[],G=[],ee=!0);break;case"table-row-group":m[1]==="/"?--k:++k;break;case"table-row":case"行":if(m[1]==="/"){T+=X,X=1;break}if(f=De(m[0],!1),f.行号?T=f.行号-1:T==-1&&(T=0),X=+f["number-rows-repeated"]||1,X<10)for(oe=0;oe<X;++oe)k>0&&(G[T+oe]={level:k});S=-1;break;case"covered-table-cell":m[1]!=="/"&&++S,r.sheetStubs&&(r.dense?(g[T]||(g[T]=[]),g[T][S]={t:"z"}):g[Be({r:T,c:S})]={t:"z"}),x="",w=[];break;case"table-cell":case"数据":if(m[0].charAt(m[0].length-2)==="/")++S,_=De(m[0],!1),Z=parseInt(_["number-columns-repeated"]||"1",10),v={t:"z",v:null},_.formula&&r.cellFormula!=!1&&(v.f=CT(st(_.formula))),(_.数据类型||_["value-type"])=="string"&&(v.t="s",v.v=st(_["string-value"]||""),r.dense?(g[T]||(g[T]=[]),g[T][S]=v):g[Be({r:T,c:S})]=v),S+=Z-1;else if(m[1]!=="/"){++S,x="",y=0,w=[],Z=1;var me=X?T+X-1:T;if(S>E.e.c&&(E.e.c=S),S<E.s.c&&(E.s.c=S),T<E.s.r&&(E.s.r=T),me>E.e.r&&(E.e.r=me),_=De(m[0],!1),xe=[],I={},v={t:_.数据类型||_["value-type"],v:null},r.cellFormula)if(_.formula&&(_.formula=st(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(O=parseInt(_["number-matrix-rows-spanned"],10)||0,V=parseInt(_["number-matrix-columns-spanned"],10)||0,H={s:{r:T,c:S},e:{r:T+O-1,c:S+V-1}},v.F=nt(H),ie.push([H,v.F])),_.formula)v.f=CT(_.formula);else for(oe=0;oe<ie.length;++oe)T>=ie[oe][0].s.r&&T<=ie[oe][0].e.r&&S>=ie[oe][0].s.c&&S<=ie[oe][0].e.c&&(v.F=ie[oe][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(O=parseInt(_["number-rows-spanned"],10)||0,V=parseInt(_["number-columns-spanned"],10)||0,H={s:{r:T,c:S},e:{r:T+O-1,c:S+V-1}},j.push(H)),_["number-columns-repeated"]&&(Z=parseInt(_["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=St(_["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(_.value);break;case"percentage":v.t="n",v.v=parseFloat(_.value);break;case"currency":v.t="n",v.v=parseFloat(_.value);break;case"date":v.t="d",v.v=dr(_["date-value"]),r.cellDates||(v.t="n",v.v=cn(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=J7(_["time-value"])/86400,r.cellDates&&(v.t="d",v.v=bp(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(_.数据数值);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",_["string-value"]!=null&&(x=st(_["string-value"]),w=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(U=!1,v.t==="s"&&(v.v=x||"",w.length&&(v.R=w),U=y==0),B.Target&&(v.l=B),xe.length>0&&(v.c=xe,xe=[]),x&&r.cellText!==!1&&(v.w=x),U&&(v.t="z",delete v.v),(!U||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=T))for(var de=0;de<X;++de){if(Z=parseInt(_["number-columns-repeated"]||"1",10),r.dense)for(g[T+de]||(g[T+de]=[]),g[T+de][S]=de==0?v:Cr(v);--Z>0;)g[T+de][S+Z]=Cr(v);else for(g[Be({r:T+de,c:S})]=v;--Z>0;)g[Be({r:T+de,c:S+Z})]=Cr(v);E.e.c<=S&&(E.e.c=S)}Z=parseInt(_["number-columns-repeated"]||"1",10),S+=Z-1,Z=0,v={},x="",w=[]}B={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;I.t=x,w.length&&(I.R=w),I.a=W,xe.push(I)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);W="",z=0,x="",y=0,w=[];break;case"creator":m[1]==="/"?W=n.slice(z,m.index):z=m.index+m[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);x="",y=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(b[o.name]=c,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(c="",o=De(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=De(m[0],!1),c+=NT[m[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=De(m[0],!1),c+=NT[m[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(l,m.index);break}else l=m.index+m[0].length;break;case"named-range":a=De(m[0],!1),ae=ug(a["cell-range-address"]);var ce={Name:a.name,Ref:ae[0]+"!"+ae[1]};ee&&(ce.Sheet=p.length),re.Names.push(ce);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!_||!_["string-value"])){var ze=VK(n.slice(y,m.index));x=(x.length>0?x+`
`:"")+ze[0]}else De(m[0],!1),y=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{ae=ug(De(m[0])["target-range-address"]),d[ae[0]]["!autofilter"]={ref:ae[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(B=De(m[0],!1),!B.href)break;B.Target=st(B.href),delete B.href,B.Target.charAt(0)=="#"&&B.Target.indexOf(".")>-1?(ae=ug(B.Target.slice(1)),B.Target="#"+ae[0]+"!"+ae[1]):B.Target.match(/^\.\.[\\\/]/)&&(B.Target=B.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(m)}}var M={Sheets:d,SheetNames:p,Workbook:re};return r.bookSheets&&delete M.Sheets,M}function DT(e,t){t=t||{},Wn(e,"META-INF/manifest.xml")&&e$(Gt(e,"META-INF/manifest.xml"),t);var r=In(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=yF(gt(r),t);return Wn(e,"meta.xml")&&(n.Props=Nb(Gt(e,"meta.xml"))),n}function OT(e,t){return yF(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function xy(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function hv(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):gt(Ao(e))}function dv(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function LT(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function jK(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Zu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ir(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function $r(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=Zu(e,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Zu(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var l={data:o,type:s};t[i]==null?t[i]=[l]:t[i].push(l)}return t}function _y(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function BK(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=Zu(e,n),s=$r(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:ir(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=$r(o.data),l=ir(c[3][0].data);a.messages.push({meta:c,data:e.slice(n[0],n[0]+l)}),n[0]+=l}),(t=s[3])!=null&&t[0]&&(a.merge=ir(s[3][0].data)>>>0>0),r.push(a)}return r}function UK(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Zu(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,l=0;if(s==1?(l=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(l=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[dv(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(i.push(i[0].slice(-c)),l-=c;l>=i[i.length-1].length;)i.push(i[i.length-1]),l-=i[i.length-1].length;i.push(i[0].slice(-c,-c+l))}}var u=dv(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function $K(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(UK(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return dv(t)}function HK(e,t,r,n){var i=xy(e),s=i.getUint32(4,!0),a=(n>1?12:8)+LT(s&(n>1?3470:398))*4,o=-1,c=-1,l=NaN,u=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=LT(s&(n>1?12288:4096))*4,s&16&&(c=i.getUint32(a,!0),a+=4),s&32&&(l=i.getFloat64(a,!0),a+=8),s&64&&(u.setTime(u.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:l>0};break;case 7:f={t:"n",v:l/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(l))f={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function zK(e,t,r){var n=xy(e),i=n.getUint32(8,!0),s=12,a=-1,o=-1,c=NaN,l=NaN,u=new Date(2001,0,1);i&1&&(c=jK(e,s),s+=16),i&2&&(l=n.getFloat64(s,!0),s+=8),i&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:l>0};break;case 7:f={t:"n",v:l/86400};break;case 8:f={t:"e",v:0};break;case 9:if(a>-1)f={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return f}function WK(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return HK(e,t,r,e[0]);case 5:return zK(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ia(e){var t=$r(e);return Zu(t[1][0].data)}function MT(e,t){var r=$r(t.data),n=ir(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=$r(a.data),c=ir(o[1][0].data)>>>0;switch(n){case 1:s[c]=hv(o[3][0].data);break;case 8:{var l=e[ia(o[9][0].data)][0],u=$r(l.data),f=e[ia(u[1][0].data)][0],d=ir(f.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var p=$r(f.data);s[c]=p[3].map(function(g){return hv(g.data)}).join("")}break}}),s}function GK(e,t){var r,n,i,s,a,o,c,l,u,f,d,p,g,m,v=$r(e),_=ir(v[1][0].data)>>>0,x=ir(v[2][0].data)>>>0,y=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&ir(v[8][0].data)>0||!1,w,T;if((s=(i=v[7])==null?void 0:i[0])!=null&&s.data&&t!=0)w=(o=(a=v[7])==null?void 0:a[0])==null?void 0:o.data,T=(l=(c=v[6])==null?void 0:c[0])==null?void 0:l.data;else if((f=(u=v[4])==null?void 0:u[0])!=null&&f.data&&t!=1)w=(p=(d=v[4])==null?void 0:d[0])==null?void 0:p.data,T=(m=(g=v[3])==null?void 0:g[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var S=y?4:1,E=xy(w),k=[],b=0;b<w.length/2;++b){var j=E.getUint16(b*2,!0);j<65535&&k.push([b,j])}if(k.length!=x)throw"Expected ".concat(x," cells, found ").concat(k.length);var H=[];for(b=0;b<k.length-1;++b)H[k[b][0]]=T.subarray(k[b][1]*S,k[b+1][1]*S);return k.length>=1&&(H[k[k.length-1][0]]=T.subarray(k[k.length-1][1]*S)),{R:_,cells:H}}function qK(e,t){var r,n=$r(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?ir(n[7][0].data)>>>0>0?1:0:-1,s=_y(n[5],function(a){return GK(a,i)});return{nrows:ir(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(c,l){if(a[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));a[o.R][l]=c}),a},[])}}function KK(e,t,r){var n,i=$r(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(ir(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(ir(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=nt(s);var a=$r(i[4][0].data),o=MT(e,e[ia(a[4][0].data)][0]),c=(n=a[17])!=null&&n[0]?MT(e,e[ia(a[17][0].data)][0]):[],l=$r(a[3][0].data),u=0;l[1].forEach(function(f){var d=$r(f.data),p=e[ia(d[2][0].data)][0],g=ir(p.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var m=qK(e,p);m.data.forEach(function(v,_){v.forEach(function(x,y){var w=Be({r:u+_,c:y}),T=WK(x,o,c);T&&(r[w]=T)})}),u+=m.nrows})}function XK(e,t){var r=$r(t.data),n={"!ref":"A1"},i=e[ia(r[2][0].data)],s=ir(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return KK(e,i[0],n),n}function YK(e,t){var r,n=$r(t.data),i={name:(r=n[1])!=null&&r[0]?hv(n[1][0].data):"",sheets:[]},s=_y(n[2],ia);return s.forEach(function(a){e[a].forEach(function(o){var c=ir(o.meta[1][0].data);c==6e3&&i.sheets.push(XK(e,o))})}),i}function QK(e,t){var r=wy(),n=$r(t.data),i=_y(n[1],ia);if(i.forEach(function(s){e[s].forEach(function(a){var o=ir(a.meta[1][0].data);if(o==2){var c=YK(e,a);c.sheets.forEach(function(l,u){Ty(r,l,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function hg(e){var t,r,n,i,s={},a=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=$K(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var u;try{u=BK(l)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){s[f.id]=f.messages,a.push(f.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&ir(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(c){s[c].forEach(function(l){var u=ir(l.meta[1][0].data)>>>0;if(u==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return QK(s,o)}function JK(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function yy(e){JK([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function ZK(e){return tc.WS.indexOf(e)>-1?"sheet":e==tc.CS?"chart":e==tc.DS?"dialog":e==tc.MS?"macro":e&&e.length?e:"sheet"}function eX(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,ZK(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function tX(e,t,r,n,i,s,a,o,c,l,u,f){try{s[n]=ru(In(e,r,!0),t);var d=Gt(e,t),p;switch(o){case"sheet":p=oK(d,t,i,c,s[n],l,u,f);break;case"chart":if(p=cK(d,t,i,c,s[n],l,u,f),!p||!p["!drawel"])break;var g=Nl(p["!drawel"].Target,t),m=ov(g),v=aW(In(e,g,!0),ru(In(e,m,!0),g)),_=Nl(v,g),x=ov(_);p=zq(In(e,_,!0),_,c,ru(In(e,x,!0),_),l,p);break;case"macro":p=lK(d,t,i,c,s[n],l,u,f);break;case"dialog":p=uK(d,t,i,c,s[n],l,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=p;var y=[];s&&s[n]&&zi(s[n]).forEach(function(w){var T="";if(s[n][w].Type==tc.CMNT){T=Nl(s[n][w].Target,t);var S=pK(Gt(e,T,!0),T,c);if(!S||!S.length)return;wT(p,S,!1)}s[n][w].Type==tc.TCMNT&&(T=Nl(s[n][w].Target,t),y=y.concat(cW(Gt(e,T,!0),c)))}),y&&y.length&&wT(p,y,!0,c.people||[])}catch(w){if(c.WTF)throw w}}function Hn(e){return e.charAt(0)=="/"?e.slice(1):e}function rX(e,t){if(nb(),t=t||{},yy(t),Wn(e,"META-INF/manifest.xml")||Wn(e,"objectdata.xml"))return DT(e,t);if(Wn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof hg<"u"){if(e.FileIndex)return hg(e);var r=tt.utils.cfb_new();return X2(e).forEach(function(G){nU(r,G,lb(e,G))}),hg(r)}throw new Error("Unsupported NUMBERS file")}if(!Wn(e,"[Content_Types].xml"))throw Wn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Wn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=X2(e),i=JU(In(e,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Gt(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Gt(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},l={};if(!t.bookSheets&&!t.bookProps){if(su=[],i.sst)try{su=dK(Gt(e,Hn(i.sst)),i.sst,t)}catch(G){if(t.WTF)throw G}t.cellStyles&&i.themes.length&&(c=hK(In(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(l=fK(Gt(e,Hn(i.style)),i.style,c,t))}i.links.map(function(G){try{var X=ru(In(e,ov(Hn(G))),G);return gK(Gt(e,Hn(G)),X,G,t)}catch{}});var u=aK(Gt(e,Hn(i.workbooks[0])),i.workbooks[0],t),f={},d="";i.coreprops.length&&(d=Gt(e,Hn(i.coreprops[0]),!0),d&&(f=Nb(d)),i.extprops.length!==0&&(d=Gt(e,Hn(i.extprops[0]),!0),d&&n$(d,f,t)));var p={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(d=In(e,Hn(i.custprops[0]),!0),d&&(p=s$(d,t)));var g={};if((t.bookSheets||t.bookProps)&&(u.Sheets?a=u.Sheets.map(function(X){return X.name}):f.Worksheets&&f.SheetNames.length>0&&(a=f.SheetNames),t.bookProps&&(g.Props=f,g.Custprops=p),t.bookSheets&&typeof a<"u"&&(g.SheetNames=a),t.bookSheets?g.SheetNames:t.bookProps))return g;a={};var m={};t.bookDeps&&i.calcchain&&(m=mK(Gt(e,Hn(i.calcchain)),i.calcchain));var v=0,_={},x,y;{var w=u.Sheets;f.Worksheets=w.length,f.SheetNames=[];for(var T=0;T!=w.length;++T)f.SheetNames[T]=w[T].name}var S=s?"bin":"xml",E=i.workbooks[0].lastIndexOf("/"),k=(i.workbooks[0].slice(0,E+1)+"_rels/"+i.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");Wn(e,k)||(k="xl/_rels/workbook."+S+".rels");var b=ru(In(e,k,!0),k.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=vK(Gt(e,Hn(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=lW(Gt(e,Hn(i.people[0])),t)),b&&(b=eX(b,u.Sheets));var j=Gt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=f.Worksheets;++v){var H="sheet";if(b&&b[v]?(x="xl/"+b[v][1].replace(/[\/]?xl\//,""),Wn(e,x)||(x=b[v][1]),Wn(e,x)||(x=k.replace(/_rels\/.*$/,"")+b[v][1]),H=b[v][2]):(x="xl/worksheets/sheet"+(v+1-j)+"."+S,x=x.replace(/sheet0\./,"sheet.")),y=x.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(f.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var O=!1,V=0;V!=t.sheets.length;++V)typeof t.sheets[V]=="number"&&t.sheets[V]==v&&(O=1),typeof t.sheets[V]=="string"&&t.sheets[V].toLowerCase()==f.SheetNames[v].toLowerCase()&&(O=1);if(!O)continue e}}tX(e,x,y,f.SheetNames[v],v,_,a,H,t,u,c,l)}return g={Directory:i,Workbook:u,Props:f,Custprops:p,Deps:m,Sheets:a,SheetNames:f.SheetNames,Strings:su,Styles:l,Themes:c,SSF:Cr($e)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(G,X){G=G.replace(/^Root Entry[\/]/,""),g.keys.push(G),g.files[G]=e.FileIndex[X]}))),t&&t.bookVBA&&(i.vba.length>0?g.vbaraw=Gt(e,Hn(i.vba[0]),!0):i.defaults&&i.defaults.bin===dW&&(g.vbaraw=Gt(e,"xl/vbaProject.bin",!0))),g}function nX(e,t){var r=t||{},n="Workbook",i=tt.find(e,n);try{if(n="/!DataSpaces/Version",i=tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(XH(i.content),n="/!DataSpaces/DataSpaceMap",i=tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=QH(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=JH(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);ez(i.content)}catch{}if(n="/EncryptionInfo",i=tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=tz(i.content);if(n="/EncryptedPackage",i=tt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function Ey(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Vn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function iX(e,t){return tt.find(e,"EncryptedPackage")?nX(e,t):vF(e,t)}function sX(e,t){var r,n=e,i=t||{};return i.type||(i.type=Je&&Buffer.isBuffer(e)?"buffer":"base64"),r=ub(n,i),rX(r,i)}function EF(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return uv(e.slice(r),t);default:break e}return Yu.to_workbook(e,t)}function aX(e,t){var r="",n=Ey(e,t);switch(t.type){case"base64":r=Vn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=lo(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=gt(r)),t.type="binary",EF(r,t)}function oX(e,t){var r=e;return t.type=="base64"&&(r=Vn(r)),r=Os.utils.decode(1200,r.slice(2),"str"),t.type="binary",EF(r,t)}function cX(e){return e.match(/[^\x00-\x7F]/)?Dl(e):e}function dg(e,t,r,n){return n?(r.type="string",Yu.to_workbook(e,r)):Yu.to_workbook(t,r)}function pv(e,t){W4();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return pv(new Uint8Array(e),(r=Cr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),gc={},r.dateNF&&(gc.dateNF=r.dateNF),r.type||(r.type=Je&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Je?"buffer":"binary",n=Y7(e),typeof Uint8Array<"u"&&!Je&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=cX(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=Cr(r),r.type="array",pv(Z_(n),r)}switch((i=Ey(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return iX(tt.read(n,r),r);break;case 9:if(i[1]<=8)return vF(n,r);break;case 60:return uv(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return LH(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return DH.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?sX(n,r):dg(e,n,r,s);case 239:return i[3]===60?uv(n,r):dg(e,n,r,s);case 255:if(i[1]===254)return oX(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return iu.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return iu.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return ET.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return dz.to_workbook(n,r);break;case 10:case 13:case 32:return aX(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return PH.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?ET.to_workbook(n,r):dg(e,n,r,s)}function lX(e,t,r,n,i,s,a,o){var c=Ir(r),l=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||e[r])for(var p=t.s.c;p<=t.e.c;++p){var g=a?e[r][p]:e[n[p]+c];if(g===void 0||g.t===void 0){if(l===void 0)continue;s[p]!=null&&(d[s[p]]=l);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[p]!=null){if(m==null)if(g.t=="e"&&m===null)d[s[p]]=null;else if(l!==void 0)d[s[p]]=l;else if(u&&m===null)d[s[p]]=null;else continue;else d[s[p]]=u&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?m:xs(g,m,o);m!=null&&(f=!1)}}return{row:d,isempty:f}}function mv(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},u=l.range!=null?l.range:e["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof u){case"string":c=Vt(u);break;case"number":c=Vt(e["!ref"]),c.s.r=u;break;default:c=u}n>0&&(i=0);var f=Ir(c.s.r),d=[],p=[],g=0,m=0,v=Array.isArray(e),_=c.s.r,x=0,y={};v&&!e[_]&&(e[_]=[]);var w=l.skipHidden&&e["!cols"]||[],T=l.skipHidden&&e["!rows"]||[];for(x=c.s.c;x<=c.e.c;++x)if(!(w[x]||{}).hidden)switch(d[x]=rr(x),r=v?e[_][x]:e[d[x]+f],n){case 1:s[x]=x-c.s.c;break;case 2:s[x]=d[x];break;case 3:s[x]=l.header[x-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=xs(r,null,l),m=y[a]||0,!m)y[a]=1;else{do o=a+"_"+m++;while(y[o]);y[a]=m,y[o]=1}s[x]=o}for(_=c.s.r+i;_<=c.e.r;++_)if(!(T[_]||{}).hidden){var S=lX(e,c,_,d,n,s,v,l);(S.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(p[g++]=S.row)}return p.length=g,p}var VT=/"/g;function uX(e,t,r,n,i,s,a,o){for(var c=!0,l=[],u="",f=Ir(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var p=o.dense?(e[r]||[])[d]:e[n[d]+f];if(p==null)u="";else if(p.v!=null){c=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:xs(p,null,o));for(var g=0,m=0;g!==u.length;++g)if((m=u.charCodeAt(g))===i||m===s||m===34||o.forceQuotes){u='"'+u.replace(VT,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(c=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(VT,'""')+'"')):u="";l.push(u)}return o.blankrows===!1&&c?null:l.join(a)}function wF(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=Vt(e["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(d[g]||{}).hidden||(f[g]=rr(g));for(var m=0,v=i.s.r;v<=i.e.r;++v)(p[v]||{}).hidden||(u=uX(e,i,v,f,a,c,s,n),u!=null&&(n.strip&&(u=u.replace(l,"")),(u||n.blankrows!==!1)&&r.push((m++?o:"")+u)));return delete n.dense,r.join("")}function fX(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=wF(e,t);return r}function hX(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=Vt(e["!ref"]),s="",a=[],o,c=[],l=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=rr(o);for(var u=i.s.r;u<=i.e.r;++u)for(s=Ir(u),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,r=l?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function TF(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?sn(n.origin):n.origin;a=c.r,o=c.c}var l,u={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var f=Vt(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(a=f.e.r+1,u.e.r=a+t.length-1+i)}else a==-1&&(a=0,u.e.r=t.length-1+i);var d=n.header||[],p=0;t.forEach(function(m,v){zi(m).forEach(function(_){(p=d.indexOf(_))==-1&&(d[p=d.length]=_);var x=m[_],y="z",w="",T=Be({c:o+p,r:a+v+i});l=ef(s,T),x&&typeof x=="object"&&!(x instanceof Date)?s[T]=x:(typeof x=="number"?y="n":typeof x=="boolean"?y="b":typeof x=="string"?y="s":x instanceof Date?(y="d",n.cellDates||(y="n",x=cn(x)),w=n.dateNF||$e[14]):x===null&&n.nullError&&(y="e",x=0),l?(l.t=y,l.v=x,delete l.w,delete l.R,w&&(l.z=w)):s[T]=l={t:y,v:x},w&&(l.z=w))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var g=Ir(a);if(i)for(p=0;p<d.length;++p)s[rr(p+o)+g]={t:"s",v:d[p]};return s["!ref"]=nt(u),s}function dX(e,t){return TF(null,e,t)}function ef(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=sn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ef(e,Be(t)):ef(e,Be({r:t,c:r||0}))}function pX(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function wy(){return{SheetNames:[],Sheets:{}}}function Ty(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(Jq(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function mX(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=pX(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function gX(e,t){return e.z=t,e}function SF(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function vX(e,t,r){return SF(e,"#"+t,r)}function xX(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function _X(e,t,r,n){for(var i=typeof t!="string"?t:Vt(t),s=typeof t=="string"?t:nt(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var c=ef(e,a,o);c.t="n",c.F=s,delete c.v,a==i.s.r&&o==i.s.c&&(c.f=r,n&&(c.D=!0))}return e}var yX={encode_col:rr,encode_row:Ir,encode_cell:Be,encode_range:nt,decode_col:cy,decode_row:oy,split_cell:FU,decode_cell:sn,decode_range:Zc,format_cell:xs,sheet_add_aoa:Ib,sheet_add_json:TF,sheet_add_dom:xF,aoa_to_sheet:el,json_to_sheet:dX,table_to_sheet:_F,table_to_book:LK,sheet_to_csv:wF,sheet_to_txt:fX,sheet_to_json:mv,sheet_to_html:OK,sheet_to_formulae:hX,sheet_to_row_object_array:mv,sheet_get_cell:ef,book_new:wy,book_append_sheet:Ty,book_set_sheet_visibility:mX,cell_set_number_format:gX,cell_set_hyperlink:SF,cell_set_internal_link:vX,cell_add_comment:xX,sheet_set_array_formula:_X,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function AF(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=AF(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function Ws(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=AF(e))&&(n&&(n+=" "),n+=t);return n}const cu=e=>typeof e=="number"&&!isNaN(e),fo=e=>typeof e=="string",xn=e=>typeof e=="function",ed=e=>fo(e)||xn(e)?e:null,pg=e=>F.isValidElement(e)||fo(e)||xn(e)||cu(e);function EX(e,t,r){r===void 0&&(r=300);const{scrollHeight:n,style:i}=e;requestAnimationFrame(()=>{i.minHeight="initial",i.height=n+"px",i.transition=`all ${r}ms`,requestAnimationFrame(()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(t,r)})})}function Dp(e){let{enter:t,exit:r,appendPosition:n=!1,collapse:i=!0,collapseDuration:s=300}=e;return function(a){let{children:o,position:c,preventExitTransition:l,done:u,nodeRef:f,isIn:d}=a;const p=n?`${t}--${c}`:t,g=n?`${r}--${c}`:r,m=F.useRef(0);return F.useLayoutEffect(()=>{const v=f.current,_=p.split(" "),x=y=>{y.target===f.current&&(v.dispatchEvent(new Event("d")),v.removeEventListener("animationend",x),v.removeEventListener("animationcancel",x),m.current===0&&y.type!=="animationcancel"&&v.classList.remove(..._))};v.classList.add(..._),v.addEventListener("animationend",x),v.addEventListener("animationcancel",x)},[]),F.useEffect(()=>{const v=f.current,_=()=>{v.removeEventListener("animationend",_),i?EX(v,u,s):u()};d||(l?_():(m.current=1,v.className+=` ${g}`,v.addEventListener("animationend",_)))},[d]),ke.createElement(ke.Fragment,null,o)}}function jT(e,t){return e!=null?{content:e.content,containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,status:t}:{}}const Gn={list:new Map,emitQueue:new Map,on(e,t){return this.list.has(e)||this.list.set(e,[]),this.list.get(e).push(t),this},off(e,t){if(t){const r=this.list.get(e).filter(n=>n!==t);return this.list.set(e,r),this}return this.list.delete(e),this},cancelEmit(e){const t=this.emitQueue.get(e);return t&&(t.forEach(clearTimeout),this.emitQueue.delete(e)),this},emit(e){this.list.has(e)&&this.list.get(e).forEach(t=>{const r=setTimeout(()=>{t(...[].slice.call(arguments,1))},0);this.emitQueue.has(e)||this.emitQueue.set(e,[]),this.emitQueue.get(e).push(r)})}},Ch=e=>{let{theme:t,type:r,...n}=e;return ke.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:t==="colored"?"currentColor":`var(--toastify-icon-color-${r})`,...n})},mg={info:function(e){return ke.createElement(Ch,{...e},ke.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return ke.createElement(Ch,{...e},ke.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return ke.createElement(Ch,{...e},ke.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return ke.createElement(Ch,{...e},ke.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return ke.createElement("div",{className:"Toastify__spinner"})}};function wX(e){const[,t]=F.useReducer(p=>p+1,0),[r,n]=F.useState([]),i=F.useRef(null),s=F.useRef(new Map).current,a=p=>r.indexOf(p)!==-1,o=F.useRef({toastKey:1,displayedToast:0,count:0,queue:[],props:e,containerId:null,isToastActive:a,getToast:p=>s.get(p)}).current;function c(p){let{containerId:g}=p;const{limit:m}=o.props;!m||g&&o.containerId!==g||(o.count-=o.queue.length,o.queue=[])}function l(p){n(g=>p==null?[]:g.filter(m=>m!==p))}function u(){const{toastContent:p,toastProps:g,staleId:m}=o.queue.shift();d(p,g,m)}function f(p,g){let{delay:m,staleId:v,..._}=g;if(!pg(p)||function(O){return!i.current||o.props.enableMultiContainer&&O.containerId!==o.props.containerId||s.has(O.toastId)&&O.updateId==null}(_))return;const{toastId:x,updateId:y,data:w}=_,{props:T}=o,S=()=>l(x),E=y==null;E&&o.count++;const k={...T,style:T.toastStyle,key:o.toastKey++,...Object.fromEntries(Object.entries(_).filter(O=>{let[V,G]=O;return G!=null})),toastId:x,updateId:y,data:w,closeToast:S,isIn:!1,className:ed(_.className||T.toastClassName),bodyClassName:ed(_.bodyClassName||T.bodyClassName),progressClassName:ed(_.progressClassName||T.progressClassName),autoClose:!_.isLoading&&(b=_.autoClose,j=T.autoClose,b===!1||cu(b)&&b>0?b:j),deleteToast(){const O=jT(s.get(x),"removed");s.delete(x),Gn.emit(4,O);const V=o.queue.length;if(o.count=x==null?o.count-o.displayedToast:o.count-1,o.count<0&&(o.count=0),V>0){const G=x==null?o.props.limit:1;if(V===1||G===1)o.displayedToast++,u();else{const X=G>V?V:G;o.displayedToast=X;for(let Z=0;Z<X;Z++)u()}}else t()}};var b,j;k.iconOut=function(O){let{theme:V,type:G,isLoading:X,icon:Z}=O,ie=null;const re={theme:V,type:G};return Z===!1||(xn(Z)?ie=Z(re):F.isValidElement(Z)?ie=F.cloneElement(Z,re):fo(Z)||cu(Z)?ie=Z:X?ie=mg.spinner():(B=>B in mg)(G)&&(ie=mg[G](re))),ie}(k),xn(_.onOpen)&&(k.onOpen=_.onOpen),xn(_.onClose)&&(k.onClose=_.onClose),k.closeButton=T.closeButton,_.closeButton===!1||pg(_.closeButton)?k.closeButton=_.closeButton:_.closeButton===!0&&(k.closeButton=!pg(T.closeButton)||T.closeButton);let H=p;F.isValidElement(p)&&!fo(p.type)?H=F.cloneElement(p,{closeToast:S,toastProps:k,data:w}):xn(p)&&(H=p({closeToast:S,toastProps:k,data:w})),T.limit&&T.limit>0&&o.count>T.limit&&E?o.queue.push({toastContent:H,toastProps:k,staleId:v}):cu(m)?setTimeout(()=>{d(H,k,v)},m):d(H,k,v)}function d(p,g,m){const{toastId:v}=g;m&&s.delete(m);const _={content:p,props:g};s.set(v,_),n(x=>[...x,v].filter(y=>y!==m)),Gn.emit(4,jT(_,_.props.updateId==null?"added":"updated"))}return F.useEffect(()=>(o.containerId=e.containerId,Gn.cancelEmit(3).on(0,f).on(1,p=>i.current&&l(p)).on(5,c).emit(2,o),()=>{s.clear(),Gn.emit(3,o)}),[]),F.useEffect(()=>{o.props=e,o.isToastActive=a,o.displayedToast=r.length}),{getToastToRender:function(p){const g=new Map,m=Array.from(s.values());return e.newestOnTop&&m.reverse(),m.forEach(v=>{const{position:_}=v.props;g.has(_)||g.set(_,[]),g.get(_).push(v)}),Array.from(g,v=>p(v[0],v[1]))},containerRef:i,isToastActive:a}}function BT(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientX:e.clientX}function UT(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientY:e.clientY}function TX(e){const[t,r]=F.useState(!1),[n,i]=F.useState(!1),s=F.useRef(null),a=F.useRef({start:0,x:0,y:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,boundingRect:null,didMove:!1}).current,o=F.useRef(e),{autoClose:c,pauseOnHover:l,closeToast:u,onClick:f,closeOnClick:d}=e;function p(w){if(e.draggable){w.nativeEvent.type==="touchstart"&&w.nativeEvent.preventDefault(),a.didMove=!1,document.addEventListener("mousemove",_),document.addEventListener("mouseup",x),document.addEventListener("touchmove",_),document.addEventListener("touchend",x);const T=s.current;a.canCloseOnClick=!0,a.canDrag=!0,a.boundingRect=T.getBoundingClientRect(),T.style.transition="",a.x=BT(w.nativeEvent),a.y=UT(w.nativeEvent),e.draggableDirection==="x"?(a.start=a.x,a.removalDistance=T.offsetWidth*(e.draggablePercent/100)):(a.start=a.y,a.removalDistance=T.offsetHeight*(e.draggablePercent===80?1.5*e.draggablePercent:e.draggablePercent/100))}}function g(w){if(a.boundingRect){const{top:T,bottom:S,left:E,right:k}=a.boundingRect;w.nativeEvent.type!=="touchend"&&e.pauseOnHover&&a.x>=E&&a.x<=k&&a.y>=T&&a.y<=S?v():m()}}function m(){r(!0)}function v(){r(!1)}function _(w){const T=s.current;a.canDrag&&T&&(a.didMove=!0,t&&v(),a.x=BT(w),a.y=UT(w),a.delta=e.draggableDirection==="x"?a.x-a.start:a.y-a.start,a.start!==a.x&&(a.canCloseOnClick=!1),T.style.transform=`translate${e.draggableDirection}(${a.delta}px)`,T.style.opacity=""+(1-Math.abs(a.delta/a.removalDistance)))}function x(){document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",x),document.removeEventListener("touchmove",_),document.removeEventListener("touchend",x);const w=s.current;if(a.canDrag&&a.didMove&&w){if(a.canDrag=!1,Math.abs(a.delta)>a.removalDistance)return i(!0),void e.closeToast();w.style.transition="transform 0.2s, opacity 0.2s",w.style.transform=`translate${e.draggableDirection}(0)`,w.style.opacity="1"}}F.useEffect(()=>{o.current=e}),F.useEffect(()=>(s.current&&s.current.addEventListener("d",m,{once:!0}),xn(e.onOpen)&&e.onOpen(F.isValidElement(e.children)&&e.children.props),()=>{const w=o.current;xn(w.onClose)&&w.onClose(F.isValidElement(w.children)&&w.children.props)}),[]),F.useEffect(()=>(e.pauseOnFocusLoss&&(document.hasFocus()||v(),window.addEventListener("focus",m),window.addEventListener("blur",v)),()=>{e.pauseOnFocusLoss&&(window.removeEventListener("focus",m),window.removeEventListener("blur",v))}),[e.pauseOnFocusLoss]);const y={onMouseDown:p,onTouchStart:p,onMouseUp:g,onTouchEnd:g};return c&&l&&(y.onMouseEnter=v,y.onMouseLeave=m),d&&(y.onClick=w=>{f&&f(w),a.canCloseOnClick&&u()}),{playToast:m,pauseToast:v,isRunning:t,preventExitTransition:n,toastRef:s,eventHandlers:y}}function kF(e){let{closeToast:t,theme:r,ariaLabel:n="close"}=e;return ke.createElement("button",{className:`Toastify__close-button Toastify__close-button--${r}`,type:"button",onClick:i=>{i.stopPropagation(),t(i)},"aria-label":n},ke.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},ke.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function SX(e){let{delay:t,isRunning:r,closeToast:n,type:i="default",hide:s,className:a,style:o,controlledProgress:c,progress:l,rtl:u,isIn:f,theme:d}=e;const p=s||c&&l===0,g={...o,animationDuration:`${t}ms`,animationPlayState:r?"running":"paused",opacity:p?0:1};c&&(g.transform=`scaleX(${l})`);const m=Ws("Toastify__progress-bar",c?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${d}`,`Toastify__progress-bar--${i}`,{"Toastify__progress-bar--rtl":u}),v=xn(a)?a({rtl:u,type:i,defaultClassName:m}):Ws(m,a);return ke.createElement("div",{role:"progressbar","aria-hidden":p?"true":"false","aria-label":"notification timer",className:v,style:g,[c&&l>=1?"onTransitionEnd":"onAnimationEnd"]:c&&l<1?null:()=>{f&&n()}})}const AX=e=>{const{isRunning:t,preventExitTransition:r,toastRef:n,eventHandlers:i}=TX(e),{closeButton:s,children:a,autoClose:o,onClick:c,type:l,hideProgressBar:u,closeToast:f,transition:d,position:p,className:g,style:m,bodyClassName:v,bodyStyle:_,progressClassName:x,progressStyle:y,updateId:w,role:T,progress:S,rtl:E,toastId:k,deleteToast:b,isIn:j,isLoading:H,iconOut:O,closeOnClick:V,theme:G}=e,X=Ws("Toastify__toast",`Toastify__toast-theme--${G}`,`Toastify__toast--${l}`,{"Toastify__toast--rtl":E},{"Toastify__toast--close-on-click":V}),Z=xn(g)?g({rtl:E,position:p,type:l,defaultClassName:X}):Ws(X,g),ie=!!S||!o,re={closeToast:f,type:l,theme:G};let B=null;return s===!1||(B=xn(s)?s(re):F.isValidElement(s)?F.cloneElement(s,re):kF(re)),ke.createElement(d,{isIn:j,done:b,position:p,preventExitTransition:r,nodeRef:n},ke.createElement("div",{id:k,onClick:c,className:Z,...i,style:m,ref:n},ke.createElement("div",{...j&&{role:T},className:xn(v)?v({type:l}):Ws("Toastify__toast-body",v),style:_},O!=null&&ke.createElement("div",{className:Ws("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!H})},O),ke.createElement("div",null,a)),B,ke.createElement(SX,{...w&&!ie?{key:`pb-${w}`}:{},rtl:E,theme:G,delay:o,isRunning:t,isIn:j,closeToast:f,hide:u,type:l,style:y,className:x,controlledProgress:ie,progress:S||0})))},Op=function(e,t){return t===void 0&&(t=!1),{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}},kX=Dp(Op("bounce",!0));Dp(Op("slide",!0));Dp(Op("zoom"));Dp(Op("flip"));const pa=F.forwardRef((e,t)=>{const{getToastToRender:r,containerRef:n,isToastActive:i}=wX(e),{className:s,style:a,rtl:o,containerId:c}=e;function l(u){const f=Ws("Toastify__toast-container",`Toastify__toast-container--${u}`,{"Toastify__toast-container--rtl":o});return xn(s)?s({position:u,rtl:o,defaultClassName:f}):Ws(f,ed(s))}return F.useEffect(()=>{t&&(t.current=n.current)},[]),ke.createElement("div",{ref:n,className:"Toastify",id:c},r((u,f)=>{const d=f.length?{...a}:{...a,pointerEvents:"none"};return ke.createElement("div",{className:l(u),style:d,key:`container-${u}`},f.map((p,g)=>{let{content:m,props:v}=p;return ke.createElement(AX,{...v,isIn:i(v.toastId),style:{...v.style,"--nth":g+1,"--len":f.length},key:`toast-${v.key}`},m)}))}))});pa.displayName="ToastContainer",pa.defaultProps={position:"top-right",transition:kX,autoClose:5e3,closeButton:kF,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,draggable:!0,draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};let gg,Fa=new Map,Ol=[],CX=1;function CF(){return""+CX++}function IX(e){return e&&(fo(e.toastId)||cu(e.toastId))?e.toastId:CF()}function lu(e,t){return Fa.size>0?Gn.emit(0,e,t):Ol.push({content:e,options:t}),t.toastId}function x0(e,t){return{...t,type:t&&t.type||e,toastId:IX(t)}}function Ih(e){return(t,r)=>lu(t,x0(e,r))}function Ne(e,t){return lu(e,x0("default",t))}Ne.loading=(e,t)=>lu(e,x0("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t})),Ne.promise=function(e,t,r){let n,{pending:i,error:s,success:a}=t;i&&(n=fo(i)?Ne.loading(i,r):Ne.loading(i.render,{...r,...i}));const o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},c=(u,f,d)=>{if(f==null)return void Ne.dismiss(n);const p={type:u,...o,...r,data:d},g=fo(f)?{render:f}:f;return n?Ne.update(n,{...p,...g}):Ne(g.render,{...p,...g}),d},l=xn(e)?e():e;return l.then(u=>c("success",a,u)).catch(u=>c("error",s,u)),l},Ne.success=Ih("success"),Ne.info=Ih("info"),Ne.error=Ih("error"),Ne.warning=Ih("warning"),Ne.warn=Ne.warning,Ne.dark=(e,t)=>lu(e,x0("default",{theme:"dark",...t})),Ne.dismiss=e=>{Fa.size>0?Gn.emit(1,e):Ol=Ol.filter(t=>e!=null&&t.options.toastId!==e)},Ne.clearWaitingQueue=function(e){return e===void 0&&(e={}),Gn.emit(5,e)},Ne.isActive=e=>{let t=!1;return Fa.forEach(r=>{r.isToastActive&&r.isToastActive(e)&&(t=!0)}),t},Ne.update=function(e,t){t===void 0&&(t={}),setTimeout(()=>{const r=function(n,i){let{containerId:s}=i;const a=Fa.get(s||gg);return a&&a.getToast(n)}(e,t);if(r){const{props:n,content:i}=r,s={delay:100,...n,...t,toastId:t.toastId||e,updateId:CF()};s.toastId!==e&&(s.staleId=e);const a=s.render||i;delete s.render,lu(a,s)}},0)},Ne.done=e=>{Ne.update(e,{progress:1})},Ne.onChange=e=>(Gn.on(4,e),()=>{Gn.off(4,e)}),Ne.POSITION={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",TOP_CENTER:"top-center",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",BOTTOM_CENTER:"bottom-center"},Ne.TYPE={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error",DEFAULT:"default"},Gn.on(2,e=>{gg=e.containerId||e,Fa.set(gg,e),Ol.forEach(t=>{Gn.emit(0,t.content,t.options)}),Ol=[]}).on(3,e=>{Fa.delete(e.containerId||e),Fa.size===0&&Gn.off(0).off(1).off(5)});const RX=e=>e===""?!0:/^\d{4}-\d{2}$/.test(e),IF=e=>/^\d{4}-\d{2}$/.test(e);function vg(e){let t=e.toLowerCase();return t=t.replace(/[áäâà]/g,"a").replace(/[éëêè]/g,"e").replace(/[íïîì]/g,"i").replace(/[óöôò]/g,"o").replace(/[úüûù]/g,"u").replace(/[^\w\s]/g,"").replace(/\s+/g,"_"),t}function bX(){const[e,t]=F.useState([]),[r,n]=F.useState(null),[i,s]=F.useState(!1),a=ar(),{control:o,handleSubmit:c,reset:l}=Ta({defaultValues:{week:"",team:""}}),u=d=>{const p=new FileReader;p.readAsBinaryString(d.target.files[0]),p.onload=g=>{const m=g.target.result,v=pv(m,{type:"binary"}),_=[];["Impacto","Impacto ácido"].forEach(y=>{if(v.SheetNames.includes(y)){const w=v.Sheets[y],T=yX.sheet_to_json(w),S=T.length>0?Object.keys(T[0]):[],E=T.map(k=>{const b={};return S.forEach(j=>{b[vg(j)]=k[j]}),b});_.push({sheetName:y,data:E})}}),t(_)}},f=async d=>{try{const p=localStorage.getItem("userEmail"),g="MSMIN",m="RECIBIDO-MSMIN",{week:v,team:_}=d;if(!_||!IF(v)){Ne.error("Ha ocurrido un error: Debe completar campos de equipo, semana y seleccionar un archivo.");return}s(!0);const x=e.filter(H=>vg(H.sheetName)===_),y={created_at:new Date,created_by:p,team:_,week_name:v,file_name:`${v}.xlsx`},w=await g4(y),T=x[0].data,S=Object.values(T[0]).map(H=>vg(H)),k=T.slice(1).map(H=>{const O={};return S.forEach((V,G)=>{O[V]=Object.values(H)[G]||null}),O.week_id=w.id,O.week_name=v,O.created_by=p,O.created_at=new Date,O.informed_by=g,O.current_status=m,v4(O)}),b=await Promise.all(k),j=b.map(H=>{const O={created_at:new Date,created_by:p,status:m,description:"",activity:H.id};return x4(O)});await Promise.all(j),BB(r,v),s(!1),t(b),Ne.success("Actividad creada exitosamente"),l({week:"",team:""}),setTimeout(()=>{a("/home")},2e3)}catch(p){console.error("Error:",p),Ne.error(`Ha ocurrido un error: ${p.message}`),s(!1)}};return h.jsx("form",{onSubmit:c(f),className:"container mt-5",children:h.jsx("div",{className:"d-flex justify-content-center",children:h.jsx("div",{className:"col-md-7",children:h.jsx("div",{className:"card",children:h.jsxs("div",{className:"card-body",children:[h.jsx("h2",{className:"text-center mb-4",children:"CARGAR PRIORIZACIÓN"}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"week",children:"Semana:"}),h.jsx(Ve,{name:"week",control:o,render:({field:d})=>h.jsx("input",{...d,type:"text",id:"week",placeholder:"Ejemplo: 2023-37 (AAAA-SS)",className:"form-control mb-3",required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"team",children:"Equipo:"}),h.jsx(Ve,{name:"team",control:o,render:({field:d})=>h.jsxs("select",{...d,className:"form-control mb-3",id:"team",children:[h.jsx("option",{value:"",defaultValue:!0,children:"Seleccione un equipo"}),h.jsx("option",{value:"impacto",children:"Impacto"}),h.jsx("option",{value:"impacto_acido",children:"Impacto Acido"})]})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"file",children:"Archivo:"}),h.jsx(Ve,{name:"file",control:o,render:({field:d})=>h.jsx("input",{...d,type:"file",id:"file",className:"form-control mb-3",onChange:p=>{n(p.target.files[0]),u(p)}})})]}),h.jsx("div",{className:"form-group d-flex text-center justify-content-center",children:h.jsx("button",{type:"submit",className:"btn btn-dark btn-block text-center mt-3",disabled:i,children:i?h.jsx(Un,{}):"CARGAR PRIORIZACIÓN"})}),h.jsx(pa,{class:"custom-toast",position:"top-right",autoClose:3e3,hideProgressBar:!0})]})})})})})}function FX(){const e=ar(),t=()=>{e("/home")};return h.jsxs(h.Fragment,{children:[h.jsx(qi,{}),h.jsxs("section",{id:"upload-activities",children:[h.jsx(bX,{}),h.jsx("div",{className:"d-flex justify-content-center mt-5",children:h.jsx(Mn,{text:"VOLVER",icon:"bi bi-arrow-return-left",marginClassName:"mb-5",btnClassName:"btn-link",onClick:t})})]})]})}function RF({documentId:e}){var s,a;const[t,r]=F.useState({}),[n,i]=F.useState(!0);return F.useEffect(()=>{(async()=>{try{const c=await _4(e),l=c.length>0?c.reduce((u,f)=>u.data.created_at>f.data.created_at?u:f):null;r(l),i(!1)}catch(c){console.error("Error al obtener datos: ",c)}})()},[e]),n?h.jsx(Un,{}):h.jsx("div",{className:"row justify-content-center",children:h.jsx("div",{className:"col-xl",children:h.jsx("div",{className:"card",children:h.jsxs("div",{className:"card-body",children:[h.jsx("h2",{className:"text-center mb-4",children:"ESTADO IMPACTO"}),h.jsxs("dl",{className:"dl-horizontal",children:[h.jsx("dt",{children:"Estado:"}),h.jsx("dd",{children:(s=t==null?void 0:t.data)==null?void 0:s.status})]}),h.jsx("dt",{children:"Descripción:"}),h.jsx("dd",{children:(a=t==null?void 0:t.data)==null?void 0:a.description})]})})})})}RF.propTypes={documentId:rt.string.isRequired};function bF({documentId:e}){const[t,r]=F.useState(!1),n=ar(),{control:i,handleSubmit:s,reset:a}=Ta({defaultValues:{status:"",description:""}}),o=async c=>{try{const l=localStorage.getItem("userEmail"),{status:u,description:f}=c;if(!u||!f){Ne.error("Ha ocurrido un error: Debe completar el estado y la descripción.");return}const d={created_by:l,created_at:new Date,activity:e,status:u,description:f};r(!0),await VB(d),await jB(e,c.status),r(!1),Ne.success("Estado actualizado exitosamente"),a({status:"",description:""}),setTimeout(()=>{n("/home")},2e3)}catch(l){console.error("Error:",l),Ne.error(`Ha ocurrido un error: ${l.message}`),r(!1)}};return h.jsx("form",{onSubmit:s(o),className:"container mt-5",children:h.jsx("div",{className:"row justify-content-center",children:h.jsx("div",{className:"col-xl",children:h.jsx("div",{className:"card",children:h.jsxs("div",{className:"card-body",children:[h.jsx("h2",{className:"text-center mb-4",children:" ACTUALIZAR ESTADO IMPACTO"}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"status",children:"Ingresar Estado:"}),h.jsx(Ve,{name:"status",control:i,render:({field:c})=>h.jsxs("select",{...c,className:"form-control mb-3",id:"status",children:[h.jsx("option",{value:"",defaultValue:!0,children:"Seleccione un Estado"}),h.jsx("option",{value:"ACEPTADO",children:"Aceptado"}),h.jsx("option",{value:"RECHAZADO",children:"Rechazado"}),h.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),h.jsx("option",{value:"PROGRAMADO",children:"Programado"}),h.jsx("option",{value:"EJECUTADO",children:"Ejecutado"}),h.jsx("option",{value:"REPETIDO",children:"Repetido"}),h.jsx("option",{value:"OTRO",children:"Otro"})]})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"description",children:"Descripción u observación:"}),h.jsx(Ve,{name:"description",control:i,render:({field:c})=>h.jsx("textarea",{...c,id:"description",className:"form-control mb-3",placeholder:"Escribe una descripción"})})]}),h.jsx("div",{className:"form-group d-flex text-center justify-content-center",children:h.jsx("button",{type:"submit",className:"btn btn-dark btn-block text-center mt-3",disabled:t,children:t?h.jsx(Un,{}):"ACTUALIZAR ESTADO IMPACTO"})}),h.jsx(pa,{className:"custom-toast",position:"top-right",autoClose:3e3,hideProgressBar:!0})]})})})})})}bF.propTypes={documentId:rt.string.isRequired};function PX(){const e=ar(),{documentId:t}=ff(),r=()=>{e("/home")};return h.jsxs(h.Fragment,{children:[h.jsx(qi,{}),h.jsxs("section",{id:"update-activity-status",children:[h.jsx("div",{className:"container",children:h.jsxs("div",{className:"row",children:[h.jsx("div",{className:"col-md-6 mt-5",children:h.jsx(RF,{documentId:t})}),h.jsx("div",{className:"col-md-6",children:h.jsx(bF,{documentId:t})})]})}),h.jsx("div",{className:"d-flex justify-content-center mt-5",children:h.jsx(Mn,{text:"VOLVER",icon:"bi bi-arrow-return-left",marginClassName:"mb-5",btnClassName:"btn-link",onClick:r})})]})]})}const NX=()=>new Promise((e,t)=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(r=>{const{latitude:n,longitude:i}=r.coords;e(`${n}, ${i}`)},r=>{t(r)}):t(new Error("Geolocation is not available in this browser."))});function DX(e,t,r){let n=`*Registro de actividad:*
*Fecha:*
${e}

`;return t.forEach((s,a)=>{n+=`*Descripción:*
${s}
*Link de descarga:*
${r[a]}
`}),`whatsapp://send?text=${encodeURIComponent(n)}`}function FF({documentId:e}){const[t,r]=F.useState(""),[n,i]=F.useState(""),[s,a]=F.useState([]),[o,c]=F.useState(!1),[l,u]=F.useState(!1),[f,d]=F.useState(!1),p=ar(),{control:g,handleSubmit:m,reset:v,setValue:_}=Ta({defaultValues:{activity_log_description:""}}),{fields:x,append:y,remove:w}=n7({control:g,name:"activity_log_files"});F.useEffect(()=>{T()||Ne.error("Speech recognition is not supported in this browser.")},[]);const T=()=>"SpeechRecognition"in window||"webkitSpeechRecognition"in window||"mozSpeechRecognition"in window||"msSpeechRecognition"in window,S=async()=>{try{const V=await NX();r(V)}catch(V){console.error("Error getting GPS coordinates:",V),Ne.error(`Error getting GPS coordinates: ${V.message}`)}},E=(V,G)=>{_(`activity_log_files[${V}]`,G);const X=[...s];X[V]="",a(X)},k=()=>{if(o)b();else try{const V=window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition,G=new V;G.continuous=!0,G.onresult=X=>{const Z=X.results[0][0].transcript;i(Z),b(),console.log(n)},G.start(),c(!0)}catch(V){console.error("Error starting speech recognition:",V),Ne.error(`Error starting speech recognition: ${V.message}`)}},b=()=>{c(!1)},j=o?h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"bi bi-mic-mute align-middle"})," DETENER GRABACIÓN POR VOZ"]}):h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"bi bi-mic align-middle"})," INICIAR GRABACIÓN POR VOZ"]}),H=()=>{d(!f)},O=async V=>{try{const G=localStorage.getItem("userEmail");if(!t||!n){Ne.error("Ha ocurrido un error: Debe completar las coordenadas GPS y la descripción del registro.");return}u(!0);const X=[];if(V.activity_log_files&&V.activity_log_files.length>0)for(let Z=0;Z<V.activity_log_files.length;Z++){const ie=V.activity_log_files[Z],re=await UB([ie]),B={activity:e,activity_log_created_by:G,activity_log_created_at:new Date,activity_log_GPS:t,activity_log_description:n,activity_log_file_name:ie.name,activity_log_file_description:s[Z]||""};await DB(B);const ae=await T4(ie.name);X.push(ae)}if(f&&X.length>0){const Z=new Date().toLocaleString(),ie=DX(Z,s,X);window.open(ie,"_blank")}u(!1),Ne.success("Registros ingresados exitosamente"),v({activity_log_GPS:"",activity_log_description:"",activity_log_files:[],activity_log_file_description:""}),setTimeout(()=>{p("/home")},2e3)}catch(G){console.error("Error:",G),Ne.error(`Ha ocurrido un error: ${G.message}`),u(!1)}};return h.jsxs(h.Fragment,{children:[h.jsx("form",{onSubmit:m(O),className:"container mt-5",children:h.jsx("div",{className:"row justify-content-center",children:h.jsx("div",{className:"col-md-7",children:h.jsxs("div",{className:"card",children:[h.jsxs("div",{className:"card-body",children:[h.jsx("h2",{className:"text-center mb-4",children:" INGRESAR REGISTRO"}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"activity_log_GPS",children:"GPS:"}),h.jsx(Ve,{name:"activity_log_GPS",control:g,render:({field:V})=>h.jsx("textarea",{...V,id:"activity_log_GPS",className:"form-control",placeholder:"Ingrese las coordenadas GPS.",value:t})}),h.jsx("div",{className:"input-group-append",children:h.jsxs("button",{className:"btn btn-dark mt-2 mb-3",type:"button",onClick:S,children:[h.jsx("i",{className:"bi bi-geo-alt align-middle"})," OBTENER GPS"]})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"activity_log_description",children:"Descripción del registro:"}),h.jsx(Ve,{name:"activity_log_description",control:g,defaultValue:"",render:({field:V})=>h.jsx("textarea",{...V,id:"activity_log_description",className:"form-control",placeholder:"Ingrese descripción del registro.",value:n,onChange:G=>{i(G.target.value),V.onChange(G)}})})]}),h.jsx("div",{className:"form-group",children:h.jsx("button",{type:"button",className:"btn btn-dark mt-2 mb-3",onClick:k,children:j})}),h.jsxs("div",{className:"form-group mt-2 mb-3",children:[h.jsxs("label",{children:["Imagen/es ",h.jsx("span",{className:"text-muted",children:"(opcional)"}),":"]}),x.map((V,G)=>h.jsxs("div",{className:"d-flex align-items-start mb-2",children:[h.jsxs("div",{className:"flex-grow-1 me-2",children:[h.jsx(Ve,{name:`activity_log_files_${G}`,control:g,render:({field:X})=>h.jsx("input",{...X,type:"file",className:"form-control",onChange:Z=>E(G,Z.target.files[0])})}),h.jsx("textarea",{className:"form-control mt-2",placeholder:"Descripción de la imagen",value:s[G]||"",onChange:X=>{const Z=[...s];Z[G]=X.target.value,a(Z)}})]}),h.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>w(G),children:h.jsx("i",{className:"bi bi-x-circle align-middle"})})]},V.id)),h.jsx("div",{children:h.jsxs("button",{type:"button",className:"btn btn-success",onClick:()=>y({}),children:[h.jsx("i",{className:"bi bi-plus-circle align-middle"})," AGREGAR"]})})]})]}),h.jsxs("div",{className:"form-check form-switch",children:[h.jsx("input",{className:"form-check-input",type:"checkbox",role:"switch",id:"flexSwitchCheckChecked",onChange:H}),h.jsxs("label",{className:"form-check-label",htmlFor:"flexSwitchCheckChecked",children:[h.jsx("i",{className:"bi bi-whatsapp"}),"  Enviar por WhatsApp"]})]}),h.jsx("div",{className:"form-group d-flex text-center justify-content-center",children:h.jsx("button",{type:"submit",className:"btn btn-dark btn-block mb-4",disabled:l,children:l?h.jsx(h.Fragment,{children:h.jsx(Un,{})}):"INGRESAR REGISTRO"})})]})})})}),h.jsx(pa,{className:"custom-toast",position:"top-right",autoClose:3e3,hideProgressBar:!0})]})}FF.propTypes={documentId:rt.string.isRequired};function OX(){const e=ar(),{documentId:t}=ff(),r=()=>{e("/home")};return h.jsxs(h.Fragment,{children:[h.jsx(qi,{}),h.jsxs("section",{id:"upload-activity-log",children:[h.jsx(FF,{documentId:t}),h.jsx("div",{className:"d-flex justify-content-center mt-5",children:h.jsx(Mn,{text:"VOLVER",icon:"bi bi-arrow-return-left",marginClassName:"mb-5",btnClassName:"btn-link",onClick:r})})]})]})}function Pe(){return Pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pe.apply(this,arguments)}function ho(e){"@babel/helpers - typeof";return ho=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ho(e)}function LX(e,t){if(ho(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ho(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PF(e){var t=LX(e,"string");return ho(t)==="symbol"?t:String(t)}function rc(e,t,r){return t=PF(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Re(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$T(Object(r),!0).forEach(function(n){rc(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$T(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PF(n.key),n)}}function VX(e,t,r){return t&&HT(e.prototype,t),r&&HT(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gv(e,t){return gv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gv(e,t)}function jX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gv(e,t)}function _0(e){return _0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_0(e)}function BX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function UX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $X(e,t){if(t&&(ho(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UX(e)}function HX(e){var t=BX();return function(){var n=_0(e),i;if(t){var s=_0(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return $X(this,i)}}function vv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zX(e){if(Array.isArray(e))return vv(e)}function WX(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function NF(e,t){if(e){if(typeof e=="string")return vv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vv(e,t)}}function GX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vc(e){return zX(e)||WX(e)||NF(e)||GX()}function qX(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function KX(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var XX=function(){function e(r){var n=this;this._insertTag=function(i){var s;n.tags.length===0?n.insertionPoint?s=n.insertionPoint.nextSibling:n.prepend?s=n.container.firstChild:s=n.before:s=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(i,s),n.tags.push(i)},this.isSpeedy=r.speedy===void 0?!0:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(n){n.forEach(this._insertTag)},t.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(KX(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var s=qX(i);try{s.insertRule(n,s.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(n));this.ctr++},t.flush=function(){this.tags.forEach(function(n){return n.parentNode&&n.parentNode.removeChild(n)}),this.tags=[],this.ctr=0},e}(),Or="-ms-",y0="-moz-",ot="-webkit-",DF="comm",Sy="rule",Ay="decl",YX="@import",OF="@keyframes",QX="@layer",JX=Math.abs,Lp=String.fromCharCode,ZX=Object.assign;function eY(e,t){return Er(e,0)^45?(((t<<2^Er(e,0))<<2^Er(e,1))<<2^Er(e,2))<<2^Er(e,3):0}function LF(e){return e.trim()}function tY(e,t){return(e=t.exec(e))?e[0]:e}function ct(e,t,r){return e.replace(t,r)}function xv(e,t){return e.indexOf(t)}function Er(e,t){return e.charCodeAt(t)|0}function tf(e,t,r){return e.slice(t,r)}function ki(e){return e.length}function ky(e){return e.length}function Rh(e,t){return t.push(e),e}function rY(e,t){return e.map(t).join("")}var Mp=1,Lc=1,MF=0,Tn=0,Xt=0,tl="";function Vp(e,t,r,n,i,s,a){return{value:e,root:t,parent:r,type:n,props:i,children:s,line:Mp,column:Lc,length:a,return:""}}function xl(e,t){return ZX(Vp("",null,null,"",null,null,0),e,{length:-e.length},t)}function nY(){return Xt}function iY(){return Xt=Tn>0?Er(tl,--Tn):0,Lc--,Xt===10&&(Lc=1,Mp--),Xt}function Dn(){return Xt=Tn<MF?Er(tl,Tn++):0,Lc++,Xt===10&&(Lc=1,Mp++),Xt}function $i(){return Er(tl,Tn)}function td(){return Tn}function $f(e,t){return tf(tl,e,t)}function rf(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function VF(e){return Mp=Lc=1,MF=ki(tl=e),Tn=0,[]}function jF(e){return tl="",e}function rd(e){return LF($f(Tn-1,_v(e===91?e+2:e===40?e+1:e)))}function sY(e){for(;(Xt=$i())&&Xt<33;)Dn();return rf(e)>2||rf(Xt)>3?"":" "}function aY(e,t){for(;--t&&Dn()&&!(Xt<48||Xt>102||Xt>57&&Xt<65||Xt>70&&Xt<97););return $f(e,td()+(t<6&&$i()==32&&Dn()==32))}function _v(e){for(;Dn();)switch(Xt){case e:return Tn;case 34:case 39:e!==34&&e!==39&&_v(Xt);break;case 40:e===41&&_v(e);break;case 92:Dn();break}return Tn}function oY(e,t){for(;Dn()&&e+Xt!==47+10;)if(e+Xt===42+42&&$i()===47)break;return"/*"+$f(t,Tn-1)+"*"+Lp(e===47?e:Dn())}function cY(e){for(;!rf($i());)Dn();return $f(e,Tn)}function lY(e){return jF(nd("",null,null,null,[""],e=VF(e),0,[0],e))}function nd(e,t,r,n,i,s,a,o,c){for(var l=0,u=0,f=a,d=0,p=0,g=0,m=1,v=1,_=1,x=0,y="",w=i,T=s,S=n,E=y;v;)switch(g=x,x=Dn()){case 40:if(g!=108&&Er(E,f-1)==58){xv(E+=ct(rd(x),"&","&\f"),"&\f")!=-1&&(_=-1);break}case 34:case 39:case 91:E+=rd(x);break;case 9:case 10:case 13:case 32:E+=sY(g);break;case 92:E+=aY(td()-1,7);continue;case 47:switch($i()){case 42:case 47:Rh(uY(oY(Dn(),td()),t,r),c);break;default:E+="/"}break;case 123*m:o[l++]=ki(E)*_;case 125*m:case 59:case 0:switch(x){case 0:case 125:v=0;case 59+u:_==-1&&(E=ct(E,/\f/g,"")),p>0&&ki(E)-f&&Rh(p>32?WT(E+";",n,r,f-1):WT(ct(E," ","")+";",n,r,f-2),c);break;case 59:E+=";";default:if(Rh(S=zT(E,t,r,l,u,i,o,y,w=[],T=[],f),s),x===123)if(u===0)nd(E,t,S,S,w,s,f,o,T);else switch(d===99&&Er(E,3)===110?100:d){case 100:case 108:case 109:case 115:nd(e,S,S,n&&Rh(zT(e,S,S,0,0,i,o,y,i,w=[],f),T),i,T,f,o,n?w:T);break;default:nd(E,S,S,S,[""],T,0,o,T)}}l=u=p=0,m=_=1,y=E="",f=a;break;case 58:f=1+ki(E),p=g;default:if(m<1){if(x==123)--m;else if(x==125&&m++==0&&iY()==125)continue}switch(E+=Lp(x),x*m){case 38:_=u>0?1:(E+="\f",-1);break;case 44:o[l++]=(ki(E)-1)*_,_=1;break;case 64:$i()===45&&(E+=rd(Dn())),d=$i(),u=f=ki(y=E+=cY(td())),x++;break;case 45:g===45&&ki(E)==2&&(m=0)}}return s}function zT(e,t,r,n,i,s,a,o,c,l,u){for(var f=i-1,d=i===0?s:[""],p=ky(d),g=0,m=0,v=0;g<n;++g)for(var _=0,x=tf(e,f+1,f=JX(m=a[g])),y=e;_<p;++_)(y=LF(m>0?d[_]+" "+x:ct(x,/&\f/g,d[_])))&&(c[v++]=y);return Vp(e,t,r,i===0?Sy:o,c,l,u)}function uY(e,t,r){return Vp(e,t,r,DF,Lp(nY()),tf(e,2,-2),0)}function WT(e,t,r,n){return Vp(e,t,r,Ay,tf(e,0,n),tf(e,n+1,-1),n)}function xc(e,t){for(var r="",n=ky(e),i=0;i<n;i++)r+=t(e[i],i,e,t)||"";return r}function fY(e,t,r,n){switch(e.type){case QX:if(e.children.length)break;case YX:case Ay:return e.return=e.return||e.value;case DF:return"";case OF:return e.return=e.value+"{"+xc(e.children,n)+"}";case Sy:e.value=e.props.join(",")}return ki(r=xc(e.children,n))?e.return=e.value+"{"+r+"}":""}function hY(e){var t=ky(e);return function(r,n,i,s){for(var a="",o=0;o<t;o++)a+=e[o](r,n,i,s)||"";return a}}function dY(e){return function(t){t.root||(t=t.return)&&e(t)}}function pY(e){var t=Object.create(null);return function(r){return t[r]===void 0&&(t[r]=e(r)),t[r]}}var mY=function(t,r,n){for(var i=0,s=0;i=s,s=$i(),i===38&&s===12&&(r[n]=1),!rf(s);)Dn();return $f(t,Tn)},gY=function(t,r){var n=-1,i=44;do switch(rf(i)){case 0:i===38&&$i()===12&&(r[n]=1),t[n]+=mY(Tn-1,r,n);break;case 2:t[n]+=rd(i);break;case 4:if(i===44){t[++n]=$i()===58?"&\f":"",r[n]=t[n].length;break}default:t[n]+=Lp(i)}while(i=Dn());return t},vY=function(t,r){return jF(gY(VF(t),r))},GT=new WeakMap,xY=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var r=t.value,n=t.parent,i=t.column===n.column&&t.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(t.props.length===1&&r.charCodeAt(0)!==58&&!GT.get(n))&&!i){GT.set(t,!0);for(var s=[],a=vY(r,s),o=n.props,c=0,l=0;c<a.length;c++)for(var u=0;u<o.length;u++,l++)t.props[l]=s[c]?a[c].replace(/&\f/g,o[u]):o[u]+" "+a[c]}}},_Y=function(t){if(t.type==="decl"){var r=t.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(t.return="",t.value="")}};function BF(e,t){switch(eY(e,t)){case 5103:return ot+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return ot+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return ot+e+y0+e+Or+e+e;case 6828:case 4268:return ot+e+Or+e+e;case 6165:return ot+e+Or+"flex-"+e+e;case 5187:return ot+e+ct(e,/(\w+).+(:[^]+)/,ot+"box-$1$2"+Or+"flex-$1$2")+e;case 5443:return ot+e+Or+"flex-item-"+ct(e,/flex-|-self/,"")+e;case 4675:return ot+e+Or+"flex-line-pack"+ct(e,/align-content|flex-|-self/,"")+e;case 5548:return ot+e+Or+ct(e,"shrink","negative")+e;case 5292:return ot+e+Or+ct(e,"basis","preferred-size")+e;case 6060:return ot+"box-"+ct(e,"-grow","")+ot+e+Or+ct(e,"grow","positive")+e;case 4554:return ot+ct(e,/([^-])(transform)/g,"$1"+ot+"$2")+e;case 6187:return ct(ct(ct(e,/(zoom-|grab)/,ot+"$1"),/(image-set)/,ot+"$1"),e,"")+e;case 5495:case 3959:return ct(e,/(image-set\([^]*)/,ot+"$1$`$1");case 4968:return ct(ct(e,/(.+:)(flex-)?(.*)/,ot+"box-pack:$3"+Or+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+ot+e+e;case 4095:case 3583:case 4068:case 2532:return ct(e,/(.+)-inline(.+)/,ot+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ki(e)-1-t>6)switch(Er(e,t+1)){case 109:if(Er(e,t+4)!==45)break;case 102:return ct(e,/(.+:)(.+)-([^]+)/,"$1"+ot+"$2-$3$1"+y0+(Er(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~xv(e,"stretch")?BF(ct(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Er(e,t+1)!==115)break;case 6444:switch(Er(e,ki(e)-3-(~xv(e,"!important")&&10))){case 107:return ct(e,":",":"+ot)+e;case 101:return ct(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+ot+(Er(e,14)===45?"inline-":"")+"box$3$1"+ot+"$2$3$1"+Or+"$2box$3")+e}break;case 5936:switch(Er(e,t+11)){case 114:return ot+e+Or+ct(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return ot+e+Or+ct(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return ot+e+Or+ct(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return ot+e+Or+e+e}return e}var yY=function(t,r,n,i){if(t.length>-1&&!t.return)switch(t.type){case Ay:t.return=BF(t.value,t.length);break;case OF:return xc([xl(t,{value:ct(t.value,"@","@"+ot)})],i);case Sy:if(t.length)return rY(t.props,function(s){switch(tY(s,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return xc([xl(t,{props:[ct(s,/:(read-\w+)/,":"+y0+"$1")]})],i);case"::placeholder":return xc([xl(t,{props:[ct(s,/:(plac\w+)/,":"+ot+"input-$1")]}),xl(t,{props:[ct(s,/:(plac\w+)/,":"+y0+"$1")]}),xl(t,{props:[ct(s,/:(plac\w+)/,Or+"input-$1")]})],i)}return""})}},EY=[yY],wY=function(t){var r=t.key;if(r==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(m){var v=m.getAttribute("data-emotion");v.indexOf(" ")!==-1&&(document.head.appendChild(m),m.setAttribute("data-s",""))})}var i=t.stylisPlugins||EY,s={},a,o=[];a=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(m){for(var v=m.getAttribute("data-emotion").split(" "),_=1;_<v.length;_++)s[v[_]]=!0;o.push(m)});var c,l=[xY,_Y];{var u,f=[fY,dY(function(m){u.insert(m)})],d=hY(l.concat(i,f)),p=function(v){return xc(lY(v),d)};c=function(v,_,x,y){u=x,p(v?v+"{"+_.styles+"}":_.styles),y&&(g.inserted[_.name]=!0)}}var g={key:r,sheet:new XX({key:r,container:a,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:s,registered:{},insert:c};return g.sheet.hydrate(o),g},UF={exports:{}},ht={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vr=typeof Symbol=="function"&&Symbol.for,Cy=vr?Symbol.for("react.element"):60103,Iy=vr?Symbol.for("react.portal"):60106,jp=vr?Symbol.for("react.fragment"):60107,Bp=vr?Symbol.for("react.strict_mode"):60108,Up=vr?Symbol.for("react.profiler"):60114,$p=vr?Symbol.for("react.provider"):60109,Hp=vr?Symbol.for("react.context"):60110,Ry=vr?Symbol.for("react.async_mode"):60111,zp=vr?Symbol.for("react.concurrent_mode"):60111,Wp=vr?Symbol.for("react.forward_ref"):60112,Gp=vr?Symbol.for("react.suspense"):60113,TY=vr?Symbol.for("react.suspense_list"):60120,qp=vr?Symbol.for("react.memo"):60115,Kp=vr?Symbol.for("react.lazy"):60116,SY=vr?Symbol.for("react.block"):60121,AY=vr?Symbol.for("react.fundamental"):60117,kY=vr?Symbol.for("react.responder"):60118,CY=vr?Symbol.for("react.scope"):60119;function $n(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Cy:switch(e=e.type,e){case Ry:case zp:case jp:case Up:case Bp:case Gp:return e;default:switch(e=e&&e.$$typeof,e){case Hp:case Wp:case Kp:case qp:case $p:return e;default:return t}}case Iy:return t}}}function $F(e){return $n(e)===zp}ht.AsyncMode=Ry;ht.ConcurrentMode=zp;ht.ContextConsumer=Hp;ht.ContextProvider=$p;ht.Element=Cy;ht.ForwardRef=Wp;ht.Fragment=jp;ht.Lazy=Kp;ht.Memo=qp;ht.Portal=Iy;ht.Profiler=Up;ht.StrictMode=Bp;ht.Suspense=Gp;ht.isAsyncMode=function(e){return $F(e)||$n(e)===Ry};ht.isConcurrentMode=$F;ht.isContextConsumer=function(e){return $n(e)===Hp};ht.isContextProvider=function(e){return $n(e)===$p};ht.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Cy};ht.isForwardRef=function(e){return $n(e)===Wp};ht.isFragment=function(e){return $n(e)===jp};ht.isLazy=function(e){return $n(e)===Kp};ht.isMemo=function(e){return $n(e)===qp};ht.isPortal=function(e){return $n(e)===Iy};ht.isProfiler=function(e){return $n(e)===Up};ht.isStrictMode=function(e){return $n(e)===Bp};ht.isSuspense=function(e){return $n(e)===Gp};ht.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===jp||e===zp||e===Up||e===Bp||e===Gp||e===TY||typeof e=="object"&&e!==null&&(e.$$typeof===Kp||e.$$typeof===qp||e.$$typeof===$p||e.$$typeof===Hp||e.$$typeof===Wp||e.$$typeof===AY||e.$$typeof===kY||e.$$typeof===CY||e.$$typeof===SY)};ht.typeOf=$n;UF.exports=ht;var IY=UF.exports,HF=IY,RY={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},bY={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},zF={};zF[HF.ForwardRef]=RY;zF[HF.Memo]=bY;var FY=!0;function PY(e,t,r){var n="";return r.split(" ").forEach(function(i){e[i]!==void 0?t.push(e[i]+";"):n+=i+" "}),n}var WF=function(t,r,n){var i=t.key+"-"+r.name;(n===!1||FY===!1)&&t.registered[i]===void 0&&(t.registered[i]=r.styles)},NY=function(t,r,n){WF(t,r,n);var i=t.key+"-"+r.name;if(t.inserted[r.name]===void 0){var s=r;do t.insert(r===s?"."+i:"",s,t.sheet,!0),s=s.next;while(s!==void 0)}};function DY(e){for(var t=0,r,n=0,i=e.length;i>=4;++n,i-=4)r=e.charCodeAt(n)&255|(e.charCodeAt(++n)&255)<<8|(e.charCodeAt(++n)&255)<<16|(e.charCodeAt(++n)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,t=(r&65535)*1540483477+((r>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(i){case 3:t^=(e.charCodeAt(n+2)&255)<<16;case 2:t^=(e.charCodeAt(n+1)&255)<<8;case 1:t^=e.charCodeAt(n)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var OY={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},LY=/[A-Z]|^ms/g,MY=/_EMO_([^_]+?)_([^]*?)_EMO_/g,GF=function(t){return t.charCodeAt(1)===45},qT=function(t){return t!=null&&typeof t!="boolean"},xg=pY(function(e){return GF(e)?e:e.replace(LY,"-$&").toLowerCase()}),KT=function(t,r){switch(t){case"animation":case"animationName":if(typeof r=="string")return r.replace(MY,function(n,i,s){return Ci={name:i,styles:s,next:Ci},i})}return OY[t]!==1&&!GF(t)&&typeof r=="number"&&r!==0?r+"px":r};function nf(e,t,r){if(r==null)return"";if(r.__emotion_styles!==void 0)return r;switch(typeof r){case"boolean":return"";case"object":{if(r.anim===1)return Ci={name:r.name,styles:r.styles,next:Ci},r.name;if(r.styles!==void 0){var n=r.next;if(n!==void 0)for(;n!==void 0;)Ci={name:n.name,styles:n.styles,next:Ci},n=n.next;var i=r.styles+";";return i}return VY(e,t,r)}case"function":{if(e!==void 0){var s=Ci,a=r(e);return Ci=s,nf(e,t,a)}break}}if(t==null)return r;var o=t[r];return o!==void 0?o:r}function VY(e,t,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=nf(e,t,r[i])+";";else for(var s in r){var a=r[s];if(typeof a!="object")t!=null&&t[a]!==void 0?n+=s+"{"+t[a]+"}":qT(a)&&(n+=xg(s)+":"+KT(s,a)+";");else if(Array.isArray(a)&&typeof a[0]=="string"&&(t==null||t[a[0]]===void 0))for(var o=0;o<a.length;o++)qT(a[o])&&(n+=xg(s)+":"+KT(s,a[o])+";");else{var c=nf(e,t,a);switch(s){case"animation":case"animationName":{n+=xg(s)+":"+c+";";break}default:n+=s+"{"+c+"}"}}}return n}var XT=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Ci,qF=function(t,r,n){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var i=!0,s="";Ci=void 0;var a=t[0];a==null||a.raw===void 0?(i=!1,s+=nf(n,r,a)):s+=a[0];for(var o=1;o<t.length;o++)s+=nf(n,r,t[o]),i&&(s+=a[o]);XT.lastIndex=0;for(var c="",l;(l=XT.exec(s))!==null;)c+="-"+l[1];var u=DY(s)+c;return{name:u,styles:s,next:Ci}},jY=function(t){return t()},BY=Cg["useInsertionEffect"]?Cg["useInsertionEffect"]:!1,UY=BY||jY,by={}.hasOwnProperty,KF=F.createContext(typeof HTMLElement<"u"?wY({key:"css"}):null);KF.Provider;var $Y=function(t){return F.forwardRef(function(r,n){var i=F.useContext(KF);return t(r,i,n)})},HY=F.createContext({}),yv="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",zY=function(t,r){var n={};for(var i in r)by.call(r,i)&&(n[i]=r[i]);return n[yv]=t,n},WY=function(t){var r=t.cache,n=t.serialized,i=t.isStringTag;return WF(r,n,i),UY(function(){return NY(r,n,i)}),null},GY=$Y(function(e,t,r){var n=e.css;typeof n=="string"&&t.registered[n]!==void 0&&(n=t.registered[n]);var i=e[yv],s=[n],a="";typeof e.className=="string"?a=PY(t.registered,s,e.className):e.className!=null&&(a=e.className+" ");var o=qF(s,void 0,F.useContext(HY));a+=t.key+"-"+o.name;var c={};for(var l in e)by.call(e,l)&&l!=="css"&&l!==yv&&(c[l]=e[l]);return c.ref=r,c.className=a,F.createElement(F.Fragment,null,F.createElement(WY,{cache:t,serialized:o,isStringTag:typeof i=="string"}),F.createElement(i,c))}),qY=GY,Fe=function(t,r){var n=arguments;if(r==null||!by.call(r,"css"))return F.createElement.apply(void 0,n);var i=n.length,s=new Array(i);s[0]=qY,s[1]=zY(t,r);for(var a=2;a<i;a++)s[a]=n[a];return F.createElement.apply(null,s)};function Fy(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return qF(t)}var KY=function(){var t=Fy.apply(void 0,arguments),r="animation-"+t.name;return{name:r,styles:"@keyframes "+r+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}};function XY(e){if(Array.isArray(e))return e}function YY(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,s,a,o=[],c=!0,l=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(u){l=!0,i=u}finally{try{if(!c&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return o}}function QY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ur(e,t){return XY(e)||YY(e,t)||NF(e,t)||QY()}function JY(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function yi(e,t){if(e==null)return{};var r=JY(e,t),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ZY(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}const eQ=Math.min,tQ=Math.max,E0=Math.round,bh=Math.floor,w0=e=>({x:e,y:e});function rQ(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function XF(e){return QF(e)?(e.nodeName||"").toLowerCase():"#document"}function mi(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function YF(e){var t;return(t=(QF(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function QF(e){return e instanceof Node||e instanceof mi(e).Node}function Ev(e){return e instanceof Element||e instanceof mi(e).Element}function Py(e){return e instanceof HTMLElement||e instanceof mi(e).HTMLElement}function YT(e){return typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof mi(e).ShadowRoot}function JF(e){const{overflow:t,overflowX:r,overflowY:n,display:i}=Ny(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(i)}function nQ(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function iQ(e){return["html","body","#document"].includes(XF(e))}function Ny(e){return mi(e).getComputedStyle(e)}function sQ(e){if(XF(e)==="html")return e;const t=e.assignedSlot||e.parentNode||YT(e)&&e.host||YF(e);return YT(t)?t.host:t}function ZF(e){const t=sQ(e);return iQ(t)?e.ownerDocument?e.ownerDocument.body:e.body:Py(t)&&JF(t)?t:ZF(t)}function T0(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const i=ZF(e),s=i===((n=e.ownerDocument)==null?void 0:n.body),a=mi(i);return s?t.concat(a,a.visualViewport||[],JF(i)?i:[],a.frameElement&&r?T0(a.frameElement):[]):t.concat(i,T0(i,[],r))}function aQ(e){const t=Ny(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const i=Py(e),s=i?e.offsetWidth:r,a=i?e.offsetHeight:n,o=E0(r)!==s||E0(n)!==a;return o&&(r=s,n=a),{width:r,height:n,$:o}}function Dy(e){return Ev(e)?e:e.contextElement}function _g(e){const t=Dy(e);if(!Py(t))return w0(1);const r=t.getBoundingClientRect(),{width:n,height:i,$:s}=aQ(t);let a=(s?E0(r.width):r.width)/n,o=(s?E0(r.height):r.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const oQ=w0(0);function cQ(e){const t=mi(e);return!nQ()||!t.visualViewport?oQ:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function lQ(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==mi(e)?!1:t}function QT(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const i=e.getBoundingClientRect(),s=Dy(e);let a=w0(1);t&&(n?Ev(n)&&(a=_g(n)):a=_g(e));const o=lQ(s,r,n)?cQ(s):w0(0);let c=(i.left+o.x)/a.x,l=(i.top+o.y)/a.y,u=i.width/a.x,f=i.height/a.y;if(s){const d=mi(s),p=n&&Ev(n)?mi(n):n;let g=d.frameElement;for(;g&&n&&p!==d;){const m=_g(g),v=g.getBoundingClientRect(),_=Ny(g),x=v.left+(g.clientLeft+parseFloat(_.paddingLeft))*m.x,y=v.top+(g.clientTop+parseFloat(_.paddingTop))*m.y;c*=m.x,l*=m.y,u*=m.x,f*=m.y,c+=x,l+=y,g=mi(g).frameElement}}return rQ({width:u,height:f,x:c,y:l})}function uQ(e,t){let r=null,n;const i=YF(e);function s(){clearTimeout(n),r&&r.disconnect(),r=null}function a(o,c){o===void 0&&(o=!1),c===void 0&&(c=1),s();const{left:l,top:u,width:f,height:d}=e.getBoundingClientRect();if(o||t(),!f||!d)return;const p=bh(u),g=bh(i.clientWidth-(l+f)),m=bh(i.clientHeight-(u+d)),v=bh(l),x={rootMargin:-p+"px "+-g+"px "+-m+"px "+-v+"px",threshold:tQ(0,eQ(1,c))||1};let y=!0;function w(T){const S=T[0].intersectionRatio;if(S!==c){if(!y)return a();S?a(!1,S):n=setTimeout(()=>{a(!1,1e-7)},100)}y=!1}try{r=new IntersectionObserver(w,{...x,root:i.ownerDocument})}catch{r=new IntersectionObserver(w,x)}r.observe(e)}return a(!0),s}function fQ(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,l=Dy(e),u=i||s?[...l?T0(l):[],...T0(t)]:[];u.forEach(_=>{i&&_.addEventListener("scroll",r,{passive:!0}),s&&_.addEventListener("resize",r)});const f=l&&o?uQ(l,r):null;let d=-1,p=null;a&&(p=new ResizeObserver(_=>{let[x]=_;x&&x.target===l&&p&&(p.unobserve(t),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{p&&p.observe(t)})),r()}),l&&!c&&p.observe(l),p.observe(t));let g,m=c?QT(e):null;c&&v();function v(){const _=QT(e);m&&(_.x!==m.x||_.y!==m.y||_.width!==m.width||_.height!==m.height)&&r(),m=_,g=requestAnimationFrame(v)}return r(),()=>{u.forEach(_=>{i&&_.removeEventListener("scroll",r),s&&_.removeEventListener("resize",r)}),f&&f(),p&&p.disconnect(),p=null,c&&cancelAnimationFrame(g)}}var wv=F.useLayoutEffect,hQ=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],S0=function(){};function dQ(e,t){return t?t[0]==="-"?e+t:e+"__"+t:e}function pQ(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];var s=[].concat(n);if(t&&e)for(var a in t)t.hasOwnProperty(a)&&t[a]&&s.push("".concat(dQ(e,a)));return s.filter(function(o){return o}).map(function(o){return String(o).trim()}).join(" ")}var A0=function(t){return SQ(t)?t.filter(Boolean):ho(t)==="object"&&t!==null?[t]:[]},eP=function(t){t.className,t.clearValue,t.cx,t.getStyles,t.getClassNames,t.getValue,t.hasValue,t.isMulti,t.isRtl,t.options,t.selectOption,t.selectProps,t.setValue,t.theme;var r=yi(t,hQ);return Re({},r)},Ot=function(t,r,n){var i=t.cx,s=t.getStyles,a=t.getClassNames,o=t.className;return{css:s(r,t),className:i(n??{},a(r,t),o)}};function mQ(e,t,r){if(r){var n=r(e,t);if(typeof n=="string")return n}return e}function Xp(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function gQ(e){return Xp(e)?window.innerHeight:e.clientHeight}function tP(e){return Xp(e)?window.pageYOffset:e.scrollTop}function k0(e,t){if(Xp(e)){window.scrollTo(0,t);return}e.scrollTop=t}function vQ(e){var t=getComputedStyle(e),r=t.position==="absolute",n=/(auto|scroll)/;if(t.position==="fixed")return document.documentElement;for(var i=e;i=i.parentElement;)if(t=getComputedStyle(i),!(r&&t.position==="static")&&n.test(t.overflow+t.overflowY+t.overflowX))return i;return document.documentElement}function xQ(e,t,r,n){return r*((e=e/n-1)*e*e+1)+t}function Fh(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:S0,i=tP(e),s=t-i,a=10,o=0;function c(){o+=a;var l=xQ(o,i,s,r);k0(e,l),o<r?window.requestAnimationFrame(c):n(e)}c()}function JT(e,t){var r=e.getBoundingClientRect(),n=t.getBoundingClientRect(),i=t.offsetHeight/3;n.bottom+i>r.bottom?k0(e,Math.min(t.offsetTop+t.clientHeight-e.offsetHeight+i,e.scrollHeight)):n.top-i<r.top&&k0(e,Math.max(t.offsetTop-i,0))}function _Q(e){var t=e.getBoundingClientRect();return{bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width}}function ZT(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function yQ(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var rP=!1,EQ={get passive(){return rP=!0}},Ph=typeof window<"u"?window:{};Ph.addEventListener&&Ph.removeEventListener&&(Ph.addEventListener("p",S0,EQ),Ph.removeEventListener("p",S0,!1));var wQ=rP;function TQ(e){return e!=null}function SQ(e){return Array.isArray(e)}function Ll(e,t,r){return e?t:r}var AQ=function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var s=Object.entries(t).filter(function(a){var o=ur(a,1),c=o[0];return!n.includes(c)});return s.reduce(function(a,o){var c=ur(o,2),l=c[0],u=c[1];return a[l]=u,a},{})},kQ=["children","innerProps"],CQ=["children","innerProps"];function IQ(e){var t=e.maxHeight,r=e.menuEl,n=e.minHeight,i=e.placement,s=e.shouldScroll,a=e.isFixedPosition,o=e.controlHeight,c=vQ(r),l={placement:"bottom",maxHeight:t};if(!r||!r.offsetParent)return l;var u=c.getBoundingClientRect(),f=u.height,d=r.getBoundingClientRect(),p=d.bottom,g=d.height,m=d.top,v=r.offsetParent.getBoundingClientRect(),_=v.top,x=a?window.innerHeight:gQ(c),y=tP(c),w=parseInt(getComputedStyle(r).marginBottom,10),T=parseInt(getComputedStyle(r).marginTop,10),S=_-T,E=x-m,k=S+y,b=f-y-m,j=p-x+y+w,H=y+m-T,O=160;switch(i){case"auto":case"bottom":if(E>=g)return{placement:"bottom",maxHeight:t};if(b>=g&&!a)return s&&Fh(c,j,O),{placement:"bottom",maxHeight:t};if(!a&&b>=n||a&&E>=n){s&&Fh(c,j,O);var V=a?E-w:b-w;return{placement:"bottom",maxHeight:V}}if(i==="auto"||a){var G=t,X=a?S:k;return X>=n&&(G=Math.min(X-w-o,t)),{placement:"top",maxHeight:G}}if(i==="bottom")return s&&k0(c,j),{placement:"bottom",maxHeight:t};break;case"top":if(S>=g)return{placement:"top",maxHeight:t};if(k>=g&&!a)return s&&Fh(c,H,O),{placement:"top",maxHeight:t};if(!a&&k>=n||a&&S>=n){var Z=t;return(!a&&k>=n||a&&S>=n)&&(Z=a?S-T:k-T),s&&Fh(c,H,O),{placement:"top",maxHeight:Z}}return{placement:"bottom",maxHeight:t};default:throw new Error('Invalid placement provided "'.concat(i,'".'))}return l}function RQ(e){var t={bottom:"top",top:"bottom"};return e?t[e]:"bottom"}var nP=function(t){return t==="auto"?"bottom":t},bQ=function(t,r){var n,i=t.placement,s=t.theme,a=s.borderRadius,o=s.spacing,c=s.colors;return Re((n={label:"menu"},rc(n,RQ(i),"100%"),rc(n,"position","absolute"),rc(n,"width","100%"),rc(n,"zIndex",1),n),r?{}:{backgroundColor:c.neutral0,borderRadius:a,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:o.menuGutter,marginTop:o.menuGutter})},iP=F.createContext(null),FQ=function(t){var r=t.children,n=t.minMenuHeight,i=t.maxMenuHeight,s=t.menuPlacement,a=t.menuPosition,o=t.menuShouldScrollIntoView,c=t.theme,l=F.useContext(iP)||{},u=l.setPortalPlacement,f=F.useRef(null),d=F.useState(i),p=ur(d,2),g=p[0],m=p[1],v=F.useState(null),_=ur(v,2),x=_[0],y=_[1],w=c.spacing.controlHeight;return wv(function(){var T=f.current;if(T){var S=a==="fixed",E=o&&!S,k=IQ({maxHeight:i,menuEl:T,minHeight:n,placement:s,shouldScroll:E,isFixedPosition:S,controlHeight:w});m(k.maxHeight),y(k.placement),u==null||u(k.placement)}},[i,s,a,o,n,u,w]),r({ref:f,placerProps:Re(Re({},t),{},{placement:x||nP(s),maxHeight:g})})},PQ=function(t){var r=t.children,n=t.innerRef,i=t.innerProps;return Fe("div",Pe({},Ot(t,"menu",{menu:!0}),{ref:n},i),r)},NQ=PQ,DQ=function(t,r){var n=t.maxHeight,i=t.theme.spacing.baseUnit;return Re({maxHeight:n,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},r?{}:{paddingBottom:i,paddingTop:i})},OQ=function(t){var r=t.children,n=t.innerProps,i=t.innerRef,s=t.isMulti;return Fe("div",Pe({},Ot(t,"menuList",{"menu-list":!0,"menu-list--is-multi":s}),{ref:i},n),r)},sP=function(t,r){var n=t.theme,i=n.spacing.baseUnit,s=n.colors;return Re({textAlign:"center"},r?{}:{color:s.neutral40,padding:"".concat(i*2,"px ").concat(i*3,"px")})},LQ=sP,MQ=sP,VQ=function(t){var r=t.children,n=r===void 0?"No options":r,i=t.innerProps,s=yi(t,kQ);return Fe("div",Pe({},Ot(Re(Re({},s),{},{children:n,innerProps:i}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),i),n)},jQ=function(t){var r=t.children,n=r===void 0?"Loading...":r,i=t.innerProps,s=yi(t,CQ);return Fe("div",Pe({},Ot(Re(Re({},s),{},{children:n,innerProps:i}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),i),n)},BQ=function(t){var r=t.rect,n=t.offset,i=t.position;return{left:r.left,position:i,top:n,width:r.width,zIndex:1}},UQ=function(t){var r=t.appendTo,n=t.children,i=t.controlElement,s=t.innerProps,a=t.menuPlacement,o=t.menuPosition,c=F.useRef(null),l=F.useRef(null),u=F.useState(nP(a)),f=ur(u,2),d=f[0],p=f[1],g=F.useMemo(function(){return{setPortalPlacement:p}},[]),m=F.useState(null),v=ur(m,2),_=v[0],x=v[1],y=F.useCallback(function(){if(i){var E=_Q(i),k=o==="fixed"?0:window.pageYOffset,b=E[d]+k;(b!==(_==null?void 0:_.offset)||E.left!==(_==null?void 0:_.rect.left)||E.width!==(_==null?void 0:_.rect.width))&&x({offset:b,rect:E})}},[i,o,d,_==null?void 0:_.offset,_==null?void 0:_.rect.left,_==null?void 0:_.rect.width]);wv(function(){y()},[y]);var w=F.useCallback(function(){typeof l.current=="function"&&(l.current(),l.current=null),i&&c.current&&(l.current=fQ(i,c.current,y,{elementResize:"ResizeObserver"in window}))},[i,y]);wv(function(){w()},[w]);var T=F.useCallback(function(E){c.current=E,w()},[w]);if(!r&&o!=="fixed"||!_)return null;var S=Fe("div",Pe({ref:T},Ot(Re(Re({},t),{},{offset:_.offset,position:o,rect:_.rect}),"menuPortal",{"menu-portal":!0}),s),n);return Fe(iP.Provider,{value:g},r?Rk.createPortal(S,r):S)},$Q=function(t){var r=t.isDisabled,n=t.isRtl;return{label:"container",direction:n?"rtl":void 0,pointerEvents:r?"none":void 0,position:"relative"}},HQ=function(t){var r=t.children,n=t.innerProps,i=t.isDisabled,s=t.isRtl;return Fe("div",Pe({},Ot(t,"container",{"--is-disabled":i,"--is-rtl":s}),n),r)},zQ=function(t,r){var n=t.theme.spacing,i=t.isMulti,s=t.hasValue,a=t.selectProps.controlShouldRenderValue;return Re({alignItems:"center",display:i&&s&&a?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},r?{}:{padding:"".concat(n.baseUnit/2,"px ").concat(n.baseUnit*2,"px")})},WQ=function(t){var r=t.children,n=t.innerProps,i=t.isMulti,s=t.hasValue;return Fe("div",Pe({},Ot(t,"valueContainer",{"value-container":!0,"value-container--is-multi":i,"value-container--has-value":s}),n),r)},GQ=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},qQ=function(t){var r=t.children,n=t.innerProps;return Fe("div",Pe({},Ot(t,"indicatorsContainer",{indicators:!0}),n),r)},eS,KQ=["size"],XQ=["innerProps","isRtl","size"],YQ={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},aP=function(t){var r=t.size,n=yi(t,KQ);return Fe("svg",Pe({height:r,width:r,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:YQ},n))},Oy=function(t){return Fe(aP,Pe({size:20},t),Fe("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},oP=function(t){return Fe(aP,Pe({size:20},t),Fe("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},cP=function(t,r){var n=t.isFocused,i=t.theme,s=i.spacing.baseUnit,a=i.colors;return Re({label:"indicatorContainer",display:"flex",transition:"color 150ms"},r?{}:{color:n?a.neutral60:a.neutral20,padding:s*2,":hover":{color:n?a.neutral80:a.neutral40}})},QQ=cP,JQ=function(t){var r=t.children,n=t.innerProps;return Fe("div",Pe({},Ot(t,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),n),r||Fe(oP,null))},ZQ=cP,eJ=function(t){var r=t.children,n=t.innerProps;return Fe("div",Pe({},Ot(t,"clearIndicator",{indicator:!0,"clear-indicator":!0}),n),r||Fe(Oy,null))},tJ=function(t,r){var n=t.isDisabled,i=t.theme,s=i.spacing.baseUnit,a=i.colors;return Re({label:"indicatorSeparator",alignSelf:"stretch",width:1},r?{}:{backgroundColor:n?a.neutral10:a.neutral20,marginBottom:s*2,marginTop:s*2})},rJ=function(t){var r=t.innerProps;return Fe("span",Pe({},r,Ot(t,"indicatorSeparator",{"indicator-separator":!0})))},nJ=KY(eS||(eS=ZY([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),iJ=function(t,r){var n=t.isFocused,i=t.size,s=t.theme,a=s.colors,o=s.spacing.baseUnit;return Re({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:i,lineHeight:1,marginRight:i,textAlign:"center",verticalAlign:"middle"},r?{}:{color:n?a.neutral60:a.neutral20,padding:o*2})},yg=function(t){var r=t.delay,n=t.offset;return Fe("span",{css:Fy({animation:"".concat(nJ," 1s ease-in-out ").concat(r,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:n?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},sJ=function(t){var r=t.innerProps,n=t.isRtl,i=t.size,s=i===void 0?4:i,a=yi(t,XQ);return Fe("div",Pe({},Ot(Re(Re({},a),{},{innerProps:r,isRtl:n,size:s}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),r),Fe(yg,{delay:0,offset:n}),Fe(yg,{delay:160,offset:!0}),Fe(yg,{delay:320,offset:!n}))},aJ=function(t,r){var n=t.isDisabled,i=t.isFocused,s=t.theme,a=s.colors,o=s.borderRadius,c=s.spacing;return Re({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:c.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},r?{}:{backgroundColor:n?a.neutral5:a.neutral0,borderColor:n?a.neutral10:i?a.primary:a.neutral20,borderRadius:o,borderStyle:"solid",borderWidth:1,boxShadow:i?"0 0 0 1px ".concat(a.primary):void 0,"&:hover":{borderColor:i?a.primary:a.neutral30}})},oJ=function(t){var r=t.children,n=t.isDisabled,i=t.isFocused,s=t.innerRef,a=t.innerProps,o=t.menuIsOpen;return Fe("div",Pe({ref:s},Ot(t,"control",{control:!0,"control--is-disabled":n,"control--is-focused":i,"control--menu-is-open":o}),a,{"aria-disabled":n||void 0}),r)},cJ=oJ,lJ=["data"],uJ=function(t,r){var n=t.theme.spacing;return r?{}:{paddingBottom:n.baseUnit*2,paddingTop:n.baseUnit*2}},fJ=function(t){var r=t.children,n=t.cx,i=t.getStyles,s=t.getClassNames,a=t.Heading,o=t.headingProps,c=t.innerProps,l=t.label,u=t.theme,f=t.selectProps;return Fe("div",Pe({},Ot(t,"group",{group:!0}),c),Fe(a,Pe({},o,{selectProps:f,theme:u,getStyles:i,getClassNames:s,cx:n}),l),Fe("div",null,r))},hJ=function(t,r){var n=t.theme,i=n.colors,s=n.spacing;return Re({label:"group",cursor:"default",display:"block"},r?{}:{color:i.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:s.baseUnit*3,paddingRight:s.baseUnit*3,textTransform:"uppercase"})},dJ=function(t){var r=eP(t);r.data;var n=yi(r,lJ);return Fe("div",Pe({},Ot(t,"groupHeading",{"group-heading":!0}),n))},pJ=fJ,mJ=["innerRef","isDisabled","isHidden","inputClassName"],gJ=function(t,r){var n=t.isDisabled,i=t.value,s=t.theme,a=s.spacing,o=s.colors;return Re(Re({visibility:n?"hidden":"visible",transform:i?"translateZ(0)":""},vJ),r?{}:{margin:a.baseUnit/2,paddingBottom:a.baseUnit/2,paddingTop:a.baseUnit/2,color:o.neutral80})},lP={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},vJ={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Re({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},lP)},xJ=function(t){return Re({label:"input",color:"inherit",background:0,opacity:t?0:1,width:"100%"},lP)},_J=function(t){var r=t.cx,n=t.value,i=eP(t),s=i.innerRef,a=i.isDisabled,o=i.isHidden,c=i.inputClassName,l=yi(i,mJ);return Fe("div",Pe({},Ot(t,"input",{"input-container":!0}),{"data-value":n||""}),Fe("input",Pe({className:r({input:!0},c),ref:s,style:xJ(o),disabled:a},l)))},yJ=_J,EJ=function(t,r){var n=t.theme,i=n.spacing,s=n.borderRadius,a=n.colors;return Re({label:"multiValue",display:"flex",minWidth:0},r?{}:{backgroundColor:a.neutral10,borderRadius:s/2,margin:i.baseUnit/2})},wJ=function(t,r){var n=t.theme,i=n.borderRadius,s=n.colors,a=t.cropWithEllipsis;return Re({overflow:"hidden",textOverflow:a||a===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},r?{}:{borderRadius:i/2,color:s.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},TJ=function(t,r){var n=t.theme,i=n.spacing,s=n.borderRadius,a=n.colors,o=t.isFocused;return Re({alignItems:"center",display:"flex"},r?{}:{borderRadius:s/2,backgroundColor:o?a.dangerLight:void 0,paddingLeft:i.baseUnit,paddingRight:i.baseUnit,":hover":{backgroundColor:a.dangerLight,color:a.danger}})},uP=function(t){var r=t.children,n=t.innerProps;return Fe("div",n,r)},SJ=uP,AJ=uP;function kJ(e){var t=e.children,r=e.innerProps;return Fe("div",Pe({role:"button"},r),t||Fe(Oy,{size:14}))}var CJ=function(t){var r=t.children,n=t.components,i=t.data,s=t.innerProps,a=t.isDisabled,o=t.removeProps,c=t.selectProps,l=n.Container,u=n.Label,f=n.Remove;return Fe(l,{data:i,innerProps:Re(Re({},Ot(t,"multiValue",{"multi-value":!0,"multi-value--is-disabled":a})),s),selectProps:c},Fe(u,{data:i,innerProps:Re({},Ot(t,"multiValueLabel",{"multi-value__label":!0})),selectProps:c},r),Fe(f,{data:i,innerProps:Re(Re({},Ot(t,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(r||"option")},o),selectProps:c}))},IJ=CJ,RJ=function(t,r){var n=t.isDisabled,i=t.isFocused,s=t.isSelected,a=t.theme,o=a.spacing,c=a.colors;return Re({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},r?{}:{backgroundColor:s?c.primary:i?c.primary25:"transparent",color:n?c.neutral20:s?c.neutral0:"inherit",padding:"".concat(o.baseUnit*2,"px ").concat(o.baseUnit*3,"px"),":active":{backgroundColor:n?void 0:s?c.primary:c.primary50}})},bJ=function(t){var r=t.children,n=t.isDisabled,i=t.isFocused,s=t.isSelected,a=t.innerRef,o=t.innerProps;return Fe("div",Pe({},Ot(t,"option",{option:!0,"option--is-disabled":n,"option--is-focused":i,"option--is-selected":s}),{ref:a,"aria-disabled":n},o),r)},FJ=bJ,PJ=function(t,r){var n=t.theme,i=n.spacing,s=n.colors;return Re({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},r?{}:{color:s.neutral50,marginLeft:i.baseUnit/2,marginRight:i.baseUnit/2})},NJ=function(t){var r=t.children,n=t.innerProps;return Fe("div",Pe({},Ot(t,"placeholder",{placeholder:!0}),n),r)},DJ=NJ,OJ=function(t,r){var n=t.isDisabled,i=t.theme,s=i.spacing,a=i.colors;return Re({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},r?{}:{color:n?a.neutral40:a.neutral80,marginLeft:s.baseUnit/2,marginRight:s.baseUnit/2})},LJ=function(t){var r=t.children,n=t.isDisabled,i=t.innerProps;return Fe("div",Pe({},Ot(t,"singleValue",{"single-value":!0,"single-value--is-disabled":n}),i),r)},MJ=LJ,VJ={ClearIndicator:eJ,Control:cJ,DropdownIndicator:JQ,DownChevron:oP,CrossIcon:Oy,Group:pJ,GroupHeading:dJ,IndicatorsContainer:qQ,IndicatorSeparator:rJ,Input:yJ,LoadingIndicator:sJ,Menu:NQ,MenuList:OQ,MenuPortal:UQ,LoadingMessage:jQ,NoOptionsMessage:VQ,MultiValue:IJ,MultiValueContainer:SJ,MultiValueLabel:AJ,MultiValueRemove:kJ,Option:FJ,Placeholder:DJ,SelectContainer:HQ,SingleValue:MJ,ValueContainer:WQ},jJ=function(t){return Re(Re({},VJ),t.components)},tS=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function BJ(e,t){return!!(e===t||tS(e)&&tS(t))}function UJ(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!BJ(e[r],t[r]))return!1;return!0}function $J(e,t){t===void 0&&(t=UJ);var r=null;function n(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];if(r&&r.lastThis===this&&t(i,r.lastArgs))return r.lastResult;var a=e.apply(this,i);return r={lastResult:a,lastArgs:i,lastThis:this},a}return n.clear=function(){r=null},n}var HJ={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},zJ=function(t){return Fe("span",Pe({css:HJ},t))},rS=zJ,WJ={guidance:function(t){var r=t.isSearchable,n=t.isMulti,i=t.tabSelectsValue,s=t.context,a=t.isInitialFocus;switch(s){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(i?", press Tab to select the option and exit the menu":"",".");case"input":return a?"".concat(t["aria-label"]||"Select"," is focused ").concat(r?",type to refine list":"",", press Down to open the menu, ").concat(n?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(t){var r=t.action,n=t.label,i=n===void 0?"":n,s=t.labels,a=t.isDisabled;switch(r){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(i,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(s.length>1?"s":""," ").concat(s.join(","),", selected.");case"select-option":return a?"option ".concat(i," is disabled. Select another option."):"option ".concat(i,", selected.");default:return""}},onFocus:function(t){var r=t.context,n=t.focused,i=t.options,s=t.label,a=s===void 0?"":s,o=t.selectValue,c=t.isDisabled,l=t.isSelected,u=t.isAppleDevice,f=function(m,v){return m&&m.length?"".concat(m.indexOf(v)+1," of ").concat(m.length):""};if(r==="value"&&o)return"value ".concat(a," focused, ").concat(f(o,n),".");if(r==="menu"&&u){var d=c?" disabled":"",p="".concat(l?" selected":"").concat(d);return"".concat(a).concat(p,", ").concat(f(i,n),".")}return""},onFilter:function(t){var r=t.inputValue,n=t.resultsMessage;return"".concat(n).concat(r?" for search term "+r:"",".")}},GJ=function(t){var r=t.ariaSelection,n=t.focusedOption,i=t.focusedValue,s=t.focusableOptions,a=t.isFocused,o=t.selectValue,c=t.selectProps,l=t.id,u=t.isAppleDevice,f=c.ariaLiveMessages,d=c.getOptionLabel,p=c.inputValue,g=c.isMulti,m=c.isOptionDisabled,v=c.isSearchable,_=c.menuIsOpen,x=c.options,y=c.screenReaderStatus,w=c.tabSelectsValue,T=c.isLoading,S=c["aria-label"],E=c["aria-live"],k=F.useMemo(function(){return Re(Re({},WJ),f||{})},[f]),b=F.useMemo(function(){var X="";if(r&&k.onChange){var Z=r.option,ie=r.options,re=r.removedValue,B=r.removedValues,ae=r.value,xe=function(me){return Array.isArray(me)?null:me},I=re||Z||xe(ae),W=I?d(I):"",z=ie||B||void 0,U=z?z.map(d):[],ee=Re({isDisabled:I&&m(I,o),label:W,labels:U},r);X=k.onChange(ee)}return X},[r,k,m,o,d]),j=F.useMemo(function(){var X="",Z=n||i,ie=!!(n&&o&&o.includes(n));if(Z&&k.onFocus){var re={focused:Z,label:d(Z),isDisabled:m(Z,o),isSelected:ie,options:s,context:Z===n?"menu":"value",selectValue:o,isAppleDevice:u};X=k.onFocus(re)}return X},[n,i,d,m,k,s,o,u]),H=F.useMemo(function(){var X="";if(_&&x.length&&!T&&k.onFilter){var Z=y({count:s.length});X=k.onFilter({inputValue:p,resultsMessage:Z})}return X},[s,p,_,k,x,y,T]),O=(r==null?void 0:r.action)==="initial-input-focus",V=F.useMemo(function(){var X="";if(k.guidance){var Z=i?"value":_?"menu":"input";X=k.guidance({"aria-label":S,context:Z,isDisabled:n&&m(n,o),isMulti:g,isSearchable:v,tabSelectsValue:w,isInitialFocus:O})}return X},[S,n,i,g,m,v,_,k,o,w,O]),G=Fe(F.Fragment,null,Fe("span",{id:"aria-selection"},b),Fe("span",{id:"aria-focused"},j),Fe("span",{id:"aria-results"},H),Fe("span",{id:"aria-guidance"},V));return Fe(F.Fragment,null,Fe(rS,{id:l},O&&G),Fe(rS,{"aria-live":E,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},a&&!O&&G))},qJ=GJ,Tv=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],KJ=new RegExp("["+Tv.map(function(e){return e.letters}).join("")+"]","g"),fP={};for(var Eg=0;Eg<Tv.length;Eg++)for(var wg=Tv[Eg],Tg=0;Tg<wg.letters.length;Tg++)fP[wg.letters[Tg]]=wg.base;var hP=function(t){return t.replace(KJ,function(r){return fP[r]})},XJ=$J(hP),nS=function(t){return t.replace(/^\s+|\s+$/g,"")},YJ=function(t){return"".concat(t.label," ").concat(t.value)},QJ=function(t){return function(r,n){if(r.data.__isNew__)return!0;var i=Re({ignoreCase:!0,ignoreAccents:!0,stringify:YJ,trim:!0,matchFrom:"any"},t),s=i.ignoreCase,a=i.ignoreAccents,o=i.stringify,c=i.trim,l=i.matchFrom,u=c?nS(n):n,f=c?nS(o(r)):o(r);return s&&(u=u.toLowerCase(),f=f.toLowerCase()),a&&(u=XJ(u),f=hP(f)),l==="start"?f.substr(0,u.length)===u:f.indexOf(u)>-1}},JJ=["innerRef"];function ZJ(e){var t=e.innerRef,r=yi(e,JJ),n=AQ(r,"onExited","in","enter","exit","appear");return Fe("input",Pe({ref:t},n,{css:Fy({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var eZ=function(t){t.cancelable&&t.preventDefault(),t.stopPropagation()};function tZ(e){var t=e.isEnabled,r=e.onBottomArrive,n=e.onBottomLeave,i=e.onTopArrive,s=e.onTopLeave,a=F.useRef(!1),o=F.useRef(!1),c=F.useRef(0),l=F.useRef(null),u=F.useCallback(function(v,_){if(l.current!==null){var x=l.current,y=x.scrollTop,w=x.scrollHeight,T=x.clientHeight,S=l.current,E=_>0,k=w-T-y,b=!1;k>_&&a.current&&(n&&n(v),a.current=!1),E&&o.current&&(s&&s(v),o.current=!1),E&&_>k?(r&&!a.current&&r(v),S.scrollTop=w,b=!0,a.current=!0):!E&&-_>y&&(i&&!o.current&&i(v),S.scrollTop=0,b=!0,o.current=!0),b&&eZ(v)}},[r,n,i,s]),f=F.useCallback(function(v){u(v,v.deltaY)},[u]),d=F.useCallback(function(v){c.current=v.changedTouches[0].clientY},[]),p=F.useCallback(function(v){var _=c.current-v.changedTouches[0].clientY;u(v,_)},[u]),g=F.useCallback(function(v){if(v){var _=wQ?{passive:!1}:!1;v.addEventListener("wheel",f,_),v.addEventListener("touchstart",d,_),v.addEventListener("touchmove",p,_)}},[p,d,f]),m=F.useCallback(function(v){v&&(v.removeEventListener("wheel",f,!1),v.removeEventListener("touchstart",d,!1),v.removeEventListener("touchmove",p,!1))},[p,d,f]);return F.useEffect(function(){if(t){var v=l.current;return g(v),function(){m(v)}}},[t,g,m]),function(v){l.current=v}}var iS=["boxSizing","height","overflow","paddingRight","position"],sS={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function aS(e){e.preventDefault()}function oS(e){e.stopPropagation()}function cS(){var e=this.scrollTop,t=this.scrollHeight,r=e+this.offsetHeight;e===0?this.scrollTop=1:r===t&&(this.scrollTop=e-1)}function lS(){return"ontouchstart"in window||navigator.maxTouchPoints}var uS=!!(typeof window<"u"&&window.document&&window.document.createElement),_l=0,Do={capture:!1,passive:!1};function rZ(e){var t=e.isEnabled,r=e.accountForScrollbars,n=r===void 0?!0:r,i=F.useRef({}),s=F.useRef(null),a=F.useCallback(function(c){if(uS){var l=document.body,u=l&&l.style;if(n&&iS.forEach(function(g){var m=u&&u[g];i.current[g]=m}),n&&_l<1){var f=parseInt(i.current.paddingRight,10)||0,d=document.body?document.body.clientWidth:0,p=window.innerWidth-d+f||0;Object.keys(sS).forEach(function(g){var m=sS[g];u&&(u[g]=m)}),u&&(u.paddingRight="".concat(p,"px"))}l&&lS()&&(l.addEventListener("touchmove",aS,Do),c&&(c.addEventListener("touchstart",cS,Do),c.addEventListener("touchmove",oS,Do))),_l+=1}},[n]),o=F.useCallback(function(c){if(uS){var l=document.body,u=l&&l.style;_l=Math.max(_l-1,0),n&&_l<1&&iS.forEach(function(f){var d=i.current[f];u&&(u[f]=d)}),l&&lS()&&(l.removeEventListener("touchmove",aS,Do),c&&(c.removeEventListener("touchstart",cS,Do),c.removeEventListener("touchmove",oS,Do)))}},[n]);return F.useEffect(function(){if(t){var c=s.current;return a(c),function(){o(c)}}},[t,a,o]),function(c){s.current=c}}var nZ=function(t){var r=t.target;return r.ownerDocument.activeElement&&r.ownerDocument.activeElement.blur()},iZ={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function sZ(e){var t=e.children,r=e.lockEnabled,n=e.captureEnabled,i=n===void 0?!0:n,s=e.onBottomArrive,a=e.onBottomLeave,o=e.onTopArrive,c=e.onTopLeave,l=tZ({isEnabled:i,onBottomArrive:s,onBottomLeave:a,onTopArrive:o,onTopLeave:c}),u=rZ({isEnabled:r}),f=function(p){l(p),u(p)};return Fe(F.Fragment,null,r&&Fe("div",{onClick:nZ,css:iZ}),t(f))}var aZ={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},oZ=function(t){var r=t.name,n=t.onFocus;return Fe("input",{required:!0,name:r,tabIndex:-1,"aria-hidden":"true",onFocus:n,css:aZ,value:"",onChange:function(){}})},cZ=oZ;function Ly(e){var t;return typeof window<"u"&&window.navigator!=null?e.test(((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.platform)||window.navigator.platform):!1}function lZ(){return Ly(/^iPhone/i)}function dP(){return Ly(/^Mac/i)}function uZ(){return Ly(/^iPad/i)||dP()&&navigator.maxTouchPoints>1}function fZ(){return lZ()||uZ()}function hZ(){return dP()||fZ()}var dZ=function(t){return t.label},pP=function(t){return t.label},mP=function(t){return t.value},pZ=function(t){return!!t.isDisabled},mZ={clearIndicator:ZQ,container:$Q,control:aJ,dropdownIndicator:QQ,group:uJ,groupHeading:hJ,indicatorsContainer:GQ,indicatorSeparator:tJ,input:gJ,loadingIndicator:iJ,loadingMessage:MQ,menu:bQ,menuList:DQ,menuPortal:BQ,multiValue:EJ,multiValueLabel:wJ,multiValueRemove:TJ,noOptionsMessage:LQ,option:RJ,placeholder:PJ,singleValue:OJ,valueContainer:zQ},gZ={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},vZ=4,gP=4,xZ=38,_Z=gP*2,yZ={baseUnit:gP,controlHeight:xZ,menuGutter:_Z},Sg={borderRadius:vZ,colors:gZ,spacing:yZ},EZ={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:ZT(),captureMenuScroll:!ZT(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:QJ(),formatGroupLabel:dZ,getOptionLabel:pP,getOptionValue:mP,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:pZ,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!yQ(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(t){var r=t.count;return"".concat(r," result").concat(r!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function fS(e,t,r,n){var i=_P(e,t,r),s=yP(e,t,r),a=xP(e,t),o=C0(e,t);return{type:"option",data:t,isDisabled:i,isSelected:s,label:a,value:o,index:n}}function id(e,t){return e.options.map(function(r,n){if("options"in r){var i=r.options.map(function(a,o){return fS(e,a,t,o)}).filter(function(a){return dS(e,a)});return i.length>0?{type:"group",data:r,options:i,index:n}:void 0}var s=fS(e,r,t,n);return dS(e,s)?s:void 0}).filter(TQ)}function vP(e){return e.reduce(function(t,r){return r.type==="group"?t.push.apply(t,vc(r.options.map(function(n){return n.data}))):t.push(r.data),t},[])}function hS(e,t){return e.reduce(function(r,n){return n.type==="group"?r.push.apply(r,vc(n.options.map(function(i){return{data:i.data,id:"".concat(t,"-").concat(n.index,"-").concat(i.index)}}))):r.push({data:n.data,id:"".concat(t,"-").concat(n.index)}),r},[])}function wZ(e,t){return vP(id(e,t))}function dS(e,t){var r=e.inputValue,n=r===void 0?"":r,i=t.data,s=t.isSelected,a=t.label,o=t.value;return(!wP(e)||!s)&&EP(e,{label:a,value:o,data:i},n)}function TZ(e,t){var r=e.focusedValue,n=e.selectValue,i=n.indexOf(r);if(i>-1){var s=t.indexOf(r);if(s>-1)return r;if(i<t.length)return t[i]}return null}function SZ(e,t){var r=e.focusedOption;return r&&t.indexOf(r)>-1?r:t[0]}var Ag=function(t,r){var n,i=(n=t.find(function(s){return s.data===r}))===null||n===void 0?void 0:n.id;return i||null},xP=function(t,r){return t.getOptionLabel(r)},C0=function(t,r){return t.getOptionValue(r)};function _P(e,t,r){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(t,r):!1}function yP(e,t,r){if(r.indexOf(t)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(t,r);var n=C0(e,t);return r.some(function(i){return C0(e,i)===n})}function EP(e,t,r){return e.filterOption?e.filterOption(t,r):!0}var wP=function(t){var r=t.hideSelectedOptions,n=t.isMulti;return r===void 0?n:r},AZ=1,TP=function(e){jX(r,e);var t=HX(r);function r(n){var i;if(MX(this,r),i=t.call(this,n),i.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},i.blockOptionHover=!1,i.isComposing=!1,i.commonProps=void 0,i.initialTouchX=0,i.initialTouchY=0,i.openAfterFocus=!1,i.scrollToFocusedOptionOnUpdate=!1,i.userIsDragging=void 0,i.isAppleDevice=hZ(),i.controlRef=null,i.getControlRef=function(c){i.controlRef=c},i.focusedOptionRef=null,i.getFocusedOptionRef=function(c){i.focusedOptionRef=c},i.menuListRef=null,i.getMenuListRef=function(c){i.menuListRef=c},i.inputRef=null,i.getInputRef=function(c){i.inputRef=c},i.focus=i.focusInput,i.blur=i.blurInput,i.onChange=function(c,l){var u=i.props,f=u.onChange,d=u.name;l.name=d,i.ariaOnChange(c,l),f(c,l)},i.setValue=function(c,l,u){var f=i.props,d=f.closeMenuOnSelect,p=f.isMulti,g=f.inputValue;i.onInputChange("",{action:"set-value",prevInputValue:g}),d&&(i.setState({inputIsHiddenAfterUpdate:!p}),i.onMenuClose()),i.setState({clearFocusValueOnUpdate:!0}),i.onChange(c,{action:l,option:u})},i.selectOption=function(c){var l=i.props,u=l.blurInputOnSelect,f=l.isMulti,d=l.name,p=i.state.selectValue,g=f&&i.isOptionSelected(c,p),m=i.isOptionDisabled(c,p);if(g){var v=i.getOptionValue(c);i.setValue(p.filter(function(_){return i.getOptionValue(_)!==v}),"deselect-option",c)}else if(!m)f?i.setValue([].concat(vc(p),[c]),"select-option",c):i.setValue(c,"select-option");else{i.ariaOnChange(c,{action:"select-option",option:c,name:d});return}u&&i.blurInput()},i.removeValue=function(c){var l=i.props.isMulti,u=i.state.selectValue,f=i.getOptionValue(c),d=u.filter(function(g){return i.getOptionValue(g)!==f}),p=Ll(l,d,d[0]||null);i.onChange(p,{action:"remove-value",removedValue:c}),i.focusInput()},i.clearValue=function(){var c=i.state.selectValue;i.onChange(Ll(i.props.isMulti,[],null),{action:"clear",removedValues:c})},i.popValue=function(){var c=i.props.isMulti,l=i.state.selectValue,u=l[l.length-1],f=l.slice(0,l.length-1),d=Ll(c,f,f[0]||null);i.onChange(d,{action:"pop-value",removedValue:u})},i.getFocusedOptionId=function(c){return Ag(i.state.focusableOptionsWithIds,c)},i.getFocusableOptionsWithIds=function(){return hS(id(i.props,i.state.selectValue),i.getElementId("option"))},i.getValue=function(){return i.state.selectValue},i.cx=function(){for(var c=arguments.length,l=new Array(c),u=0;u<c;u++)l[u]=arguments[u];return pQ.apply(void 0,[i.props.classNamePrefix].concat(l))},i.getOptionLabel=function(c){return xP(i.props,c)},i.getOptionValue=function(c){return C0(i.props,c)},i.getStyles=function(c,l){var u=i.props.unstyled,f=mZ[c](l,u);f.boxSizing="border-box";var d=i.props.styles[c];return d?d(f,l):f},i.getClassNames=function(c,l){var u,f;return(u=(f=i.props.classNames)[c])===null||u===void 0?void 0:u.call(f,l)},i.getElementId=function(c){return"".concat(i.state.instancePrefix,"-").concat(c)},i.getComponents=function(){return jJ(i.props)},i.buildCategorizedOptions=function(){return id(i.props,i.state.selectValue)},i.getCategorizedOptions=function(){return i.props.menuIsOpen?i.buildCategorizedOptions():[]},i.buildFocusableOptions=function(){return vP(i.buildCategorizedOptions())},i.getFocusableOptions=function(){return i.props.menuIsOpen?i.buildFocusableOptions():[]},i.ariaOnChange=function(c,l){i.setState({ariaSelection:Re({value:c},l)})},i.onMenuMouseDown=function(c){c.button===0&&(c.stopPropagation(),c.preventDefault(),i.focusInput())},i.onMenuMouseMove=function(c){i.blockOptionHover=!1},i.onControlMouseDown=function(c){if(!c.defaultPrevented){var l=i.props.openMenuOnClick;i.state.isFocused?i.props.menuIsOpen?c.target.tagName!=="INPUT"&&c.target.tagName!=="TEXTAREA"&&i.onMenuClose():l&&i.openMenu("first"):(l&&(i.openAfterFocus=!0),i.focusInput()),c.target.tagName!=="INPUT"&&c.target.tagName!=="TEXTAREA"&&c.preventDefault()}},i.onDropdownIndicatorMouseDown=function(c){if(!(c&&c.type==="mousedown"&&c.button!==0)&&!i.props.isDisabled){var l=i.props,u=l.isMulti,f=l.menuIsOpen;i.focusInput(),f?(i.setState({inputIsHiddenAfterUpdate:!u}),i.onMenuClose()):i.openMenu("first"),c.preventDefault()}},i.onClearIndicatorMouseDown=function(c){c&&c.type==="mousedown"&&c.button!==0||(i.clearValue(),c.preventDefault(),i.openAfterFocus=!1,c.type==="touchend"?i.focusInput():setTimeout(function(){return i.focusInput()}))},i.onScroll=function(c){typeof i.props.closeMenuOnScroll=="boolean"?c.target instanceof HTMLElement&&Xp(c.target)&&i.props.onMenuClose():typeof i.props.closeMenuOnScroll=="function"&&i.props.closeMenuOnScroll(c)&&i.props.onMenuClose()},i.onCompositionStart=function(){i.isComposing=!0},i.onCompositionEnd=function(){i.isComposing=!1},i.onTouchStart=function(c){var l=c.touches,u=l&&l.item(0);u&&(i.initialTouchX=u.clientX,i.initialTouchY=u.clientY,i.userIsDragging=!1)},i.onTouchMove=function(c){var l=c.touches,u=l&&l.item(0);if(u){var f=Math.abs(u.clientX-i.initialTouchX),d=Math.abs(u.clientY-i.initialTouchY),p=5;i.userIsDragging=f>p||d>p}},i.onTouchEnd=function(c){i.userIsDragging||(i.controlRef&&!i.controlRef.contains(c.target)&&i.menuListRef&&!i.menuListRef.contains(c.target)&&i.blurInput(),i.initialTouchX=0,i.initialTouchY=0)},i.onControlTouchEnd=function(c){i.userIsDragging||i.onControlMouseDown(c)},i.onClearIndicatorTouchEnd=function(c){i.userIsDragging||i.onClearIndicatorMouseDown(c)},i.onDropdownIndicatorTouchEnd=function(c){i.userIsDragging||i.onDropdownIndicatorMouseDown(c)},i.handleInputChange=function(c){var l=i.props.inputValue,u=c.currentTarget.value;i.setState({inputIsHiddenAfterUpdate:!1}),i.onInputChange(u,{action:"input-change",prevInputValue:l}),i.props.menuIsOpen||i.onMenuOpen()},i.onInputFocus=function(c){i.props.onFocus&&i.props.onFocus(c),i.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(i.openAfterFocus||i.props.openMenuOnFocus)&&i.openMenu("first"),i.openAfterFocus=!1},i.onInputBlur=function(c){var l=i.props.inputValue;if(i.menuListRef&&i.menuListRef.contains(document.activeElement)){i.inputRef.focus();return}i.props.onBlur&&i.props.onBlur(c),i.onInputChange("",{action:"input-blur",prevInputValue:l}),i.onMenuClose(),i.setState({focusedValue:null,isFocused:!1})},i.onOptionHover=function(c){if(!(i.blockOptionHover||i.state.focusedOption===c)){var l=i.getFocusableOptions(),u=l.indexOf(c);i.setState({focusedOption:c,focusedOptionId:u>-1?i.getFocusedOptionId(c):null})}},i.shouldHideSelectedOptions=function(){return wP(i.props)},i.onValueInputFocus=function(c){c.preventDefault(),c.stopPropagation(),i.focus()},i.onKeyDown=function(c){var l=i.props,u=l.isMulti,f=l.backspaceRemovesValue,d=l.escapeClearsValue,p=l.inputValue,g=l.isClearable,m=l.isDisabled,v=l.menuIsOpen,_=l.onKeyDown,x=l.tabSelectsValue,y=l.openMenuOnFocus,w=i.state,T=w.focusedOption,S=w.focusedValue,E=w.selectValue;if(!m&&!(typeof _=="function"&&(_(c),c.defaultPrevented))){switch(i.blockOptionHover=!0,c.key){case"ArrowLeft":if(!u||p)return;i.focusValue("previous");break;case"ArrowRight":if(!u||p)return;i.focusValue("next");break;case"Delete":case"Backspace":if(p)return;if(S)i.removeValue(S);else{if(!f)return;u?i.popValue():g&&i.clearValue()}break;case"Tab":if(i.isComposing||c.shiftKey||!v||!x||!T||y&&i.isOptionSelected(T,E))return;i.selectOption(T);break;case"Enter":if(c.keyCode===229)break;if(v){if(!T||i.isComposing)return;i.selectOption(T);break}return;case"Escape":v?(i.setState({inputIsHiddenAfterUpdate:!1}),i.onInputChange("",{action:"menu-close",prevInputValue:p}),i.onMenuClose()):g&&d&&i.clearValue();break;case" ":if(p)return;if(!v){i.openMenu("first");break}if(!T)return;i.selectOption(T);break;case"ArrowUp":v?i.focusOption("up"):i.openMenu("last");break;case"ArrowDown":v?i.focusOption("down"):i.openMenu("first");break;case"PageUp":if(!v)return;i.focusOption("pageup");break;case"PageDown":if(!v)return;i.focusOption("pagedown");break;case"Home":if(!v)return;i.focusOption("first");break;case"End":if(!v)return;i.focusOption("last");break;default:return}c.preventDefault()}},i.state.instancePrefix="react-select-"+(i.props.instanceId||++AZ),i.state.selectValue=A0(n.value),n.menuIsOpen&&i.state.selectValue.length){var s=i.getFocusableOptionsWithIds(),a=i.buildFocusableOptions(),o=a.indexOf(i.state.selectValue[0]);i.state.focusableOptionsWithIds=s,i.state.focusedOption=a[o],i.state.focusedOptionId=Ag(s,a[o])}return i}return VX(r,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&JT(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(i){var s=this.props,a=s.isDisabled,o=s.menuIsOpen,c=this.state.isFocused;(c&&!a&&i.isDisabled||c&&o&&!i.menuIsOpen)&&this.focusInput(),c&&a&&!i.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!c&&!a&&i.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(JT(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(i,s){this.props.onInputChange(i,s)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(i){var s=this,a=this.state,o=a.selectValue,c=a.isFocused,l=this.buildFocusableOptions(),u=i==="first"?0:l.length-1;if(!this.props.isMulti){var f=l.indexOf(o[0]);f>-1&&(u=f)}this.scrollToFocusedOptionOnUpdate=!(c&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:l[u],focusedOptionId:this.getFocusedOptionId(l[u])},function(){return s.onMenuOpen()})}},{key:"focusValue",value:function(i){var s=this.state,a=s.selectValue,o=s.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var c=a.indexOf(o);o||(c=-1);var l=a.length-1,u=-1;if(a.length){switch(i){case"previous":c===0?u=0:c===-1?u=l:u=c-1;break;case"next":c>-1&&c<l&&(u=c+1);break}this.setState({inputIsHidden:u!==-1,focusedValue:a[u]})}}}},{key:"focusOption",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",s=this.props.pageSize,a=this.state.focusedOption,o=this.getFocusableOptions();if(o.length){var c=0,l=o.indexOf(a);a||(l=-1),i==="up"?c=l>0?l-1:o.length-1:i==="down"?c=(l+1)%o.length:i==="pageup"?(c=l-s,c<0&&(c=0)):i==="pagedown"?(c=l+s,c>o.length-1&&(c=o.length-1)):i==="last"&&(c=o.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:o[c],focusedValue:null,focusedOptionId:this.getFocusedOptionId(o[c])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(Sg):Re(Re({},Sg),this.props.theme):Sg}},{key:"getCommonProps",value:function(){var i=this.clearValue,s=this.cx,a=this.getStyles,o=this.getClassNames,c=this.getValue,l=this.selectOption,u=this.setValue,f=this.props,d=f.isMulti,p=f.isRtl,g=f.options,m=this.hasValue();return{clearValue:i,cx:s,getStyles:a,getClassNames:o,getValue:c,hasValue:m,isMulti:d,isRtl:p,options:g,selectOption:l,selectProps:f,setValue:u,theme:this.getTheme()}}},{key:"hasValue",value:function(){var i=this.state.selectValue;return i.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var i=this.props,s=i.isClearable,a=i.isMulti;return s===void 0?a:s}},{key:"isOptionDisabled",value:function(i,s){return _P(this.props,i,s)}},{key:"isOptionSelected",value:function(i,s){return yP(this.props,i,s)}},{key:"filterOption",value:function(i,s){return EP(this.props,i,s)}},{key:"formatOptionLabel",value:function(i,s){if(typeof this.props.formatOptionLabel=="function"){var a=this.props.inputValue,o=this.state.selectValue;return this.props.formatOptionLabel(i,{context:s,inputValue:a,selectValue:o})}else return this.getOptionLabel(i)}},{key:"formatGroupLabel",value:function(i){return this.props.formatGroupLabel(i)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var i=this.props,s=i.isDisabled,a=i.isSearchable,o=i.inputId,c=i.inputValue,l=i.tabIndex,u=i.form,f=i.menuIsOpen,d=i.required,p=this.getComponents(),g=p.Input,m=this.state,v=m.inputIsHidden,_=m.ariaSelection,x=this.commonProps,y=o||this.getElementId("input"),w=Re(Re(Re({"aria-autocomplete":"list","aria-expanded":f,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":d,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},f&&{"aria-controls":this.getElementId("listbox")}),!a&&{"aria-readonly":!0}),this.hasValue()?(_==null?void 0:_.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return a?F.createElement(g,Pe({},x,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:y,innerRef:this.getInputRef,isDisabled:s,isHidden:v,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:l,form:u,type:"text",value:c},w)):F.createElement(ZJ,Pe({id:y,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:S0,onFocus:this.onInputFocus,disabled:s,tabIndex:l,inputMode:"none",form:u,value:""},w))}},{key:"renderPlaceholderOrValue",value:function(){var i=this,s=this.getComponents(),a=s.MultiValue,o=s.MultiValueContainer,c=s.MultiValueLabel,l=s.MultiValueRemove,u=s.SingleValue,f=s.Placeholder,d=this.commonProps,p=this.props,g=p.controlShouldRenderValue,m=p.isDisabled,v=p.isMulti,_=p.inputValue,x=p.placeholder,y=this.state,w=y.selectValue,T=y.focusedValue,S=y.isFocused;if(!this.hasValue()||!g)return _?null:F.createElement(f,Pe({},d,{key:"placeholder",isDisabled:m,isFocused:S,innerProps:{id:this.getElementId("placeholder")}}),x);if(v)return w.map(function(k,b){var j=k===T,H="".concat(i.getOptionLabel(k),"-").concat(i.getOptionValue(k));return F.createElement(a,Pe({},d,{components:{Container:o,Label:c,Remove:l},isFocused:j,isDisabled:m,key:H,index:b,removeProps:{onClick:function(){return i.removeValue(k)},onTouchEnd:function(){return i.removeValue(k)},onMouseDown:function(V){V.preventDefault()}},data:k}),i.formatOptionLabel(k,"value"))});if(_)return null;var E=w[0];return F.createElement(u,Pe({},d,{data:E,isDisabled:m}),this.formatOptionLabel(E,"value"))}},{key:"renderClearIndicator",value:function(){var i=this.getComponents(),s=i.ClearIndicator,a=this.commonProps,o=this.props,c=o.isDisabled,l=o.isLoading,u=this.state.isFocused;if(!this.isClearable()||!s||c||!this.hasValue()||l)return null;var f={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return F.createElement(s,Pe({},a,{innerProps:f,isFocused:u}))}},{key:"renderLoadingIndicator",value:function(){var i=this.getComponents(),s=i.LoadingIndicator,a=this.commonProps,o=this.props,c=o.isDisabled,l=o.isLoading,u=this.state.isFocused;if(!s||!l)return null;var f={"aria-hidden":"true"};return F.createElement(s,Pe({},a,{innerProps:f,isDisabled:c,isFocused:u}))}},{key:"renderIndicatorSeparator",value:function(){var i=this.getComponents(),s=i.DropdownIndicator,a=i.IndicatorSeparator;if(!s||!a)return null;var o=this.commonProps,c=this.props.isDisabled,l=this.state.isFocused;return F.createElement(a,Pe({},o,{isDisabled:c,isFocused:l}))}},{key:"renderDropdownIndicator",value:function(){var i=this.getComponents(),s=i.DropdownIndicator;if(!s)return null;var a=this.commonProps,o=this.props.isDisabled,c=this.state.isFocused,l={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return F.createElement(s,Pe({},a,{innerProps:l,isDisabled:o,isFocused:c}))}},{key:"renderMenu",value:function(){var i=this,s=this.getComponents(),a=s.Group,o=s.GroupHeading,c=s.Menu,l=s.MenuList,u=s.MenuPortal,f=s.LoadingMessage,d=s.NoOptionsMessage,p=s.Option,g=this.commonProps,m=this.state.focusedOption,v=this.props,_=v.captureMenuScroll,x=v.inputValue,y=v.isLoading,w=v.loadingMessage,T=v.minMenuHeight,S=v.maxMenuHeight,E=v.menuIsOpen,k=v.menuPlacement,b=v.menuPosition,j=v.menuPortalTarget,H=v.menuShouldBlockScroll,O=v.menuShouldScrollIntoView,V=v.noOptionsMessage,G=v.onMenuScrollToTop,X=v.onMenuScrollToBottom;if(!E)return null;var Z=function(W,z){var U=W.type,ee=W.data,oe=W.isDisabled,me=W.isSelected,de=W.label,ce=W.value,ze=m===ee,M=oe?void 0:function(){return i.onOptionHover(ee)},dt=oe?void 0:function(){return i.selectOption(ee)},qe="".concat(i.getElementId("option"),"-").concat(z),Ze={id:qe,onClick:dt,onMouseMove:M,onMouseOver:M,tabIndex:-1,role:"option","aria-selected":i.isAppleDevice?void 0:me};return F.createElement(p,Pe({},g,{innerProps:Ze,data:ee,isDisabled:oe,isSelected:me,key:qe,label:de,type:U,value:ce,isFocused:ze,innerRef:ze?i.getFocusedOptionRef:void 0}),i.formatOptionLabel(W.data,"menu"))},ie;if(this.hasOptions())ie=this.getCategorizedOptions().map(function(I){if(I.type==="group"){var W=I.data,z=I.options,U=I.index,ee="".concat(i.getElementId("group"),"-").concat(U),oe="".concat(ee,"-heading");return F.createElement(a,Pe({},g,{key:ee,data:W,options:z,Heading:o,headingProps:{id:oe,data:I.data},label:i.formatGroupLabel(I.data)}),I.options.map(function(me){return Z(me,"".concat(U,"-").concat(me.index))}))}else if(I.type==="option")return Z(I,"".concat(I.index))});else if(y){var re=w({inputValue:x});if(re===null)return null;ie=F.createElement(f,g,re)}else{var B=V({inputValue:x});if(B===null)return null;ie=F.createElement(d,g,B)}var ae={minMenuHeight:T,maxMenuHeight:S,menuPlacement:k,menuPosition:b,menuShouldScrollIntoView:O},xe=F.createElement(FQ,Pe({},g,ae),function(I){var W=I.ref,z=I.placerProps,U=z.placement,ee=z.maxHeight;return F.createElement(c,Pe({},g,ae,{innerRef:W,innerProps:{onMouseDown:i.onMenuMouseDown,onMouseMove:i.onMenuMouseMove},isLoading:y,placement:U}),F.createElement(sZ,{captureEnabled:_,onTopArrive:G,onBottomArrive:X,lockEnabled:H},function(oe){return F.createElement(l,Pe({},g,{innerRef:function(de){i.getMenuListRef(de),oe(de)},innerProps:{role:"listbox","aria-multiselectable":g.isMulti,id:i.getElementId("listbox")},isLoading:y,maxHeight:ee,focusedOption:m}),ie)}))});return j||b==="fixed"?F.createElement(u,Pe({},g,{appendTo:j,controlElement:this.controlRef,menuPlacement:k,menuPosition:b}),xe):xe}},{key:"renderFormField",value:function(){var i=this,s=this.props,a=s.delimiter,o=s.isDisabled,c=s.isMulti,l=s.name,u=s.required,f=this.state.selectValue;if(u&&!this.hasValue()&&!o)return F.createElement(cZ,{name:l,onFocus:this.onValueInputFocus});if(!(!l||o))if(c)if(a){var d=f.map(function(m){return i.getOptionValue(m)}).join(a);return F.createElement("input",{name:l,type:"hidden",value:d})}else{var p=f.length>0?f.map(function(m,v){return F.createElement("input",{key:"i-".concat(v),name:l,type:"hidden",value:i.getOptionValue(m)})}):F.createElement("input",{name:l,type:"hidden",value:""});return F.createElement("div",null,p)}else{var g=f[0]?this.getOptionValue(f[0]):"";return F.createElement("input",{name:l,type:"hidden",value:g})}}},{key:"renderLiveRegion",value:function(){var i=this.commonProps,s=this.state,a=s.ariaSelection,o=s.focusedOption,c=s.focusedValue,l=s.isFocused,u=s.selectValue,f=this.getFocusableOptions();return F.createElement(qJ,Pe({},i,{id:this.getElementId("live-region"),ariaSelection:a,focusedOption:o,focusedValue:c,isFocused:l,selectValue:u,focusableOptions:f,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var i=this.getComponents(),s=i.Control,a=i.IndicatorsContainer,o=i.SelectContainer,c=i.ValueContainer,l=this.props,u=l.className,f=l.id,d=l.isDisabled,p=l.menuIsOpen,g=this.state.isFocused,m=this.commonProps=this.getCommonProps();return F.createElement(o,Pe({},m,{className:u,innerProps:{id:f,onKeyDown:this.onKeyDown},isDisabled:d,isFocused:g}),this.renderLiveRegion(),F.createElement(s,Pe({},m,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:d,isFocused:g,menuIsOpen:p}),F.createElement(c,Pe({},m,{isDisabled:d}),this.renderPlaceholderOrValue(),this.renderInput()),F.createElement(a,Pe({},m,{isDisabled:d}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(i,s){var a=s.prevProps,o=s.clearFocusValueOnUpdate,c=s.inputIsHiddenAfterUpdate,l=s.ariaSelection,u=s.isFocused,f=s.prevWasFocused,d=s.instancePrefix,p=i.options,g=i.value,m=i.menuIsOpen,v=i.inputValue,_=i.isMulti,x=A0(g),y={};if(a&&(g!==a.value||p!==a.options||m!==a.menuIsOpen||v!==a.inputValue)){var w=m?wZ(i,x):[],T=m?hS(id(i,x),"".concat(d,"-option")):[],S=o?TZ(s,x):null,E=SZ(s,w),k=Ag(T,E);y={selectValue:x,focusedOption:E,focusedOptionId:k,focusableOptionsWithIds:T,focusedValue:S,clearFocusValueOnUpdate:!1}}var b=c!=null&&i!==a?{inputIsHidden:c,inputIsHiddenAfterUpdate:void 0}:{},j=l,H=u&&f;return u&&!H&&(j={value:Ll(_,x,x[0]||null),options:x,action:"initial-input-focus"},H=!f),(l==null?void 0:l.action)==="initial-input-focus"&&(j=null),Re(Re(Re({},y),b),{},{prevProps:i,ariaSelection:j,prevWasFocused:H})}}]),r}(F.Component);TP.defaultProps=EZ;var kZ=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"];function CZ(e){var t=e.defaultOptions,r=t===void 0?!1:t,n=e.cacheOptions,i=n===void 0?!1:n,s=e.loadOptions;e.options;var a=e.isLoading,o=a===void 0?!1:a,c=e.onInputChange,l=e.filterOption,u=l===void 0?null:l,f=yi(e,kZ),d=f.inputValue,p=F.useRef(void 0),g=F.useRef(!1),m=F.useState(Array.isArray(r)?r:void 0),v=ur(m,2),_=v[0],x=v[1],y=F.useState(typeof d<"u"?d:""),w=ur(y,2),T=w[0],S=w[1],E=F.useState(r===!0),k=ur(E,2),b=k[0],j=k[1],H=F.useState(void 0),O=ur(H,2),V=O[0],G=O[1],X=F.useState([]),Z=ur(X,2),ie=Z[0],re=Z[1],B=F.useState(!1),ae=ur(B,2),xe=ae[0],I=ae[1],W=F.useState({}),z=ur(W,2),U=z[0],ee=z[1],oe=F.useState(void 0),me=ur(oe,2),de=me[0],ce=me[1],ze=F.useState(void 0),M=ur(ze,2),dt=M[0],qe=M[1];i!==dt&&(ee({}),qe(i)),r!==de&&(x(Array.isArray(r)?r:void 0),ce(r)),F.useEffect(function(){return g.current=!0,function(){g.current=!1}},[]);var Ze=F.useCallback(function(q,te){if(!s)return te();var ge=s(q,te);ge&&typeof ge.then=="function"&&ge.then(te,function(){return te()})},[s]);F.useEffect(function(){r===!0&&Ze(T,function(q){g.current&&(x(q||[]),j(!!p.current))})},[]);var We=F.useCallback(function(q,te){var ge=mQ(q,te,c);if(!ge){p.current=void 0,S(""),G(""),re([]),j(!1),I(!1);return}if(i&&U[ge])S(ge),G(ge),re(U[ge]),j(!1),I(!1);else{var ve=p.current={};S(ge),j(!0),I(!V),Ze(ge,function(ue){g&&ve===p.current&&(p.current=void 0,j(!1),G(ge),re(ue||[]),I(!1),ee(ue?Re(Re({},U),{},rc({},ge,ue)):U))})}},[i,Ze,V,U,c]),P=xe?[]:T&&V?ie:_||[];return Re(Re({},f),{},{options:P,isLoading:b||o,onInputChange:We,filterOption:u})}var IZ=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function RZ(e){var t=e.defaultInputValue,r=t===void 0?"":t,n=e.defaultMenuIsOpen,i=n===void 0?!1:n,s=e.defaultValue,a=s===void 0?null:s,o=e.inputValue,c=e.menuIsOpen,l=e.onChange,u=e.onInputChange,f=e.onMenuClose,d=e.onMenuOpen,p=e.value,g=yi(e,IZ),m=F.useState(o!==void 0?o:r),v=ur(m,2),_=v[0],x=v[1],y=F.useState(c!==void 0?c:i),w=ur(y,2),T=w[0],S=w[1],E=F.useState(p!==void 0?p:a),k=ur(E,2),b=k[0],j=k[1],H=F.useCallback(function(re,B){typeof l=="function"&&l(re,B),j(re)},[l]),O=F.useCallback(function(re,B){var ae;typeof u=="function"&&(ae=u(re,B)),x(ae!==void 0?ae:re)},[u]),V=F.useCallback(function(){typeof d=="function"&&d(),S(!0)},[d]),G=F.useCallback(function(){typeof f=="function"&&f(),S(!1)},[f]),X=o!==void 0?o:_,Z=c!==void 0?c:T,ie=p!==void 0?p:b;return Re(Re({},g),{},{inputValue:X,menuIsOpen:Z,onChange:H,onInputChange:O,onMenuClose:G,onMenuOpen:V,value:ie})}var bZ=["allowCreateWhileLoading","createOptionPosition","formatCreateLabel","isValidNewOption","getNewOptionData","onCreateOption","options","onChange"],pS=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=String(t).toLowerCase(),s=String(n.getOptionValue(r)).toLowerCase(),a=String(n.getOptionLabel(r)).toLowerCase();return s===i||a===i},kg={formatCreateLabel:function(t){return'Create "'.concat(t,'"')},isValidNewOption:function(t,r,n,i){return!(!t||r.some(function(s){return pS(t,s,i)})||n.some(function(s){return pS(t,s,i)}))},getNewOptionData:function(t,r){return{label:r,value:t,__isNew__:!0}}};function FZ(e){var t=e.allowCreateWhileLoading,r=t===void 0?!1:t,n=e.createOptionPosition,i=n===void 0?"last":n,s=e.formatCreateLabel,a=s===void 0?kg.formatCreateLabel:s,o=e.isValidNewOption,c=o===void 0?kg.isValidNewOption:o,l=e.getNewOptionData,u=l===void 0?kg.getNewOptionData:l,f=e.onCreateOption,d=e.options,p=d===void 0?[]:d,g=e.onChange,m=yi(e,bZ),v=m.getOptionValue,_=v===void 0?mP:v,x=m.getOptionLabel,y=x===void 0?pP:x,w=m.inputValue,T=m.isLoading,S=m.isMulti,E=m.value,k=m.name,b=F.useMemo(function(){return c(w,A0(E),p,{getOptionValue:_,getOptionLabel:y})?u(w,a(w)):void 0},[a,u,y,_,w,c,p,E]),j=F.useMemo(function(){return(r||!T)&&b?i==="first"?[b].concat(vc(p)):[].concat(vc(p),[b]):p},[r,i,T,b,p]),H=F.useCallback(function(O,V){if(V.action!=="select-option")return g(O,V);var G=Array.isArray(O)?O:[O];if(G[G.length-1]===b){if(f)f(w);else{var X=u(w,w),Z={action:"create-option",name:k,option:X};g(Ll(S,[].concat(vc(A0(E)),[X]),X),Z)}return}g(O,V)},[u,w,S,k,b,f,g,E]);return Re(Re({},m),{},{options:j,onChange:H})}var PZ=F.forwardRef(function(e,t){var r=CZ(e),n=RZ(r),i=FZ(n);return F.createElement(TP,Pe({ref:t},i))}),SP=PZ;const AP=async e=>{try{const t=await zB(e);return[...new Set(t)].map(n=>({value:n,label:n}))}catch(t){return console.error("Error al buscar sugerencias de unidad técnica:",t),[]}};function kP({fieldName:e,content:t,documentId:r,modalRef:n,isVisible:i,closeModal:s}){const[a,o]=F.useState(!1),{control:c,handleSubmit:l,setError:u,clearErrors:f,formState:d,reset:p}=Ta({defaultValues:{changeContent:t,editedBy:"",changeDescription:""}}),[g,m]=F.useState({label:t,value:t});F.useEffect(()=>{i&&n.current?window.$(n.current).modal("show"):!i&&n.current&&window.$(n.current).modal("hide")},[i,n]);const v=async _=>{try{const{changeContent:x,editedBy:y,changeDescription:w}=_;if(!x)throw new Error("El contenido no puede estar vacío.");if(!y)throw new Error("El campo 'Modificado por' es requerido.");if(!w)throw new Error("El campo 'Descripción del cambio' es requerido.");if(f("changeContent"),e==="week_name"&&!IF(x)){u("changeContent",{type:"manual",message:"El formato de la semana no es válido. Debe ser año-semana ('AAAA-SS')."});return}const T=await WB(r);if(!T)throw new Error("Actividad no encontrada.");const S=localStorage.getItem("userEmail"),E={activity:r,modified_table_name:"Activity",modified_field:e,modified_at:new Date,modified_by:S,edited_by:y,old_value:T.data[e],new_value:x,modified_value_description:w,status:""};o(!0),await OB(E),await GB(r,e,x),o(!1),Ne.success("Cambios exitosamente guardados!"),p({changeContent:"",editedBy:"",changeDescription:""}),setTimeout(()=>{s(),window.location.reload()},1500)}catch(x){console.error("Error al manejar el guardado: ",x),Ne.error(`Error al manejar el guardado ${x.message}`),o(!1)}};return h.jsx("div",{className:"modal",id:"exampleModal",tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:n,children:h.jsxs("div",{className:"modal-dialog",role:"document",children:[h.jsx("div",{className:"modal-content",children:h.jsxs("form",{onSubmit:l(v),children:[h.jsxs("div",{className:"modal-header",children:[h.jsx("h1",{className:"modal-title fs-5",id:"exampleModalLabel",children:"EDITAR CONTENIDO"}),h.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close","data-bs-toggle":"modal"})]}),h.jsxs("div",{className:"modal-body",children:[h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"changeContent",className:"form-label",children:"Contenido:"}),h.jsx(Ve,{name:"changeContent",control:c,rules:{required:"Este campo es requerido"},render:({field:_})=>h.jsx(h.Fragment,{children:e==="u_tecnica"?h.jsx(SP,{isClearable:!0,isSearchable:!0,cacheOptions:!0,defaultOptions:!0,loadOptions:AP,value:g,placeholder:t,onChange:x=>m(x)}):h.jsxs(h.Fragment,{children:[h.jsx("input",{..._,id:"changeContent",type:"text",className:"form-control",placeholder:t}),d.errors.changeContent&&h.jsx("p",{className:"text-danger",children:d.errors.changeContent.message})]})})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"editedBy",className:"form-label",children:"Modificado por:"}),h.jsx(Ve,{name:"editedBy",control:c,rules:{required:"Este campo es requerido"},render:({field:_})=>h.jsxs(h.Fragment,{children:[h.jsx("input",{..._,type:"text",className:"form-control",id:"editedBy",placeholder:"Nombre Apellido"}),d.errors.editedBy&&h.jsx("p",{className:"text-danger",children:d.errors.editedBy.message})]})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"changeDescription",className:"form-label",children:"Descripción del cambio:"}),h.jsx(Ve,{name:"changeDescription",control:c,rules:{required:"Este campo es requerido"},render:({field:_})=>h.jsxs(h.Fragment,{children:[h.jsx("textarea",{..._,className:"form-control",id:"changeDescription",rows:"3"}),d.errors.changeDescription&&h.jsx("p",{className:"text-danger",children:d.errors.changeDescription.message})]})})]})]}),h.jsxs("div",{className:"modal-footer",children:[h.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal","data-bs-toggle":"modal",children:"Cerrar"}),h.jsx("button",{type:"submit",className:"btn btn-dark",disabled:a,children:a?h.jsx(Un,{}):"Guardar cambios"})]})]})}),h.jsx(pa,{className:"custom-toast",position:"top-right",autoClose:3e3,hideProgressBar:!0})]})})}kP.propTypes={documentId:rt.string,setIsModalVisible:rt.func,onClose:rt.func,fieldName:rt.string};function CP({weekDocument:e,activityDocument:t,documentId:r}){var d,p,g,m,v,_,x;const[n,i]=F.useState(""),[s,a]=F.useState(""),[o,c]=F.useState(!1),l=F.useRef(),u=(y,w)=>{a(y),i(w),c(!0)},f=()=>{c(!1)};return h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"table-responsive",children:[h.jsx("h1",{className:"my-2 text-center mt-3 mb-3",children:"Información de Actividad"}),h.jsx("table",{className:"table table-hover table-bordered",children:h.jsxs("tbody",{children:[h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Empresa:"}),h.jsxs("td",{className:"d-flex justify-content-between",children:[(e==null?void 0:e.data.team)==="impacto_acido"?"Impacto Ácido":(e==null?void 0:e.data.team)==="impacto"?"Impacto":e==null?void 0:e.data.team,h.jsx("button",{"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:()=>u(e.data.team==="impacto_acido"?"Impacto Ácido":e.data.team==="impacto"?"Impacto":e.data.team,"team"),children:h.jsx("i",{className:"bi bi-pencil"})})]}),h.jsx("th",{scope:"row",children:"Semana:"}),h.jsxs("td",{className:"d-flex justify-content-between",children:[t==null?void 0:t.data.week_name,h.jsx("button",{"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:()=>u(t.data.week_name,"week_name"),children:h.jsx("i",{className:"bi bi-pencil"})})]})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Fecha de creación:"}),h.jsx("td",{children:e.data.created_at.toDate().toLocaleString()}),h.jsx("th",{scope:"row",children:"Creado por:"}),h.jsxs("td",{children:[" ",e.data.created_by]})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Informado por:"}),h.jsx("td",{colSpan:3,children:h.jsxs("div",{className:"d-flex justify-content-between",children:[t.data.informed_by,h.jsx("button",{"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:()=>u(t.data.informed_by,"informed_by"),children:h.jsx("i",{className:"bi bi-pencil"})})]})})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Prioridad:"}),h.jsx("td",{colSpan:3,children:h.jsxs("div",{className:"d-flex justify-content-between",children:[(d=t.data)==null?void 0:d.prioridad,h.jsx("button",{"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:()=>u(t.data.prioridad,"prioridad"),children:h.jsx("i",{className:"bi bi-pencil"})})]})})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"N° Aviso:"}),h.jsx("td",{colSpan:3,children:h.jsxs("div",{className:"d-flex justify-content-between",children:[(p=t.data)==null?void 0:p.n_aviso,h.jsx("button",{"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:()=>u(t.data.n_aviso,"n_aviso"),children:h.jsx("i",{className:"bi bi-pencil"})})]})})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Equipo o Sistema: "}),h.jsx("td",{colSpan:3,children:h.jsxs("div",{className:"d-flex justify-content-between",children:[(g=t.data)==null?void 0:g.equipo_o_sistema,h.jsx("button",{"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:()=>u(t.data.equipo_o_sistema,"equipo_o_sistema"),children:h.jsx("i",{className:"bi bi-pencil"})})]})})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Unidad Técnica:"}),h.jsx("td",{colSpan:3,children:h.jsxs("div",{className:"d-flex justify-content-between",children:[(m=t.data)==null?void 0:m.u_tecnica,h.jsx("button",{"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:()=>u(t.data.u_tecnica,"u_tecnica"),children:h.jsx("i",{className:"bi bi-pencil"})})]})})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Descripción del Trabajo:"}),h.jsx("td",{colSpan:3,children:h.jsxs("div",{className:"d-flex justify-content-between",children:[(v=t.data)==null?void 0:v.descripcion_del_trabajo,h.jsx("button",{"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:()=>u(t.data.descripcion_del_trabajo,"descripcion_del_trabajo"),children:h.jsx("i",{className:"bi bi-pencil"})})]})})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Descripción del Aviso:"}),h.jsx("td",{colSpan:3,children:h.jsxs("div",{className:"d-flex justify-content-between",children:[(_=t.data)==null?void 0:_.descripcion_del_aviso,h.jsx("button",{"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:()=>u(t.data.descripcion_del_aviso,"descripcion_del_aviso"),children:h.jsx("i",{className:"bi bi-pencil"})})]})})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Vulnerabilidad"}),h.jsx("td",{colSpan:3,children:h.jsxs("div",{className:"d-flex justify-content-between",children:[(x=t.data)==null?void 0:x.vulnerabilidad_1,h.jsx("button",{"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:()=>u(t.data.vulnerabilidad_1,"vulnerabilidad_1"),children:h.jsx("i",{className:"bi bi-pencil"})})]})})]})]})})]}),h.jsx(kP,{fieldName:n,content:s,documentId:r,modalRef:l,isVisible:o,closeModal:f})]})}CP.propTypes={documentId:rt.string,weekDocument:rt.object,activityDocument:rt.object,activityStatusDocument:rt.object,activityLogDocument:rt.object};function IP({activityStatusDocument:e}){const t=e.sort((n,i)=>i.data.created_at.toMillis()-n.data.created_at.toMillis()),r=t[0];return h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"table-responsive",children:[h.jsx("h1",{className:"my-2 text-center mt-3 mb-3",children:"Estado Impacto Actual"}),h.jsx("table",{className:"table table-hover table-bordered",children:h.jsxs("tbody",{children:[h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Fecha de creación:"}),h.jsx("td",{children:r==null?void 0:r.data.created_at.toDate().toLocaleString()})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Estado actual:"}),h.jsx("td",{children:r==null?void 0:r.data.status})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Descripción:"}),h.jsx("td",{children:r!=null&&r.data.description?r.data.description:"Sin descripción."})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Creado por:"}),h.jsx("td",{children:r==null?void 0:r.data.created_by})]})]})})]}),h.jsxs("div",{className:"mt-4",children:[h.jsx("h2",{children:"Historial de Estados:"}),h.jsx("div",{className:"table-responsive",children:h.jsxs("table",{className:"table table-hover table-bordered",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"align-middle",children:[h.jsx("th",{children:"Fecha de creación"}),h.jsx("th",{children:"Estado"}),h.jsx("th",{children:"Descripción"}),h.jsx("th",{children:"Creado por"})]})}),h.jsx("tbody",{children:t.length>1?t.slice(1).map((n,i)=>h.jsxs("tr",{children:[h.jsx("td",{children:n.data.created_at.toDate().toLocaleString()}),h.jsx("td",{children:n.data.status}),h.jsx("td",{children:n.data.description?n.data.description:"Sin descripción."}),h.jsx("td",{children:n.data.created_by})]},i)):h.jsx("tr",{children:h.jsx("td",{colSpan:"4",children:"No hay historial de estados disponible."})})})]})})]})]})}IP.propTypes={activityStatusDocument:rt.array};function RP({isLoading:e,activityPlanningDocument:t}){const r=t&&t.length>0?t[0].data:{};return h.jsx(h.Fragment,{children:t&&Object.keys(t).length!==0?e?h.jsx(Un,{}):h.jsxs("div",{className:"table-responsive",children:[h.jsx("h1",{className:"my-2 text-center mt-3 mb-3",children:"Planificación de la Actividad"}),h.jsx("table",{className:"table table-hover table-bordered",children:h.jsxs("tbody",{children:[h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"N° OT"}),h.jsx("td",{colSpan:3,children:r.OT})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Inicio programa"}),h.jsx("td",{children:r.program_start}),h.jsx("th",{scope:"row",children:"Inicio real"}),h.jsx("td",{children:r.real_program_start})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Fin programa"}),h.jsx("td",{children:r.program_end}),h.jsx("th",{scope:"row",children:"Fin real"}),h.jsx("td",{children:r.real_program_end})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Duración programa"}),h.jsx("td",{children:r.program_duration}),h.jsx("th",{scope:"row",children:"Duración real"}),h.jsx("td",{children:r.real_program_duration})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Alcances programa"}),h.jsx("td",{children:r.program_scope}),h.jsx("th",{scope:"row",children:"Alcance real"}),h.jsx("td",{children:r.real_program_scope})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Descripción detallada de la actividad"}),h.jsx("td",{colSpan:3,children:r.detailed_activity_description})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Especificaciones técnicas relevantes"}),h.jsx("td",{colSpan:3,children:r.relevant_technical_specifications})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Paso a paso general"}),h.jsx("td",{colSpan:3,children:r.general_step_by_step})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Materiales e insumos requeridos"}),h.jsx("td",{colSpan:3,children:r.required_material})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Equipos de apoyo requeridos"}),h.jsx("td",{colSpan:3,children:r.required_support_equipment})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Estándar técnico"}),h.jsx("td",{colSpan:3,children:r.technical_standard})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Procedimiento de trabajo"}),h.jsx("td",{colSpan:3,children:r.work_procedure})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Riesgos críticos y controles aplicados"}),h.jsx("td",{colSpan:3,children:r.risks_and_controls})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Analálisis de riesgos (¿Qué pasa sí?)"}),h.jsx("td",{colSpan:3,children:r.risk_analysis})]})]})})]}):h.jsxs("div",{className:"table-responsive",children:[h.jsx("h1",{className:"my-2 text-center mt-3 mb-3",children:"Planificación de la Actividad"}),h.jsx("table",{className:"table table-hover table-bordered"}),h.jsx("p",{children:"Sin planificaciones disponibles"})]})})}RP.propTypes={isLoading:rt.bool,activityPlanningDocument:rt.array};function bP({activityLogImage:e,activityLogImageDescription:t,closeModal:r}){const[n,i]=F.useState(""),[s,a]=F.useState(!1),o=F.useRef(null);F.useEffect(()=>{e&&(async()=>{try{a(!0);const u=await T4(e);i(u)}catch(u){console.error("Error fetching image URL:",u)}finally{a(!1)}})()},[e]);const c=()=>{o.current.click()};return h.jsx("div",{className:"container",children:h.jsx("div",{className:"modal fade show",style:{display:"block"},tabIndex:"-1",children:h.jsx("div",{className:"modal-dialog modal-lg",children:h.jsxs("div",{className:"modal-content",children:[h.jsx("div",{className:"modal-header",children:h.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:r})}),h.jsxs("div",{className:"modal-body d-flex flex-column justify-content-center align-items-center",children:[h.jsx("h1",{className:"text-center mb-4",children:"IMAGEN"}),s?h.jsx(Un,{}):h.jsx(h.Fragment,{children:n?h.jsxs(h.Fragment,{children:[h.jsx("img",{src:n,alt:"Image",style:{width:"15rem",height:"15rem",objectFit:"cover"}}),h.jsx("p",{className:"mt-2",children:t}),h.jsx("a",{ref:o,href:n,download:"nombre-de-la-imagen.jpg",target:"_blank",rel:"noopener noreferrer",style:{display:"none"}}),h.jsx("button",{type:"button",className:"btn btn-dark",onClick:c,children:"VER IMAGEN EN TAMAÑO COMPLETO"})]}):h.jsx("p",{children:"Sin imágenes disponibles"})})]})]})})})})}bP.propTypes={activityLogImage:rt.string,activityLogImageDescription:rt.string,closeModal:rt.func.isRequired};function FP({activityLogDocument:e}){const[t,r]=F.useState(!1),[n,i]=F.useState(null),[s,a]=F.useState(!1),o=e.sort((f,d)=>d.data.activity_log_created_at.toMillis()-f.data.activity_log_created_at.toMillis()),c=f=>{i(f),r(!0)},l=()=>{i(null),r(!1)},u=50;return h.jsx(h.Fragment,{children:h.jsxs("div",{className:"mt-4",children:[h.jsx("h2",{children:"Historial de Registros:"}),h.jsx("div",{className:"table-responsive",children:h.jsxs("table",{className:"table table-hover table-bordered",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"align-middle",children:[h.jsx("th",{children:"Fecha de creación"}),h.jsx("th",{children:"Descripción de Registro"}),h.jsx("th",{children:"Coordenadas GPS"}),h.jsx("th",{children:"Creado por"}),h.jsx("th",{children:"Descripción de Imagen"}),h.jsx("th",{children:"Imagen"})]})}),h.jsx("tbody",{children:o.length>=1?o.map((f,d)=>{var p;return h.jsxs("tr",{children:[h.jsx("td",{children:(p=f==null?void 0:f.data.activity_log_created_at)==null?void 0:p.toDate().toLocaleString()}),h.jsxs("td",{className:"position-relative",style:{width:"300px"},children:[f!=null&&f.data.activity_log_description&&(f==null?void 0:f.data.activity_log_description.length)>u?h.jsxs("div",{className:"d-flex",children:[h.jsx("div",{className:"flex-grow-1",children:f.data.activity_log_description.slice(0,u)}),h.jsx("a",{className:"btns d-flex align-items-center justify-content-center ms-2",role:"button",onClick:()=>a(!s),"data-bs-toggle":"collapse",href:`#collapseDescription${d}`,"aria-expanded":!s,"aria-controls":`collapseDescription${d}`,style:{height:"30px"},children:h.jsx("i",{className:`bi bi-caret-${s?"up-fill":"down-fill"}`,style:{transition:"transform 0.3s ease-in-out"}})})]}):(f==null?void 0:f.data.activity_log_description)||"Sin descripción.",h.jsx("div",{className:"collapse",id:`collapseDescription${d}`,children:f.data.activity_log_description.slice(u)})]}),h.jsx("td",{children:f==null?void 0:f.data.activity_log_GPS}),h.jsx("td",{children:f==null?void 0:f.data.activity_log_created_by}),h.jsx("td",{children:f==null?void 0:f.data.activity_log_file_description}),h.jsxs("td",{children:[h.jsx("button",{className:"btn btn-dark",onClick:()=>c(f.id),children:"VER"}),t&&n===f.id&&h.jsx(bP,{activityLogDocument:f,activityLogImage:f==null?void 0:f.data.activity_log_file_name,activityLogImageDescription:f==null?void 0:f.data.activity_log_file_description,closeModal:l})]})]},d)}):h.jsx("tr",{children:h.jsx("td",{colSpan:"4",children:"No hay historial de registros disponible."})})})]})})]})})}FP.propTypes={activityLogDocument:rt.array,documentId:rt.string};const NZ={informed_by:"Informado por",week_name:"Semana",team:"Empresa",current_status:"Estado Actual",equipo_o_sistema:"Equipo o Sistema",n_aviso:"Número de Aviso",u_tecnica:"Unidad Técnica",descripcion_del_trabajo:"Descripción del Trabajo",descripcion_del_aviso:"Descripción del Aviso",vulnerabilidad_1:"Vulnerabilidad",prioridad:"Prioridad"};function PP({activityHistoryLogDocument:e}){const t=e.sort((r,n)=>n.data.modified_at.toMillis()-r.data.modified_at.toMillis());return h.jsx(h.Fragment,{children:h.jsxs("div",{className:"mt-4",children:[h.jsx("h2",{children:"Historial de Modificaciones:"}),h.jsx("div",{className:"table-responsive",children:h.jsxs("table",{className:"table table-hover table-bordered",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"align-middle",children:[h.jsx("th",{children:"Fecha de creación"}),h.jsx("th",{children:"Campo modificado"}),h.jsx("th",{children:"Antes"}),h.jsx("th",{children:"Después"}),h.jsx("th",{children:"Descripción del cambio"}),h.jsx("th",{children:"Modificado por"})]})}),h.jsx("tbody",{children:t.length>=1?t.map((r,n)=>h.jsxs("tr",{children:[h.jsx("td",{children:r.data.modified_at.toDate().toLocaleString()}),h.jsx("td",{children:NZ[r.data.modified_field]||r.data.modified_field}),h.jsx("td",{children:r.data.old_value?r.data.old_value:"No hay datos."}),h.jsx("td",{children:r.data.new_value?r.data.new_value:"No hay datos."}),h.jsx("td",{children:r.data.modified_value_description?r.data.modified_value_description:"Sin descripción."}),h.jsx("td",{children:r.data.edited_by?r.data.edited_by:"Sin descripción."})]},n)):h.jsx("tr",{children:h.jsx("td",{colSpan:"4",children:"No hay historial de modificaciones disponible."})})})]})})]})})}PP.propTypes={activityHistoryLogDocument:rt.array};function DZ(){const{documentId:e}=ff(),[t,r]=F.useState({}),[n,i]=F.useState({}),[s,a]=F.useState({}),[o,c]=F.useState({}),[l,u]=F.useState({}),[f,d]=F.useState({}),[p,g]=F.useState(!0),m=ar();F.useEffect(()=>{(async()=>{try{const[x,y,w,T,S,E]=await Promise.all([W_(),E4(),_4(e),$B(e),w4(e),HB(e)]),k=x.find(j=>j.id===e),b=y.find(j=>j.id===(k==null?void 0:k.data.week_id));r(b),i(k),a(w),c(T),u(S),d(E),g(!1)}catch(x){console.error("Error al obtener documentos: ",x)}})()},[e]);const v=()=>{m("/home")};return h.jsxs(h.Fragment,{children:[h.jsx(qi,{}),h.jsxs("section",{id:"view-dossier",children:[h.jsx("div",{className:"container",children:p?h.jsx(Un,{}):h.jsxs(h.Fragment,{children:[h.jsx(CP,{documentId:e,isLoading:p,weekDocument:t,activityDocument:n}),h.jsx(IP,{isLoading:p,activityStatusDocument:s}),h.jsx(FP,{isLoading:p,activityLogDocument:o}),h.jsx(RP,{isLoading:p,activityPlanningDocument:l}),h.jsx(PP,{isLoading:p,activityHistoryLogDocument:f})]})}),h.jsx("div",{className:"d-flex justify-content-center mt-5",children:h.jsx(Mn,{text:"VOLVER",icon:"bi bi-arrow-return-left",marginClassName:"mb-5",btnClassName:"btn-link",onClick:v})})]})]})}function OZ(){const[e,t]=F.useState(!1),[r,n]=F.useState(!1),[i,s]=F.useState(!1),[a,o]=F.useState(!1),[c,l]=F.useState(""),[u,f]=F.useState(""),[d,p]=F.useState(""),[g,m]=F.useState(""),v=ar(),{control:_,reset:x,handleSubmit:y}=Ta({defaultValues:{week:"",informed_by:"",team:"",current_status:"",description:"",u_tecnica:"",equipo_o_sistema:"",descripcion_del_trabajo:"",descripcion_del_aviso:"",vulnerabilidad:""}});F.useEffect(()=>{w()||Ne.error("Speech recognition is not supported in this browser.")},[]);const w=()=>"SpeechRecognition"in window||"webkitSpeechRecognition"in window||"mozSpeechRecognition"in window||"msSpeechRecognition"in window,T=()=>{if(r)k();else try{const V=window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition,G=new V;G.continuous=!0,G.onresult=X=>{const Z=X.results[0][0].transcript;l(Z),k(),console.log(c)},G.start(),n(!0)}catch(V){console.error("Error starting speech recognition:",V),Ne.error(`Error starting speech recognition: ${V.message}`)}},S=()=>{if(i)k();else try{const V=window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition,G=new V;G.continuous=!0,G.onresult=X=>{const Z=X.results[0][0].transcript;f(Z),k(),console.log(u)},G.start(),s(!0)}catch(V){console.error("Error starting speech recognition:",V),Ne.error(`Error starting speech recognition: ${V.message}`)}},E=()=>{if(a)k();else try{const V=window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition,G=new V;G.continuous=!0,G.onresult=X=>{const Z=X.results[0][0].transcript;p(Z),k(),console.log(d)},G.start(),o(!0)}catch(V){console.error("Error starting speech recognition:",V),Ne.error(`Error starting speech recognition: ${V.message}`)}},k=()=>{n(!1),s(!1),o(!1)},b=i?h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"bi bi-mic-mute align-middle"})," DETENER GRABACIÓN POR VOZ"]}):h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"bi bi-mic align-middle"})," INICIAR GRABACIÓN POR VOZ"]}),j=r?h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"bi bi-mic-mute align-middle"})," DETENER GRABACIÓN POR VOZ"]}):h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"bi bi-mic align-middle"})," INICIAR GRABACIÓN POR VOZ"]}),H=a?h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"bi bi-mic-mute align-middle"})," DETENER GRABACIÓN POR VOZ"]}):h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"bi bi-mic align-middle"})," INICIAR GRABACIÓN POR VOZ"]}),O=async V=>{try{const G=localStorage.getItem("userEmail"),{week:X,informed_by:Z,team:ie,current_status:re,description:B,equipo_o_sistema:ae,descripcion_del_aviso:xe,descripcion_del_trabajo:I,vulnerabilidad:W}=V;if(!RX(X)){Ne.error("Por favor: completar semana en el formato correspondiente o dejar vacía, si corresponde.");return}t(!0);const U=await g4({created_at:new Date,created_by:G,file_name:"",team:ie,week_name:X||"N/A"});console.log(U.id);const ee={created_at:new Date,created_by:G,team:ie,informed_by:Z,current_status:re,equipo_o_sistema:ae,n_aviso:"",u_tecnica:g.value,descripcion_del_trabajo:I,descripcion_del_aviso:xe,vulnerabilidad_1:W,prioridad:"",week_id:U.id,week_name:X},oe=await v4(ee),me={created_at:new Date,created_by:G,informed_by:Z,activity:oe.id,status:re,description:B};await x4(me),t(!1),Ne.success("Priorización importada correctamente"),x({week:"",informed_by:"",team:"",current_status:"",description:"",u_tecnica:"",equipo_o_sistema:"",descripcion_del_trabajo:"",descripcion_del_aviso:"",vulnerabilidad:""}),setTimeout(()=>{v("/home")},2e3)}catch(G){console.error("Error:",G),Ne.error(`Ha ocurrido un error: ${G.message}`),t(!1)}};return h.jsx("form",{onSubmit:y(O),className:"container mt-5",children:h.jsx("div",{className:"d-flex justify-content-center",children:h.jsx("div",{className:"col-md-7",children:h.jsx("div",{className:"card",children:h.jsxs("div",{className:"card-body",children:[h.jsx("h2",{className:"text-center mb-4",children:"NUEVA ACTIVIDAD"}),h.jsx("h5",{children:"INFORMACIÓN GENERAL DE ACTIVIDAD"}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"week",children:"Semana:"}),h.jsx("p",{className:"text-muted",children:"(opcional)"}),h.jsx(Ve,{name:"week",control:_,render:({field:V})=>h.jsx("input",{...V,type:"text",id:"week",placeholder:"Ejemplo: 2023-37 (AAAA-SS)",className:"form-control mb-3"})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"informed_by",children:"Informado por:"}),h.jsx(Ve,{name:"informed_by",control:_,render:({field:V})=>h.jsx("input",{...V,type:"text",id:"informed_by",className:"form-control mb-3",placeholder:"Nombre + Apellido",required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"team",children:"Equipo:"}),h.jsx(Ve,{name:"team",control:_,rules:{required:"Debe seleccionar equipo"},render:({field:V})=>h.jsxs("select",{...V,className:"form-control mb-3",id:"team",children:[h.jsx("option",{value:"",defaultValue:!0,children:"Seleccione un equipo"}),h.jsx("option",{value:"impacto",children:"Impacto"}),h.jsx("option",{value:"impacto_acido",children:"Impacto Acido"})]})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"current_status",children:"Ingresar Estado:"}),h.jsx(Ve,{name:"current_status",control:_,rules:{required:"Debe seleccionar un estado inicial."},render:({field:V})=>h.jsxs("select",{...V,className:"form-control mb-3",id:"current_status",children:[h.jsx("option",{value:"",defaultValue:!0,children:"Seleccione un Estado"}),h.jsx("option",{value:"HALLAZGO",children:"Hallazgo"}),h.jsx("option",{value:"NO PROGRAMADA",children:"No programada"}),h.jsx("option",{value:"URGENCIA",children:"Urgencia"}),h.jsx("option",{value:"ACEPTADO",children:"Aceptado"}),h.jsx("option",{value:"RECHAZADO",children:"Rechazado"}),h.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),h.jsx("option",{value:"PROGRAMADO",children:"Programado"}),h.jsx("option",{value:"EJECUTADO",children:"Ejecutado"}),h.jsx("option",{value:"REPETIDO",children:"Repetido"}),h.jsx("option",{value:"OTRO",children:"Otro"})]})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"description",children:"Descripción del Estado:"}),h.jsx(Ve,{name:"description",control:_,defaultValue:"",render:({field:V})=>h.jsx("textarea",{...V,id:"description",className:"form-control",placeholder:"Ingrese descripción del estado.",required:!0,value:d,onChange:G=>{p(G.target.value),V.onChange(G)}})})]}),h.jsx("div",{className:"form-group",children:h.jsx("button",{type:"button",className:"btn btn-dark mt-2 mb-3",onClick:E,children:H})}),h.jsx("h5",{children:"DETALLES DE ACTIVIDAD"}),h.jsx("p",{className:"text-muted",children:"(opcional)"}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"u_tecnica",children:"Unidad Técnica:"}),h.jsx(SP,{isClearable:!0,isSearchable:!0,cacheOptions:!0,defaultOptions:!0,loadOptions:AP,value:g,placeholder:"Ej: COXI-LIX-LIS-LSR",onChange:V=>{m(V)}})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"equipo_o_sistema",children:"Equipo o Sistema:"}),h.jsx(Ve,{name:"equipo_o_sistema",control:_,render:({field:V})=>h.jsx("input",{...V,type:"text",id:"equipo_o_sistema",className:"form-control mb-3",placeholder:"Ej: LINEAS DE SOLUCIÓN DE REFINO"})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"descripcion_del_trabajo",children:"Descripción del Trabajo:"}),h.jsx(Ve,{name:"descripcion_del_trabajo",control:_,defaultValue:"",render:({field:V})=>h.jsx("textarea",{...V,id:"descripcion_del_trabajo",className:"form-control",placeholder:"Ingrese descripción del trabajo.",value:u,onChange:G=>{f(G.target.value),V.onChange(G)}})})]}),h.jsx("div",{className:"form-group",children:h.jsx("button",{type:"button",className:"btn btn-dark mt-2 mb-3",onClick:S,children:b})}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"descripcion_del_aviso",children:"Descripción del Aviso:"}),h.jsx(Ve,{name:"descripcion_del_aviso",control:_,defaultValue:"",render:({field:V})=>h.jsx("textarea",{...V,id:"descripcion_del_aviso",className:"form-control",placeholder:"Ingrese descripción del aviso.",value:c,onChange:G=>{l(G.target.value),V.onChange(G)}})})]}),h.jsx("div",{className:"form-group",children:h.jsx("button",{type:"button",className:"btn btn-dark mt-2 mb-3",onClick:T,children:j})}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"vulnerabilidad",children:"Vulnerabilidad:"}),h.jsx(Ve,{name:"vulnerabilidad",control:_,render:({field:V})=>h.jsx("input",{...V,type:"text",id:"vulnerabilidad",className:"form-control mb-3",placeholder:"Ej: HDPE"})})]}),h.jsxs("div",{className:"form-group d-flex text-center justify-content-center",children:[h.jsx("button",{type:"submit",className:"btn btn-dark btn-block text-center mt-3",disabled:e,children:e?h.jsx(Un,{}):"CREAR ACTIVIDAD"}),h.jsx(pa,{class:"custom-toast",position:"top-right",autoClose:3e3,hideProgressBar:!0})]})]})})})})})}function LZ(){const e=ar(),t=()=>{e("/home")};return h.jsxs(h.Fragment,{children:[h.jsx(qi,{}),h.jsxs("section",{id:"create-activity",children:[h.jsx("div",{className:"container"}),h.jsx(OZ,{}),h.jsx("div",{className:"d-flex justify-content-center mt-5",children:h.jsx(Mn,{text:"VOLVER",icon:"bi bi-arrow-return-left",marginClassName:"mb-5",btnClassName:"btn-link",onClick:t})})]})]})}function NP({documentId:e}){const[t,r]=F.useState(!1),[n,i]=F.useState(!1),[s,a]=F.useState(""),[o,c]=F.useState({}),l=ar(),{control:u,reset:f,handleSubmit:d}=Ta({defaultValues:{OT:"",program_start:"",real_program_start:"",program_end:"",real_program_end:"",program_duration:"",real_program_duration:"",program_scope:"",real_program_scope:"",detailed_activity_description:"",relevant_technical_specifications:"",general_step_by_step:"",required_material:"",required_support_equipment:"",technical_standard:"",work_procedure:"",risks_and_controls:"",risk_analysis:""}});F.useEffect(()=>{p()||Ne.error("Speech recognition is not supported in this browser.")},[]);const p=()=>"SpeechRecognition"in window||"webkitSpeechRecognition"in window||"mozSpeechRecognition"in window||"msSpeechRecognition"in window,g=()=>{if(n)m();else try{const x=window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition,y=new x;y.continuous=!0,y.onresult=w=>{const T=w.results[0][0].transcript;a(T),m()},y.start(),i(!0)}catch(x){console.error("Error starting speech recognition:",x),Ne.error(`Error starting speech recognition: ${x.message}`)}},m=()=>{i(!1)},v=n?h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"bi bi-mic-mute align-middle"})," DETENER GRABACIÓN POR VOZ"]}):h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"bi bi-mic align-middle"})," INICIAR GRABACIÓN POR VOZ"]});F.useEffect(()=>{(async()=>{try{const y=await E4(),T=(await W_()).find(E=>E.id===e),S=y.find(E=>E.id===(T==null?void 0:T.data.week_id));if(S){const E=S.data;console.log("Datos del documento:",E),c(E)}else return console.log("El documento no existe."),null}catch(y){throw console.error("Error al obtener la información del documento:",y),y}})()},[e]);const _=async x=>{try{const y=localStorage.getItem("userEmail"),{OT:w,program_start:T,real_program_start:S,program_end:E,real_program_end:k,program_duration:b,real_program_duration:j,program_scope:H,real_program_scope:O,detailed_activity_description:V,relevant_technical_specifications:G,general_step_by_step:X,required_material:Z,required_support_equipment:ie,technical_standard:re,work_procedure:B,risks_and_controls:ae,risk_analysis:xe}=x;r(!0),NB({created_at:new Date,created_by:y,activity:e,OT:w,program_start:T,real_program_start:S,program_end:E,real_program_end:k,program_duration:b,real_program_duration:j,program_scope:H,real_program_scope:O,detailed_activity_description:V,relevant_technical_specifications:G,general_step_by_step:X,required_material:Z,required_support_equipment:ie,technical_standard:re,work_procedure:B,risks_and_controls:ae,risk_analysis:xe}),r(!1),Ne.success("Actividad planificada exitosamente."),f({OT:"",program_start:"",real_program_start:"",program_end:"",real_program_end:"",program_duration:"",real_program_duration:"",program_scope:"",real_program_scope:"",detailed_activity_description:"",relevant_technical_specifications:"",general_step_by_step:"",required_material:"",required_support_equipment:"",technical_standard:"",work_procedure:"",risks_and_controls:"",risk_analysis:""}),setTimeout(()=>{l("/home")},2e3)}catch(y){console.error("Error:",y),Ne.error(`Ha ocurrido un error: ${y.message}`),r(!1)}};return h.jsx("form",{onSubmit:d(_),className:"container mt-5",children:h.jsx("div",{className:"d-flex justify-content-center",children:h.jsx("div",{className:"col-md-7",children:h.jsx("div",{className:"card",children:h.jsxs("div",{className:"card-body",children:[h.jsx("h2",{className:"text-center mb-4",children:"PLANIFICAR ACTIVIDAD"}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"week",children:"Semana:"}),h.jsx(Ve,{name:"week",control:u,render:({field:x})=>h.jsx("input",{...x,type:"text",id:"week",placeholder:o.week_name,className:"form-control mb-3",disabled:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"team",children:"Empresa:"}),h.jsx(Ve,{name:"team",control:u,render:({field:x})=>h.jsx("input",{...x,type:"text",id:"team",placeholder:(o==null?void 0:o.team)==="impacto_acido"?"Impacto Ácido":(o==null?void 0:o.team)==="impacto"?"Impacto":o==null?void 0:o.team,className:"form-control mb-3",disabled:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"OT",children:"OT:"}),h.jsx(Ve,{name:"OT",control:u,render:({field:x})=>h.jsx("input",{...x,type:"text",id:"OT",placeholder:"12345",className:"form-control mb-3",required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"program_start",children:"Inicio de Programa:"}),h.jsx(Ve,{name:"program_start",control:u,render:({field:x})=>h.jsx("input",{...x,type:"text",id:"program_start",placeholder:"01/01/2000",className:"form-control mb-3",required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"real_program_start",children:"Inicio Real:"}),h.jsx(Ve,{name:"real_program_start",control:u,render:({field:x})=>h.jsx("input",{...x,type:"text",id:"real_program_start",placeholder:"01/02/2000",className:"form-control mb-3",required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"program_end",children:"Fin Programa:"}),h.jsx(Ve,{name:"program_end",control:u,render:({field:x})=>h.jsx("input",{...x,type:"text",id:"program_end",placeholder:"01/01/2000",className:"form-control mb-3",required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"real_program_end",children:"Fin Real:"}),h.jsx(Ve,{name:"real_program_end",control:u,render:({field:x})=>h.jsx("input",{...x,type:"text",id:"real_program_end",placeholder:"01/02/2000",className:"form-control mb-3",required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"program_duration",children:"Duración del Programa:"}),h.jsx(Ve,{name:"program_duration",control:u,render:({field:x})=>h.jsx("input",{...x,type:"text",id:"program_duration",placeholder:"3 semanas.",className:"form-control mb-3",required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"real_program_duration",children:" Duración real:"}),h.jsx(Ve,{name:"real_program_duration",control:u,render:({field:x})=>h.jsx("input",{...x,type:"text",id:"real_program_duration",placeholder:"6 semanas.",className:"form-control mb-3",required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"program_scope",children:"Alcances Programa:"}),h.jsx(Ve,{name:"program_scope",control:u,render:({field:x})=>h.jsx("input",{...x,type:"text",id:"program_scope",placeholder:"Detallar alcance por carta Gantt.",className:"form-control mb-3",required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"real_program_scope",children:"Alcance Real:"}),h.jsx(Ve,{name:"real_program_scope",control:u,render:({field:x})=>h.jsx("textarea",{...x,type:"text",id:"real_program_scope",placeholder:"Detallar si alcance programado correspondía al alcance real de las actividades a realizar. Indicar si hubo cambio de alcance por definición de terreno, declarar detalle de cambio alcance y justificación técnica.",className:"form-control mb-3",rows:4,required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"detailed_activity_description",children:"Descripción detallada de la actividad:"}),h.jsx(Ve,{name:"detailed_activity_description",control:u,defaultValue:"",render:({field:x})=>h.jsx("textarea",{...x,id:"detailed_activity_description",className:"form-control",placeholder:"Ingrese descripción del estado.",required:!0,value:s,onChange:y=>{a(y.target.value),x.onChange(y)}})})]}),h.jsx("div",{className:"form-group",children:h.jsx("button",{type:"button",className:"btn btn-dark mt-2 mb-3",onClick:g,children:v})}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"relevant_technical_specifications",children:"Especificaciones técnicas relevantes:"}),h.jsx(Ve,{name:"relevant_technical_specifications",control:u,render:({field:x})=>h.jsx("textarea",{...x,type:"text",id:"relevant_technical_specifications",placeholder:`Equipo a intervenir, características técnicas, parámetros relevantes, mediciones y referencias, presiones, torques, voltajes, corrientes, flujos, tipo de pernos, tipos de soldadura, juegos, interferencias, rodamientos, motor, reductor, etc.\r
                                            `,className:"form-control mb-3",rows:4,required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"general_step_by_step",children:"Paso a paso general:"}),h.jsx(Ve,{name:"general_step_by_step",control:u,render:({field:x})=>h.jsx("textarea",{...x,type:"text",id:"general_step_by_step",placeholder:"",className:"form-control mb-3",rows:4,required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"required_material",children:"Materiales e insumos requeridos:"}),h.jsx(Ve,{name:"required_material",control:u,render:({field:x})=>h.jsx("textarea",{...x,type:"text",id:"required_material",placeholder:"Tipos y cantidad de aceite, dieléctrico, grasas, pernos, cables, sensores, rodamientos, etc.",className:"form-control mb-3",rows:4,required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"required_support_equipment",children:"Equipos de apoyo requeridos:"}),h.jsx(Ve,{name:"required_support_equipment",control:u,render:({field:x})=>h.jsx("textarea",{...x,type:"text",id:"required_support_equipment",placeholder:"Si necesito equipos de apoyo, grúa, camión pluma, camión grúa, alza hombre, andamios, camión, instrumentos especiales, requiere equipos/herramientas específicos, otros.",className:"form-control mb-3",rows:4,required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"technical_standard",children:"Estándar técnico:"}),h.jsx(Ve,{name:"technical_standard",control:u,render:({field:x})=>h.jsx("input",{...x,type:"text",id:"technical_standard",placeholder:"Procedimiento y estándar utilizados, etc.",className:"form-control mb-3",required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"work_procedure",children:"Procedimiento de trabajo:"}),h.jsx(Ve,{name:"work_procedure",control:u,render:({field:x})=>h.jsx("input",{...x,type:"text",id:"work_procedure",placeholder:"Procedimiento de trabajo utilizados, etc.",className:"form-control mb-3",required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"risks_and_controls",children:"Riesgos críticos y controles aplicados:"}),h.jsx(Ve,{name:"risks_and_controls",control:u,render:({field:x})=>h.jsx("input",{...x,type:"text",id:"risks_and_controls",placeholder:"RC1, RC4, control preventivo CCP1, control mitigador CCM1, etc.",className:"form-control mb-3",required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"risk_analysis",children:"Análisis de riesgos (¿Qué pasa sí?):"}),h.jsx(Ve,{name:"risk_analysis",control:u,render:({field:x})=>h.jsx("textarea",{...x,type:"text",id:"risk_analysis",placeholder:"Indicar la existencia de riesgos (no solo de seguridad, sino también de recursos o hallazgos de terreno) que pudieron amenazar o que amenazaron la actividad y tuvimos que resolver y/o tomar una decisión in situ o de ultima hora para corregir una desviación",className:"form-control mb-3",rows:4,required:!0})})]}),h.jsxs("div",{className:"form-group d-flex text-center justify-content-center",children:[h.jsx("button",{type:"submit",className:"btn btn-dark btn-block text-center mt-3",disabled:t,children:t?h.jsx(Un,{}):"PLANIFICAR ACTIVIDAD"}),h.jsx(pa,{class:"custom-toast",position:"top-right",autoClose:3e3,hideProgressBar:!0})]})]})})})})})}NP.propTypes={documentId:rt.string};function MZ(){const{documentId:e}=ff(),t=ar(),r=()=>{t("/home")};return h.jsxs(h.Fragment,{children:[h.jsx(qi,{}),h.jsx(NP,{documentId:e}),h.jsx("div",{className:"d-flex justify-content-center mt-5",children:h.jsx(Mn,{text:"VOLVER",icon:"bi bi-arrow-return-left",marginClassName:"mb-5",btnClassName:"btn-link",onClick:r})})]})}function VZ({activityPlanningDocument:e,isLoading:t}){console.log(e);const r=e&&e.length>0?e[0].data:{};return h.jsx(h.Fragment,{children:e&&Object.keys(e).length!==0?t?h.jsx(Un,{}):h.jsx("div",{className:"table-responsive",children:h.jsx("table",{className:"table table-hover table-bordered",children:h.jsxs("tbody",{children:[h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"N° OT"}),h.jsx("td",{colSpan:3,children:r.OT})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Inicio programa"}),h.jsx("td",{children:r.program_start}),h.jsx("th",{scope:"row",children:"Inicio real"}),h.jsx("td",{children:r.real_program_start})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Fin programa"}),h.jsx("td",{children:r.program_end}),h.jsx("th",{scope:"row",children:"Fin real"}),h.jsx("td",{children:r.real_program_end})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Duración programa"}),h.jsx("td",{children:r.program_duration}),h.jsx("th",{scope:"row",children:"Duración real"}),h.jsx("td",{children:r.real_program_duration})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Alcances programa"}),h.jsx("td",{children:r.program_scope}),h.jsx("th",{scope:"row",children:"Alcance real"}),h.jsx("td",{children:r.real_program_scope})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Descripción detallada de la actividad"}),h.jsx("td",{colSpan:3,children:r.detailed_activity_description})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Especificaciones técnicas relevantes"}),h.jsx("td",{colSpan:3,children:r.relevant_technical_specifications})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Paso a paso general"}),h.jsx("td",{colSpan:3,children:r.general_step_by_step})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Materiales e insumos requeridos"}),h.jsx("td",{colSpan:3,children:r.required_material})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Equipos de apoyo requeridos"}),h.jsx("td",{colSpan:3,children:r.required_support_equipment})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Estándar técnico"}),h.jsx("td",{colSpan:3,children:r.technical_standard})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Procedimiento de trabajo"}),h.jsx("td",{colSpan:3,children:r.work_procedure})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Riesgos críticos y controles aplicados"}),h.jsx("td",{colSpan:3,children:r.risks_and_controls})]}),h.jsxs("tr",{children:[h.jsx("th",{scope:"row",children:"Analálisis de riesgos (¿Qué pasa sí?)"}),h.jsx("td",{colSpan:3,children:r.risk_analysis})]})]})})}):h.jsxs("div",{className:"table-responsive",children:[h.jsx("h1",{className:"my-2 text-center mt-3 mb-3",children:"Planificación de la Actividad"}),h.jsx("table",{className:"table table-hover table-bordered"}),h.jsx("p",{children:"Sin planificaciones disponibles"})]})})}function jZ(){const{documentId:e}=ff(),[t,r]=F.useState({}),[n,i]=F.useState(!0),s=ar(),a=()=>{s("/home")};return F.useEffect(()=>{(async()=>{try{const c=await w4(e);r(c),i(!1)}catch(c){console.error("Error fetching activity planning documents:",c),i(!1)}})()},[e]),h.jsxs(h.Fragment,{children:[h.jsx(qi,{}),h.jsxs("div",{className:"container-fluid",children:[h.jsx("div",{className:"row",children:h.jsx("div",{className:"col-12",children:h.jsx("h1",{className:"text-center mt-3",children:"DOSSIER DE ACTIVIDAD"})})}),h.jsx(VZ,{activityPlanningDocument:t,isLoading:n}),h.jsx("div",{className:"d-flex justify-content-center mt-5",children:h.jsx(Mn,{text:"VOLVER",icon:"bi bi-arrow-return-left",marginClassName:"mb-5",btnClassName:"btn-link",onClick:a})})]})]})}function DP({filters:e}){const[t,r]=F.useState([]),[n,i]=F.useState(1),[s,a]=F.useState(!0),o=20,c=d=>{d>0&&d<=u&&i(d)};F.useEffect(()=>{Object.values(e).some(d=>d!=="")&&i(1)},[e]),F.useEffect(()=>{(async()=>{try{const p=(n-1)*o,m=(await MB({limit:o,offset:p})).map(v=>({id:v.id,...v.data}));r(m),a(!1)}catch(p){console.error("Error al obtener documentos: ",p)}})()},[n,o,e]);const l=t.filter(d=>Object.keys(e).every(p=>{const g=ec(e[p]).toLowerCase(),m=ec(d[p]).toLowerCase();return!(g&&!m.includes(g))})),u=Math.ceil(l.length/o),f=l.slice((n-1)*o,n*o);return h.jsxs(h.Fragment,{children:[s?h.jsx(Un,{}):h.jsx("div",{className:"table-responsive-xxl",children:h.jsxs("table",{className:"table table-hover",children:[h.jsx("thead",{className:"table-secondary",children:h.jsxs("tr",{className:"align-middle",children:[h.jsx("th",{scope:"col",children:"N°"}),h.jsx("th",{scope:"col",children:"Nombre"}),h.jsx("th",{scope:"col",children:"Correo Electrónico"}),h.jsx("th",{scope:"col",children:"Rol"}),h.jsx("th",{scope:"col",colSpan:"2",className:"text-center",children:"Acciones"})]})}),h.jsx("tbody",{children:f.map((d,p)=>{const g=(n-1)*o+p+1;return h.jsxs("tr",{children:[h.jsx("td",{children:g}),h.jsx("td",{children:d.name||"N/A"}),h.jsx("td",{children:d.email||"N/A"}),h.jsx("td",{children:d.role||"N/A"}),h.jsx("td",{children:h.jsx(Pa,{to:`/update-activity-status/${d.id}`,children:h.jsx("i",{className:"bi bi-pencil-square"})})}),h.jsx("td",{children:h.jsx(Pa,{to:`/upload-activity-log/${d.id}`,children:h.jsx("i",{className:"bi bi-trash"})})})]},p)})})]})}),h.jsx(Y_,{currentPage:n,totalPages:u,handlePageChange:c})]})}DP.propTypes={filters:rt.object};function OP({handleFilterChange:e}){return h.jsx(h.Fragment,{children:h.jsxs("form",{className:"row gx-3 gy-1 align-items-center",children:[h.jsxs("div",{className:"col-sm-2",children:[h.jsx("label",{className:"visually-hidden",htmlFor:"name",children:"Nombre"}),h.jsx("input",{type:"text",className:"form-control",id:"name",placeholder:"Nombre",onChange:t=>e("name",t.target.value)})]}),h.jsxs("div",{className:"col-sm-2",children:[h.jsx("label",{className:"visually-hidden",htmlFor:"email",children:"Correo electrónico"}),h.jsx("input",{type:"text",className:"form-control",id:"email",placeholder:"Correo electrónico",onChange:t=>e("email",t.target.value)})]}),h.jsxs("div",{className:"col-sm-2",children:[h.jsx("label",{className:"visually-hidden",htmlFor:"role",children:"Rol"}),h.jsx("input",{type:"text",className:"form-control",id:"role",placeholder:"Rol",onChange:t=>e("role",t.target.value)})]})]})})}OP.propTypes={handleFilterChange:rt.func.isRequired};function BZ(){const e=ar(),[t,r]=F.useState({user:"",email:"",role:""}),n=(a,o)=>{r({...t,[a]:o})},i=()=>{e("/create-user")},s=()=>{e("/home")};return h.jsxs(h.Fragment,{children:[h.jsx(qi,{}),h.jsxs("section",{id:"admin",children:[h.jsx("h1",{className:"my-2 text-center mt-3",children:"ADMINISTRACIÓN DE USUARIOS"}),h.jsxs("div",{className:"container",children:[h.jsx(Mn,{text:"CREAR USUARIO",icon:"bi bi-plus-circle",btnClassName:"btn-dark mb-3",onClick:i}),h.jsxs("div",{className:"row mb-3",children:[h.jsx("div",{className:"col mb-3",children:h.jsx(OP,{filters:t,handleFilterChange:n})}),h.jsx(DP,{filters:t})]}),h.jsx("div",{className:"d-flex justify-content-center mt-5",children:h.jsx(Mn,{text:"VOLVER",icon:"bi bi-arrow-return-left",marginClassName:"mb-5",btnClassName:"btn-link",onClick:s})})]})]})]})}function UZ(){const e=ar(),{control:t,handleSubmit:r,reset:n}=Ta({defaultValues:{user:"",password:""}}),i=async a=>{const{name:o,email:c,password:l,role:u}=a,f=localStorage.getItem("userEmail"),p=(await RB(c,l)).uid;await PB({name:o,email:c,role:u,userId:p,created_at:new Date,created_by:f})},s=()=>{e("/admin")};return h.jsxs(h.Fragment,{children:[h.jsx(qi,{}),h.jsx("section",{id:"admin",children:h.jsx("div",{className:"d-flex justify-content-center mt-5",children:h.jsxs("div",{className:"col-md-7",children:[h.jsx("div",{className:"card",children:h.jsxs("div",{className:"card-body",children:[h.jsx("h2",{className:"my-2 text-center mt-3",children:"CREAR USUARIO"}),h.jsxs("form",{onSubmit:r(i),className:"container mt-5",children:[h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"user",children:"Nombre de usuario:"}),h.jsx(Ve,{name:"name",control:t,render:({field:a})=>h.jsx("input",{...a,type:"text",id:"name",placeholder:"Nombre + Apellido",className:"form-control mb-3",required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"email",children:"Nombre de usuario:"}),h.jsx(Ve,{name:"email",control:t,render:({field:a})=>h.jsx("input",{...a,type:"email",id:"email",placeholder:"correo electrónico",className:"form-control mb-3",required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"password",children:"Contraseña:"}),h.jsx(Ve,{name:"password",control:t,render:({field:a})=>h.jsx("input",{...a,type:"password",id:"password",placeholder:"usuario",className:"form-control mb-3",required:!0})})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"role",children:"Rol:"}),h.jsx(Ve,{name:"role",control:t,render:({field:a})=>h.jsxs("select",{...a,className:"form-control mb-3",id:"role",children:[h.jsx("option",{value:"",defaultValue:!0,children:"Seleccione un Rol"}),h.jsx("option",{value:"admin",children:"Administrador"}),h.jsx("option",{value:"user",children:"Usuario"})]})})]}),h.jsx("div",{className:"form-group d-flex text-center justify-content-center",children:h.jsx("button",{type:"submit",className:"btn btn-dark",children:"CREAR USUARIO"})})]})]})}),h.jsx("div",{className:"d-flex justify-content-center mt-5",children:h.jsx(Mn,{text:"VOLVER",icon:"bi bi-arrow-return-left",marginClassName:"mb-5",btnClassName:"btn-link",onClick:s})})]})})})]})}const $Z=bk(document.getElementById("root"));function Ti({element:e}){return m4()?e:h.jsx(E1,{to:"/login",replace:!0})}$Z.render(h.jsx(ke.StrictMode,{children:h.jsx(m3,{children:h.jsxs(l3,{children:[h.jsx(Sn,{path:"/",element:m4()?h.jsx(E1,{to:"/home",replace:!0}):h.jsx(E1,{to:"/login"})}),h.jsx(Sn,{path:"/home",element:h.jsx(Ti,{element:h.jsx(_7,{})})}),h.jsx(Sn,{path:"/upload-activities",element:h.jsx(Ti,{element:h.jsx(FX,{})})}),h.jsx(Sn,{path:"/create-activity",element:h.jsx(Ti,{element:h.jsx(LZ,{})})}),h.jsx(Sn,{path:"/update-activity-status/:documentId",element:h.jsx(Ti,{element:h.jsx(PX,{})})}),h.jsx(Sn,{path:"/upload-activity-log/:documentId",element:h.jsx(Ti,{element:h.jsx(OX,{})})}),h.jsx(Sn,{path:"/activity-planning/:documentId",element:h.jsx(Ti,{element:h.jsx(MZ,{})})}),h.jsx(Sn,{path:"/view-activity-info/:documentId",element:h.jsx(Ti,{element:h.jsx(DZ,{})})}),h.jsx(Sn,{path:"/view-activity-dossier/:documentId",element:h.jsx(Ti,{element:h.jsx(jZ,{})})}),h.jsx(Sn,{path:"/admin",element:h.jsx(Ti,{element:h.jsx(BZ,{})})}),h.jsx(Sn,{path:"/create-user",element:h.jsx(Ti,{element:h.jsx(UZ,{})})}),h.jsx(Sn,{path:"/login",element:h.jsx(h7,{})})]})})}));
