function P4(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function tT(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var rT={exports:{}},I0={},nT={exports:{}},He={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yu=Symbol.for("react.element"),F4=Symbol.for("react.portal"),N4=Symbol.for("react.fragment"),D4=Symbol.for("react.strict_mode"),O4=Symbol.for("react.profiler"),L4=Symbol.for("react.provider"),b4=Symbol.for("react.context"),M4=Symbol.for("react.forward_ref"),V4=Symbol.for("react.suspense"),U4=Symbol.for("react.memo"),B4=Symbol.for("react.lazy"),Z_=Symbol.iterator;function j4(e){return e===null||typeof e!="object"?null:(e=Z_&&e[Z_]||e["@@iterator"],typeof e=="function"?e:null)}var iT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sT=Object.assign,aT={};function tl(e,t,r){this.props=e,this.context=t,this.refs=aT,this.updater=r||iT}tl.prototype.isReactComponent={};tl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};tl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function oT(){}oT.prototype=tl.prototype;function qg(e,t,r){this.props=e,this.context=t,this.refs=aT,this.updater=r||iT}var Xg=qg.prototype=new oT;Xg.constructor=qg;sT(Xg,tl.prototype);Xg.isPureReactComponent=!0;var ex=Array.isArray,lT=Object.prototype.hasOwnProperty,Yg={current:null},cT={key:!0,ref:!0,__self:!0,__source:!0};function uT(e,t,r){var n,i={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)lT.call(t,n)&&!cT.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:yu,type:e,key:s,ref:a,props:i,_owner:Yg.current}}function $4(e,t){return{$$typeof:yu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Qg(e){return typeof e=="object"&&e!==null&&e.$$typeof===yu}function H4(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var tx=/\/+/g;function Ud(e,t){return typeof e=="object"&&e!==null&&e.key!=null?H4(""+e.key):t.toString(36)}function Wf(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case yu:case F4:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+Ud(a,0):n,ex(i)?(r="",e!=null&&(r=e.replace(tx,"$&/")+"/"),Wf(i,t,r,"",function(c){return c})):i!=null&&(Qg(i)&&(i=$4(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(tx,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",ex(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+Ud(s,o);a+=Wf(s,t,r,l,i)}else if(l=j4(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+Ud(s,o++),a+=Wf(s,t,r,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function nf(e,t,r){if(e==null)return e;var n=[],i=0;return Wf(e,n,"","",function(s){return t.call(r,s,i++)}),n}function z4(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Xr={current:null},Gf={transition:null},W4={ReactCurrentDispatcher:Xr,ReactCurrentBatchConfig:Gf,ReactCurrentOwner:Yg};He.Children={map:nf,forEach:function(e,t,r){nf(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return nf(e,function(){t++}),t},toArray:function(e){return nf(e,function(t){return t})||[]},only:function(e){if(!Qg(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};He.Component=tl;He.Fragment=N4;He.Profiler=O4;He.PureComponent=qg;He.StrictMode=D4;He.Suspense=V4;He.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W4;He.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=sT({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=Yg.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)lT.call(t,l)&&!cT.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:yu,type:e.type,key:i,ref:s,props:n,_owner:a}};He.createContext=function(e){return e={$$typeof:b4,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:L4,_context:e},e.Consumer=e};He.createElement=uT;He.createFactory=function(e){var t=uT.bind(null,e);return t.type=e,t};He.createRef=function(){return{current:null}};He.forwardRef=function(e){return{$$typeof:M4,render:e}};He.isValidElement=Qg;He.lazy=function(e){return{$$typeof:B4,_payload:{_status:-1,_result:e},_init:z4}};He.memo=function(e,t){return{$$typeof:U4,type:e,compare:t===void 0?null:t}};He.startTransition=function(e){var t=Gf.transition;Gf.transition={};try{e()}finally{Gf.transition=t}};He.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};He.useCallback=function(e,t){return Xr.current.useCallback(e,t)};He.useContext=function(e){return Xr.current.useContext(e)};He.useDebugValue=function(){};He.useDeferredValue=function(e){return Xr.current.useDeferredValue(e)};He.useEffect=function(e,t){return Xr.current.useEffect(e,t)};He.useId=function(){return Xr.current.useId()};He.useImperativeHandle=function(e,t,r){return Xr.current.useImperativeHandle(e,t,r)};He.useInsertionEffect=function(e,t){return Xr.current.useInsertionEffect(e,t)};He.useLayoutEffect=function(e,t){return Xr.current.useLayoutEffect(e,t)};He.useMemo=function(e,t){return Xr.current.useMemo(e,t)};He.useReducer=function(e,t,r){return Xr.current.useReducer(e,t,r)};He.useRef=function(e){return Xr.current.useRef(e)};He.useState=function(e){return Xr.current.useState(e)};He.useSyncExternalStore=function(e,t,r){return Xr.current.useSyncExternalStore(e,t,r)};He.useTransition=function(){return Xr.current.useTransition()};He.version="18.2.0";nT.exports=He;var Y=nT.exports;const Se=tT(Y),G4=P4({__proto__:null,default:Se},[Y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K4=Y,q4=Symbol.for("react.element"),X4=Symbol.for("react.fragment"),Y4=Object.prototype.hasOwnProperty,Q4=K4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,J4={key:!0,ref:!0,__self:!0,__source:!0};function fT(e,t,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)Y4.call(t,n)&&!J4.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:q4,type:e,key:s,ref:a,props:i,_owner:Q4.current}}I0.Fragment=X4;I0.jsx=fT;I0.jsxs=fT;rT.exports=I0;var y=rT.exports,hT={exports:{}},yn={},dT={exports:{}},pT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(te,V){var ce=te.length;te.push(V);e:for(;0<ce;){var Ee=ce-1>>>1,N=te[Ee];if(0<i(N,V))te[Ee]=V,te[ce]=N,ce=Ee;else break e}}function r(te){return te.length===0?null:te[0]}function n(te){if(te.length===0)return null;var V=te[0],ce=te.pop();if(ce!==V){te[0]=ce;e:for(var Ee=0,N=te.length,z=N>>>1;Ee<z;){var B=2*(Ee+1)-1,U=te[B],Z=B+1,de=te[Z];if(0>i(U,ce))Z<N&&0>i(de,U)?(te[Ee]=de,te[Z]=ce,Ee=Z):(te[Ee]=U,te[B]=ce,Ee=B);else if(Z<N&&0>i(de,ce))te[Ee]=de,te[Z]=ce,Ee=Z;else break e}}return V}function i(te,V){var ce=te.sortIndex-V.sortIndex;return ce!==0?ce:te.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,f=null,h=3,d=!1,m=!1,p=!1,g=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(te){for(var V=r(c);V!==null;){if(V.callback===null)n(c);else if(V.startTime<=te)n(c),V.sortIndex=V.expirationTime,t(l,V);else break;V=r(c)}}function T(te){if(p=!1,v(te),!m)if(r(l)!==null)m=!0,se(k);else{var V=r(c);V!==null&&ue(T,V.startTime-te)}}function k(te,V){m=!1,p&&(p=!1,x(F),F=-1),d=!0;var ce=h;try{for(v(V),f=r(l);f!==null&&(!(f.expirationTime>V)||te&&!j());){var Ee=f.callback;if(typeof Ee=="function"){f.callback=null,h=f.priorityLevel;var N=Ee(f.expirationTime<=V);V=e.unstable_now(),typeof N=="function"?f.callback=N:f===r(l)&&n(l),v(V)}else n(l);f=r(l)}if(f!==null)var z=!0;else{var B=r(c);B!==null&&ue(T,B.startTime-V),z=!1}return z}finally{f=null,h=ce,d=!1}}var A=!1,E=null,F=-1,O=5,M=-1;function j(){return!(e.unstable_now()-M<O)}function b(){if(E!==null){var te=e.unstable_now();M=te;var V=!0;try{V=E(!0,te)}finally{V?X():(A=!1,E=null)}}else A=!1}var X;if(typeof _=="function")X=function(){_(b)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,re=ne.port2;ne.port1.onmessage=b,X=function(){re.postMessage(null)}}else X=function(){g(b,0)};function se(te){E=te,A||(A=!0,X())}function ue(te,V){F=g(function(){te(e.unstable_now())},V)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(te){te.callback=null},e.unstable_continueExecution=function(){m||d||(m=!0,se(k))},e.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<te?Math.floor(1e3/te):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(te){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var ce=h;h=V;try{return te()}finally{h=ce}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(te,V){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var ce=h;h=te;try{return V()}finally{h=ce}},e.unstable_scheduleCallback=function(te,V,ce){var Ee=e.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?Ee+ce:Ee):ce=Ee,te){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=ce+N,te={id:u++,callback:V,priorityLevel:te,startTime:ce,expirationTime:N,sortIndex:-1},ce>Ee?(te.sortIndex=ce,t(c,te),r(l)===null&&te===r(c)&&(p?(x(F),F=-1):p=!0,ue(T,ce-Ee))):(te.sortIndex=N,t(l,te),m||d||(m=!0,se(k))),te},e.unstable_shouldYield=j,e.unstable_wrapCallback=function(te){var V=h;return function(){var ce=h;h=V;try{return te.apply(this,arguments)}finally{h=ce}}}})(pT);dT.exports=pT;var Z4=dT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mT=Y,vn=Z4;function le(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var gT=new Set,Cc={};function Va(e,t){Mo(e,t),Mo(e+"Capture",t)}function Mo(e,t){for(Cc[e]=t,e=0;e<t.length;e++)gT.add(t[e])}var Vi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),am=Object.prototype.hasOwnProperty,eP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,rx={},nx={};function tP(e){return am.call(nx,e)?!0:am.call(rx,e)?!1:eP.test(e)?nx[e]=!0:(rx[e]=!0,!1)}function rP(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function nP(e,t,r,n){if(t===null||typeof t>"u"||rP(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Yr(e,t,r,n,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var gr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){gr[e]=new Yr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];gr[t]=new Yr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){gr[e]=new Yr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){gr[e]=new Yr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){gr[e]=new Yr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){gr[e]=new Yr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){gr[e]=new Yr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){gr[e]=new Yr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){gr[e]=new Yr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Jg=/[\-:]([a-z])/g;function Zg(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Jg,Zg);gr[t]=new Yr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Jg,Zg);gr[t]=new Yr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Jg,Zg);gr[t]=new Yr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){gr[e]=new Yr(e,1,!1,e.toLowerCase(),null,!1,!1)});gr.xlinkHref=new Yr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){gr[e]=new Yr(e,1,!1,e.toLowerCase(),null,!0,!0)});function e1(e,t,r,n){var i=gr.hasOwnProperty(t)?gr[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(nP(t,r,i,n)&&(r=null),n||i===null?tP(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ki=mT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,sf=Symbol.for("react.element"),ao=Symbol.for("react.portal"),oo=Symbol.for("react.fragment"),t1=Symbol.for("react.strict_mode"),om=Symbol.for("react.profiler"),vT=Symbol.for("react.provider"),_T=Symbol.for("react.context"),r1=Symbol.for("react.forward_ref"),lm=Symbol.for("react.suspense"),cm=Symbol.for("react.suspense_list"),n1=Symbol.for("react.memo"),rs=Symbol.for("react.lazy"),xT=Symbol.for("react.offscreen"),ix=Symbol.iterator;function Al(e){return e===null||typeof e!="object"?null:(e=ix&&e[ix]||e["@@iterator"],typeof e=="function"?e:null)}var Tt=Object.assign,Bd;function Ul(e){if(Bd===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Bd=t&&t[1]||""}return`
`+Bd+e}var jd=!1;function $d(e,t){if(!e||jd)return"";jd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{jd=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ul(e):""}function iP(e){switch(e.tag){case 5:return Ul(e.type);case 16:return Ul("Lazy");case 13:return Ul("Suspense");case 19:return Ul("SuspenseList");case 0:case 2:case 15:return e=$d(e.type,!1),e;case 11:return e=$d(e.type.render,!1),e;case 1:return e=$d(e.type,!0),e;default:return""}}function um(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case oo:return"Fragment";case ao:return"Portal";case om:return"Profiler";case t1:return"StrictMode";case lm:return"Suspense";case cm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case _T:return(e.displayName||"Context")+".Consumer";case vT:return(e._context.displayName||"Context")+".Provider";case r1:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case n1:return t=e.displayName||null,t!==null?t:um(e.type)||"Memo";case rs:t=e._payload,e=e._init;try{return um(e(t))}catch{}}return null}function sP(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return um(t);case 8:return t===t1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function bs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function yT(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function aP(e){var t=yT(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function af(e){e._valueTracker||(e._valueTracker=aP(e))}function ET(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=yT(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function dh(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function fm(e,t){var r=t.checked;return Tt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function sx(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=bs(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function wT(e,t){t=t.checked,t!=null&&e1(e,"checked",t,!1)}function hm(e,t){wT(e,t);var r=bs(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?dm(e,t.type,r):t.hasOwnProperty("defaultValue")&&dm(e,t.type,bs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function ax(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function dm(e,t,r){(t!=="number"||dh(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Bl=Array.isArray;function To(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+bs(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function pm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(le(91));return Tt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ox(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(le(92));if(Bl(r)){if(1<r.length)throw Error(le(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:bs(r)}}function TT(e,t){var r=bs(t.value),n=bs(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function lx(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function kT(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function mm(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?kT(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var of,AT=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(of=of||document.createElement("div"),of.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=of.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Rc(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var tc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},oP=["Webkit","ms","Moz","O"];Object.keys(tc).forEach(function(e){oP.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),tc[t]=tc[e]})});function ST(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||tc.hasOwnProperty(e)&&tc[e]?(""+t).trim():t+"px"}function IT(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=ST(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var lP=Tt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gm(e,t){if(t){if(lP[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(le(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(le(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(le(61))}if(t.style!=null&&typeof t.style!="object")throw Error(le(62))}}function vm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _m=null;function i1(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var xm=null,ko=null,Ao=null;function cx(e){if(e=Tu(e)){if(typeof xm!="function")throw Error(le(280));var t=e.stateNode;t&&(t=N0(t),xm(e.stateNode,e.type,t))}}function CT(e){ko?Ao?Ao.push(e):Ao=[e]:ko=e}function RT(){if(ko){var e=ko,t=Ao;if(Ao=ko=null,cx(e),t)for(e=0;e<t.length;e++)cx(t[e])}}function PT(e,t){return e(t)}function FT(){}var Hd=!1;function NT(e,t,r){if(Hd)return e(t,r);Hd=!0;try{return PT(e,t,r)}finally{Hd=!1,(ko!==null||Ao!==null)&&(FT(),RT())}}function Pc(e,t){var r=e.stateNode;if(r===null)return null;var n=N0(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(le(231,t,typeof r));return r}var ym=!1;if(Vi)try{var Sl={};Object.defineProperty(Sl,"passive",{get:function(){ym=!0}}),window.addEventListener("test",Sl,Sl),window.removeEventListener("test",Sl,Sl)}catch{ym=!1}function cP(e,t,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var rc=!1,ph=null,mh=!1,Em=null,uP={onError:function(e){rc=!0,ph=e}};function fP(e,t,r,n,i,s,a,o,l){rc=!1,ph=null,cP.apply(uP,arguments)}function hP(e,t,r,n,i,s,a,o,l){if(fP.apply(this,arguments),rc){if(rc){var c=ph;rc=!1,ph=null}else throw Error(le(198));mh||(mh=!0,Em=c)}}function Ua(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function DT(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ux(e){if(Ua(e)!==e)throw Error(le(188))}function dP(e){var t=e.alternate;if(!t){if(t=Ua(e),t===null)throw Error(le(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return ux(i),e;if(s===n)return ux(i),t;s=s.sibling}throw Error(le(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(le(189))}}if(r.alternate!==n)throw Error(le(190))}if(r.tag!==3)throw Error(le(188));return r.stateNode.current===r?e:t}function OT(e){return e=dP(e),e!==null?LT(e):null}function LT(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=LT(e);if(t!==null)return t;e=e.sibling}return null}var bT=vn.unstable_scheduleCallback,fx=vn.unstable_cancelCallback,pP=vn.unstable_shouldYield,mP=vn.unstable_requestPaint,Dt=vn.unstable_now,gP=vn.unstable_getCurrentPriorityLevel,s1=vn.unstable_ImmediatePriority,MT=vn.unstable_UserBlockingPriority,gh=vn.unstable_NormalPriority,vP=vn.unstable_LowPriority,VT=vn.unstable_IdlePriority,C0=null,ui=null;function _P(e){if(ui&&typeof ui.onCommitFiberRoot=="function")try{ui.onCommitFiberRoot(C0,e,void 0,(e.current.flags&128)===128)}catch{}}var Gn=Math.clz32?Math.clz32:EP,xP=Math.log,yP=Math.LN2;function EP(e){return e>>>=0,e===0?32:31-(xP(e)/yP|0)|0}var lf=64,cf=4194304;function jl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function vh(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=jl(o):(s&=a,s!==0&&(n=jl(s)))}else a=r&~i,a!==0?n=jl(a):s!==0&&(n=jl(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Gn(t),i=1<<r,n|=e[r],t&=~i;return n}function wP(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function TP(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-Gn(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=wP(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function wm(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function UT(){var e=lf;return lf<<=1,!(lf&4194240)&&(lf=64),e}function zd(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Eu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Gn(t),e[t]=r}function kP(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Gn(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function a1(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Gn(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var rt=0;function BT(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var jT,o1,$T,HT,zT,Tm=!1,uf=[],ws=null,Ts=null,ks=null,Fc=new Map,Nc=new Map,is=[],AP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function hx(e,t){switch(e){case"focusin":case"focusout":ws=null;break;case"dragenter":case"dragleave":Ts=null;break;case"mouseover":case"mouseout":ks=null;break;case"pointerover":case"pointerout":Fc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nc.delete(t.pointerId)}}function Il(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=Tu(t),t!==null&&o1(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function SP(e,t,r,n,i){switch(t){case"focusin":return ws=Il(ws,e,t,r,n,i),!0;case"dragenter":return Ts=Il(Ts,e,t,r,n,i),!0;case"mouseover":return ks=Il(ks,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Fc.set(s,Il(Fc.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Nc.set(s,Il(Nc.get(s)||null,e,t,r,n,i)),!0}return!1}function WT(e){var t=oa(e.target);if(t!==null){var r=Ua(t);if(r!==null){if(t=r.tag,t===13){if(t=DT(r),t!==null){e.blockedOn=t,zT(e.priority,function(){$T(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Kf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=km(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);_m=n,r.target.dispatchEvent(n),_m=null}else return t=Tu(r),t!==null&&o1(t),e.blockedOn=r,!1;t.shift()}return!0}function dx(e,t,r){Kf(e)&&r.delete(t)}function IP(){Tm=!1,ws!==null&&Kf(ws)&&(ws=null),Ts!==null&&Kf(Ts)&&(Ts=null),ks!==null&&Kf(ks)&&(ks=null),Fc.forEach(dx),Nc.forEach(dx)}function Cl(e,t){e.blockedOn===t&&(e.blockedOn=null,Tm||(Tm=!0,vn.unstable_scheduleCallback(vn.unstable_NormalPriority,IP)))}function Dc(e){function t(i){return Cl(i,e)}if(0<uf.length){Cl(uf[0],e);for(var r=1;r<uf.length;r++){var n=uf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ws!==null&&Cl(ws,e),Ts!==null&&Cl(Ts,e),ks!==null&&Cl(ks,e),Fc.forEach(t),Nc.forEach(t),r=0;r<is.length;r++)n=is[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<is.length&&(r=is[0],r.blockedOn===null);)WT(r),r.blockedOn===null&&is.shift()}var So=Ki.ReactCurrentBatchConfig,_h=!0;function CP(e,t,r,n){var i=rt,s=So.transition;So.transition=null;try{rt=1,l1(e,t,r,n)}finally{rt=i,So.transition=s}}function RP(e,t,r,n){var i=rt,s=So.transition;So.transition=null;try{rt=4,l1(e,t,r,n)}finally{rt=i,So.transition=s}}function l1(e,t,r,n){if(_h){var i=km(e,t,r,n);if(i===null)ep(e,t,n,xh,r),hx(e,n);else if(SP(i,e,t,r,n))n.stopPropagation();else if(hx(e,n),t&4&&-1<AP.indexOf(e)){for(;i!==null;){var s=Tu(i);if(s!==null&&jT(s),s=km(e,t,r,n),s===null&&ep(e,t,n,xh,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else ep(e,t,n,null,r)}}var xh=null;function km(e,t,r,n){if(xh=null,e=i1(n),e=oa(e),e!==null)if(t=Ua(e),t===null)e=null;else if(r=t.tag,r===13){if(e=DT(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return xh=e,null}function GT(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gP()){case s1:return 1;case MT:return 4;case gh:case vP:return 16;case VT:return 536870912;default:return 16}default:return 16}}var ds=null,c1=null,qf=null;function KT(){if(qf)return qf;var e,t=c1,r=t.length,n,i="value"in ds?ds.value:ds.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[s-n];n++);return qf=i.slice(e,1<n?1-n:void 0)}function Xf(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ff(){return!0}function px(){return!1}function En(e){function t(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ff:px,this.isPropagationStopped=px,this}return Tt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ff)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ff)},persist:function(){},isPersistent:ff}),t}var rl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},u1=En(rl),wu=Tt({},rl,{view:0,detail:0}),PP=En(wu),Wd,Gd,Rl,R0=Tt({},wu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:f1,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Rl&&(Rl&&e.type==="mousemove"?(Wd=e.screenX-Rl.screenX,Gd=e.screenY-Rl.screenY):Gd=Wd=0,Rl=e),Wd)},movementY:function(e){return"movementY"in e?e.movementY:Gd}}),mx=En(R0),FP=Tt({},R0,{dataTransfer:0}),NP=En(FP),DP=Tt({},wu,{relatedTarget:0}),Kd=En(DP),OP=Tt({},rl,{animationName:0,elapsedTime:0,pseudoElement:0}),LP=En(OP),bP=Tt({},rl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),MP=En(bP),VP=Tt({},rl,{data:0}),gx=En(VP),UP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},BP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $P(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=jP[e])?!!t[e]:!1}function f1(){return $P}var HP=Tt({},wu,{key:function(e){if(e.key){var t=UP[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Xf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?BP[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:f1,charCode:function(e){return e.type==="keypress"?Xf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Xf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),zP=En(HP),WP=Tt({},R0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vx=En(WP),GP=Tt({},wu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:f1}),KP=En(GP),qP=Tt({},rl,{propertyName:0,elapsedTime:0,pseudoElement:0}),XP=En(qP),YP=Tt({},R0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),QP=En(YP),JP=[9,13,27,32],h1=Vi&&"CompositionEvent"in window,nc=null;Vi&&"documentMode"in document&&(nc=document.documentMode);var ZP=Vi&&"TextEvent"in window&&!nc,qT=Vi&&(!h1||nc&&8<nc&&11>=nc),_x=String.fromCharCode(32),xx=!1;function XT(e,t){switch(e){case"keyup":return JP.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function YT(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var lo=!1;function eF(e,t){switch(e){case"compositionend":return YT(t);case"keypress":return t.which!==32?null:(xx=!0,_x);case"textInput":return e=t.data,e===_x&&xx?null:e;default:return null}}function tF(e,t){if(lo)return e==="compositionend"||!h1&&XT(e,t)?(e=KT(),qf=c1=ds=null,lo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return qT&&t.locale!=="ko"?null:t.data;default:return null}}var rF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!rF[e.type]:t==="textarea"}function QT(e,t,r,n){CT(n),t=yh(t,"onChange"),0<t.length&&(r=new u1("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var ic=null,Oc=null;function nF(e){l2(e,0)}function P0(e){var t=fo(e);if(ET(t))return e}function iF(e,t){if(e==="change")return t}var JT=!1;if(Vi){var qd;if(Vi){var Xd="oninput"in document;if(!Xd){var Ex=document.createElement("div");Ex.setAttribute("oninput","return;"),Xd=typeof Ex.oninput=="function"}qd=Xd}else qd=!1;JT=qd&&(!document.documentMode||9<document.documentMode)}function wx(){ic&&(ic.detachEvent("onpropertychange",ZT),Oc=ic=null)}function ZT(e){if(e.propertyName==="value"&&P0(Oc)){var t=[];QT(t,Oc,e,i1(e)),NT(nF,t)}}function sF(e,t,r){e==="focusin"?(wx(),ic=t,Oc=r,ic.attachEvent("onpropertychange",ZT)):e==="focusout"&&wx()}function aF(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return P0(Oc)}function oF(e,t){if(e==="click")return P0(t)}function lF(e,t){if(e==="input"||e==="change")return P0(t)}function cF(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Yn=typeof Object.is=="function"?Object.is:cF;function Lc(e,t){if(Yn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!am.call(t,i)||!Yn(e[i],t[i]))return!1}return!0}function Tx(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function kx(e,t){var r=Tx(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Tx(r)}}function e2(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?e2(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function t2(){for(var e=window,t=dh();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=dh(e.document)}return t}function d1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function uF(e){var t=t2(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&e2(r.ownerDocument.documentElement,r)){if(n!==null&&d1(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=kx(r,s);var a=kx(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fF=Vi&&"documentMode"in document&&11>=document.documentMode,co=null,Am=null,sc=null,Sm=!1;function Ax(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Sm||co==null||co!==dh(n)||(n=co,"selectionStart"in n&&d1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),sc&&Lc(sc,n)||(sc=n,n=yh(Am,"onSelect"),0<n.length&&(t=new u1("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=co)))}function hf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var uo={animationend:hf("Animation","AnimationEnd"),animationiteration:hf("Animation","AnimationIteration"),animationstart:hf("Animation","AnimationStart"),transitionend:hf("Transition","TransitionEnd")},Yd={},r2={};Vi&&(r2=document.createElement("div").style,"AnimationEvent"in window||(delete uo.animationend.animation,delete uo.animationiteration.animation,delete uo.animationstart.animation),"TransitionEvent"in window||delete uo.transitionend.transition);function F0(e){if(Yd[e])return Yd[e];if(!uo[e])return e;var t=uo[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in r2)return Yd[e]=t[r];return e}var n2=F0("animationend"),i2=F0("animationiteration"),s2=F0("animationstart"),a2=F0("transitionend"),o2=new Map,Sx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ws(e,t){o2.set(e,t),Va(t,[e])}for(var Qd=0;Qd<Sx.length;Qd++){var Jd=Sx[Qd],hF=Jd.toLowerCase(),dF=Jd[0].toUpperCase()+Jd.slice(1);Ws(hF,"on"+dF)}Ws(n2,"onAnimationEnd");Ws(i2,"onAnimationIteration");Ws(s2,"onAnimationStart");Ws("dblclick","onDoubleClick");Ws("focusin","onFocus");Ws("focusout","onBlur");Ws(a2,"onTransitionEnd");Mo("onMouseEnter",["mouseout","mouseover"]);Mo("onMouseLeave",["mouseout","mouseover"]);Mo("onPointerEnter",["pointerout","pointerover"]);Mo("onPointerLeave",["pointerout","pointerover"]);Va("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Va("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Va("onBeforeInput",["compositionend","keypress","textInput","paste"]);Va("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Va("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Va("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $l="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pF=new Set("cancel close invalid load scroll toggle".split(" ").concat($l));function Ix(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,hP(n,t,void 0,e),e.currentTarget=null}function l2(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Ix(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Ix(i,o,c),s=l}}}if(mh)throw e=Em,mh=!1,Em=null,e}function ct(e,t){var r=t[Fm];r===void 0&&(r=t[Fm]=new Set);var n=e+"__bubble";r.has(n)||(c2(t,e,2,!1),r.add(n))}function Zd(e,t,r){var n=0;t&&(n|=4),c2(r,e,n,t)}var df="_reactListening"+Math.random().toString(36).slice(2);function bc(e){if(!e[df]){e[df]=!0,gT.forEach(function(r){r!=="selectionchange"&&(pF.has(r)||Zd(r,!1,e),Zd(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[df]||(t[df]=!0,Zd("selectionchange",!1,t))}}function c2(e,t,r,n){switch(GT(t)){case 1:var i=CP;break;case 4:i=RP;break;default:i=l1}r=i.bind(null,t,r,e),i=void 0,!ym||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function ep(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=oa(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}NT(function(){var c=s,u=i1(r),f=[];e:{var h=o2.get(e);if(h!==void 0){var d=u1,m=e;switch(e){case"keypress":if(Xf(r)===0)break e;case"keydown":case"keyup":d=zP;break;case"focusin":m="focus",d=Kd;break;case"focusout":m="blur",d=Kd;break;case"beforeblur":case"afterblur":d=Kd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=mx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=NP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=KP;break;case n2:case i2:case s2:d=LP;break;case a2:d=XP;break;case"scroll":d=PP;break;case"wheel":d=QP;break;case"copy":case"cut":case"paste":d=MP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=vx}var p=(t&4)!==0,g=!p&&e==="scroll",x=p?h!==null?h+"Capture":null:h;p=[];for(var _=c,v;_!==null;){v=_;var T=v.stateNode;if(v.tag===5&&T!==null&&(v=T,x!==null&&(T=Pc(_,x),T!=null&&p.push(Mc(_,T,v)))),g)break;_=_.return}0<p.length&&(h=new d(h,m,null,r,u),f.push({event:h,listeners:p}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",d=e==="mouseout"||e==="pointerout",h&&r!==_m&&(m=r.relatedTarget||r.fromElement)&&(oa(m)||m[Ui]))break e;if((d||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,d?(m=r.relatedTarget||r.toElement,d=c,m=m?oa(m):null,m!==null&&(g=Ua(m),m!==g||m.tag!==5&&m.tag!==6)&&(m=null)):(d=null,m=c),d!==m)){if(p=mx,T="onMouseLeave",x="onMouseEnter",_="mouse",(e==="pointerout"||e==="pointerover")&&(p=vx,T="onPointerLeave",x="onPointerEnter",_="pointer"),g=d==null?h:fo(d),v=m==null?h:fo(m),h=new p(T,_+"leave",d,r,u),h.target=g,h.relatedTarget=v,T=null,oa(u)===c&&(p=new p(x,_+"enter",m,r,u),p.target=v,p.relatedTarget=g,T=p),g=T,d&&m)t:{for(p=d,x=m,_=0,v=p;v;v=Ja(v))_++;for(v=0,T=x;T;T=Ja(T))v++;for(;0<_-v;)p=Ja(p),_--;for(;0<v-_;)x=Ja(x),v--;for(;_--;){if(p===x||x!==null&&p===x.alternate)break t;p=Ja(p),x=Ja(x)}p=null}else p=null;d!==null&&Cx(f,h,d,p,!1),m!==null&&g!==null&&Cx(f,g,m,p,!0)}}e:{if(h=c?fo(c):window,d=h.nodeName&&h.nodeName.toLowerCase(),d==="select"||d==="input"&&h.type==="file")var k=iF;else if(yx(h))if(JT)k=lF;else{k=aF;var A=sF}else(d=h.nodeName)&&d.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(k=oF);if(k&&(k=k(e,c))){QT(f,k,r,u);break e}A&&A(e,h,c),e==="focusout"&&(A=h._wrapperState)&&A.controlled&&h.type==="number"&&dm(h,"number",h.value)}switch(A=c?fo(c):window,e){case"focusin":(yx(A)||A.contentEditable==="true")&&(co=A,Am=c,sc=null);break;case"focusout":sc=Am=co=null;break;case"mousedown":Sm=!0;break;case"contextmenu":case"mouseup":case"dragend":Sm=!1,Ax(f,r,u);break;case"selectionchange":if(fF)break;case"keydown":case"keyup":Ax(f,r,u)}var E;if(h1)e:{switch(e){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else lo?XT(e,r)&&(F="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&(qT&&r.locale!=="ko"&&(lo||F!=="onCompositionStart"?F==="onCompositionEnd"&&lo&&(E=KT()):(ds=u,c1="value"in ds?ds.value:ds.textContent,lo=!0)),A=yh(c,F),0<A.length&&(F=new gx(F,e,null,r,u),f.push({event:F,listeners:A}),E?F.data=E:(E=YT(r),E!==null&&(F.data=E)))),(E=ZP?eF(e,r):tF(e,r))&&(c=yh(c,"onBeforeInput"),0<c.length&&(u=new gx("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:c}),u.data=E))}l2(f,t)})}function Mc(e,t,r){return{instance:e,listener:t,currentTarget:r}}function yh(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Pc(e,r),s!=null&&n.unshift(Mc(e,s,i)),s=Pc(e,t),s!=null&&n.push(Mc(e,s,i))),e=e.return}return n}function Ja(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Cx(e,t,r,n,i){for(var s=t._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=Pc(r,s),l!=null&&a.unshift(Mc(r,l,o))):i||(l=Pc(r,s),l!=null&&a.push(Mc(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var mF=/\r\n?/g,gF=/\u0000|\uFFFD/g;function Rx(e){return(typeof e=="string"?e:""+e).replace(mF,`
`).replace(gF,"")}function pf(e,t,r){if(t=Rx(t),Rx(e)!==t&&r)throw Error(le(425))}function Eh(){}var Im=null,Cm=null;function Rm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Pm=typeof setTimeout=="function"?setTimeout:void 0,vF=typeof clearTimeout=="function"?clearTimeout:void 0,Px=typeof Promise=="function"?Promise:void 0,_F=typeof queueMicrotask=="function"?queueMicrotask:typeof Px<"u"?function(e){return Px.resolve(null).then(e).catch(xF)}:Pm;function xF(e){setTimeout(function(){throw e})}function tp(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Dc(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Dc(t)}function As(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Fx(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var nl=Math.random().toString(36).slice(2),ii="__reactFiber$"+nl,Vc="__reactProps$"+nl,Ui="__reactContainer$"+nl,Fm="__reactEvents$"+nl,yF="__reactListeners$"+nl,EF="__reactHandles$"+nl;function oa(e){var t=e[ii];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ui]||r[ii]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Fx(e);e!==null;){if(r=e[ii])return r;e=Fx(e)}return t}e=r,r=e.parentNode}return null}function Tu(e){return e=e[ii]||e[Ui],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function fo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(le(33))}function N0(e){return e[Vc]||null}var Nm=[],ho=-1;function Gs(e){return{current:e}}function dt(e){0>ho||(e.current=Nm[ho],Nm[ho]=null,ho--)}function ot(e,t){ho++,Nm[ho]=e.current,e.current=t}var Ms={},Nr=Gs(Ms),sn=Gs(!1),wa=Ms;function Vo(e,t){var r=e.type.contextTypes;if(!r)return Ms;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function an(e){return e=e.childContextTypes,e!=null}function wh(){dt(sn),dt(Nr)}function Nx(e,t,r){if(Nr.current!==Ms)throw Error(le(168));ot(Nr,t),ot(sn,r)}function u2(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(le(108,sP(e)||"Unknown",i));return Tt({},r,n)}function Th(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ms,wa=Nr.current,ot(Nr,e),ot(sn,sn.current),!0}function Dx(e,t,r){var n=e.stateNode;if(!n)throw Error(le(169));r?(e=u2(e,t,wa),n.__reactInternalMemoizedMergedChildContext=e,dt(sn),dt(Nr),ot(Nr,e)):dt(sn),ot(sn,r)}var Ii=null,D0=!1,rp=!1;function f2(e){Ii===null?Ii=[e]:Ii.push(e)}function wF(e){D0=!0,f2(e)}function Ks(){if(!rp&&Ii!==null){rp=!0;var e=0,t=rt;try{var r=Ii;for(rt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ii=null,D0=!1}catch(i){throw Ii!==null&&(Ii=Ii.slice(e+1)),bT(s1,Ks),i}finally{rt=t,rp=!1}}return null}var po=[],mo=0,kh=null,Ah=0,Sn=[],In=0,Ta=null,Ci=1,Ri="";function ra(e,t){po[mo++]=Ah,po[mo++]=kh,kh=e,Ah=t}function h2(e,t,r){Sn[In++]=Ci,Sn[In++]=Ri,Sn[In++]=Ta,Ta=e;var n=Ci;e=Ri;var i=32-Gn(n)-1;n&=~(1<<i),r+=1;var s=32-Gn(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Ci=1<<32-Gn(t)+i|r<<i|n,Ri=s+e}else Ci=1<<s|r<<i|n,Ri=e}function p1(e){e.return!==null&&(ra(e,1),h2(e,1,0))}function m1(e){for(;e===kh;)kh=po[--mo],po[mo]=null,Ah=po[--mo],po[mo]=null;for(;e===Ta;)Ta=Sn[--In],Sn[In]=null,Ri=Sn[--In],Sn[In]=null,Ci=Sn[--In],Sn[In]=null}var gn=null,hn=null,_t=!1,$n=null;function d2(e,t){var r=Pn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Ox(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,gn=e,hn=As(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,gn=e,hn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ta!==null?{id:Ci,overflow:Ri}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Pn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,gn=e,hn=null,!0):!1;default:return!1}}function Dm(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Om(e){if(_t){var t=hn;if(t){var r=t;if(!Ox(e,t)){if(Dm(e))throw Error(le(418));t=As(r.nextSibling);var n=gn;t&&Ox(e,t)?d2(n,r):(e.flags=e.flags&-4097|2,_t=!1,gn=e)}}else{if(Dm(e))throw Error(le(418));e.flags=e.flags&-4097|2,_t=!1,gn=e}}}function Lx(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;gn=e}function mf(e){if(e!==gn)return!1;if(!_t)return Lx(e),_t=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Rm(e.type,e.memoizedProps)),t&&(t=hn)){if(Dm(e))throw p2(),Error(le(418));for(;t;)d2(e,t),t=As(t.nextSibling)}if(Lx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(le(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){hn=As(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}hn=null}}else hn=gn?As(e.stateNode.nextSibling):null;return!0}function p2(){for(var e=hn;e;)e=As(e.nextSibling)}function Uo(){hn=gn=null,_t=!1}function g1(e){$n===null?$n=[e]:$n.push(e)}var TF=Ki.ReactCurrentBatchConfig;function Bn(e,t){if(e&&e.defaultProps){t=Tt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}var Sh=Gs(null),Ih=null,go=null,v1=null;function _1(){v1=go=Ih=null}function x1(e){var t=Sh.current;dt(Sh),e._currentValue=t}function Lm(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Io(e,t){Ih=e,v1=go=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(rn=!0),e.firstContext=null)}function Nn(e){var t=e._currentValue;if(v1!==e)if(e={context:e,memoizedValue:t,next:null},go===null){if(Ih===null)throw Error(le(308));go=e,Ih.dependencies={lanes:0,firstContext:e}}else go=go.next=e;return t}var la=null;function y1(e){la===null?la=[e]:la.push(e)}function m2(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,y1(t)):(r.next=i.next,i.next=r),t.interleaved=r,Bi(e,n)}function Bi(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ns=!1;function E1(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function g2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Oi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ss(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Je&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Bi(e,r)}return i=n.interleaved,i===null?(t.next=t,y1(n)):(t.next=i.next,i.next=t),n.interleaved=t,Bi(e,r)}function Yf(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,a1(e,r)}}function bx(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Ch(e,t,r,n){var i=e.updateQueue;ns=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;a=0,u=c=l=null,o=s;do{var h=o.lane,d=o.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,p=o;switch(h=t,d=r,p.tag){case 1:if(m=p.payload,typeof m=="function"){f=m.call(d,f,h);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,h=typeof m=="function"?m.call(d,f,h):m,h==null)break e;f=Tt({},f,h);break e;case 2:ns=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else d={eventTime:d,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=d,l=f):u=u.next=d,a|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(u===null&&(l=f),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Aa|=a,e.lanes=a,e.memoizedState=f}}function Mx(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(le(191,i));i.call(n)}}}var v2=new mT.Component().refs;function bm(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Tt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var O0={isMounted:function(e){return(e=e._reactInternals)?Ua(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Wr(),i=Cs(e),s=Oi(n,i);s.payload=t,r!=null&&(s.callback=r),t=Ss(e,s,i),t!==null&&(Kn(t,e,i,n),Yf(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Wr(),i=Cs(e),s=Oi(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Ss(e,s,i),t!==null&&(Kn(t,e,i,n),Yf(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Wr(),n=Cs(e),i=Oi(r,n);i.tag=2,t!=null&&(i.callback=t),t=Ss(e,i,n),t!==null&&(Kn(t,e,n,r),Yf(t,e,n))}};function Vx(e,t,r,n,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!Lc(r,n)||!Lc(i,s):!0}function _2(e,t,r){var n=!1,i=Ms,s=t.contextType;return typeof s=="object"&&s!==null?s=Nn(s):(i=an(t)?wa:Nr.current,n=t.contextTypes,s=(n=n!=null)?Vo(e,i):Ms),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=O0,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function Ux(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&O0.enqueueReplaceState(t,t.state,null)}function Mm(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=v2,E1(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Nn(s):(s=an(t)?wa:Nr.current,i.context=Vo(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(bm(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&O0.enqueueReplaceState(i,i.state,null),Ch(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Pl(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(le(309));var n=r.stateNode}if(!n)throw Error(le(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=i.refs;o===v2&&(o=i.refs={}),a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(le(284));if(!r._owner)throw Error(le(290,e))}return e}function gf(e,t){throw e=Object.prototype.toString.call(t),Error(le(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Bx(e){var t=e._init;return t(e._payload)}function x2(e){function t(x,_){if(e){var v=x.deletions;v===null?(x.deletions=[_],x.flags|=16):v.push(_)}}function r(x,_){if(!e)return null;for(;_!==null;)t(x,_),_=_.sibling;return null}function n(x,_){for(x=new Map;_!==null;)_.key!==null?x.set(_.key,_):x.set(_.index,_),_=_.sibling;return x}function i(x,_){return x=Rs(x,_),x.index=0,x.sibling=null,x}function s(x,_,v){return x.index=v,e?(v=x.alternate,v!==null?(v=v.index,v<_?(x.flags|=2,_):v):(x.flags|=2,_)):(x.flags|=1048576,_)}function a(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,_,v,T){return _===null||_.tag!==6?(_=cp(v,x.mode,T),_.return=x,_):(_=i(_,v),_.return=x,_)}function l(x,_,v,T){var k=v.type;return k===oo?u(x,_,v.props.children,T,v.key):_!==null&&(_.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===rs&&Bx(k)===_.type)?(T=i(_,v.props),T.ref=Pl(x,_,v),T.return=x,T):(T=rh(v.type,v.key,v.props,null,x.mode,T),T.ref=Pl(x,_,v),T.return=x,T)}function c(x,_,v,T){return _===null||_.tag!==4||_.stateNode.containerInfo!==v.containerInfo||_.stateNode.implementation!==v.implementation?(_=up(v,x.mode,T),_.return=x,_):(_=i(_,v.children||[]),_.return=x,_)}function u(x,_,v,T,k){return _===null||_.tag!==7?(_=ga(v,x.mode,T,k),_.return=x,_):(_=i(_,v),_.return=x,_)}function f(x,_,v){if(typeof _=="string"&&_!==""||typeof _=="number")return _=cp(""+_,x.mode,v),_.return=x,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case sf:return v=rh(_.type,_.key,_.props,null,x.mode,v),v.ref=Pl(x,null,_),v.return=x,v;case ao:return _=up(_,x.mode,v),_.return=x,_;case rs:var T=_._init;return f(x,T(_._payload),v)}if(Bl(_)||Al(_))return _=ga(_,x.mode,v,null),_.return=x,_;gf(x,_)}return null}function h(x,_,v,T){var k=_!==null?_.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return k!==null?null:o(x,_,""+v,T);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case sf:return v.key===k?l(x,_,v,T):null;case ao:return v.key===k?c(x,_,v,T):null;case rs:return k=v._init,h(x,_,k(v._payload),T)}if(Bl(v)||Al(v))return k!==null?null:u(x,_,v,T,null);gf(x,v)}return null}function d(x,_,v,T,k){if(typeof T=="string"&&T!==""||typeof T=="number")return x=x.get(v)||null,o(_,x,""+T,k);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case sf:return x=x.get(T.key===null?v:T.key)||null,l(_,x,T,k);case ao:return x=x.get(T.key===null?v:T.key)||null,c(_,x,T,k);case rs:var A=T._init;return d(x,_,v,A(T._payload),k)}if(Bl(T)||Al(T))return x=x.get(v)||null,u(_,x,T,k,null);gf(_,T)}return null}function m(x,_,v,T){for(var k=null,A=null,E=_,F=_=0,O=null;E!==null&&F<v.length;F++){E.index>F?(O=E,E=null):O=E.sibling;var M=h(x,E,v[F],T);if(M===null){E===null&&(E=O);break}e&&E&&M.alternate===null&&t(x,E),_=s(M,_,F),A===null?k=M:A.sibling=M,A=M,E=O}if(F===v.length)return r(x,E),_t&&ra(x,F),k;if(E===null){for(;F<v.length;F++)E=f(x,v[F],T),E!==null&&(_=s(E,_,F),A===null?k=E:A.sibling=E,A=E);return _t&&ra(x,F),k}for(E=n(x,E);F<v.length;F++)O=d(E,x,F,v[F],T),O!==null&&(e&&O.alternate!==null&&E.delete(O.key===null?F:O.key),_=s(O,_,F),A===null?k=O:A.sibling=O,A=O);return e&&E.forEach(function(j){return t(x,j)}),_t&&ra(x,F),k}function p(x,_,v,T){var k=Al(v);if(typeof k!="function")throw Error(le(150));if(v=k.call(v),v==null)throw Error(le(151));for(var A=k=null,E=_,F=_=0,O=null,M=v.next();E!==null&&!M.done;F++,M=v.next()){E.index>F?(O=E,E=null):O=E.sibling;var j=h(x,E,M.value,T);if(j===null){E===null&&(E=O);break}e&&E&&j.alternate===null&&t(x,E),_=s(j,_,F),A===null?k=j:A.sibling=j,A=j,E=O}if(M.done)return r(x,E),_t&&ra(x,F),k;if(E===null){for(;!M.done;F++,M=v.next())M=f(x,M.value,T),M!==null&&(_=s(M,_,F),A===null?k=M:A.sibling=M,A=M);return _t&&ra(x,F),k}for(E=n(x,E);!M.done;F++,M=v.next())M=d(E,x,F,M.value,T),M!==null&&(e&&M.alternate!==null&&E.delete(M.key===null?F:M.key),_=s(M,_,F),A===null?k=M:A.sibling=M,A=M);return e&&E.forEach(function(b){return t(x,b)}),_t&&ra(x,F),k}function g(x,_,v,T){if(typeof v=="object"&&v!==null&&v.type===oo&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case sf:e:{for(var k=v.key,A=_;A!==null;){if(A.key===k){if(k=v.type,k===oo){if(A.tag===7){r(x,A.sibling),_=i(A,v.props.children),_.return=x,x=_;break e}}else if(A.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===rs&&Bx(k)===A.type){r(x,A.sibling),_=i(A,v.props),_.ref=Pl(x,A,v),_.return=x,x=_;break e}r(x,A);break}else t(x,A);A=A.sibling}v.type===oo?(_=ga(v.props.children,x.mode,T,v.key),_.return=x,x=_):(T=rh(v.type,v.key,v.props,null,x.mode,T),T.ref=Pl(x,_,v),T.return=x,x=T)}return a(x);case ao:e:{for(A=v.key;_!==null;){if(_.key===A)if(_.tag===4&&_.stateNode.containerInfo===v.containerInfo&&_.stateNode.implementation===v.implementation){r(x,_.sibling),_=i(_,v.children||[]),_.return=x,x=_;break e}else{r(x,_);break}else t(x,_);_=_.sibling}_=up(v,x.mode,T),_.return=x,x=_}return a(x);case rs:return A=v._init,g(x,_,A(v._payload),T)}if(Bl(v))return m(x,_,v,T);if(Al(v))return p(x,_,v,T);gf(x,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,_!==null&&_.tag===6?(r(x,_.sibling),_=i(_,v),_.return=x,x=_):(r(x,_),_=cp(v,x.mode,T),_.return=x,x=_),a(x)):r(x,_)}return g}var Bo=x2(!0),y2=x2(!1),ku={},fi=Gs(ku),Uc=Gs(ku),Bc=Gs(ku);function ca(e){if(e===ku)throw Error(le(174));return e}function w1(e,t){switch(ot(Bc,t),ot(Uc,e),ot(fi,ku),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:mm(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=mm(t,e)}dt(fi),ot(fi,t)}function jo(){dt(fi),dt(Uc),dt(Bc)}function E2(e){ca(Bc.current);var t=ca(fi.current),r=mm(t,e.type);t!==r&&(ot(Uc,e),ot(fi,r))}function T1(e){Uc.current===e&&(dt(fi),dt(Uc))}var Et=Gs(0);function Rh(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var np=[];function k1(){for(var e=0;e<np.length;e++)np[e]._workInProgressVersionPrimary=null;np.length=0}var Qf=Ki.ReactCurrentDispatcher,ip=Ki.ReactCurrentBatchConfig,ka=0,wt=null,Wt=null,er=null,Ph=!1,ac=!1,jc=0,kF=0;function _r(){throw Error(le(321))}function A1(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Yn(e[r],t[r]))return!1;return!0}function S1(e,t,r,n,i,s){if(ka=s,wt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Qf.current=e===null||e.memoizedState===null?CF:RF,e=r(n,i),ac){s=0;do{if(ac=!1,jc=0,25<=s)throw Error(le(301));s+=1,er=Wt=null,t.updateQueue=null,Qf.current=PF,e=r(n,i)}while(ac)}if(Qf.current=Fh,t=Wt!==null&&Wt.next!==null,ka=0,er=Wt=wt=null,Ph=!1,t)throw Error(le(300));return e}function I1(){var e=jc!==0;return jc=0,e}function ni(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return er===null?wt.memoizedState=er=e:er=er.next=e,er}function Dn(){if(Wt===null){var e=wt.alternate;e=e!==null?e.memoizedState:null}else e=Wt.next;var t=er===null?wt.memoizedState:er.next;if(t!==null)er=t,Wt=e;else{if(e===null)throw Error(le(310));Wt=e,e={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},er===null?wt.memoizedState=er=e:er=er.next=e}return er}function $c(e,t){return typeof t=="function"?t(e):t}function sp(e){var t=Dn(),r=t.queue;if(r===null)throw Error(le(311));r.lastRenderedReducer=e;var n=Wt,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((ka&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=f,a=n):l=l.next=f,wt.lanes|=u,Aa|=u}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,Yn(n,t.memoizedState)||(rn=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,wt.lanes|=s,Aa|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function ap(e){var t=Dn(),r=t.queue;if(r===null)throw Error(le(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);Yn(s,t.memoizedState)||(rn=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function w2(){}function T2(e,t){var r=wt,n=Dn(),i=t(),s=!Yn(n.memoizedState,i);if(s&&(n.memoizedState=i,rn=!0),n=n.queue,C1(S2.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||er!==null&&er.memoizedState.tag&1){if(r.flags|=2048,Hc(9,A2.bind(null,r,n,i,t),void 0,null),tr===null)throw Error(le(349));ka&30||k2(r,t,i)}return i}function k2(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=wt.updateQueue,t===null?(t={lastEffect:null,stores:null},wt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function A2(e,t,r,n){t.value=r,t.getSnapshot=n,I2(t)&&C2(e)}function S2(e,t,r){return r(function(){I2(t)&&C2(e)})}function I2(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Yn(e,r)}catch{return!0}}function C2(e){var t=Bi(e,1);t!==null&&Kn(t,e,1,-1)}function jx(e){var t=ni();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$c,lastRenderedState:e},t.queue=e,e=e.dispatch=IF.bind(null,wt,e),[t.memoizedState,e]}function Hc(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=wt.updateQueue,t===null?(t={lastEffect:null,stores:null},wt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function R2(){return Dn().memoizedState}function Jf(e,t,r,n){var i=ni();wt.flags|=e,i.memoizedState=Hc(1|t,r,void 0,n===void 0?null:n)}function L0(e,t,r,n){var i=Dn();n=n===void 0?null:n;var s=void 0;if(Wt!==null){var a=Wt.memoizedState;if(s=a.destroy,n!==null&&A1(n,a.deps)){i.memoizedState=Hc(t,r,s,n);return}}wt.flags|=e,i.memoizedState=Hc(1|t,r,s,n)}function $x(e,t){return Jf(8390656,8,e,t)}function C1(e,t){return L0(2048,8,e,t)}function P2(e,t){return L0(4,2,e,t)}function F2(e,t){return L0(4,4,e,t)}function N2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function D2(e,t,r){return r=r!=null?r.concat([e]):null,L0(4,4,N2.bind(null,t,e),r)}function R1(){}function O2(e,t){var r=Dn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&A1(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function L2(e,t){var r=Dn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&A1(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function b2(e,t,r){return ka&21?(Yn(r,t)||(r=UT(),wt.lanes|=r,Aa|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,rn=!0),e.memoizedState=r)}function AF(e,t){var r=rt;rt=r!==0&&4>r?r:4,e(!0);var n=ip.transition;ip.transition={};try{e(!1),t()}finally{rt=r,ip.transition=n}}function M2(){return Dn().memoizedState}function SF(e,t,r){var n=Cs(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},V2(e))U2(t,r);else if(r=m2(e,t,r,n),r!==null){var i=Wr();Kn(r,e,n,i),B2(r,t,n)}}function IF(e,t,r){var n=Cs(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(V2(e))U2(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Yn(o,a)){var l=t.interleaved;l===null?(i.next=i,y1(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=m2(e,t,i,n),r!==null&&(i=Wr(),Kn(r,e,n,i),B2(r,t,n))}}function V2(e){var t=e.alternate;return e===wt||t!==null&&t===wt}function U2(e,t){ac=Ph=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function B2(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,a1(e,r)}}var Fh={readContext:Nn,useCallback:_r,useContext:_r,useEffect:_r,useImperativeHandle:_r,useInsertionEffect:_r,useLayoutEffect:_r,useMemo:_r,useReducer:_r,useRef:_r,useState:_r,useDebugValue:_r,useDeferredValue:_r,useTransition:_r,useMutableSource:_r,useSyncExternalStore:_r,useId:_r,unstable_isNewReconciler:!1},CF={readContext:Nn,useCallback:function(e,t){return ni().memoizedState=[e,t===void 0?null:t],e},useContext:Nn,useEffect:$x,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Jf(4194308,4,N2.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Jf(4194308,4,e,t)},useInsertionEffect:function(e,t){return Jf(4,2,e,t)},useMemo:function(e,t){var r=ni();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ni();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=SF.bind(null,wt,e),[n.memoizedState,e]},useRef:function(e){var t=ni();return e={current:e},t.memoizedState=e},useState:jx,useDebugValue:R1,useDeferredValue:function(e){return ni().memoizedState=e},useTransition:function(){var e=jx(!1),t=e[0];return e=AF.bind(null,e[1]),ni().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=wt,i=ni();if(_t){if(r===void 0)throw Error(le(407));r=r()}else{if(r=t(),tr===null)throw Error(le(349));ka&30||k2(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,$x(S2.bind(null,n,s,e),[e]),n.flags|=2048,Hc(9,A2.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=ni(),t=tr.identifierPrefix;if(_t){var r=Ri,n=Ci;r=(n&~(1<<32-Gn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=jc++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=kF++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},RF={readContext:Nn,useCallback:O2,useContext:Nn,useEffect:C1,useImperativeHandle:D2,useInsertionEffect:P2,useLayoutEffect:F2,useMemo:L2,useReducer:sp,useRef:R2,useState:function(){return sp($c)},useDebugValue:R1,useDeferredValue:function(e){var t=Dn();return b2(t,Wt.memoizedState,e)},useTransition:function(){var e=sp($c)[0],t=Dn().memoizedState;return[e,t]},useMutableSource:w2,useSyncExternalStore:T2,useId:M2,unstable_isNewReconciler:!1},PF={readContext:Nn,useCallback:O2,useContext:Nn,useEffect:C1,useImperativeHandle:D2,useInsertionEffect:P2,useLayoutEffect:F2,useMemo:L2,useReducer:ap,useRef:R2,useState:function(){return ap($c)},useDebugValue:R1,useDeferredValue:function(e){var t=Dn();return Wt===null?t.memoizedState=e:b2(t,Wt.memoizedState,e)},useTransition:function(){var e=ap($c)[0],t=Dn().memoizedState;return[e,t]},useMutableSource:w2,useSyncExternalStore:T2,useId:M2,unstable_isNewReconciler:!1};function $o(e,t){try{var r="",n=t;do r+=iP(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function op(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Vm(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var FF=typeof WeakMap=="function"?WeakMap:Map;function j2(e,t,r){r=Oi(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Dh||(Dh=!0,qm=n),Vm(e,t)},r}function $2(e,t,r){r=Oi(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Vm(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Vm(e,t),typeof n!="function"&&(Is===null?Is=new Set([this]):Is.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function Hx(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new FF;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=WF.bind(null,e,t,r),t.then(e,e))}function zx(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Wx(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Oi(-1,1),t.tag=2,Ss(r,t,1))),r.lanes|=1),e)}var NF=Ki.ReactCurrentOwner,rn=!1;function Ur(e,t,r,n){t.child=e===null?y2(t,null,r,n):Bo(t,e.child,r,n)}function Gx(e,t,r,n,i){r=r.render;var s=t.ref;return Io(t,i),n=S1(e,t,r,n,s,i),r=I1(),e!==null&&!rn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ji(e,t,i)):(_t&&r&&p1(t),t.flags|=1,Ur(e,t,n,i),t.child)}function Kx(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!M1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,H2(e,t,s,n,i)):(e=rh(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Lc,r(a,n)&&e.ref===t.ref)return ji(e,t,i)}return t.flags|=1,e=Rs(s,n),e.ref=t.ref,e.return=t,t.child=e}function H2(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(Lc(s,n)&&e.ref===t.ref)if(rn=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(rn=!0);else return t.lanes=e.lanes,ji(e,t,i)}return Um(e,t,r,n,i)}function z2(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ot(_o,ln),ln|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ot(_o,ln),ln|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,ot(_o,ln),ln|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,ot(_o,ln),ln|=n;return Ur(e,t,i,r),t.child}function W2(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Um(e,t,r,n,i){var s=an(r)?wa:Nr.current;return s=Vo(t,s),Io(t,i),r=S1(e,t,r,n,s,i),n=I1(),e!==null&&!rn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ji(e,t,i)):(_t&&n&&p1(t),t.flags|=1,Ur(e,t,r,i),t.child)}function qx(e,t,r,n,i){if(an(r)){var s=!0;Th(t)}else s=!1;if(Io(t,i),t.stateNode===null)Zf(e,t),_2(t,r,n),Mm(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=Nn(c):(c=an(r)?wa:Nr.current,c=Vo(t,c));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&Ux(t,a,n,c),ns=!1;var h=t.memoizedState;a.state=h,Ch(t,n,a,i),l=t.memoizedState,o!==n||h!==l||sn.current||ns?(typeof u=="function"&&(bm(t,r,u,n),l=t.memoizedState),(o=ns||Vx(t,r,o,n,h,l,c))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,g2(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Bn(t.type,o),a.props=c,f=t.pendingProps,h=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Nn(l):(l=an(r)?wa:Nr.current,l=Vo(t,l));var d=r.getDerivedStateFromProps;(u=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==f||h!==l)&&Ux(t,a,n,l),ns=!1,h=t.memoizedState,a.state=h,Ch(t,n,a,i);var m=t.memoizedState;o!==f||h!==m||sn.current||ns?(typeof d=="function"&&(bm(t,r,d,n),m=t.memoizedState),(c=ns||Vx(t,r,c,n,h,m,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,m,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,m,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),a.props=n,a.state=m,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Bm(e,t,r,n,s,i)}function Bm(e,t,r,n,i,s){W2(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&Dx(t,r,!1),ji(e,t,s);n=t.stateNode,NF.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=Bo(t,e.child,null,s),t.child=Bo(t,null,o,s)):Ur(e,t,o,s),t.memoizedState=n.state,i&&Dx(t,r,!0),t.child}function G2(e){var t=e.stateNode;t.pendingContext?Nx(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Nx(e,t.context,!1),w1(e,t.containerInfo)}function Xx(e,t,r,n,i){return Uo(),g1(i),t.flags|=256,Ur(e,t,r,n),t.child}var jm={dehydrated:null,treeContext:null,retryLane:0};function $m(e){return{baseLanes:e,cachePool:null,transitions:null}}function K2(e,t,r){var n=t.pendingProps,i=Et.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),ot(Et,i&1),e===null)return Om(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=V0(a,n,0,null),e=ga(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=$m(r),t.memoizedState=jm,e):P1(t,a));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return DF(e,t,a,n,o,i,r);if(s){s=n.fallback,a=t.mode,i=e.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Rs(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Rs(o,s):(s=ga(s,a,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?$m(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=jm,n}return s=e.child,e=s.sibling,n=Rs(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function P1(e,t){return t=V0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function vf(e,t,r,n){return n!==null&&g1(n),Bo(t,e.child,null,r),e=P1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function DF(e,t,r,n,i,s,a){if(r)return t.flags&256?(t.flags&=-257,n=op(Error(le(422))),vf(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=V0({mode:"visible",children:n.children},i,0,null),s=ga(s,i,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Bo(t,e.child,null,a),t.child.memoizedState=$m(a),t.memoizedState=jm,s);if(!(t.mode&1))return vf(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(le(419)),n=op(s,n,void 0),vf(e,t,a,n)}if(o=(a&e.childLanes)!==0,rn||o){if(n=tr,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Bi(e,i),Kn(n,e,i,-1))}return b1(),n=op(Error(le(421))),vf(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=GF.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,hn=As(i.nextSibling),gn=t,_t=!0,$n=null,e!==null&&(Sn[In++]=Ci,Sn[In++]=Ri,Sn[In++]=Ta,Ci=e.id,Ri=e.overflow,Ta=t),t=P1(t,n.children),t.flags|=4096,t)}function Yx(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Lm(e.return,t,r)}function lp(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function q2(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Ur(e,t,n.children,r),n=Et.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Yx(e,r,t);else if(e.tag===19)Yx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ot(Et,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Rh(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),lp(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Rh(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}lp(t,!0,r,null,s);break;case"together":lp(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Zf(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ji(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Aa|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(le(153));if(t.child!==null){for(e=t.child,r=Rs(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Rs(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function OF(e,t,r){switch(t.tag){case 3:G2(t),Uo();break;case 5:E2(t);break;case 1:an(t.type)&&Th(t);break;case 4:w1(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;ot(Sh,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(ot(Et,Et.current&1),t.flags|=128,null):r&t.child.childLanes?K2(e,t,r):(ot(Et,Et.current&1),e=ji(e,t,r),e!==null?e.sibling:null);ot(Et,Et.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return q2(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ot(Et,Et.current),n)break;return null;case 22:case 23:return t.lanes=0,z2(e,t,r)}return ji(e,t,r)}var X2,Hm,Y2,Q2;X2=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Hm=function(){};Y2=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,ca(fi.current);var s=null;switch(r){case"input":i=fm(e,i),n=fm(e,n),s=[];break;case"select":i=Tt({},i,{value:void 0}),n=Tt({},n,{value:void 0}),s=[];break;case"textarea":i=pm(e,i),n=pm(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Eh)}gm(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Cc.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Cc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ct("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};Q2=function(e,t,r,n){r!==n&&(t.flags|=4)};function Fl(e,t){if(!_t)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function xr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function LF(e,t,r){var n=t.pendingProps;switch(m1(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xr(t),null;case 1:return an(t.type)&&wh(),xr(t),null;case 3:return n=t.stateNode,jo(),dt(sn),dt(Nr),k1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(mf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,$n!==null&&(Qm($n),$n=null))),Hm(e,t),xr(t),null;case 5:T1(t);var i=ca(Bc.current);if(r=t.type,e!==null&&t.stateNode!=null)Y2(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(le(166));return xr(t),null}if(e=ca(fi.current),mf(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[ii]=t,n[Vc]=s,e=(t.mode&1)!==0,r){case"dialog":ct("cancel",n),ct("close",n);break;case"iframe":case"object":case"embed":ct("load",n);break;case"video":case"audio":for(i=0;i<$l.length;i++)ct($l[i],n);break;case"source":ct("error",n);break;case"img":case"image":case"link":ct("error",n),ct("load",n);break;case"details":ct("toggle",n);break;case"input":sx(n,s),ct("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},ct("invalid",n);break;case"textarea":ox(n,s),ct("invalid",n)}gm(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&pf(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&pf(n.textContent,o,e),i=["children",""+o]):Cc.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&ct("scroll",n)}switch(r){case"input":af(n),ax(n,s,!0);break;case"textarea":af(n),lx(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Eh)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kT(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[ii]=t,e[Vc]=n,X2(e,t,!1,!1),t.stateNode=e;e:{switch(a=vm(r,n),r){case"dialog":ct("cancel",e),ct("close",e),i=n;break;case"iframe":case"object":case"embed":ct("load",e),i=n;break;case"video":case"audio":for(i=0;i<$l.length;i++)ct($l[i],e);i=n;break;case"source":ct("error",e),i=n;break;case"img":case"image":case"link":ct("error",e),ct("load",e),i=n;break;case"details":ct("toggle",e),i=n;break;case"input":sx(e,n),i=fm(e,n),ct("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Tt({},n,{value:void 0}),ct("invalid",e);break;case"textarea":ox(e,n),i=pm(e,n),ct("invalid",e);break;default:i=n}gm(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?IT(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&AT(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Rc(e,l):typeof l=="number"&&Rc(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Cc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ct("scroll",e):l!=null&&e1(e,s,l,a))}switch(r){case"input":af(e),ax(e,n,!1);break;case"textarea":af(e),lx(e);break;case"option":n.value!=null&&e.setAttribute("value",""+bs(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?To(e,!!n.multiple,s,!1):n.defaultValue!=null&&To(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Eh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return xr(t),null;case 6:if(e&&t.stateNode!=null)Q2(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(le(166));if(r=ca(Bc.current),ca(fi.current),mf(t)){if(n=t.stateNode,r=t.memoizedProps,n[ii]=t,(s=n.nodeValue!==r)&&(e=gn,e!==null))switch(e.tag){case 3:pf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&pf(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ii]=t,t.stateNode=n}return xr(t),null;case 13:if(dt(Et),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(_t&&hn!==null&&t.mode&1&&!(t.flags&128))p2(),Uo(),t.flags|=98560,s=!1;else if(s=mf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(le(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(le(317));s[ii]=t}else Uo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;xr(t),s=!1}else $n!==null&&(Qm($n),$n=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Et.current&1?Gt===0&&(Gt=3):b1())),t.updateQueue!==null&&(t.flags|=4),xr(t),null);case 4:return jo(),Hm(e,t),e===null&&bc(t.stateNode.containerInfo),xr(t),null;case 10:return x1(t.type._context),xr(t),null;case 17:return an(t.type)&&wh(),xr(t),null;case 19:if(dt(Et),s=t.memoizedState,s===null)return xr(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)Fl(s,!1);else{if(Gt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Rh(e),a!==null){for(t.flags|=128,Fl(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ot(Et,Et.current&1|2),t.child}e=e.sibling}s.tail!==null&&Dt()>Ho&&(t.flags|=128,n=!0,Fl(s,!1),t.lanes=4194304)}else{if(!n)if(e=Rh(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Fl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!_t)return xr(t),null}else 2*Dt()-s.renderingStartTime>Ho&&r!==1073741824&&(t.flags|=128,n=!0,Fl(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Dt(),t.sibling=null,r=Et.current,ot(Et,n?r&1|2:r&1),t):(xr(t),null);case 22:case 23:return L1(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ln&1073741824&&(xr(t),t.subtreeFlags&6&&(t.flags|=8192)):xr(t),null;case 24:return null;case 25:return null}throw Error(le(156,t.tag))}function bF(e,t){switch(m1(t),t.tag){case 1:return an(t.type)&&wh(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return jo(),dt(sn),dt(Nr),k1(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return T1(t),null;case 13:if(dt(Et),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(le(340));Uo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return dt(Et),null;case 4:return jo(),null;case 10:return x1(t.type._context),null;case 22:case 23:return L1(),null;case 24:return null;default:return null}}var _f=!1,Ar=!1,MF=typeof WeakSet=="function"?WeakSet:Set,Ae=null;function vo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){St(e,t,n)}else r.current=null}function zm(e,t,r){try{r()}catch(n){St(e,t,n)}}var Qx=!1;function VF(e,t){if(Im=_h,e=t2(),d1(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,u=0,f=e,h=null;t:for(;;){for(var d;f!==r||i!==0&&f.nodeType!==3||(o=a+i),f!==s||n!==0&&f.nodeType!==3||(l=a+n),f.nodeType===3&&(a+=f.nodeValue.length),(d=f.firstChild)!==null;)h=f,f=d;for(;;){if(f===e)break t;if(h===r&&++c===i&&(o=a),h===s&&++u===n&&(l=a),(d=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=d}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Cm={focusedElem:e,selectionRange:r},_h=!1,Ae=t;Ae!==null;)if(t=Ae,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ae=e;else for(;Ae!==null;){t=Ae;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,g=m.memoizedState,x=t.stateNode,_=x.getSnapshotBeforeUpdate(t.elementType===t.type?p:Bn(t.type,p),g);x.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(le(163))}}catch(T){St(t,t.return,T)}if(e=t.sibling,e!==null){e.return=t.return,Ae=e;break}Ae=t.return}return m=Qx,Qx=!1,m}function oc(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&zm(t,r,s)}i=i.next}while(i!==n)}}function b0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Wm(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function J2(e){var t=e.alternate;t!==null&&(e.alternate=null,J2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ii],delete t[Vc],delete t[Fm],delete t[yF],delete t[EF])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Z2(e){return e.tag===5||e.tag===3||e.tag===4}function Jx(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Z2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Gm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Eh));else if(n!==4&&(e=e.child,e!==null))for(Gm(e,t,r),e=e.sibling;e!==null;)Gm(e,t,r),e=e.sibling}function Km(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Km(e,t,r),e=e.sibling;e!==null;)Km(e,t,r),e=e.sibling}var ar=null,jn=!1;function Qi(e,t,r){for(r=r.child;r!==null;)ek(e,t,r),r=r.sibling}function ek(e,t,r){if(ui&&typeof ui.onCommitFiberUnmount=="function")try{ui.onCommitFiberUnmount(C0,r)}catch{}switch(r.tag){case 5:Ar||vo(r,t);case 6:var n=ar,i=jn;ar=null,Qi(e,t,r),ar=n,jn=i,ar!==null&&(jn?(e=ar,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ar.removeChild(r.stateNode));break;case 18:ar!==null&&(jn?(e=ar,r=r.stateNode,e.nodeType===8?tp(e.parentNode,r):e.nodeType===1&&tp(e,r),Dc(e)):tp(ar,r.stateNode));break;case 4:n=ar,i=jn,ar=r.stateNode.containerInfo,jn=!0,Qi(e,t,r),ar=n,jn=i;break;case 0:case 11:case 14:case 15:if(!Ar&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&zm(r,t,a),i=i.next}while(i!==n)}Qi(e,t,r);break;case 1:if(!Ar&&(vo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){St(r,t,o)}Qi(e,t,r);break;case 21:Qi(e,t,r);break;case 22:r.mode&1?(Ar=(n=Ar)||r.memoizedState!==null,Qi(e,t,r),Ar=n):Qi(e,t,r);break;default:Qi(e,t,r)}}function Zx(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new MF),t.forEach(function(n){var i=KF.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Mn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:ar=o.stateNode,jn=!1;break e;case 3:ar=o.stateNode.containerInfo,jn=!0;break e;case 4:ar=o.stateNode.containerInfo,jn=!0;break e}o=o.return}if(ar===null)throw Error(le(160));ek(s,a,i),ar=null,jn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){St(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)tk(t,e),t=t.sibling}function tk(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Mn(t,e),ei(e),n&4){try{oc(3,e,e.return),b0(3,e)}catch(p){St(e,e.return,p)}try{oc(5,e,e.return)}catch(p){St(e,e.return,p)}}break;case 1:Mn(t,e),ei(e),n&512&&r!==null&&vo(r,r.return);break;case 5:if(Mn(t,e),ei(e),n&512&&r!==null&&vo(r,r.return),e.flags&32){var i=e.stateNode;try{Rc(i,"")}catch(p){St(e,e.return,p)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&wT(i,s),vm(o,a);var c=vm(o,s);for(a=0;a<l.length;a+=2){var u=l[a],f=l[a+1];u==="style"?IT(i,f):u==="dangerouslySetInnerHTML"?AT(i,f):u==="children"?Rc(i,f):e1(i,u,f,c)}switch(o){case"input":hm(i,s);break;case"textarea":TT(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var d=s.value;d!=null?To(i,!!s.multiple,d,!1):h!==!!s.multiple&&(s.defaultValue!=null?To(i,!!s.multiple,s.defaultValue,!0):To(i,!!s.multiple,s.multiple?[]:"",!1))}i[Vc]=s}catch(p){St(e,e.return,p)}}break;case 6:if(Mn(t,e),ei(e),n&4){if(e.stateNode===null)throw Error(le(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(p){St(e,e.return,p)}}break;case 3:if(Mn(t,e),ei(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Dc(t.containerInfo)}catch(p){St(e,e.return,p)}break;case 4:Mn(t,e),ei(e);break;case 13:Mn(t,e),ei(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(D1=Dt())),n&4&&Zx(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Ar=(c=Ar)||u,Mn(t,e),Ar=c):Mn(t,e),ei(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(Ae=e,u=e.child;u!==null;){for(f=Ae=u;Ae!==null;){switch(h=Ae,d=h.child,h.tag){case 0:case 11:case 14:case 15:oc(4,h,h.return);break;case 1:vo(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(p){St(n,r,p)}}break;case 5:vo(h,h.return);break;case 22:if(h.memoizedState!==null){ty(f);continue}}d!==null?(d.return=h,Ae=d):ty(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,l=f.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=ST("display",a))}catch(p){St(e,e.return,p)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(p){St(e,e.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Mn(t,e),ei(e),n&4&&Zx(e);break;case 21:break;default:Mn(t,e),ei(e)}}function ei(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Z2(r)){var n=r;break e}r=r.return}throw Error(le(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Rc(i,""),n.flags&=-33);var s=Jx(e);Km(e,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=Jx(e);Gm(e,o,a);break;default:throw Error(le(161))}}catch(l){St(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function UF(e,t,r){Ae=e,rk(e)}function rk(e,t,r){for(var n=(e.mode&1)!==0;Ae!==null;){var i=Ae,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||_f;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Ar;o=_f;var c=Ar;if(_f=a,(Ar=l)&&!c)for(Ae=i;Ae!==null;)a=Ae,l=a.child,a.tag===22&&a.memoizedState!==null?ry(i):l!==null?(l.return=a,Ae=l):ry(i);for(;s!==null;)Ae=s,rk(s),s=s.sibling;Ae=i,_f=o,Ar=c}ey(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Ae=s):ey(e)}}function ey(e){for(;Ae!==null;){var t=Ae;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ar||b0(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ar)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Bn(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Mx(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Mx(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Dc(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(le(163))}Ar||t.flags&512&&Wm(t)}catch(h){St(t,t.return,h)}}if(t===e){Ae=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ae=r;break}Ae=t.return}}function ty(e){for(;Ae!==null;){var t=Ae;if(t===e){Ae=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ae=r;break}Ae=t.return}}function ry(e){for(;Ae!==null;){var t=Ae;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{b0(4,t)}catch(l){St(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){St(t,i,l)}}var s=t.return;try{Wm(t)}catch(l){St(t,s,l)}break;case 5:var a=t.return;try{Wm(t)}catch(l){St(t,a,l)}}}catch(l){St(t,t.return,l)}if(t===e){Ae=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ae=o;break}Ae=t.return}}var BF=Math.ceil,Nh=Ki.ReactCurrentDispatcher,F1=Ki.ReactCurrentOwner,Fn=Ki.ReactCurrentBatchConfig,Je=0,tr=null,jt=null,fr=0,ln=0,_o=Gs(0),Gt=0,zc=null,Aa=0,M0=0,N1=0,lc=null,en=null,D1=0,Ho=1/0,Si=null,Dh=!1,qm=null,Is=null,xf=!1,ps=null,Oh=0,cc=0,Xm=null,eh=-1,th=0;function Wr(){return Je&6?Dt():eh!==-1?eh:eh=Dt()}function Cs(e){return e.mode&1?Je&2&&fr!==0?fr&-fr:TF.transition!==null?(th===0&&(th=UT()),th):(e=rt,e!==0||(e=window.event,e=e===void 0?16:GT(e.type)),e):1}function Kn(e,t,r,n){if(50<cc)throw cc=0,Xm=null,Error(le(185));Eu(e,r,n),(!(Je&2)||e!==tr)&&(e===tr&&(!(Je&2)&&(M0|=r),Gt===4&&ss(e,fr)),on(e,n),r===1&&Je===0&&!(t.mode&1)&&(Ho=Dt()+500,D0&&Ks()))}function on(e,t){var r=e.callbackNode;TP(e,t);var n=vh(e,e===tr?fr:0);if(n===0)r!==null&&fx(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&fx(r),t===1)e.tag===0?wF(ny.bind(null,e)):f2(ny.bind(null,e)),_F(function(){!(Je&6)&&Ks()}),r=null;else{switch(BT(n)){case 1:r=s1;break;case 4:r=MT;break;case 16:r=gh;break;case 536870912:r=VT;break;default:r=gh}r=uk(r,nk.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function nk(e,t){if(eh=-1,th=0,Je&6)throw Error(le(327));var r=e.callbackNode;if(Co()&&e.callbackNode!==r)return null;var n=vh(e,e===tr?fr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Lh(e,n);else{t=n;var i=Je;Je|=2;var s=sk();(tr!==e||fr!==t)&&(Si=null,Ho=Dt()+500,ma(e,t));do try{HF();break}catch(o){ik(e,o)}while(1);_1(),Nh.current=s,Je=i,jt!==null?t=0:(tr=null,fr=0,t=Gt)}if(t!==0){if(t===2&&(i=wm(e),i!==0&&(n=i,t=Ym(e,i))),t===1)throw r=zc,ma(e,0),ss(e,n),on(e,Dt()),r;if(t===6)ss(e,n);else{if(i=e.current.alternate,!(n&30)&&!jF(i)&&(t=Lh(e,n),t===2&&(s=wm(e),s!==0&&(n=s,t=Ym(e,s))),t===1))throw r=zc,ma(e,0),ss(e,n),on(e,Dt()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(le(345));case 2:na(e,en,Si);break;case 3:if(ss(e,n),(n&130023424)===n&&(t=D1+500-Dt(),10<t)){if(vh(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Wr(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Pm(na.bind(null,e,en,Si),t);break}na(e,en,Si);break;case 4:if(ss(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-Gn(n);s=1<<a,a=t[a],a>i&&(i=a),n&=~s}if(n=i,n=Dt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*BF(n/1960))-n,10<n){e.timeoutHandle=Pm(na.bind(null,e,en,Si),n);break}na(e,en,Si);break;case 5:na(e,en,Si);break;default:throw Error(le(329))}}}return on(e,Dt()),e.callbackNode===r?nk.bind(null,e):null}function Ym(e,t){var r=lc;return e.current.memoizedState.isDehydrated&&(ma(e,t).flags|=256),e=Lh(e,t),e!==2&&(t=en,en=r,t!==null&&Qm(t)),e}function Qm(e){en===null?en=e:en.push.apply(en,e)}function jF(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Yn(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ss(e,t){for(t&=~N1,t&=~M0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Gn(t),n=1<<r;e[r]=-1,t&=~n}}function ny(e){if(Je&6)throw Error(le(327));Co();var t=vh(e,0);if(!(t&1))return on(e,Dt()),null;var r=Lh(e,t);if(e.tag!==0&&r===2){var n=wm(e);n!==0&&(t=n,r=Ym(e,n))}if(r===1)throw r=zc,ma(e,0),ss(e,t),on(e,Dt()),r;if(r===6)throw Error(le(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,na(e,en,Si),on(e,Dt()),null}function O1(e,t){var r=Je;Je|=1;try{return e(t)}finally{Je=r,Je===0&&(Ho=Dt()+500,D0&&Ks())}}function Sa(e){ps!==null&&ps.tag===0&&!(Je&6)&&Co();var t=Je;Je|=1;var r=Fn.transition,n=rt;try{if(Fn.transition=null,rt=1,e)return e()}finally{rt=n,Fn.transition=r,Je=t,!(Je&6)&&Ks()}}function L1(){ln=_o.current,dt(_o)}function ma(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,vF(r)),jt!==null)for(r=jt.return;r!==null;){var n=r;switch(m1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&wh();break;case 3:jo(),dt(sn),dt(Nr),k1();break;case 5:T1(n);break;case 4:jo();break;case 13:dt(Et);break;case 19:dt(Et);break;case 10:x1(n.type._context);break;case 22:case 23:L1()}r=r.return}if(tr=e,jt=e=Rs(e.current,null),fr=ln=t,Gt=0,zc=null,N1=M0=Aa=0,en=lc=null,la!==null){for(t=0;t<la.length;t++)if(r=la[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}la=null}return e}function ik(e,t){do{var r=jt;try{if(_1(),Qf.current=Fh,Ph){for(var n=wt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Ph=!1}if(ka=0,er=Wt=wt=null,ac=!1,jc=0,F1.current=null,r===null||r.return===null){Gt=1,zc=t,jt=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=fr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var d=zx(a);if(d!==null){d.flags&=-257,Wx(d,a,o,s,t),d.mode&1&&Hx(s,c,t),t=d,l=c;var m=t.updateQueue;if(m===null){var p=new Set;p.add(l),t.updateQueue=p}else m.add(l);break e}else{if(!(t&1)){Hx(s,c,t),b1();break e}l=Error(le(426))}}else if(_t&&o.mode&1){var g=zx(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),Wx(g,a,o,s,t),g1($o(l,o));break e}}s=l=$o(l,o),Gt!==4&&(Gt=2),lc===null?lc=[s]:lc.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=j2(s,l,t);bx(s,x);break e;case 1:o=l;var _=s.type,v=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Is===null||!Is.has(v)))){s.flags|=65536,t&=-t,s.lanes|=t;var T=$2(s,o,t);bx(s,T);break e}}s=s.return}while(s!==null)}ok(r)}catch(k){t=k,jt===r&&r!==null&&(jt=r=r.return);continue}break}while(1)}function sk(){var e=Nh.current;return Nh.current=Fh,e===null?Fh:e}function b1(){(Gt===0||Gt===3||Gt===2)&&(Gt=4),tr===null||!(Aa&268435455)&&!(M0&268435455)||ss(tr,fr)}function Lh(e,t){var r=Je;Je|=2;var n=sk();(tr!==e||fr!==t)&&(Si=null,ma(e,t));do try{$F();break}catch(i){ik(e,i)}while(1);if(_1(),Je=r,Nh.current=n,jt!==null)throw Error(le(261));return tr=null,fr=0,Gt}function $F(){for(;jt!==null;)ak(jt)}function HF(){for(;jt!==null&&!pP();)ak(jt)}function ak(e){var t=ck(e.alternate,e,ln);e.memoizedProps=e.pendingProps,t===null?ok(e):jt=t,F1.current=null}function ok(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=bF(r,t),r!==null){r.flags&=32767,jt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Gt=6,jt=null;return}}else if(r=LF(r,t,ln),r!==null){jt=r;return}if(t=t.sibling,t!==null){jt=t;return}jt=t=e}while(t!==null);Gt===0&&(Gt=5)}function na(e,t,r){var n=rt,i=Fn.transition;try{Fn.transition=null,rt=1,zF(e,t,r,n)}finally{Fn.transition=i,rt=n}return null}function zF(e,t,r,n){do Co();while(ps!==null);if(Je&6)throw Error(le(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(le(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(kP(e,s),e===tr&&(jt=tr=null,fr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||xf||(xf=!0,uk(gh,function(){return Co(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Fn.transition,Fn.transition=null;var a=rt;rt=1;var o=Je;Je|=4,F1.current=null,VF(e,r),tk(r,e),uF(Cm),_h=!!Im,Cm=Im=null,e.current=r,UF(r),mP(),Je=o,rt=a,Fn.transition=s}else e.current=r;if(xf&&(xf=!1,ps=e,Oh=i),s=e.pendingLanes,s===0&&(Is=null),_P(r.stateNode),on(e,Dt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Dh)throw Dh=!1,e=qm,qm=null,e;return Oh&1&&e.tag!==0&&Co(),s=e.pendingLanes,s&1?e===Xm?cc++:(cc=0,Xm=e):cc=0,Ks(),null}function Co(){if(ps!==null){var e=BT(Oh),t=Fn.transition,r=rt;try{if(Fn.transition=null,rt=16>e?16:e,ps===null)var n=!1;else{if(e=ps,ps=null,Oh=0,Je&6)throw Error(le(331));var i=Je;for(Je|=4,Ae=e.current;Ae!==null;){var s=Ae,a=s.child;if(Ae.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ae=c;Ae!==null;){var u=Ae;switch(u.tag){case 0:case 11:case 15:oc(8,u,s)}var f=u.child;if(f!==null)f.return=u,Ae=f;else for(;Ae!==null;){u=Ae;var h=u.sibling,d=u.return;if(J2(u),u===c){Ae=null;break}if(h!==null){h.return=d,Ae=h;break}Ae=d}}}var m=s.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var g=p.sibling;p.sibling=null,p=g}while(p!==null)}}Ae=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Ae=a;else e:for(;Ae!==null;){if(s=Ae,s.flags&2048)switch(s.tag){case 0:case 11:case 15:oc(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,Ae=x;break e}Ae=s.return}}var _=e.current;for(Ae=_;Ae!==null;){a=Ae;var v=a.child;if(a.subtreeFlags&2064&&v!==null)v.return=a,Ae=v;else e:for(a=_;Ae!==null;){if(o=Ae,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:b0(9,o)}}catch(k){St(o,o.return,k)}if(o===a){Ae=null;break e}var T=o.sibling;if(T!==null){T.return=o.return,Ae=T;break e}Ae=o.return}}if(Je=i,Ks(),ui&&typeof ui.onPostCommitFiberRoot=="function")try{ui.onPostCommitFiberRoot(C0,e)}catch{}n=!0}return n}finally{rt=r,Fn.transition=t}}return!1}function iy(e,t,r){t=$o(r,t),t=j2(e,t,1),e=Ss(e,t,1),t=Wr(),e!==null&&(Eu(e,1,t),on(e,t))}function St(e,t,r){if(e.tag===3)iy(e,e,r);else for(;t!==null;){if(t.tag===3){iy(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Is===null||!Is.has(n))){e=$o(r,e),e=$2(t,e,1),t=Ss(t,e,1),e=Wr(),t!==null&&(Eu(t,1,e),on(t,e));break}}t=t.return}}function WF(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Wr(),e.pingedLanes|=e.suspendedLanes&r,tr===e&&(fr&r)===r&&(Gt===4||Gt===3&&(fr&130023424)===fr&&500>Dt()-D1?ma(e,0):N1|=r),on(e,t)}function lk(e,t){t===0&&(e.mode&1?(t=cf,cf<<=1,!(cf&130023424)&&(cf=4194304)):t=1);var r=Wr();e=Bi(e,t),e!==null&&(Eu(e,t,r),on(e,r))}function GF(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),lk(e,r)}function KF(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(le(314))}n!==null&&n.delete(t),lk(e,r)}var ck;ck=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||sn.current)rn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return rn=!1,OF(e,t,r);rn=!!(e.flags&131072)}else rn=!1,_t&&t.flags&1048576&&h2(t,Ah,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Zf(e,t),e=t.pendingProps;var i=Vo(t,Nr.current);Io(t,r),i=S1(null,t,n,e,i,r);var s=I1();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,an(n)?(s=!0,Th(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,E1(t),i.updater=O0,t.stateNode=i,i._reactInternals=t,Mm(t,n,e,r),t=Bm(null,t,n,!0,s,r)):(t.tag=0,_t&&s&&p1(t),Ur(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Zf(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=XF(n),e=Bn(n,e),i){case 0:t=Um(null,t,n,e,r);break e;case 1:t=qx(null,t,n,e,r);break e;case 11:t=Gx(null,t,n,e,r);break e;case 14:t=Kx(null,t,n,Bn(n.type,e),r);break e}throw Error(le(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Bn(n,i),Um(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Bn(n,i),qx(e,t,n,i,r);case 3:e:{if(G2(t),e===null)throw Error(le(387));n=t.pendingProps,s=t.memoizedState,i=s.element,g2(e,t),Ch(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=$o(Error(le(423)),t),t=Xx(e,t,n,r,i);break e}else if(n!==i){i=$o(Error(le(424)),t),t=Xx(e,t,n,r,i);break e}else for(hn=As(t.stateNode.containerInfo.firstChild),gn=t,_t=!0,$n=null,r=y2(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Uo(),n===i){t=ji(e,t,r);break e}Ur(e,t,n,r)}t=t.child}return t;case 5:return E2(t),e===null&&Om(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,Rm(n,i)?a=null:s!==null&&Rm(n,s)&&(t.flags|=32),W2(e,t),Ur(e,t,a,r),t.child;case 6:return e===null&&Om(t),null;case 13:return K2(e,t,r);case 4:return w1(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Bo(t,null,n,r):Ur(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Bn(n,i),Gx(e,t,n,i,r);case 7:return Ur(e,t,t.pendingProps,r),t.child;case 8:return Ur(e,t,t.pendingProps.children,r),t.child;case 12:return Ur(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,ot(Sh,n._currentValue),n._currentValue=a,s!==null)if(Yn(s.value,a)){if(s.children===i.children&&!sn.current){t=ji(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Oi(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Lm(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(le(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Lm(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Ur(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Io(t,r),i=Nn(i),n=n(i),t.flags|=1,Ur(e,t,n,r),t.child;case 14:return n=t.type,i=Bn(n,t.pendingProps),i=Bn(n.type,i),Kx(e,t,n,i,r);case 15:return H2(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Bn(n,i),Zf(e,t),t.tag=1,an(n)?(e=!0,Th(t)):e=!1,Io(t,r),_2(t,n,i),Mm(t,n,i,r),Bm(null,t,n,!0,e,r);case 19:return q2(e,t,r);case 22:return z2(e,t,r)}throw Error(le(156,t.tag))};function uk(e,t){return bT(e,t)}function qF(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(e,t,r,n){return new qF(e,t,r,n)}function M1(e){return e=e.prototype,!(!e||!e.isReactComponent)}function XF(e){if(typeof e=="function")return M1(e)?1:0;if(e!=null){if(e=e.$$typeof,e===r1)return 11;if(e===n1)return 14}return 2}function Rs(e,t){var r=e.alternate;return r===null?(r=Pn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function rh(e,t,r,n,i,s){var a=2;if(n=e,typeof e=="function")M1(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case oo:return ga(r.children,i,s,t);case t1:a=8,i|=8;break;case om:return e=Pn(12,r,t,i|2),e.elementType=om,e.lanes=s,e;case lm:return e=Pn(13,r,t,i),e.elementType=lm,e.lanes=s,e;case cm:return e=Pn(19,r,t,i),e.elementType=cm,e.lanes=s,e;case xT:return V0(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case vT:a=10;break e;case _T:a=9;break e;case r1:a=11;break e;case n1:a=14;break e;case rs:a=16,n=null;break e}throw Error(le(130,e==null?e:typeof e,""))}return t=Pn(a,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function ga(e,t,r,n){return e=Pn(7,e,n,t),e.lanes=r,e}function V0(e,t,r,n){return e=Pn(22,e,n,t),e.elementType=xT,e.lanes=r,e.stateNode={isHidden:!1},e}function cp(e,t,r){return e=Pn(6,e,null,t),e.lanes=r,e}function up(e,t,r){return t=Pn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function YF(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zd(0),this.expirationTimes=zd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zd(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function V1(e,t,r,n,i,s,a,o,l){return e=new YF(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Pn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},E1(s),e}function QF(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ao,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function fk(e){if(!e)return Ms;e=e._reactInternals;e:{if(Ua(e)!==e||e.tag!==1)throw Error(le(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(an(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(le(171))}if(e.tag===1){var r=e.type;if(an(r))return u2(e,r,t)}return t}function hk(e,t,r,n,i,s,a,o,l){return e=V1(r,n,!0,e,i,s,a,o,l),e.context=fk(null),r=e.current,n=Wr(),i=Cs(r),s=Oi(n,i),s.callback=t??null,Ss(r,s,i),e.current.lanes=i,Eu(e,i,n),on(e,n),e}function U0(e,t,r,n){var i=t.current,s=Wr(),a=Cs(i);return r=fk(r),t.context===null?t.context=r:t.pendingContext=r,t=Oi(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ss(i,t,a),e!==null&&(Kn(e,i,a,s),Yf(e,i,a)),a}function bh(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function sy(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function U1(e,t){sy(e,t),(e=e.alternate)&&sy(e,t)}function JF(){return null}var dk=typeof reportError=="function"?reportError:function(e){console.error(e)};function B1(e){this._internalRoot=e}B0.prototype.render=B1.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(le(409));U0(e,t,null,null)};B0.prototype.unmount=B1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Sa(function(){U0(null,e,null,null)}),t[Ui]=null}};function B0(e){this._internalRoot=e}B0.prototype.unstable_scheduleHydration=function(e){if(e){var t=HT();e={blockedOn:null,target:e,priority:t};for(var r=0;r<is.length&&t!==0&&t<is[r].priority;r++);is.splice(r,0,e),r===0&&WT(e)}};function j1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function j0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ay(){}function ZF(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=bh(a);s.call(c)}}var a=hk(t,n,e,0,null,!1,!1,"",ay);return e._reactRootContainer=a,e[Ui]=a.current,bc(e.nodeType===8?e.parentNode:e),Sa(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=bh(l);o.call(c)}}var l=V1(e,0,!1,null,null,!1,!1,"",ay);return e._reactRootContainer=l,e[Ui]=l.current,bc(e.nodeType===8?e.parentNode:e),Sa(function(){U0(t,l,r,n)}),l}function $0(e,t,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=bh(a);o.call(l)}}U0(t,a,e,i)}else a=ZF(r,t,e,i,n);return bh(a)}jT=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=jl(t.pendingLanes);r!==0&&(a1(t,r|1),on(t,Dt()),!(Je&6)&&(Ho=Dt()+500,Ks()))}break;case 13:Sa(function(){var n=Bi(e,1);if(n!==null){var i=Wr();Kn(n,e,1,i)}}),U1(e,1)}};o1=function(e){if(e.tag===13){var t=Bi(e,134217728);if(t!==null){var r=Wr();Kn(t,e,134217728,r)}U1(e,134217728)}};$T=function(e){if(e.tag===13){var t=Cs(e),r=Bi(e,t);if(r!==null){var n=Wr();Kn(r,e,t,n)}U1(e,t)}};HT=function(){return rt};zT=function(e,t){var r=rt;try{return rt=e,t()}finally{rt=r}};xm=function(e,t,r){switch(t){case"input":if(hm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=N0(n);if(!i)throw Error(le(90));ET(n),hm(n,i)}}}break;case"textarea":TT(e,r);break;case"select":t=r.value,t!=null&&To(e,!!r.multiple,t,!1)}};PT=O1;FT=Sa;var eN={usingClientEntryPoint:!1,Events:[Tu,fo,N0,CT,RT,O1]},Nl={findFiberByHostInstance:oa,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},tN={bundleType:Nl.bundleType,version:Nl.version,rendererPackageName:Nl.rendererPackageName,rendererConfig:Nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ki.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=OT(e),e===null?null:e.stateNode},findFiberByHostInstance:Nl.findFiberByHostInstance||JF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yf.isDisabled&&yf.supportsFiber)try{C0=yf.inject(tN),ui=yf}catch{}}yn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eN;yn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!j1(t))throw Error(le(200));return QF(e,t,null,r)};yn.createRoot=function(e,t){if(!j1(e))throw Error(le(299));var r=!1,n="",i=dk;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=V1(e,1,!1,null,null,r,!1,n,i),e[Ui]=t.current,bc(e.nodeType===8?e.parentNode:e),new B1(t)};yn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(le(188)):(e=Object.keys(e).join(","),Error(le(268,e)));return e=OT(t),e=e===null?null:e.stateNode,e};yn.flushSync=function(e){return Sa(e)};yn.hydrate=function(e,t,r){if(!j0(t))throw Error(le(200));return $0(null,e,t,!0,r)};yn.hydrateRoot=function(e,t,r){if(!j1(e))throw Error(le(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=dk;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=hk(t,null,e,1,r??null,i,!1,s,a),e[Ui]=t.current,bc(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new B0(t)};yn.render=function(e,t,r){if(!j0(t))throw Error(le(200));return $0(null,e,t,!1,r)};yn.unmountComponentAtNode=function(e){if(!j0(e))throw Error(le(40));return e._reactRootContainer?(Sa(function(){$0(null,null,e,!1,function(){e._reactRootContainer=null,e[Ui]=null})}),!0):!1};yn.unstable_batchedUpdates=O1;yn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!j0(r))throw Error(le(200));if(e==null||e._reactInternals===void 0)throw Error(le(38));return $0(e,t,r,!1,n)};yn.version="18.2.0-next-9e3b772b8-20220608";function pk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(pk)}catch(e){console.error(e)}}pk(),hT.exports=yn;var rN=hT.exports,mk,oy=rN;mk=oy.createRoot,oy.hydrateRoot;/**
 * @remix-run/router v1.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wc(){return Wc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wc.apply(this,arguments)}var ms;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(ms||(ms={}));const ly="popstate";function nN(e){e===void 0&&(e={});function t(n,i){let{pathname:s,search:a,hash:o}=n.location;return Jm("",{pathname:s,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Mh(i)}return sN(t,r,null,e)}function Ot(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function $1(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function iN(){return Math.random().toString(36).substr(2,8)}function cy(e,t){return{usr:e.state,key:e.key,idx:t}}function Jm(e,t,r,n){return r===void 0&&(r=null),Wc({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?il(t):t,{state:r,key:t&&t.key||n||iN()})}function Mh(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function il(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function sN(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,a=i.history,o=ms.Pop,l=null,c=u();c==null&&(c=0,a.replaceState(Wc({},a.state,{idx:c}),""));function u(){return(a.state||{idx:null}).idx}function f(){o=ms.Pop;let g=u(),x=g==null?null:g-c;c=g,l&&l({action:o,location:p.location,delta:x})}function h(g,x){o=ms.Push;let _=Jm(p.location,g,x);r&&r(_,g),c=u()+1;let v=cy(_,c),T=p.createHref(_);try{a.pushState(v,"",T)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;i.location.assign(T)}s&&l&&l({action:o,location:p.location,delta:1})}function d(g,x){o=ms.Replace;let _=Jm(p.location,g,x);r&&r(_,g),c=u();let v=cy(_,c),T=p.createHref(_);a.replaceState(v,"",T),s&&l&&l({action:o,location:p.location,delta:0})}function m(g){let x=i.location.origin!=="null"?i.location.origin:i.location.href,_=typeof g=="string"?g:Mh(g);return Ot(x,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,x)}let p={get action(){return o},get location(){return e(i,a)},listen(g){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(ly,f),l=g,()=>{i.removeEventListener(ly,f),l=null}},createHref(g){return t(i,g)},createURL:m,encodeLocation(g){let x=m(g);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:h,replace:d,go(g){return a.go(g)}};return p}var uy;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(uy||(uy={}));function aN(e,t,r){r===void 0&&(r="/");let n=typeof t=="string"?il(t):t,i=H1(n.pathname||"/",r);if(i==null)return null;let s=gk(e);oN(s);let a=null;for(let o=0;a==null&&o<s.length;++o)a=gN(s[o],xN(i));return a}function gk(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(Ot(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=Ps([n,l.relativePath]),u=r.concat(l);s.children&&s.children.length>0&&(Ot(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),gk(s.children,t,u,c)),!(s.path==null&&!s.index)&&t.push({path:c,score:pN(c,s.index),routesMeta:u})};return e.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let l of vk(s.path))i(s,a,l)}),t}function vk(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let a=vk(n.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),i&&o.push(...a),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function oN(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:mN(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const lN=/^:\w+$/,cN=3,uN=2,fN=1,hN=10,dN=-2,fy=e=>e==="*";function pN(e,t){let r=e.split("/"),n=r.length;return r.some(fy)&&(n+=dN),t&&(n+=uN),r.filter(i=>!fy(i)).reduce((i,s)=>i+(lN.test(s)?cN:s===""?fN:hN),n)}function mN(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function gN(e,t){let{routesMeta:r}=e,n={},i="/",s=[];for(let a=0;a<r.length;++a){let o=r[a],l=a===r.length-1,c=i==="/"?t:t.slice(i.length)||"/",u=vN({path:o.relativePath,caseSensitive:o.caseSensitive,end:l},c);if(!u)return null;Object.assign(n,u.params);let f=o.route;s.push({params:n,pathname:Ps([i,u.pathname]),pathnameBase:TN(Ps([i,u.pathnameBase])),route:f}),u.pathnameBase!=="/"&&(i=Ps([i,u.pathnameBase]))}return s}function vN(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=_N(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((c,u,f)=>{let{paramName:h,isOptional:d}=u;if(h==="*"){let p=o[f]||"";a=s.slice(0,s.length-p.length).replace(/(.)\/+$/,"$1")}const m=o[f];return d&&!m?c[h]=void 0:c[h]=yN(m||"",h),c},{}),pathname:s,pathnameBase:a,pattern:e}}function _N(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),$1(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(a,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function xN(e){try{return decodeURI(e)}catch(t){return $1(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function yN(e,t){try{return decodeURIComponent(e)}catch(r){return $1(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),e}}function H1(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function EN(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?il(e):e;return{pathname:r?r.startsWith("/")?r:wN(r,t):t,search:kN(n),hash:AN(i)}}function wN(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function fp(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function z1(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function W1(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=il(e):(i=Wc({},e),Ot(!i.pathname||!i.pathname.includes("?"),fp("?","pathname","search",i)),Ot(!i.pathname||!i.pathname.includes("#"),fp("#","pathname","hash",i)),Ot(!i.search||!i.search.includes("#"),fp("#","search","hash",i)));let s=e===""||i.pathname==="",a=s?"/":i.pathname,o;if(n||a==null)o=r;else{let f=t.length-1;if(a.startsWith("..")){let h=a.split("/");for(;h[0]==="..";)h.shift(),f-=1;i.pathname=h.join("/")}o=f>=0?t[f]:"/"}let l=EN(i,o),c=a&&a!=="/"&&a.endsWith("/"),u=(s||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Ps=e=>e.join("/").replace(/\/\/+/g,"/"),TN=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),kN=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,AN=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function SN(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const _k=["post","put","patch","delete"];new Set(_k);const IN=["get",..._k];new Set(IN);/**
 * React Router v6.18.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Vh(){return Vh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vh.apply(this,arguments)}const G1=Y.createContext(null),CN=Y.createContext(null),sl=Y.createContext(null),H0=Y.createContext(null),qi=Y.createContext({outlet:null,matches:[],isDataRoute:!1}),xk=Y.createContext(null);function RN(e,t){let{relative:r}=t===void 0?{}:t;al()||Ot(!1);let{basename:n,navigator:i}=Y.useContext(sl),{hash:s,pathname:a,search:o}=Ek(e,{relative:r}),l=a;return n!=="/"&&(l=a==="/"?n:Ps([n,a])),i.createHref({pathname:l,search:o,hash:s})}function al(){return Y.useContext(H0)!=null}function Au(){return al()||Ot(!1),Y.useContext(H0).location}function yk(e){Y.useContext(sl).static||Y.useLayoutEffect(e)}function Ln(){let{isDataRoute:e}=Y.useContext(qi);return e?$N():PN()}function PN(){al()||Ot(!1);let e=Y.useContext(G1),{basename:t,navigator:r}=Y.useContext(sl),{matches:n}=Y.useContext(qi),{pathname:i}=Au(),s=JSON.stringify(z1(n).map(l=>l.pathnameBase)),a=Y.useRef(!1);return yk(()=>{a.current=!0}),Y.useCallback(function(l,c){if(c===void 0&&(c={}),!a.current)return;if(typeof l=="number"){r.go(l);return}let u=W1(l,JSON.parse(s),i,c.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:Ps([t,u.pathname])),(c.replace?r.replace:r.push)(u,c.state,c)},[t,r,s,i,e])}function K1(){let{matches:e}=Y.useContext(qi),t=e[e.length-1];return t?t.params:{}}function Ek(e,t){let{relative:r}=t===void 0?{}:t,{matches:n}=Y.useContext(qi),{pathname:i}=Au(),s=JSON.stringify(z1(n).map(a=>a.pathnameBase));return Y.useMemo(()=>W1(e,JSON.parse(s),i,r==="path"),[e,s,i,r])}function FN(e,t){return NN(e,t)}function NN(e,t,r){al()||Ot(!1);let{navigator:n}=Y.useContext(sl),{matches:i}=Y.useContext(qi),s=i[i.length-1],a=s?s.params:{};s&&s.pathname;let o=s?s.pathnameBase:"/";s&&s.route;let l=Au(),c;if(t){var u;let p=typeof t=="string"?il(t):t;o==="/"||(u=p.pathname)!=null&&u.startsWith(o)||Ot(!1),c=p}else c=l;let f=c.pathname||"/",h=o==="/"?f:f.slice(o.length)||"/",d=aN(e,{pathname:h}),m=MN(d&&d.map(p=>Object.assign({},p,{params:Object.assign({},a,p.params),pathname:Ps([o,n.encodeLocation?n.encodeLocation(p.pathname).pathname:p.pathname]),pathnameBase:p.pathnameBase==="/"?o:Ps([o,n.encodeLocation?n.encodeLocation(p.pathnameBase).pathname:p.pathnameBase])})),i,r);return t&&m?Y.createElement(H0.Provider,{value:{location:Vh({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:ms.Pop}},m):m}function DN(){let e=jN(),t=SN(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return Y.createElement(Y.Fragment,null,Y.createElement("h2",null,"Unexpected Application Error!"),Y.createElement("h3",{style:{fontStyle:"italic"}},t),r?Y.createElement("pre",{style:i},r):null,s)}const ON=Y.createElement(DN,null);class LN extends Y.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error||r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error?Y.createElement(qi.Provider,{value:this.props.routeContext},Y.createElement(xk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function bN(e){let{routeContext:t,match:r,children:n}=e,i=Y.useContext(G1);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),Y.createElement(qi.Provider,{value:t},n)}function MN(e,t,r){var n;if(t===void 0&&(t=[]),r===void 0&&(r=null),e==null){var i;if((i=r)!=null&&i.errors)e=r.matches;else return null}let s=e,a=(n=r)==null?void 0:n.errors;if(a!=null){let o=s.findIndex(l=>l.route.id&&(a==null?void 0:a[l.route.id]));o>=0||Ot(!1),s=s.slice(0,Math.min(s.length,o+1))}return s.reduceRight((o,l,c)=>{let u=l.route.id?a==null?void 0:a[l.route.id]:null,f=null;r&&(f=l.route.errorElement||ON);let h=t.concat(s.slice(0,c+1)),d=()=>{let m;return u?m=f:l.route.Component?m=Y.createElement(l.route.Component,null):l.route.element?m=l.route.element:m=o,Y.createElement(bN,{match:l,routeContext:{outlet:o,matches:h,isDataRoute:r!=null},children:m})};return r&&(l.route.ErrorBoundary||l.route.errorElement||c===0)?Y.createElement(LN,{location:r.location,revalidation:r.revalidation,component:f,error:u,children:d(),routeContext:{outlet:null,matches:h,isDataRoute:!0}}):d()},null)}var wk=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(wk||{}),Uh=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Uh||{});function VN(e){let t=Y.useContext(G1);return t||Ot(!1),t}function UN(e){let t=Y.useContext(CN);return t||Ot(!1),t}function BN(e){let t=Y.useContext(qi);return t||Ot(!1),t}function Tk(e){let t=BN(),r=t.matches[t.matches.length-1];return r.route.id||Ot(!1),r.route.id}function jN(){var e;let t=Y.useContext(xk),r=UN(Uh.UseRouteError),n=Tk(Uh.UseRouteError);return t||((e=r.errors)==null?void 0:e[n])}function $N(){let{router:e}=VN(wk.UseNavigateStable),t=Tk(Uh.UseNavigateStable),r=Y.useRef(!1);return yk(()=>{r.current=!0}),Y.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,Vh({fromRouteId:t},s)))},[e,t])}function Zm(e){let{to:t,replace:r,state:n,relative:i}=e;al()||Ot(!1);let{matches:s}=Y.useContext(qi),{pathname:a}=Au(),o=Ln(),l=W1(t,z1(s).map(u=>u.pathnameBase),a,i==="path"),c=JSON.stringify(l);return Y.useEffect(()=>o(JSON.parse(c),{replace:r,state:n,relative:i}),[o,c,i,r,n]),null}function ts(e){Ot(!1)}function HN(e){let{basename:t="/",children:r=null,location:n,navigationType:i=ms.Pop,navigator:s,static:a=!1}=e;al()&&Ot(!1);let o=t.replace(/^\/*/,"/"),l=Y.useMemo(()=>({basename:o,navigator:s,static:a}),[o,s,a]);typeof n=="string"&&(n=il(n));let{pathname:c="/",search:u="",hash:f="",state:h=null,key:d="default"}=n,m=Y.useMemo(()=>{let p=H1(c,o);return p==null?null:{location:{pathname:p,search:u,hash:f,state:h,key:d},navigationType:i}},[o,c,u,f,h,d,i]);return m==null?null:Y.createElement(sl.Provider,{value:l},Y.createElement(H0.Provider,{children:r,value:m}))}function zN(e){let{children:t,location:r}=e;return FN(eg(t),r)}new Promise(()=>{});function eg(e,t){t===void 0&&(t=[]);let r=[];return Y.Children.forEach(e,(n,i)=>{if(!Y.isValidElement(n))return;let s=[...t,i];if(n.type===Y.Fragment){r.push.apply(r,eg(n.props.children,s));return}n.type!==ts&&Ot(!1),!n.props.index||!n.props.children||Ot(!1);let a={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=eg(n.props.children,s)),r.push(a)}),r}/**
 * React Router DOM v6.18.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tg(){return tg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tg.apply(this,arguments)}function WN(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function GN(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function KN(e,t){return e.button===0&&(!t||t==="_self")&&!GN(e)}const qN=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],XN="startTransition",hy=G4[XN];function YN(e){let{basename:t,children:r,future:n,window:i}=e,s=Y.useRef();s.current==null&&(s.current=nN({window:i,v5Compat:!0}));let a=s.current,[o,l]=Y.useState({action:a.action,location:a.location}),{v7_startTransition:c}=n||{},u=Y.useCallback(f=>{c&&hy?hy(()=>l(f)):l(f)},[l,c]);return Y.useLayoutEffect(()=>a.listen(u),[a,u]),Y.createElement(HN,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:a})}const QN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",JN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,hp=Y.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:s,replace:a,state:o,target:l,to:c,preventScrollReset:u,unstable_viewTransition:f}=t,h=WN(t,qN),{basename:d}=Y.useContext(sl),m,p=!1;if(typeof c=="string"&&JN.test(c)&&(m=c,QN))try{let v=new URL(window.location.href),T=c.startsWith("//")?new URL(v.protocol+c):new URL(c),k=H1(T.pathname,d);T.origin===v.origin&&k!=null?c=k+T.search+T.hash:p=!0}catch{}let g=RN(c,{relative:i}),x=ZN(c,{replace:a,state:o,target:l,preventScrollReset:u,relative:i,unstable_viewTransition:f});function _(v){n&&n(v),v.defaultPrevented||x(v)}return Y.createElement("a",tg({},h,{href:m||g,onClick:p||s?n:_,ref:r,target:l}))});var dy;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(dy||(dy={}));var py;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(py||(py={}));function ZN(e,t){let{target:r,replace:n,state:i,preventScrollReset:s,relative:a,unstable_viewTransition:o}=t===void 0?{}:t,l=Ln(),c=Au(),u=Ek(e,{relative:a});return Y.useCallback(f=>{if(KN(f,r)){f.preventDefault();let h=n!==void 0?n:Mh(c)===Mh(u);l(e,{replace:h,state:i,preventScrollReset:s,relative:a,unstable_viewTransition:o})}},[c,l,u,n,i,r,e,s,a,o])}let Ef;const e3=new Uint8Array(16);function t3(){if(!Ef&&(Ef=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ef))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ef(e3)}const sr=[];for(let e=0;e<256;++e)sr.push((e+256).toString(16).slice(1));function r3(e,t=0){return sr[e[t+0]]+sr[e[t+1]]+sr[e[t+2]]+sr[e[t+3]]+"-"+sr[e[t+4]]+sr[e[t+5]]+"-"+sr[e[t+6]]+sr[e[t+7]]+"-"+sr[e[t+8]]+sr[e[t+9]]+"-"+sr[e[t+10]]+sr[e[t+11]]+sr[e[t+12]]+sr[e[t+13]]+sr[e[t+14]]+sr[e[t+15]]}const n3=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),my={randomUUID:n3};function i3(e,t,r){if(my.randomUUID&&!t&&!e)return my.randomUUID();e=e||{};const n=e.random||(e.rng||t3)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(let i=0;i<16;++i)t[r+i]=n[i];return t}return r3(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kk=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=i&63|128):(i&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=i&63|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=i&63|128)}return t},s3=function(e){const t=[];let r=0,n=0;for(;r<e.length;){const i=e[r++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[r++];t[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=e[r++],a=e[r++],o=e[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;t[n++]=String.fromCharCode(55296+(l>>10)),t[n++]=String.fromCharCode(56320+(l&1023))}else{const s=e[r++],a=e[r++];t[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return t.join("")},Ak={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<e.length;i+=3){const s=e[i],a=i+1<e.length,o=a?e[i+1]:0,l=i+2<e.length,c=l?e[i+2]:0,u=s>>2,f=(s&3)<<4|o>>4;let h=(o&15)<<2|c>>6,d=c&63;l||(d=64,a||(h=64)),n.push(r[u],r[f],r[h],r[d])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(kk(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):s3(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<e.length;){const s=r[e.charAt(i++)],o=i<e.length?r[e.charAt(i)]:0;++i;const c=i<e.length?r[e.charAt(i)]:64;++i;const f=i<e.length?r[e.charAt(i)]:64;if(++i,s==null||o==null||c==null||f==null)throw new a3;const h=s<<2|o>>4;if(n.push(h),c!==64){const d=o<<4&240|c>>2;if(n.push(d),f!==64){const m=c<<6&192|f;n.push(m)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class a3 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const o3=function(e){const t=kk(e);return Ak.encodeByteArray(t,!0)},Bh=function(e){return o3(e).replace(/\./g,"")},Sk=function(e){try{return Ak.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l3(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c3=()=>l3().__FIREBASE_DEFAULTS__,u3=()=>{if(typeof process>"u"||typeof process.env>"u")return;const e={}.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},f3=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&Sk(e[1]);return t&&JSON.parse(t)},z0=()=>{try{return c3()||u3()||f3()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},Ik=e=>{var t,r;return(r=(t=z0())===null||t===void 0?void 0:t.emulatorHosts)===null||r===void 0?void 0:r[e]},Ck=e=>{const t=Ik(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),n]:[t.substring(0,r),n]},Rk=()=>{var e;return(e=z0())===null||e===void 0?void 0:e.config},Pk=e=>{var t;return(t=z0())===null||t===void 0?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h3{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fk(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e),o="";return[Bh(JSON.stringify(r)),Bh(JSON.stringify(a)),o].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function d3(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Dr())}function p3(){var e;const t=(e=z0())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function m3(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function g3(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function v3(){const e=Dr();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function _3(){try{return typeof indexedDB=="object"}catch{return!1}}function x3(){return new Promise((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;t(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y3="FirebaseError";class Ei extends Error{constructor(t,r,n){super(r),this.code=t,this.customData=n,this.name=y3,Object.setPrototypeOf(this,Ei.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Su.prototype.create)}}class Su{constructor(t,r,n){this.service=t,this.serviceName=r,this.errors=n}create(t,...r){const n=r[0]||{},i=`${this.service}/${t}`,s=this.errors[t],a=s?E3(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Ei(i,o,n)}}function E3(e,t){return e.replace(w3,(r,n)=>{const i=t[n];return i!=null?String(i):`<${n}?>`})}const w3=/\{\$([^}]+)}/g;function T3(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function jh(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const i of r){if(!n.includes(i))return!1;const s=e[i],a=t[i];if(gy(s)&&gy(a)){if(!jh(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function gy(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iu(e){const t=[];for(const[r,n]of Object.entries(e))Array.isArray(n)?n.forEach(i=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function Hl(e){const t={};return e.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");t[decodeURIComponent(i)]=decodeURIComponent(s)}}),t}function zl(e){const t=e.indexOf("?");if(!t)return"";const r=e.indexOf("#",t);return e.substring(t,r>0?r:void 0)}function k3(e,t){const r=new A3(e,t);return r.subscribe.bind(r)}class A3{constructor(t,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{t(this)}).catch(n=>{this.error(n)})}next(t){this.forEachObserver(r=>{r.next(t)})}error(t){this.forEachObserver(r=>{r.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,r,n){let i;if(t===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");S3(t,["next","error","complete"])?i=t:i={next:t,error:r,complete:n},i.next===void 0&&(i.next=dp),i.error===void 0&&(i.error=dp),i.complete===void 0&&(i.complete=dp);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,t)}sendOne(t,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{r(this.observers[t])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function S3(e,t){if(typeof e!="object"||e===null)return!1;for(const r of t)if(r in e&&typeof e[r]=="function")return!0;return!1}function dp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lt(e){return e&&e._delegate?e._delegate:e}class Vs{constructor(t,r,n){this.name=t,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ia="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I3{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const n=new h3;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){var r;const n=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(r=t==null?void 0:t.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(R3(t))try{this.getOrInitializeService({instanceIdentifier:ia})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(t=ia){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=ia){return this.instances.has(t)}getOptions(t=ia){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(t,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&t(a,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:C3(t),options:r}),this.instances.set(t,n),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=ia){return this.component?this.component.multipleInstances?t:ia:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function C3(e){return e===ia?void 0:e}function R3(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P3{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new I3(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ge;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Ge||(Ge={}));const F3={debug:Ge.DEBUG,verbose:Ge.VERBOSE,info:Ge.INFO,warn:Ge.WARN,error:Ge.ERROR,silent:Ge.SILENT},N3=Ge.INFO,D3={[Ge.DEBUG]:"log",[Ge.VERBOSE]:"log",[Ge.INFO]:"info",[Ge.WARN]:"warn",[Ge.ERROR]:"error"},O3=(e,t,...r)=>{if(t<e.logLevel)return;const n=new Date().toISOString(),i=D3[t];if(i)console[i](`[${n}]  ${e.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class q1{constructor(t){this.name=t,this._logLevel=N3,this._logHandler=O3,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Ge))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?F3[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Ge.DEBUG,...t),this._logHandler(this,Ge.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Ge.VERBOSE,...t),this._logHandler(this,Ge.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Ge.INFO,...t),this._logHandler(this,Ge.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Ge.WARN,...t),this._logHandler(this,Ge.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Ge.ERROR,...t),this._logHandler(this,Ge.ERROR,...t)}}const L3=(e,t)=>t.some(r=>e instanceof r);let vy,_y;function b3(){return vy||(vy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function M3(){return _y||(_y=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Nk=new WeakMap,rg=new WeakMap,Dk=new WeakMap,pp=new WeakMap,X1=new WeakMap;function V3(e){const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",a)},s=()=>{r(Fs(e.result)),i()},a=()=>{n(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",a)});return t.then(r=>{r instanceof IDBCursor&&Nk.set(r,e)}).catch(()=>{}),X1.set(t,e),t}function U3(e){if(rg.has(e))return;const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",a),e.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",a),e.addEventListener("abort",a)});rg.set(e,t)}let ng={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return rg.get(e);if(t==="objectStoreNames")return e.objectStoreNames||Dk.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Fs(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function B3(e){ng=e(ng)}function j3(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const n=e.call(mp(this),t,...r);return Dk.set(n,t.sort?t.sort():[t]),Fs(n)}:M3().includes(e)?function(...t){return e.apply(mp(this),t),Fs(Nk.get(this))}:function(...t){return Fs(e.apply(mp(this),t))}}function $3(e){return typeof e=="function"?j3(e):(e instanceof IDBTransaction&&U3(e),L3(e,b3())?new Proxy(e,ng):e)}function Fs(e){if(e instanceof IDBRequest)return V3(e);if(pp.has(e))return pp.get(e);const t=$3(e);return t!==e&&(pp.set(e,t),X1.set(t,e)),t}const mp=e=>X1.get(e);function H3(e,t,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(e,t),o=Fs(a);return n&&a.addEventListener("upgradeneeded",l=>{n(Fs(a.result),l.oldVersion,l.newVersion,Fs(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const z3=["get","getKey","getAll","getAllKeys","count"],W3=["put","add","delete","clear"],gp=new Map;function xy(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(gp.get(t))return gp.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,i=W3.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||z3.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return gp.set(t,s),s}B3(e=>({...e,get:(t,r,n)=>xy(t,r)||e.get(t,r,n),has:(t,r)=>!!xy(t,r)||e.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G3{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(K3(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function K3(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const ig="@firebase/app",yy="0.9.22";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ia=new q1("@firebase/app"),q3="@firebase/app-compat",X3="@firebase/analytics-compat",Y3="@firebase/analytics",Q3="@firebase/app-check-compat",J3="@firebase/app-check",Z3="@firebase/auth",eD="@firebase/auth-compat",tD="@firebase/database",rD="@firebase/database-compat",nD="@firebase/functions",iD="@firebase/functions-compat",sD="@firebase/installations",aD="@firebase/installations-compat",oD="@firebase/messaging",lD="@firebase/messaging-compat",cD="@firebase/performance",uD="@firebase/performance-compat",fD="@firebase/remote-config",hD="@firebase/remote-config-compat",dD="@firebase/storage",pD="@firebase/storage-compat",mD="@firebase/firestore",gD="@firebase/firestore-compat",vD="firebase",_D="10.5.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sg="[DEFAULT]",xD={[ig]:"fire-core",[q3]:"fire-core-compat",[Y3]:"fire-analytics",[X3]:"fire-analytics-compat",[J3]:"fire-app-check",[Q3]:"fire-app-check-compat",[Z3]:"fire-auth",[eD]:"fire-auth-compat",[tD]:"fire-rtdb",[rD]:"fire-rtdb-compat",[nD]:"fire-fn",[iD]:"fire-fn-compat",[sD]:"fire-iid",[aD]:"fire-iid-compat",[oD]:"fire-fcm",[lD]:"fire-fcm-compat",[cD]:"fire-perf",[uD]:"fire-perf-compat",[fD]:"fire-rc",[hD]:"fire-rc-compat",[dD]:"fire-gcs",[pD]:"fire-gcs-compat",[mD]:"fire-fst",[gD]:"fire-fst-compat","fire-js":"fire-js",[vD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $h=new Map,ag=new Map;function yD(e,t){try{e.container.addComponent(t)}catch(r){Ia.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function Ca(e){const t=e.name;if(ag.has(t))return Ia.debug(`There were multiple attempts to register component ${t}.`),!1;ag.set(t,e);for(const r of $h.values())yD(r,e);return!0}function W0(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ED={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Ns=new Su("app","Firebase",ED);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(t,r,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Vs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Ns.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ba=_D;function Ok(e,t={}){let r=e;typeof t!="object"&&(t={name:t});const n=Object.assign({name:sg,automaticDataCollectionEnabled:!1},t),i=n.name;if(typeof i!="string"||!i)throw Ns.create("bad-app-name",{appName:String(i)});if(r||(r=Rk()),!r)throw Ns.create("no-options");const s=$h.get(i);if(s){if(jh(r,s.options)&&jh(n,s.config))return s;throw Ns.create("duplicate-app",{appName:i})}const a=new P3(i);for(const l of ag.values())a.addComponent(l);const o=new wD(r,n,a);return $h.set(i,o),o}function Y1(e=sg){const t=$h.get(e);if(!t&&e===sg&&Rk())return Ok();if(!t)throw Ns.create("no-app",{appName:e});return t}function hi(e,t,r){var n;let i=(n=xD[e])!==null&&n!==void 0?n:e;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${t}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Ia.warn(o.join(" "));return}Ca(new Vs(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TD="firebase-heartbeat-database",kD=1,Gc="firebase-heartbeat-store";let vp=null;function Lk(){return vp||(vp=H3(TD,kD,{upgrade:(e,t)=>{switch(t){case 0:e.createObjectStore(Gc)}}}).catch(e=>{throw Ns.create("idb-open",{originalErrorMessage:e.message})})),vp}async function AD(e){try{return await(await Lk()).transaction(Gc).objectStore(Gc).get(bk(e))}catch(t){if(t instanceof Ei)Ia.warn(t.message);else{const r=Ns.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Ia.warn(r.message)}}}async function Ey(e,t){try{const n=(await Lk()).transaction(Gc,"readwrite");await n.objectStore(Gc).put(t,bk(e)),await n.done}catch(r){if(r instanceof Ei)Ia.warn(r.message);else{const n=Ns.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Ia.warn(n.message)}}}function bk(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SD=1024,ID=30*24*60*60*1e3;class CD{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new PD(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=wy();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n)))return this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const s=new Date(i.date).valueOf();return Date.now()-s<=ID}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const t=wy(),{heartbeatsToSend:r,unsentEntries:n}=RD(this._heartbeatsCache.heartbeats),i=Bh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function wy(){return new Date().toISOString().substring(0,10)}function RD(e,t=SD){const r=[];let n=e.slice();for(const i of e){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Ty(r)>t){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Ty(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class PD{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _3()?x3().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await AD(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(t){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Ey(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Ey(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function Ty(e){return Bh(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FD(e){Ca(new Vs("platform-logger",t=>new G3(t),"PRIVATE")),Ca(new Vs("heartbeat",t=>new CD(t),"PRIVATE")),hi(ig,yy,e),hi(ig,yy,"esm2017"),hi("fire-js","")}FD("");function Q1(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Mk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ND=Mk,Vk=new Su("auth","Firebase",Mk());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hh=new q1("@firebase/auth");function DD(e,...t){Hh.logLevel<=Ge.WARN&&Hh.warn(`Auth (${Ba}): ${e}`,...t)}function nh(e,...t){Hh.logLevel<=Ge.ERROR&&Hh.error(`Auth (${Ba}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qn(e,...t){throw J1(e,...t)}function di(e,...t){return J1(e,...t)}function OD(e,t,r){const n=Object.assign(Object.assign({},ND()),{[t]:r});return new Su("auth","Firebase",n).create(t,{appName:e.name})}function J1(e,...t){if(typeof e!="string"){const r=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(r,...n)}return Vk.create(e,...t)}function Fe(e,t,...r){if(!e)throw J1(t,...r)}function Pi(e){const t="INTERNAL ASSERTION FAILED: "+e;throw nh(t),new Error(t)}function $i(e,t){e||Pi(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function og(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.href)||""}function LD(){return ky()==="http:"||ky()==="https:"}function ky(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(LD()||m3()||"connection"in navigator)?navigator.onLine:!0}function MD(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(t,r){this.shortDelay=t,this.longDelay=r,$i(r>t,"Short delay should be less than long delay!"),this.isMobile=d3()||g3()}get(){return bD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z1(e,t){$i(e.emulator,"Emulator should always be set here");const{url:r}=e.emulator;return t?`${r}${t.startsWith("/")?t.slice(1):t}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{static initialize(t,r,n){this.fetchImpl=t,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Pi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Pi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Pi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UD=new Cu(3e4,6e4);function ol(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function ja(e,t,r,n,i={}){return Bk(e,i,async()=>{let s={},a={};n&&(t==="GET"?a=n:s={body:JSON.stringify(n)});const o=Iu(Object.assign({key:e.config.apiKey},a)).slice(1),l=await e._getAdditionalHeaders();return l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode),Uk.fetch()(jk(e,e.config.apiHost,r,o),Object.assign({method:t,headers:l,referrerPolicy:"no-referrer"},s))})}async function Bk(e,t,r){e._canInitEmulator=!1;const n=Object.assign(Object.assign({},VD),t);try{const i=new jD(e),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw wf(e,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw wf(e,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw wf(e,"email-already-in-use",a);if(l==="USER_DISABLED")throw wf(e,"user-disabled",a);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw OD(e,u,c);Qn(e,u)}}catch(i){if(i instanceof Ei)throw i;Qn(e,"network-request-failed",{message:String(i)})}}async function G0(e,t,r,n,i={}){const s=await ja(e,t,r,n,i);return"mfaPendingCredential"in s&&Qn(e,"multi-factor-auth-required",{_serverResponse:s}),s}function jk(e,t,r,n){const i=`${t}${r}?${n}`;return e.config.emulator?Z1(e.config,i):`${e.config.apiScheme}://${i}`}function BD(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class jD{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(di(this.auth,"network-request-failed")),UD.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function wf(e,t,r){const n={appName:e.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=di(e,t,n);return i.customData._tokenResponse=r,i}function Ay(e){return e!==void 0&&e.enterprise!==void 0}class $D{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],t.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===t)return BD(r.enforcementState);return null}isProviderEnabled(t){return this.getProviderEnforcementState(t)==="ENFORCE"||this.getProviderEnforcementState(t)==="AUDIT"}}async function HD(e,t){return ja(e,"GET","/v2/recaptchaConfig",ol(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zD(e,t){return ja(e,"POST","/v1/accounts:delete",t)}async function WD(e,t){return ja(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uc(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function GD(e,t=!1){const r=Lt(e),n=await r.getIdToken(t),i=ev(n);Fe(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:uc(_p(i.auth_time)),issuedAtTime:uc(_p(i.iat)),expirationTime:uc(_p(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function _p(e){return Number(e)*1e3}function ev(e){const[t,r,n]=e.split(".");if(t===void 0||r===void 0||n===void 0)return nh("JWT malformed, contained fewer than 3 sections"),null;try{const i=Sk(r);return i?JSON.parse(i):(nh("Failed to decode base64 JWT payload"),null)}catch(i){return nh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function KD(e){const t=ev(e);return Fe(t,"internal-error"),Fe(typeof t.exp<"u","internal-error"),Fe(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kc(e,t,r=!1){if(r)return t;try{return await t}catch(n){throw n instanceof Ei&&qD(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}function qD({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var r;if(t){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(t=!1){if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $k{constructor(t,r){this.createdAt=t,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=uc(this.lastLoginAt),this.creationTime=uc(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zh(e){var t;const r=e.auth,n=await e.getIdToken(),i=await Kc(e,WD(r,{idToken:n}));Fe(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const a=!((t=s.providerUserInfo)===null||t===void 0)&&t.length?JD(s.providerUserInfo):[],o=QD(e.providerData,a),l=e.isAnonymous,c=!(e.email&&s.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new $k(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(e,f)}async function YD(e){const t=Lt(e);await zh(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function QD(e,t){return[...e.filter(n=>!t.some(i=>i.providerId===n.providerId)),...t]}function JD(e){return e.map(t=>{var{providerId:r}=t,n=Q1(t,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZD(e,t){const r=await Bk(e,{},async()=>{const n=Iu({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:s}=e.config,a=jk(e,i,"/v1/token",`key=${s}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Uk.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Fe(t.idToken,"internal-error"),Fe(typeof t.idToken<"u","internal-error"),Fe(typeof t.refreshToken<"u","internal-error");const r="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):KD(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,r)}async getToken(t,r=!1){return Fe(!this.accessToken||this.refreshToken,t,"user-token-expired"),!r&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(t,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await ZD(t,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(t,r,n){this.refreshToken=r||null,this.accessToken=t||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(t,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new qc;return n&&(Fe(typeof n=="string","internal-error",{appName:t}),a.refreshToken=n),i&&(Fe(typeof i=="string","internal-error",{appName:t}),a.accessToken=i),s&&(Fe(typeof s=="number","internal-error",{appName:t}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new qc,this.toJSON())}_performRefresh(){return Pi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ji(e,t){Fe(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class va{constructor(t){var{uid:r,auth:n,stsTokenManager:i}=t,s=Q1(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new XD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new $k(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const r=await Kc(this,this.stsTokenManager.getToken(this.auth,t));return Fe(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(t){return GD(this,t)}reload(){return YD(this)}_assign(t){this!==t&&(Fe(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(r=>Object.assign({},r)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const r=new va(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(t){Fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,r=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),r&&await zh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await Kc(this,zD(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,r){var n,i,s,a,o,l,c,u;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,h=(i=r.email)!==null&&i!==void 0?i:void 0,d=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,m=(a=r.photoURL)!==null&&a!==void 0?a:void 0,p=(o=r.tenantId)!==null&&o!==void 0?o:void 0,g=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,x=(c=r.createdAt)!==null&&c!==void 0?c:void 0,_=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:v,emailVerified:T,isAnonymous:k,providerData:A,stsTokenManager:E}=r;Fe(v&&E,t,"internal-error");const F=qc.fromJSON(this.name,E);Fe(typeof v=="string",t,"internal-error"),Ji(f,t.name),Ji(h,t.name),Fe(typeof T=="boolean",t,"internal-error"),Fe(typeof k=="boolean",t,"internal-error"),Ji(d,t.name),Ji(m,t.name),Ji(p,t.name),Ji(g,t.name),Ji(x,t.name),Ji(_,t.name);const O=new va({uid:v,auth:t,email:h,emailVerified:T,displayName:f,isAnonymous:k,photoURL:m,phoneNumber:d,tenantId:p,stsTokenManager:F,createdAt:x,lastLoginAt:_});return A&&Array.isArray(A)&&(O.providerData=A.map(M=>Object.assign({},M))),g&&(O._redirectEventId=g),O}static async _fromIdTokenResponse(t,r,n=!1){const i=new qc;i.updateFromServerResponse(r);const s=new va({uid:r.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await zh(s),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sy=new Map;function Fi(e){$i(e instanceof Function,"Expected a class definition");let t=Sy.get(e);return t?($i(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Sy.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){const r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}Hk.type="NONE";const Iy=Hk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ih(e,t,r){return`firebase:${e}:${t}:${r}`}class Ro{constructor(t,r,n){this.persistence=t,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=ih(this.userKey,i.apiKey,s),this.fullPersistenceKey=ih("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?va._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,r,n="authUser"){if(!r.length)return new Ro(Fi(Iy),t,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||Fi(Iy);const a=ih(n,t.config.apiKey,t.name);let o=null;for(const c of r)try{const u=await c._get(a);if(u){const f=va._fromJSON(t,u);c!==s&&(o=f),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Ro(s,t,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new Ro(s,t,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cy(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Gk(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(zk(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(qk(t))return"Blackberry";if(Xk(t))return"Webos";if(tv(t))return"Safari";if((t.includes("chrome/")||Wk(t))&&!t.includes("edge/"))return"Chrome";if(Kk(t))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function zk(e=Dr()){return/firefox\//i.test(e)}function tv(e=Dr()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Wk(e=Dr()){return/crios\//i.test(e)}function Gk(e=Dr()){return/iemobile/i.test(e)}function Kk(e=Dr()){return/android/i.test(e)}function qk(e=Dr()){return/blackberry/i.test(e)}function Xk(e=Dr()){return/webos/i.test(e)}function K0(e=Dr()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function eO(e=Dr()){var t;return K0(e)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function tO(){return v3()&&document.documentMode===10}function Yk(e=Dr()){return K0(e)||Kk(e)||Xk(e)||qk(e)||/windows phone/i.test(e)||Gk(e)}function rO(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qk(e,t=[]){let r;switch(e){case"Browser":r=Cy(Dr());break;case"Worker":r=`${Cy(Dr())}-${e}`;break;default:r=e}const n=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${Ba}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,r){const n=s=>new Promise((a,o)=>{try{const l=t(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const r=[];try{for(const n of this.queue)await n(t),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iO(e,t={}){return ja(e,"GET","/v2/passwordPolicy",ol(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sO=6;class aO{constructor(t){var r,n,i,s;const a=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:sO,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=t.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=t.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,l),this.validatePasswordCharacterOptions(t,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(t,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=t.length>=n),i&&(r.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<t.length;i++)n=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO{constructor(t,r,n,i){this.app=t,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ry(this),this.idTokenSubscription=new Ry(this),this.beforeStateQueue=new nO(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Vk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,r){return r&&(this._popupRedirectResolver=Fi(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Ro.create(this,t),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUser(t){var r;const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(t);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(t){try{await zh(t)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=MD()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const r=t?Lt(t):null;return r&&Fe(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(t,r=!1){if(!this._deleted)return t&&Fe(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(t){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Fi(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await iO(this),r=new aO(t);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new Su("auth","Firebase",t())}onAuthStateChanged(t,r,n){return this.registerStateListener(this.authStateSubscription,t,r,n)}beforeAuthStateChanged(t,r){return this.beforeStateQueue.pushCallback(t,r)}onIdTokenChanged(t,r,n){return this.registerStateListener(this.idTokenSubscription,t,r,n)}authStateReady(){return new Promise((t,r)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged(()=>{n(),t()},r)}})}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,r){const n=await this.getOrInitRedirectPersistenceManager(r);return t===null?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const r=t&&Fi(t)||this._popupRedirectResolver;Fe(r,this,"argument-error"),this.redirectPersistenceManager=await Ro.create(this,[Fi(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===t?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Fe(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=t.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=t.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Qk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var t;const r=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return r!=null&&r.error&&DD(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function ll(e){return Lt(e)}class Ry{constructor(t){this.auth=t,this.observer=null,this.addObserver=k3(r=>this.observer=r)}get next(){return Fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lO(){var e,t;return(t=(e=document.getElementsByTagName("head"))===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:document}function Jk(e){return new Promise((t,r)=>{const n=document.createElement("script");n.setAttribute("src",e),n.onload=t,n.onerror=i=>{const s=di("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",lO().appendChild(n)})}function cO(e){return`__${e}${Math.floor(Math.random()*1e6)}`}const uO="https://www.google.com/recaptcha/enterprise.js?render=",fO="recaptcha-enterprise",hO="NO_RECAPTCHA";class dO{constructor(t){this.type=fO,this.auth=ll(t)}async verify(t="verify",r=!1){async function n(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,o)=>{HD(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new $D(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,a(c.siteKey)}}).catch(l=>{o(l)})})}function i(s,a,o){const l=window.grecaptcha;Ay(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:t}).then(c=>{a(c)}).catch(()=>{a(hO)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{n(this.auth).then(o=>{if(!r&&Ay(window.grecaptcha))i(o,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}Jk(uO+o).then(()=>{i(o,s,a)}).catch(l=>{a(l)})}}).catch(o=>{a(o)})})}}async function Py(e,t,r,n=!1){const i=new dO(e);let s;try{s=await i.verify(r)}catch{s=await i.verify(r,!0)}const a=Object.assign({},t);return n?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function pO(e,t,r,n){var i;if(!((i=e._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await Py(e,t,r,r==="getOobCode");return n(e,s)}else return n(e,t).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Py(e,t,r,r==="getOobCode");return n(e,a)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mO(e,t){const r=W0(e,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(jh(s,t??{}))return i;Qn(i,"already-initialized")}return r.initialize({options:t})}function gO(e,t){const r=(t==null?void 0:t.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Fi);t!=null&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(n,t==null?void 0:t.popupRedirectResolver)}function vO(e,t,r){const n=ll(e);Fe(n._canInitEmulator,n,"emulator-config-failed"),Fe(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");const i=!!(r!=null&&r.disableWarnings),s=Zk(t),{host:a,port:o}=_O(t),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||xO()}function Zk(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function _O(e){const t=Zk(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:Fy(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:Fy(a)}}}function Fy(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function xO(){function e(){const t=document.createElement("p"),r=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(t,r){this.providerId=t,this.signInMethod=r}toJSON(){return Pi("not implemented")}_getIdTokenResponse(t){return Pi("not implemented")}_linkToIdToken(t,r){return Pi("not implemented")}_getReauthenticationResolver(t){return Pi("not implemented")}}async function yO(e,t){return ja(e,"POST","/v1/accounts:update",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EO(e,t){return G0(e,"POST","/v1/accounts:signInWithPassword",ol(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wO(e,t){return G0(e,"POST","/v1/accounts:signInWithEmailLink",ol(e,t))}async function TO(e,t){return G0(e,"POST","/v1/accounts:signInWithEmailLink",ol(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc extends rv{constructor(t,r,n,i=null){super("password",n),this._email=t,this._password=r,this._tenantId=i}static _fromEmailAndPassword(t,r){return new Xc(t,r,"password")}static _fromEmailAndCode(t,r,n=null){return new Xc(t,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return pO(t,r,"signInWithPassword",EO);case"emailLink":return wO(t,{email:this._email,oobCode:this._password});default:Qn(t,"internal-error")}}async _linkToIdToken(t,r){switch(this.signInMethod){case"password":return yO(t,{idToken:r,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return TO(t,{idToken:r,email:this._email,oobCode:this._password});default:Qn(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Po(e,t){return G0(e,"POST","/v1/accounts:signInWithIdp",ol(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kO="http://localhost";class Ra extends rv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const r=new Ra(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(r.idToken=t.idToken),t.accessToken&&(r.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(r.nonce=t.nonce),t.pendingToken&&(r.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(r.accessToken=t.oauthToken,r.secret=t.oauthTokenSecret):Qn("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t,{providerId:n,signInMethod:i}=r,s=Q1(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new Ra(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(t){const r=this.buildRequest();return Po(t,r)}_linkToIdToken(t,r){const n=this.buildRequest();return n.idToken=r,Po(t,n)}_getReauthenticationResolver(t){const r=this.buildRequest();return r.autoCreate=!1,Po(t,r)}buildRequest(){const t={requestUri:kO,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),t.postBody=Iu(r)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AO(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function SO(e){const t=Hl(zl(e)).link,r=t?Hl(zl(t)).deep_link_id:null,n=Hl(zl(e)).deep_link_id;return(n?Hl(zl(n)).link:null)||n||r||t||e}class nv{constructor(t){var r,n,i,s,a,o;const l=Hl(zl(t)),c=(r=l.apiKey)!==null&&r!==void 0?r:null,u=(n=l.oobCode)!==null&&n!==void 0?n:null,f=AO((i=l.mode)!==null&&i!==void 0?i:null);Fe(c&&u&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=u,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=l.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(o=l.tenantId)!==null&&o!==void 0?o:null}static parseLink(t){const r=SO(t);try{return new nv(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(){this.providerId=cl.PROVIDER_ID}static credential(t,r){return Xc._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){const n=nv.parseLink(r);return Fe(n,"argument-error"),Xc._fromEmailAndCode(t,n.code,n.tenantId)}}cl.PROVIDER_ID="password";cl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";cl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru extends eA{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as extends Ru{constructor(){super("facebook.com")}static credential(t){return Ra._fromParams({providerId:as.PROVIDER_ID,signInMethod:as.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return as.credentialFromTaggedObject(t)}static credentialFromError(t){return as.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return as.credential(t.oauthAccessToken)}catch{return null}}}as.FACEBOOK_SIGN_IN_METHOD="facebook.com";as.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os extends Ru{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return Ra._fromParams({providerId:os.PROVIDER_ID,signInMethod:os.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return os.credentialFromTaggedObject(t)}static credentialFromError(t){return os.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:r,oauthAccessToken:n}=t;if(!r&&!n)return null;try{return os.credential(r,n)}catch{return null}}}os.GOOGLE_SIGN_IN_METHOD="google.com";os.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls extends Ru{constructor(){super("github.com")}static credential(t){return Ra._fromParams({providerId:ls.PROVIDER_ID,signInMethod:ls.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return ls.credentialFromTaggedObject(t)}static credentialFromError(t){return ls.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return ls.credential(t.oauthAccessToken)}catch{return null}}}ls.GITHUB_SIGN_IN_METHOD="github.com";ls.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs extends Ru{constructor(){super("twitter.com")}static credential(t,r){return Ra._fromParams({providerId:cs.PROVIDER_ID,signInMethod:cs.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return cs.credentialFromTaggedObject(t)}static credentialFromError(t){return cs.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=t;if(!r||!n)return null;try{return cs.credential(r,n)}catch{return null}}}cs.TWITTER_SIGN_IN_METHOD="twitter.com";cs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,r,n,i=!1){const s=await va._fromIdTokenResponse(t,n,i),a=Ny(n);return new zo({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(t,r,n){await t._updateTokensIfNecessary(n,!0);const i=Ny(n);return new zo({user:t,providerId:i,_tokenResponse:n,operationType:r})}}function Ny(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh extends Ei{constructor(t,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Wh.prototype),this.customData={appName:t.name,tenantId:(s=t.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,r,n,i){return new Wh(t,r,n,i)}}function tA(e,t,r,n){return(t==="reauthenticate"?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Wh._fromErrorAndOperation(e,s,t,n):s})}async function IO(e,t,r=!1){const n=await Kc(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return zo._forOperation(e,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CO(e,t,r=!1){const{auth:n}=e,i="reauthenticate";try{const s=await Kc(e,tA(n,i,t,e),r);Fe(s.idToken,n,"internal-error");const a=ev(s.idToken);Fe(a,n,"internal-error");const{sub:o}=a;return Fe(e.uid===o,n,"user-mismatch"),zo._forOperation(e,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Qn(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rA(e,t,r=!1){const n="signIn",i=await tA(e,n,t),s=await zo._fromIdTokenResponse(e,n,i);return r||await e._updateCurrentUser(s.user),s}async function RO(e,t){return rA(ll(e),t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PO(e){const t=ll(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function FO(e,t,r){return RO(Lt(e),cl.credential(t,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&PO(e),n})}function NO(e,t,r,n){return Lt(e).onIdTokenChanged(t,r,n)}function DO(e,t,r){return Lt(e).beforeAuthStateChanged(t,r)}function OO(e){return Lt(e).signOut()}const Gh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{constructor(t,r){this.storageRetriever=t,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Gh,"1"),this.storage.removeItem(Gh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,r){return this.storage.setItem(t,JSON.stringify(r)),Promise.resolve()}_get(t){const r=this.storage.getItem(t);return Promise.resolve(r?JSON.parse(r):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LO(){const e=Dr();return tv(e)||K0(e)}const bO=1e3,MO=10;class iA extends nA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=LO()&&rO(),this.fallbackToPolling=Yk(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&t(r,i,n)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=t.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(n);if(t.newValue!==a)t.newValue!==null?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!r)return}const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);tO()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,MO):i()}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:n}),!0)})},bO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){const r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}iA.type="LOCAL";const VO=iA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sA extends nA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}sA.type="SESSION";const aA=sA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UO(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const r=this.receivers.find(i=>i.isListeningto(t));if(r)return r;const n=new q0(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const r=t,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await UO(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}q0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iv(e="",t=10){let r="";for(let n=0;n<t;n++)r+=Math.floor(Math.random()*10);return e+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BO{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=iv("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(f){const h=f;if(h.data.eventId===c)switch(h.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(h.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:t,eventId:c,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pi(){return window}function jO(e){pi().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oA(){return typeof pi().WorkerGlobalScope<"u"&&typeof pi().importScripts=="function"}async function $O(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function HO(){var e;return((e=navigator==null?void 0:navigator.serviceWorker)===null||e===void 0?void 0:e.controller)||null}function zO(){return oA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lA="firebaseLocalStorageDb",WO=1,Kh="firebaseLocalStorage",cA="fbase_key";class Pu{constructor(t){this.request=t}toPromise(){return new Promise((t,r)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function X0(e,t){return e.transaction([Kh],t?"readwrite":"readonly").objectStore(Kh)}function GO(){const e=indexedDB.deleteDatabase(lA);return new Pu(e).toPromise()}function lg(){const e=indexedDB.open(lA,WO);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{const n=e.result;try{n.createObjectStore(Kh,{keyPath:cA})}catch(i){r(i)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Kh)?t(n):(n.close(),await GO(),t(await lg()))})})}async function Dy(e,t,r){const n=X0(e,!0).put({[cA]:t,value:r});return new Pu(n).toPromise()}async function KO(e,t){const r=X0(e,!1).get(t),n=await new Pu(r).toPromise();return n===void 0?null:n.value}function Oy(e,t){const r=X0(e,!0).delete(t);return new Pu(r).toPromise()}const qO=800,XO=3;class uA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await lg(),this.db)}async _withRetries(t){let r=0;for(;;)try{const n=await this._openDb();return await t(n)}catch(n){if(r++>XO)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return oA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=q0._getInstance(zO()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await $O(),!this.activeServiceWorker)return;this.sender=new BO(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((t=n[0])===null||t===void 0)&&t.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||HO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await lg();return await Dy(t,Gh,"1"),await Oy(t,Gh),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Dy(n,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){const r=await this._withRetries(n=>KO(n,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Oy(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(i=>{const s=X0(i,!1).getAll();return new Pu(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;for(const{fbase_key:i,value:s}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),qO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}uA.type="LOCAL";const YO=uA;new Cu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QO(e,t){return t?Fi(t):(Fe(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv extends rv{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Po(t,this._buildIdpRequest())}_linkToIdToken(t,r){return Po(t,this._buildIdpRequest(r))}_getReauthenticationResolver(t){return Po(t,this._buildIdpRequest())}_buildIdpRequest(t){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(r.idToken=t),r}}function JO(e){return rA(e.auth,new sv(e),e.bypassAuthState)}function ZO(e){const{auth:t,user:r}=e;return Fe(r,t,"internal-error"),CO(r,new sv(e),e.bypassAuthState)}async function eL(e){const{auth:t,user:r}=e;return Fe(r,t,"internal-error"),IO(r,new sv(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(t,r,n,i,s=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(t,r)=>{this.pendingPromise={resolve:t,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(t){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=t;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return JO;case"linkViaPopup":case"linkViaRedirect":return eL;case"reauthViaPopup":case"reauthViaRedirect":return ZO;default:Qn(this.auth,"internal-error")}}resolve(t){$i(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){$i(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tL=new Cu(2e3,1e4);class xo extends fA{constructor(t,r,n,i,s){super(t,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,xo.currentPopupAction&&xo.currentPopupAction.cancel(),xo.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Fe(t,this.auth,"internal-error"),t}async onExecution(){$i(this.filter.length===1,"Popup operations only handle one event");const t=iv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(di(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(di(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xo.currentPopupAction=null}pollUserCancellation(){const t=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(di(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,tL.get())};t()}}xo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rL="pendingRedirect",sh=new Map;class nL extends fA{constructor(t,r,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let t=sh.get(this.auth._key());if(!t){try{const n=await iL(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(n)}catch(r){t=()=>Promise.reject(r)}sh.set(this.auth._key(),t)}return this.bypassAuthState||sh.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const r=await this.auth._redirectUserForId(t.eventId);if(r)return this.user=r,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function iL(e,t){const r=oL(t),n=aL(e);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function sL(e,t){sh.set(e._key(),t)}function aL(e){return Fi(e._redirectPersistence)}function oL(e){return ih(rL,e.config.apiKey,e.name)}async function lL(e,t,r=!1){const n=ll(e),i=QO(n,t),a=await new nL(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,t)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cL=10*60*1e3;class uL{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(r=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!fL(t)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=t,r=!0)),r}sendToConsumer(t,r){var n;if(t.error&&!hA(t)){const i=((n=t.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(di(this.auth,i))}else r.onAuthEvent(t)}isEventForConsumer(t,r){const n=r.eventId===null||!!t.eventId&&t.eventId===r.eventId;return r.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=cL&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ly(t))}saveEventToCache(t){this.cachedEventUids.add(Ly(t)),this.lastProcessedEventTime=Date.now()}}function Ly(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function hA({type:e,error:t}){return e==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function fL(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return hA(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hL(e,t={}){return ja(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dL=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,pL=/^https?/;async function mL(e){if(e.config.emulator)return;const{authorizedDomains:t}=await hL(e);for(const r of t)try{if(gL(r))return}catch{}Qn(e,"unauthorized-domain")}function gL(e){const t=og(),{protocol:r,hostname:n}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return a.hostname===""&&n===""?r==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!pL.test(r))return!1;if(dL.test(e))return n===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vL=new Cu(3e4,6e4);function by(){const e=pi().___jsl;if(e!=null&&e.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}}function _L(e){return new Promise((t,r)=>{var n,i,s;function a(){by(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{by(),r(di(e,"network-request-failed"))},timeout:vL.get()})}if(!((i=(n=pi().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)t(gapi.iframes.getContext());else if(!((s=pi().gapi)===null||s===void 0)&&s.load)a();else{const o=cO("iframefcb");return pi()[o]=()=>{gapi.load?a():r(di(e,"network-request-failed"))},Jk(`https://apis.google.com/js/api.js?onload=${o}`).catch(l=>r(l))}}).catch(t=>{throw ah=null,t})}let ah=null;function xL(e){return ah=ah||_L(e),ah}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yL=new Cu(5e3,15e3),EL="__/auth/iframe",wL="emulator/auth/iframe",TL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},kL=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function AL(e){const t=e.config;Fe(t.authDomain,e,"auth-domain-config-required");const r=t.emulator?Z1(t,wL):`https://${e.config.authDomain}/${EL}`,n={apiKey:t.apiKey,appName:e.name,v:Ba},i=kL.get(e.config.apiHost);i&&(n.eid=i);const s=e._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${Iu(n).slice(1)}`}async function SL(e){const t=await xL(e),r=pi().gapi;return Fe(r,e,"internal-error"),t.open({where:document.body,url:AL(e),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:TL,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=di(e,"network-request-failed"),o=pi().setTimeout(()=>{s(a)},yL.get());function l(){pi().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IL={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},CL=500,RL=600,PL="_blank",FL="http://localhost";class My{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function NL(e,t,r,n=CL,i=RL){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},IL),{width:n.toString(),height:i.toString(),top:s,left:a}),c=Dr().toLowerCase();r&&(o=Wk(c)?PL:r),zk(c)&&(t=t||FL,l.scrollbars="yes");const u=Object.entries(l).reduce((h,[d,m])=>`${h}${d}=${m},`,"");if(eO(c)&&o!=="_self")return DL(t||"",o),new My(null);const f=window.open(t||"",o,u);Fe(f,e,"popup-blocked");try{f.focus()}catch{}return new My(f)}function DL(e,t){const r=document.createElement("a");r.href=e,r.target=t;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OL="__/auth/handler",LL="emulator/auth/handler",bL=encodeURIComponent("fac");async function Vy(e,t,r,n,i,s){Fe(e.config.authDomain,e,"auth-domain-config-required"),Fe(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:n,v:Ba,eventId:i};if(t instanceof eA){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",T3(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,f]of Object.entries(s||{}))a[u]=f}if(t instanceof Ru){const u=t.getScopes().filter(f=>f!=="");u.length>0&&(a.scopes=u.join(","))}e.tenantId&&(a.tid=e.tenantId);const o=a;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await e._getAppCheckToken(),c=l?`#${bL}=${encodeURIComponent(l)}`:"";return`${ML(e)}?${Iu(o).slice(1)}${c}`}function ML({config:e}){return e.emulator?Z1(e,LL):`https://${e.authDomain}/${OL}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xp="webStorageSupport";class VL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=aA,this._completeRedirectFn=lL,this._overrideRedirectResult=sL}async _openPopup(t,r,n,i){var s;$i((s=this.eventManagers[t._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await Vy(t,r,n,og(),i);return NL(t,a,iv())}async _openRedirect(t,r,n,i){await this._originValidation(t);const s=await Vy(t,r,n,og(),i);return jO(s),new Promise(()=>{})}_initialize(t){const r=t._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):($i(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(t);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(t){const r=await SL(t),n=new uL(t);return r.register("authEvent",i=>(Fe(i==null?void 0:i.authEvent,t,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=r,n}_isIframeWebStorageSupported(t,r){this.iframes[t._key()].send(xp,{type:xp},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[xp];a!==void 0&&r(!!a),Qn(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const r=t._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=mL(t)),this.originValidationPromises[r]}get _shouldInitProactively(){return Yk()||tv()||K0()}}const UL=VL;var Uy="@firebase/auth",By="1.3.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BL{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const r=this.auth.onIdTokenChanged(n=>{t((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,r),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const r=this.internalListeners.get(t);r&&(this.internalListeners.delete(t),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jL(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function $L(e){Ca(new Vs("auth",(t,{options:r})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Fe(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Qk(e)},c=new oO(n,i,s,l);return gO(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,r,n)=>{t.getProvider("auth-internal").initialize()})),Ca(new Vs("auth-internal",t=>{const r=ll(t.getProvider("auth").getImmediate());return(n=>new BL(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),hi(Uy,By,jL(e)),hi(Uy,By,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HL=5*60,zL=Pk("authIdTokenMaxAge")||HL;let jy=null;const WL=e=>async t=>{const r=t&&await t.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>zL)return;const i=r==null?void 0:r.token;jy!==i&&(jy=i,await fetch(e,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function GL(e=Y1()){const t=W0(e,"auth");if(t.isInitialized())return t.getImmediate();const r=mO(e,{popupRedirectResolver:UL,persistence:[YO,VO,aA]}),n=Pk("authTokenSyncURL");if(n){const s=WL(n);DO(r,s,()=>s(r.currentUser)),NO(r,a=>s(a))}const i=Ik("auth");return i&&vO(r,`http://${i}`),r}$L("Browser");var KL="firebase",qL="10.5.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hi(KL,qL,"app");var XL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_e,av=av||{},De=XL||self;function Y0(e){var t=typeof e;return t=t!="object"?t:e?Array.isArray(e)?"array":t:"null",t=="array"||t=="object"&&typeof e.length=="number"}function Fu(e){var t=typeof e;return t=="object"&&e!=null||t=="function"}function YL(e){return Object.prototype.hasOwnProperty.call(e,yp)&&e[yp]||(e[yp]=++QL)}var yp="closure_uid_"+(1e9*Math.random()>>>0),QL=0;function JL(e,t,r){return e.call.apply(e.bind,arguments)}function ZL(e,t,r){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),e.apply(t,i)}}return function(){return e.apply(t,arguments)}}function Rr(e,t,r){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Rr=JL:Rr=ZL,Rr.apply(null,arguments)}function Tf(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var n=r.slice();return n.push.apply(n,arguments),e.apply(this,n)}}function ir(e,t){function r(){}r.prototype=t.prototype,e.$=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.ac=function(n,i,s){for(var a=Array(arguments.length-2),o=2;o<arguments.length;o++)a[o-2]=arguments[o];return t.prototype[i].apply(n,a)}}function qs(){this.s=this.s,this.o=this.o}var eb=0;qs.prototype.s=!1;qs.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),eb!=0)&&YL(this)};qs.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const dA=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(typeof e=="string")return typeof t!="string"||t.length!=1?-1:e.indexOf(t,0);for(let r=0;r<e.length;r++)if(r in e&&e[r]===t)return r;return-1};function ov(e){const t=e.length;if(0<t){const r=Array(t);for(let n=0;n<t;n++)r[n]=e[n];return r}return[]}function $y(e,t){for(let r=1;r<arguments.length;r++){const n=arguments[r];if(Y0(n)){const i=e.length||0,s=n.length||0;e.length=i+s;for(let a=0;a<s;a++)e[i+a]=n[a]}else e.push(n)}}function Pr(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Pr.prototype.h=function(){this.defaultPrevented=!0};var tb=function(){if(!De.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{De.addEventListener("test",()=>{},t),De.removeEventListener("test",()=>{},t)}catch{}return e}();function Yc(e){return/^[\s\xa0]*$/.test(e)}function Q0(){var e=De.navigator;return e&&(e=e.userAgent)?e:""}function si(e){return Q0().indexOf(e)!=-1}function lv(e){return lv[" "](e),e}lv[" "]=function(){};function rb(e,t){var r=qb;return Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=t(e)}var nb=si("Opera"),Wo=si("Trident")||si("MSIE"),pA=si("Edge"),cg=pA||Wo,mA=si("Gecko")&&!(Q0().toLowerCase().indexOf("webkit")!=-1&&!si("Edge"))&&!(si("Trident")||si("MSIE"))&&!si("Edge"),ib=Q0().toLowerCase().indexOf("webkit")!=-1&&!si("Edge");function gA(){var e=De.document;return e?e.documentMode:void 0}var ug;e:{var Ep="",wp=function(){var e=Q0();if(mA)return/rv:([^\);]+)(\)|;)/.exec(e);if(pA)return/Edge\/([\d\.]+)/.exec(e);if(Wo)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(ib)return/WebKit\/(\S+)/.exec(e);if(nb)return/(?:Version)[ \/]?(\S+)/.exec(e)}();if(wp&&(Ep=wp?wp[1]:""),Wo){var Tp=gA();if(Tp!=null&&Tp>parseFloat(Ep)){ug=String(Tp);break e}}ug=Ep}var fg;if(De.document&&Wo){var Hy=gA();fg=Hy||parseInt(ug,10)||void 0}else fg=void 0;var sb=fg;function Qc(e,t){if(Pr.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var r=this.type=e.type,n=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(mA){e:{try{lv(t.nodeName);var i=!0;break e}catch{}i=!1}i||(t=null)}}else r=="mouseover"?t=e.fromElement:r=="mouseout"&&(t=e.toElement);this.relatedTarget=t,n?(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=e.clientX!==void 0?e.clientX:e.pageX,this.clientY=e.clientY!==void 0?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=typeof e.pointerType=="string"?e.pointerType:ab[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Qc.$.h.call(this)}}ir(Qc,Pr);var ab={2:"touch",3:"pen",4:"mouse"};Qc.prototype.h=function(){Qc.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Nu="closure_listenable_"+(1e6*Math.random()|0),ob=0;function lb(e,t,r,n,i){this.listener=e,this.proxy=null,this.src=t,this.type=r,this.capture=!!n,this.la=i,this.key=++ob,this.fa=this.ia=!1}function J0(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function cv(e,t,r){for(const n in e)t.call(r,e[n],n,e)}function cb(e,t){for(const r in e)t.call(void 0,e[r],r,e)}function vA(e){const t={};for(const r in e)t[r]=e[r];return t}const zy="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _A(e,t){let r,n;for(let i=1;i<arguments.length;i++){n=arguments[i];for(r in n)e[r]=n[r];for(let s=0;s<zy.length;s++)r=zy[s],Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}}function Z0(e){this.src=e,this.g={},this.h=0}Z0.prototype.add=function(e,t,r,n,i){var s=e.toString();e=this.g[s],e||(e=this.g[s]=[],this.h++);var a=dg(e,t,n,i);return-1<a?(t=e[a],r||(t.ia=!1)):(t=new lb(t,this.src,s,!!n,i),t.ia=r,e.push(t)),t};function hg(e,t){var r=t.type;if(r in e.g){var n=e.g[r],i=dA(n,t),s;(s=0<=i)&&Array.prototype.splice.call(n,i,1),s&&(J0(t),e.g[r].length==0&&(delete e.g[r],e.h--))}}function dg(e,t,r,n){for(var i=0;i<e.length;++i){var s=e[i];if(!s.fa&&s.listener==t&&s.capture==!!r&&s.la==n)return i}return-1}var uv="closure_lm_"+(1e6*Math.random()|0),kp={};function xA(e,t,r,n,i){if(n&&n.once)return EA(e,t,r,n,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)xA(e,t[s],r,n,i);return null}return r=dv(r),e&&e[Nu]?e.O(t,r,Fu(n)?!!n.capture:!!n,i):yA(e,t,r,!1,n,i)}function yA(e,t,r,n,i,s){if(!t)throw Error("Invalid event type");var a=Fu(i)?!!i.capture:!!i,o=hv(e);if(o||(e[uv]=o=new Z0(e)),r=o.add(t,r,n,a,s),r.proxy)return r;if(n=ub(),r.proxy=n,n.src=e,n.listener=r,e.addEventListener)tb||(i=a),i===void 0&&(i=!1),e.addEventListener(t.toString(),n,i);else if(e.attachEvent)e.attachEvent(TA(t.toString()),n);else if(e.addListener&&e.removeListener)e.addListener(n);else throw Error("addEventListener and attachEvent are unavailable.");return r}function ub(){function e(r){return t.call(e.src,e.listener,r)}const t=fb;return e}function EA(e,t,r,n,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)EA(e,t[s],r,n,i);return null}return r=dv(r),e&&e[Nu]?e.P(t,r,Fu(n)?!!n.capture:!!n,i):yA(e,t,r,!0,n,i)}function wA(e,t,r,n,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)wA(e,t[s],r,n,i);else n=Fu(n)?!!n.capture:!!n,r=dv(r),e&&e[Nu]?(e=e.i,t=String(t).toString(),t in e.g&&(s=e.g[t],r=dg(s,r,n,i),-1<r&&(J0(s[r]),Array.prototype.splice.call(s,r,1),s.length==0&&(delete e.g[t],e.h--)))):e&&(e=hv(e))&&(t=e.g[t.toString()],e=-1,t&&(e=dg(t,r,n,i)),(r=-1<e?t[e]:null)&&fv(r))}function fv(e){if(typeof e!="number"&&e&&!e.fa){var t=e.src;if(t&&t[Nu])hg(t.i,e);else{var r=e.type,n=e.proxy;t.removeEventListener?t.removeEventListener(r,n,e.capture):t.detachEvent?t.detachEvent(TA(r),n):t.addListener&&t.removeListener&&t.removeListener(n),(r=hv(t))?(hg(r,e),r.h==0&&(r.src=null,t[uv]=null)):J0(e)}}}function TA(e){return e in kp?kp[e]:kp[e]="on"+e}function fb(e,t){if(e.fa)e=!0;else{t=new Qc(t,this);var r=e.listener,n=e.la||e.src;e.ia&&fv(e),e=r.call(n,t)}return e}function hv(e){return e=e[uv],e instanceof Z0?e:null}var Ap="__closure_events_fn_"+(1e9*Math.random()>>>0);function dv(e){return typeof e=="function"?e:(e[Ap]||(e[Ap]=function(t){return e.handleEvent(t)}),e[Ap])}function nr(){qs.call(this),this.i=new Z0(this),this.S=this,this.J=null}ir(nr,qs);nr.prototype[Nu]=!0;nr.prototype.removeEventListener=function(e,t,r,n){wA(this,e,t,r,n)};function hr(e,t){var r,n=e.J;if(n)for(r=[];n;n=n.J)r.push(n);if(e=e.S,n=t.type||t,typeof t=="string")t=new Pr(t,e);else if(t instanceof Pr)t.target=t.target||e;else{var i=t;t=new Pr(n,e),_A(t,i)}if(i=!0,r)for(var s=r.length-1;0<=s;s--){var a=t.g=r[s];i=kf(a,n,!0,t)&&i}if(a=t.g=e,i=kf(a,n,!0,t)&&i,i=kf(a,n,!1,t)&&i,r)for(s=0;s<r.length;s++)a=t.g=r[s],i=kf(a,n,!1,t)&&i}nr.prototype.N=function(){if(nr.$.N.call(this),this.i){var e=this.i,t;for(t in e.g){for(var r=e.g[t],n=0;n<r.length;n++)J0(r[n]);delete e.g[t],e.h--}}this.J=null};nr.prototype.O=function(e,t,r,n){return this.i.add(String(e),t,!1,r,n)};nr.prototype.P=function(e,t,r,n){return this.i.add(String(e),t,!0,r,n)};function kf(e,t,r,n){if(t=e.i.g[String(t)],!t)return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var a=t[s];if(a&&!a.fa&&a.capture==r){var o=a.listener,l=a.la||a.src;a.ia&&hg(e.i,a),i=o.call(l,n)!==!1&&i}}return i&&!n.defaultPrevented}var pv=De.JSON.stringify;class hb{constructor(t,r){this.i=t,this.j=r,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}function db(){var e=mv;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}class pb{constructor(){this.h=this.g=null}add(t,r){const n=kA.get();n.set(t,r),this.h?this.h.next=n:this.g=n,this.h=n}}var kA=new hb(()=>new mb,e=>e.reset());class mb{constructor(){this.next=this.g=this.h=null}set(t,r){this.h=t,this.g=r,this.next=null}reset(){this.next=this.g=this.h=null}}function gb(e){var t=1;e=e.split(":");const r=[];for(;0<t&&e.length;)r.push(e.shift()),t--;return e.length&&r.push(e.join(":")),r}function vb(e){De.setTimeout(()=>{throw e},0)}let Jc,Zc=!1,mv=new pb,AA=()=>{const e=De.Promise.resolve(void 0);Jc=()=>{e.then(_b)}};var _b=()=>{for(var e;e=db();){try{e.h.call(e.g)}catch(r){vb(r)}var t=kA;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Zc=!1};function ed(e,t){nr.call(this),this.h=e||1,this.g=t||De,this.j=Rr(this.qb,this),this.l=Date.now()}ir(ed,nr);_e=ed.prototype;_e.ga=!1;_e.T=null;_e.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),hr(this,"tick"),this.ga&&(gv(this),this.start()))}};_e.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function gv(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}_e.N=function(){ed.$.N.call(this),gv(this),delete this.g};function vv(e,t,r){if(typeof e=="function")r&&(e=Rr(e,r));else if(e&&typeof e.handleEvent=="function")e=Rr(e.handleEvent,e);else throw Error("Invalid listener argument");return 2147483647<Number(t)?-1:De.setTimeout(e,t||0)}function SA(e){e.g=vv(()=>{e.g=null,e.i&&(e.i=!1,SA(e))},e.j);const t=e.h;e.h=null,e.m.apply(null,t)}class xb extends qs{constructor(t,r){super(),this.m=t,this.j=r,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:SA(this)}N(){super.N(),this.g&&(De.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function eu(e){qs.call(this),this.h=e,this.g={}}ir(eu,qs);var Wy=[];function IA(e,t,r,n){Array.isArray(r)||(r&&(Wy[0]=r.toString()),r=Wy);for(var i=0;i<r.length;i++){var s=xA(t,r[i],n||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function CA(e){cv(e.g,function(t,r){this.g.hasOwnProperty(r)&&fv(t)},e),e.g={}}eu.prototype.N=function(){eu.$.N.call(this),CA(this)};eu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function td(){this.g=!0}td.prototype.Ea=function(){this.g=!1};function yb(e,t,r,n,i,s){e.info(function(){if(e.g)if(s)for(var a="",o=s.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var f=u.split("_");a=2<=f.length&&f[1]=="type"?a+(u+"="+c+"&"):a+(u+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+n+") [attempt "+i+"]: "+t+`
`+r+`
`+a})}function Eb(e,t,r,n,i,s,a){e.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+i+"]: "+t+`
`+r+`
`+s+" "+a})}function yo(e,t,r,n){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+Tb(e,r)+(n?" "+n:"")})}function wb(e,t){e.info(function(){return"TIMEOUT: "+t})}td.prototype.info=function(){};function Tb(e,t){if(!e.g)return t;if(!t)return null;try{var r=JSON.parse(t);if(r){for(e=0;e<r.length;e++)if(Array.isArray(r[e])){var n=r[e];if(!(2>n.length)){var i=n[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var a=1;a<i.length;a++)i[a]=""}}}}return pv(r)}catch{return t}}var $a={},Gy=null;function rd(){return Gy=Gy||new nr}$a.Ta="serverreachability";function RA(e){Pr.call(this,$a.Ta,e)}ir(RA,Pr);function tu(e){const t=rd();hr(t,new RA(t))}$a.STAT_EVENT="statevent";function PA(e,t){Pr.call(this,$a.STAT_EVENT,e),this.stat=t}ir(PA,Pr);function Hr(e){const t=rd();hr(t,new PA(t,e))}$a.Ua="timingevent";function FA(e,t){Pr.call(this,$a.Ua,e),this.size=t}ir(FA,Pr);function Du(e,t){if(typeof e!="function")throw Error("Fn must not be null and must be a function");return De.setTimeout(function(){e()},t)}var nd={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},NA={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function _v(){}_v.prototype.h=null;function Ky(e){return e.h||(e.h=e.i())}function DA(){}var Ou={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function xv(){Pr.call(this,"d")}ir(xv,Pr);function yv(){Pr.call(this,"c")}ir(yv,Pr);var pg;function id(){}ir(id,_v);id.prototype.g=function(){return new XMLHttpRequest};id.prototype.i=function(){return{}};pg=new id;function Lu(e,t,r,n){this.l=e,this.j=t,this.m=r,this.W=n||1,this.U=new eu(this),this.P=kb,e=cg?125:void 0,this.V=new ed(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new OA}function OA(){this.i=null,this.g="",this.h=!1}var kb=45e3,mg={},qh={};_e=Lu.prototype;_e.setTimeout=function(e){this.P=e};function gg(e,t,r){e.L=1,e.v=ad(Hi(t)),e.s=r,e.S=!0,LA(e,null)}function LA(e,t){e.G=Date.now(),bu(e),e.A=Hi(e.v);var r=e.A,n=e.W;Array.isArray(n)||(n=[String(n)]),HA(r.i,"t",n),e.C=0,r=e.l.J,e.h=new OA,e.g=uS(e.l,r?t:null,!e.s),0<e.O&&(e.M=new xb(Rr(e.Pa,e,e.g),e.O)),IA(e.U,e.g,"readystatechange",e.nb),t=e.I?vA(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),tu(),yb(e.j,e.u,e.A,e.m,e.W,e.s)}_e.nb=function(e){e=e.target;const t=this.M;t&&ai(e)==3?t.l():this.Pa(e)};_e.Pa=function(e){try{if(e==this.g)e:{const u=ai(this.g);var t=this.g.Ia();const f=this.g.da();if(!(3>u)&&(u!=3||cg||this.g&&(this.h.h||this.g.ja()||Qy(this.g)))){this.J||u!=4||t==7||(t==8||0>=f?tu(3):tu(2)),sd(this);var r=this.g.da();this.ca=r;t:if(bA(this)){var n=Qy(this.g);e="";var i=n.length,s=ai(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ua(this),fc(this);var a="";break t}this.h.i=new De.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(n[t],{stream:s&&t==i-1});n.splice(0,i),this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.ja();if(this.i=r==200,Eb(this.j,this.u,this.A,this.m,this.W,u,r),this.i){if(this.aa&&!this.K){t:{if(this.g){var o,l=this.g;if((o=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Yc(o)){var c=o;break t}}c=null}if(r=c)yo(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,vg(this,r);else{this.i=!1,this.o=3,Hr(12),ua(this),fc(this);break e}}this.S?(MA(this,u,a),cg&&this.i&&u==3&&(IA(this.U,this.V,"tick",this.mb),this.V.start())):(yo(this.j,this.m,a,null),vg(this,a)),u==4&&ua(this),this.i&&!this.J&&(u==4?aS(this.l,this):(this.i=!1,bu(this)))}else Wb(this.g),r==400&&0<a.indexOf("Unknown SID")?(this.o=3,Hr(12)):(this.o=0,Hr(13)),ua(this),fc(this)}}}catch{}finally{}};function bA(e){return e.g?e.u=="GET"&&e.L!=2&&e.l.Ha:!1}function MA(e,t,r){let n=!0,i;for(;!e.J&&e.C<r.length;)if(i=Ab(e,r),i==qh){t==4&&(e.o=4,Hr(14),n=!1),yo(e.j,e.m,null,"[Incomplete Response]");break}else if(i==mg){e.o=4,Hr(15),yo(e.j,e.m,r,"[Invalid Chunk]"),n=!1;break}else yo(e.j,e.m,i,null),vg(e,i);bA(e)&&i!=qh&&i!=mg&&(e.h.g="",e.C=0),t!=4||r.length!=0||e.h.h||(e.o=1,Hr(16),n=!1),e.i=e.i&&n,n?0<r.length&&!e.ba&&(e.ba=!0,t=e.l,t.g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+r.length),Sv(t),t.M=!0,Hr(11))):(yo(e.j,e.m,r,"[Invalid Chunked Response]"),ua(e),fc(e))}_e.mb=function(){if(this.g){var e=ai(this.g),t=this.g.ja();this.C<t.length&&(sd(this),MA(this,e,t),this.i&&e!=4&&bu(this))}};function Ab(e,t){var r=e.C,n=t.indexOf(`
`,r);return n==-1?qh:(r=Number(t.substring(r,n)),isNaN(r)?mg:(n+=1,n+r>t.length?qh:(t=t.slice(n,n+r),e.C=n+r,t)))}_e.cancel=function(){this.J=!0,ua(this)};function bu(e){e.Y=Date.now()+e.P,VA(e,e.P)}function VA(e,t){if(e.B!=null)throw Error("WatchDog timer not null");e.B=Du(Rr(e.lb,e),t)}function sd(e){e.B&&(De.clearTimeout(e.B),e.B=null)}_e.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(wb(this.j,this.A),this.L!=2&&(tu(),Hr(17)),ua(this),this.o=2,fc(this)):VA(this,this.Y-e)};function fc(e){e.l.H==0||e.J||aS(e.l,e)}function ua(e){sd(e);var t=e.M;t&&typeof t.sa=="function"&&t.sa(),e.M=null,gv(e.V),CA(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function vg(e,t){try{var r=e.l;if(r.H!=0&&(r.g==e||_g(r.i,e))){if(!e.K&&_g(r.i,e)&&r.H==3){try{var n=r.Ja.g.parse(t)}catch{n=null}if(Array.isArray(n)&&n.length==3){var i=n;if(i[0]==0){e:if(!r.u){if(r.g)if(r.g.G+3e3<e.G)Qh(r),cd(r);else break e;Av(r),Hr(18)}}else r.Fa=i[1],0<r.Fa-r.V&&37500>i[2]&&r.G&&r.A==0&&!r.v&&(r.v=Du(Rr(r.ib,r),6e3));if(1>=GA(r.i)&&r.oa){try{r.oa()}catch{}r.oa=void 0}}else fa(r,11)}else if((e.K||r.g==e)&&Qh(r),!Yc(t))for(i=r.Ja.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(r.V=c[0],c=c[1],r.H==2)if(c[0]=="c"){r.K=c[1],r.pa=c[2];const u=c[3];u!=null&&(r.ra=u,r.l.info("VER="+r.ra));const f=c[4];f!=null&&(r.Ga=f,r.l.info("SVER="+r.Ga));const h=c[5];h!=null&&typeof h=="number"&&0<h&&(n=1.5*h,r.L=n,r.l.info("backChannelRequestTimeoutMs_="+n)),n=r;const d=e.g;if(d){const m=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(m){var s=n.i;s.g||m.indexOf("spdy")==-1&&m.indexOf("quic")==-1&&m.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Ev(s,s.h),s.h=null))}if(n.F){const p=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;p&&(n.Da=p,ft(n.I,n.F,p))}}r.H=3,r.h&&r.h.Ba(),r.ca&&(r.S=Date.now()-e.G,r.l.info("Handshake RTT: "+r.S+"ms")),n=r;var a=e;if(n.wa=cS(n,n.J?n.pa:null,n.Y),a.K){KA(n.i,a);var o=a,l=n.L;l&&o.setTimeout(l),o.B&&(sd(o),bu(o)),n.g=a}else iS(n);0<r.j.length&&ud(r)}else c[0]!="stop"&&c[0]!="close"||fa(r,7);else r.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?fa(r,7):kv(r):c[0]!="noop"&&r.h&&r.h.Aa(c),r.A=0)}}tu(4)}catch{}}function Sb(e){if(e.Z&&typeof e.Z=="function")return e.Z();if(typeof Map<"u"&&e instanceof Map||typeof Set<"u"&&e instanceof Set)return Array.from(e.values());if(typeof e=="string")return e.split("");if(Y0(e)){for(var t=[],r=e.length,n=0;n<r;n++)t.push(e[n]);return t}t=[],r=0;for(n in e)t[r++]=e[n];return t}function Ib(e){if(e.ta&&typeof e.ta=="function")return e.ta();if(!e.Z||typeof e.Z!="function"){if(typeof Map<"u"&&e instanceof Map)return Array.from(e.keys());if(!(typeof Set<"u"&&e instanceof Set)){if(Y0(e)||typeof e=="string"){var t=[];e=e.length;for(var r=0;r<e;r++)t.push(r);return t}t=[],r=0;for(const n in e)t[r++]=n;return t}}}function UA(e,t){if(e.forEach&&typeof e.forEach=="function")e.forEach(t,void 0);else if(Y0(e)||typeof e=="string")Array.prototype.forEach.call(e,t,void 0);else for(var r=Ib(e),n=Sb(e),i=n.length,s=0;s<i;s++)t.call(void 0,n[s],r&&r[s],e)}var BA=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Cb(e,t){if(e){e=e.split("&");for(var r=0;r<e.length;r++){var n=e[r].indexOf("="),i=null;if(0<=n){var s=e[r].substring(0,n);i=e[r].substring(n+1)}else s=e[r];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function _a(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof _a){this.h=e.h,Xh(this,e.j),this.s=e.s,this.g=e.g,Yh(this,e.m),this.l=e.l;var t=e.i,r=new ru;r.i=t.i,t.g&&(r.g=new Map(t.g),r.h=t.h),qy(this,r),this.o=e.o}else e&&(t=String(e).match(BA))?(this.h=!1,Xh(this,t[1]||"",!0),this.s=Wl(t[2]||""),this.g=Wl(t[3]||"",!0),Yh(this,t[4]),this.l=Wl(t[5]||"",!0),qy(this,t[6]||"",!0),this.o=Wl(t[7]||"")):(this.h=!1,this.i=new ru(null,this.h))}_a.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Gl(t,Xy,!0),":");var r=this.g;return(r||t=="file")&&(e.push("//"),(t=this.s)&&e.push(Gl(t,Xy,!0),"@"),e.push(encodeURIComponent(String(r)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),r=this.m,r!=null&&e.push(":",String(r))),(r=this.l)&&(this.g&&r.charAt(0)!="/"&&e.push("/"),e.push(Gl(r,r.charAt(0)=="/"?Fb:Pb,!0))),(r=this.i.toString())&&e.push("?",r),(r=this.o)&&e.push("#",Gl(r,Db)),e.join("")};function Hi(e){return new _a(e)}function Xh(e,t,r){e.j=r?Wl(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Yh(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function qy(e,t,r){t instanceof ru?(e.i=t,Ob(e.i,e.h)):(r||(t=Gl(t,Nb)),e.i=new ru(t,e.h))}function ft(e,t,r){e.i.set(t,r)}function ad(e){return ft(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Wl(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Gl(e,t,r){return typeof e=="string"?(e=encodeURI(e).replace(t,Rb),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Rb(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)}var Xy=/[#\/\?@]/g,Pb=/[#\?:]/g,Fb=/[#\?]/g,Nb=/[#\?@]/g,Db=/#/g;function ru(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Xs(e){e.g||(e.g=new Map,e.h=0,e.i&&Cb(e.i,function(t,r){e.add(decodeURIComponent(t.replace(/\+/g," ")),r)}))}_e=ru.prototype;_e.add=function(e,t){Xs(this),this.i=null,e=ul(this,e);var r=this.g.get(e);return r||this.g.set(e,r=[]),r.push(t),this.h+=1,this};function jA(e,t){Xs(e),t=ul(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function $A(e,t){return Xs(e),t=ul(e,t),e.g.has(t)}_e.forEach=function(e,t){Xs(this),this.g.forEach(function(r,n){r.forEach(function(i){e.call(t,i,n,this)},this)},this)};_e.ta=function(){Xs(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),r=[];for(let n=0;n<t.length;n++){const i=e[n];for(let s=0;s<i.length;s++)r.push(t[n])}return r};_e.Z=function(e){Xs(this);let t=[];if(typeof e=="string")$A(this,e)&&(t=t.concat(this.g.get(ul(this,e))));else{e=Array.from(this.g.values());for(let r=0;r<e.length;r++)t=t.concat(e[r])}return t};_e.set=function(e,t){return Xs(this),this.i=null,e=ul(this,e),$A(this,e)&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this};_e.get=function(e,t){return e?(e=this.Z(e),0<e.length?String(e[0]):t):t};function HA(e,t,r){jA(e,t),0<r.length&&(e.i=null,e.g.set(ul(e,t),ov(r)),e.h+=r.length)}_e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var r=0;r<t.length;r++){var n=t[r];const s=encodeURIComponent(String(n)),a=this.Z(n);for(n=0;n<a.length;n++){var i=s;a[n]!==""&&(i+="="+encodeURIComponent(String(a[n]))),e.push(i)}}return this.i=e.join("&")};function ul(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Ob(e,t){t&&!e.j&&(Xs(e),e.i=null,e.g.forEach(function(r,n){var i=n.toLowerCase();n!=i&&(jA(this,n),HA(this,i,r))},e)),e.j=t}var Lb=class{constructor(e,t){this.g=e,this.map=t}};function zA(e){this.l=e||bb,De.PerformanceNavigationTiming?(e=De.performance.getEntriesByType("navigation"),e=0<e.length&&(e[0].nextHopProtocol=="hq"||e[0].nextHopProtocol=="h2")):e=!!(De.g&&De.g.Ka&&De.g.Ka()&&De.g.Ka().dc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var bb=10;function WA(e){return e.h?!0:e.g?e.g.size>=e.j:!1}function GA(e){return e.h?1:e.g?e.g.size:0}function _g(e,t){return e.h?e.h==t:e.g?e.g.has(t):!1}function Ev(e,t){e.g?e.g.add(t):e.h=t}function KA(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}zA.prototype.cancel=function(){if(this.i=qA(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const e of this.g.values())e.cancel();this.g.clear()}};function qA(e){if(e.h!=null)return e.i.concat(e.h.F);if(e.g!=null&&e.g.size!==0){let t=e.i;for(const r of e.g.values())t=t.concat(r.F);return t}return ov(e.i)}var Mb=class{stringify(e){return De.JSON.stringify(e,void 0)}parse(e){return De.JSON.parse(e,void 0)}};function Vb(){this.g=new Mb}function Ub(e,t,r){const n=r||"";try{UA(e,function(i,s){let a=i;Fu(i)&&(a=pv(i)),t.push(n+s+"="+encodeURIComponent(a))})}catch(i){throw t.push(n+"type="+encodeURIComponent("_badmap")),i}}function Bb(e,t){const r=new td;if(De.Image){const n=new Image;n.onload=Tf(Af,r,n,"TestLoadImage: loaded",!0,t),n.onerror=Tf(Af,r,n,"TestLoadImage: error",!1,t),n.onabort=Tf(Af,r,n,"TestLoadImage: abort",!1,t),n.ontimeout=Tf(Af,r,n,"TestLoadImage: timeout",!1,t),De.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=e}else t(!1)}function Af(e,t,r,n,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(n)}catch{}}function Mu(e){this.l=e.ec||null,this.j=e.ob||!1}ir(Mu,_v);Mu.prototype.g=function(){return new od(this.l,this.j)};Mu.prototype.i=function(e){return function(){return e}}({});function od(e,t){nr.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=wv,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ir(od,nr);var wv=0;_e=od.prototype;_e.open=function(e,t){if(this.readyState!=wv)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,nu(this)};_e.send=function(e){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||De).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))};_e.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Vu(this)),this.readyState=wv};_e.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,nu(this)),this.g&&(this.readyState=3,nu(this),this.g)))if(this.responseType==="arraybuffer")e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof De.ReadableStream<"u"&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;XA(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))};function XA(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}_e.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Vu(this):nu(this),this.readyState==3&&XA(this)}};_e.Za=function(e){this.g&&(this.response=this.responseText=e,Vu(this))};_e.Ya=function(e){this.g&&(this.response=e,Vu(this))};_e.ka=function(){this.g&&Vu(this)};function Vu(e){e.readyState=4,e.l=null,e.j=null,e.A=null,nu(e)}_e.setRequestHeader=function(e,t){this.v.append(e,t)};_e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""};_e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var r=t.next();!r.done;)r=r.value,e.push(r[0]+": "+r[1]),r=t.next();return e.join(`\r
`)};function nu(e){e.onreadystatechange&&e.onreadystatechange.call(e)}Object.defineProperty(od.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(e){this.m=e?"include":"same-origin"}});var jb=De.JSON.parse;function Ct(e){nr.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=YA,this.L=this.M=!1}ir(Ct,nr);var YA="",$b=/^https?$/i,Hb=["POST","PUT"];_e=Ct.prototype;_e.Oa=function(e){this.M=e};_e.ha=function(e,t,r,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():pg.g(),this.C=this.u?Ky(this.u):Ky(pg),this.g.onreadystatechange=Rr(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(s){Yy(this,s);return}if(e=r||"",r=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var i in n)r.set(i,n[i]);else if(typeof n.keys=="function"&&typeof n.get=="function")for(const s of n.keys())r.set(s,n.get(s));else throw Error("Unknown input type for opt_headers: "+String(n));n=Array.from(r.keys()).find(s=>s.toLowerCase()=="content-type"),i=De.FormData&&e instanceof De.FormData,!(0<=dA(Hb,t))||n||i||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of r)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{ZA(this),0<this.B&&((this.L=zb(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Rr(this.ua,this)):this.A=vv(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){Yy(this,s)}};function zb(e){return Wo&&typeof e.timeout=="number"&&e.ontimeout!==void 0}_e.ua=function(){typeof av<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,hr(this,"timeout"),this.abort(8))};function Yy(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,QA(e),ld(e)}function QA(e){e.F||(e.F=!0,hr(e,"complete"),hr(e,"error"))}_e.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,hr(this,"complete"),hr(this,"abort"),ld(this))};_e.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ld(this,!0)),Ct.$.N.call(this)};_e.La=function(){this.s||(this.G||this.v||this.l?JA(this):this.kb())};_e.kb=function(){JA(this)};function JA(e){if(e.h&&typeof av<"u"&&(!e.C[1]||ai(e)!=4||e.da()!=2)){if(e.v&&ai(e)==4)vv(e.La,0,e);else if(hr(e,"readystatechange"),ai(e)==4){e.h=!1;try{const a=e.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var r;if(!(r=t)){var n;if(n=a===0){var i=String(e.I).match(BA)[1]||null;!i&&De.self&&De.self.location&&(i=De.self.location.protocol.slice(0,-1)),n=!$b.test(i?i.toLowerCase():"")}r=n}if(r)hr(e,"complete"),hr(e,"success");else{e.m=6;try{var s=2<ai(e)?e.g.statusText:""}catch{s=""}e.j=s+" ["+e.da()+"]",QA(e)}}finally{ld(e)}}}}function ld(e,t){if(e.g){ZA(e);const r=e.g,n=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||hr(e,"ready");try{r.onreadystatechange=n}catch{}}}function ZA(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(De.clearTimeout(e.A),e.A=null)}_e.isActive=function(){return!!this.g};function ai(e){return e.g?e.g.readyState:0}_e.da=function(){try{return 2<ai(this)?this.g.status:-1}catch{return-1}};_e.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};_e.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&t.indexOf(e)==0&&(t=t.substring(e.length)),jb(t)}};function Qy(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case YA:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}function Wb(e){const t={};e=(e.g&&2<=ai(e)&&e.g.getAllResponseHeaders()||"").split(`\r
`);for(let n=0;n<e.length;n++){if(Yc(e[n]))continue;var r=gb(e[n]);const i=r[0];if(r=r[1],typeof r!="string")continue;r=r.trim();const s=t[i]||[];t[i]=s,s.push(r)}cb(t,function(n){return n.join(", ")})}_e.Ia=function(){return this.m};_e.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function eS(e){let t="";return cv(e,function(r,n){t+=n,t+=":",t+=r,t+=`\r
`}),t}function Tv(e,t,r){e:{for(n in r){var n=!1;break e}n=!0}n||(r=eS(r),typeof e=="string"?r!=null&&encodeURIComponent(String(r)):ft(e,t,r))}function Dl(e,t,r){return r&&r.internalChannelParams&&r.internalChannelParams[e]||t}function tS(e){this.Ga=0,this.j=[],this.l=new td,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Dl("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Dl("baseRetryDelayMs",5e3,e),this.hb=Dl("retryDelaySeedMs",1e4,e),this.eb=Dl("forwardChannelMaxRetries",2,e),this.xa=Dl("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new zA(e&&e.concurrentRequestLimit),this.Ja=new Vb,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}_e=tS.prototype;_e.ra=8;_e.H=1;function kv(e){if(rS(e),e.H==3){var t=e.W++,r=Hi(e.I);if(ft(r,"SID",e.K),ft(r,"RID",t),ft(r,"TYPE","terminate"),Uu(e,r),t=new Lu(e,e.l,t),t.L=2,t.v=ad(Hi(r)),r=!1,De.navigator&&De.navigator.sendBeacon)try{r=De.navigator.sendBeacon(t.v.toString(),"")}catch{}!r&&De.Image&&(new Image().src=t.v,r=!0),r||(t.g=uS(t.l,null),t.g.ha(t.v)),t.G=Date.now(),bu(t)}lS(e)}function cd(e){e.g&&(Sv(e),e.g.cancel(),e.g=null)}function rS(e){cd(e),e.u&&(De.clearTimeout(e.u),e.u=null),Qh(e),e.i.cancel(),e.m&&(typeof e.m=="number"&&De.clearTimeout(e.m),e.m=null)}function ud(e){if(!WA(e.i)&&!e.m){e.m=!0;var t=e.Na;Jc||AA(),Zc||(Jc(),Zc=!0),mv.add(t,e),e.C=0}}function Gb(e,t){return GA(e.i)>=e.i.j-(e.m?1:0)?!1:e.m?(e.j=t.F.concat(e.j),!0):e.H==1||e.H==2||e.C>=(e.cb?0:e.eb)?!1:(e.m=Du(Rr(e.Na,e,t),oS(e,e.C)),e.C++,!0)}_e.Na=function(e){if(this.m)if(this.m=null,this.H==1){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const i=new Lu(this,this.l,e);let s=this.s;if(this.U&&(s?(s=vA(s),_A(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var t=0,r=0;r<this.j.length;r++){t:{var n=this.j[r];if("__data__"in n.map&&(n=n.map.__data__,typeof n=="string")){n=n.length;break t}n=void 0}if(n===void 0)break;if(t+=n,4096<t){t=r;break e}if(t===4096||r===this.j.length-1){t=r+1;break e}}t=1e3}else t=1e3;t=nS(this,i,t),r=Hi(this.I),ft(r,"RID",e),ft(r,"CVER",22),this.F&&ft(r,"X-HTTP-Session-Id",this.F),Uu(this,r),s&&(this.O?t="headers="+encodeURIComponent(String(eS(s)))+"&"+t:this.o&&Tv(r,this.o,s)),Ev(this.i,i),this.bb&&ft(r,"TYPE","init"),this.P?(ft(r,"$req",t),ft(r,"SID","null"),i.aa=!0,gg(i,r,null)):gg(i,r,t),this.H=2}}else this.H==3&&(e?Jy(this,e):this.j.length==0||WA(this.i)||Jy(this))};function Jy(e,t){var r;t?r=t.m:r=e.W++;const n=Hi(e.I);ft(n,"SID",e.K),ft(n,"RID",r),ft(n,"AID",e.V),Uu(e,n),e.o&&e.s&&Tv(n,e.o,e.s),r=new Lu(e,e.l,r,e.C+1),e.o===null&&(r.I=e.s),t&&(e.j=t.F.concat(e.j)),t=nS(e,r,1e3),r.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),Ev(e.i,r),gg(r,n,t)}function Uu(e,t){e.na&&cv(e.na,function(r,n){ft(t,n,r)}),e.h&&UA({},function(r,n){ft(t,n,r)})}function nS(e,t,r){r=Math.min(e.j.length,r);var n=e.h?Rr(e.h.Va,e.h,e):null;e:{var i=e.j;let s=-1;for(;;){const a=["count="+r];s==-1?0<r?(s=i[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let o=!0;for(let l=0;l<r;l++){let c=i[l].g;const u=i[l].map;if(c-=s,0>c)s=Math.max(0,i[l].g-100),o=!1;else try{Ub(u,a,"req"+c+"_")}catch{n&&n(u)}}if(o){n=a.join("&");break e}}}return e=e.j.splice(0,r),t.F=e,n}function iS(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Jc||AA(),Zc||(Jc(),Zc=!0),mv.add(t,e),e.A=0}}function Av(e){return e.g||e.u||3<=e.A?!1:(e.ba++,e.u=Du(Rr(e.Ma,e),oS(e,e.A)),e.A++,!0)}_e.Ma=function(){if(this.u=null,sS(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=Du(Rr(this.jb,this),e)}};_e.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Hr(10),cd(this),sS(this))};function Sv(e){e.B!=null&&(De.clearTimeout(e.B),e.B=null)}function sS(e){e.g=new Lu(e,e.l,"rpc",e.ba),e.o===null&&(e.g.I=e.s),e.g.O=0;var t=Hi(e.wa);ft(t,"RID","rpc"),ft(t,"SID",e.K),ft(t,"AID",e.V),ft(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&ft(t,"TO",e.qa),ft(t,"TYPE","xmlhttp"),Uu(e,t),e.o&&e.s&&Tv(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var r=e.g;e=e.pa,r.L=1,r.v=ad(Hi(t)),r.s=null,r.S=!0,LA(r,e)}_e.ib=function(){this.v!=null&&(this.v=null,cd(this),Av(this),Hr(19))};function Qh(e){e.v!=null&&(De.clearTimeout(e.v),e.v=null)}function aS(e,t){var r=null;if(e.g==t){Qh(e),Sv(e),e.g=null;var n=2}else if(_g(e.i,t))r=t.F,KA(e.i,t),n=1;else return;if(e.H!=0){if(t.i)if(n==1){r=t.s?t.s.length:0,t=Date.now()-t.G;var i=e.C;n=rd(),hr(n,new FA(n,r)),ud(e)}else iS(e);else if(i=t.o,i==3||i==0&&0<t.ca||!(n==1&&Gb(e,t)||n==2&&Av(e)))switch(r&&0<r.length&&(t=e.i,t.i=t.i.concat(r)),i){case 1:fa(e,5);break;case 4:fa(e,10);break;case 3:fa(e,6);break;default:fa(e,2)}}}function oS(e,t){let r=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(r*=2),r*t}function fa(e,t){if(e.l.info("Error code "+t),t==2){var r=null;e.h&&(r=null);var n=Rr(e.pb,e);r||(r=new _a("//www.google.com/images/cleardot.gif"),De.location&&De.location.protocol=="http"||Xh(r,"https"),ad(r)),Bb(r.toString(),n)}else Hr(2);e.H=0,e.h&&e.h.za(t),lS(e),rS(e)}_e.pb=function(e){e?(this.l.info("Successfully pinged google.com"),Hr(2)):(this.l.info("Failed to ping google.com"),Hr(1))};function lS(e){if(e.H=0,e.ma=[],e.h){const t=qA(e.i);(t.length!=0||e.j.length!=0)&&($y(e.ma,t),$y(e.ma,e.j),e.i.i.length=0,ov(e.j),e.j.length=0),e.h.ya()}}function cS(e,t,r){var n=r instanceof _a?Hi(r):new _a(r);if(n.g!="")t&&(n.g=t+"."+n.g),Yh(n,n.m);else{var i=De.location;n=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new _a(null);n&&Xh(s,n),t&&(s.g=t),i&&Yh(s,i),r&&(s.l=r),n=s}return r=e.F,t=e.Da,r&&t&&ft(n,r,t),ft(n,"VER",e.ra),Uu(e,n),n}function uS(e,t,r){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return t=r&&e.Ha&&!e.va?new Ct(new Mu({ob:!0})):new Ct(e.va),t.Oa(e.J),t}_e.isActive=function(){return!!this.h&&this.h.isActive(this)};function fS(){}_e=fS.prototype;_e.Ba=function(){};_e.Aa=function(){};_e.za=function(){};_e.ya=function(){};_e.isActive=function(){return!0};_e.Va=function(){};function Jh(){if(Wo&&!(10<=Number(sb)))throw Error("Environmental error: no available transport.")}Jh.prototype.g=function(e,t){return new _n(e,t)};function _n(e,t){nr.call(this),this.g=new tS(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!Yc(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Yc(t)&&(this.g.F=t,e=this.h,e!==null&&t in e&&(e=this.h,t in e&&delete e[t])),this.j=new fl(this)}ir(_n,nr);_n.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,r=this.h||void 0;Hr(0),e.Y=t,e.na=r||{},e.G=e.aa,e.I=cS(e,null,e.Y),ud(e)};_n.prototype.close=function(){kv(this.g)};_n.prototype.u=function(e){var t=this.g;if(typeof e=="string"){var r={};r.__data__=e,e=r}else this.v&&(r={},r.__data__=pv(e),e=r);t.j.push(new Lb(t.fb++,e)),t.H==3&&ud(t)};_n.prototype.N=function(){this.g.h=null,delete this.j,kv(this.g),delete this.g,_n.$.N.call(this)};function hS(e){xv.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const r in t){e=r;break e}e=void 0}(this.i=e)&&(e=this.i,t=t!==null&&e in t?t[e]:void 0),this.data=t}else this.data=e}ir(hS,xv);function dS(){yv.call(this),this.status=1}ir(dS,yv);function fl(e){this.g=e}ir(fl,fS);fl.prototype.Ba=function(){hr(this.g,"a")};fl.prototype.Aa=function(e){hr(this.g,new hS(e))};fl.prototype.za=function(e){hr(this.g,new dS)};fl.prototype.ya=function(){hr(this.g,"b")};function Kb(){this.blockSize=-1}function Jn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}ir(Jn,Kb);Jn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Sp(e,t,r){r||(r=0);var n=Array(16);if(typeof t=="string")for(var i=0;16>i;++i)n[i]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(i=0;16>i;++i)n[i]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],i=e.g[2];var s=e.g[3],a=t+(s^r&(i^s))+n[0]+3614090360&4294967295;t=r+(a<<7&4294967295|a>>>25),a=s+(i^t&(r^i))+n[1]+3905402710&4294967295,s=t+(a<<12&4294967295|a>>>20),a=i+(r^s&(t^r))+n[2]+606105819&4294967295,i=s+(a<<17&4294967295|a>>>15),a=r+(t^i&(s^t))+n[3]+3250441966&4294967295,r=i+(a<<22&4294967295|a>>>10),a=t+(s^r&(i^s))+n[4]+4118548399&4294967295,t=r+(a<<7&4294967295|a>>>25),a=s+(i^t&(r^i))+n[5]+1200080426&4294967295,s=t+(a<<12&4294967295|a>>>20),a=i+(r^s&(t^r))+n[6]+2821735955&4294967295,i=s+(a<<17&4294967295|a>>>15),a=r+(t^i&(s^t))+n[7]+4249261313&4294967295,r=i+(a<<22&4294967295|a>>>10),a=t+(s^r&(i^s))+n[8]+1770035416&4294967295,t=r+(a<<7&4294967295|a>>>25),a=s+(i^t&(r^i))+n[9]+2336552879&4294967295,s=t+(a<<12&4294967295|a>>>20),a=i+(r^s&(t^r))+n[10]+4294925233&4294967295,i=s+(a<<17&4294967295|a>>>15),a=r+(t^i&(s^t))+n[11]+2304563134&4294967295,r=i+(a<<22&4294967295|a>>>10),a=t+(s^r&(i^s))+n[12]+1804603682&4294967295,t=r+(a<<7&4294967295|a>>>25),a=s+(i^t&(r^i))+n[13]+4254626195&4294967295,s=t+(a<<12&4294967295|a>>>20),a=i+(r^s&(t^r))+n[14]+2792965006&4294967295,i=s+(a<<17&4294967295|a>>>15),a=r+(t^i&(s^t))+n[15]+1236535329&4294967295,r=i+(a<<22&4294967295|a>>>10),a=t+(i^s&(r^i))+n[1]+4129170786&4294967295,t=r+(a<<5&4294967295|a>>>27),a=s+(r^i&(t^r))+n[6]+3225465664&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^r&(s^t))+n[11]+643717713&4294967295,i=s+(a<<14&4294967295|a>>>18),a=r+(s^t&(i^s))+n[0]+3921069994&4294967295,r=i+(a<<20&4294967295|a>>>12),a=t+(i^s&(r^i))+n[5]+3593408605&4294967295,t=r+(a<<5&4294967295|a>>>27),a=s+(r^i&(t^r))+n[10]+38016083&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^r&(s^t))+n[15]+3634488961&4294967295,i=s+(a<<14&4294967295|a>>>18),a=r+(s^t&(i^s))+n[4]+3889429448&4294967295,r=i+(a<<20&4294967295|a>>>12),a=t+(i^s&(r^i))+n[9]+568446438&4294967295,t=r+(a<<5&4294967295|a>>>27),a=s+(r^i&(t^r))+n[14]+3275163606&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^r&(s^t))+n[3]+4107603335&4294967295,i=s+(a<<14&4294967295|a>>>18),a=r+(s^t&(i^s))+n[8]+1163531501&4294967295,r=i+(a<<20&4294967295|a>>>12),a=t+(i^s&(r^i))+n[13]+2850285829&4294967295,t=r+(a<<5&4294967295|a>>>27),a=s+(r^i&(t^r))+n[2]+4243563512&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^r&(s^t))+n[7]+1735328473&4294967295,i=s+(a<<14&4294967295|a>>>18),a=r+(s^t&(i^s))+n[12]+2368359562&4294967295,r=i+(a<<20&4294967295|a>>>12),a=t+(r^i^s)+n[5]+4294588738&4294967295,t=r+(a<<4&4294967295|a>>>28),a=s+(t^r^i)+n[8]+2272392833&4294967295,s=t+(a<<11&4294967295|a>>>21),a=i+(s^t^r)+n[11]+1839030562&4294967295,i=s+(a<<16&4294967295|a>>>16),a=r+(i^s^t)+n[14]+4259657740&4294967295,r=i+(a<<23&4294967295|a>>>9),a=t+(r^i^s)+n[1]+2763975236&4294967295,t=r+(a<<4&4294967295|a>>>28),a=s+(t^r^i)+n[4]+1272893353&4294967295,s=t+(a<<11&4294967295|a>>>21),a=i+(s^t^r)+n[7]+4139469664&4294967295,i=s+(a<<16&4294967295|a>>>16),a=r+(i^s^t)+n[10]+3200236656&4294967295,r=i+(a<<23&4294967295|a>>>9),a=t+(r^i^s)+n[13]+681279174&4294967295,t=r+(a<<4&4294967295|a>>>28),a=s+(t^r^i)+n[0]+3936430074&4294967295,s=t+(a<<11&4294967295|a>>>21),a=i+(s^t^r)+n[3]+3572445317&4294967295,i=s+(a<<16&4294967295|a>>>16),a=r+(i^s^t)+n[6]+76029189&4294967295,r=i+(a<<23&4294967295|a>>>9),a=t+(r^i^s)+n[9]+3654602809&4294967295,t=r+(a<<4&4294967295|a>>>28),a=s+(t^r^i)+n[12]+3873151461&4294967295,s=t+(a<<11&4294967295|a>>>21),a=i+(s^t^r)+n[15]+530742520&4294967295,i=s+(a<<16&4294967295|a>>>16),a=r+(i^s^t)+n[2]+3299628645&4294967295,r=i+(a<<23&4294967295|a>>>9),a=t+(i^(r|~s))+n[0]+4096336452&4294967295,t=r+(a<<6&4294967295|a>>>26),a=s+(r^(t|~i))+n[7]+1126891415&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~r))+n[14]+2878612391&4294967295,i=s+(a<<15&4294967295|a>>>17),a=r+(s^(i|~t))+n[5]+4237533241&4294967295,r=i+(a<<21&4294967295|a>>>11),a=t+(i^(r|~s))+n[12]+1700485571&4294967295,t=r+(a<<6&4294967295|a>>>26),a=s+(r^(t|~i))+n[3]+2399980690&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~r))+n[10]+4293915773&4294967295,i=s+(a<<15&4294967295|a>>>17),a=r+(s^(i|~t))+n[1]+2240044497&4294967295,r=i+(a<<21&4294967295|a>>>11),a=t+(i^(r|~s))+n[8]+1873313359&4294967295,t=r+(a<<6&4294967295|a>>>26),a=s+(r^(t|~i))+n[15]+4264355552&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~r))+n[6]+2734768916&4294967295,i=s+(a<<15&4294967295|a>>>17),a=r+(s^(i|~t))+n[13]+1309151649&4294967295,r=i+(a<<21&4294967295|a>>>11),a=t+(i^(r|~s))+n[4]+4149444226&4294967295,t=r+(a<<6&4294967295|a>>>26),a=s+(r^(t|~i))+n[11]+3174756917&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~r))+n[2]+718787259&4294967295,i=s+(a<<15&4294967295|a>>>17),a=r+(s^(i|~t))+n[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}Jn.prototype.j=function(e,t){t===void 0&&(t=e.length);for(var r=t-this.blockSize,n=this.m,i=this.h,s=0;s<t;){if(i==0)for(;s<=r;)Sp(this,e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(n[i++]=e.charCodeAt(s++),i==this.blockSize){Sp(this,n),i=0;break}}else for(;s<t;)if(n[i++]=e[s++],i==this.blockSize){Sp(this,n),i=0;break}}this.h=i,this.i+=t};Jn.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var r=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=r&255,r/=256;for(this.j(e),e=Array(16),t=r=0;4>t;++t)for(var n=0;32>n;n+=8)e[r++]=this.g[t]>>>n&255;return e};function nt(e,t){this.h=t;for(var r=[],n=!0,i=e.length-1;0<=i;i--){var s=e[i]|0;n&&s==t||(r[i]=s,n=!1)}this.g=r}var qb={};function Iv(e){return-128<=e&&128>e?rb(e,function(t){return new nt([t|0],0>t?-1:0)}):new nt([e|0],0>e?-1:0)}function oi(e){if(isNaN(e)||!isFinite(e))return Fo;if(0>e)return cr(oi(-e));for(var t=[],r=1,n=0;e>=r;n++)t[n]=e/r|0,r*=xg;return new nt(t,0)}function pS(e,t){if(e.length==0)throw Error("number format error: empty string");if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(e.charAt(0)=="-")return cr(pS(e.substring(1),t));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=oi(Math.pow(t,8)),n=Fo,i=0;i<e.length;i+=8){var s=Math.min(8,e.length-i),a=parseInt(e.substring(i,i+s),t);8>s?(s=oi(Math.pow(t,s)),n=n.R(s).add(oi(a))):(n=n.R(r),n=n.add(oi(a)))}return n}var xg=4294967296,Fo=Iv(0),yg=Iv(1),Zy=Iv(16777216);_e=nt.prototype;_e.ea=function(){if(Cn(this))return-cr(this).ea();for(var e=0,t=1,r=0;r<this.g.length;r++){var n=this.D(r);e+=(0<=n?n:xg+n)*t,t*=xg}return e};_e.toString=function(e){if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(Ni(this))return"0";if(Cn(this))return"-"+cr(this).toString(e);for(var t=oi(Math.pow(e,6)),r=this,n="";;){var i=e0(r,t).g;r=Zh(r,i.R(t));var s=((0<r.g.length?r.g[0]:r.h)>>>0).toString(e);if(r=i,Ni(r))return s+n;for(;6>s.length;)s="0"+s;n=s+n}};_e.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h};function Ni(e){if(e.h!=0)return!1;for(var t=0;t<e.g.length;t++)if(e.g[t]!=0)return!1;return!0}function Cn(e){return e.h==-1}_e.X=function(e){return e=Zh(this,e),Cn(e)?-1:Ni(e)?0:1};function cr(e){for(var t=e.g.length,r=[],n=0;n<t;n++)r[n]=~e.g[n];return new nt(r,~e.h).add(yg)}_e.abs=function(){return Cn(this)?cr(this):this};_e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0,i=0;i<=t;i++){var s=n+(this.D(i)&65535)+(e.D(i)&65535),a=(s>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);n=a>>>16,s&=65535,a&=65535,r[i]=a<<16|s}return new nt(r,r[r.length-1]&-2147483648?-1:0)};function Zh(e,t){return e.add(cr(t))}_e.R=function(e){if(Ni(this)||Ni(e))return Fo;if(Cn(this))return Cn(e)?cr(this).R(cr(e)):cr(cr(this).R(e));if(Cn(e))return cr(this.R(cr(e)));if(0>this.X(Zy)&&0>e.X(Zy))return oi(this.ea()*e.ea());for(var t=this.g.length+e.g.length,r=[],n=0;n<2*t;n++)r[n]=0;for(n=0;n<this.g.length;n++)for(var i=0;i<e.g.length;i++){var s=this.D(n)>>>16,a=this.D(n)&65535,o=e.D(i)>>>16,l=e.D(i)&65535;r[2*n+2*i]+=a*l,Sf(r,2*n+2*i),r[2*n+2*i+1]+=s*l,Sf(r,2*n+2*i+1),r[2*n+2*i+1]+=a*o,Sf(r,2*n+2*i+1),r[2*n+2*i+2]+=s*o,Sf(r,2*n+2*i+2)}for(n=0;n<t;n++)r[n]=r[2*n+1]<<16|r[2*n];for(n=t;n<2*t;n++)r[n]=0;return new nt(r,0)};function Sf(e,t){for(;(e[t]&65535)!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Ol(e,t){this.g=e,this.h=t}function e0(e,t){if(Ni(t))throw Error("division by zero");if(Ni(e))return new Ol(Fo,Fo);if(Cn(e))return t=e0(cr(e),t),new Ol(cr(t.g),cr(t.h));if(Cn(t))return t=e0(e,cr(t)),new Ol(cr(t.g),t.h);if(30<e.g.length){if(Cn(e)||Cn(t))throw Error("slowDivide_ only works with positive integers.");for(var r=yg,n=t;0>=n.X(e);)r=eE(r),n=eE(n);var i=Za(r,1),s=Za(n,1);for(n=Za(n,2),r=Za(r,2);!Ni(n);){var a=s.add(n);0>=a.X(e)&&(i=i.add(r),s=a),n=Za(n,1),r=Za(r,1)}return t=Zh(e,i.R(t)),new Ol(i,t)}for(i=Fo;0<=e.X(t);){for(r=Math.max(1,Math.floor(e.ea()/t.ea())),n=Math.ceil(Math.log(r)/Math.LN2),n=48>=n?1:Math.pow(2,n-48),s=oi(r),a=s.R(t);Cn(a)||0<a.X(e);)r-=n,s=oi(r),a=s.R(t);Ni(s)&&(s=yg),i=i.add(s),e=Zh(e,a)}return new Ol(i,e)}_e.gb=function(e){return e0(this,e).h};_e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.D(n)&e.D(n);return new nt(r,this.h&e.h)};_e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.D(n)|e.D(n);return new nt(r,this.h|e.h)};_e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.D(n)^e.D(n);return new nt(r,this.h^e.h)};function eE(e){for(var t=e.g.length+1,r=[],n=0;n<t;n++)r[n]=e.D(n)<<1|e.D(n-1)>>>31;return new nt(r,e.h)}function Za(e,t){var r=t>>5;t%=32;for(var n=e.g.length-r,i=[],s=0;s<n;s++)i[s]=0<t?e.D(s+r)>>>t|e.D(s+r+1)<<32-t:e.D(s+r);return new nt(i,e.h)}Jh.prototype.createWebChannel=Jh.prototype.g;_n.prototype.send=_n.prototype.u;_n.prototype.open=_n.prototype.m;_n.prototype.close=_n.prototype.close;nd.NO_ERROR=0;nd.TIMEOUT=8;nd.HTTP_ERROR=6;NA.COMPLETE="complete";DA.EventType=Ou;Ou.OPEN="a";Ou.CLOSE="b";Ou.ERROR="c";Ou.MESSAGE="d";nr.prototype.listen=nr.prototype.O;Ct.prototype.listenOnce=Ct.prototype.P;Ct.prototype.getLastError=Ct.prototype.Sa;Ct.prototype.getLastErrorCode=Ct.prototype.Ia;Ct.prototype.getStatus=Ct.prototype.da;Ct.prototype.getResponseJson=Ct.prototype.Wa;Ct.prototype.getResponseText=Ct.prototype.ja;Ct.prototype.send=Ct.prototype.ha;Ct.prototype.setWithCredentials=Ct.prototype.Oa;Jn.prototype.digest=Jn.prototype.l;Jn.prototype.reset=Jn.prototype.reset;Jn.prototype.update=Jn.prototype.j;nt.prototype.add=nt.prototype.add;nt.prototype.multiply=nt.prototype.R;nt.prototype.modulo=nt.prototype.gb;nt.prototype.compare=nt.prototype.X;nt.prototype.toNumber=nt.prototype.ea;nt.prototype.toString=nt.prototype.toString;nt.prototype.getBits=nt.prototype.D;nt.fromNumber=oi;nt.fromString=pS;var Xb=function(){return new Jh},Yb=function(){return rd()},Ip=nd,Qb=NA,Jb=$a,tE={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Zb=Mu,If=DA,e6=Ct,t6=Jn,No=nt;const rE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}wr.UNAUTHENTICATED=new wr(null),wr.GOOGLE_CREDENTIALS=new wr("google-credentials-uid"),wr.FIRST_PARTY=new wr("first-party-uid"),wr.MOCK_USER=new wr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hl="10.5.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pa=new q1("@firebase/firestore");function Ll(){return Pa.logLevel}function Ie(e,...t){if(Pa.logLevel<=Ge.DEBUG){const r=t.map(Cv);Pa.debug(`Firestore (${hl}): ${e}`,...r)}}function zi(e,...t){if(Pa.logLevel<=Ge.ERROR){const r=t.map(Cv);Pa.error(`Firestore (${hl}): ${e}`,...r)}}function Go(e,...t){if(Pa.logLevel<=Ge.WARN){const r=t.map(Cv);Pa.warn(`Firestore (${hl}): ${e}`,...r)}}function Cv(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ne(e="Unexpected state"){const t=`FIRESTORE (${hl}) INTERNAL ASSERTION FAILED: `+e;throw zi(t),new Error(t)}function pt(e,t){e||Ne()}function Ve(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends Ei{constructor(t,r){super(t,r),this.code=t,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(){this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(t,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class r6{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,r){t.enqueueRetryable(()=>r(wr.UNAUTHENTICATED))}shutdown(){}}class n6{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,r){this.changeListener=r,t.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class i6{constructor(t){this.t=t,this.currentUser=wr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,r){let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new Li;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Li,t.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;t.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Ie("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Ie("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Li)}},0),a()}getToken(){const t=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==t?(Ie("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(pt(typeof n.accessToken=="string"),new mS(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return pt(t===null||typeof t=="string"),new wr(t)}}class s6{constructor(t,r,n){this.l=t,this.h=r,this.P=n,this.type="FirstParty",this.user=wr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class a6{constructor(t,r,n){this.l=t,this.h=r,this.P=n}getToken(){return Promise.resolve(new s6(this.l,this.h,this.P))}start(t,r){t.enqueueRetryable(()=>r(wr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class o6{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class l6{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,r){const n=s=>{s.error!=null&&Ie("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Ie("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>n(s))};const i=s=>{Ie("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Ie("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(r=>r?(pt(typeof r.token=="string"),this.R=r.token,new o6(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c6(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(r);else for(let n=0;n<e;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const i=c6(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=t.charAt(i[s]%t.length))}return n}}function tt(e,t){return e<t?-1:e>t?1:0}function Ko(e,t,r){return e.length===t.length&&e.every((n,i)=>r(n,t[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(t,r){if(this.seconds=t,this.nanoseconds=r,r<0)throw new Te(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Te(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(t<-62135596800)throw new Te(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Te(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return qt.fromMillis(Date.now())}static fromDate(t){return qt.fromMillis(t.getTime())}static fromMillis(t){const r=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*r));return new qt(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?tt(this.nanoseconds,t.nanoseconds):tt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Oe(t)}static min(){return new Oe(new qt(0,0))}static max(){return new Oe(new qt(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(t,r,n){r===void 0?r=0:r>t.length&&Ne(),n===void 0?n=t.length-r:n>t.length-r&&Ne(),this.segments=t,this.offset=r,this.len=n}get length(){return this.len}isEqual(t){return iu.comparator(this,t)===0}child(t){const r=this.segments.slice(this.offset,this.limit());return t instanceof iu?t.forEach(n=>{r.push(n)}):r.push(t),this.construct(r)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}forEach(t){for(let r=this.offset,n=this.limit();r<n;r++)t(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,r){const n=Math.min(t.length,r.length);for(let i=0;i<n;i++){const s=t.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return t.length<r.length?-1:t.length>r.length?1:0}}class ht extends iu{construct(t,r,n){return new ht(t,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const r=[];for(const n of t){if(n.indexOf("//")>=0)throw new Te(ee.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new ht(r)}static emptyPath(){return new ht([])}}const u6=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ur extends iu{construct(t,r,n){return new ur(t,r,n)}static isValidIdentifier(t){return u6.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ur.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ur(["__name__"])}static fromServerFormat(t){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new Te(ee.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<t.length;){const o=t[i];if(o==="\\"){if(i+1===t.length)throw new Te(ee.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Te(ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new Te(ee.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ur(r)}static emptyPath(){return new ur([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(t){this.path=t}static fromPath(t){return new Re(ht.fromString(t))}static fromName(t){return new Re(ht.fromString(t).popFirst(5))}static empty(){return new Re(ht.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&ht.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,r){return ht.comparator(t.path,r.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Re(new ht(t.slice()))}}function f6(e,t){const r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1,i=Oe.fromTimestamp(n===1e9?new qt(r+1,0):new qt(r,n));return new Us(i,Re.empty(),t)}function h6(e){return new Us(e.readTime,e.key,-1)}class Us{constructor(t,r,n){this.readTime=t,this.documentKey=r,this.largestBatchId=n}static min(){return new Us(Oe.min(),Re.empty(),-1)}static max(){return new Us(Oe.max(),Re.empty(),-1)}}function d6(e,t){let r=e.readTime.compareTo(t.readTime);return r!==0?r:(r=Re.comparator(e.documentKey,t.documentKey),r!==0?r:tt(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class m6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bu(e){if(e.code!==ee.FAILED_PRECONDITION||e.message!==p6)throw e;Ie("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(t){return this.next(void 0,t)}next(t,r){return this.callbackAttached&&Ne(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(t,this.result):new ie((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((t,r)=>{this.next(t,r)})}wrapUserFunction(t){try{const r=t();return r instanceof ie?r:ie.resolve(r)}catch(r){return ie.reject(r)}}wrapSuccess(t,r){return t?this.wrapUserFunction(()=>t(r)):ie.resolve(r)}wrapFailure(t,r){return t?this.wrapUserFunction(()=>t(r)):ie.reject(r)}static resolve(t){return new ie((r,n)=>{r(t)})}static reject(t){return new ie((r,n)=>{n(t)})}static waitFor(t){return new ie((r,n)=>{let i=0,s=0,a=!1;t.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(t){let r=ie.resolve(!1);for(const n of t)r=r.next(i=>i?ie.resolve(i):n());return r}static forEach(t,r){const n=[];return t.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(t,r){return new ie((n,i)=>{const s=t.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(t[c]).next(u=>{a[c]=u,++o,o===s&&n(a)},u=>i(u))}})}static doWhile(t,r){return new ie((n,i)=>{const s=()=>{t()===!0?r().next(()=>{s()},i):n()};s()})}}function ju(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=n=>this.se(n),this.oe=n=>r.writeSequenceNumber(n))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}Rv._e=-1;function fd(e){return e==null}function t0(e){return e===0&&1/e==-1/0}function g6(e){return typeof e=="number"&&Number.isInteger(e)&&!t0(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function Ha(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function vS(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(t,r){this.comparator=t,this.root=r||or.EMPTY}insert(t,r){return new kt(this.comparator,this.root.insert(t,r,this.comparator).copy(null,null,or.BLACK,null,null))}remove(t){return new kt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,or.BLACK,null,null))}get(t){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(t,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(t){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((r,n)=>(t(r,n),!1))}toString(){const t=[];return this.inorderTraversal((r,n)=>(t.push(`${r}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Cf(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Cf(this.root,t,this.comparator,!1)}getReverseIterator(){return new Cf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Cf(this.root,t,this.comparator,!0)}}class Cf{constructor(t,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=r?n(t.key,r):1,r&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const r={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class or{constructor(t,r,n,i,s){this.key=t,this.value=r,this.color=n??or.RED,this.left=i??or.EMPTY,this.right=s??or.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,n,i,s){return new or(t??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,n){let i=this;const s=n(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(t,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return or.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let n,i=this;if(r(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(t,i.key)===0){if(i.right.isEmpty())return or.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,or.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,or.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ne();const t=this.left.check();if(t!==this.right.check())throw Ne();return t+(this.isRed()?0:1)}}or.EMPTY=null,or.RED=!0,or.BLACK=!1;or.EMPTY=new class{constructor(){this.size=0}get key(){throw Ne()}get value(){throw Ne()}get color(){throw Ne()}get left(){throw Ne()}get right(){throw Ne()}copy(t,r,n,i,s){return this}insert(t,r,n){return new or(t,r)}remove(t,r){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(t){this.comparator=t,this.data=new kt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((r,n)=>(t(r),!1))}forEachInRange(t,r){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;r(i.key)}}forEachWhile(t,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const r=this.data.getIteratorFrom(t);return r.hasNext()?r.getNext().key:null}getIterator(){return new iE(this.data.getIterator())}getIteratorFrom(t){return new iE(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let r=this;return r.size<t.size&&(r=t,t=this),t.forEach(n=>{r=r.add(n)}),r}isEqual(t){if(!(t instanceof dr)||this.size!==t.size)return!1;const r=this.data.getIterator(),n=t.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(r=>{t.push(r)}),t}toString(){const t=[];return this.forEach(r=>t.push(r)),"SortedSet("+t.toString()+")"}copy(t){const r=new dr(this.comparator);return r.data=t,r}}class iE{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(t){this.fields=t,t.sort(ur.comparator)}static empty(){return new dn([])}unionWith(t){let r=new dr(ur.comparator);for(const n of this.fields)r=r.add(n);for(const n of t)r=r.add(n);return new dn(r.toArray())}covers(t){for(const r of this.fields)if(r.isPrefixOf(t))return!0;return!1}isEqual(t){return Ko(this.fields,t.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(t){this.binaryString=t}static fromBase64String(t){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new _S("Invalid base64 string: "+s):s}}(t);return new Or(r)}static fromUint8Array(t){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(t);return new Or(r)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return tt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Or.EMPTY_BYTE_STRING=new Or("");const v6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bs(e){if(pt(!!e),typeof e=="string"){let t=0;const r=v6.exec(e);if(pt(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),t=Number(i)}const n=new Date(e);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:Bt(e.seconds),nanos:Bt(e.nanos)}}function Bt(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Fa(e){return typeof e=="string"?Or.fromBase64String(e):Or.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pv(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function Fv(e){const t=e.mapValue.fields.__previous_value__;return Pv(t)?Fv(t):t}function su(e){const t=Bs(e.mapValue.fields.__local_write_time__.timestampValue);return new qt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _6{constructor(t,r,n,i,s,a,o,l,c){this.databaseId=t,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class au{constructor(t,r){this.projectId=t,this.database=r||"(default)"}static empty(){return new au("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof au&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rf={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Na(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Pv(e)?4:x6(e)?9007199254740991:10:Ne()}function vi(e,t){if(e===t)return!0;const r=Na(e);if(r!==Na(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return su(e).isEqual(su(t));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Bs(i.timestampValue),o=Bs(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(i,s){return Fa(i.bytesValue).isEqual(Fa(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(i,s){return Bt(i.geoPointValue.latitude)===Bt(s.geoPointValue.latitude)&&Bt(i.geoPointValue.longitude)===Bt(s.geoPointValue.longitude)}(e,t);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Bt(i.integerValue)===Bt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Bt(i.doubleValue),o=Bt(s.doubleValue);return a===o?t0(a)===t0(o):isNaN(a)&&isNaN(o)}return!1}(e,t);case 9:return Ko(e.arrayValue.values||[],t.arrayValue.values||[],vi);case 10:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(nE(a)!==nE(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!vi(a[l],o[l])))return!1;return!0}(e,t);default:return Ne()}}function ou(e,t){return(e.values||[]).find(r=>vi(r,t))!==void 0}function qo(e,t){if(e===t)return 0;const r=Na(e),n=Na(t);if(r!==n)return tt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return tt(e.booleanValue,t.booleanValue);case 2:return function(s,a){const o=Bt(s.integerValue||s.doubleValue),l=Bt(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(e,t);case 3:return sE(e.timestampValue,t.timestampValue);case 4:return sE(su(e),su(t));case 5:return tt(e.stringValue,t.stringValue);case 6:return function(s,a){const o=Fa(s),l=Fa(a);return o.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=tt(o[c],l[c]);if(u!==0)return u}return tt(o.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,a){const o=tt(Bt(s.latitude),Bt(a.latitude));return o!==0?o:tt(Bt(s.longitude),Bt(a.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(s,a){const o=s.values||[],l=a.values||[];for(let c=0;c<o.length&&c<l.length;++c){const u=qo(o[c],l[c]);if(u)return u}return tt(o.length,l.length)}(e.arrayValue,t.arrayValue);case 10:return function(s,a){if(s===Rf.mapValue&&a===Rf.mapValue)return 0;if(s===Rf.mapValue)return 1;if(a===Rf.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let f=0;f<l.length&&f<u.length;++f){const h=tt(l[f],u[f]);if(h!==0)return h;const d=qo(o[l[f]],c[u[f]]);if(d!==0)return d}return tt(l.length,u.length)}(e.mapValue,t.mapValue);default:throw Ne()}}function sE(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return tt(e,t);const r=Bs(e),n=Bs(t),i=tt(r.seconds,n.seconds);return i!==0?i:tt(r.nanos,n.nanos)}function Xo(e){return Eg(e)}function Eg(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(r){const n=Bs(r);return`time(${n.seconds},${n.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(r){return Fa(r).toBase64()}(e.bytesValue):"referenceValue"in e?function(r){return Re.fromName(r).toString()}(e.referenceValue):"geoPointValue"in e?function(r){return`geo(${r.latitude},${r.longitude})`}(e.geoPointValue):"arrayValue"in e?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=Eg(s);return n+"]"}(e.arrayValue):"mapValue"in e?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${Eg(r.fields[a])}`;return i+"}"}(e.mapValue):Ne()}function aE(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function wg(e){return!!e&&"integerValue"in e}function Nv(e){return!!e&&"arrayValue"in e}function oE(e){return!!e&&"nullValue"in e}function lE(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function oh(e){return!!e&&"mapValue"in e}function hc(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Ha(e.mapValue.fields,(r,n)=>t.mapValue.fields[r]=hc(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=hc(e.arrayValue.values[r]);return t}return Object.assign({},e)}function x6(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(t){this.value=t}static empty(){return new tn({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let r=this.value;for(let n=0;n<t.length-1;++n)if(r=(r.mapValue.fields||{})[t.get(n)],!oh(r))return null;return r=(r.mapValue.fields||{})[t.lastSegment()],r||null}}set(t,r){this.getFieldsMap(t.popLast())[t.lastSegment()]=hc(r)}setAll(t){let r=ur.emptyPath(),n={},i=[];t.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=hc(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(t){const r=this.field(t.popLast());oh(r)&&r.mapValue.fields&&delete r.mapValue.fields[t.lastSegment()]}isEqual(t){return vi(this.value,t.value)}getFieldsMap(t){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=r.mapValue.fields[t.get(n)];oh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[t.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(t,r,n){Ha(r,(i,s)=>t[i]=s);for(const i of n)delete t[i]}clone(){return new tn(hc(this.value))}}function xS(e){const t=[];return Ha(e.fields,(r,n)=>{const i=new ur([r]);if(oh(n)){const s=xS(n.mapValue).fields;if(s.length===0)t.push(i);else for(const a of s)t.push(i.child(a))}else t.push(i)}),new dn(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(t,r,n,i,s,a,o){this.key=t,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(t){return new Sr(t,0,Oe.min(),Oe.min(),Oe.min(),tn.empty(),0)}static newFoundDocument(t,r,n,i){return new Sr(t,1,r,Oe.min(),n,i,0)}static newNoDocument(t,r){return new Sr(t,2,r,Oe.min(),Oe.min(),tn.empty(),0)}static newUnknownDocument(t,r){return new Sr(t,3,r,Oe.min(),Oe.min(),tn.empty(),2)}convertToFoundDocument(t,r){return!this.createTime.isEqual(Oe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=tn.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=tn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Oe.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Sr&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Sr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(t,r){this.position=t,this.inclusive=r}}function cE(e,t,r){let n=0;for(let i=0;i<e.position.length;i++){const s=t[i],a=e.position[i];if(s.field.isKeyField()?n=Re.comparator(Re.fromName(a.referenceValue),r.key):n=qo(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function uE(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!vi(e.position[r],t.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(t,r="asc"){this.field=t,this.dir=r}}function y6(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{}class $t extends yS{constructor(t,r,n){super(),this.field=t,this.op=r,this.value=n}static create(t,r,n){return t.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(t,r,n):new w6(t,r,n):r==="array-contains"?new A6(t,n):r==="in"?new S6(t,n):r==="not-in"?new I6(t,n):r==="array-contains-any"?new C6(t,n):new $t(t,r,n)}static createKeyFieldInFilter(t,r,n){return r==="in"?new T6(t,n):new k6(t,n)}matches(t){const r=t.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(qo(r,this.value)):r!==null&&Na(this.value)===Na(r)&&this.matchesComparison(qo(r,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Ne()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Zn extends yS{constructor(t,r){super(),this.filters=t,this.op=r,this.ue=null}static create(t,r){return new Zn(t,r)}matches(t){return ES(this)?this.filters.find(r=>!r.matches(t))===void 0:this.filters.find(r=>r.matches(t))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((t,r)=>t.concat(r.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function ES(e){return e.op==="and"}function wS(e){return E6(e)&&ES(e)}function E6(e){for(const t of e.filters)if(t instanceof Zn)return!1;return!0}function Tg(e){if(e instanceof $t)return e.field.canonicalString()+e.op.toString()+Xo(e.value);if(wS(e))return e.filters.map(t=>Tg(t)).join(",");{const t=e.filters.map(r=>Tg(r)).join(",");return`${e.op}(${t})`}}function TS(e,t){return e instanceof $t?function(n,i){return i instanceof $t&&n.op===i.op&&n.field.isEqual(i.field)&&vi(n.value,i.value)}(e,t):e instanceof Zn?function(n,i){return i instanceof Zn&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&TS(a,i.filters[o]),!0):!1}(e,t):void Ne()}function kS(e){return e instanceof $t?function(r){return`${r.field.canonicalString()} ${r.op} ${Xo(r.value)}`}(e):e instanceof Zn?function(r){return r.op.toString()+" {"+r.getFilters().map(kS).join(" ,")+"}"}(e):"Filter"}class w6 extends $t{constructor(t,r,n){super(t,r,n),this.key=Re.fromName(n.referenceValue)}matches(t){const r=Re.comparator(t.key,this.key);return this.matchesComparison(r)}}class T6 extends $t{constructor(t,r){super(t,"in",r),this.keys=AS("in",r)}matches(t){return this.keys.some(r=>r.isEqual(t.key))}}class k6 extends $t{constructor(t,r){super(t,"not-in",r),this.keys=AS("not-in",r)}matches(t){return!this.keys.some(r=>r.isEqual(t.key))}}function AS(e,t){var r;return(((r=t.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Re.fromName(n.referenceValue))}class A6 extends $t{constructor(t,r){super(t,"array-contains",r)}matches(t){const r=t.data.field(this.field);return Nv(r)&&ou(r.arrayValue,this.value)}}class S6 extends $t{constructor(t,r){super(t,"in",r)}matches(t){const r=t.data.field(this.field);return r!==null&&ou(this.value.arrayValue,r)}}class I6 extends $t{constructor(t,r){super(t,"not-in",r)}matches(t){if(ou(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=t.data.field(this.field);return r!==null&&!ou(this.value.arrayValue,r)}}class C6 extends $t{constructor(t,r){super(t,"array-contains-any",r)}matches(t){const r=t.data.field(this.field);return!(!Nv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>ou(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{constructor(t,r=null,n=[],i=[],s=null,a=null,o=null){this.path=t,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ce=null}}function fE(e,t=null,r=[],n=[],i=null,s=null,a=null){return new R6(e,t,r,n,i,s,a)}function Dv(e){const t=Ve(e);if(t.ce===null){let r=t.path.canonicalString();t.collectionGroup!==null&&(r+="|cg:"+t.collectionGroup),r+="|f:",r+=t.filters.map(n=>Tg(n)).join(","),r+="|ob:",r+=t.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),fd(t.limit)||(r+="|l:",r+=t.limit),t.startAt&&(r+="|lb:",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(n=>Xo(n)).join(",")),t.endAt&&(r+="|ub:",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(n=>Xo(n)).join(",")),t.ce=r}return t.ce}function Ov(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!y6(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!TS(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!uE(e.startAt,t.startAt)&&uE(e.endAt,t.endAt)}function kg(e){return Re.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(t,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=t,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function P6(e,t,r,n,i,s,a,o){return new dl(e,t,r,n,i,s,a,o)}function Lv(e){return new dl(e)}function hE(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function SS(e){return e.collectionGroup!==null}function dc(e){const t=Ve(e);if(t.le===null){t.le=[];const r=new Set;for(const s of t.explicitOrderBy)t.le.push(s),r.add(s.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new dr(ur.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(t).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||t.le.push(new lu(s,n))}),r.has(ur.keyField().canonicalString())||t.le.push(new lu(ur.keyField(),n))}return t.le}function mi(e){const t=Ve(e);return t.he||(t.he=F6(t,dc(e))),t.he}function F6(e,t){if(e.limitType==="F")return fE(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new lu(i.field,s)});const r=e.endAt?new r0(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new r0(e.startAt.position,e.startAt.inclusive):null;return fE(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function Ag(e,t){const r=e.filters.concat([t]);return new dl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function n0(e,t,r){return new dl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function hd(e,t){return Ov(mi(e),mi(t))&&e.limitType===t.limitType}function IS(e){return`${Dv(mi(e))}|lt:${e.limitType}`}function ro(e){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>kS(i)).join(", ")}]`),fd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Xo(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Xo(i)).join(",")),`Target(${n})`}(mi(e))}; limitType=${e.limitType})`}function dd(e,t){return t.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Re.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(e,t)&&function(n,i){for(const s of dc(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(e,t)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(e,t)&&function(n,i){return!(n.startAt&&!function(a,o,l){const c=cE(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,dc(n),i)||n.endAt&&!function(a,o,l){const c=cE(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,dc(n),i))}(e,t)}function N6(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function CS(e){return(t,r)=>{let n=!1;for(const i of dc(e)){const s=D6(i,t,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function D6(e,t,r){const n=e.field.isKeyField()?Re.comparator(t.key,r.key):function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?qo(l,c):Ne()}(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return Ne()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(t,r){this.mapKeyFn=t,this.equalsFn=r,this.inner={},this.innerSize=0}get(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,t))return s}}has(t){return this.get(t)!==void 0}set(t,r){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return this.inner[n]=[[t,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,r]);i.push([t,r]),this.innerSize++}delete(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Ha(this.inner,(r,n)=>{for(const[i,s]of n)t(i,s)})}isEmpty(){return vS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O6=new kt(Re.comparator);function Wi(){return O6}const RS=new kt(Re.comparator);function Kl(...e){let t=RS;for(const r of e)t=t.insert(r.key,r);return t}function PS(e){let t=RS;return e.forEach((r,n)=>t=t.insert(r,n.overlayedDocument)),t}function ha(){return pc()}function FS(){return pc()}function pc(){return new pl(e=>e.toString(),(e,t)=>e.isEqual(t))}const L6=new kt(Re.comparator),b6=new dr(Re.comparator);function $e(...e){let t=b6;for(const r of e)t=t.add(r);return t}const M6=new dr(tt);function V6(){return M6}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NS(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t0(t)?"-0":t}}function DS(e){return{integerValue:""+e}}function U6(e,t){return g6(t)?DS(t):NS(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(){this._=void 0}}function B6(e,t,r){return e instanceof i0?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Pv(s)&&(s=Fv(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,t):e instanceof cu?LS(e,t):e instanceof uu?bS(e,t):function(i,s){const a=OS(i,s),o=dE(a)+dE(i.Ie);return wg(a)&&wg(i.Ie)?DS(o):NS(i.serializer,o)}(e,t)}function j6(e,t,r){return e instanceof cu?LS(e,t):e instanceof uu?bS(e,t):r}function OS(e,t){return e instanceof s0?function(n){return wg(n)||function(s){return!!s&&"doubleValue"in s}(n)}(t)?t:{integerValue:0}:null}class i0 extends pd{}class cu extends pd{constructor(t){super(),this.elements=t}}function LS(e,t){const r=MS(t);for(const n of e.elements)r.some(i=>vi(i,n))||r.push(n);return{arrayValue:{values:r}}}class uu extends pd{constructor(t){super(),this.elements=t}}function bS(e,t){let r=MS(t);for(const n of e.elements)r=r.filter(i=>!vi(i,n));return{arrayValue:{values:r}}}class s0 extends pd{constructor(t,r){super(),this.serializer=t,this.Ie=r}}function dE(e){return Bt(e.integerValue||e.doubleValue)}function MS(e){return Nv(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function $6(e,t){return e.field.isEqual(t.field)&&function(n,i){return n instanceof cu&&i instanceof cu||n instanceof uu&&i instanceof uu?Ko(n.elements,i.elements,vi):n instanceof s0&&i instanceof s0?vi(n.Ie,i.Ie):n instanceof i0&&i instanceof i0}(e.transform,t.transform)}class H6{constructor(t,r){this.version=t,this.transformResults=r}}class qn{constructor(t,r){this.updateTime=t,this.exists=r}static none(){return new qn}static exists(t){return new qn(void 0,t)}static updateTime(t){return new qn(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function lh(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class md{}function VS(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new BS(e.key,qn.none()):new $u(e.key,e.data,qn.none());{const r=e.data,n=tn.empty();let i=new dr(ur.comparator);for(let s of t.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new Ys(e.key,n,new dn(i.toArray()),qn.none())}}function z6(e,t,r){e instanceof $u?function(i,s,a){const o=i.value.clone(),l=mE(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(e,t,r):e instanceof Ys?function(i,s,a){if(!lh(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=mE(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(US(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(e,t,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,t,r)}function mc(e,t,r,n){return e instanceof $u?function(s,a,o,l){if(!lh(s.precondition,a))return o;const c=s.value.clone(),u=gE(s.fieldTransforms,l,a);return c.setAll(u),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(e,t,r,n):e instanceof Ys?function(s,a,o,l){if(!lh(s.precondition,a))return o;const c=gE(s.fieldTransforms,l,a),u=a.data;return u.setAll(US(s)),u.setAll(c),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(e,t,r,n):function(s,a,o){return lh(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(e,t,r)}function W6(e,t){let r=null;for(const n of e.fieldTransforms){const i=t.data.field(n.field),s=OS(n.transform,i||null);s!=null&&(r===null&&(r=tn.empty()),r.set(n.field,s))}return r||null}function pE(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Ko(n,i,(s,a)=>$6(s,a))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class $u extends md{constructor(t,r,n,i=[]){super(),this.key=t,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ys extends md{constructor(t,r,n,i,s=[]){super(),this.key=t,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function US(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=e.data.field(r);t.set(r,n)}}),t}function mE(e,t,r){const n=new Map;pt(e.length===r.length);for(let i=0;i<r.length;i++){const s=e[i],a=s.transform,o=t.data.field(s.field);n.set(s.field,j6(a,o,r[i]))}return n}function gE(e,t,r){const n=new Map;for(const i of e){const s=i.transform,a=r.data.field(i.field);n.set(i.field,B6(s,a,t))}return n}class BS extends md{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class G6 extends md{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K6{constructor(t,r,n,i){this.batchId=t,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(t.key)&&z6(s,t,n[i])}}applyToLocalView(t,r){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(r=mc(n,t,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(r=mc(n,t,r,this.localWriteTime));return r}applyToLocalDocumentSet(t,r){const n=FS();return this.mutations.forEach(i=>{const s=t.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=VS(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Oe.min())}),n}keys(){return this.mutations.reduce((t,r)=>t.add(r.key),$e())}isEqual(t){return this.batchId===t.batchId&&Ko(this.mutations,t.mutations,(r,n)=>pE(r,n))&&Ko(this.baseMutations,t.baseMutations,(r,n)=>pE(r,n))}}class bv{constructor(t,r,n,i){this.batch=t,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(t,r,n){pt(t.mutations.length===n.length);let i=function(){return L6}();const s=t.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new bv(t,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q6{constructor(t,r){this.largestBatchId=t,this.mutation=r}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X6{constructor(t,r){this.count=t,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mt,qe;function Y6(e){switch(e){default:return Ne();case ee.CANCELLED:case ee.UNKNOWN:case ee.DEADLINE_EXCEEDED:case ee.RESOURCE_EXHAUSTED:case ee.INTERNAL:case ee.UNAVAILABLE:case ee.UNAUTHENTICATED:return!1;case ee.INVALID_ARGUMENT:case ee.NOT_FOUND:case ee.ALREADY_EXISTS:case ee.PERMISSION_DENIED:case ee.FAILED_PRECONDITION:case ee.ABORTED:case ee.OUT_OF_RANGE:case ee.UNIMPLEMENTED:case ee.DATA_LOSS:return!0}}function jS(e){if(e===void 0)return zi("GRPC error has no .code"),ee.UNKNOWN;switch(e){case Mt.OK:return ee.OK;case Mt.CANCELLED:return ee.CANCELLED;case Mt.UNKNOWN:return ee.UNKNOWN;case Mt.DEADLINE_EXCEEDED:return ee.DEADLINE_EXCEEDED;case Mt.RESOURCE_EXHAUSTED:return ee.RESOURCE_EXHAUSTED;case Mt.INTERNAL:return ee.INTERNAL;case Mt.UNAVAILABLE:return ee.UNAVAILABLE;case Mt.UNAUTHENTICATED:return ee.UNAUTHENTICATED;case Mt.INVALID_ARGUMENT:return ee.INVALID_ARGUMENT;case Mt.NOT_FOUND:return ee.NOT_FOUND;case Mt.ALREADY_EXISTS:return ee.ALREADY_EXISTS;case Mt.PERMISSION_DENIED:return ee.PERMISSION_DENIED;case Mt.FAILED_PRECONDITION:return ee.FAILED_PRECONDITION;case Mt.ABORTED:return ee.ABORTED;case Mt.OUT_OF_RANGE:return ee.OUT_OF_RANGE;case Mt.UNIMPLEMENTED:return ee.UNIMPLEMENTED;case Mt.DATA_LOSS:return ee.DATA_LOSS;default:return Ne()}}(qe=Mt||(Mt={}))[qe.OK=0]="OK",qe[qe.CANCELLED=1]="CANCELLED",qe[qe.UNKNOWN=2]="UNKNOWN",qe[qe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",qe[qe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",qe[qe.NOT_FOUND=5]="NOT_FOUND",qe[qe.ALREADY_EXISTS=6]="ALREADY_EXISTS",qe[qe.PERMISSION_DENIED=7]="PERMISSION_DENIED",qe[qe.UNAUTHENTICATED=16]="UNAUTHENTICATED",qe[qe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",qe[qe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",qe[qe.ABORTED=10]="ABORTED",qe[qe.OUT_OF_RANGE=11]="OUT_OF_RANGE",qe[qe.UNIMPLEMENTED=12]="UNIMPLEMENTED",qe[qe.INTERNAL=13]="INTERNAL",qe[qe.UNAVAILABLE=14]="UNAVAILABLE",qe[qe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q6(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J6=new No([4294967295,4294967295],0);function vE(e){const t=Q6().encode(e),r=new t6;return r.update(t),new Uint8Array(r.digest())}function _E(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new No([r,n],0),new No([i,s],0)]}class Mv{constructor(t,r,n){if(this.bitmap=t,this.padding=r,this.hashCount=n,r<0||r>=8)throw new ql(`Invalid padding: ${r}`);if(n<0)throw new ql(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new ql(`Invalid hash count: ${n}`);if(t.length===0&&r!==0)throw new ql(`Invalid padding when bitmap length is 0: ${r}`);this.Te=8*t.length-r,this.Ee=No.fromNumber(this.Te)}de(t,r,n){let i=t.add(r.multiply(No.fromNumber(n)));return i.compare(J6)===1&&(i=new No([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Te===0)return!1;const r=vE(t),[n,i]=_E(r);for(let s=0;s<this.hashCount;s++){const a=this.de(n,i,s);if(!this.Ae(a))return!1}return!0}static create(t,r,n){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),a=new Mv(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(t){if(this.Te===0)return;const r=vE(t),[n,i]=_E(r);for(let s=0;s<this.hashCount;s++){const a=this.de(n,i,s);this.Re(a)}}Re(t){const r=Math.floor(t/8),n=t%8;this.bitmap[r]|=1<<n}}class ql extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{constructor(t,r,n,i,s){this.snapshotVersion=t,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,r,n){const i=new Map;return i.set(t,Hu.createSynthesizedTargetChangeForCurrentChange(t,r,n)),new gd(Oe.min(),i,new kt(tt),Wi(),$e())}}class Hu{constructor(t,r,n,i,s){this.resumeToken=t,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,r,n){return new Hu(n,r,$e(),$e(),$e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(t,r,n,i){this.Ve=t,this.removedTargetIds=r,this.key=n,this.me=i}}class $S{constructor(t,r){this.targetId=t,this.fe=r}}class HS{constructor(t,r,n=Or.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=r,this.resumeToken=n,this.cause=i}}class xE{constructor(){this.ge=0,this.pe=EE(),this.ye=Or.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=$e(),r=$e(),n=$e();return this.pe.forEach((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Ne()}}),new Hu(this.ye,this.we,t,r,n)}Fe(){this.Se=!1,this.pe=EE()}Me(t,r){this.Se=!0,this.pe=this.pe.insert(t,r)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1}Be(){this.Se=!0,this.we=!0}}class Z6{constructor(t){this.Le=t,this.ke=new Map,this.qe=Wi(),this.Qe=yE(),this.Ke=new kt(tt)}$e(t){for(const r of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(r,t.me):this.We(r,t.key,t.me);for(const r of t.removedTargetIds)this.We(r,t.key,t.me)}Ge(t){this.forEachTarget(t,r=>{const n=this.ze(r);switch(t.state){case 0:this.je(r)&&n.Ce(t.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(t.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(r);break;case 3:this.je(r)&&(n.Be(),n.Ce(t.resumeToken));break;case 4:this.je(r)&&(this.He(r),n.Ce(t.resumeToken));break;default:Ne()}})}forEachTarget(t,r){t.targetIds.length>0?t.targetIds.forEach(r):this.ke.forEach((n,i)=>{this.je(i)&&r(i)})}Je(t){const r=t.targetId,n=t.fe.count,i=this.Ye(r);if(i){const s=i.target;if(kg(s))if(n===0){const a=new Re(s.path);this.We(r,a,Sr.newNoDocument(a,Oe.min()))}else pt(n===1);else{const a=this.Ze(r);if(a!==n){const o=this.Xe(t),l=o?this.et(o,t,a):1;if(l!==0){this.He(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(r,c)}}}}}Xe(t){const r=t.fe.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=Fa(n).toUint8Array()}catch(l){if(l instanceof _S)return Go("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Mv(a,i,s)}catch(l){return Go(l instanceof ql?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Te===0?null:o}et(t,r,n){return r.fe.count===n-this.rt(t,r.targetId)?0:2}rt(t,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.nt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;t.mightContain(o)||(this.We(r,s,null),i++)}),i}it(t){const r=new Map;this.ke.forEach((s,a)=>{const o=this.Ye(a);if(o){if(s.current&&kg(o.target)){const l=new Re(o.target.path);this.qe.get(l)!==null||this.st(a,l)||this.We(a,l,Sr.newNoDocument(l,t))}s.De&&(r.set(a,s.ve()),s.Fe())}});let n=$e();this.Qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Ye(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.qe.forEach((s,a)=>a.setReadTime(t));const i=new gd(t,r,this.Ke,this.qe,n);return this.qe=Wi(),this.Qe=yE(),this.Ke=new kt(tt),i}Ue(t,r){if(!this.je(t))return;const n=this.st(t,r.key)?2:0;this.ze(t).Me(r.key,n),this.qe=this.qe.insert(r.key,r),this.Qe=this.Qe.insert(r.key,this.ot(r.key).add(t))}We(t,r,n){if(!this.je(t))return;const i=this.ze(t);this.st(t,r)?i.Me(r,1):i.xe(r),this.Qe=this.Qe.insert(r,this.ot(r).delete(t)),n&&(this.qe=this.qe.insert(r,n))}removeTarget(t){this.ke.delete(t)}Ze(t){const r=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+r.addedDocuments.size-r.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let r=this.ke.get(t);return r||(r=new xE,this.ke.set(t,r)),r}ot(t){let r=this.Qe.get(t);return r||(r=new dr(tt),this.Qe=this.Qe.insert(t,r)),r}je(t){const r=this.Ye(t)!==null;return r||Ie("WatchChangeAggregator","Detected inactive target",t),r}Ye(t){const r=this.ke.get(t);return r&&r.be?null:this.Le._t(t)}He(t){this.ke.set(t,new xE),this.Le.getRemoteKeysForTarget(t).forEach(r=>{this.We(t,r,null)})}st(t,r){return this.Le.getRemoteKeysForTarget(t).has(r)}}function yE(){return new kt(Re.comparator)}function EE(){return new kt(Re.comparator)}const eM=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),tM=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),rM=(()=>({and:"AND",or:"OR"}))();class nM{constructor(t,r){this.databaseId=t,this.useProto3Json=r}}function Sg(e,t){return e.useProto3Json||fd(t)?t:{value:t}}function a0(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function zS(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function iM(e,t){return a0(e,t.toTimestamp())}function gi(e){return pt(!!e),Oe.fromTimestamp(function(r){const n=Bs(r);return new qt(n.seconds,n.nanos)}(e))}function Vv(e,t){return function(n){return new ht(["projects",n.projectId,"databases",n.database])}(e).child("documents").child(t).canonicalString()}function WS(e){const t=ht.fromString(e);return pt(XS(t)),t}function Ig(e,t){return Vv(e.databaseId,t.path)}function Cp(e,t){const r=WS(t);if(r.get(1)!==e.databaseId.projectId)throw new Te(ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new Te(ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new Re(GS(r))}function Cg(e,t){return Vv(e.databaseId,t)}function sM(e){const t=WS(e);return t.length===4?ht.emptyPath():GS(t)}function Rg(e){return new ht(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function GS(e){return pt(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function wE(e,t,r){return{name:Ig(e,t),fields:r.value.mapValue.fields}}function aM(e,t){let r;if("targetChange"in t){t.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Ne()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(c,u){return c.useProto3Json?(pt(u===void 0||typeof u=="string"),Or.fromBase64String(u||"")):(pt(u===void 0||u instanceof Uint8Array),Or.fromUint8Array(u||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,o=a&&function(c){const u=c.code===void 0?ee.UNKNOWN:jS(c.code);return new Te(u,c.message||"")}(a);r=new HS(n,i,s,o||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const i=Cp(e,n.document.name),s=gi(n.document.updateTime),a=n.document.createTime?gi(n.document.createTime):Oe.min(),o=new tn({mapValue:{fields:n.document.fields}}),l=Sr.newFoundDocument(i,s,a,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new ch(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const i=Cp(e,n.document),s=n.readTime?gi(n.readTime):Oe.min(),a=Sr.newNoDocument(i,s),o=n.removedTargetIds||[];r=new ch([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const i=Cp(e,n.document),s=n.removedTargetIds||[];r=new ch([],s,i,null)}else{if(!("filter"in t))return Ne();{t.filter;const n=t.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new X6(i,s),o=n.targetId;r=new $S(o,a)}}return r}function oM(e,t){let r;if(t instanceof $u)r={update:wE(e,t.key,t.value)};else if(t instanceof BS)r={delete:Ig(e,t.key)};else if(t instanceof Ys)r={update:wE(e,t.key,t.data),updateMask:gM(t.fieldMask)};else{if(!(t instanceof G6))return Ne();r={verify:Ig(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof i0)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof cu)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof uu)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof s0)return{fieldPath:a.field.canonicalString(),increment:o.Ie};throw Ne()}(0,n))),t.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:iM(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ne()}(e,t.precondition)),r}function lM(e,t){return e&&e.length>0?(pt(t!==void 0),e.map(r=>function(i,s){let a=i.updateTime?gi(i.updateTime):gi(s);return a.isEqual(Oe.min())&&(a=gi(s)),new H6(a,i.transformResults||[])}(r,t))):[]}function cM(e,t){return{documents:[Cg(e,t.path)]}}function uM(e,t){const r={structuredQuery:{}},n=t.path;t.collectionGroup!==null?(r.parent=Cg(e,n),r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r.parent=Cg(e,n.popLast()),r.structuredQuery.from=[{collectionId:n.lastSegment()}]);const i=function(l){if(l.length!==0)return qS(Zn.create(l,"and"))}(t.filters);i&&(r.structuredQuery.where=i);const s=function(l){if(l.length!==0)return l.map(c=>function(f){return{field:no(f.field),direction:dM(f.dir)}}(c))}(t.orderBy);s&&(r.structuredQuery.orderBy=s);const a=Sg(e,t.limit);return a!==null&&(r.structuredQuery.limit=a),t.startAt&&(r.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(t.endAt)),r}function fM(e){let t=sM(e.parent);const r=e.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){pt(n===1);const u=r.from[0];u.allDescendants?i=u.collectionId:t=t.child(u.collectionId)}let s=[];r.where&&(s=function(f){const h=KS(f);return h instanceof Zn&&wS(h)?h.getFilters():[h]}(r.where));let a=[];r.orderBy&&(a=function(f){return f.map(h=>function(m){return new lu(io(m.field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(h))}(r.orderBy));let o=null;r.limit&&(o=function(f){let h;return h=typeof f=="object"?f.value:f,fd(h)?null:h}(r.limit));let l=null;r.startAt&&(l=function(f){const h=!!f.before,d=f.values||[];return new r0(d,h)}(r.startAt));let c=null;return r.endAt&&(c=function(f){const h=!f.before,d=f.values||[];return new r0(d,h)}(r.endAt)),P6(t,i,a,s,o,"F",l,c)}function hM(e,t){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ne()}}(t.purpose);return r==null?null:{"goog-listen-tags":r}}function KS(e){return e.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=io(r.unaryFilter.field);return $t.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=io(r.unaryFilter.field);return $t.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=io(r.unaryFilter.field);return $t.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=io(r.unaryFilter.field);return $t.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Ne()}}(e):e.fieldFilter!==void 0?function(r){return $t.create(io(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ne()}}(r.fieldFilter.op),r.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(r){return Zn.create(r.compositeFilter.filters.map(n=>KS(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ne()}}(r.compositeFilter.op))}(e):Ne()}function dM(e){return eM[e]}function pM(e){return tM[e]}function mM(e){return rM[e]}function no(e){return{fieldPath:e.canonicalString()}}function io(e){return ur.fromServerFormat(e.fieldPath)}function qS(e){return e instanceof $t?function(r){if(r.op==="=="){if(lE(r.value))return{unaryFilter:{field:no(r.field),op:"IS_NAN"}};if(oE(r.value))return{unaryFilter:{field:no(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(lE(r.value))return{unaryFilter:{field:no(r.field),op:"IS_NOT_NAN"}};if(oE(r.value))return{unaryFilter:{field:no(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:no(r.field),op:pM(r.op),value:r.value}}}(e):e instanceof Zn?function(r){const n=r.getFilters().map(i=>qS(i));return n.length===1?n[0]:{compositeFilter:{op:mM(r.op),filters:n}}}(e):Ne()}function gM(e){const t=[];return e.fields.forEach(r=>t.push(r.canonicalString())),{fieldPaths:t}}function XS(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(t,r,n,i,s=Oe.min(),a=Oe.min(),o=Or.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(t){return new gs(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,r){return new gs(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new gs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new gs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(t){this.ut=t}}function _M(e){const t=fM({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?n0(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(){this.on=new yM}addToCollectionParentIndex(t,r){return this.on.add(r),ie.resolve()}getCollectionParents(t,r){return ie.resolve(this.on.getEntries(r))}addFieldIndex(t,r){return ie.resolve()}deleteFieldIndex(t,r){return ie.resolve()}deleteAllFieldIndexes(t){return ie.resolve()}createTargetIndexes(t,r){return ie.resolve()}getDocumentsMatchingTarget(t,r){return ie.resolve(null)}getIndexType(t,r){return ie.resolve(0)}getFieldIndexes(t,r){return ie.resolve([])}getNextCollectionGroupToUpdate(t){return ie.resolve(null)}getMinOffset(t,r){return ie.resolve(Us.min())}getMinOffsetFromCollectionGroup(t,r){return ie.resolve(Us.min())}updateCollectionGroup(t,r,n){return ie.resolve()}updateIndexEntries(t,r){return ie.resolve()}}class yM{constructor(){this.index={}}add(t){const r=t.lastSegment(),n=t.popLast(),i=this.index[r]||new dr(ht.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(t){const r=t.lastSegment(),n=t.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(t){return(this.index[t]||new dr(ht.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(t){this.xn=t}next(){return this.xn+=2,this.xn}static On(){return new Yo(0)}static Nn(){return new Yo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EM{constructor(){this.changes=new pl(t=>t.toString(),(t,r)=>t.isEqual(r)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,r){this.assertNotApplied(),this.changes.set(t,Sr.newInvalidDocument(t).setReadTime(r))}getEntry(t,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ie.resolve(n):this.getFromCache(t,r)}getEntries(t,r){return this.getAllFromCache(t,r)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wM{constructor(t,r){this.overlayedDocument=t,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TM{constructor(t,r,n,i){this.remoteDocumentCache=t,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,r){let n=null;return this.documentOverlayCache.getOverlay(t,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(t,r))).next(i=>(n!==null&&mc(n.mutation,i,dn.empty(),qt.now()),i))}getDocuments(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.getLocalViewOfDocuments(t,n,$e()).next(()=>n))}getLocalViewOfDocuments(t,r,n=$e()){const i=ha();return this.populateOverlays(t,i,r).next(()=>this.computeViews(t,r,i,n).next(s=>{let a=Kl();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(t,r){const n=ha();return this.populateOverlays(t,n,r).next(()=>this.computeViews(t,r,n,$e()))}populateOverlays(t,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(t,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(t,r,n,i){let s=Wi();const a=pc(),o=function(){return pc()}();return r.forEach((l,c)=>{const u=n.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof Ys)?s=s.insert(c.key,c):u!==void 0?(a.set(c.key,u.mutation.getFieldMask()),mc(u.mutation,c,u.mutation.getFieldMask(),qt.now())):a.set(c.key,dn.empty())}),this.recalculateAndSaveOverlays(t,s).next(l=>(l.forEach((c,u)=>a.set(c,u)),r.forEach((c,u)=>{var f;return o.set(c,new wM(u,(f=a.get(c))!==null&&f!==void 0?f:null))}),o))}recalculateAndSaveOverlays(t,r){const n=pc();let i=new kt((a,o)=>a-o),s=$e();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||dn.empty();u=o.applyToLocalView(c,u),n.set(l,u);const f=(i.get(o.batchId)||$e()).add(l);i=i.insert(o.batchId,f)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,f=FS();u.forEach(h=>{if(!s.has(h)){const d=VS(r.get(h),n.get(h));d!==null&&f.set(h,d),s=s.add(h)}}),a.push(this.documentOverlayCache.saveOverlays(t,c,f))}return ie.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.recalculateAndSaveOverlays(t,n))}getDocumentsMatchingQuery(t,r,n,i){return function(a){return Re.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(t,r.path):SS(r)?this.getDocumentsMatchingCollectionGroupQuery(t,r,n,i):this.getDocumentsMatchingCollectionQuery(t,r,n,i)}getNextDocuments(t,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,r,n.largestBatchId,i-s.size):ie.resolve(ha());let o=-1,l=s;return a.next(c=>ie.forEach(c,(u,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),s.get(u)?ie.resolve():this.remoteDocumentCache.getEntry(t,u).next(h=>{l=l.insert(u,h)}))).next(()=>this.populateOverlays(t,c,s)).next(()=>this.computeViews(t,l,c,$e())).next(u=>({batchId:o,changes:PS(u)})))})}getDocumentsMatchingDocumentQuery(t,r){return this.getDocument(t,new Re(r)).next(n=>{let i=Kl();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(t,r,n,i){const s=r.collectionGroup;let a=Kl();return this.indexManager.getCollectionParents(t,s).next(o=>ie.forEach(o,l=>{const c=function(f,h){return new dl(h,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(t,c,n,i).next(u=>{u.forEach((f,h)=>{a=a.insert(f,h)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(t,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(t,r,n,s,i))).next(a=>{s.forEach((l,c)=>{const u=c.getKey();a.get(u)===null&&(a=a.insert(u,Sr.newInvalidDocument(u)))});let o=Kl();return a.forEach((l,c)=>{const u=s.get(l);u!==void 0&&mc(u.mutation,c,dn.empty(),qt.now()),dd(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kM{constructor(t){this.serializer=t,this.ur=new Map,this.cr=new Map}getBundleMetadata(t,r){return ie.resolve(this.ur.get(r))}saveBundleMetadata(t,r){return this.ur.set(r.id,function(i){return{id:i.id,version:i.version,createTime:gi(i.createTime)}}(r)),ie.resolve()}getNamedQuery(t,r){return ie.resolve(this.cr.get(r))}saveNamedQuery(t,r){return this.cr.set(r.name,function(i){return{name:i.name,query:_M(i.bundledQuery),readTime:gi(i.readTime)}}(r)),ie.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AM{constructor(){this.overlays=new kt(Re.comparator),this.lr=new Map}getOverlay(t,r){return ie.resolve(this.overlays.get(r))}getOverlays(t,r){const n=ha();return ie.forEach(r,i=>this.getOverlay(t,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(t,r,n){return n.forEach((i,s)=>{this.lt(t,r,s)}),ie.resolve()}removeOverlaysForBatchId(t,r,n){const i=this.lr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(n)),ie.resolve()}getOverlaysForCollection(t,r,n){const i=ha(),s=r.length+1,a=new Re(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return ie.resolve(i)}getOverlaysForCollectionGroup(t,r,n,i){let s=new kt((c,u)=>c-u);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=s.get(c.largestBatchId);u===null&&(u=ha(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=ha(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=i)););return ie.resolve(o)}lt(t,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.lr.get(i.largestBatchId).delete(n.key);this.lr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new q6(r,n));let s=this.lr.get(r);s===void 0&&(s=$e(),this.lr.set(r,s)),this.lr.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(){this.hr=new dr(Jt.Pr),this.Ir=new dr(Jt.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(t,r){const n=new Jt(t,r);this.hr=this.hr.add(n),this.Ir=this.Ir.add(n)}Er(t,r){t.forEach(n=>this.addReference(n,r))}removeReference(t,r){this.dr(new Jt(t,r))}Ar(t,r){t.forEach(n=>this.removeReference(n,r))}Rr(t){const r=new Re(new ht([])),n=new Jt(r,t),i=new Jt(r,t+1),s=[];return this.Ir.forEachInRange([n,i],a=>{this.dr(a),s.push(a.key)}),s}Vr(){this.hr.forEach(t=>this.dr(t))}dr(t){this.hr=this.hr.delete(t),this.Ir=this.Ir.delete(t)}mr(t){const r=new Re(new ht([])),n=new Jt(r,t),i=new Jt(r,t+1);let s=$e();return this.Ir.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(t){const r=new Jt(t,0),n=this.hr.firstAfterOrEqual(r);return n!==null&&t.isEqual(n.key)}}class Jt{constructor(t,r){this.key=t,this.gr=r}static Pr(t,r){return Re.comparator(t.key,r.key)||tt(t.gr,r.gr)}static Tr(t,r){return tt(t.gr,r.gr)||Re.comparator(t.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SM{constructor(t,r){this.indexManager=t,this.referenceDelegate=r,this.mutationQueue=[],this.pr=1,this.yr=new dr(Jt.Pr)}checkEmpty(t){return ie.resolve(this.mutationQueue.length===0)}addMutationBatch(t,r,n,i){const s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new K6(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.yr=this.yr.add(new Jt(o.key,s)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return ie.resolve(a)}lookupMutationBatch(t,r){return ie.resolve(this.wr(r))}getNextMutationBatchAfterBatchId(t,r){const n=r+1,i=this.Sr(n),s=i<0?0:i;return ie.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(t){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,r){const n=new Jt(r,0),i=new Jt(r,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([n,i],a=>{const o=this.wr(a.gr);s.push(o)}),ie.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,r){let n=new dr(tt);return r.forEach(i=>{const s=new Jt(i,0),a=new Jt(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,a],o=>{n=n.add(o.gr)})}),ie.resolve(this.br(n))}getAllMutationBatchesAffectingQuery(t,r){const n=r.path,i=n.length+1;let s=n;Re.isDocumentKey(s)||(s=s.child(""));const a=new Jt(new Re(s),0);let o=new dr(tt);return this.yr.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.gr)),!0)},a),ie.resolve(this.br(o))}br(t){const r=[];return t.forEach(n=>{const i=this.wr(n);i!==null&&r.push(i)}),r}removeMutationBatch(t,r){pt(this.Dr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.yr;return ie.forEach(r.mutations,i=>{const s=new Jt(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.yr=n})}Fn(t){}containsKey(t,r){const n=new Jt(r,0),i=this.yr.firstAfterOrEqual(n);return ie.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,ie.resolve()}Dr(t,r){return this.Sr(t)}Sr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}wr(t){const r=this.Sr(t);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IM{constructor(t){this.Cr=t,this.docs=function(){return new kt(Re.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Cr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const r=this.docs.get(t);r&&(this.docs=this.docs.remove(t),this.size-=r.size)}getEntry(t,r){const n=this.docs.get(r);return ie.resolve(n?n.document.mutableCopy():Sr.newInvalidDocument(r))}getEntries(t,r){let n=Wi();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Sr.newInvalidDocument(i))}),ie.resolve(n)}getDocumentsMatchingQuery(t,r,n,i){let s=Wi();const a=r.path,o=new Re(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||d6(h6(u),n)<=0||(i.has(u.key)||dd(r,u))&&(s=s.insert(u.key,u.mutableCopy()))}return ie.resolve(s)}getAllFromCollectionGroup(t,r,n,i){Ne()}vr(t,r){return ie.forEach(this.docs,n=>r(n))}newChangeBuffer(t){return new CM(this)}getSize(t){return ie.resolve(this.size)}}class CM extends EM{constructor(t){super(),this._r=t}applyChanges(t){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this._r.addEntry(t,i)):this._r.removeEntry(n)}),ie.waitFor(r)}getFromCache(t,r){return this._r.getEntry(t,r)}getAllFromCache(t,r){return this._r.getEntries(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RM{constructor(t){this.persistence=t,this.Fr=new pl(r=>Dv(r),Ov),this.lastRemoteSnapshotVersion=Oe.min(),this.highestTargetId=0,this.Mr=0,this.Or=new Uv,this.targetCount=0,this.Nr=Yo.On()}forEachTarget(t,r){return this.Fr.forEach((n,i)=>r(i)),ie.resolve()}getLastRemoteSnapshotVersion(t){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return ie.resolve(this.Mr)}allocateTargetId(t){return this.highestTargetId=this.Nr.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(t,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Mr&&(this.Mr=r),ie.resolve()}kn(t){this.Fr.set(t.target,t);const r=t.targetId;r>this.highestTargetId&&(this.Nr=new Yo(r),this.highestTargetId=r),t.sequenceNumber>this.Mr&&(this.Mr=t.sequenceNumber)}addTargetData(t,r){return this.kn(r),this.targetCount+=1,ie.resolve()}updateTargetData(t,r){return this.kn(r),ie.resolve()}removeTargetData(t,r){return this.Fr.delete(r.target),this.Or.Rr(r.targetId),this.targetCount-=1,ie.resolve()}removeTargets(t,r,n){let i=0;const s=[];return this.Fr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Fr.delete(a),s.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)}),ie.waitFor(s).next(()=>i)}getTargetCount(t){return ie.resolve(this.targetCount)}getTargetData(t,r){const n=this.Fr.get(r)||null;return ie.resolve(n)}addMatchingKeys(t,r,n){return this.Or.Er(r,n),ie.resolve()}removeMatchingKeys(t,r,n){this.Or.Ar(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(t,a))}),ie.waitFor(s)}removeMatchingKeysForTargetId(t,r){return this.Or.Rr(r),ie.resolve()}getMatchingKeysForTargetId(t,r){const n=this.Or.mr(r);return ie.resolve(n)}containsKey(t,r){return ie.resolve(this.Or.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PM{constructor(t,r){this.Br={},this.overlays={},this.Lr=new Rv(0),this.kr=!1,this.kr=!0,this.referenceDelegate=t(this),this.qr=new RM(this),this.indexManager=new xM,this.remoteDocumentCache=function(i){return new IM(i)}(n=>this.referenceDelegate.Qr(n)),this.serializer=new vM(r),this.Kr=new kM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let r=this.overlays[t.toKey()];return r||(r=new AM,this.overlays[t.toKey()]=r),r}getMutationQueue(t,r){let n=this.Br[t.toKey()];return n||(n=new SM(r,this.referenceDelegate),this.Br[t.toKey()]=n),n}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(t,r,n){Ie("MemoryPersistence","Starting transaction:",t);const i=new FM(this.Lr.next());return this.referenceDelegate.$r(),n(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(t,r){return ie.or(Object.values(this.Br).map(n=>()=>n.containsKey(t,r)))}}class FM extends m6{constructor(t){super(),this.currentSequenceNumber=t}}class Bv{constructor(t){this.persistence=t,this.Gr=new Uv,this.zr=null}static jr(t){return new Bv(t)}get Hr(){if(this.zr)return this.zr;throw Ne()}addReference(t,r,n){return this.Gr.addReference(n,r),this.Hr.delete(n.toString()),ie.resolve()}removeReference(t,r,n){return this.Gr.removeReference(n,r),this.Hr.add(n.toString()),ie.resolve()}markPotentiallyOrphaned(t,r){return this.Hr.add(r.toString()),ie.resolve()}removeTarget(t,r){this.Gr.Rr(r.targetId).forEach(i=>this.Hr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,r.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>n.removeTargetData(t,r))}$r(){this.zr=new Set}Ur(t){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.Hr,n=>{const i=Re.fromPath(n);return this.Jr(t,i).next(s=>{s||r.removeEntry(i,Oe.min())})}).next(()=>(this.zr=null,r.apply(t)))}updateLimboDocument(t,r){return this.Jr(t,r).next(n=>{n?this.Hr.delete(r.toString()):this.Hr.add(r.toString())})}Qr(t){return 0}Jr(t,r){return ie.or([()=>ie.resolve(this.Gr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(t,r),()=>this.persistence.Wr(t,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jv{constructor(t,r,n,i){this.targetId=t,this.fromCache=r,this.ki=n,this.qi=i}static Qi(t,r){let n=$e(),i=$e();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new jv(t,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(t,r){this.Gi=t,this.indexManager=r,this.Ki=!0}getDocumentsMatchingQuery(t,r,n,i){const s={result:null};return this.zi(t,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ji(t,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new NM;return this.Hi(t,r,a).next(o=>{if(s.result=o,this.$i)return this.Ji(t,r,a,o.size)})}).next(()=>s.result)}Ji(t,r,n,i){return n.documentReadCount<this.Ui?(Ll()<=Ge.DEBUG&&Ie("QueryEngine","SDK will not create cache indexes for query:",ro(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),ie.resolve()):(Ll()<=Ge.DEBUG&&Ie("QueryEngine","Query:",ro(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Wi*i?(Ll()<=Ge.DEBUG&&Ie("QueryEngine","The SDK decides to create cache indexes for query:",ro(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,mi(r))):ie.resolve())}zi(t,r){if(hE(r))return ie.resolve(null);let n=mi(r);return this.indexManager.getIndexType(t,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=n0(r,null,"F"),n=mi(r)),this.indexManager.getDocumentsMatchingTarget(t,n).next(s=>{const a=$e(...s);return this.Gi.getDocuments(t,a).next(o=>this.indexManager.getMinOffset(t,n).next(l=>{const c=this.Yi(r,o);return this.Zi(r,c,a,l.readTime)?this.zi(t,n0(r,null,"F")):this.Xi(t,c,r,l)}))})))}ji(t,r,n,i){return hE(r)||i.isEqual(Oe.min())?ie.resolve(null):this.Gi.getDocuments(t,n).next(s=>{const a=this.Yi(r,s);return this.Zi(r,a,n,i)?ie.resolve(null):(Ll()<=Ge.DEBUG&&Ie("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ro(r)),this.Xi(t,a,r,f6(i,-1)).next(o=>o))})}Yi(t,r){let n=new dr(CS(t));return r.forEach((i,s)=>{dd(t,s)&&(n=n.add(s))}),n}Zi(t,r,n,i){if(t.limit===null)return!1;if(n.size!==r.size)return!0;const s=t.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(t,r,n){return Ll()<=Ge.DEBUG&&Ie("QueryEngine","Using full collection scan to execute query:",ro(r)),this.Gi.getDocumentsMatchingQuery(t,r,Us.min(),n)}Xi(t,r,n,i){return this.Gi.getDocumentsMatchingQuery(t,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(t,r,n,i){this.persistence=t,this.es=r,this.serializer=i,this.ts=new kt(tt),this.ns=new pl(s=>Dv(s),Ov),this.rs=new Map,this.ss=t.getRemoteDocumentCache(),this.qr=t.getTargetCache(),this.Kr=t.getBundleCache(),this.os(n)}os(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new TM(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>t.collect(r,this.ts))}}function LM(e,t,r,n){return new OM(e,t,r,n)}async function YS(e,t){const r=Ve(e);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.os(t),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=$e();for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({_s:c,removedBatchIds:a,addedBatchIds:o}))})})}function bM(e,t){const r=Ve(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=t.batch.keys(),s=r.ss.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const f=c.batch,h=f.keys();let d=ie.resolve();return h.forEach(m=>{d=d.next(()=>u.getEntry(l,m)).next(p=>{const g=c.docVersions.get(m);pt(g!==null),p.version.compareTo(g)<0&&(f.applyToRemoteDocument(p,c),p.isValidDocument()&&(p.setReadTime(c.commitVersion),u.addEntry(p)))})}),d.next(()=>o.mutationQueue.removeMutationBatch(l,f))}(r,n,t,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=$e();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(t))).next(()=>r.localDocuments.getDocuments(n,i))})}function QS(e){const t=Ve(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",r=>t.qr.getLastRemoteSnapshotVersion(r))}function MM(e,t){const r=Ve(e),n=t.snapshotVersion;let i=r.ts;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.ss.newChangeBuffer({trackRemovals:!0});i=r.ts;const o=[];t.targetChanges.forEach((u,f)=>{const h=i.get(f);if(!h)return;o.push(r.qr.removeMatchingKeys(s,u.removedDocuments,f).next(()=>r.qr.addMatchingKeys(s,u.addedDocuments,f)));let d=h.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(f)!==null?d=d.withResumeToken(Or.EMPTY_BYTE_STRING,Oe.min()).withLastLimboFreeSnapshotVersion(Oe.min()):u.resumeToken.approximateByteSize()>0&&(d=d.withResumeToken(u.resumeToken,n)),i=i.insert(f,d),function(p,g,x){return p.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(h,d,u)&&o.push(r.qr.updateTargetData(s,d))});let l=Wi(),c=$e();if(t.documentUpdates.forEach(u=>{t.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,u))}),o.push(VM(s,a,t.documentUpdates).next(u=>{l=u.us,c=u.cs})),!n.isEqual(Oe.min())){const u=r.qr.getLastRemoteSnapshotVersion(s).next(f=>r.qr.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(u)}return ie.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.ts=i,s))}function VM(e,t,r){let n=$e(),i=$e();return r.forEach(s=>n=n.add(s)),t.getEntries(e,n).next(s=>{let a=Wi();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Oe.min())?(t.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),a=a.insert(o,l)):Ie("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{us:a,cs:i}})}function UM(e,t){const r=Ve(e);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(t===void 0&&(t=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,t)))}function BM(e,t){const r=Ve(e);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.qr.getTargetData(n,t).next(s=>s?(i=s,ie.resolve(i)):r.qr.allocateTargetId(n).next(a=>(i=new gs(t,a,"TargetPurposeListen",n.currentSequenceNumber),r.qr.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.ts.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.ts=r.ts.insert(n.targetId,n),r.ns.set(t,n.targetId)),n})}async function Pg(e,t,r){const n=Ve(e),i=n.ts.get(t),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!ju(a))throw a;Ie("LocalStore",`Failed to update sequence numbers for target ${t}: ${a}`)}n.ts=n.ts.remove(t),n.ns.delete(i.target)}function TE(e,t,r){const n=Ve(e);let i=Oe.min(),s=$e();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,u){const f=Ve(l),h=f.ns.get(u);return h!==void 0?ie.resolve(f.ts.get(h)):f.qr.getTargetData(c,u)}(n,a,mi(t)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.qr.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.es.getDocumentsMatchingQuery(a,t,r?i:Oe.min(),r?s:$e())).next(o=>(jM(n,N6(t),o),{documents:o,ls:s})))}function jM(e,t,r){let n=e.rs.get(t)||Oe.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),e.rs.set(t,n)}class kE{constructor(){this.activeTargetIds=V6()}ds(t){this.activeTargetIds=this.activeTargetIds.add(t)}As(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Es(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class $M{constructor(){this.eo=new kE,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,r,n){}addLocalQueryTarget(t){return this.eo.ds(t),this.no[t]||"not-current"}updateQueryState(t,r,n){this.no[t]=r}removeLocalQueryTarget(t){this.eo.As(t)}isLocalQueryTarget(t){return this.eo.activeTargetIds.has(t)}clearQueryState(t){delete this.no[t]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(t){return this.eo.activeTargetIds.has(t)}start(){return this.eo=new kE,Promise.resolve()}handleUserChange(t,r,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HM{ro(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(t){this.ao.push(t)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){Ie("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ao)t(0)}_o(){Ie("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ao)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pf=null;function Rp(){return Pf===null?Pf=function(){return 268435456+Math.round(2147483648*Math.random())}():Pf++,"0x"+Pf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WM{constructor(t){this.co=t.co,this.lo=t.lo}ho(t){this.Po=t}Io(t){this.To=t}onMessage(t){this.Eo=t}close(){this.lo()}send(t){this.co(t)}Ao(){this.Po()}Ro(t){this.To(t)}Vo(t){this.Eo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yr="WebChannelConnection";class GM extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=n+"://"+r.host,this.fo=`projects/${i}/databases/${s}`,this.po=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(r,n,i,s,a){const o=Rp(),l=this.So(r,n);Ie("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(c,s,a),this.Do(r,l,c,i).then(u=>(Ie("RestConnection",`Received RPC '${r}' ${o}: `,u),u),u=>{throw Go("RestConnection",`RPC '${r}' ${o} failed with error: `,u,"url: ",l,"request:",i),u})}Co(r,n,i,s,a,o){return this.wo(r,n,i,s,a)}bo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+hl}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}So(r,n){const i=zM[r];return`${this.mo}/v1/${n}:${i}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Do(t,r,n,i){const s=Rp();return new Promise((a,o)=>{const l=new e6;l.setWithCredentials(!0),l.listenOnce(Qb.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Ip.NO_ERROR:const u=l.getResponseJson();Ie(yr,`XHR for RPC '${t}' ${s} received:`,JSON.stringify(u)),a(u);break;case Ip.TIMEOUT:Ie(yr,`RPC '${t}' ${s} timed out`),o(new Te(ee.DEADLINE_EXCEEDED,"Request time out"));break;case Ip.HTTP_ERROR:const f=l.getStatus();if(Ie(yr,`RPC '${t}' ${s} failed with status:`,f,"response text:",l.getResponseText()),f>0){let h=l.getResponseJson();Array.isArray(h)&&(h=h[0]);const d=h==null?void 0:h.error;if(d&&d.status&&d.message){const m=function(g){const x=g.toLowerCase().replace(/_/g,"-");return Object.values(ee).indexOf(x)>=0?x:ee.UNKNOWN}(d.status);o(new Te(m,d.message))}else o(new Te(ee.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new Te(ee.UNAVAILABLE,"Connection failed."));break;default:Ne()}}finally{Ie(yr,`RPC '${t}' ${s} completed.`)}});const c=JSON.stringify(i);Ie(yr,`RPC '${t}' ${s} sending request:`,i),l.send(r,"POST",c,n,15)})}vo(t,r,n){const i=Rp(),s=[this.mo,"/","google.firestore.v1.Firestore","/",t,"/channel"],a=Xb(),o=Yb(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.xmlHttpFactory=new Zb({})),this.bo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=s.join("");Ie(yr,`Creating RPC '${t}' stream ${i}: ${u}`,l);const f=a.createWebChannel(u,l);let h=!1,d=!1;const m=new WM({co:g=>{d?Ie(yr,`Not sending because RPC '${t}' stream ${i} is closed:`,g):(h||(Ie(yr,`Opening RPC '${t}' stream ${i} transport.`),f.open(),h=!0),Ie(yr,`RPC '${t}' stream ${i} sending:`,g),f.send(g))},lo:()=>f.close()}),p=(g,x,_)=>{g.listen(x,v=>{try{_(v)}catch(T){setTimeout(()=>{throw T},0)}})};return p(f,If.EventType.OPEN,()=>{d||Ie(yr,`RPC '${t}' stream ${i} transport opened.`)}),p(f,If.EventType.CLOSE,()=>{d||(d=!0,Ie(yr,`RPC '${t}' stream ${i} transport closed`),m.Ro())}),p(f,If.EventType.ERROR,g=>{d||(d=!0,Go(yr,`RPC '${t}' stream ${i} transport errored:`,g),m.Ro(new Te(ee.UNAVAILABLE,"The operation could not be completed")))}),p(f,If.EventType.MESSAGE,g=>{var x;if(!d){const _=g.data[0];pt(!!_);const v=_,T=v.error||((x=v[0])===null||x===void 0?void 0:x.error);if(T){Ie(yr,`RPC '${t}' stream ${i} received error:`,T);const k=T.status;let A=function(O){const M=Mt[O];if(M!==void 0)return jS(M)}(k),E=T.message;A===void 0&&(A=ee.INTERNAL,E="Unknown error status: "+k+" with message "+T.message),d=!0,m.Ro(new Te(A,E)),f.close()}else Ie(yr,`RPC '${t}' stream ${i} received:`,_),m.Vo(_)}}),p(o,Jb.STAT_EVENT,g=>{g.stat===tE.PROXY?Ie(yr,`RPC '${t}' stream ${i} detected buffering proxy`):g.stat===tE.NOPROXY&&Ie(yr,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{m.Ao()},0),m}}function Pp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vd(e){return new nM(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(t,r,n=1e3,i=1.5,s=6e4){this.si=t,this.timerId=r,this.Fo=n,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(t){this.cancel();const r=Math.floor(this.Oo+this.qo()),n=Math.max(0,Date.now()-this.Bo),i=Math.max(0,r-n);i>0&&Ie("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),t())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(t,r,n,i,s,a,o,l){this.si=t,this.Ko=n,this.$o=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new JS(t,r)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(t){this.t_(),this.stream.send(t)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(t,r){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,t!==4?this.zo.reset():r&&r.code===ee.RESOURCE_EXHAUSTED?(zi(r.toString()),zi("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):r&&r.code===ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Io(r)}r_(){}auth(){this.state=1;const t=this.i_(this.Uo),r=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Uo===r&&this.s_(n,i)},n=>{t(()=>{const i=new Te(ee.UNKNOWN,"Fetching auth token failed: "+n.message);return this.o_(i)})})}s_(t,r){const n=this.i_(this.Uo);this.stream=this.__(t,r),this.stream.ho(()=>{n(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{n(()=>this.o_(i))}),this.stream.onMessage(i=>{n(()=>this.onMessage(i))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(t){return Ie("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}i_(t){return r=>{this.si.enqueueAndForget(()=>this.Uo===t?r():(Ie("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class KM extends ZS{constructor(t,r,n,i,s,a){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}__(t,r){return this.connection.vo("Listen",t,r)}onMessage(t){this.zo.reset();const r=aM(this.serializer,t),n=function(s){if(!("targetChange"in s))return Oe.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Oe.min():a.readTime?gi(a.readTime):Oe.min()}(t);return this.listener.a_(r,n)}u_(t){const r={};r.database=Rg(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=kg(l)?{documents:cM(s,l)}:{query:uM(s,l)},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=zS(s,a.resumeToken);const c=Sg(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Oe.min())>0){o.readTime=a0(s,a.snapshotVersion.toTimestamp());const c=Sg(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,t);const n=hM(this.serializer,t);n&&(r.labels=n),this.e_(r)}c_(t){const r={};r.database=Rg(this.serializer),r.removeTarget=t,this.e_(r)}}class qM extends ZS{constructor(t,r,n,i,s,a){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(t,r){return this.connection.vo("Write",t,r)}onMessage(t){if(pt(!!t.streamToken),this.lastStreamToken=t.streamToken,this.l_){this.zo.reset();const r=lM(t.writeResults,t.commitTime),n=gi(t.commitTime);return this.listener.I_(n,r)}return pt(!t.writeResults||t.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const t={};t.database=Rg(this.serializer),this.e_(t)}P_(t){const r={streamToken:this.lastStreamToken,writes:t.map(n=>oM(this.serializer,n))};this.e_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XM extends class{}{constructor(t,r,n,i){super(),this.authCredentials=t,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new Te(ee.FAILED_PRECONDITION,"The client has already been terminated.")}wo(t,r,n){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(t,r,n,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Te(ee.UNKNOWN,i.toString())})}Co(t,r,n,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(t,r,n,s,a,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Te(ee.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class YM{constructor(t,r){this.asyncQueue=t,this.onlineStateHandler=r,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(t){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.p_("Offline")))}set(t){this.S_(),this.V_=0,t==="Online"&&(this.f_=!1),this.p_(t)}p_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}y_(t){const r=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(zi(r),this.f_=!1):Ie("OnlineStateTracker",r)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(t,r,n,i,s){this.localStore=t,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{n.enqueueAndForget(async()=>{za(this)&&(Ie("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=Ve(l);c.C_.add(4),await zu(c),c.M_.set("Unknown"),c.C_.delete(4),await _d(c)}(this))})}),this.M_=new YM(n,i)}}async function _d(e){if(za(e))for(const t of e.v_)await t(!0)}async function zu(e){for(const t of e.v_)await t(!1)}function eI(e,t){const r=Ve(e);r.D_.has(t.targetId)||(r.D_.set(t.targetId,t),zv(r)?Hv(r):ml(r).Ho()&&$v(r,t))}function tI(e,t){const r=Ve(e),n=ml(r);r.D_.delete(t),n.Ho()&&rI(r,t),r.D_.size===0&&(n.Ho()?n.Zo():za(r)&&r.M_.set("Unknown"))}function $v(e,t){if(e.x_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Oe.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}ml(e).u_(t)}function rI(e,t){e.x_.Oe(t),ml(e).c_(t)}function Hv(e){e.x_=new Z6({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>e.D_.get(t)||null,nt:()=>e.datastore.serializer.databaseId}),ml(e).start(),e.M_.g_()}function zv(e){return za(e)&&!ml(e).jo()&&e.D_.size>0}function za(e){return Ve(e).C_.size===0}function nI(e){e.x_=void 0}async function JM(e){e.D_.forEach((t,r)=>{$v(e,t)})}async function ZM(e,t){nI(e),zv(e)?(e.M_.w_(t),Hv(e)):e.M_.set("Unknown")}async function e8(e,t,r){if(e.M_.set("Online"),t instanceof HS&&t.state===2&&t.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.D_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.D_.delete(o),i.x_.removeTarget(o))}(e,t)}catch(n){Ie("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await o0(e,n)}else if(t instanceof ch?e.x_.$e(t):t instanceof $S?e.x_.Je(t):e.x_.Ge(t),!r.isEqual(Oe.min()))try{const n=await QS(e.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.x_.it(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=s.D_.get(c);u&&s.D_.set(c,u.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const u=s.D_.get(l);if(!u)return;s.D_.set(l,u.withResumeToken(Or.EMPTY_BYTE_STRING,u.snapshotVersion)),rI(s,l);const f=new gs(u.target,l,c,u.sequenceNumber);$v(s,f)}),s.remoteSyncer.applyRemoteEvent(o)}(e,r)}catch(n){Ie("RemoteStore","Failed to raise snapshot:",n),await o0(e,n)}}async function o0(e,t,r){if(!ju(t))throw t;e.C_.add(1),await zu(e),e.M_.set("Offline"),r||(r=()=>QS(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Ie("RemoteStore","Retrying IndexedDB access"),await r(),e.C_.delete(1),await _d(e)})}function iI(e,t){return t().catch(r=>o0(e,r,t))}async function xd(e){const t=Ve(e),r=js(t);let n=t.b_.length>0?t.b_[t.b_.length-1].batchId:-1;for(;t8(t);)try{const i=await UM(t.localStore,n);if(i===null){t.b_.length===0&&r.Zo();break}n=i.batchId,r8(t,i)}catch(i){await o0(t,i)}sI(t)&&aI(t)}function t8(e){return za(e)&&e.b_.length<10}function r8(e,t){e.b_.push(t);const r=js(e);r.Ho()&&r.h_&&r.P_(t.mutations)}function sI(e){return za(e)&&!js(e).jo()&&e.b_.length>0}function aI(e){js(e).start()}async function n8(e){js(e).E_()}async function i8(e){const t=js(e);for(const r of e.b_)t.P_(r.mutations)}async function s8(e,t,r){const n=e.b_.shift(),i=bv.from(n,t,r);await iI(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await xd(e)}async function a8(e,t){t&&js(e).h_&&await async function(n,i){if(function(a){return Y6(a)&&a!==ee.ABORTED}(i.code)){const s=n.b_.shift();js(n).Yo(),await iI(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await xd(n)}}(e,t),sI(e)&&aI(e)}async function SE(e,t){const r=Ve(e);r.asyncQueue.verifyOperationInProgress(),Ie("RemoteStore","RemoteStore received new credentials");const n=za(r);r.C_.add(3),await zu(r),n&&r.M_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.C_.delete(3),await _d(r)}async function o8(e,t){const r=Ve(e);t?(r.C_.delete(2),await _d(r)):t||(r.C_.add(2),await zu(r),r.M_.set("Unknown"))}function ml(e){return e.O_||(e.O_=function(r,n,i){const s=Ve(r);return s.A_(),new KM(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{ho:JM.bind(null,e),Io:ZM.bind(null,e),a_:e8.bind(null,e)}),e.v_.push(async t=>{t?(e.O_.Yo(),zv(e)?Hv(e):e.M_.set("Unknown")):(await e.O_.stop(),nI(e))})),e.O_}function js(e){return e.N_||(e.N_=function(r,n,i){const s=Ve(r);return s.A_(),new qM(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{ho:n8.bind(null,e),Io:a8.bind(null,e),T_:i8.bind(null,e),I_:s8.bind(null,e)}),e.v_.push(async t=>{t?(e.N_.Yo(),await xd(e)):(await e.N_.stop(),e.b_.length>0&&(Ie("RemoteStore",`Stopping write stream with ${e.b_.length} pending writes`),e.b_=[]))})),e.N_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(t,r,n,i,s){this.asyncQueue=t,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Li,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,r,n,i,s){const a=Date.now()+n,o=new Wv(t,r,a,i,s);return o.start(n),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Te(ee.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Gv(e,t){if(zi("AsyncQueue",`${t}: ${e}`),ju(e))return new Te(ee.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(t){this.comparator=t?(r,n)=>t(r,n)||Re.comparator(r.key,n.key):(r,n)=>Re.comparator(r.key,n.key),this.keyedMap=Kl(),this.sortedSet=new kt(this.comparator)}static emptySet(t){return new Do(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const r=this.keyedMap.get(t);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((r,n)=>(t(r),!1))}add(t){const r=this.delete(t.key);return r.copy(r.keyedMap.insert(t.key,t),r.sortedSet.insert(t,null))}delete(t){const r=this.get(t);return r?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(r)):this}isEqual(t){if(!(t instanceof Do)||this.size!==t.size)return!1;const r=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(r=>{t.push(r.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,r){const n=new Do;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(){this.B_=new kt(Re.comparator)}track(t){const r=t.doc.key,n=this.B_.get(r);n?t.type!==0&&n.type===3?this.B_=this.B_.insert(r,t):t.type===3&&n.type!==1?this.B_=this.B_.insert(r,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.B_=this.B_.insert(r,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.B_=this.B_.insert(r,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.B_=this.B_.remove(r):t.type===1&&n.type===2?this.B_=this.B_.insert(r,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.B_=this.B_.insert(r,{type:2,doc:t.doc}):Ne():this.B_=this.B_.insert(r,t)}L_(){const t=[];return this.B_.inorderTraversal((r,n)=>{t.push(n)}),t}}class Qo{constructor(t,r,n,i,s,a,o,l,c){this.query=t,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Qo(t,r,Do.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&hd(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const r=this.docChanges,n=t.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l8{constructor(){this.k_=void 0,this.listeners=[]}}class c8{constructor(){this.queries=new pl(t=>IS(t),hd),this.onlineState="Unknown",this.q_=new Set}}async function oI(e,t){const r=Ve(e),n=t.query;let i=!1,s=r.queries.get(n);if(s||(i=!0,s=new l8),i)try{s.k_=await r.onListen(n)}catch(a){const o=Gv(a,`Initialization of query '${ro(t.query)}' failed`);return void t.onError(o)}r.queries.set(n,s),s.listeners.push(t),t.Q_(r.onlineState),s.k_&&t.K_(s.k_)&&Kv(r)}async function lI(e,t){const r=Ve(e),n=t.query;let i=!1;const s=r.queries.get(n);if(s){const a=s.listeners.indexOf(t);a>=0&&(s.listeners.splice(a,1),i=s.listeners.length===0)}if(i)return r.queries.delete(n),r.onUnlisten(n)}function u8(e,t){const r=Ve(e);let n=!1;for(const i of t){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.listeners)o.K_(i)&&(n=!0);a.k_=i}}n&&Kv(r)}function f8(e,t,r){const n=Ve(e),i=n.queries.get(t);if(i)for(const s of i.listeners)s.onError(r);n.queries.delete(t)}function Kv(e){e.q_.forEach(t=>{t.next()})}class cI{constructor(t,r,n){this.query=t,this.U_=r,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=n||{}}K_(t){if(!this.options.includeMetadataChanges){const n=[];for(const i of t.docChanges)i.type!==3&&n.push(i);t=new Qo(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let r=!1;return this.W_?this.z_(t)&&(this.U_.next(t),r=!0):this.j_(t,this.onlineState)&&(this.H_(t),r=!0),this.G_=t,r}onError(t){this.U_.error(t)}Q_(t){this.onlineState=t;let r=!1;return this.G_&&!this.W_&&this.j_(this.G_,t)&&(this.H_(this.G_),r=!0),r}j_(t,r){if(!t.fromCache)return!0;const n=r!=="Offline";return(!this.options.J_||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||r==="Offline")}z_(t){if(t.docChanges.length>0)return!0;const r=this.G_&&this.G_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}H_(t){t=Qo.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.W_=!0,this.U_.next(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(t){this.key=t}}class fI{constructor(t){this.key=t}}class h8{constructor(t,r){this.query=t,this.ia=r,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=$e(),this.mutatedKeys=$e(),this._a=CS(t),this.aa=new Do(this._a)}get ua(){return this.ia}ca(t,r){const n=r?r.la:new IE,i=r?r.aa:this.aa;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((u,f)=>{const h=i.get(u),d=dd(this.query,f)?f:null,m=!!h&&this.mutatedKeys.has(h.key),p=!!d&&(d.hasLocalMutations||this.mutatedKeys.has(d.key)&&d.hasCommittedMutations);let g=!1;h&&d?h.data.isEqual(d.data)?m!==p&&(n.track({type:3,doc:d}),g=!0):this.ha(h,d)||(n.track({type:2,doc:d}),g=!0,(l&&this._a(d,l)>0||c&&this._a(d,c)<0)&&(o=!0)):!h&&d?(n.track({type:0,doc:d}),g=!0):h&&!d&&(n.track({type:1,doc:h}),g=!0,(l||c)&&(o=!0)),g&&(d?(a=a.add(d),s=p?s.add(u):s.delete(u)):(a=a.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),s=s.delete(u.key),n.track({type:1,doc:u})}return{aa:a,la:n,Zi:o,mutatedKeys:s}}ha(t,r){return t.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(t,r,n){const i=this.aa;this.aa=t.aa,this.mutatedKeys=t.mutatedKeys;const s=t.la.L_();s.sort((c,u)=>function(h,d){const m=p=>{switch(p){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ne()}};return m(h)-m(d)}(c.type,u.type)||this._a(c.doc,u.doc)),this.Pa(n);const a=r?this.Ia():[],o=this.oa.size===0&&this.current?1:0,l=o!==this.sa;return this.sa=o,s.length!==0||l?{snapshot:new Qo(this.query,t.aa,i,s,t.mutatedKeys,o===0,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ta:a}:{Ta:a}}Q_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new IE,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(t){return!this.ia.has(t)&&!!this.aa.has(t)&&!this.aa.get(t).hasLocalMutations}Pa(t){t&&(t.addedDocuments.forEach(r=>this.ia=this.ia.add(r)),t.modifiedDocuments.forEach(r=>{}),t.removedDocuments.forEach(r=>this.ia=this.ia.delete(r)),this.current=t.current)}Ia(){if(!this.current)return[];const t=this.oa;this.oa=$e(),this.aa.forEach(n=>{this.Ea(n.key)&&(this.oa=this.oa.add(n.key))});const r=[];return t.forEach(n=>{this.oa.has(n)||r.push(new fI(n))}),this.oa.forEach(n=>{t.has(n)||r.push(new uI(n))}),r}da(t){this.ia=t.ls,this.oa=$e();const r=this.ca(t.documents);return this.applyChanges(r,!0)}Aa(){return Qo.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class d8{constructor(t,r,n){this.query=t,this.targetId=r,this.view=n}}class p8{constructor(t){this.key=t,this.Ra=!1}}class m8{constructor(t,r,n,i,s,a){this.localStore=t,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Va={},this.ma=new pl(o=>IS(o),hd),this.fa=new Map,this.ga=new Set,this.pa=new kt(Re.comparator),this.ya=new Map,this.wa=new Uv,this.Sa={},this.ba=new Map,this.Da=Yo.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function g8(e,t){const r=S8(e);let n,i;const s=r.ma.get(t);if(s)n=s.targetId,r.sharedClientState.addLocalQueryTarget(n),i=s.view.Aa();else{const a=await BM(r.localStore,mi(t)),o=r.sharedClientState.addLocalQueryTarget(a.targetId);n=a.targetId,i=await v8(r,t,n,o==="current",a.resumeToken),r.isPrimaryClient&&eI(r.remoteStore,a)}return i}async function v8(e,t,r,n,i){e.va=(f,h,d)=>async function(p,g,x,_){let v=g.view.ca(x);v.Zi&&(v=await TE(p.localStore,g.query,!1).then(({documents:A})=>g.view.ca(A,v)));const T=_&&_.targetChanges.get(g.targetId),k=g.view.applyChanges(v,p.isPrimaryClient,T);return RE(p,g.targetId,k.Ta),k.snapshot}(e,f,h,d);const s=await TE(e.localStore,t,!0),a=new h8(t,s.ls),o=a.ca(s.documents),l=Hu.createSynthesizedTargetChangeForCurrentChange(r,n&&e.onlineState!=="Offline",i),c=a.applyChanges(o,e.isPrimaryClient,l);RE(e,r,c.Ta);const u=new d8(t,r,a);return e.ma.set(t,u),e.fa.has(r)?e.fa.get(r).push(t):e.fa.set(r,[t]),c.snapshot}async function _8(e,t){const r=Ve(e),n=r.ma.get(t),i=r.fa.get(n.targetId);if(i.length>1)return r.fa.set(n.targetId,i.filter(s=>!hd(s,t))),void r.ma.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(n.targetId),r.sharedClientState.isActiveQueryTarget(n.targetId)||await Pg(r.localStore,n.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(n.targetId),tI(r.remoteStore,n.targetId),Fg(r,n.targetId)}).catch(Bu)):(Fg(r,n.targetId),await Pg(r.localStore,n.targetId,!0))}async function x8(e,t,r){const n=I8(e);try{const i=await function(a,o){const l=Ve(a),c=qt.now(),u=o.reduce((d,m)=>d.add(m.key),$e());let f,h;return l.persistence.runTransaction("Locally write mutations","readwrite",d=>{let m=Wi(),p=$e();return l.ss.getEntries(d,u).next(g=>{m=g,m.forEach((x,_)=>{_.isValidDocument()||(p=p.add(x))})}).next(()=>l.localDocuments.getOverlayedDocuments(d,m)).next(g=>{f=g;const x=[];for(const _ of o){const v=W6(_,f.get(_.key).overlayedDocument);v!=null&&x.push(new Ys(_.key,v,xS(v.value.mapValue),qn.exists(!0)))}return l.mutationQueue.addMutationBatch(d,c,x,o)}).next(g=>{h=g;const x=g.applyToLocalDocumentSet(f,p);return l.documentOverlayCache.saveOverlays(d,g.batchId,x)})}).then(()=>({batchId:h.batchId,changes:PS(f)}))}(n.localStore,t);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let c=a.Sa[a.currentUser.toKey()];c||(c=new kt(tt)),c=c.insert(o,l),a.Sa[a.currentUser.toKey()]=c}(n,i.batchId,r),await Wu(n,i.changes),await xd(n.remoteStore)}catch(i){const s=Gv(i,"Failed to persist write");r.reject(s)}}async function hI(e,t){const r=Ve(e);try{const n=await MM(r.localStore,t);t.targetChanges.forEach((i,s)=>{const a=r.ya.get(s);a&&(pt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.Ra=!0:i.modifiedDocuments.size>0?pt(a.Ra):i.removedDocuments.size>0&&(pt(a.Ra),a.Ra=!1))}),await Wu(r,n,t)}catch(n){await Bu(n)}}function CE(e,t,r){const n=Ve(e);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.ma.forEach((s,a)=>{const o=a.view.Q_(t);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=Ve(a);l.onlineState=o;let c=!1;l.queries.forEach((u,f)=>{for(const h of f.listeners)h.Q_(o)&&(c=!0)}),c&&Kv(l)}(n.eventManager,t),i.length&&n.Va.a_(i),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function y8(e,t,r){const n=Ve(e);n.sharedClientState.updateQueryState(t,"rejected",r);const i=n.ya.get(t),s=i&&i.key;if(s){let a=new kt(Re.comparator);a=a.insert(s,Sr.newNoDocument(s,Oe.min()));const o=$e().add(s),l=new gd(Oe.min(),new Map,new kt(tt),a,o);await hI(n,l),n.pa=n.pa.remove(s),n.ya.delete(t),qv(n)}else await Pg(n.localStore,t,!1).then(()=>Fg(n,t,r)).catch(Bu)}async function E8(e,t){const r=Ve(e),n=t.batch.batchId;try{const i=await bM(r.localStore,t);pI(r,n,null),dI(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Wu(r,i)}catch(i){await Bu(i)}}async function w8(e,t,r){const n=Ve(e);try{const i=await function(a,o){const l=Ve(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(f=>(pt(f!==null),u=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,t);pI(n,t,r),dI(n,t),n.sharedClientState.updateMutationState(t,"rejected",r),await Wu(n,i)}catch(i){await Bu(i)}}function dI(e,t){(e.ba.get(t)||[]).forEach(r=>{r.resolve()}),e.ba.delete(t)}function pI(e,t,r){const n=Ve(e);let i=n.Sa[n.currentUser.toKey()];if(i){const s=i.get(t);s&&(r?s.reject(r):s.resolve(),i=i.remove(t)),n.Sa[n.currentUser.toKey()]=i}}function Fg(e,t,r=null){e.sharedClientState.removeLocalQueryTarget(t);for(const n of e.fa.get(t))e.ma.delete(n),r&&e.Va.Fa(n,r);e.fa.delete(t),e.isPrimaryClient&&e.wa.Rr(t).forEach(n=>{e.wa.containsKey(n)||mI(e,n)})}function mI(e,t){e.ga.delete(t.path.canonicalString());const r=e.pa.get(t);r!==null&&(tI(e.remoteStore,r),e.pa=e.pa.remove(t),e.ya.delete(r),qv(e))}function RE(e,t,r){for(const n of r)n instanceof uI?(e.wa.addReference(n.key,t),T8(e,n)):n instanceof fI?(Ie("SyncEngine","Document no longer in limbo: "+n.key),e.wa.removeReference(n.key,t),e.wa.containsKey(n.key)||mI(e,n.key)):Ne()}function T8(e,t){const r=t.key,n=r.path.canonicalString();e.pa.get(r)||e.ga.has(n)||(Ie("SyncEngine","New document in limbo: "+r),e.ga.add(n),qv(e))}function qv(e){for(;e.ga.size>0&&e.pa.size<e.maxConcurrentLimboResolutions;){const t=e.ga.values().next().value;e.ga.delete(t);const r=new Re(ht.fromString(t)),n=e.Da.next();e.ya.set(n,new p8(r)),e.pa=e.pa.insert(r,n),eI(e.remoteStore,new gs(mi(Lv(r.path)),n,"TargetPurposeLimboResolution",Rv._e))}}async function Wu(e,t,r){const n=Ve(e),i=[],s=[],a=[];n.ma.isEmpty()||(n.ma.forEach((o,l)=>{a.push(n.va(l,t,r).then(c=>{if((c||r)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(l.targetId,c!=null&&c.fromCache?"not-current":"current"),c){i.push(c);const u=jv.Qi(l.targetId,c);s.push(u)}}))}),await Promise.all(a),n.Va.a_(i),await async function(l,c){const u=Ve(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>ie.forEach(c,h=>ie.forEach(h.ki,d=>u.persistence.referenceDelegate.addReference(f,h.targetId,d)).next(()=>ie.forEach(h.qi,d=>u.persistence.referenceDelegate.removeReference(f,h.targetId,d)))))}catch(f){if(!ju(f))throw f;Ie("LocalStore","Failed to update sequence numbers: "+f)}for(const f of c){const h=f.targetId;if(!f.fromCache){const d=u.ts.get(h),m=d.snapshotVersion,p=d.withLastLimboFreeSnapshotVersion(m);u.ts=u.ts.insert(h,p)}}}(n.localStore,s))}async function k8(e,t){const r=Ve(e);if(!r.currentUser.isEqual(t)){Ie("SyncEngine","User change. New user:",t.toKey());const n=await YS(r.localStore,t);r.currentUser=t,function(s,a){s.ba.forEach(o=>{o.forEach(l=>{l.reject(new Te(ee.CANCELLED,a))})}),s.ba.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await Wu(r,n._s)}}function A8(e,t){const r=Ve(e),n=r.ya.get(t);if(n&&n.Ra)return $e().add(n.key);{let i=$e();const s=r.fa.get(t);if(!s)return i;for(const a of s){const o=r.ma.get(a);i=i.unionWith(o.view.ua)}return i}}function S8(e){const t=Ve(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=hI.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=A8.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=y8.bind(null,t),t.Va.a_=u8.bind(null,t.eventManager),t.Va.Fa=f8.bind(null,t.eventManager),t}function I8(e){const t=Ve(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=E8.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=w8.bind(null,t),t}class PE{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=vd(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,r){return null}createIndexBackfillerScheduler(t,r){return null}createLocalStore(t){return LM(this.persistence,new DM,t.initialUser,this.serializer)}createPersistence(t){return new PM(Bv.jr,this.serializer)}createSharedClientState(t){return new $M}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class C8{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>CE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=k8.bind(null,this.syncEngine),await o8(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new c8}()}createDatastore(t){const r=vd(t.databaseInfo.databaseId),n=function(s){return new GM(s)}(t.databaseInfo);return function(s,a,o,l){return new XM(s,a,o,l)}(t.authCredentials,t.appCheckCredentials,n,r)}createRemoteStore(t){return function(n,i,s,a,o){return new QM(n,i,s,a,o)}(this.localStore,this.datastore,t.asyncQueue,r=>CE(this.syncEngine,r,0),function(){return AE.D()?new AE:new HM}())}createSyncEngine(t,r){return function(i,s,a,o,l,c,u){const f=new m8(i,s,a,o,l,c);return u&&(f.Ca=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return async function(r){const n=Ve(r);Ie("RemoteStore","RemoteStore shutting down."),n.C_.add(5),await zu(n),n.F_.shutdown(),n.M_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Oa(this.observer.next,t)}error(t){this.observer.error?this.Oa(this.observer.error,t):zi("Uncaught Error in snapshot listener:",t.toString())}Na(){this.muted=!0}Oa(t,r){this.muted||setTimeout(()=>{this.muted||t(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R8{constructor(t,r,n,i){this.authCredentials=t,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=wr.UNAUTHENTICATED,this.clientId=gS.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,async s=>{Ie("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(Ie("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Te(ee.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Li;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(r){const n=Gv(r,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function Fp(e,t){e.asyncQueue.verifyOperationInProgress(),Ie("FirestoreClient","Initializing OfflineComponentProvider");const r=await e.getConfiguration();await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async i=>{n.isEqual(i)||(await YS(t.localStore,i),n=i)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function FE(e,t){e.asyncQueue.verifyOperationInProgress();const r=await F8(e);Ie("FirestoreClient","Initializing OnlineComponentProvider");const n=await e.getConfiguration();await t.initialize(r,n),e.setCredentialChangeListener(i=>SE(t.remoteStore,i)),e.setAppCheckTokenChangeListener((i,s)=>SE(t.remoteStore,s)),e._onlineComponents=t}function P8(e){return e.name==="FirebaseError"?e.code===ee.FAILED_PRECONDITION||e.code===ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&e instanceof DOMException)||e.code===22||e.code===20||e.code===11}async function F8(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Ie("FirestoreClient","Using user provided OfflineComponentProvider");try{await Fp(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!P8(r))throw r;Go("Error using user provided cache. Falling back to memory cache: "+r),await Fp(e,new PE)}}else Ie("FirestoreClient","Using default OfflineComponentProvider"),await Fp(e,new PE);return e._offlineComponents}async function vI(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Ie("FirestoreClient","Using user provided OnlineComponentProvider"),await FE(e,e._uninitializedComponentsProvider._online)):(Ie("FirestoreClient","Using default OnlineComponentProvider"),await FE(e,new C8))),e._onlineComponents}function N8(e){return vI(e).then(t=>t.syncEngine)}async function _I(e){const t=await vI(e),r=t.eventManager;return r.onListen=g8.bind(null,t.syncEngine),r.onUnlisten=_8.bind(null,t.syncEngine),r}function D8(e,t,r={}){const n=new Li;return e.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const u=new gI({next:h=>{a.enqueueAndForget(()=>lI(s,f));const d=h.docs.has(o);!d&&h.fromCache?c.reject(new Te(ee.UNAVAILABLE,"Failed to get document because the client is offline.")):d&&h.fromCache&&l&&l.source==="server"?c.reject(new Te(ee.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),f=new cI(Lv(o.path),u,{includeMetadataChanges:!0,J_:!0});return oI(s,f)}(await _I(e),e.asyncQueue,t,r,n)),n.promise}function O8(e,t,r={}){const n=new Li;return e.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const u=new gI({next:h=>{a.enqueueAndForget(()=>lI(s,f)),h.fromCache&&l.source==="server"?c.reject(new Te(ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),f=new cI(o,u,{includeMetadataChanges:!0,J_:!0});return oI(s,f)}(await _I(e),e.asyncQueue,t,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xI(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yI(e,t,r){if(!r)throw new Te(ee.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function L8(e,t,r,n){if(t===!0&&n===!0)throw new Te(ee.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)}function DE(e){if(!Re.isDocumentKey(e))throw new Te(ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function OE(e){if(Re.isDocumentKey(e))throw new Te(ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function yd(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(n){return n.constructor?n.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":Ne()}function _i(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Te(ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=yd(e);throw new Te(ee.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}function b8(e,t){if(t<=0)throw new Te(ee.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LE{constructor(t){var r,n;if(t.host===void 0){if(t.ssl!==void 0)throw new Te(ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(r=t.ssl)===null||r===void 0||r;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new Te(ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}L8("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=xI((n=t.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Te(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Te(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Te(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Ed{constructor(t,r,n,i){this._authCredentials=t,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new LE({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Te(ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(t){if(this._settingsFrozen)throw new Te(ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new LE(t),t.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new r6;switch(n.type){case"firstParty":return new a6(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Te(ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=NE.get(r);n&&(Ie("ComponentProvider","Removing Datastore"),NE.delete(r),n.terminate())}(this),Promise.resolve()}}function M8(e,t,r,n={}){var i;const s=(e=_i(e,Ed))._getSettings(),a=`${t}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Go("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=wr.MOCK_USER;else{o=Fk(n.mockUserToken,(i=e._app)===null||i===void 0?void 0:i.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new Te(ee.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new wr(c)}e._authCredentials=new n6(new mS(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(t,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Qs(this.firestore,t,this._query)}}class Gr{constructor(t,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ds(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Gr(this.firestore,t,this._key)}}class Ds extends Qs{constructor(t,r,n){super(t,r,Lv(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Gr(this.firestore,null,new Re(t))}withConverter(t){return new Ds(this.firestore,t,this._path)}}function Wa(e,t,...r){if(e=Lt(e),yI("collection","path",t),e instanceof Ed){const n=ht.fromString(t,...r);return OE(n),new Ds(e,null,n)}{if(!(e instanceof Gr||e instanceof Ds))throw new Te(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(ht.fromString(t,...r));return OE(n),new Ds(e.firestore,null,n)}}function Xv(e,t,...r){if(e=Lt(e),arguments.length===1&&(t=gS.newId()),yI("doc","path",t),e instanceof Ed){const n=ht.fromString(t,...r);return DE(n),new Gr(e,null,new Re(n))}{if(!(e instanceof Gr||e instanceof Ds))throw new Te(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(ht.fromString(t,...r));return DE(n),new Gr(e.firestore,e instanceof Ds?e.converter:null,new Re(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V8{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new JS(this,"async_queue_retry"),this.iu=()=>{const r=Pp();r&&Ie("AsyncQueue","Visibility state changed to "+r.visibilityState),this.zo.Qo()};const t=Pp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.su(),this.ou(t)}enterRestrictedMode(t){if(!this.Za){this.Za=!0,this.nu=t||!1;const r=Pp();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.iu)}}enqueue(t){if(this.su(),this.Za)return new Promise(()=>{});const r=new Li;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Ya.push(t),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(t){if(!ju(t))throw t;Ie("AsyncQueue","Operation failed with retryable error: "+t)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(t){const r=this.Ja.then(()=>(this.tu=!0,t().catch(n=>{this.eu=n,this.tu=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw zi("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.tu=!1,n))));return this.Ja=r,r}enqueueAfterDelay(t,r,n){this.su(),this.ru.indexOf(t)>-1&&(r=0);const i=Wv.createAndSchedule(this,t,r,n,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&Ne()}verifyOperationInProgress(){}async uu(){let t;do t=this.Ja,await t;while(t!==this.Ja)}cu(t){for(const r of this.Xa)if(r.timerId===t)return!0;return!1}lu(t){return this.uu().then(()=>{this.Xa.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Xa)if(r.skipDelay(),t!=="all"&&r.timerId===t)break;return this.uu()})}hu(t){this.ru.push(t)}au(t){const r=this.Xa.indexOf(t);this.Xa.splice(r,1)}}class gl extends Ed{constructor(t,r,n,i){super(t,r,n,i),this.type="firestore",this._queue=function(){return new V8}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||EI(this),this._firestoreClient.terminate()}}function U8(e,t){const r=typeof e=="object"?e:Y1(),n=typeof e=="string"?e:t||"(default)",i=W0(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=Ck("firestore");s&&M8(i,...s)}return i}function Yv(e){return e._firestoreClient||EI(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function EI(e){var t,r,n;const i=e._freezeSettings(),s=function(o,l,c,u){return new _6(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,xI(u.experimentalLongPollingOptions),u.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new R8(e._authCredentials,e._appCheckCredentials,e._queue,s),!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Jo(Or.fromBase64String(t))}catch(r){throw new Te(ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(t){return new Jo(Or.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu{constructor(...t){for(let r=0;r<t.length;++r)if(t[r].length===0)throw new Te(ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ur(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}function B8(){return new Gu("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(t,r){if(!isFinite(t)||t<-90||t>90)throw new Te(ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(r)||r<-180||r>180)throw new Te(ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=t,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return tt(this._lat,t._lat)||tt(this._long,t._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j8=/^__.*__$/;class $8{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return this.fieldMask!==null?new Ys(t,this.data,this.fieldMask,r,this.fieldTransforms):new $u(t,this.data,r,this.fieldTransforms)}}class wI{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return new Ys(t,this.data,this.fieldMask,r,this.fieldTransforms)}}function TI(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ne()}}class Zv{constructor(t,r,n,i,s,a){this.settings=t,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(t){return new Zv(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),i=this.Tu({path:n,du:!1});return i.Au(t),i}Ru(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),i=this.Tu({path:n,du:!1});return i.Pu(),i}Vu(t){return this.Tu({path:void 0,du:!0})}mu(t){return l0(t,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(t){return this.fieldMask.find(r=>t.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>t.isPrefixOf(r.field))!==void 0}Pu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Au(this.path.get(t))}Au(t){if(t.length===0)throw this.mu("Document fields must not be empty");if(TI(this.Iu)&&j8.test(t))throw this.mu('Document fields cannot begin and end with "__"')}}class H8{constructor(t,r,n){this.databaseId=t,this.ignoreUndefinedProperties=r,this.serializer=n||vd(t)}pu(t,r,n,i=!1){return new Zv({Iu:t,methodName:r,gu:n,path:ur.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function wd(e){const t=e._freezeSettings(),r=vd(e._databaseId);return new H8(e._databaseId,!!t.ignoreUndefinedProperties,r)}function kI(e,t,r,n,i,s={}){const a=e.pu(s.merge||s.mergeFields?2:0,t,r,i);e_("Data must be an object, but it was:",a,n);const o=AI(n,a);let l,c;if(s.merge)l=new dn(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const u=[];for(const f of s.mergeFields){const h=Ng(t,f,r);if(!a.contains(h))throw new Te(ee.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);II(u,h)||u.push(h)}l=new dn(u),c=a.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=a.fieldTransforms;return new $8(new tn(o),l,c)}class Td extends Qv{_toFieldTransform(t){if(t.Iu!==2)throw t.Iu===1?t.mu(`${this._methodName}() can only appear at the top level of your update data`):t.mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Td}}function z8(e,t,r,n){const i=e.pu(1,t,r);e_("Data must be an object, but it was:",i,n);const s=[],a=tn.empty();Ha(n,(l,c)=>{const u=t_(t,l,r);c=Lt(c);const f=i.Ru(u);if(c instanceof Td)s.push(u);else{const h=Ku(c,f);h!=null&&(s.push(u),a.set(u,h))}});const o=new dn(s);return new wI(a,o,i.fieldTransforms)}function W8(e,t,r,n,i,s){const a=e.pu(1,t,r),o=[Ng(t,n,r)],l=[i];if(s.length%2!=0)throw new Te(ee.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)o.push(Ng(t,s[h])),l.push(s[h+1]);const c=[],u=tn.empty();for(let h=o.length-1;h>=0;--h)if(!II(c,o[h])){const d=o[h];let m=l[h];m=Lt(m);const p=a.Ru(d);if(m instanceof Td)c.push(d);else{const g=Ku(m,p);g!=null&&(c.push(d),u.set(d,g))}}const f=new dn(c);return new wI(u,f,a.fieldTransforms)}function G8(e,t,r,n=!1){return Ku(r,e.pu(n?4:3,t))}function Ku(e,t){if(SI(e=Lt(e)))return e_("Unsupported field value:",t,e),AI(e,t);if(e instanceof Qv)return function(n,i){if(!TI(i.Iu))throw i.mu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.du&&t.Iu!==4)throw t.mu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=Ku(o,i.Vu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(e,t)}return function(n,i){if((n=Lt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return U6(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=qt.fromDate(n);return{timestampValue:a0(i.serializer,s)}}if(n instanceof qt){const s=new qt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:a0(i.serializer,s)}}if(n instanceof Jv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Jo)return{bytesValue:zS(i.serializer,n._byteString)};if(n instanceof Gr){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Vv(n.firestore._databaseId||i.databaseId,n._key.path)}}throw i.mu(`Unsupported field value: ${yd(n)}`)}(e,t)}function AI(e,t){const r={};return vS(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ha(e,(n,i)=>{const s=Ku(i,t.Eu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function SI(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof qt||e instanceof Jv||e instanceof Jo||e instanceof Gr||e instanceof Qv)}function e_(e,t,r){if(!SI(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=yd(r);throw n==="an object"?t.mu(e+" a custom object"):t.mu(e+" "+n)}}function Ng(e,t,r){if((t=Lt(t))instanceof Gu)return t._internalPath;if(typeof t=="string")return t_(e,t);throw l0("Field path arguments must be of type string or ",e,!1,void 0,r)}const K8=new RegExp("[~\\*/\\[\\]]");function t_(e,t,r){if(t.search(K8)>=0)throw l0(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new Gu(...t.split("."))._internalPath}catch{throw l0(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function l0(e,t,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new Te(ee.INVALID_ARGUMENT,o+e+l)}function II(e,t){return e.some(r=>r.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CI{constructor(t,r,n,i,s){this._firestore=t,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Gr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new q8(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const r=this._document.data.field(kd("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r)}}}class q8 extends CI{data(){return super.data()}}function kd(e,t){return typeof t=="string"?t_(e,t):t instanceof Gu?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X8(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new Te(ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class r_{}class n_ extends r_{}function i_(e,t,...r){let n=[];t instanceof r_&&n.push(t),n=n.concat(r),function(s){const a=s.filter(l=>l instanceof s_).length,o=s.filter(l=>l instanceof Ad).length;if(a>1||a>0&&o>0)throw new Te(ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)e=i._apply(e);return e}class Ad extends n_{constructor(t,r,n){super(),this._field=t,this._op=r,this._value=n,this.type="where"}static _create(t,r,n){return new Ad(t,r,n)}_apply(t){const r=this._parse(t);return RI(t._query,r),new Qs(t.firestore,t.converter,Ag(t._query,r))}_parse(t){const r=wd(t.firestore);return function(s,a,o,l,c,u,f){let h;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Te(ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){ME(f,u);const d=[];for(const m of f)d.push(bE(l,s,m));h={arrayValue:{values:d}}}else h=bE(l,s,f)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||ME(f,u),h=G8(o,a,f,u==="in"||u==="not-in");return $t.create(c,u,h)}(t._query,"where",r,t.firestore._databaseId,this._field,this._op,this._value)}}function Y8(e,t,r){const n=t,i=kd("where",e);return Ad._create(i,n,r)}class s_ extends r_{constructor(t,r){super(),this.type=t,this._queryConstraints=r}static _create(t,r){return new s_(t,r)}_parse(t){const r=this._queryConstraints.map(n=>n._parse(t)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Zn.create(r,this._getOperator())}_apply(t){const r=this._parse(t);return r.getFilters().length===0?t:(function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)RI(a,l),a=Ag(a,l)}(t._query,r),new Qs(t.firestore,t.converter,Ag(t._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class a_ extends n_{constructor(t,r){super(),this._field=t,this._direction=r,this.type="orderBy"}static _create(t,r){return new a_(t,r)}_apply(t){const r=function(i,s,a){if(i.startAt!==null)throw new Te(ee.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Te(ee.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new lu(s,a)}(t._query,this._field,this._direction);return new Qs(t.firestore,t.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new dl(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(t._query,r))}}function Q8(e,t="asc"){const r=t,n=kd("orderBy",e);return a_._create(n,r)}class o_ extends n_{constructor(t,r,n){super(),this.type=t,this._limit=r,this._limitType=n}static _create(t,r,n){return new o_(t,r,n)}_apply(t){return new Qs(t.firestore,t.converter,n0(t._query,this._limit,this._limitType))}}function J8(e){return b8("limit",e),o_._create("limit",e,"F")}function bE(e,t,r){if(typeof(r=Lt(r))=="string"){if(r==="")throw new Te(ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!SS(t)&&r.indexOf("/")!==-1)throw new Te(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=t.path.child(ht.fromString(r));if(!Re.isDocumentKey(n))throw new Te(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return aE(e,new Re(n))}if(r instanceof Gr)return aE(e,r._key);throw new Te(ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${yd(r)}.`)}function ME(e,t){if(!Array.isArray(e)||e.length===0)throw new Te(ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function RI(e,t){const r=function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(e.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(r!==null)throw r===t.op?new Te(ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Te(ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}class Z8{convertValue(t,r="none"){switch(Na(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Bt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,r);case 5:return t.stringValue;case 6:return this.convertBytes(Fa(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,r);case 10:return this.convertObject(t.mapValue,r);default:throw Ne()}}convertObject(t,r){return this.convertObjectMap(t.fields,r)}convertObjectMap(t,r="none"){const n={};return Ha(t,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertGeoPoint(t){return new Jv(Bt(t.latitude),Bt(t.longitude))}convertArray(t,r){return(t.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(t,r){switch(r){case"previous":const n=Fv(t);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(su(t));default:return null}}convertTimestamp(t){const r=Bs(t);return new qt(r.seconds,r.nanos)}convertDocumentKey(t,r){const n=ht.fromString(t);pt(XS(n));const i=new au(n.get(1),n.get(3)),s=new Re(n.popFirst(5));return i.isEqual(r)||zi(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PI(e,t,r){let n;return n=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(t,r){this.hasPendingWrites=t,this.fromCache=r}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class FI extends CI{constructor(t,r,n,i,s,a){super(t,r,n,i,a),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const r=new uh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,r={}){if(this._document){const n=this._document.data.field(kd("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class uh extends FI{data(t={}){return super.data(t)}}class e5{constructor(t,r,n,i){this._firestore=t,this._userDataWriter=r,this._snapshot=i,this.metadata=new Xl(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach(r=>t.push(r)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,r){this._snapshot.docs.forEach(n=>{t.call(r,new uh(this._firestore,this._userDataWriter,n.key,n,new Xl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const r=!!t.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Te(ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new uh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Xl(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new uh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Xl(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,u=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),u=a.indexOf(o.doc.key)),{type:t5(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function t5(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ne()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NI(e){e=_i(e,Gr);const t=_i(e.firestore,gl);return D8(Yv(t),e._key).then(r=>r5(t,e,r))}class DI extends Z8{constructor(t){super(),this.firestore=t}convertBytes(t){return new Jo(t)}convertReference(t){const r=this.convertDocumentKey(t,this.firestore._databaseId);return new Gr(this.firestore,null,r)}}function Sd(e){e=_i(e,Qs);const t=_i(e.firestore,gl),r=Yv(t),n=new DI(t);return X8(e._query),O8(r,e._query).then(i=>new e5(t,n,e,i))}function OI(e,t,r){e=_i(e,Gr);const n=_i(e.firestore,gl),i=PI(e.converter,t,r);return c_(n,[kI(wd(n),"setDoc",e._key,i,e.converter!==null,r).toMutation(e._key,qn.none())])}function LI(e,t,r,...n){e=_i(e,Gr);const i=_i(e.firestore,gl),s=wd(i);let a;return a=typeof(t=Lt(t))=="string"||t instanceof Gu?W8(s,"updateDoc",e._key,t,r,n):z8(s,"updateDoc",e._key,t),c_(i,[a.toMutation(e._key,qn.exists(!0))])}function l_(e,t){const r=_i(e.firestore,gl),n=Xv(e),i=PI(e.converter,t);return c_(r,[kI(wd(e.firestore),"addDoc",n._key,i,e.converter!==null,{}).toMutation(n._key,qn.exists(!1))]).then(()=>n)}function c_(e,t){return function(n,i){const s=new Li;return n.asyncQueue.enqueueAndForget(async()=>x8(await N8(n),i,s)),s.promise}(Yv(e),t)}function r5(e,t,r){const n=r.docs.get(t._key),i=new DI(e);return new FI(e,i,t._key,n,new Xl(r.hasPendingWrites,r.fromCache),t.converter)}(function(t,r=!0){(function(i){hl=i})(Ba),Ca(new Vs("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new gl(new i6(n.getProvider("auth-internal")),new l6(n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Te(ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new au(c.options.projectId,u)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),hi(rE,"4.3.2",t),hi(rE,"4.3.2","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bI="firebasestorage.googleapis.com",MI="storageBucket",n5=2*60*1e3,i5=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft extends Ei{constructor(t,r,n=0){super(Np(t),`Firebase Storage: ${r} (${Np(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ft.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return Np(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Rt;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Rt||(Rt={}));function Np(e){return"storage/"+e}function u_(){const e="An unknown error occurred, please check the error payload for server response.";return new Ft(Rt.UNKNOWN,e)}function s5(e){return new Ft(Rt.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")}function a5(e){return new Ft(Rt.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function o5(){const e="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ft(Rt.UNAUTHENTICATED,e)}function l5(){return new Ft(Rt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function c5(e){return new Ft(Rt.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function u5(){return new Ft(Rt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function f5(){return new Ft(Rt.CANCELED,"User canceled the upload/download.")}function h5(e){return new Ft(Rt.INVALID_URL,"Invalid URL '"+e+"'.")}function d5(e){return new Ft(Rt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function p5(){return new Ft(Rt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+MI+"' property when initializing the app?")}function m5(){return new Ft(Rt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function g5(){return new Ft(Rt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function v5(e){return new Ft(Rt.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Dg(e){return new Ft(Rt.INVALID_ARGUMENT,e)}function VI(){return new Ft(Rt.APP_DELETED,"The Firebase app was deleted.")}function _5(e){return new Ft(Rt.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function gc(e,t){return new Ft(Rt.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function bl(e){throw new Ft(Rt.INTERNAL_ERROR,"Internal error: "+e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(t,r){this.bucket=t,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,r){let n;try{n=pn.makeFromUrl(t,r)}catch{return new pn(t,"")}if(n.path==="")return n;throw d5(t)}static makeFromUrl(t,r){let n=null;const i="([A-Za-z0-9.\\-_]+)";function s(T){T.path.charAt(T.path.length-1)==="/"&&(T.path_=T.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function c(T){T.path_=decodeURIComponent(T.path)}const u="v[A-Za-z0-9_]+",f=r.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",d=new RegExp(`^https?://${f}/${u}/b/${i}/o${h}`,"i"),m={bucket:1,path:3},p=r===bI?"(?:storage.googleapis.com|storage.cloud.google.com)":r,g="([^?#]*)",x=new RegExp(`^https?://${p}/${i}/${g}`,"i"),v=[{regex:o,indices:l,postModify:s},{regex:d,indices:m,postModify:c},{regex:x,indices:{bucket:1,path:2},postModify:c}];for(let T=0;T<v.length;T++){const k=v[T],A=k.regex.exec(t);if(A){const E=A[k.indices.bucket];let F=A[k.indices.path];F||(F=""),n=new pn(E,F),k.postModify(n);break}}if(n==null)throw h5(t);return n}}class x5{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y5(e,t,r){let n=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let c=!1;function u(...g){c||(c=!0,t.apply(null,g))}function f(g){i=setTimeout(()=>{i=null,e(d,l())},g)}function h(){s&&clearTimeout(s)}function d(g,...x){if(c){h();return}if(g){h(),u.call(null,g,...x);return}if(l()||a){h(),u.call(null,g,...x);return}n<64&&(n*=2);let v;o===1?(o=2,v=0):v=(n+Math.random())*1e3,f(v)}let m=!1;function p(g){m||(m=!0,h(),!c&&(i!==null?(g||(o=2),clearTimeout(i),f(0)):g||(o=1)))}return f(0),s=setTimeout(()=>{a=!0,p(!0)},r),p}function E5(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w5(e){return e!==void 0}function T5(e){return typeof e=="object"&&!Array.isArray(e)}function f_(e){return typeof e=="string"||e instanceof String}function VE(e){return h_()&&e instanceof Blob}function h_(){return typeof Blob<"u"&&!p3()}function UE(e,t,r,n){if(n<t)throw Dg(`Invalid value for '${e}'. Expected ${t} or greater.`);if(n>r)throw Dg(`Invalid value for '${e}'. Expected ${r} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d_(e,t,r){let n=t;return r==null&&(n=`https://${t}`),`${r}://${n}/v0${e}`}function UI(e){const t=encodeURIComponent;let r="?";for(const n in e)if(e.hasOwnProperty(n)){const i=t(n)+"="+t(e[n]);r=r+i+"&"}return r=r.slice(0,-1),r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xa;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(xa||(xa={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k5(e,t){const r=e>=500&&e<600,i=[408,429].indexOf(e)!==-1,s=t.indexOf(e)!==-1;return r||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A5{constructor(t,r,n,i,s,a,o,l,c,u,f,h=!0){this.url_=t,this.method_=r,this.headers_=n,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=f,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((d,m)=>{this.resolve_=d,this.reject_=m,this.start_()})}start_(){const t=(n,i)=>{if(i){n(!1,new Ff(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===xa.NO_ERROR,l=s.getStatus();if(!o||k5(l,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===xa.ABORT;n(!1,new Ff(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new Ff(c,s))})},r=(n,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());w5(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=u_();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?VI():f5();a(l)}else{const l=u5();a(l)}};this.canceled_?r(!1,new Ff(!1,null,!0)):this.backoffId_=y5(t,r,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&E5(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Ff{constructor(t,r,n){this.wasSuccessCode=t,this.connection=r,this.canceled=!!n}}function S5(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function I5(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function C5(e,t){t&&(e["X-Firebase-GMPID"]=t)}function R5(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function P5(e,t,r,n,i,s,a=!0){const o=UI(e.urlParams),l=e.url+o,c=Object.assign({},e.headers);return C5(c,t),S5(c,r),I5(c,s),R5(c,n),new A5(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F5(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function N5(...e){const t=F5();if(t!==void 0){const r=new t;for(let n=0;n<e.length;n++)r.append(e[n]);return r.getBlob()}else{if(h_())return new Blob(e);throw new Ft(Rt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function D5(e,t,r){return e.webkitSlice?e.webkitSlice(t,r):e.mozSlice?e.mozSlice(t,r):e.slice?e.slice(t,r):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O5(e){if(typeof atob>"u")throw v5("base-64");return atob(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const li={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Dp{constructor(t,r){this.data=t,this.contentType=r||null}}function L5(e,t){switch(e){case li.RAW:return new Dp(BI(t));case li.BASE64:case li.BASE64URL:return new Dp(jI(e,t));case li.DATA_URL:return new Dp(M5(t),V5(t))}throw u_()}function BI(e){const t=[];for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);if(n<=127)t.push(n);else if(n<=2047)t.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(r<e.length-1&&(e.charCodeAt(r+1)&64512)===56320))t.push(239,191,189);else{const s=n,a=e.charCodeAt(++r);n=65536|(s&1023)<<10|a&1023,t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?t.push(239,191,189):t.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(t)}function b5(e){let t;try{t=decodeURIComponent(e)}catch{throw gc(li.DATA_URL,"Malformed data URL.")}return BI(t)}function jI(e,t){switch(e){case li.BASE64:{const i=t.indexOf("-")!==-1,s=t.indexOf("_")!==-1;if(i||s)throw gc(e,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case li.BASE64URL:{const i=t.indexOf("+")!==-1,s=t.indexOf("/")!==-1;if(i||s)throw gc(e,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=O5(t)}catch(i){throw i.message.includes("polyfill")?i:gc(e,"Invalid character found")}const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}class $I{constructor(t){this.base64=!1,this.contentType=null;const r=t.match(/^data:([^,]+)?,/);if(r===null)throw gc(li.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=r[1]||null;n!=null&&(this.base64=U5(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=t.substring(t.indexOf(",")+1)}}function M5(e){const t=new $I(e);return t.base64?jI(li.BASE64,t.rest):b5(t.rest)}function V5(e){return new $I(e).contentType}function U5(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(t,r){let n=0,i="";VE(t)?(this.data_=t,n=t.size,i=t.type):t instanceof ArrayBuffer?(r?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(r?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=i}size(){return this.size_}type(){return this.type_}slice(t,r){if(VE(this.data_)){const n=this.data_,i=D5(n,t,r);return i===null?null:new us(i)}else{const n=new Uint8Array(this.data_.buffer,t,r-t);return new us(n,!0)}}static getBlob(...t){if(h_()){const r=t.map(n=>n instanceof us?n.data_:n);return new us(N5.apply(null,r))}else{const r=t.map(a=>f_(a)?L5(li.RAW,a).data:a.data_);let n=0;r.forEach(a=>{n+=a.byteLength});const i=new Uint8Array(n);let s=0;return r.forEach(a=>{for(let o=0;o<a.length;o++)i[s++]=a[o]}),new us(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HI(e){let t;try{t=JSON.parse(e)}catch{return null}return T5(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B5(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function j5(e,t){const r=t.split("/").filter(n=>n.length>0).join("/");return e.length===0?r:e+"/"+r}function zI(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $5(e,t){return t}class Vr{constructor(t,r,n,i){this.server=t,this.local=r||t,this.writable=!!n,this.xform=i||$5}}let Nf=null;function H5(e){return!f_(e)||e.length<2?e:zI(e)}function WI(){if(Nf)return Nf;const e=[];e.push(new Vr("bucket")),e.push(new Vr("generation")),e.push(new Vr("metageneration")),e.push(new Vr("name","fullPath",!0));function t(s,a){return H5(a)}const r=new Vr("name");r.xform=t,e.push(r);function n(s,a){return a!==void 0?Number(a):a}const i=new Vr("size");return i.xform=n,e.push(i),e.push(new Vr("timeCreated")),e.push(new Vr("updated")),e.push(new Vr("md5Hash",null,!0)),e.push(new Vr("cacheControl",null,!0)),e.push(new Vr("contentDisposition",null,!0)),e.push(new Vr("contentEncoding",null,!0)),e.push(new Vr("contentLanguage",null,!0)),e.push(new Vr("contentType",null,!0)),e.push(new Vr("metadata","customMetadata",!0)),Nf=e,Nf}function z5(e,t){function r(){const n=e.bucket,i=e.fullPath,s=new pn(n,i);return t._makeStorageReference(s)}Object.defineProperty(e,"ref",{get:r})}function W5(e,t,r){const n={};n.type="file";const i=r.length;for(let s=0;s<i;s++){const a=r[s];n[a.local]=a.xform(n,t[a.server])}return z5(n,e),n}function GI(e,t,r){const n=HI(t);return n===null?null:W5(e,n,r)}function G5(e,t,r,n){const i=HI(t);if(i===null||!f_(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const a=encodeURIComponent;return s.split(",").map(c=>{const u=e.bucket,f=e.fullPath,h="/b/"+a(u)+"/o/"+a(f),d=d_(h,r,n),m=UI({alt:"media",token:c});return d+m})[0]}function K5(e,t){const r={},n=t.length;for(let i=0;i<n;i++){const s=t[i];s.writable&&(r[s.server]=e[s.local])}return JSON.stringify(r)}class KI{constructor(t,r,n,i){this.url=t,this.method=r,this.handler=n,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qI(e){if(!e)throw u_()}function q5(e,t){function r(n,i){const s=GI(e,i,t);return qI(s!==null),s}return r}function X5(e,t){function r(n,i){const s=GI(e,i,t);return qI(s!==null),G5(s,i,e.host,e._protocol)}return r}function XI(e){function t(r,n){let i;return r.getStatus()===401?r.getErrorText().includes("Firebase App Check token is invalid")?i=l5():i=o5():r.getStatus()===402?i=a5(e.bucket):r.getStatus()===403?i=c5(e.path):i=n,i.status=r.getStatus(),i.serverResponse=n.serverResponse,i}return t}function Y5(e){const t=XI(e);function r(n,i){let s=t(n,i);return n.getStatus()===404&&(s=s5(e.path)),s.serverResponse=i.serverResponse,s}return r}function Q5(e,t,r){const n=t.fullServerUrl(),i=d_(n,e.host,e._protocol),s="GET",a=e.maxOperationRetryTime,o=new KI(i,s,X5(e,r),a);return o.errorHandler=Y5(t),o}function J5(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function Z5(e,t,r){const n=Object.assign({},r);return n.fullPath=e.path,n.size=t.size(),n.contentType||(n.contentType=J5(null,t)),n}function e9(e,t,r,n,i){const s=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function o(){let v="";for(let T=0;T<2;T++)v=v+Math.random().toString().slice(2);return v}const l=o();a["Content-Type"]="multipart/related; boundary="+l;const c=Z5(t,n,i),u=K5(c,r),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,h=`\r
--`+l+"--",d=us.getBlob(f,n,h);if(d===null)throw m5();const m={name:c.fullPath},p=d_(s,e.host,e._protocol),g="POST",x=e.maxUploadRetryTime,_=new KI(p,g,q5(e,r),x);return _.urlParams=m,_.headers=a,_.body=d.uploadData(),_.errorHandler=XI(t),_}class t9{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=xa.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=xa.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=xa.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,r,n,i){if(this.sent_)throw bl("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(r,t,!0),i!==void 0)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return n!==void 0?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw bl("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw bl("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw bl("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw bl("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class r9 extends t9{initXhr(){this.xhr_.responseType="text"}}function YI(){return new r9}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(t,r){this._service=t,r instanceof pn?this._location=r:this._location=pn.makeFromUrl(r,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,r){return new Da(t,r)}get root(){const t=new pn(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return zI(this._location.path)}get storage(){return this._service}get parent(){const t=B5(this._location.path);if(t===null)return null;const r=new pn(this._location.bucket,t);return new Da(this._service,r)}_throwIfRoot(t){if(this._location.path==="")throw _5(t)}}function n9(e,t,r){e._throwIfRoot("uploadBytes");const n=e9(e.storage,e._location,WI(),new us(t,!0),r);return e.storage.makeRequestWithTokens(n,YI).then(i=>({metadata:i,ref:e}))}function i9(e){e._throwIfRoot("getDownloadURL");const t=Q5(e.storage,e._location,WI());return e.storage.makeRequestWithTokens(t,YI).then(r=>{if(r===null)throw g5();return r})}function s9(e,t){const r=j5(e._location.path,t),n=new pn(e._location.bucket,r);return new Da(e.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a9(e){return/^[A-Za-z]+:\/\//.test(e)}function o9(e,t){return new Da(e,t)}function QI(e,t){if(e instanceof p_){const r=e;if(r._bucket==null)throw p5();const n=new Da(r,r._bucket);return t!=null?QI(n,t):n}else return t!==void 0?s9(e,t):e}function l9(e,t){if(t&&a9(t)){if(e instanceof p_)return o9(e,t);throw Dg("To use ref(service, url), the first argument must be a Storage instance.")}else return QI(e,t)}function BE(e,t){const r=t==null?void 0:t[MI];return r==null?null:pn.makeFromBucketSpec(r,e)}function c9(e,t,r,n={}){e.host=`${t}:${r}`,e._protocol="http";const{mockUserToken:i}=n;i&&(e._overrideAuthToken=typeof i=="string"?i:Fk(i,e.app.options.projectId))}class p_{constructor(t,r,n,i,s){this.app=t,this._authProvider=r,this._appCheckProvider=n,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=bI,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=n5,this._maxUploadRetryTime=i5,this._requests=new Set,i!=null?this._bucket=pn.makeFromBucketSpec(i,this._host):this._bucket=BE(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=pn.makeFromBucketSpec(this._url,t):this._bucket=BE(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){UE("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){UE("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const r=await t.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Da(this,t)}_makeRequest(t,r,n,i,s=!0){if(this._deleted)return new x5(VI());{const a=P5(t,this._appId,n,i,r,this._firebaseVersion,s);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(t,r){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,r,n,i).getPromise()}}const jE="@firebase/storage",$E="0.11.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JI="storage";function ZI(e,t,r){return e=Lt(e),n9(e,t,r)}function u9(e){return e=Lt(e),i9(e)}function m_(e,t){return e=Lt(e),l9(e,t)}function f9(e=Y1(),t){e=Lt(e);const n=W0(e,JI).getImmediate({identifier:t}),i=Ck("storage");return i&&h9(n,...i),n}function h9(e,t,r,n={}){c9(e,t,r,n)}function d9(e,{instanceIdentifier:t}){const r=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new p_(r,n,i,t,Ba)}function p9(){Ca(new Vs(JI,d9,"PUBLIC").setMultipleInstances(!0)),hi(jE,$E,""),hi(jE,$E,"esm2017")}p9();const m9={apiKey:"AIzaSyBktaPDjpc5sEMyZN7RCrlPPrupX9aFAOo",authDomain:"portal-impacto-ba606.firebaseapp.com",projectId:"portal-impacto-ba606",storageBucket:"portal-impacto-ba606.appspot.com",messagingSenderId:{}.VITE_FIREBASE_MESSAGING_ID,appId:"1:973609007998:web:41d149e29165aecdb1912f"},g_=Ok(m9),$s=GL(g_),Xi=U8(g_),v_=f9(g_),g9=(e,t)=>FO($s,e,t),eC=()=>$s.currentUser!==null,v9=async()=>{try{await OO($s)}catch(e){console.error("logout",e)}},_9=async e=>{try{return await l_(Wa(Xi,"Week"),{...e,userId:$s.currentUser.uid})}catch(t){console.error("Error adding document: ",t)}},x9=async e=>{try{return await l_(Wa(Xi,"Activity"),{...e,userId:$s.currentUser.uid})}catch(t){console.error("Error adding document: ",t)}},y9=async({itemsPerPage:e})=>{try{const t=i_(Wa(Xi,"Activity"),Q8("week_name","desc"),J8(e)),r=await Sd(t),n=[];return r.forEach(i=>{const s=i.data();n.push({id:i.id,data:s})}),n}catch(t){throw console.error("Error al obtener actividades: ",t),t}},E9=async e=>{try{return await l_(Wa(Xi,"ActivityStatusHistory",B8),{...e,userId:$s.currentUser.uid})}catch(t){console.error("Error adding document: ",t)}},w9=async()=>{try{const e=i_(Wa(Xi,"ActivityStatusHistory")),t=await Sd(e),r=[];return t.forEach(n=>{const i=n.data();r.push({id:n.id,data:{...i,activity:i.activity}})}),r}catch(e){throw console.error("Error al obtener estados: ",e),e}},T9=async(e,t)=>{try{const r=i_(Wa(Xi,"ActivityStatusHistory"),Y8("activity","==",e)),n=await Sd(r);if(n.empty)console.error("Error: Document not found.");else{const i=n.docs[0].ref,s=n.docs[0].data();if(s.status_history||(s.status_history=[]),s.status_history.push({previous_status:s.status||"",previous_status_description:s.description||"",previous_created_by:s.created_by||"",previous_created_at:s.created_at||""}),Object.keys(t).every(o=>t[o]!==void 0)){const o={...t,activity:s.activity,status_history:s.status_history};console.log(o);try{await OI(i,o),console.log("Document updated successfully")}catch(l){console.error("Error updating the document:",l)}}else console.error("Error: Update data contains undefined values.")}}catch(r){console.error("Error:",r)}},k9=async(e,t)=>{try{const r=Xv(Xi,"Activity",e),n=await NI(r);if(n.exists()){const s={...n.data(),current_status:t};await LI(r,s),console.log("Campo 'current_status' actualizado en la colección 'Activity'")}else console.error("Error: Documento no encontrado en la colección 'Activity'")}catch(r){console.error("Error:",r)}};async function A9(e,t){const r=m_(v_,`${t}.xlsx`);await ZI(r,e)}const S9=async(e,t)=>{try{const r=Xv(Xi,"ActivityLog",e),n=await NI(r);if(n.exists()){const i=n.data();if((i.activity||"")===e){const o=[...i.history||[],{activity_id:i3(),activity_log_written_by:i.activity_log_written_by||"",activity_log_creation_date:i.activity_log_creation_date||"",activity_log_GPS:i.activity_log_GPS||"",activity_log_description:i.activity_log_description||"",activity_log_file_names:i.activity_log_file_names||""}];await LI(r,{...t,userId:$s.currentUser.uid,history:o})}else console.error("El documentId y la actividad existente no coinciden.")}else await OI(r,{...t,userId:$s.currentUser.uid,activity:e,history:[]})}catch(r){throw console.error("Error al agregar documento:",r),r}};async function I9(e){const t=m_(v_,`ActivityLogFile/${e[0].name}`);await ZI(t,e[0])}const Id=async e=>{try{return(await Sd(Wa(Xi,e))).docs.map(n=>({id:n.id,data:n.data()}))}catch(t){throw console.error("Error al obtener documentos: ",t),t}},C9=async()=>Id("Week"),R9=async()=>Id("Activity"),P9=async()=>Id("ActivityStatusHistory"),F9=async()=>Id("ActivityLog"),tC=async e=>{try{const t=m_(v_,"gs://portal-impacto-ba606.appspot.com/ActivityLogFile/"+e);return await u9(t)}catch(t){throw console.error("Error al obtener la URL de descarga:",t),t}};var qu=e=>e.type==="checkbox",Eo=e=>e instanceof Date,Br=e=>e==null;const rC=e=>typeof e=="object";var Yt=e=>!Br(e)&&!Array.isArray(e)&&rC(e)&&!Eo(e),nC=e=>Yt(e)&&e.target?qu(e.target)?e.target.checked:e.target.value:e,N9=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,iC=(e,t)=>e.has(N9(t)),D9=e=>{const t=e.constructor&&e.constructor.prototype;return Yt(t)&&t.hasOwnProperty("isPrototypeOf")},__=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Tr(e){let t;const r=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(__&&(e instanceof Blob||e instanceof FileList))&&(r||Yt(e)))if(t=r?[]:{},!r&&!D9(e))t=e;else for(const n in e)e.hasOwnProperty(n)&&(t[n]=Tr(e[n]));else return e;return t}var vl=e=>Array.isArray(e)?e.filter(Boolean):[],ut=e=>e===void 0,ve=(e,t,r)=>{if(!t||!Yt(e))return r;const n=vl(t.split(/[,[\].]+?/)).reduce((i,s)=>Br(i)?i:i[s],e);return ut(n)||n===e?ut(e[t])?r:e[t]:n},vs=e=>typeof e=="boolean";const c0={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Rn={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ai={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},O9=Se.createContext(null),Cd=()=>Se.useContext(O9);var sC=(e,t,r,n=!0)=>{const i={defaultValues:t._defaultValues};for(const s in e)Object.defineProperty(i,s,{get:()=>{const a=s;return t._proxyFormState[a]!==Rn.all&&(t._proxyFormState[a]=!n||Rn.all),r&&(r[a]=!0),e[a]}});return i},cn=e=>Yt(e)&&!Object.keys(e).length,aC=(e,t,r,n)=>{r(e);const{name:i,...s}=e;return cn(s)||Object.keys(s).length>=Object.keys(t).length||Object.keys(s).find(a=>t[a]===(!n||Rn.all))},mn=e=>Array.isArray(e)?e:[e],oC=(e,t,r)=>!e||!t||e===t||mn(e).some(n=>n&&(r?n===t:n.startsWith(t)||t.startsWith(n)));function Rd(e){const t=Se.useRef(e);t.current=e,Se.useEffect(()=>{const r=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{r&&r.unsubscribe()}},[e.disabled])}function L9(e){const t=Cd(),{control:r=t.control,disabled:n,name:i,exact:s}=e||{},[a,o]=Se.useState(r._formState),l=Se.useRef(!0),c=Se.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),u=Se.useRef(i);return u.current=i,Rd({disabled:n,next:f=>l.current&&oC(u.current,f.name,s)&&aC(f,c.current,r._updateFormState)&&o({...r._formState,...f}),subject:r._subjects.state}),Se.useEffect(()=>(l.current=!0,c.current.isValid&&r._updateValid(!0),()=>{l.current=!1}),[r]),sC(a,r,c.current,!1)}var ci=e=>typeof e=="string",lC=(e,t,r,n,i)=>ci(e)?(n&&t.watch.add(e),ve(r,e,i)):Array.isArray(e)?e.map(s=>(n&&t.watch.add(s),ve(r,s))):(n&&(t.watchAll=!0),r);function b9(e){const t=Cd(),{control:r=t.control,name:n,defaultValue:i,disabled:s,exact:a}=e||{},o=Se.useRef(n);o.current=n,Rd({disabled:s,subject:r._subjects.values,next:u=>{oC(o.current,u.name,a)&&c(Tr(lC(o.current,r._names,u.values||r._formValues,!1,i)))}});const[l,c]=Se.useState(r._getWatch(n,i));return Se.useEffect(()=>r._removeUnmounted()),l}var x_=e=>/^\w*$/.test(e),cC=e=>vl(e.replace(/["|']|\]/g,"").split(/\.|\[/));function st(e,t,r){let n=-1;const i=x_(t)?[t]:cC(t),s=i.length,a=s-1;for(;++n<s;){const o=i[n];let l=r;if(n!==a){const c=e[o];l=Yt(c)||Array.isArray(c)?c:isNaN(+i[n+1])?{}:[]}e[o]=l,e=e[o]}return e}function M9(e){const t=Cd(),{name:r,disabled:n,control:i=t.control,shouldUnregister:s}=e,a=iC(i._names.array,r),o=b9({control:i,name:r,defaultValue:ve(i._formValues,r,ve(i._defaultValues,r,e.defaultValue)),exact:!0}),l=L9({control:i,name:r}),c=Se.useRef(i.register(r,{...e.rules,value:o}));return c.current=i.register(r,e.rules),Se.useEffect(()=>{const u=i._options.shouldUnregister||s,f=(h,d)=>{const m=ve(i._fields,h);m&&(m._f.mount=d)};if(f(r,!0),u){const h=Tr(ve(i._options.defaultValues,r));st(i._defaultValues,r,h),ut(ve(i._formValues,r))&&st(i._formValues,r,h)}return()=>{(a?u&&!i._state.action:u)?i.unregister(r):f(r,!1)}},[r,i,a,s]),Se.useEffect(()=>{ve(i._fields,r)&&i._updateDisabledField({disabled:n,fields:i._fields,name:r})},[n,r,i]),{field:{name:r,value:o,...vs(n)?{disabled:n}:{},onChange:Se.useCallback(u=>c.current.onChange({target:{value:nC(u),name:r},type:c0.CHANGE}),[r]),onBlur:Se.useCallback(()=>c.current.onBlur({target:{value:ve(i._formValues,r),name:r},type:c0.BLUR}),[r,i]),ref:u=>{const f=ve(i._fields,r);f&&u&&(f._f.ref={focus:()=>u.focus(),select:()=>u.select(),setCustomValidity:h=>u.setCustomValidity(h),reportValidity:()=>u.reportValidity()})}},formState:l,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!ve(l.errors,r)},isDirty:{enumerable:!0,get:()=>!!ve(l.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!ve(l.touchedFields,r)},error:{enumerable:!0,get:()=>ve(l.errors,r)}})}}const Os=e=>e.render(M9(e));var V9=(e,t,r,n,i)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[n]:i||!0}}:{};const u0=(e,t,r)=>{for(const n of r||Object.keys(e)){const i=ve(e,n);if(i){const{_f:s,...a}=i;if(s&&t(s.name)){if(s.ref.focus){s.ref.focus();break}else if(s.refs&&s.refs[0].focus){s.refs[0].focus();break}}else Yt(a)&&u0(a,t)}}};var Zi=()=>{const e=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const r=(Math.random()*16+e)%16|0;return(t=="x"?r:r&3|8).toString(16)})},Op=(e,t,r={})=>r.shouldFocus||ut(r.shouldFocus)?r.focusName||`${e}.${ut(r.focusIndex)?t:r.focusIndex}.`:"",Og=e=>({isOnSubmit:!e||e===Rn.onSubmit,isOnBlur:e===Rn.onBlur,isOnChange:e===Rn.onChange,isOnAll:e===Rn.all,isOnTouch:e===Rn.onTouched}),Lg=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length)))),uC=(e,t,r)=>{const n=vl(ve(e,r));return st(n,"root",t[r]),st(e,r,n),e},y_=e=>e.type==="file",_s=e=>typeof e=="function",f0=e=>{if(!__)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},fh=e=>ci(e),E_=e=>e.type==="radio",h0=e=>e instanceof RegExp;const HE={value:!1,isValid:!1},zE={value:!0,isValid:!0};var fC=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!ut(e[0].attributes.value)?ut(e[0].value)||e[0].value===""?zE:{value:e[0].value,isValid:!0}:zE:HE}return HE};const WE={isValid:!1,value:null};var hC=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,WE):WE;function GE(e,t,r="validate"){if(fh(e)||Array.isArray(e)&&e.every(fh)||vs(e)&&!e)return{type:r,message:fh(e)?e:"",ref:t}}var eo=e=>Yt(e)&&!h0(e)?e:{value:e,message:""},bg=async(e,t,r,n,i)=>{const{ref:s,refs:a,required:o,maxLength:l,minLength:c,min:u,max:f,pattern:h,validate:d,name:m,valueAsNumber:p,mount:g,disabled:x}=e._f,_=ve(t,m);if(!g||x)return{};const v=a?a[0]:s,T=b=>{n&&v.reportValidity&&(v.setCustomValidity(vs(b)?"":b||""),v.reportValidity())},k={},A=E_(s),E=qu(s),F=A||E,O=(p||y_(s))&&ut(s.value)&&ut(_)||f0(s)&&s.value===""||_===""||Array.isArray(_)&&!_.length,M=V9.bind(null,m,r,k),j=(b,X,ne,re=Ai.maxLength,se=Ai.minLength)=>{const ue=b?X:ne;k[m]={type:b?re:se,message:ue,ref:s,...M(b?re:se,ue)}};if(i?!Array.isArray(_)||!_.length:o&&(!F&&(O||Br(_))||vs(_)&&!_||E&&!fC(a).isValid||A&&!hC(a).isValid)){const{value:b,message:X}=fh(o)?{value:!!o,message:o}:eo(o);if(b&&(k[m]={type:Ai.required,message:X,ref:v,...M(Ai.required,X)},!r))return T(X),k}if(!O&&(!Br(u)||!Br(f))){let b,X;const ne=eo(f),re=eo(u);if(!Br(_)&&!isNaN(_)){const se=s.valueAsNumber||_&&+_;Br(ne.value)||(b=se>ne.value),Br(re.value)||(X=se<re.value)}else{const se=s.valueAsDate||new Date(_),ue=ce=>new Date(new Date().toDateString()+" "+ce),te=s.type=="time",V=s.type=="week";ci(ne.value)&&_&&(b=te?ue(_)>ue(ne.value):V?_>ne.value:se>new Date(ne.value)),ci(re.value)&&_&&(X=te?ue(_)<ue(re.value):V?_<re.value:se<new Date(re.value))}if((b||X)&&(j(!!b,ne.message,re.message,Ai.max,Ai.min),!r))return T(k[m].message),k}if((l||c)&&!O&&(ci(_)||i&&Array.isArray(_))){const b=eo(l),X=eo(c),ne=!Br(b.value)&&_.length>+b.value,re=!Br(X.value)&&_.length<+X.value;if((ne||re)&&(j(ne,b.message,X.message),!r))return T(k[m].message),k}if(h&&!O&&ci(_)){const{value:b,message:X}=eo(h);if(h0(b)&&!_.match(b)&&(k[m]={type:Ai.pattern,message:X,ref:s,...M(Ai.pattern,X)},!r))return T(X),k}if(d){if(_s(d)){const b=await d(_,t),X=GE(b,v);if(X&&(k[m]={...X,...M(Ai.validate,X.message)},!r))return T(X.message),k}else if(Yt(d)){let b={};for(const X in d){if(!cn(b)&&!r)break;const ne=GE(await d[X](_,t),v,X);ne&&(b={...ne,...M(X,ne.message)},T(ne.message),r&&(k[m]=b))}if(!cn(b)&&(k[m]={ref:v,...b},!r))return k}}return T(!0),k};function Lp(e,t){return[...e,...mn(t)]}var bp=e=>Array.isArray(e)?e.map(()=>{}):void 0;function Mp(e,t,r){return[...e.slice(0,t),...mn(r),...e.slice(t)]}var Vp=(e,t,r)=>Array.isArray(e)?(ut(e[r])&&(e[r]=void 0),e.splice(r,0,e.splice(t,1)[0]),e):[];function Up(e,t){return[...mn(t),...mn(e)]}function U9(e,t){let r=0;const n=[...e];for(const i of t)n.splice(i-r,1),r++;return vl(n).length?n:[]}var Bp=(e,t)=>ut(t)?[]:U9(e,mn(t).sort((r,n)=>r-n)),jp=(e,t,r)=>{e[t]=[e[r],e[r]=e[t]][0]};function B9(e,t){const r=t.slice(0,-1).length;let n=0;for(;n<r;)e=ut(e)?n++:e[t[n++]];return e}function j9(e){for(const t in e)if(e.hasOwnProperty(t)&&!ut(e[t]))return!1;return!0}function Qt(e,t){const r=Array.isArray(t)?t:x_(t)?[t]:cC(t),n=r.length===1?e:B9(e,r),i=r.length-1,s=r[i];return n&&delete n[s],i!==0&&(Yt(n)&&cn(n)||Array.isArray(n)&&j9(n))&&Qt(e,r.slice(0,-1)),e}var KE=(e,t,r)=>(e[t]=r,e);function $9(e){const t=Cd(),{control:r=t.control,name:n,keyName:i="id",shouldUnregister:s}=e,[a,o]=Se.useState(r._getFieldArray(n)),l=Se.useRef(r._getFieldArray(n).map(Zi)),c=Se.useRef(a),u=Se.useRef(n),f=Se.useRef(!1);u.current=n,c.current=a,r._names.array.add(n),e.rules&&r.register(n,e.rules),Rd({next:({values:k,name:A})=>{if(A===u.current||!A){const E=ve(k,u.current);Array.isArray(E)&&(o(E),l.current=E.map(Zi))}},subject:r._subjects.array});const h=Se.useCallback(k=>{f.current=!0,r._updateFieldArray(n,k)},[r,n]),d=(k,A)=>{const E=mn(Tr(k)),F=Lp(r._getFieldArray(n),E);r._names.focus=Op(n,F.length-1,A),l.current=Lp(l.current,E.map(Zi)),h(F),o(F),r._updateFieldArray(n,F,Lp,{argA:bp(k)})},m=(k,A)=>{const E=mn(Tr(k)),F=Up(r._getFieldArray(n),E);r._names.focus=Op(n,0,A),l.current=Up(l.current,E.map(Zi)),h(F),o(F),r._updateFieldArray(n,F,Up,{argA:bp(k)})},p=k=>{const A=Bp(r._getFieldArray(n),k);l.current=Bp(l.current,k),h(A),o(A),r._updateFieldArray(n,A,Bp,{argA:k})},g=(k,A,E)=>{const F=mn(Tr(A)),O=Mp(r._getFieldArray(n),k,F);r._names.focus=Op(n,k,E),l.current=Mp(l.current,k,F.map(Zi)),h(O),o(O),r._updateFieldArray(n,O,Mp,{argA:k,argB:bp(A)})},x=(k,A)=>{const E=r._getFieldArray(n);jp(E,k,A),jp(l.current,k,A),h(E),o(E),r._updateFieldArray(n,E,jp,{argA:k,argB:A},!1)},_=(k,A)=>{const E=r._getFieldArray(n);Vp(E,k,A),Vp(l.current,k,A),h(E),o(E),r._updateFieldArray(n,E,Vp,{argA:k,argB:A},!1)},v=(k,A)=>{const E=Tr(A),F=KE(r._getFieldArray(n),k,E);l.current=[...F].map((O,M)=>!O||M===k?Zi():l.current[M]),h(F),o([...F]),r._updateFieldArray(n,F,KE,{argA:k,argB:E},!0,!1)},T=k=>{const A=mn(Tr(k));l.current=A.map(Zi),h([...A]),o([...A]),r._updateFieldArray(n,[...A],E=>E,{},!0,!1)};return Se.useEffect(()=>{if(r._state.action=!1,Lg(n,r._names)&&r._subjects.state.next({...r._formState}),f.current&&(!Og(r._options.mode).isOnSubmit||r._formState.isSubmitted))if(r._options.resolver)r._executeSchema([n]).then(k=>{const A=ve(k.errors,n),E=ve(r._formState.errors,n);(E?!A&&E.type||A&&(E.type!==A.type||E.message!==A.message):A&&A.type)&&(A?st(r._formState.errors,n,A):Qt(r._formState.errors,n),r._subjects.state.next({errors:r._formState.errors}))});else{const k=ve(r._fields,n);k&&k._f&&bg(k,r._formValues,r._options.criteriaMode===Rn.all,r._options.shouldUseNativeValidation,!0).then(A=>!cn(A)&&r._subjects.state.next({errors:uC(r._formState.errors,A,n)}))}r._subjects.values.next({name:n,values:{...r._formValues}}),r._names.focus&&u0(r._fields,k=>!!k&&k.startsWith(r._names.focus||"")),r._names.focus="",r._updateValid(),f.current=!1},[a,n,r]),Se.useEffect(()=>(!ve(r._formValues,n)&&r._updateFieldArray(n),()=>{(r._options.shouldUnregister||s)&&r.unregister(n)}),[n,r,i,s]),{swap:Se.useCallback(x,[h,n,r]),move:Se.useCallback(_,[h,n,r]),prepend:Se.useCallback(m,[h,n,r]),append:Se.useCallback(d,[h,n,r]),remove:Se.useCallback(p,[h,n,r]),insert:Se.useCallback(g,[h,n,r]),update:Se.useCallback(v,[h,n,r]),replace:Se.useCallback(T,[h,n,r]),fields:Se.useMemo(()=>a.map((k,A)=>({...k,[i]:l.current[A]||Zi()})),[a,i])}}function $p(){let e=[];return{get observers(){return e},next:i=>{for(const s of e)s.next&&s.next(i)},subscribe:i=>(e.push(i),{unsubscribe:()=>{e=e.filter(s=>s!==i)}}),unsubscribe:()=>{e=[]}}}var d0=e=>Br(e)||!rC(e);function da(e,t){if(d0(e)||d0(t))return e===t;if(Eo(e)&&Eo(t))return e.getTime()===t.getTime();const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const i of r){const s=e[i];if(!n.includes(i))return!1;if(i!=="ref"){const a=t[i];if(Eo(s)&&Eo(a)||Yt(s)&&Yt(a)||Array.isArray(s)&&Array.isArray(a)?!da(s,a):s!==a)return!1}}return!0}var dC=e=>e.type==="select-multiple",H9=e=>E_(e)||qu(e),Hp=e=>f0(e)&&e.isConnected,pC=e=>{for(const t in e)if(_s(e[t]))return!0;return!1};function p0(e,t={}){const r=Array.isArray(e);if(Yt(e)||r)for(const n in e)Array.isArray(e[n])||Yt(e[n])&&!pC(e[n])?(t[n]=Array.isArray(e[n])?[]:{},p0(e[n],t[n])):Br(e[n])||(t[n]=!0);return t}function mC(e,t,r){const n=Array.isArray(e);if(Yt(e)||n)for(const i in e)Array.isArray(e[i])||Yt(e[i])&&!pC(e[i])?ut(t)||d0(r[i])?r[i]=Array.isArray(e[i])?p0(e[i],[]):{...p0(e[i])}:mC(e[i],Br(t)?{}:t[i],r[i]):r[i]=!da(e[i],t[i]);return r}var zp=(e,t)=>mC(e,t,p0(t)),gC=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:n})=>ut(e)?e:t?e===""?NaN:e&&+e:r&&ci(e)?new Date(e):n?n(e):e;function Wp(e){const t=e.ref;if(!(e.refs?e.refs.every(r=>r.disabled):t.disabled))return y_(t)?t.files:E_(t)?hC(e.refs).value:dC(t)?[...t.selectedOptions].map(({value:r})=>r):qu(t)?fC(e.refs).value:gC(ut(t.value)?e.ref.value:t.value,e)}var z9=(e,t,r,n)=>{const i={};for(const s of e){const a=ve(t,s);a&&st(i,s,a._f)}return{criteriaMode:r,names:[...e],fields:i,shouldUseNativeValidation:n}},Ml=e=>ut(e)?e:h0(e)?e.source:Yt(e)?h0(e.value)?e.value.source:e.value:e,W9=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function qE(e,t,r){const n=ve(e,r);if(n||x_(r))return{error:n,name:r};const i=r.split(".");for(;i.length;){const s=i.join("."),a=ve(t,s),o=ve(e,s);if(a&&!Array.isArray(a)&&r!==s)return{name:r};if(o&&o.type)return{name:s,error:o};i.pop()}return{name:r}}var G9=(e,t,r,n,i)=>i.isOnAll?!1:!r&&i.isOnTouch?!(t||e):(r?n.isOnBlur:i.isOnBlur)?!e:(r?n.isOnChange:i.isOnChange)?e:!0,K9=(e,t)=>!vl(ve(e,t)).length&&Qt(e,t);const q9={mode:Rn.onSubmit,reValidateMode:Rn.onChange,shouldFocusError:!0};function X9(e={},t){let r={...q9,...e},n={submitCount:0,isDirty:!1,isLoading:_s(r.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{}},i={},s=Yt(r.defaultValues)||Yt(r.values)?Tr(r.defaultValues||r.values)||{}:{},a=r.shouldUnregister?{}:Tr(s),o={action:!1,mount:!1,watch:!1},l={mount:new Set,unMount:new Set,array:new Set,watch:new Set},c,u=0;const f={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},h={values:$p(),array:$p(),state:$p()},d=e.resetOptions&&e.resetOptions.keepDirtyValues,m=Og(r.mode),p=Og(r.reValidateMode),g=r.criteriaMode===Rn.all,x=C=>W=>{clearTimeout(u),u=setTimeout(C,W)},_=async C=>{if(f.isValid||C){const W=r.resolver?cn((await O()).errors):await j(i,!0);W!==n.isValid&&h.state.next({isValid:W})}},v=C=>f.isValidating&&h.state.next({isValidating:C}),T=(C,W=[],Q,we,pe=!0,fe=!0)=>{if(we&&Q){if(o.action=!0,fe&&Array.isArray(ve(i,C))){const Ce=Q(ve(i,C),we.argA,we.argB);pe&&st(i,C,Ce)}if(fe&&Array.isArray(ve(n.errors,C))){const Ce=Q(ve(n.errors,C),we.argA,we.argB);pe&&st(n.errors,C,Ce),K9(n.errors,C)}if(f.touchedFields&&fe&&Array.isArray(ve(n.touchedFields,C))){const Ce=Q(ve(n.touchedFields,C),we.argA,we.argB);pe&&st(n.touchedFields,C,Ce)}f.dirtyFields&&(n.dirtyFields=zp(s,a)),h.state.next({name:C,isDirty:X(C,W),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else st(a,C,W)},k=(C,W)=>{st(n.errors,C,W),h.state.next({errors:n.errors})},A=(C,W,Q,we)=>{const pe=ve(i,C);if(pe){const fe=ve(a,C,ut(Q)?ve(s,C):Q);ut(fe)||we&&we.defaultChecked||W?st(a,C,W?fe:Wp(pe._f)):se(C,fe),o.mount&&_()}},E=(C,W,Q,we,pe)=>{let fe=!1,Ce=!1;const je={name:C};if(!Q||we){f.isDirty&&(Ce=n.isDirty,n.isDirty=je.isDirty=X(),fe=Ce!==je.isDirty);const et=da(ve(s,C),W);Ce=ve(n.dirtyFields,C),et?Qt(n.dirtyFields,C):st(n.dirtyFields,C,!0),je.dirtyFields=n.dirtyFields,fe=fe||f.dirtyFields&&Ce!==!et}if(Q){const et=ve(n.touchedFields,C);et||(st(n.touchedFields,C,Q),je.touchedFields=n.touchedFields,fe=fe||f.touchedFields&&et!==Q)}return fe&&pe&&h.state.next(je),fe?je:{}},F=(C,W,Q,we)=>{const pe=ve(n.errors,C),fe=f.isValid&&vs(W)&&n.isValid!==W;if(e.delayError&&Q?(c=x(()=>k(C,Q)),c(e.delayError)):(clearTimeout(u),c=null,Q?st(n.errors,C,Q):Qt(n.errors,C)),(Q?!da(pe,Q):pe)||!cn(we)||fe){const Ce={...we,...fe&&vs(W)?{isValid:W}:{},errors:n.errors,name:C};n={...n,...Ce},h.state.next(Ce)}v(!1)},O=async C=>r.resolver(a,r.context,z9(C||l.mount,i,r.criteriaMode,r.shouldUseNativeValidation)),M=async C=>{const{errors:W}=await O(C);if(C)for(const Q of C){const we=ve(W,Q);we?st(n.errors,Q,we):Qt(n.errors,Q)}else n.errors=W;return W},j=async(C,W,Q={valid:!0})=>{for(const we in C){const pe=C[we];if(pe){const{_f:fe,...Ce}=pe;if(fe){const je=l.array.has(fe.name),et=await bg(pe,a,g,r.shouldUseNativeValidation&&!W,je);if(et[fe.name]&&(Q.valid=!1,W))break;!W&&(ve(et,fe.name)?je?uC(n.errors,et,fe.name):st(n.errors,fe.name,et[fe.name]):Qt(n.errors,fe.name))}Ce&&await j(Ce,W,Q)}}return Q.valid},b=()=>{for(const C of l.unMount){const W=ve(i,C);W&&(W._f.refs?W._f.refs.every(Q=>!Hp(Q)):!Hp(W._f.ref))&&Z(C)}l.unMount=new Set},X=(C,W)=>(C&&W&&st(a,C,W),!da(Ee(),s)),ne=(C,W,Q)=>lC(C,l,{...o.mount?a:ut(W)?s:ci(C)?{[C]:W}:W},Q,W),re=C=>vl(ve(o.mount?a:s,C,e.shouldUnregister?ve(s,C,[]):[])),se=(C,W,Q={})=>{const we=ve(i,C);let pe=W;if(we){const fe=we._f;fe&&(!fe.disabled&&st(a,C,gC(W,fe)),pe=f0(fe.ref)&&Br(W)?"":W,dC(fe.ref)?[...fe.ref.options].forEach(Ce=>Ce.selected=pe.includes(Ce.value)):fe.refs?qu(fe.ref)?fe.refs.length>1?fe.refs.forEach(Ce=>(!Ce.defaultChecked||!Ce.disabled)&&(Ce.checked=Array.isArray(pe)?!!pe.find(je=>je===Ce.value):pe===Ce.value)):fe.refs[0]&&(fe.refs[0].checked=!!pe):fe.refs.forEach(Ce=>Ce.checked=Ce.value===pe):y_(fe.ref)?fe.ref.value="":(fe.ref.value=pe,fe.ref.type||h.values.next({name:C,values:{...a}})))}(Q.shouldDirty||Q.shouldTouch)&&E(C,pe,Q.shouldTouch,Q.shouldDirty,!0),Q.shouldValidate&&ce(C)},ue=(C,W,Q)=>{for(const we in W){const pe=W[we],fe=`${C}.${we}`,Ce=ve(i,fe);(l.array.has(C)||!d0(pe)||Ce&&!Ce._f)&&!Eo(pe)?ue(fe,pe,Q):se(fe,pe,Q)}},te=(C,W,Q={})=>{const we=ve(i,C),pe=l.array.has(C),fe=Tr(W);st(a,C,fe),pe?(h.array.next({name:C,values:{...a}}),(f.isDirty||f.dirtyFields)&&Q.shouldDirty&&h.state.next({name:C,dirtyFields:zp(s,a),isDirty:X(C,fe)})):we&&!we._f&&!Br(fe)?ue(C,fe,Q):se(C,fe,Q),Lg(C,l)&&h.state.next({...n}),h.values.next({name:C,values:{...a}}),!o.mount&&t()},V=async C=>{const W=C.target;let Q=W.name,we=!0;const pe=ve(i,Q),fe=()=>W.type?Wp(pe._f):nC(C);if(pe){let Ce,je;const et=fe(),Mr=C.type===c0.BLUR||C.type===c0.FOCUS_OUT,Zs=!W9(pe._f)&&!r.resolver&&!ve(n.errors,Q)&&!pe._f.deps||G9(Mr,ve(n.touchedFields,Q),n.isSubmitted,p,m),Ht=Lg(Q,l,Mr);st(a,Q,et),Mr?(pe._f.onBlur&&pe._f.onBlur(C),c&&c(0)):pe._f.onChange&&pe._f.onChange(C);const Qr=E(Q,et,Mr,!1),Ue=!cn(Qr)||Ht;if(!Mr&&h.values.next({name:Q,type:C.type,values:{...a}}),Zs)return f.isValid&&_(),Ue&&h.state.next({name:Q,...Ht?{}:Qr});if(!Mr&&Ht&&h.state.next({...n}),v(!0),r.resolver){const{errors:gt}=await O([Q]),Jr=qE(n.errors,i,Q),At=qE(gt,i,Jr.name||Q);Ce=At.error,Q=At.name,je=cn(gt)}else Ce=(await bg(pe,a,g,r.shouldUseNativeValidation))[Q],we=Number.isNaN(et)||et===ve(a,Q,et),we&&(Ce?je=!1:f.isValid&&(je=await j(i,!0)));we&&(pe._f.deps&&ce(pe._f.deps),F(Q,je,Ce,Qr))}},ce=async(C,W={})=>{let Q,we;const pe=mn(C);if(v(!0),r.resolver){const fe=await M(ut(C)?C:pe);Q=cn(fe),we=C?!pe.some(Ce=>ve(fe,Ce)):Q}else C?(we=(await Promise.all(pe.map(async fe=>{const Ce=ve(i,fe);return await j(Ce&&Ce._f?{[fe]:Ce}:Ce)}))).every(Boolean),!(!we&&!n.isValid)&&_()):we=Q=await j(i);return h.state.next({...!ci(C)||f.isValid&&Q!==n.isValid?{}:{name:C},...r.resolver||!C?{isValid:Q}:{},errors:n.errors,isValidating:!1}),W.shouldFocus&&!we&&u0(i,fe=>fe&&ve(n.errors,fe),C?pe:l.mount),we},Ee=C=>{const W={...s,...o.mount?a:{}};return ut(C)?W:ci(C)?ve(W,C):C.map(Q=>ve(W,Q))},N=(C,W)=>({invalid:!!ve((W||n).errors,C),isDirty:!!ve((W||n).dirtyFields,C),isTouched:!!ve((W||n).touchedFields,C),error:ve((W||n).errors,C)}),z=C=>{C&&mn(C).forEach(W=>Qt(n.errors,W)),h.state.next({errors:C?n.errors:{}})},B=(C,W,Q)=>{const we=(ve(i,C,{_f:{}})._f||{}).ref;st(n.errors,C,{...W,ref:we}),h.state.next({name:C,errors:n.errors,isValid:!1}),Q&&Q.shouldFocus&&we&&we.focus&&we.focus()},U=(C,W)=>_s(C)?h.values.subscribe({next:Q=>C(ne(void 0,W),Q)}):ne(C,W,!0),Z=(C,W={})=>{for(const Q of C?mn(C):l.mount)l.mount.delete(Q),l.array.delete(Q),W.keepValue||(Qt(i,Q),Qt(a,Q)),!W.keepError&&Qt(n.errors,Q),!W.keepDirty&&Qt(n.dirtyFields,Q),!W.keepTouched&&Qt(n.touchedFields,Q),!r.shouldUnregister&&!W.keepDefaultValue&&Qt(s,Q);h.values.next({values:{...a}}),h.state.next({...n,...W.keepDirty?{isDirty:X()}:{}}),!W.keepIsValid&&_()},de=({disabled:C,name:W,field:Q,fields:we})=>{if(vs(C)){const pe=C?void 0:ve(a,W,Wp(Q?Q._f:ve(we,W)._f));st(a,W,pe),E(W,pe,!1,!1,!0)}},xe=(C,W={})=>{let Q=ve(i,C);const we=vs(W.disabled);return st(i,C,{...Q||{},_f:{...Q&&Q._f?Q._f:{ref:{name:C}},name:C,mount:!0,...W}}),l.mount.add(C),Q?de({field:Q,disabled:W.disabled,name:C}):A(C,!0,W.value),{...we?{disabled:W.disabled}:{},...r.progressive?{required:!!W.required,min:Ml(W.min),max:Ml(W.max),minLength:Ml(W.minLength),maxLength:Ml(W.maxLength),pattern:Ml(W.pattern)}:{},name:C,onChange:V,onBlur:V,ref:pe=>{if(pe){xe(C,W),Q=ve(i,C);const fe=ut(pe.value)&&pe.querySelectorAll&&pe.querySelectorAll("input,select,textarea")[0]||pe,Ce=H9(fe),je=Q._f.refs||[];if(Ce?je.find(et=>et===fe):fe===Q._f.ref)return;st(i,C,{_f:{...Q._f,...Ce?{refs:[...je.filter(Hp),fe,...Array.isArray(ve(s,C))?[{}]:[]],ref:{type:fe.type,name:C}}:{ref:fe}}}),A(C,!1,void 0,fe)}else Q=ve(i,C,{}),Q._f&&(Q._f.mount=!1),(r.shouldUnregister||W.shouldUnregister)&&!(iC(l.array,C)&&o.action)&&l.unMount.add(C)}}},me=()=>r.shouldFocusError&&u0(i,C=>C&&ve(n.errors,C),l.mount),ae=(C,W)=>async Q=>{Q&&(Q.preventDefault&&Q.preventDefault(),Q.persist&&Q.persist());let we=Tr(a);if(h.state.next({isSubmitting:!0}),r.resolver){const{errors:pe,values:fe}=await O();n.errors=pe,we=fe}else await j(i);Qt(n.errors,"root"),cn(n.errors)?(h.state.next({errors:{}}),await C(we,Q)):(W&&await W({...n.errors},Q),me(),setTimeout(me)),h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:cn(n.errors),submitCount:n.submitCount+1,errors:n.errors})},ze=(C,W={})=>{ve(i,C)&&(ut(W.defaultValue)?te(C,ve(s,C)):(te(C,W.defaultValue),st(s,C,W.defaultValue)),W.keepTouched||Qt(n.touchedFields,C),W.keepDirty||(Qt(n.dirtyFields,C),n.isDirty=W.defaultValue?X(C,ve(s,C)):X()),W.keepError||(Qt(n.errors,C),f.isValid&&_()),h.state.next({...n}))},L=(C,W={})=>{const Q=C?Tr(C):s,we=Tr(Q),pe=C&&!cn(C)?we:s;if(W.keepDefaultValues||(s=Q),!W.keepValues){if(W.keepDirtyValues||d)for(const fe of l.mount)ve(n.dirtyFields,fe)?st(pe,fe,ve(a,fe)):te(fe,ve(pe,fe));else{if(__&&ut(C))for(const fe of l.mount){const Ce=ve(i,fe);if(Ce&&Ce._f){const je=Array.isArray(Ce._f.refs)?Ce._f.refs[0]:Ce._f.ref;if(f0(je)){const et=je.closest("form");if(et){et.reset();break}}}}i={}}a=e.shouldUnregister?W.keepDefaultValues?Tr(s):{}:Tr(pe),h.array.next({values:{...pe}}),h.values.next({values:{...pe}})}l={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!o.mount&&t(),o.mount=!f.isValid||!!W.keepIsValid,o.watch=!!e.shouldUnregister,h.state.next({submitCount:W.keepSubmitCount?n.submitCount:0,isDirty:W.keepDirty?n.isDirty:!!(W.keepDefaultValues&&!da(C,s)),isSubmitted:W.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:W.keepDirtyValues?n.dirtyFields:W.keepDefaultValues&&C?zp(s,C):{},touchedFields:W.keepTouched?n.touchedFields:{},errors:W.keepErrors?n.errors:{},isSubmitSuccessful:W.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1})},mt=(C,W)=>L(_s(C)?C(a):C,W);return{control:{register:xe,unregister:Z,getFieldState:N,handleSubmit:ae,setError:B,_executeSchema:O,_getWatch:ne,_getDirty:X,_updateValid:_,_removeUnmounted:b,_updateFieldArray:T,_updateDisabledField:de,_getFieldArray:re,_reset:L,_resetDefaultValues:()=>_s(r.defaultValues)&&r.defaultValues().then(C=>{mt(C,r.resetOptions),h.state.next({isLoading:!1})}),_updateFormState:C=>{n={...n,...C}},_subjects:h,_proxyFormState:f,get _fields(){return i},get _formValues(){return a},get _state(){return o},set _state(C){o=C},get _defaultValues(){return s},get _names(){return l},set _names(C){l=C},get _formState(){return n},set _formState(C){n=C},get _options(){return r},set _options(C){r={...r,...C}}},trigger:ce,register:xe,handleSubmit:ae,watch:U,setValue:te,getValues:Ee,reset:mt,resetField:ze,clearErrors:z,unregister:Z,setError:B,setFocus:(C,W={})=>{const Q=ve(i,C),we=Q&&Q._f;if(we){const pe=we.refs?we.refs[0]:we.ref;pe.focus&&(pe.focus(),W.shouldSelect&&pe.select())}},getFieldState:N}}function Pd(e={}){const t=Se.useRef(),r=Se.useRef(),[n,i]=Se.useState({isDirty:!1,isValidating:!1,isLoading:_s(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},defaultValues:_s(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...X9(e,()=>i(a=>({...a}))),formState:n});const s=t.current.control;return s._options=e,Rd({subject:s._subjects.state,next:a=>{aC(a,s._proxyFormState,s._updateFormState,!0)&&i({...s._formState})}}),Se.useEffect(()=>{e.values&&!da(e.values,r.current)?(s._reset(e.values,s._options.resetOptions),r.current=e.values):s._resetDefaultValues()},[e.values,s]),Se.useEffect(()=>{s._state.mount||(s._updateValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),t.current.formState=sC(n,s),t.current}const Y9=e=>{console.log(e.code);const t=e.code;return t==="auth/invalid-login-credentials"?"Verifique que su usuario y/o contraseña sean correctos.":t==="auth/too-many-requests"?"Se han realizado demasiados intentos fállidos.":"Ha ocurrido un error en el inicio de sesión."};function Q9(){const[e,t]=Y.useState(null),{register:r,handleSubmit:n,formState:{errors:i}}=Pd(),s=Ln(),a=async o=>{try{await g9(o.email,o.password),localStorage.setItem("userEmail",o.email),s("/home")}catch(l){const c=Y9(l);t(c)}};return y.jsx("section",{id:"login",className:"d-flex align-items-center justify-content-center bg-white",style:{height:"100vh"},children:y.jsxs("div",{className:"container p-5 text-center bg-light shadow-sm rounded border",style:{maxWidth:"500px"},children:[y.jsx("h2",{children:"PORTAL IMPACTO"}),y.jsxs("form",{onSubmit:n(a),className:"needs-validation",noValidate:!0,children:[y.jsxs("div",{className:"mb-3",children:[y.jsx("label",{htmlFor:"email",className:"form-label",children:"Correo electrónico"}),y.jsx("input",{type:"email",className:`form-control ${i.email?"is-invalid":""}`,id:"email",placeholder:"ejemplo@mail.com",...r("email",{required:"Ingrese su correo electrónico"})}),i.email&&y.jsx("div",{className:"invalid-feedback",children:i.email.message})]}),y.jsxs("div",{className:"mb-3",children:[y.jsx("label",{htmlFor:"password",className:"form-label",children:"Contraseña"}),y.jsx("input",{type:"password",className:`form-control ${i.password?"is-invalid":""}`,id:"password",placeholder:"******",...r("password",{required:"Ingrese su contraseña"})}),i.password&&y.jsx("div",{className:"invalid-feedback",children:i.password.message})]}),y.jsx("div",{className:"form-group",children:y.jsx("button",{type:"submit",className:"btn btn-dark btn-block w-100",children:"INGRESAR"})})]}),e&&y.jsx("div",{className:"alert alert-danger mt-3",role:"alert",children:e})]})})}function Xu(){const e=Ln(),t=async()=>{try{await v9(),localStorage.removeItem("userEmail"),e("/login")}catch(r){console.log(r)}};return y.jsx("nav",{className:"navbar navbar-expand-md navbar-dark",style:{backgroundColor:"#4b4a4a"},children:y.jsxs("div",{className:"container-fluid",children:[y.jsx("a",{className:"navbar-brand",children:"PORTAL IMPACTO"}),y.jsx("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation",children:y.jsx("span",{className:"navbar-toggler-icon"})}),y.jsx("div",{className:"collapse navbar-collapse justify-content-end",id:"navbarNav",children:y.jsx("ul",{className:"navbar-nav",children:y.jsx("li",{className:"nav-item",children:y.jsxs("button",{type:"button",className:"btn text-white",onClick:t,children:["CERRAR SESIÓN",y.jsx("i",{className:"bi bi-box-arrow-right",style:{fontSize:"24px",marginLeft:"8px"}})]})})})})]})})}var vC={exports:{}},J9="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Z9=J9,eV=Z9;function _C(){}function xC(){}xC.resetWarningCache=_C;var tV=function(){function e(n,i,s,a,o,l){if(l!==eV){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:xC,resetWarningCache:_C};return r.PropTypes=r,r};vC.exports=tV();var rV=vC.exports;const at=tT(rV);function _l({onClick:e,text:t,icon:r,marginClassName:n,btnClassName:i}){return y.jsxs("button",{type:"button",className:`btn ${i} ${n}`,onClick:e,children:[t," ",r&&y.jsx("i",{className:`bi ${r}`,style:{marginLeft:"4px"}})]})}_l.propTypes={text:at.string.isRequired,icon:at.string,marginClassName:at.string,btnClassName:at.string,onClick:at.func.isRequired};function yC({handleFilterChange:e}){return y.jsx(y.Fragment,{children:y.jsxs("form",{className:"row gx-3 gy-1 align-items-center",children:[y.jsxs("div",{className:"col-sm-1",children:[y.jsx("label",{className:"visually-hidden",htmlFor:"week-input",children:"Sem"}),y.jsx("input",{type:"text",className:"form-control",id:"week-input",placeholder:"Sem",onChange:t=>e("week_name",t.target.value)})]}),y.jsxs("div",{className:"col-sm-2",children:[y.jsx("label",{className:"visually-hidden",htmlFor:"vulnerability-input",children:"Vulnerabilidad"}),y.jsx("input",{type:"text",className:"form-control",id:"vulnerability-input",placeholder:"Vulnerabilidad",onChange:t=>e("vulnerabilidad_1",t.target.value)})]}),y.jsxs("div",{className:"col-sm-2",children:[y.jsx("label",{className:"visually-hidden",htmlFor:"technical-unit-input",children:"Unidad Técnica"}),y.jsx("input",{type:"text",className:"form-control",id:"technical-unit-input",placeholder:"Unidad Técnica",onChange:t=>e("u_tecnica",t.target.value)})]}),y.jsxs("div",{className:"col-sm-2",children:[y.jsx("label",{className:"visually-hidden",htmlFor:"equipment-system-input",children:"Equipo Sistema"}),y.jsx("input",{type:"text",className:"form-control",id:"equipment-system-input",placeholder:"Equipo Sistema",onChange:t=>e("equipo_o_sistema",t.target.value)})]}),y.jsxs("div",{className:"col-sm-2",children:[y.jsx("label",{className:"visually-hidden",htmlFor:"description",children:"Descripción"}),y.jsx("input",{type:"text",className:"form-control",id:"description",placeholder:"Descripción",onChange:t=>e("description",t.target.value)})]}),y.jsxs("div",{className:"col-sm-2",children:[y.jsx("label",{className:"visually-hidden",htmlFor:"current-status",children:"Estado"}),y.jsx("input",{type:"text",className:"form-control",id:"current-status",placeholder:"Estado",onChange:t=>e("current_status",t.target.value)})]})]})})}yC.propTypes={handleFilterChange:at.func.isRequired};function Df(e=""){return e.replace(/[^\p{L}\d\s]/gu,"").normalize("NFD").replace(/\p{Diacritic}/gu,"")}function EC({currentPage:e,totalPages:t,handlePageChange:r}){return y.jsx("div",{className:"d-flex justify-content-center",children:y.jsx("ul",{className:"pagination",children:Array(t).fill(0).map((n,i)=>y.jsx("li",{className:`page-item ${i+1===e?"active":""}`,children:y.jsx("button",{className:"page-link",onClick:()=>r(i+1),children:i+1})},i))})})}EC.propTypes={currentPage:at.number.isRequired,totalPages:at.number.isRequired,handlePageChange:at.func.isRequired};function xi(){return y.jsx("div",{className:"d-flex justify-content-center",children:y.jsx("div",{className:"spinner-border text-secondary",role:"status",children:y.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}function wC({filters:e}){const[t,r]=Y.useState([]),[n,i]=Y.useState(1),[s,a]=Y.useState(!0),o=20,l=h=>{h>0&&h<=u&&i(h)};Y.useEffect(()=>{Object.values(e).some(h=>h!=="")&&i(1)},[e]),Y.useEffect(()=>{(async()=>{try{const d=(n-1)*o,p=(await y9({limit:o,offset:d})).map(g=>({id:g.id,...g.data}));r(p),a(!1)}catch(d){console.error("Error al obtener documentos: ",d)}})()},[n,o,e]);const c=t.filter(h=>Object.keys(e).every(d=>{const m=Df(e[d]).toLowerCase(),p=Df(h[d]).toLowerCase();if(d==="week_name"&&m){if(p.slice(-2)!==m)return!1}else if(d==="description"&&m){if(!((Df(h.descripcion_del_trabajo)||"N/A")+(Df(h.descripcion_del_aviso)||"N/A")).toLowerCase().includes(m))return!1}else if(m&&p&&!p.includes(m))return!1;return!0})),u=Math.ceil(c.length/o),f=c.slice((n-1)*o,n*o);return y.jsxs(y.Fragment,{children:[s?y.jsx(xi,{}):y.jsx("div",{className:"table-responsive-xxl",children:y.jsxs("table",{className:"table table-hover",children:[y.jsx("thead",{className:"table-secondary",children:y.jsxs("tr",{className:"align-middle",children:[y.jsx("th",{scope:"col",children:"N°"}),y.jsx("th",{scope:"col",children:"Sem"}),y.jsx("th",{scope:"col",children:"Vulnerabilidad"}),y.jsx("th",{scope:"col",children:"Unidad Técnica"}),y.jsx("th",{scope:"col",children:"Equipo Sistema"}),y.jsx("th",{scope:"col",children:"Descripción del trabajo"}),y.jsx("th",{scope:"col",children:"Descripción del aviso"}),y.jsx("th",{scope:"col",children:"Estado Impacto"}),y.jsx("th",{scope:"col",children:"Estado Final"}),y.jsx("th",{scope:"col",colSpan:"3",className:"text-center",children:"Acciones"})]})}),y.jsx("tbody",{children:f.map((h,d)=>{const m=(n-1)*o+d+1;return y.jsxs("tr",{children:[y.jsx("td",{children:m}),y.jsx("td",{children:h.week_name.slice(-2)||"N/A"}),y.jsx("td",{children:h.vulnerabilidad_1||"N/A"}),y.jsx("td",{children:h.u_tecnica||"N/A"}),y.jsx("td",{children:h.equipo_o_sistema||"N/A"}),y.jsx("td",{children:h.descripcion_del_trabajo||"N/A"}),y.jsx("td",{children:h.descripcion_del_aviso||"N/A"}),y.jsx("td",{children:h.current_status}),y.jsx("td",{children:"documento"}),y.jsx("td",{children:y.jsx(hp,{to:`/update-activity-status/${h.id}`,children:"E.I"})}),y.jsx("td",{children:y.jsx(hp,{to:`/upload-activity-log/${h.id}`,children:"I.R."})}),y.jsx("td",{children:y.jsx(hp,{to:`/view-activity-info/${h.id}`,children:"V.D."})})]},d)})})]})}),y.jsx(EC,{currentPage:n,totalPages:u,handlePageChange:l})]})}wC.propTypes={filters:at.object};function nV(){const e=Ln(),[t,r]=Y.useState({week:"",vulnerability:"",technicalUnit:"",equipmentSystem:"",description:"",status:""}),n=(s,a)=>{r({...t,[s]:a})},i=()=>{e("/upload-activities")};return y.jsx(y.Fragment,{children:y.jsxs("section",{id:"week",children:[y.jsx("h1",{className:"my-2 text-center mt-3",children:"PRIORIZACIÓN DE ACTIVIDADES"}),y.jsx("div",{className:"row",children:y.jsx("div",{className:"col text-start mb-3",children:y.jsx(_l,{text:"CARGAR PRIORIZACIÓN",icon:"bi bi-upload",btnClassName:"btn-dark",onClick:i})})}),y.jsx("div",{className:"row mb-3",children:y.jsx("div",{className:"col",children:y.jsx(yC,{filters:t,handleFilterChange:n})})}),y.jsx(wC,{filters:t})]})})}function iV(){return y.jsxs(y.Fragment,{children:[y.jsx(Xu,{}),y.jsx("div",{className:"container",children:y.jsx(nV,{})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var TC=1252,sV=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],w_={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},T_=function(e){sV.indexOf(e)!=-1&&(TC=w_[0]=e)};function aV(){T_(1252)}var zn=function(e){T_(e)};function kC(){zn(1200),aV()}function XE(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function oV(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function AC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Yl=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?oV(e.slice(2)):t==254&&r==255?AC(e.slice(2)):t==65279?e.slice(1):e},Of=function(t){return String.fromCharCode(t)},YE=function(t){return String.fromCharCode(t)},fs,xs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function QE(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),a=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=xs.charAt(s)+xs.charAt(a)+xs.charAt(o)+xs.charAt(l);return t}function xn(e){var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=xs.indexOf(e.charAt(c++)),a=xs.indexOf(e.charAt(c++)),r=s<<2|a>>4,t+=String.fromCharCode(r),o=xs.indexOf(e.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=xs.indexOf(e.charAt(c++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var Ke=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ga=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Hs(e){return Ke?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function JE(e){return Ke?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Hn=function(t){return Ke?Ga(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ka(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function k_(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return k_(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var hs=Ke?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ga(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function lV(e){for(var t=[],r=0,n=e.length+250,i=Hs(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Hs(65535),n=65530)}return t.push(i.slice(0,r)),hs(t)}var Kr=/\u0000/g,Ql=/[\u0001-\u0006]/g;function Oo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Wn(e,t){var r=""+e;return r.length>=t?r:It("0",t-r.length)+r}function A_(e,t){var r=""+e;return r.length>=t?r:It(" ",t-r.length)+r}function m0(e,t){var r=""+e;return r.length>=t?r:r+It(" ",t-r.length)}function cV(e,t){var r=""+Math.round(e);return r.length>=t?r:It("0",t-r.length)+r}function uV(e,t){var r=""+e;return r.length>=t?r:It("0",t-r.length)+r}var ZE=Math.pow(2,32);function to(e,t){if(e>ZE||e<-ZE)return cV(e,t);var r=Math.round(e);return uV(r,t)}function g0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var ew=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Gp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function fV(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Me={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},tw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},hV={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function v0(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,a=1,o=0,l=1,c=0,u=0,f=Math.floor(i);c<t&&(f=Math.floor(i),o=f*a+s,u=f*c+l,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=a)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function pa(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,a=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=_V(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var SC=new Date(1899,11,31,0,0,0),dV=SC.getTime(),pV=new Date(1900,2,1,0,0,0);function IC(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=pV&&(r+=24*60*60*1e3),(r-(dV+(e.getTimezoneOffset()-SC.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function S_(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function mV(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function gV(e){var t=e<0?12:11,r=S_(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function vV(e){var t=S_(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function fu(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=gV(e):t===10?r=e.toFixed(10).substr(0,12):r=vV(e),S_(mV(r.toUpperCase()))}function Oa(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):fu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return On(14,IC(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function _V(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function xV(e,t,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Gp[r.m-1][1];case 5:return Gp[r.m-1][0];default:return Gp[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return ew[r.q][0];default:return ew[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Wn(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=Wn(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Wn(l,c):"";return u}function ys(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var CC=/%/g;function yV(e,t,r){var n=t.replace(CC,""),i=t.length-n.length;return bi(e,n,r*Math.pow(10,2*i))+It("%",i)}function EV(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return bi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function RC(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+RC(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var PC=/# (\?+)( ?)\/( ?)(\d+)/;function wV(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?It(" ",e[1].length+1+e[4].length):A_(a,e[1].length)+e[2]+"/"+e[3]+Wn(o,e[4].length))}function TV(e,t,r){return r+(t===0?"":""+t)+It(" ",e[1].length+2+e[4].length)}var FC=/^#*0*\.([0#]+)/,NC=/\).*[0#]/,DC=/\(###\) ###\\?-####/;function jr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function rw(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function nw(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function kV(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function AV(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Tn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(NC)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Tn("n",n,r):"("+Tn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return EV(e,t,r);if(t.indexOf("%")!==-1)return yV(e,t,r);if(t.indexOf("E")!==-1)return RC(t,r);if(t.charCodeAt(0)===36)return"$"+Tn(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+to(l,t.length);if(t.match(/^[#?]+$/))return i=to(r,0),i==="0"&&(i=""),i.length>t.length?i:jr(t.substr(0,t.length-i.length))+i;if(s=t.match(PC))return wV(s,l,c);if(t.match(/^#+0+$/))return c+to(l,t.length-t.indexOf("0"));if(s=t.match(FC))return i=rw(r,s[1].length).replace(/^([^\.]+)$/,"$1."+jr(s[1])).replace(/\.$/,"."+jr(s[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+It("0",jr(s[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+rw(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+ys(to(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Tn(e,t,-r):ys(""+(Math.floor(r)+kV(r,s[1].length)))+"."+Wn(nw(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Tn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Oo(Tn(e,t.replace(/[\\-]/g,""),r)),a=0,Oo(Oo(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return a<i.length?i.charAt(a++):m==="0"?"0":""}));if(t.match(DC))return i=Tn(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=v0(l,Math.pow(10,a)-1,!1),i=""+c,u=bi("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=m0(o[2],a),u.length<s[4].length&&(u=jr(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=v0(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?A_(o[1],a)+s[2]+"/"+s[3]+m0(o[2],a):It(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=to(r,0),t.length<=i.length?i:jr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=t.indexOf(".")-a,h=t.length-i.length-f;return jr(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=nw(r,s[1].length),r<0?"-"+Tn(e,t,-r):ys(AV(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Wn(0,3-m.length):"")+m})+"."+Wn(a,s[1].length);switch(t){case"###,##0.00":return Tn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=ys(to(l,0));return d!=="0"?c+d:"";case"###,###.00":return Tn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Tn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function SV(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return bi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function IV(e,t,r){var n=t.replace(CC,""),i=t.length-n.length;return bi(e,n,r*Math.pow(10,2*i))+It("%",i)}function OC(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+OC(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ri(e,t,r){if(e.charCodeAt(0)===40&&!t.match(NC)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ri("n",n,r):"("+ri("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return SV(e,t,r);if(t.indexOf("%")!==-1)return IV(e,t,r);if(t.indexOf("E")!==-1)return OC(t,r);if(t.charCodeAt(0)===36)return"$"+ri(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Wn(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:jr(t.substr(0,t.length-i.length))+i;if(s=t.match(PC))return TV(s,l,c);if(t.match(/^#+0+$/))return c+Wn(l,t.length-t.indexOf("0"));if(s=t.match(FC))return i=(""+r).replace(/^([^\.]+)$/,"$1."+jr(s[1])).replace(/\.$/,"."+jr(s[1])),i=i.replace(/\.(\d*)$/,function(m,p){return"."+p+It("0",jr(s[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+ys(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ri(e,t,-r):ys(""+r)+"."+It("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ri(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Oo(ri(e,t.replace(/[\\-]/g,""),r)),a=0,Oo(Oo(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return a<i.length?i.charAt(a++):m==="0"?"0":""}));if(t.match(DC))return i=ri(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=v0(l,Math.pow(10,a)-1,!1),i=""+c,u=bi("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=m0(o[2],a),u.length<s[4].length&&(u=jr(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=v0(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?A_(o[1],a)+s[2]+"/"+s[3]+m0(o[2],a):It(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:jr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=t.indexOf(".")-a,h=t.length-i.length-f;return jr(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ri(e,t,-r):ys(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Wn(0,3-m.length):"")+m})+"."+Wn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=ys(""+l);return d!=="0"?c+d:"";default:if(t.match(/\.[0#?]*$/))return ri(e,t.slice(0,t.lastIndexOf(".")),r)+jr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function bi(e,t,r){return(r|0)===r?ri(e,t,r):Tn(e,t,r)}function CV(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var LC=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function xl(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":g0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(LC))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function RV(e,t,r,n){for(var i=[],s="",a=0,o="",l="t",c,u,f,h="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!g0(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var d=e.charAt(++a),m=d==="("||d===")"?d:"t";i[i.length]={t:m,v:d},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(c==null&&(c=pa(t,r,e.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=pa(t,r),c==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"上":var p={t:o,v:o};if(c==null&&(c=pa(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(p.v=c.H>=12?"P":"A"),p.t="T",h="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(p.v=c.H>=12?"PM":"AM"),p.t="T",a+=5,h="h"):e.substr(a,5).toUpperCase()==="上午/下午"?(c!=null&&(p.v=c.H>=12?"下午":"上午"),p.t="T",a+=5,h="h"):(p.t="t",++a),c==null&&p.t==="T")return"";i[i.length]=p,l=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(LC)){if(c==null&&(c=pa(t,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",xl(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var g=0,x=0,_;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=h,l="h",g<1&&(g=1);break;case"s":(_=i[a].v.match(/\.0+$/))&&(x=Math.max(x,_[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[a].v.match(/[Hh]/)&&(g=1),g<2&&i[a].v.match(/[Mm]/)&&(g=2),g<3&&i[a].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var v="",T;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=xV(i[a].t.charCodeAt(0),i[a].v,c,x),i[a].t="t";break;case"n":case"?":for(T=a+1;i[T]!=null&&((o=i[T].t)==="?"||o==="D"||(o===" "||o==="t")&&i[T+1]!=null&&(i[T+1].t==="?"||i[T+1].t==="t"&&i[T+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[T].v==="/"||i[T].v===" "&&i[T+1]!=null&&i[T+1].t=="?"));)i[a].v+=i[T].v,i[T]={v:"",t:";"},++T;v+=i[a].v,a=T-1;break;case"G":i[a].t="t",i[a].v=Oa(t,r);break}var k="",A,E;if(v.length>0){v.charCodeAt(0)==40?(A=t<0&&v.charCodeAt(0)===45?-t:t,E=bi("n",v,A)):(A=t<0&&n>1?-t:t,E=bi("n",v,A),A<0&&i[0]&&i[0].t=="t"&&(E=E.substr(1),i[0].v="-"+i[0].v)),T=E.length-1;var F=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){F=a;break}var O=i.length;if(F===i.length&&E.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(T>=i[a].v.length-1?(T-=i[a].v.length,i[a].v=E.substr(T+1,i[a].v.length)):T<0?i[a].v="":(i[a].v=E.substr(0,T+1),T=-1),i[a].t="t",O=a);T>=0&&O<i.length&&(i[O].v=E.substr(0,T+1)+i[O].v)}else if(F!==i.length&&E.indexOf("E")===-1){for(T=E.indexOf(".")-1,a=F;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(u=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")-1:i[a].v.length-1,k=i[a].v.substr(u+1);u>=0;--u)T>=0&&(i[a].v.charAt(u)==="0"||i[a].v.charAt(u)==="#")&&(k=E.charAt(T--)+k);i[a].v=k,i[a].t="t",O=a}for(T>=0&&O<i.length&&(i[O].v=E.substr(0,T+1)+i[O].v),T=E.indexOf(".")+1,a=F;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==F)){for(u=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")+1:0,k=i[a].v.substr(0,u);u<i[a].v.length;++u)T<E.length&&(k+=E.charAt(T++));i[a].v=k,i[a].t="t",O=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(A=n>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=bi(i[a].t,i[a].v,A),i[a].t="t");var M="";for(a=0;a!==i.length;++a)i[a]!=null&&(M+=i[a].v);return M}var iw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function sw(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function PV(e,t){var r=CV(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(iw),o=r[1].match(iw);return sw(t,a)?[n,r[0]]:sw(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function On(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Me)[e],n==null&&(n=r.table&&r.table[tw[e]]||Me[tw[e]]),n==null&&(n=hV[e]||"General");break}if(g0(n,0))return Oa(t,r);t instanceof Date&&(t=IC(t,r.date1904));var i=PV(n,t);if(g0(i[1]))return Oa(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return RV(i[1],t,r,i[0])}function ya(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Me[r]==null){t<0&&(t=r);continue}if(Me[r]==e){t=r;break}}t<0&&(t=391)}return Me[t]=e,t}function bC(){Me=fV()}var FV={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},MC=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function NV(e){var t=typeof e=="number"?Me[e]:e;return t=t.replace(MC,"(\\d+)"),new RegExp("^"+t+"$")}function DV(e,t,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(t.match(MC)||[]).forEach(function(f,h){var d=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=d;break;case"d":s=d;break;case"h":a=d;break;case"s":l=d;break;case"m":a>=0?o=d:i=d;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?u:c+"T"+u}var OV=function(){var e={};e.version="1.2.0";function t(){for(var E=0,F=new Array(256),O=0;O!=256;++O)E=O,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,F[O]=E;return typeof Int32Array<"u"?new Int32Array(F):F}var r=t();function n(E){var F=0,O=0,M=0,j=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)j[M]=E[M];for(M=0;M!=256;++M)for(O=E[M],F=256+M;F<4096;F+=256)O=j[F]=O>>>8^E[O&255];var b=[];for(M=1;M!=16;++M)b[M-1]=typeof Int32Array<"u"?j.subarray(M*256,M*256+256):j.slice(M*256,M*256+256);return b}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],f=i[6],h=i[7],d=i[8],m=i[9],p=i[10],g=i[11],x=i[12],_=i[13],v=i[14];function T(E,F){for(var O=F^-1,M=0,j=E.length;M<j;)O=O>>>8^r[(O^E.charCodeAt(M++))&255];return~O}function k(E,F){for(var O=F^-1,M=E.length-15,j=0;j<M;)O=v[E[j++]^O&255]^_[E[j++]^O>>8&255]^x[E[j++]^O>>16&255]^g[E[j++]^O>>>24]^p[E[j++]]^m[E[j++]]^d[E[j++]]^h[E[j++]]^f[E[j++]]^u[E[j++]]^c[E[j++]]^l[E[j++]]^o[E[j++]]^a[E[j++]]^s[E[j++]]^r[E[j++]];for(M+=15;j<M;)O=O>>>8^r[(O^E[j++])&255];return~O}function A(E,F){for(var O=F^-1,M=0,j=E.length,b=0,X=0;M<j;)b=E.charCodeAt(M++),b<128?O=O>>>8^r[(O^b)&255]:b<2048?(O=O>>>8^r[(O^(192|b>>6&31))&255],O=O>>>8^r[(O^(128|b&63))&255]):b>=55296&&b<57344?(b=(b&1023)+64,X=E.charCodeAt(M++)&1023,O=O>>>8^r[(O^(240|b>>8&7))&255],O=O>>>8^r[(O^(128|b>>2&63))&255],O=O>>>8^r[(O^(128|X>>6&15|(b&3)<<4))&255],O=O>>>8^r[(O^(128|X&63))&255]):(O=O>>>8^r[(O^(224|b>>12&15))&255],O=O>>>8^r[(O^(128|b>>6&63))&255],O=O>>>8^r[(O^(128|b&63))&255]);return~O}return e.table=r,e.bstr=T,e.buf=k,e.str=A,e}(),Xe=function(){var t={};t.version="1.2.1";function r(w,R){for(var S=w.split("/"),I=R.split("/"),P=0,D=0,G=Math.min(S.length,I.length);P<G;++P){if(D=S[P].length-I[P].length)return D;if(S[P]!=I[P])return S[P]<I[P]?-1:1}return S.length-I.length}function n(w){if(w.charAt(w.length-1)=="/")return w.slice(0,-1).indexOf("/")===-1?w:n(w.slice(0,-1));var R=w.lastIndexOf("/");return R===-1?w:w.slice(0,R+1)}function i(w){if(w.charAt(w.length-1)=="/")return i(w.slice(0,-1));var R=w.lastIndexOf("/");return R===-1?w:w.slice(R+1)}function s(w,R){typeof R=="string"&&(R=new Date(R));var S=R.getHours();S=S<<6|R.getMinutes(),S=S<<5|R.getSeconds()>>>1,w.write_shift(2,S);var I=R.getFullYear()-1980;I=I<<4|R.getMonth()+1,I=I<<5|R.getDate(),w.write_shift(2,I)}function a(w){var R=w.read_shift(2)&65535,S=w.read_shift(2)&65535,I=new Date,P=S&31;S>>>=5;var D=S&15;S>>>=4,I.setMilliseconds(0),I.setFullYear(S+1980),I.setMonth(D-1),I.setDate(P);var G=R&31;R>>>=5;var J=R&63;return R>>>=6,I.setHours(R),I.setMinutes(J),I.setSeconds(G<<1),I}function o(w){lr(w,0);for(var R={},S=0;w.l<=w.length-4;){var I=w.read_shift(2),P=w.read_shift(2),D=w.l+P,G={};switch(I){case 21589:S=w.read_shift(1),S&1&&(G.mtime=w.read_shift(4)),P>5&&(S&2&&(G.atime=w.read_shift(4)),S&4&&(G.ctime=w.read_shift(4))),G.mtime&&(G.mt=new Date(G.mtime*1e3));break}w.l=D,R[I]=G}return R}var l;function c(){return l||(l={})}function u(w,R){if(w[0]==80&&w[1]==75)return J_(w,R);if((w[0]|32)==109&&(w[1]|32)==105)return k4(w,R);if(w.length<512)throw new Error("CFB file size "+w.length+" < 512");var S=3,I=512,P=0,D=0,G=0,J=0,H=0,K=[],q=w.slice(0,512);lr(q,0);var oe=f(q);switch(S=oe[0],S){case 3:I=512;break;case 4:I=4096;break;case 0:if(oe[1]==0)return J_(w,R);default:throw new Error("Major Version: Expected 3 or 4 saw "+S)}I!==512&&(q=w.slice(0,I),lr(q,28));var ge=w.slice(0,I);h(q,S);var ke=q.read_shift(4,"i");if(S===3&&ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ke);q.l+=4,G=q.read_shift(4,"i"),q.l+=4,q.chk("00100000","Mini Stream Cutoff Size: "),J=q.read_shift(4,"i"),P=q.read_shift(4,"i"),H=q.read_shift(4,"i"),D=q.read_shift(4,"i");for(var he=-1,ye=0;ye<109&&(he=q.read_shift(4,"i"),!(he<0));++ye)K[ye]=he;var be=d(w,I);g(H,D,be,I,K);var xt=_(be,G,K,I);xt[G].name="!Directory",P>0&&J!==X&&(xt[J].name="!MiniFAT"),xt[K[0]].name="!FAT",xt.fat_addrs=K,xt.ssz=I;var yt={},vr=[],wl=[],Tl=[];v(G,xt,be,vr,P,yt,wl,J),m(wl,Tl,vr),vr.shift();var kl={FileIndex:wl,FullPaths:Tl};return R&&R.raw&&(kl.raw={header:ge,sectors:be}),kl}function f(w){if(w[w.l]==80&&w[w.l+1]==75)return[0,0];w.chk(ne,"Header Signature: "),w.l+=16;var R=w.read_shift(2,"u");return[w.read_shift(2,"u"),R]}function h(w,R){var S=9;switch(w.l+=2,S=w.read_shift(2)){case 9:if(R!=3)throw new Error("Sector Shift: Expected 9 saw "+S);break;case 12:if(R!=4)throw new Error("Sector Shift: Expected 12 saw "+S);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+S)}w.chk("0600","Mini Sector Shift: "),w.chk("000000000000","Reserved: ")}function d(w,R){for(var S=Math.ceil(w.length/R)-1,I=[],P=1;P<S;++P)I[P-1]=w.slice(P*R,(P+1)*R);return I[S-1]=w.slice(S*R),I}function m(w,R,S){for(var I=0,P=0,D=0,G=0,J=0,H=S.length,K=[],q=[];I<H;++I)K[I]=q[I]=I,R[I]=S[I];for(;J<q.length;++J)I=q[J],P=w[I].L,D=w[I].R,G=w[I].C,K[I]===I&&(P!==-1&&K[P]!==P&&(K[I]=K[P]),D!==-1&&K[D]!==D&&(K[I]=K[D])),G!==-1&&(K[G]=I),P!==-1&&I!=K[I]&&(K[P]=K[I],q.lastIndexOf(P)<J&&q.push(P)),D!==-1&&I!=K[I]&&(K[D]=K[I],q.lastIndexOf(D)<J&&q.push(D));for(I=1;I<H;++I)K[I]===I&&(D!==-1&&K[D]!==D?K[I]=K[D]:P!==-1&&K[P]!==P&&(K[I]=K[P]));for(I=1;I<H;++I)if(w[I].type!==0){if(J=I,J!=K[J])do J=K[J],R[I]=R[J]+"/"+R[I];while(J!==0&&K[J]!==-1&&J!=K[J]);K[I]=-1}for(R[0]+="/",I=1;I<H;++I)w[I].type!==2&&(R[I]+="/")}function p(w,R,S){for(var I=w.start,P=w.size,D=[],G=I;S&&P>0&&G>=0;)D.push(R.slice(G*b,G*b+b)),P-=b,G=aa(S,G*4);return D.length===0?zt(0):hs(D).slice(0,w.size)}function g(w,R,S,I,P){var D=X;if(w===X){if(R!==0)throw new Error("DIFAT chain shorter than expected")}else if(w!==-1){var G=S[w],J=(I>>>2)-1;if(!G)return;for(var H=0;H<J&&(D=aa(G,H*4))!==X;++H)P.push(D);g(aa(G,I-4),R-1,S,I,P)}}function x(w,R,S,I,P){var D=[],G=[];P||(P=[]);var J=I-1,H=0,K=0;for(H=R;H>=0;){P[H]=!0,D[D.length]=H,G.push(w[H]);var q=S[Math.floor(H*4/I)];if(K=H*4&J,I<4+K)throw new Error("FAT boundary crossed: "+H+" 4 "+I);if(!w[q])break;H=aa(w[q],K)}return{nodes:D,data:mw([G])}}function _(w,R,S,I){var P=w.length,D=[],G=[],J=[],H=[],K=I-1,q=0,oe=0,ge=0,ke=0;for(q=0;q<P;++q)if(J=[],ge=q+R,ge>=P&&(ge-=P),!G[ge]){H=[];var he=[];for(oe=ge;oe>=0;){he[oe]=!0,G[oe]=!0,J[J.length]=oe,H.push(w[oe]);var ye=S[Math.floor(oe*4/I)];if(ke=oe*4&K,I<4+ke)throw new Error("FAT boundary crossed: "+oe+" 4 "+I);if(!w[ye]||(oe=aa(w[ye],ke),he[oe]))break}D[ge]={nodes:J,data:mw([H])}}return D}function v(w,R,S,I,P,D,G,J){for(var H=0,K=I.length?2:0,q=R[w].data,oe=0,ge=0,ke;oe<q.length;oe+=128){var he=q.slice(oe,oe+128);lr(he,64),ge=he.read_shift(2),ke=F_(he,0,ge-K),I.push(ke);var ye={name:ke,type:he.read_shift(1),color:he.read_shift(1),L:he.read_shift(4,"i"),R:he.read_shift(4,"i"),C:he.read_shift(4,"i"),clsid:he.read_shift(16),state:he.read_shift(4,"i"),start:0,size:0},be=he.read_shift(2)+he.read_shift(2)+he.read_shift(2)+he.read_shift(2);be!==0&&(ye.ct=T(he,he.l-8));var xt=he.read_shift(2)+he.read_shift(2)+he.read_shift(2)+he.read_shift(2);xt!==0&&(ye.mt=T(he,he.l-8)),ye.start=he.read_shift(4,"i"),ye.size=he.read_shift(4,"i"),ye.size<0&&ye.start<0&&(ye.size=ye.type=0,ye.start=X,ye.name=""),ye.type===5?(H=ye.start,P>0&&H!==X&&(R[H].name="!StreamData")):ye.size>=4096?(ye.storage="fat",R[ye.start]===void 0&&(R[ye.start]=x(S,ye.start,R.fat_addrs,R.ssz)),R[ye.start].name=ye.name,ye.content=R[ye.start].data.slice(0,ye.size)):(ye.storage="minifat",ye.size<0?ye.size=0:H!==X&&ye.start!==X&&R[H]&&(ye.content=p(ye,R[H].data,(R[J]||{}).data))),ye.content&&lr(ye.content,0),D[ke]=ye,G.push(ye)}}function T(w,R){return new Date((un(w,R+4)/1e7*Math.pow(2,32)+un(w,R)/1e7-11644473600)*1e3)}function k(w,R){return c(),u(l.readFileSync(w),R)}function A(w,R){var S=R&&R.type;switch(S||Ke&&Buffer.isBuffer(w)&&(S="buffer"),S||"base64"){case"file":return k(w,R);case"base64":return u(Hn(xn(w)),R);case"binary":return u(Hn(w),R)}return u(w,R)}function E(w,R){var S=R||{},I=S.root||"Root Entry";if(w.FullPaths||(w.FullPaths=[]),w.FileIndex||(w.FileIndex=[]),w.FullPaths.length!==w.FileIndex.length)throw new Error("inconsistent CFB structure");w.FullPaths.length===0&&(w.FullPaths[0]=I+"/",w.FileIndex[0]={name:I,type:5}),S.CLSID&&(w.FileIndex[0].clsid=S.CLSID),F(w)}function F(w){var R="Sh33tJ5";if(!Xe.find(w,"/"+R)){var S=zt(4);S[0]=55,S[1]=S[3]=50,S[2]=54,w.FileIndex.push({name:R,type:2,content:S,size:4,L:69,R:69,C:69}),w.FullPaths.push(w.FullPaths[0]+R),O(w)}}function O(w,R){E(w);for(var S=!1,I=!1,P=w.FullPaths.length-1;P>=0;--P){var D=w.FileIndex[P];switch(D.type){case 0:I?S=!0:(w.FileIndex.pop(),w.FullPaths.pop());break;case 1:case 2:case 5:I=!0,isNaN(D.R*D.L*D.C)&&(S=!0),D.R>-1&&D.L>-1&&D.R==D.L&&(S=!0);break;default:S=!0;break}}if(!(!S&&!R)){var G=new Date(1987,1,19),J=0,H=Object.create?Object.create(null):{},K=[];for(P=0;P<w.FullPaths.length;++P)H[w.FullPaths[P]]=!0,w.FileIndex[P].type!==0&&K.push([w.FullPaths[P],w.FileIndex[P]]);for(P=0;P<K.length;++P){var q=n(K[P][0]);I=H[q],I||(K.push([q,{name:i(q).replace("/",""),type:1,clsid:se,ct:G,mt:G,content:null}]),H[q]=!0)}for(K.sort(function(ke,he){return r(ke[0],he[0])}),w.FullPaths=[],w.FileIndex=[],P=0;P<K.length;++P)w.FullPaths[P]=K[P][0],w.FileIndex[P]=K[P][1];for(P=0;P<K.length;++P){var oe=w.FileIndex[P],ge=w.FullPaths[P];if(oe.name=i(ge).replace("/",""),oe.L=oe.R=oe.C=-(oe.color=1),oe.size=oe.content?oe.content.length:0,oe.start=0,oe.clsid=oe.clsid||se,P===0)oe.C=K.length>1?1:-1,oe.size=0,oe.type=5;else if(ge.slice(-1)=="/"){for(J=P+1;J<K.length&&n(w.FullPaths[J])!=ge;++J);for(oe.C=J>=K.length?-1:J,J=P+1;J<K.length&&n(w.FullPaths[J])!=n(ge);++J);oe.R=J>=K.length?-1:J,oe.type=1}else n(w.FullPaths[P+1]||"")==n(ge)&&(oe.R=P+1),oe.type=2}}}function M(w,R){var S=R||{};if(S.fileType=="mad")return A4(w,S);switch(O(w),S.fileType){case"zip":return _4(w,S)}var I=function(ke){for(var he=0,ye=0,be=0;be<ke.FileIndex.length;++be){var xt=ke.FileIndex[be];if(xt.content){var yt=xt.content.length;yt>0&&(yt<4096?he+=yt+63>>6:ye+=yt+511>>9)}}for(var vr=ke.FullPaths.length+3>>2,wl=he+7>>3,Tl=he+127>>7,kl=wl+ye+vr+Tl,ta=kl+127>>7,Vd=ta<=109?0:Math.ceil((ta-109)/127);kl+ta+Vd+127>>7>ta;)Vd=++ta<=109?0:Math.ceil((ta-109)/127);var ki=[1,Vd,ta,Tl,vr,ye,he,0];return ke.FileIndex[0].size=he<<6,ki[7]=(ke.FileIndex[0].start=ki[0]+ki[1]+ki[2]+ki[3]+ki[4]+ki[5])+(ki[6]+7>>3),ki}(w),P=zt(I[7]<<9),D=0,G=0;{for(D=0;D<8;++D)P.write_shift(1,re[D]);for(D=0;D<8;++D)P.write_shift(2,0);for(P.write_shift(2,62),P.write_shift(2,3),P.write_shift(2,65534),P.write_shift(2,9),P.write_shift(2,6),D=0;D<3;++D)P.write_shift(2,0);for(P.write_shift(4,0),P.write_shift(4,I[2]),P.write_shift(4,I[0]+I[1]+I[2]+I[3]-1),P.write_shift(4,0),P.write_shift(4,4096),P.write_shift(4,I[3]?I[0]+I[1]+I[2]-1:X),P.write_shift(4,I[3]),P.write_shift(-4,I[1]?I[0]-1:X),P.write_shift(4,I[1]),D=0;D<109;++D)P.write_shift(-4,D<I[2]?I[1]+D:-1)}if(I[1])for(G=0;G<I[1];++G){for(;D<236+G*127;++D)P.write_shift(-4,D<I[2]?I[1]+D:-1);P.write_shift(-4,G===I[1]-1?X:G+1)}var J=function(ke){for(G+=ke;D<G-1;++D)P.write_shift(-4,D+1);ke&&(++D,P.write_shift(-4,X))};for(G=D=0,G+=I[1];D<G;++D)P.write_shift(-4,ue.DIFSECT);for(G+=I[2];D<G;++D)P.write_shift(-4,ue.FATSECT);J(I[3]),J(I[4]);for(var H=0,K=0,q=w.FileIndex[0];H<w.FileIndex.length;++H)q=w.FileIndex[H],q.content&&(K=q.content.length,!(K<4096)&&(q.start=G,J(K+511>>9)));for(J(I[6]+7>>3);P.l&511;)P.write_shift(-4,ue.ENDOFCHAIN);for(G=D=0,H=0;H<w.FileIndex.length;++H)q=w.FileIndex[H],q.content&&(K=q.content.length,!(!K||K>=4096)&&(q.start=G,J(K+63>>6)));for(;P.l&511;)P.write_shift(-4,ue.ENDOFCHAIN);for(D=0;D<I[4]<<2;++D){var oe=w.FullPaths[D];if(!oe||oe.length===0){for(H=0;H<17;++H)P.write_shift(4,0);for(H=0;H<3;++H)P.write_shift(4,-1);for(H=0;H<12;++H)P.write_shift(4,0);continue}q=w.FileIndex[D],D===0&&(q.start=q.size?q.start-1:X);var ge=D===0&&S.root||q.name;if(K=2*(ge.length+1),P.write_shift(64,ge,"utf16le"),P.write_shift(2,K),P.write_shift(1,q.type),P.write_shift(1,q.color),P.write_shift(-4,q.L),P.write_shift(-4,q.R),P.write_shift(-4,q.C),q.clsid)P.write_shift(16,q.clsid,"hex");else for(H=0;H<4;++H)P.write_shift(4,0);P.write_shift(4,q.state||0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,q.start),P.write_shift(4,q.size),P.write_shift(4,0)}for(D=1;D<w.FileIndex.length;++D)if(q=w.FileIndex[D],q.size>=4096)if(P.l=q.start+1<<9,Ke&&Buffer.isBuffer(q.content))q.content.copy(P,P.l,0,q.size),P.l+=q.size+511&-512;else{for(H=0;H<q.size;++H)P.write_shift(1,q.content[H]);for(;H&511;++H)P.write_shift(1,0)}for(D=1;D<w.FileIndex.length;++D)if(q=w.FileIndex[D],q.size>0&&q.size<4096)if(Ke&&Buffer.isBuffer(q.content))q.content.copy(P,P.l,0,q.size),P.l+=q.size+63&-64;else{for(H=0;H<q.size;++H)P.write_shift(1,q.content[H]);for(;H&63;++H)P.write_shift(1,0)}if(Ke)P.l=P.length;else for(;P.l<P.length;)P.write_shift(1,0);return P}function j(w,R){var S=w.FullPaths.map(function(H){return H.toUpperCase()}),I=S.map(function(H){var K=H.split("/");return K[K.length-(H.slice(-1)=="/"?2:1)]}),P=!1;R.charCodeAt(0)===47?(P=!0,R=S[0].slice(0,-1)+R):P=R.indexOf("/")!==-1;var D=R.toUpperCase(),G=P===!0?S.indexOf(D):I.indexOf(D);if(G!==-1)return w.FileIndex[G];var J=!D.match(Ql);for(D=D.replace(Kr,""),J&&(D=D.replace(Ql,"!")),G=0;G<S.length;++G)if((J?S[G].replace(Ql,"!"):S[G]).replace(Kr,"")==D||(J?I[G].replace(Ql,"!"):I[G]).replace(Kr,"")==D)return w.FileIndex[G];return null}var b=64,X=-2,ne="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],se="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:X,FREESECT:-1,HEADER_SIGNATURE:ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function te(w,R,S){c();var I=M(w,S);l.writeFileSync(R,I)}function V(w){for(var R=new Array(w.length),S=0;S<w.length;++S)R[S]=String.fromCharCode(w[S]);return R.join("")}function ce(w,R){var S=M(w,R);switch(R&&R.type||"buffer"){case"file":return c(),l.writeFileSync(R.filename,S),S;case"binary":return typeof S=="string"?S:V(S);case"base64":return QE(typeof S=="string"?S:V(S));case"buffer":if(Ke)return Buffer.isBuffer(S)?S:Ga(S);case"array":return typeof S=="string"?Hn(S):S}return S}var Ee;function N(w){try{var R=w.InflateRaw,S=new R;if(S._processChunk(new Uint8Array([3,0]),S._finishFlushFlag),S.bytesRead)Ee=w;else throw new Error("zlib does not expose bytesRead")}catch(I){console.error("cannot use native zlib: "+(I.message||I))}}function z(w,R){if(!Ee)return Y_(w,R);var S=Ee.InflateRaw,I=new S,P=I._processChunk(w.slice(w.l),I._finishFlushFlag);return w.l+=I.bytesRead,P}function B(w){return Ee?Ee.deflateRawSync(w):Ue(w)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],de=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function xe(w){var R=(w<<1|w<<11)&139536|(w<<5|w<<15)&558144;return(R>>16|R>>8|R)&255}for(var me=typeof Uint8Array<"u",ae=me?new Uint8Array(256):[],ze=0;ze<256;++ze)ae[ze]=xe(ze);function L(w,R){var S=ae[w&255];return R<=8?S>>>8-R:(S=S<<8|ae[w>>8&255],R<=16?S>>>16-R:(S=S<<8|ae[w>>16&255],S>>>24-R))}function mt(w,R){var S=R&7,I=R>>>3;return(w[I]|(S<=6?0:w[I+1]<<8))>>>S&3}function Qe(w,R){var S=R&7,I=R>>>3;return(w[I]|(S<=5?0:w[I+1]<<8))>>>S&7}function it(w,R){var S=R&7,I=R>>>3;return(w[I]|(S<=4?0:w[I+1]<<8))>>>S&15}function Be(w,R){var S=R&7,I=R>>>3;return(w[I]|(S<=3?0:w[I+1]<<8))>>>S&31}function C(w,R){var S=R&7,I=R>>>3;return(w[I]|(S<=1?0:w[I+1]<<8))>>>S&127}function W(w,R,S){var I=R&7,P=R>>>3,D=(1<<S)-1,G=w[P]>>>I;return S<8-I||(G|=w[P+1]<<8-I,S<16-I)||(G|=w[P+2]<<16-I,S<24-I)||(G|=w[P+3]<<24-I),G&D}function Q(w,R,S){var I=R&7,P=R>>>3;return I<=5?w[P]|=(S&7)<<I:(w[P]|=S<<I&255,w[P+1]=(S&7)>>8-I),R+3}function we(w,R,S){var I=R&7,P=R>>>3;return S=(S&1)<<I,w[P]|=S,R+1}function pe(w,R,S){var I=R&7,P=R>>>3;return S<<=I,w[P]|=S&255,S>>>=8,w[P+1]=S,R+8}function fe(w,R,S){var I=R&7,P=R>>>3;return S<<=I,w[P]|=S&255,S>>>=8,w[P+1]=S&255,w[P+2]=S>>>8,R+16}function Ce(w,R){var S=w.length,I=2*S>R?2*S:R+5,P=0;if(S>=R)return w;if(Ke){var D=JE(I);if(w.copy)w.copy(D);else for(;P<w.length;++P)D[P]=w[P];return D}else if(me){var G=new Uint8Array(I);if(G.set)G.set(w);else for(;P<S;++P)G[P]=w[P];return G}return w.length=I,w}function je(w){for(var R=new Array(w),S=0;S<w;++S)R[S]=0;return R}function et(w,R,S){var I=1,P=0,D=0,G=0,J=0,H=w.length,K=me?new Uint16Array(32):je(32);for(D=0;D<32;++D)K[D]=0;for(D=H;D<S;++D)w[D]=0;H=w.length;var q=me?new Uint16Array(H):je(H);for(D=0;D<H;++D)K[P=w[D]]++,I<P&&(I=P),q[D]=0;for(K[0]=0,D=1;D<=I;++D)K[D+16]=J=J+K[D-1]<<1;for(D=0;D<H;++D)J=w[D],J!=0&&(q[D]=K[J+16]++);var oe=0;for(D=0;D<H;++D)if(oe=w[D],oe!=0)for(J=L(q[D],I)>>I-oe,G=(1<<I+4-oe)-1;G>=0;--G)R[J|G<<oe]=oe&15|D<<4;return I}var Mr=me?new Uint16Array(512):je(512),Zs=me?new Uint16Array(32):je(32);if(!me){for(var Ht=0;Ht<512;++Ht)Mr[Ht]=0;for(Ht=0;Ht<32;++Ht)Zs[Ht]=0}(function(){for(var w=[],R=0;R<32;R++)w.push(5);et(w,Zs,32);var S=[];for(R=0;R<=143;R++)S.push(8);for(;R<=255;R++)S.push(9);for(;R<=279;R++)S.push(7);for(;R<=287;R++)S.push(8);et(S,Mr,288)})();var Qr=function(){for(var R=me?new Uint8Array(32768):[],S=0,I=0;S<de.length-1;++S)for(;I<de[S+1];++I)R[I]=S;for(;I<32768;++I)R[I]=29;var P=me?new Uint8Array(259):[];for(S=0,I=0;S<Z.length-1;++S)for(;I<Z[S+1];++I)P[I]=S;function D(J,H){for(var K=0;K<J.length;){var q=Math.min(65535,J.length-K),oe=K+q==J.length;for(H.write_shift(1,+oe),H.write_shift(2,q),H.write_shift(2,~q&65535);q-- >0;)H[H.l++]=J[K++]}return H.l}function G(J,H){for(var K=0,q=0,oe=me?new Uint16Array(32768):[];q<J.length;){var ge=Math.min(65535,J.length-q);if(ge<10){for(K=Q(H,K,+(q+ge==J.length)),K&7&&(K+=8-(K&7)),H.l=K/8|0,H.write_shift(2,ge),H.write_shift(2,~ge&65535);ge-- >0;)H[H.l++]=J[q++];K=H.l*8;continue}K=Q(H,K,+(q+ge==J.length)+2);for(var ke=0;ge-- >0;){var he=J[q];ke=(ke<<5^he)&32767;var ye=-1,be=0;if((ye=oe[ke])&&(ye|=q&-32768,ye>q&&(ye-=32768),ye<q))for(;J[ye+be]==J[q+be]&&be<250;)++be;if(be>2){he=P[be],he<=22?K=pe(H,K,ae[he+1]>>1)-1:(pe(H,K,3),K+=5,pe(H,K,ae[he-23]>>5),K+=3);var xt=he<8?0:he-4>>2;xt>0&&(fe(H,K,be-Z[he]),K+=xt),he=R[q-ye],K=pe(H,K,ae[he]>>3),K-=3;var yt=he<4?0:he-2>>1;yt>0&&(fe(H,K,q-ye-de[he]),K+=yt);for(var vr=0;vr<be;++vr)oe[ke]=q&32767,ke=(ke<<5^J[q])&32767,++q;ge-=be-1}else he<=143?he=he+48:K=we(H,K,1),K=pe(H,K,ae[he]),oe[ke]=q&32767,++q}K=pe(H,K,0)-1}return H.l=(K+7)/8|0,H.l}return function(H,K){return H.length<8?D(H,K):G(H,K)}}();function Ue(w){var R=zt(50+Math.floor(w.length*1.1)),S=Qr(w,R);return R.slice(0,S)}var gt=me?new Uint16Array(32768):je(32768),Jr=me?new Uint16Array(32768):je(32768),At=me?new Uint16Array(128):je(128),ea=1,X_=1;function m4(w,R){var S=Be(w,R)+257;R+=5;var I=Be(w,R)+1;R+=5;var P=it(w,R)+4;R+=4;for(var D=0,G=me?new Uint8Array(19):je(19),J=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],H=1,K=me?new Uint8Array(8):je(8),q=me?new Uint8Array(8):je(8),oe=G.length,ge=0;ge<P;++ge)G[U[ge]]=D=Qe(w,R),H<D&&(H=D),K[D]++,R+=3;var ke=0;for(K[0]=0,ge=1;ge<=H;++ge)q[ge]=ke=ke+K[ge-1]<<1;for(ge=0;ge<oe;++ge)(ke=G[ge])!=0&&(J[ge]=q[ke]++);var he=0;for(ge=0;ge<oe;++ge)if(he=G[ge],he!=0){ke=ae[J[ge]]>>8-he;for(var ye=(1<<7-he)-1;ye>=0;--ye)At[ke|ye<<he]=he&7|ge<<3}var be=[];for(H=1;be.length<S+I;)switch(ke=At[C(w,R)],R+=ke&7,ke>>>=3){case 16:for(D=3+mt(w,R),R+=2,ke=be[be.length-1];D-- >0;)be.push(ke);break;case 17:for(D=3+Qe(w,R),R+=3;D-- >0;)be.push(0);break;case 18:for(D=11+C(w,R),R+=7;D-- >0;)be.push(0);break;default:be.push(ke),H<ke&&(H=ke);break}var xt=be.slice(0,S),yt=be.slice(S);for(ge=S;ge<286;++ge)xt[ge]=0;for(ge=I;ge<30;++ge)yt[ge]=0;return ea=et(xt,gt,286),X_=et(yt,Jr,30),R}function g4(w,R){if(w[0]==3&&!(w[1]&3))return[Hs(R),2];for(var S=0,I=0,P=JE(R||1<<18),D=0,G=P.length>>>0,J=0,H=0;!(I&1);){if(I=Qe(w,S),S+=3,I>>>1)I>>1==1?(J=9,H=5):(S=m4(w,S),J=ea,H=X_);else{S&7&&(S+=8-(S&7));var K=w[S>>>3]|w[(S>>>3)+1]<<8;if(S+=32,K>0)for(!R&&G<D+K&&(P=Ce(P,D+K),G=P.length);K-- >0;)P[D++]=w[S>>>3],S+=8;continue}for(;;){!R&&G<D+32767&&(P=Ce(P,D+32767),G=P.length);var q=W(w,S,J),oe=I>>>1==1?Mr[q]:gt[q];if(S+=oe&15,oe>>>=4,!(oe>>>8&255))P[D++]=oe;else{if(oe==256)break;oe-=257;var ge=oe<8?0:oe-4>>2;ge>5&&(ge=0);var ke=D+Z[oe];ge>0&&(ke+=W(w,S,ge),S+=ge),q=W(w,S,H),oe=I>>>1==1?Zs[q]:Jr[q],S+=oe&15,oe>>>=4;var he=oe<4?0:oe-2>>1,ye=de[oe];for(he>0&&(ye+=W(w,S,he),S+=he),!R&&G<ke&&(P=Ce(P,ke+100),G=P.length);D<ke;)P[D]=P[D-ye],++D}}}return R?[P,S+7>>>3]:[P.slice(0,D),S+7>>>3]}function Y_(w,R){var S=w.slice(w.l||0),I=g4(S,R);return w.l+=I[1],I[0]}function Q_(w,R){if(w)typeof console<"u"&&console.error(R);else throw new Error(R)}function J_(w,R){var S=w;lr(S,0);var I=[],P=[],D={FileIndex:I,FullPaths:P};E(D,{root:R.root});for(var G=S.length-4;(S[G]!=80||S[G+1]!=75||S[G+2]!=5||S[G+3]!=6)&&G>=0;)--G;S.l=G+4,S.l+=4;var J=S.read_shift(2);S.l+=6;var H=S.read_shift(4);for(S.l=H,G=0;G<J;++G){S.l+=20;var K=S.read_shift(4),q=S.read_shift(4),oe=S.read_shift(2),ge=S.read_shift(2),ke=S.read_shift(2);S.l+=8;var he=S.read_shift(4),ye=o(S.slice(S.l+oe,S.l+oe+ge));S.l+=oe+ge+ke;var be=S.l;S.l=he+4,v4(S,K,q,D,ye),S.l=be}return D}function v4(w,R,S,I,P){w.l+=2;var D=w.read_shift(2),G=w.read_shift(2),J=a(w);if(D&8257)throw new Error("Unsupported ZIP encryption");for(var H=w.read_shift(4),K=w.read_shift(4),q=w.read_shift(4),oe=w.read_shift(2),ge=w.read_shift(2),ke="",he=0;he<oe;++he)ke+=String.fromCharCode(w[w.l++]);if(ge){var ye=o(w.slice(w.l,w.l+ge));(ye[21589]||{}).mt&&(J=ye[21589].mt),((P||{})[21589]||{}).mt&&(J=P[21589].mt)}w.l+=ge;var be=w.slice(w.l,w.l+K);switch(G){case 8:be=z(w,q);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var xt=!1;D&8&&(H=w.read_shift(4),H==134695760&&(H=w.read_shift(4),xt=!0),K=w.read_shift(4),q=w.read_shift(4)),K!=R&&Q_(xt,"Bad compressed size: "+R+" != "+K),q!=S&&Q_(xt,"Bad uncompressed size: "+S+" != "+q),Md(I,ke,be,{unsafe:!0,mt:J})}function _4(w,R){var S=R||{},I=[],P=[],D=zt(1),G=S.compression?8:0,J=0,H=0,K=0,q=0,oe=0,ge=w.FullPaths[0],ke=ge,he=w.FileIndex[0],ye=[],be=0;for(H=1;H<w.FullPaths.length;++H)if(ke=w.FullPaths[H].slice(ge.length),he=w.FileIndex[H],!(!he.size||!he.content||ke=="Sh33tJ5")){var xt=q,yt=zt(ke.length);for(K=0;K<ke.length;++K)yt.write_shift(1,ke.charCodeAt(K)&127);yt=yt.slice(0,yt.l),ye[oe]=OV.buf(he.content,0);var vr=he.content;G==8&&(vr=B(vr)),D=zt(30),D.write_shift(4,67324752),D.write_shift(2,20),D.write_shift(2,J),D.write_shift(2,G),he.mt?s(D,he.mt):D.write_shift(4,0),D.write_shift(-4,ye[oe]),D.write_shift(4,vr.length),D.write_shift(4,he.content.length),D.write_shift(2,yt.length),D.write_shift(2,0),q+=D.length,I.push(D),q+=yt.length,I.push(yt),q+=vr.length,I.push(vr),D=zt(46),D.write_shift(4,33639248),D.write_shift(2,0),D.write_shift(2,20),D.write_shift(2,J),D.write_shift(2,G),D.write_shift(4,0),D.write_shift(-4,ye[oe]),D.write_shift(4,vr.length),D.write_shift(4,he.content.length),D.write_shift(2,yt.length),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(4,0),D.write_shift(4,xt),be+=D.l,P.push(D),be+=yt.length,P.push(yt),++oe}return D=zt(22),D.write_shift(4,101010256),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,oe),D.write_shift(2,oe),D.write_shift(4,be),D.write_shift(4,q),D.write_shift(2,0),hs([hs(I),hs(P),D])}var rf={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function x4(w,R){if(w.ctype)return w.ctype;var S=w.name||"",I=S.match(/\.([^\.]+)$/);return I&&rf[I[1]]||R&&(I=(S=R).match(/[\.\\]([^\.\\])+$/),I&&rf[I[1]])?rf[I[1]]:"application/octet-stream"}function y4(w){for(var R=QE(w),S=[],I=0;I<R.length;I+=76)S.push(R.slice(I,I+76));return S.join(`\r
`)+`\r
`}function E4(w){var R=w.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(K){var q=K.charCodeAt(0).toString(16).toUpperCase();return"="+(q.length==1?"0"+q:q)});R=R.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),R.charAt(0)==`
`&&(R="=0D"+R.slice(1)),R=R.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var S=[],I=R.split(`\r
`),P=0;P<I.length;++P){var D=I[P];if(D.length==0){S.push("");continue}for(var G=0;G<D.length;){var J=76,H=D.slice(G,G+J);H.charAt(J-1)=="="?J--:H.charAt(J-2)=="="?J-=2:H.charAt(J-3)=="="&&(J-=3),H=D.slice(G,G+J),G+=J,G<D.length&&(H+="="),S.push(H)}}return S.join(`\r
`)}function w4(w){for(var R=[],S=0;S<w.length;++S){for(var I=w[S];S<=w.length&&I.charAt(I.length-1)=="=";)I=I.slice(0,I.length-1)+w[++S];R.push(I)}for(var P=0;P<R.length;++P)R[P]=R[P].replace(/[=][0-9A-Fa-f]{2}/g,function(D){return String.fromCharCode(parseInt(D.slice(1),16))});return Hn(R.join(`\r
`))}function T4(w,R,S){for(var I="",P="",D="",G,J=0;J<10;++J){var H=R[J];if(!H||H.match(/^\s*$/))break;var K=H.match(/^(.*?):\s*([^\s].*)$/);if(K)switch(K[1].toLowerCase()){case"content-location":I=K[2].trim();break;case"content-type":D=K[2].trim();break;case"content-transfer-encoding":P=K[2].trim();break}}switch(++J,P.toLowerCase()){case"base64":G=Hn(xn(R.slice(J).join("")));break;case"quoted-printable":G=w4(R.slice(J));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+P)}var q=Md(w,I.slice(S.length),G,{unsafe:!0});D&&(q.ctype=D)}function k4(w,R){if(V(w.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var S=R&&R.root||"",I=(Ke&&Buffer.isBuffer(w)?w.toString("binary"):V(w)).split(`\r
`),P=0,D="";for(P=0;P<I.length;++P)if(D=I[P],!!/^Content-Location:/i.test(D)&&(D=D.slice(D.indexOf("file")),S||(S=D.slice(0,D.lastIndexOf("/")+1)),D.slice(0,S.length)!=S))for(;S.length>0&&(S=S.slice(0,S.length-1),S=S.slice(0,S.lastIndexOf("/")+1),D.slice(0,S.length)!=S););var G=(I[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var J="--"+(G[1]||""),H=[],K=[],q={FileIndex:H,FullPaths:K};E(q);var oe,ge=0;for(P=0;P<I.length;++P){var ke=I[P];ke!==J&&ke!==J+"--"||(ge++&&T4(q,I.slice(oe,P),S),oe=P)}return q}function A4(w,R){var S=R||{},I=S.boundary||"SheetJS";I="------="+I;for(var P=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+I.slice(2)+'"',"","",""],D=w.FullPaths[0],G=D,J=w.FileIndex[0],H=1;H<w.FullPaths.length;++H)if(G=w.FullPaths[H].slice(D.length),J=w.FileIndex[H],!(!J.size||!J.content||G=="Sh33tJ5")){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(be){return"_x"+be.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(be){return"_u"+be.charCodeAt(0).toString(16)+"_"});for(var K=J.content,q=Ke&&Buffer.isBuffer(K)?K.toString("binary"):V(K),oe=0,ge=Math.min(1024,q.length),ke=0,he=0;he<=ge;++he)(ke=q.charCodeAt(he))>=32&&ke<128&&++oe;var ye=oe>=ge*4/5;P.push(I),P.push("Content-Location: "+(S.root||"file:///C:/SheetJS/")+G),P.push("Content-Transfer-Encoding: "+(ye?"quoted-printable":"base64")),P.push("Content-Type: "+x4(J,G)),P.push(""),P.push(ye?E4(q):y4(q))}return P.push(I+`--\r
`),P.join(`\r
`)}function S4(w){var R={};return E(R,w),R}function Md(w,R,S,I){var P=I&&I.unsafe;P||E(w);var D=!P&&Xe.find(w,R);if(!D){var G=w.FullPaths[0];R.slice(0,G.length)==G?G=R:(G.slice(-1)!="/"&&(G+="/"),G=(G+R).replace("//","/")),D={name:i(R),type:2},w.FileIndex.push(D),w.FullPaths.push(G),P||Xe.utils.cfb_gc(w)}return D.content=S,D.size=S?S.length:0,I&&(I.CLSID&&(D.clsid=I.CLSID),I.mt&&(D.mt=I.mt),I.ct&&(D.ct=I.ct)),D}function I4(w,R){E(w);var S=Xe.find(w,R);if(S){for(var I=0;I<w.FileIndex.length;++I)if(w.FileIndex[I]==S)return w.FileIndex.splice(I,1),w.FullPaths.splice(I,1),!0}return!1}function C4(w,R,S){E(w);var I=Xe.find(w,R);if(I){for(var P=0;P<w.FileIndex.length;++P)if(w.FileIndex[P]==I)return w.FileIndex[P].name=i(S),w.FullPaths[P]=S,!0}return!1}function R4(w){O(w,!0)}return t.find=j,t.read=A,t.parse=u,t.write=ce,t.writeFile=te,t.utils={cfb_new:S4,cfb_add:Md,cfb_del:I4,cfb_mov:C4,cfb_gc:R4,ReadShift:vc,CheckField:aR,prep_blob:lr,bconcat:hs,use_zlib:N,_deflateRaw:Ue,_inflateRaw:Y_,consts:ue},t}();function LV(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function yi(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function I_(e){for(var t=[],r=yi(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var _0=new Date(1899,11,30,0,0,0);function qr(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=_0.getTime()+(e.getTimezoneOffset()-_0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var VC=new Date,bV=_0.getTime()+(VC.getTimezoneOffset()-_0.getTimezoneOffset())*6e4,aw=VC.getTimezoneOffset();function Fd(e){var t=new Date;return t.setTime(e*24*60*60*1e3+bV),t.getTimezoneOffset()!==aw&&t.setTime(t.getTime()+(t.getTimezoneOffset()-aw)*6e4),t}function MV(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var ow=new Date("2017-02-19T19:06:09.000Z"),UC=isNaN(ow.getFullYear())?new Date("2/19/17"):ow,VV=UC.getFullYear()==2017;function rr(e,t){var r=new Date(e);if(VV)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(UC.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function La(e,t){if(Ke&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Zl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Zl(AC(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Zl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Zl(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function pr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=pr(e[r]));return t}function It(e,t){for(var r="";r.length<t;)r+=e;return r}function Xn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var UV=["january","february","march","april","may","june","july","august","september","october","november","december"];function Zo(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&UV.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var BV=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function BC(e){return e?e.content&&e.type?La(e.content,!0):e.data?Yl(e.data):e.asNodeBuffer&&Ke?Yl(e.asNodeBuffer().toString("binary")):e.asBinary?Yl(e.asBinary()):e._data&&e._data.getContent?Yl(La(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function jC(e){if(!e)return null;if(e.data)return XE(e.data);if(e.asNodeBuffer&&Ke)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?XE(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function jV(e){return e&&e.name.slice(-4)===".bin"?jC(e):BC(e)}function kn(e,t){for(var r=e.FullPaths||yi(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function C_(e,t){var r=kn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Vt(e,t,r){if(!r)return jV(C_(e,t));if(!t)return null;try{return Vt(e,t)}catch{return null}}function fn(e,t,r){if(!r)return BC(C_(e,t));if(!t)return null;try{return fn(e,t)}catch{return null}}function $C(e,t,r){if(!r)return jC(C_(e,t));if(!t)return null;try{return $C(e,t)}catch{return null}}function lw(e){for(var t=e.FullPaths||yi(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function $V(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ke?n=Ga(r):n=lV(r),Xe.utils.cfb_add(e,t,n)}Xe.utils.cfb_add(e,t,r)}else e.file(t,r)}function HC(e,t){switch(t.type){case"base64":return Xe.read(e,{type:"base64"});case"binary":return Xe.read(e,{type:"binary"});case"buffer":case"array":return Xe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Jl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var zC=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,HV=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,cw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,zV=/<[^>]*>/g,br=zC.match(cw)?cw:zV,WV=/<\w*:/,GV=/<(\/?)\w+:/;function Pe(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var a=e.match(HV),o=0,l="",c=0,u="",f="",h=1;if(a)for(c=0;c!=a.length;++c){for(f=a[c],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(u=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(h=(i=f.charCodeAt(s+1))==34||i==39?1:0,l=f.slice(s+1+h,f.length-h),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,r||(n[u.toLowerCase()]=l);else{var d=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[d]&&u.slice(o-3,o)=="ext")continue;n[d]=l,r||(n[d.toLowerCase()]=l)}}return n}function wi(e){return e.replace(GV,"<$1")}var WC={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},KV=I_(WC),Ze=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(o,l){return WC[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),qV=/[&<>'"]/g,XV=/[\u0000-\u001f]/g;function R_(e){var t=e+"";return t.replace(qV,function(r){return KV[r]}).replace(/\n/g,"<br/>").replace(XV,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var uw=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function vt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Kp(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function fw(e){var t=Hs(2*e.length),r,n,i=1,s=0,a=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function hw(e){return Ga(e,"binary").toString("utf8")}var Lf="foo bar bazâð£",lt=Ke&&(hw(Lf)==Kp(Lf)&&hw||fw(Lf)==Kp(Lf)&&fw)||Kp,Zl=Ke?function(e){return Ga(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},hu=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),GC=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),YV=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),QV=/<\/?(?:vt:)?variant>/g,JV=/<(?:vt:)([^>]*)>([\s\S]*)</;function dw(e,t){var r=Pe(e),n=e.match(YV(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(QV,"").match(JV);a&&i.push({v:lt(a[2]),t:a[1]})}),i}var ZV=/(^\s|\s$|\n)/;function eU(e){return yi(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function tU(e,t,r){return"<"+e+(r!=null?eU(r):"")+(t!=null?(t.match(ZV)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function P_(e){if(Ke&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return lt(Ka(k_(e)));throw new Error("Bad input format: expected Buffer or string")}var du=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,rU={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},nU=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function iU(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function sU(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=n?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var pw=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},mw=Ke?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ga(t)})):pw(e)}:pw,gw=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Di(e,i)));return n.join("").replace(Kr,"")},F_=Ke?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Kr,""):gw(e,t,r)}:gw,vw=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},KC=Ke?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):vw(e,t,r)}:vw,_w=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(so(e,i)));return n.join("")},Yu=Ke?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):_w(t,r,n)}:_w,qC=function(e,t){var r=un(e,t);return r>0?Yu(e,t+4,t+4+r-1):""},XC=qC,YC=function(e,t){var r=un(e,t);return r>0?Yu(e,t+4,t+4+r-1):""},QC=YC,JC=function(e,t){var r=2*un(e,t);return r>0?Yu(e,t+4,t+4+r-1):""},ZC=JC,eR=function(t,r){var n=un(t,r);return n>0?F_(t,r+4,r+4+n):""},tR=eR,rR=function(e,t){var r=un(e,t);return r>0?Yu(e,t+4,t+4+r):""},nR=rR,iR=function(e,t){return iU(e,t)},x0=iR,sR=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ke&&(XC=function(t,r){if(!Buffer.isBuffer(t))return qC(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},QC=function(t,r){if(!Buffer.isBuffer(t))return YC(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},ZC=function(t,r){if(!Buffer.isBuffer(t))return JC(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},tR=function(t,r){if(!Buffer.isBuffer(t))return eR(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},nR=function(t,r){if(!Buffer.isBuffer(t))return rR(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},x0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):iR(t,r)},sR=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var so=function(e,t){return e[t]},Di=function(e,t){return e[t+1]*256+e[t]},aU=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},un=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},aa=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},oU=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function vc(e,t){var r="",n,i,s=[],a,o,l,c;switch(t){case"dbcs":if(c=this.l,Ke&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Di(this,c)),c+=2;e*=2;break;case"utf8":r=Yu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=F_(this,this.l,this.l+e);break;case"wstr":return vc.call(this,e,"dbcs");case"lpstr-ansi":r=XC(this,this.l),e=4+un(this,this.l);break;case"lpstr-cp":r=QC(this,this.l),e=4+un(this,this.l);break;case"lpwstr":r=ZC(this,this.l),e=4+2*un(this,this.l);break;case"lpp4":e=4+un(this,this.l),r=tR(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+un(this,this.l),r=nR(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=so(this,this.l+e++))!==0;)s.push(Of(a));r=s.join("");break;case"_wstr":for(e=0,r="";(a=Di(this,this.l+e))!==0;)s.push(Of(a)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=so(this,c),this.l=c+1,o=vc.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Of(Di(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=so(this,c),this.l=c+1,o=vc.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Of(so(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=so(this,this.l),this.l++,n;case 2:return n=(t==="i"?aU:Di)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?aa:oU)(this,this.l),this.l+=4,n):(i=un(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=x0(this,this.l):i=x0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=KC(this,this.l,e);break}}return this.l+=e,r}var lU=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},cU=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},uU=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function fU(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)uU(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,lU(this,t,this.l);break;case 8:if(n=8,r==="f"){sU(this,t,this.l);break}case 16:break;case-4:n=4,cU(this,t,this.l);break}return this.l+=n,this}function aR(e,t){var r=KC(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function lr(e,t){e.l=t,e.read_shift=vc,e.chk=aR,e.write_shift=fU}function Lr(e,t){e.l+=t}function zt(e){var t=Hs(e);return lr(t,0),t}function Yi(e,t,r){if(e){var n,i,s;lr(e,e.l||0);for(var a=e.length,o=0,l=0;e.l<a;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=A0[o]||A0[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;l=e.l+s;var u=c.f&&c.f(e,s,r);if(e.l=l,t(u,c,o))return}}}function Mg(){var e=[],t=Ke?256:2048,r=function(c){var u=zt(c);return lr(u,0),u},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},a=function(){return i(),hs(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function _c(e,t,r){var n=pr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function xw(e,t,r){var n=pr(e);return n.s=_c(n.s,t.s,r),n.e=_c(n.e,t.s,r),n}function xc(e,t){if(e.cRel&&e.c<0)for(e=pr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=pr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Le(e);return!e.cRel&&e.cRel!=null&&(r=pU(r)),!e.rRel&&e.rRel!=null&&(r=hU(r)),r}function qp(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Kt(e.s.c)+":"+(e.e.cRel?"":"$")+Kt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+mr(e.s.r)+":"+(e.e.rRel?"":"$")+mr(e.e.r):xc(e.s,t.biff)+":"+xc(e.e,t.biff)}function N_(e){return parseInt(dU(e),10)-1}function mr(e){return""+(e+1)}function hU(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function dU(e){return e.replace(/\$(\d+)$/,"$1")}function D_(e){for(var t=mU(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Kt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function pU(e){return e.replace(/^([A-Z])/,"$$$1")}function mU(e){return e.replace(/^\$([A-Z])/,"$1")}function gU(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function zr(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Le(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function yl(e){var t=e.indexOf(":");return t==-1?{s:zr(e),e:zr(e)}:{s:zr(e.slice(0,t)),e:zr(e.slice(t+1))}}function Ye(e,t){return typeof t>"u"||typeof t=="number"?Ye(e.s,e.e):(typeof e!="string"&&(e=Le(e)),typeof t!="string"&&(t=Le(t)),e==t?e:e+":"+t)}function Pt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function yw(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=On(e.z,r?qr(t):t)}catch{}try{return e.w=On((e.XF||{}).numFmtId||(r?14:0),r?qr(t):t)}catch{return""+t}}function Gi(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ya[e.v]||e.v:t==null?yw(e,e.v):yw(e,t))}function Js(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function oR(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?zr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Pt(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var d={v:t[f][h]},m=a+f,p=o+h;if(c.s.r>m&&(c.s.r=m),c.s.c>p&&(c.s.c=p),c.e.r<m&&(c.e.r=m),c.e.c<p&&(c.e.c=p),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))d=t[f][h];else if(Array.isArray(d.v)&&(d.f=t[f][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||Me[14],n.cellDates?(d.t="d",d.w=On(d.z,qr(d.v))):(d.t="n",d.v=qr(d.v),d.w=On(d.z,d.v))):d.t="s";if(i)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(d.z=s[m][p].z),s[m][p]=d;else{var g=Le({c:p,r:m});s[g]&&s[g].z&&(d.z=s[g].z),s[g]=d}}}return c.s.c<1e7&&(s["!ref"]=Ye(c)),s}function El(e,t){return oR(null,e,t)}function vU(e){return e.read_shift(4,"i")}function Fr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function _U(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function O_(e,t){var r=e.l,n=e.read_shift(1),i=Fr(e),s=[],a={t:i,h:i};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(_U(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}var xU=O_;function bn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function qa(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var yU=Fr;function L_(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var EU=Fr,Vg=L_;function b_(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?x0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):aa(t,0)>>2;return r?i/100:i}function lR(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Xa=lR;function Ir(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function wU(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=Ea[i];c&&(t.rgb=mu(c));break;case 2:t.rgb=mu([a,o,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function TU(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function cR(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function kU(e){return cR(e,1)}function AU(e){return cR(e,2)}var M_=2,Zr=3,bf=11,Ew=12,y0=19,Mf=64,SU=65,IU=71,CU=4108,RU=4126,Zt=80,uR=81,PU=[Zt,uR],FU={1:{n:"CodePage",t:M_},2:{n:"Category",t:Zt},3:{n:"PresentationFormat",t:Zt},4:{n:"ByteCount",t:Zr},5:{n:"LineCount",t:Zr},6:{n:"ParagraphCount",t:Zr},7:{n:"SlideCount",t:Zr},8:{n:"NoteCount",t:Zr},9:{n:"HiddenCount",t:Zr},10:{n:"MultimediaClipCount",t:Zr},11:{n:"ScaleCrop",t:bf},12:{n:"HeadingPairs",t:CU},13:{n:"TitlesOfParts",t:RU},14:{n:"Manager",t:Zt},15:{n:"Company",t:Zt},16:{n:"LinksUpToDate",t:bf},17:{n:"CharacterCount",t:Zr},19:{n:"SharedDoc",t:bf},22:{n:"HyperlinksChanged",t:bf},23:{n:"AppVersion",t:Zr,p:"version"},24:{n:"DigSig",t:SU},26:{n:"ContentType",t:Zt},27:{n:"ContentStatus",t:Zt},28:{n:"Language",t:Zt},29:{n:"Version",t:Zt},255:{},2147483648:{n:"Locale",t:y0},2147483651:{n:"Behavior",t:y0},1919054434:{}},NU={1:{n:"CodePage",t:M_},2:{n:"Title",t:Zt},3:{n:"Subject",t:Zt},4:{n:"Author",t:Zt},5:{n:"Keywords",t:Zt},6:{n:"Comments",t:Zt},7:{n:"Template",t:Zt},8:{n:"LastAuthor",t:Zt},9:{n:"RevNumber",t:Zt},10:{n:"EditTime",t:Mf},11:{n:"LastPrinted",t:Mf},12:{n:"CreatedDate",t:Mf},13:{n:"ModifiedDate",t:Mf},14:{n:"PageCount",t:Zr},15:{n:"WordCount",t:Zr},16:{n:"CharCount",t:Zr},17:{n:"Thumbnail",t:IU},18:{n:"Application",t:Zt},19:{n:"DocSecurity",t:Zr},255:{},2147483648:{n:"Locale",t:y0},2147483651:{n:"Behavior",t:y0},1919054434:{}},ww={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},DU=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function OU(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var LU=OU([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ea=pr(LU),Ya={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},fR={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Tw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function bU(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function MU(e){var t=bU();if(!e||!e.match)return t;var r={};if((e.match(br)||[]).forEach(function(n){var i=Pe(n);switch(i[0].replace(WV,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[Tw[i.ContentType]]!==void 0&&t[Tw[i.ContentType]].push(i.PartName);break}}),t.xmlns!==rU.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var wo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ug(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function yc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(br)||[]).forEach(function(i){var s=Pe(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Jl(s.Target,t);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}var VU="application/vnd.oasis.opendocument.spreadsheet";function UU(e,t){for(var r=P_(e),n,i;n=du.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Pe(n[0],!1),i.path=="/"&&i.type!==VU)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Ec=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],BU=function(){for(var e=new Array(Ec.length),t=0;t<Ec.length;++t){var r=Ec[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function hR(e){var t={};e=lt(e);for(var r=0;r<Ec.length;++r){var n=Ec[r],i=e.match(BU[r]);i!=null&&i.length>0&&(t[n[1]]=Ze(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=rr(t[n[1]]))}return t}var jU=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function dR(e,t,r,n){var i=[];if(typeof e=="string")i=dw(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(u){return{v:u}}));var a=typeof t=="string"?dw(t,n).map(function(u){return u.v}):t,o=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function $U(e,t,r){var n={};return t||(t={}),e=lt(e),jU.forEach(function(i){var s=(e.match(hu(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=Ze(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var a=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&dR(n.HeadingPairs,n.TitlesOfParts,t,r),t}var HU=/<[^>]+>[^<]*/g;function zU(e,t){var r={},n="",i=e.match(HU);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=Pe(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ze(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Ze(u);break;case"bool":r[n]=vt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=rr(u);break;case"cy":case"error":r[n]=Ze(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(t.WTF)throw new Error(a)}}}return r}var WU={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Xp;function GU(e,t,r){Xp||(Xp=I_(WU)),t=Xp[t]||t,e[t]=r}function V_(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function pR(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function mR(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function gR(e,t,r){return t===31?mR(e):pR(e,t,r)}function Bg(e,t,r){return gR(e,t,r===!1?0:4)}function KU(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return gR(e,t,0)}function qU(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Kr,""),e.l-i&2&&(e.l+=2)}return r}function XU(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Kr,"");return r}function YU(e){var t=e.l,r=E0(e,uR);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=E0(e,Zr);return[r,n]}function QU(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(YU(e));return r}function kw(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),a=e.read_shift(4);n[s]=e.read_shift(a,t===1200?"utf16le":"utf8").replace(Kr,"").replace(Ql,"!"),t===1200&&a%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function vR(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function JU(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function E0(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==Ew&&n!==t&&PU.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Ew?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return pR(e,n,4).replace(Kr,"");case 31:return mR(e);case 64:return V_(e);case 65:return vR(e);case 71:return JU(e);case 80:return Bg(e,n,!s.raw).replace(Kr,"");case 81:return KU(e,n).replace(Kr,"");case 4108:return QU(e);case 4126:case 4127:return n==4127?qU(e):XU(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Aw(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],a=0,o=0,l=-1,c={};for(a=0;a!=i;++a){var u=e.read_shift(4),f=e.read_shift(4);s[a]=[u,f+r]}s.sort(function(_,v){return _[1]-v[1]});var h={};for(a=0;a!=i;++a){if(e.l!==s[a][1]){var d=!0;if(a>0&&t)switch(t[s[a-1][0]].t){case 2:e.l+2===s[a][1]&&(e.l+=2,d=!1);break;case 80:e.l<=s[a][1]&&(e.l=s[a][1],d=!1);break;case 4108:e.l<=s[a][1]&&(e.l=s[a][1],d=!1);break}if((!t||a==0)&&e.l<=s[a][1]&&(d=!1,e.l=s[a][1]),d)throw new Error("Read Error: Expected address "+s[a][1]+" at "+e.l+" :"+a)}if(t){var m=t[s[a][0]];if(h[m.n]=E0(e,m.t,{raw:!0}),m.p==="version"&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(h[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:zn(o=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(s[a][0]===1){if(o=h.CodePage=E0(e,M_),zn(o),l!==-1){var p=e.l;e.l=s[l][1],c=kw(e,o),e.l=p}}else if(s[a][0]===0){if(o===0){l=a,e.l=s[a+1][1];continue}c=kw(e,o)}else{var g=c[s[a][0]],x;switch(e[e.l]){case 65:e.l+=4,x=vR(e);break;case 30:e.l+=4,x=Bg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=Bg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=Nt(e,4);break;case 64:e.l+=4,x=rr(V_(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=x}}return e.l=r+n,h}function Sw(e,t,r){var n=e.content;if(!n)return{};lr(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Xe.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var f=Aw(n,t),h={SystemIdentifier:c};for(var d in f)h[d]=f[d];if(h.FMTID=s,i===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var m;try{m=Aw(n,null)}catch{}for(d in m)h[d]=m[d];return h.FMTID=[s,a],h}function es(e,t){return e.read_shift(t),null}function ZU(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Nt(e,t){return e.read_shift(t)===1}function Ut(e){return e.read_shift(2,"u")}function _R(e,t){return ZU(e,t,Ut)}function eB(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Qu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return a}function tB(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return i&&(e.l+=4*a),n&&(e.l+=o),l.t=u,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function ba(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Ju(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):ba(e,n,r)}function Qa(e,t,r){if(r.biff>5)return Ju(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function rB(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function nB(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Kr,"");return n&&(e.l+=24),i}function iB(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=e.read_shift(s>>1,"utf16le").replace(Kr,"");return r+a}function sB(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return nB(e);case"0303000000000000c000000000000046":return iB(e);default:throw new Error("Unsupported Moniker "+r)}}function Vf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Kr,""):"";return r}function aB(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,a,o,l,c="",u,f;i&16&&(s=Vf(e,r-e.l)),i&128&&(a=Vf(e,r-e.l)),(i&257)===257&&(o=Vf(e,r-e.l)),(i&257)===1&&(l=sB(e,r-e.l)),i&8&&(c=Vf(e,r-e.l)),i&32&&(u=e.read_shift(16)),i&64&&(f=V_(e)),e.l=r;var h=a||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var d={Target:h};return u&&(d.guid=u),f&&(d.time=f),s&&(d.Tooltip=s),d}function xR(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function yR(e,t){var r=xR(e);return r[3]=0,r}function Ti(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function oB(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function lB(e,t,r){return t===0?"":Qa(e,t,r)}function cB(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[i,s,a]}function ER(e){var t=e.read_shift(2),r=b_(e);return[t,r]}function uB(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=Qu(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function Nd(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function wR(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var fB=wR;function TR(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function hB(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function dB(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Er(e){e.l+=2,e.l+=e.read_shift(2)}var pB={0:Er,4:Er,5:Er,6:Er,7:dB,8:Er,9:Er,10:Er,11:Er,12:Er,13:hB,14:Er,15:Er,16:Er,17:Er,18:Er,19:Er,20:Er,21:TR};function mB(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(pB[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Uf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function gB(e,t){return t===0||e.read_shift(2),1200}function vB(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Qa(e,0,r);return e.read_shift(t+n-e.l),i}function _B(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function xB(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Qu(e,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function yB(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],a=0;a!=i&&e.l<r;++a)s.push(tB(e));return s.Count=n,s.Unique=i,s}function EB(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function wB(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function TB(e){var t=oB(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function kB(e){return e.read_shift(2),e.read_shift(4)}function Iw(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function AB(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function SB(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function IB(){}function CB(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Qu(e,0,r),n}function RB(e){var t=Ti(e);return t.isst=e.read_shift(4),t}function PB(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=Ti(e);r.biff==2&&e.l++;var s=Ju(e,n-e.l,r);return i.val=s,i}function FB(e,t,r){var n=e.read_shift(2),i=Qa(e,0,r);return[n,i]}var NB=Qa;function Cw(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),a=e.read_shift(i),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function DB(e){var t=e.read_shift(2),r=e.read_shift(2),n=ER(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function OB(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(ER(e));if(e.l!==r)throw new Error("MulRK read error");var a=e.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function LB(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var a=e.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function bB(e,t,r,n){var i={},s=e.read_shift(4),a=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return i.patternType=DU[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function MB(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=bB(e,t,n.fStyle,r),n}function VB(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Rw(e,t,r){var n=Ti(e);(r.biff==2||t==9)&&++e.l;var i=eB(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function UB(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ti(e),i=Ir(e);return n.val=i,n}var Pw=lB;function BB(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=ba(e,s),o=[];n>e.l;)o.push(Ju(e));return[s,i,a,o]}function Fw(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=uB(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var jB=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Nw(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),a=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=ba(e,a,r);i&32&&(c=jB[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var f=n==e.l||o===0||!(u>0)?[]:wH(e,u,r,o);return{chKey:s,Name:c,itab:l,rgce:f}}function kR(e,t,r){if(r.biff<8)return $B(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(cB(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function $B(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Qu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function HB(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=ba(e,n,r),a=ba(e,i,r);return[s,a]}function zB(e,t,r){var n=wR(e);e.l++;var i=e.read_shift(1);return t-=8,[TH(e,t,r),i,n]}function Dw(e,t,r){var n=fB(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,yH(e,t,r)]}function WB(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function GB(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=Qa(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,a,s]}}function KB(e,t,r){return GB(e,t,r)}function qB(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Nd(e));return r}function XB(e,t,r){if(r&&r.biff<8)return QB(e,t,r);var n=TR(e),i=mB(e,t-22,n[1]);return{cmo:n,ft:i}}var YB={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function QB(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var a=[];return a.push((YB[n]||Lr)(e,t,r)),{cmo:[i,n,s],ft:a}}function JB(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:a=rB(e,6,r);var o=e.read_shift(2);e.read_shift(2),Ut(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],f=ba(e,e.lens[c+1]-e.lens[c]-1);if(i+=f,i.length>=(u?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function ZB(e,t){var r=Nd(e);e.l+=16;var n=aB(e,t-24);return[r,n]}function e7(e,t){e.read_shift(2);var r=Nd(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Kr,""),[r,n]}function t7(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=ww[r]||r,r=e.read_shift(2),t[1]=ww[r]||r,t}function r7(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(yR(e));return r}function n7(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(yR(e));return r}function i7(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function AR(e,t,r){if(!r.cellStyles)return Lr(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function s7(e,t){var r={};return t<32||(e.l+=16,r.header=Ir(e),r.footer=Ir(e),e.l+=2),r}function a7(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var o7=Ti,l7=_R,c7=Ju;function u7(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function f7(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ti(e);++e.l;var i=Qa(e,t-7,r);return n.t="str",n.val=i,n}function h7(e){var t=Ti(e);++e.l;var r=Ir(e);return t.t="n",t.val=r,t}function d7(e){var t=Ti(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function p7(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function m7(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function g7(e,t,r){var n=e.l+t,i=Ti(e),s=e.read_shift(2),a=ba(e,s,r);return e.l=n,i.t="str",i.val=a,i}var v7=[2,3,48,49,131,139,140,245],Ow=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=I_({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=Hs(1);switch(l.type){case"base64":u=Hn(xn(o));break;case"binary":u=Hn(o);break;case"buffer":case"array":u=o;break}lr(u,0);var f=u.read_shift(1),h=!!(f&136),d=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,g=521;f==2&&(p=u.read_shift(2)),u.l+=3,f!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(g=u.read_shift(2));var x=u.read_shift(2),_=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(_=e[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var v=[],T={},k=Math.min(u.length,f==2?521:g-10-(d?264:0)),A=m?32:11;u.l<k&&u[u.l]!=13;)switch(T={},T.name=fs.utils.decode(_,u.slice(u.l,u.l+A)).replace(/[\u0000\r\n].*$/g,""),u.l+=A,T.type=String.fromCharCode(u.read_shift(1)),f!=2&&!m&&(T.offset=u.read_shift(4)),T.len=u.read_shift(1),f==2&&(T.offset=u.read_shift(2)),T.dec=u.read_shift(1),T.name.length&&v.push(T),f!=2&&(u.l+=m?13:14),T.type){case"B":(!d||T.len!=8)&&l.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var E=0,F=0;for(c[0]=[],F=0;F!=v.length;++F)c[0][F]=v[F].name;for(;p-- >0;){if(u[u.l]===42){u.l+=x;continue}for(++u.l,c[++E]=[],F=0,F=0;F!=v.length;++F){var O=u.slice(u.l,u.l+v[F].len);u.l+=v[F].len,lr(O,0);var M=fs.utils.decode(_,O);switch(v[F].type){case"C":M.trim().length&&(c[E][F]=M.replace(/\s+$/,""));break;case"D":M.length===8?c[E][F]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):c[E][F]=M;break;case"F":c[E][F]=parseFloat(M.trim());break;case"+":case"I":c[E][F]=m?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":c[E][F]=!0;break;case"N":case"F":c[E][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[E][F]="##MEMO##"+(m?parseInt(M.trim(),10):O.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(c[E][F]=+M||0);break;case"@":c[E][F]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":c[E][F]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":c[E][F]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[E][F]=-O.read_shift(-8,"f");break;case"B":if(d&&v[F].len==8){c[E][F]=O.read_shift(8,"f");break}case"G":case"P":O.l+=v[F].len;break;case"0":if(v[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[F].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=v,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=El(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function i(o,l){try{return Js(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&zn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Mg(),f=Kg(o,{header:1,raw:!0,cellDates:!0}),h=f[0],d=f.slice(1),m=o["!cols"]||[],p=0,g=0,x=0,_=1;for(p=0;p<h.length;++p){if(((m[p]||{}).DBF||{}).name){h[p]=m[p].DBF.name,++x;continue}if(h[p]!=null){if(++x,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(g=0;g<1024;++g)if(h.indexOf(h[p]+"_"+g)==-1){h[p]+="_"+g;break}}}}var v=Pt(o["!ref"]),T=[],k=[],A=[];for(p=0;p<=v.e.c-v.s.c;++p){var E="",F="",O=0,M=[];for(g=0;g<d.length;++g)d[g][p]!=null&&M.push(d[g][p]);if(M.length==0||h[p]==null){T[p]="?";continue}for(g=0;g<M.length;++g){switch(typeof M[g]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=M[g]instanceof Date?"D":"C";break;default:F="C"}O=Math.max(O,String(M[g]).length),E=E&&E!=F?"C":F}O>250&&(O=250),F=((m[p]||{}).DBF||{}).type,F=="C"&&m[p].DBF.len>O&&(O=m[p].DBF.len),E=="B"&&F=="N"&&(E="N",A[p]=m[p].DBF.dec,O=m[p].DBF.len),k[p]=E=="C"||F=="N"?O:s[E]||0,_+=k[p],T[p]=E}var j=u.next(32);for(j.write_shift(4,318902576),j.write_shift(4,d.length),j.write_shift(2,296+32*x),j.write_shift(2,_),p=0;p<4;++p)j.write_shift(4,0);for(j.write_shift(4,0|(+t[TC]||3)<<8),p=0,g=0;p<h.length;++p)if(h[p]!=null){var b=u.next(32),X=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);b.write_shift(1,X,"sbcs"),b.write_shift(1,T[p]=="?"?"C":T[p],"sbcs"),b.write_shift(4,g),b.write_shift(1,k[p]||s[T[p]]||0),b.write_shift(1,A[p]||0),b.write_shift(1,2),b.write_shift(4,0),b.write_shift(1,0),b.write_shift(4,0),b.write_shift(4,0),g+=k[p]||s[T[p]]||0}var ne=u.next(264);for(ne.write_shift(4,13),p=0;p<65;++p)ne.write_shift(4,0);for(p=0;p<d.length;++p){var re=u.next(_);for(re.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(T[g]){case"L":re.write_shift(1,d[p][g]==null?63:d[p][g]?84:70);break;case"B":re.write_shift(8,d[p][g]||0,"f");break;case"N":var se="0";for(typeof d[p][g]=="number"&&(se=d[p][g].toFixed(A[g]||0)),x=0;x<k[g]-se.length;++x)re.write_shift(1,32);re.write_shift(1,se,"sbcs");break;case"D":d[p][g]?(re.write_shift(4,("0000"+d[p][g].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(d[p][g].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+d[p][g].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(d[p][g]!=null?d[p][g]:"").slice(0,k[g]);for(re.write_shift(1,ue,"sbcs"),x=0;x<k[g]-ue.length;++x)re.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),_7=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+yi(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,d){var m=e[d];return typeof m=="number"?YE(m):m},n=function(h,d,m){var p=d.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?h:YE(p)};e["|"]=254;function i(h,d){switch(d.type){case"base64":return s(xn(h),d);case"binary":return s(h,d);case"buffer":return s(Ke&&Buffer.isBuffer(h)?h.toString("binary"):Ka(h),d);case"array":return s(La(h),d)}throw new Error("Unrecognized type "+d.type)}function s(h,d){var m=h.split(/[\n\r]+/),p=-1,g=-1,x=0,_=0,v=[],T=[],k=null,A={},E=[],F=[],O=[],M=0,j;for(+d.codepage>=0&&zn(+d.codepage);x!==m.length;++x){M=0;var b=m[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),X=b.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),ne=X[0],re;if(b.length>0)switch(ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":X[1].charAt(0)=="P"&&T.push(b.slice(3).replace(/;;/g,";"));break;case"C":var se=!1,ue=!1,te=!1,V=!1,ce=-1,Ee=-1;for(_=1;_<X.length;++_)switch(X[_].charAt(0)){case"A":break;case"X":g=parseInt(X[_].slice(1))-1,ue=!0;break;case"Y":for(p=parseInt(X[_].slice(1))-1,ue||(g=0),j=v.length;j<=p;++j)v[j]=[];break;case"K":re=X[_].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(Xn(re))?isNaN(Zo(re).getDate())||(re=rr(re)):(re=Xn(re),k!==null&&xl(k)&&(re=Fd(re))),se=!0;break;case"E":V=!0;var N=Lo(X[_].slice(1),{r:p,c:g});v[p][g]=[v[p][g],N];break;case"S":te=!0,v[p][g]=[v[p][g],"S5S"];break;case"G":break;case"R":ce=parseInt(X[_].slice(1))-1;break;case"C":Ee=parseInt(X[_].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+b)}if(se&&(v[p][g]&&v[p][g].length==2?v[p][g][0]=re:v[p][g]=re,k=null),te){if(V)throw new Error("SYLK shared formula cannot have own formula");var z=ce>-1&&v[ce][Ee];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");v[p][g][1]=LR(z[1],{r:p-ce,c:g-Ee})}break;case"F":var B=0;for(_=1;_<X.length;++_)switch(X[_].charAt(0)){case"X":g=parseInt(X[_].slice(1))-1,++B;break;case"Y":for(p=parseInt(X[_].slice(1))-1,j=v.length;j<=p;++j)v[j]=[];break;case"M":M=parseInt(X[_].slice(1))/20;break;case"F":break;case"G":break;case"P":k=T[parseInt(X[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=X[_].slice(1).split(" "),j=parseInt(O[0],10);j<=parseInt(O[1],10);++j)M=parseInt(O[2],10),F[j-1]=M===0?{hidden:!0}:{wch:M},el(F[j-1]);break;case"C":g=parseInt(X[_].slice(1))-1,F[g]||(F[g]={});break;case"R":p=parseInt(X[_].slice(1))-1,E[p]||(E[p]={}),M>0?(E[p].hpt=M,E[p].hpx=gu(M)):M===0&&(E[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+b)}B<1&&(k=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+b)}}return E.length>0&&(A["!rows"]=E),F.length>0&&(A["!cols"]=F),d&&d.sheetRows&&(v=v.slice(0,d.sheetRows)),[v,A]}function a(h,d){var m=i(h,d),p=m[0],g=m[1],x=El(p,d);return yi(g).forEach(function(_){x[_]=g[_]}),x}function o(h,d){return Js(a(h,d),d)}function l(h,d,m,p){var g="C;Y"+(m+1)+";X"+(p+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+i$(h.f,{r:m,c:p}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(h,d){d.forEach(function(m,p){var g="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=T0(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=k0(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function u(h,d){d.forEach(function(m,p){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*NR(m.hpx)+";"),g.length>2&&h.push(g+"R"+(p+1))})}function f(h,d){var m=["ID;PWXL;N;E"],p=[],g=Pt(h["!ref"]),x,_=Array.isArray(h),v=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),h["!cols"]&&c(m,h["!cols"]),h["!rows"]&&u(m,h["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var T=g.s.r;T<=g.e.r;++T)for(var k=g.s.c;k<=g.e.c;++k){var A=Le({r:T,c:k});x=_?(h[T]||[])[k]:h[A],!(!x||x.v==null&&(!x.f||x.F))&&p.push(l(x,h,T,k))}return m.join(v)+v+p.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),x7=function(){function e(s,a){switch(a.type){case"base64":return t(xn(s),a);case"binary":return t(s,a);case"buffer":return t(Ke&&Buffer.isBuffer(s)?s.toString("binary"):Ka(s),a);case"array":return t(La(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var h=o[u].trim().split(","),d=h[0],m=h[1];++u;for(var p=o[u]||"";(p.match(/["]/g)||[]).length&1&&u<o.length-1;)p+=`
`+o[++u];switch(p=p.trim(),+d){case-1:if(p==="BOT"){f[++l]=[],c=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[l][c]=!0:p==="FALSE"?f[l][c]=!1:isNaN(Xn(m))?isNaN(Zo(m).getDate())?f[l][c]=m:f[l][c]=rr(m):f[l][c]=Xn(m),++c;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[l][c++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(s,a){return El(e(s,a),a)}function n(s,a){return Js(r(s,a),a)}var i=function(){var s=function(l,c,u,f,h){l.push(c),l.push(u+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},a=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=Pt(l["!ref"]),f,h=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){a(c,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var p=Le({r:d,c:m});if(f=h?(l[d]||[])[m]:l[p],!f){a(c,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?a(c,1,0,"="+f.f):a(c,1,0,""):a(c,0,g,"V");break;case"b":a(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=On(f.z||Me[14],qr(rr(f.v)))),a(c,0,f.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var x=`\r
`,_=c.join(x);return _}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),y7=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var d=f.split(`
`),m=-1,p=-1,g=0,x=[];g!==d.length;++g){var _=d[g].trim().split(":");if(_[0]==="cell"){var v=zr(_[1]);if(x.length<=v.r)for(m=x.length;m<=v.r;++m)x[m]||(x[m]=[]);switch(m=v.r,p=v.c,_[2]){case"t":x[m][p]=e(_[3]);break;case"v":x[m][p]=+_[3];break;case"vtf":var T=_[_.length-1];case"vtc":switch(_[3]){case"nl":x[m][p]=!!+_[4];break;default:x[m][p]=+_[4];break}_[2]=="vtf"&&(x[m][p]=[x[m][p],T])}}}return h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),x}function n(f,h){return El(r(f,h),h)}function i(f,h){return Js(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],d=[],m,p="",g=yl(f["!ref"]),x=Array.isArray(f),_=g.s.r;_<=g.e.r;++_)for(var v=g.s.c;v<=g.e.c;++v)if(p=Le({r:_,c:v}),m=x?(f[_]||[])[v]:f[p],!(!m||m.v==null||m.t==="z")){switch(d=["cell",p,"t"],m.t){case"s":case"str":d.push(t(m.v));break;case"n":m.f?(d[2]="vtf",d[3]="n",d[4]=m.v,d[5]=t(m.f)):(d[2]="v",d[3]=m.v);break;case"b":d[2]="vt"+(m.f?"f":"c"),d[3]="nl",d[4]=m.v?"1":"0",d[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var T=qr(rr(m.v));d[2]="vtc",d[3]="nd",d[4]=""+T,d[5]=m.w||On(m.z||Me[14],T);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[s,a,o,a,c(f),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),pu=function(){function e(u,f,h,d,m){m.raw?f[h][d]=u:u===""||(u==="TRUE"?f[h][d]=!0:u==="FALSE"?f[h][d]=!1:isNaN(Xn(u))?isNaN(Zo(u).getDate())?f[h][d]=u:f[h][d]=rr(u):f[h][d]=Xn(u))}function t(u,f){var h=f||{},d=[];if(!u||u.length===0)return d;for(var m=u.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var g=10,x=0,_=0;_<=p;++_)x=m[_].indexOf(" "),x==-1?x=m[_].length:x++,g=Math.max(g,x);for(_=0;_<=p;++_){d[_]=[];var v=0;for(e(m[_].slice(0,g).trim(),d,_,v,h),v=1;v<=(m[_].length-g)/10+1;++v)e(m[_].slice(g+(v-1)*10,g+v*10).trim(),d,_,v,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var f={},h=!1,d=0,m=0;d<u.length;++d)(m=u.charCodeAt(d))==34?h=!h:!h&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&m.push([f[d],d]);if(!m.length){f=n;for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&m.push([f[d],d])}return m.sort(function(p,g){return p[0]-g[0]||n[p[1]]-n[g[1]]}),r[m.pop()[1]]||44}function s(u,f){var h=f||{},d="",m=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=i(u.slice(0,1024)):h&&h.FS?d=h.FS:d=i(u.slice(0,1024));var g=0,x=0,_=0,v=0,T=0,k=d.charCodeAt(0),A=!1,E=0,F=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var O=h.dateNF!=null?NV(h.dateNF):null;function M(){var j=u.slice(v,T),b={};if(j.charAt(0)=='"'&&j.charAt(j.length-1)=='"'&&(j=j.slice(1,-1).replace(/""/g,'"')),j.length===0)b.t="z";else if(h.raw)b.t="s",b.v=j;else if(j.trim().length===0)b.t="s",b.v=j;else if(j.charCodeAt(0)==61)j.charCodeAt(1)==34&&j.charCodeAt(j.length-1)==34?(b.t="s",b.v=j.slice(2,-1).replace(/""/g,'"')):a$(j)?(b.t="n",b.f=j.slice(1)):(b.t="s",b.v=j);else if(j=="TRUE")b.t="b",b.v=!0;else if(j=="FALSE")b.t="b",b.v=!1;else if(!isNaN(_=Xn(j)))b.t="n",h.cellText!==!1&&(b.w=j),b.v=_;else if(!isNaN(Zo(j).getDate())||O&&j.match(O)){b.z=h.dateNF||Me[14];var X=0;O&&j.match(O)&&(j=DV(j,h.dateNF,j.match(O)||[]),X=1),h.cellDates?(b.t="d",b.v=rr(j,X)):(b.t="n",b.v=qr(rr(j,X))),h.cellText!==!1&&(b.w=On(b.z,b.v instanceof Date?qr(b.v):b.v)),h.cellNF||delete b.z}else b.t="s",b.v=j;if(b.t=="z"||(h.dense?(m[g]||(m[g]=[]),m[g][x]=b):m[Le({c:x,r:g})]=b),v=T+1,F=u.charCodeAt(v),p.e.c<x&&(p.e.c=x),p.e.r<g&&(p.e.r=g),E==k)++x;else if(x=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;T<u.length;++T)switch(E=u.charCodeAt(T)){case 34:F===34&&(A=!A);break;case k:case 10:case 13:if(!A&&M())break e;break}return T-v>0&&M(),m["!ref"]=Ye(p),m}function a(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,f):El(t(u,f),f)}function o(u,f){var h="",d=f.type=="string"?[0,0,0,0]:G_(u,f);switch(f.type){case"base64":h=xn(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof fs<"u"?h=fs.utils.decode(f.codepage,u):h=Ke&&Buffer.isBuffer(u)?u.toString("binary"):Ka(u);break;case"array":h=La(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=lt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=lt(h):f.type=="binary"&&typeof fs<"u"&&f.codepage&&(h=fs.utils.decode(f.codepage,fs.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?y7.to_sheet(f.type=="string"?h:lt(h),f):a(h,f)}function l(u,f){return Js(o(u,f),f)}function c(u){for(var f=[],h=Pt(u["!ref"]),d,m=Array.isArray(u),p=h.s.r;p<=h.e.r;++p){for(var g=[],x=h.s.c;x<=h.e.c;++x){var _=Le({r:p,c:x});if(d=m?(u[p]||[])[x]:u[_],!d||d.v==null){g.push("          ");continue}for(var v=(d.w||(Gi(d),d.w)||"").slice(0,10);v.length<10;)v+=" ";g.push(v+(x===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function E7(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=_7.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return pu.to_workbook(e,t)}}var wc=function(){function e(N,z,B){if(N){lr(N,N.l||0);for(var U=B.Enum||ce;N.l<N.length;){var Z=N.read_shift(2),de=U[Z]||U[65535],xe=N.read_shift(2),me=N.l+xe,ae=de.f&&de.f(N,xe,B);if(N.l=me,z(ae,de,Z))return}}}function t(N,z){switch(z.type){case"base64":return r(Hn(xn(N)),z);case"binary":return r(Hn(N),z);case"buffer":case"array":return r(N,z)}throw"Unsupported type "+z.type}function r(N,z){if(!N)return N;var B=z||{},U=B.dense?[]:{},Z="Sheet1",de="",xe=0,me={},ae=[],ze=[],L={s:{r:0,c:0},e:{r:0,c:0}},mt=B.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)B.Enum=ce,e(N,function(C,W,Q){switch(Q){case 0:B.vers=C,C>=4096&&(B.qpro=!0);break;case 6:L=C;break;case 204:C&&(de=C);break;case 222:de=C;break;case 15:case 51:B.qpro||(C[1].v=C[1].v.slice(1));case 13:case 14:case 16:Q==14&&(C[2]&112)==112&&(C[2]&15)>1&&(C[2]&15)<15&&(C[1].z=B.dateNF||Me[14],B.cellDates&&(C[1].t="d",C[1].v=Fd(C[1].v))),B.qpro&&C[3]>xe&&(U["!ref"]=Ye(L),me[Z]=U,ae.push(Z),U=B.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},xe=C[3],Z=de||"Sheet"+(xe+1),de="");var we=B.dense?(U[C[0].r]||[])[C[0].c]:U[Le(C[0])];if(we){we.t=C[1].t,we.v=C[1].v,C[1].z!=null&&(we.z=C[1].z),C[1].f!=null&&(we.f=C[1].f);break}B.dense?(U[C[0].r]||(U[C[0].r]=[]),U[C[0].r][C[0].c]=C[1]):U[Le(C[0])]=C[1];break}},B);else if(N[2]==26||N[2]==14)B.Enum=Ee,N[2]==14&&(B.qpro=!0,N.l=0),e(N,function(C,W,Q){switch(Q){case 204:Z=C;break;case 22:C[1].v=C[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(C[3]>xe&&(U["!ref"]=Ye(L),me[Z]=U,ae.push(Z),U=B.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},xe=C[3],Z="Sheet"+(xe+1)),mt>0&&C[0].r>=mt)break;B.dense?(U[C[0].r]||(U[C[0].r]=[]),U[C[0].r][C[0].c]=C[1]):U[Le(C[0])]=C[1],L.e.c<C[0].c&&(L.e.c=C[0].c),L.e.r<C[0].r&&(L.e.r=C[0].r);break;case 27:C[14e3]&&(ze[C[14e3][0]]=C[14e3][1]);break;case 1537:ze[C[0]]=C[1],C[0]==xe&&(Z=C[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(U["!ref"]=Ye(L),me[de||Z]=U,ae.push(de||Z),!ze.length)return{SheetNames:ae,Sheets:me};for(var Qe={},it=[],Be=0;Be<ze.length;++Be)me[ae[Be]]?(it.push(ze[Be]||ae[Be]),Qe[ze[Be]]=me[ze[Be]]||me[ae[Be]]):(it.push(ze[Be]),Qe[ze[Be]]={"!ref":"A1"});return{SheetNames:it,Sheets:Qe}}function n(N,z){var B=z||{};if(+B.codepage>=0&&zn(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var U=Mg(),Z=Pt(N["!ref"]),de=Array.isArray(N),xe=[];Un(U,0,s(1030)),Un(U,6,l(Z));for(var me=Math.min(Z.e.r,8191),ae=Z.s.r;ae<=me;++ae)for(var ze=mr(ae),L=Z.s.c;L<=Z.e.c;++L){ae===Z.s.r&&(xe[L]=Kt(L));var mt=xe[L]+ze,Qe=de?(N[ae]||[])[L]:N[mt];if(!(!Qe||Qe.t=="z"))if(Qe.t=="n")(Qe.v|0)==Qe.v&&Qe.v>=-32768&&Qe.v<=32767?Un(U,13,d(ae,L,Qe.v)):Un(U,14,p(ae,L,Qe.v));else{var it=Gi(Qe);Un(U,15,f(ae,L,it.slice(0,239)))}}return Un(U,1),U.end()}function i(N,z){var B=z||{};if(+B.codepage>=0&&zn(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var U=Mg();Un(U,0,a(N));for(var Z=0,de=0;Z<N.SheetNames.length;++Z)(N.Sheets[N.SheetNames[Z]]||{})["!ref"]&&Un(U,27,V(N.SheetNames[Z],de++));var xe=0;for(Z=0;Z<N.SheetNames.length;++Z){var me=N.Sheets[N.SheetNames[Z]];if(!(!me||!me["!ref"])){for(var ae=Pt(me["!ref"]),ze=Array.isArray(me),L=[],mt=Math.min(ae.e.r,8191),Qe=ae.s.r;Qe<=mt;++Qe)for(var it=mr(Qe),Be=ae.s.c;Be<=ae.e.c;++Be){Qe===ae.s.r&&(L[Be]=Kt(Be));var C=L[Be]+it,W=ze?(me[Qe]||[])[Be]:me[C];if(!(!W||W.t=="z"))if(W.t=="n")Un(U,23,M(Qe,Be,xe,W.v));else{var Q=Gi(W);Un(U,22,E(Qe,Be,xe,Q.slice(0,239)))}}++xe}}return Un(U,1),U.end()}function s(N){var z=zt(2);return z.write_shift(2,N),z}function a(N){var z=zt(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var B=0,U=0,Z=0,de=0;de<N.SheetNames.length;++de){var xe=N.SheetNames[de],me=N.Sheets[xe];if(!(!me||!me["!ref"])){++Z;var ae=yl(me["!ref"]);B<ae.e.r&&(B=ae.e.r),U<ae.e.c&&(U=ae.e.c)}}return B>8191&&(B=8191),z.write_shift(2,B),z.write_shift(1,Z),z.write_shift(1,U),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function o(N,z,B){var U={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&B.qpro?(U.s.c=N.read_shift(1),N.l++,U.s.r=N.read_shift(2),U.e.c=N.read_shift(1),N.l++,U.e.r=N.read_shift(2),U):(U.s.c=N.read_shift(2),U.s.r=N.read_shift(2),z==12&&B.qpro&&(N.l+=2),U.e.c=N.read_shift(2),U.e.r=N.read_shift(2),z==12&&B.qpro&&(N.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function l(N){var z=zt(8);return z.write_shift(2,N.s.c),z.write_shift(2,N.s.r),z.write_shift(2,N.e.c),z.write_shift(2,N.e.r),z}function c(N,z,B){var U=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(U[0].c=N.read_shift(1),U[3]=N.read_shift(1),U[0].r=N.read_shift(2),N.l+=2):(U[2]=N.read_shift(1),U[0].c=N.read_shift(2),U[0].r=N.read_shift(2)),U}function u(N,z,B){var U=N.l+z,Z=c(N,z,B);if(Z[1].t="s",B.vers==20768){N.l++;var de=N.read_shift(1);return Z[1].v=N.read_shift(de,"utf8"),Z}return B.qpro&&N.l++,Z[1].v=N.read_shift(U-N.l,"cstr"),Z}function f(N,z,B){var U=zt(7+B.length);U.write_shift(1,255),U.write_shift(2,z),U.write_shift(2,N),U.write_shift(1,39);for(var Z=0;Z<U.length;++Z){var de=B.charCodeAt(Z);U.write_shift(1,de>=128?95:de)}return U.write_shift(1,0),U}function h(N,z,B){var U=c(N,z,B);return U[1].v=N.read_shift(2,"i"),U}function d(N,z,B){var U=zt(7);return U.write_shift(1,255),U.write_shift(2,z),U.write_shift(2,N),U.write_shift(2,B,"i"),U}function m(N,z,B){var U=c(N,z,B);return U[1].v=N.read_shift(8,"f"),U}function p(N,z,B){var U=zt(13);return U.write_shift(1,255),U.write_shift(2,z),U.write_shift(2,N),U.write_shift(8,B,"f"),U}function g(N,z,B){var U=N.l+z,Z=c(N,z,B);if(Z[1].v=N.read_shift(8,"f"),B.qpro)N.l=U;else{var de=N.read_shift(2);T(N.slice(N.l,N.l+de),Z),N.l+=de}return Z}function x(N,z,B){var U=z&32768;return z&=-32769,z=(U?N:0)+(z>=8192?z-16384:z),(U?"":"$")+(B?Kt(z):mr(z))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(N,z){lr(N,0);for(var B=[],U=0,Z="",de="",xe="",me="";N.l<N.length;){var ae=N[N.l++];switch(ae){case 0:B.push(N.read_shift(8,"f"));break;case 1:de=x(z[0].c,N.read_shift(2),!0),Z=x(z[0].r,N.read_shift(2),!1),B.push(de+Z);break;case 2:{var ze=x(z[0].c,N.read_shift(2),!0),L=x(z[0].r,N.read_shift(2),!1);de=x(z[0].c,N.read_shift(2),!0),Z=x(z[0].r,N.read_shift(2),!1),B.push(ze+L+":"+de+Z)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(N.read_shift(2));break;case 6:{for(var mt="";ae=N[N.l++];)mt+=String.fromCharCode(ae);B.push('"'+mt.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:me=B.pop(),xe=B.pop(),B.push(["AND","OR"][ae-20]+"("+xe+","+me+")");break;default:if(ae<32&&v[ae])me=B.pop(),xe=B.pop(),B.push(xe+v[ae]+me);else if(_[ae]){if(U=_[ae][1],U==69&&(U=N[N.l++]),U>B.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+B.join("|")+"|");return}var Qe=B.slice(-U);B.length-=U,B.push(_[ae][0]+"("+Qe.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}B.length==1?z[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function k(N){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=N.read_shift(2),z[3]=N[N.l++],z[0].c=N[N.l++],z}function A(N,z){var B=k(N);return B[1].t="s",B[1].v=N.read_shift(z-4,"cstr"),B}function E(N,z,B,U){var Z=zt(6+U.length);Z.write_shift(2,N),Z.write_shift(1,B),Z.write_shift(1,z),Z.write_shift(1,39);for(var de=0;de<U.length;++de){var xe=U.charCodeAt(de);Z.write_shift(1,xe>=128?95:xe)}return Z.write_shift(1,0),Z}function F(N,z){var B=k(N);B[1].v=N.read_shift(2);var U=B[1].v>>1;if(B[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return B[1].v=U,B}function O(N,z){var B=k(N),U=N.read_shift(4),Z=N.read_shift(4),de=N.read_shift(2);if(de==65535)return U===0&&Z===3221225472?(B[1].t="e",B[1].v=15):U===0&&Z===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var xe=de&32768;return de=(de&32767)-16446,B[1].v=(1-xe*2)*(Z*Math.pow(2,de+32)+U*Math.pow(2,de)),B}function M(N,z,B,U){var Z=zt(14);if(Z.write_shift(2,N),Z.write_shift(1,B),Z.write_shift(1,z),U==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var de=0,xe=0,me=0,ae=0;return U<0&&(de=1,U=-U),xe=Math.log2(U)|0,U/=Math.pow(2,xe-31),ae=U>>>0,ae&2147483648||(U/=2,++xe,ae=U>>>0),U-=ae,ae|=2147483648,ae>>>=0,U*=Math.pow(2,32),me=U>>>0,Z.write_shift(4,me),Z.write_shift(4,ae),xe+=16383+(de?32768:0),Z.write_shift(2,xe),Z}function j(N,z){var B=O(N);return N.l+=z-14,B}function b(N,z){var B=k(N),U=N.read_shift(4);return B[1].v=U>>6,B}function X(N,z){var B=k(N),U=N.read_shift(8,"f");return B[1].v=U,B}function ne(N,z){var B=X(N);return N.l+=z-10,B}function re(N,z){return N[N.l+z-1]==0?N.read_shift(z,"cstr"):""}function se(N,z){var B=N[N.l++];B>z-1&&(B=z-1);for(var U="";U.length<B;)U+=String.fromCharCode(N[N.l++]);return U}function ue(N,z,B){if(!(!B.qpro||z<21)){var U=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var Z=N.read_shift(z-21,"cstr");return[U,Z]}}function te(N,z){for(var B={},U=N.l+z;N.l<U;){var Z=N.read_shift(2);if(Z==14e3){for(B[Z]=[0,""],B[Z][0]=N.read_shift(2);N[N.l];)B[Z][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return B}function V(N,z){var B=zt(5+N.length);B.write_shift(2,14e3),B.write_shift(2,z);for(var U=0;U<N.length;++U){var Z=N.charCodeAt(U);B[B.l++]=Z>127?95:Z}return B[B.l++]=0,B}var ce={0:{n:"BOF",f:Ut},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:se},65535:{n:""}},Ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:A},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:j},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:te},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:b},38:{n:"??"},39:{n:"NUMBER27",f:X},40:{n:"FORMULA28",f:ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function w7(e){var t={},r=e.match(br),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Pe(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=w_[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var T7=function(){var e=hu("t"),t=hu("rPr");function r(s){var a=s.match(e);if(!a)return{t:"s",v:""};var o={t:"s",v:Ze(a[1])},l=s.match(t);return l&&(o.s=w7(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),k7=function(){var t=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),A7=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,S7=/<(?:\w+:)?r>/,I7=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function U_(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ze(lt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=lt(e),r&&(n.h=R_(n.t))):e.match(S7)&&(n.r=lt(e),n.t=Ze(lt((e.replace(I7,"").match(A7)||[]).join("").replace(br,""))),r&&(n.h=k7(T7(n.r)))),n):{t:""}}var C7=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,R7=/<(?:\w+:)?(?:si|sstItem)>/g,P7=/<\/(?:\w+:)?(?:si|sstItem)>/;function F7(e,t){var r=[],n="";if(!e)return r;var i=e.match(C7);if(i){n=i[2].replace(R7,"").split(P7);for(var s=0;s!=n.length;++s){var a=U_(n[s].trim(),t);a!=null&&(r[r.length]=a)}i=Pe(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function N7(e){return[e.read_shift(4),e.read_shift(4)]}function D7(e,t){var r=[],n=!1;return Yi(e,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function SR(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Mi(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function O7(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Mi(e,4),t.U=Mi(e,4),t.W=Mi(e,4),t}function L7(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function b7(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(L7(e));return t}function M7(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function V7(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Mi(e,4),t.U=Mi(e,4),t.W=Mi(e,4),t}function U7(e){var t=V7(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function IR(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function CR(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function B7(e){var t=Mi(e);switch(t.Minor){case 2:return[t.Minor,j7(e)];case 3:return[t.Minor,$7()];case 4:return[t.Minor,H7(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function j7(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=IR(e,r),i=CR(e,e.length-e.l);return{t:"Std",h:n,v:i}}function $7(){throw new Error("File is password-protected: ECMA-376 Extensible")}function H7(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(br,function(s){var a=Pe(s);switch(wi(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function z7(e,t){var r={},n=r.EncryptionVersionInfo=Mi(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=IR(e,i),t-=i,r.EncryptionVerifier=CR(e,t),r}function W7(e){var t={},r=t.EncryptionVersionInfo=Mi(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function G7(e){var t=0,r,n=SR(e),i=n.length+1,s,a,o,l,c;for(r=Hs(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^a;return t^52811}var RR=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=t[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var u=a[c],f=0;f!=7;++f)u&64&&(o^=r[l]),u*=2,--l;return o};return function(a){for(var o=SR(a),l=s(o),c=o.length,u=Hs(16),f=0;f!=16;++f)u[f]=0;var h,d,m;for((c&1)===1&&(h=l>>8,u[c]=i(e[0],h),--c,h=l&255,d=o[o.length-1],u[c]=i(d,h));c>0;)--c,h=l>>8,u[c]=i(o[c],h),--c,h=l&255,u[c]=i(o[c],h);for(c=15,m=15-o.length;m>0;)h=l>>8,u[c]=i(e[m],h),--c,--m,h=l&255,u[c]=i(o[c],h),--c,--m;return u}}(),K7=function(e,t,r,n,i){i||(i=t),n||(n=RR(e));var s,a;for(s=0;s!=t.length;++s)a=t[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},q7=function(e){var t=0,r=RR(e);return function(n){var i=K7("",n,t,r);return t=i[1],i[0]}};function X7(e,t,r,n){var i={key:Ut(e),verificationBytes:Ut(e)};return r.password&&(i.verifier=G7(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=q7(r.password)),i}function Y7(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=W7(e):n.Data=z7(e,t),n}function Q7(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Y7(e,t-2,n):X7(e,r.biff>=8?t:t-2,r,n),n}var J7=function(){function e(i,s){switch(s.type){case"base64":return t(xn(i),s);case"binary":return t(i,s);case"buffer":return t(Ke&&Buffer.isBuffer(i)?i.toString("binary"):Ka(i),s);case"array":return t(La(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,d=0,m,p=-1;m=h.exec(u);){switch(m[0]){case"\\cell":var g=u.slice(d,h.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var x={v:g,t:"s"};Array.isArray(o)?o[f][p]=x:o[Le({r:f,c:p})]=x}break}d=h.lastIndex}p>c.e.c&&(c.e.c=p)}),o["!ref"]=Ye(c),o}function r(i,s){return Js(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Pt(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var f=Le({r:c,c:u});o=l?(i[c]||[])[u]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Gi(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Z7(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function mu(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function ej(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),a=i-s;if(a===0)return[0,0,t];var o=0,l=0,c=i+s;switch(l=a/(c>1?2-c:c),i){case t:o=((r-n)/a+6)%6;break;case r:o=(n-t)/a+2;break;case n:o=(t-r)/a+4;break}return[o/6,l,c/2]}function tj(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function w0(e,t){if(t===0)return e;var r=ej(Z7(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),mu(tj(r))}var PR=6,rj=15,nj=1,$r=PR;function T0(e){return Math.floor((e+Math.round(128/$r)/256)*$r)}function k0(e){return Math.floor((e-5)/$r*100+.5)/100}function jg(e){return Math.round((e*$r+5)/$r*256)/256}function Yp(e){return jg(k0(T0(e)))}function B_(e){var t=Math.abs(e-Yp(e)),r=$r;if(t>.005)for($r=nj;$r<rj;++$r)Math.abs(e-Yp(e))<=t&&(t=Math.abs(e-Yp(e)),r=$r);$r=r}function el(e){e.width?(e.wpx=T0(e.width),e.wch=k0(e.wpx),e.MDW=$r):e.wpx?(e.wch=k0(e.wpx),e.width=jg(e.wch),e.MDW=$r):typeof e.wch=="number"&&(e.width=jg(e.wch),e.wpx=T0(e.width),e.MDW=$r),e.customWidth&&delete e.customWidth}var ij=96,FR=ij;function NR(e){return e*96/FR}function gu(e){return e*FR/96}var sj={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function aj(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(br)||[]).forEach(function(a){var o=Pe(a);switch(wi(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=vt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=vt(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function oj(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(br)||[]).forEach(function(a){var o=Pe(a);switch(wi(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function lj(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(br)||[]).forEach(function(a){var o=Pe(a);switch(wi(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=lt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?vt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?vt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?vt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?vt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?vt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?vt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?vt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=w_[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=vt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=Ea[i.color.index];i.color.index==81&&(l=Ea[1]),l||(l=Ea[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=w0(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function cj(e,t,r){t.NumberFmt=[];for(var n=yi(Me),i=0;i<n.length;++i)t.NumberFmt[n[i]]=Me[n[i]];var s=e[0].match(br);if(s)for(i=0;i<s.length;++i){var a=Pe(s[i]);switch(wi(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ze(lt(a.formatCode)),l=parseInt(a.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}ya(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var Bf=["numFmtId","fillId","fontId","borderId","xfId"],jf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function uj(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(br)||[]).forEach(function(s){var a=Pe(s),o=0;switch(wi(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Bf.length;++o)n[Bf[o]]&&(n[Bf[o]]=parseInt(n[Bf[o]],10));for(o=0;o<jf.length;++o)n[jf[o]]&&(n[jf[o]]=vt(n[jf[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=vt(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var fj=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&cj(f,u,c),(f=o.match(i))&&lj(f,u,l,c),(f=o.match(n))&&oj(f,u,l,c),(f=o.match(s))&&aj(f,u,l,c),(f=o.match(r))&&uj(f,u,c),u}}();function hj(e,t){var r=e.read_shift(2),n=Fr(e);return[r,n]}function dj(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=TU(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=wU(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Fr(e),n}var pj=Lr;function mj(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var gj=Lr;function vj(e,t,r){var n={};n.NumberFmt=[];for(var i in Me)n.NumberFmt[i]=Me[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return Yi(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],ya(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=w0(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(u),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var _j=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function xj(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(br)||[]).forEach(function(i){var s=Pe(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[_j.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function yj(){}function Ej(){}var wj=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Tj=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,kj=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Aj(e,t,r){t.themeElements={};var n;[["clrScheme",wj,xj],["fontScheme",Tj,yj],["fmtScheme",kj,Ej]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var Sj=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function DR(e,t){(!e||e.length===0)&&(e=Ij());var r,n={};if(!(r=e.match(Sj)))throw new Error("themeElements not found in theme");return Aj(r[0],n,t),n.raw=e,n}function Ij(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[zC];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Cj(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var a;try{a=HC(s,{type:"array"})}catch{return}var o=fn(a,"theme/theme/theme1.xml",!0);if(o)return DR(o,r)}}function Rj(e){return e.read_shift(4)}function Pj(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Fj(e,4);break;case 2:t.xclrValue=xR(e);break;case 3:t.xclrValue=Rj(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Fj(e,t){return Lr(e,t)}function Nj(e,t){return Lr(e,t)}function Dj(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Pj(e);break;case 6:n[1]=Nj(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Oj(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(Dj(e,r-e.l));return{ixfe:n,ext:s}}function Lj(e,t){t.forEach(function(r){switch(r[0]){}})}function bj(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Fr(e)}}function Mj(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Vj(e){return e.l+=4,e.read_shift(4)!=0}function Uj(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return Yi(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(u),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function Bj(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,a;return e.replace(br,function(o){var l=Pe(o);switch(wi(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function jj(e){var t=[];if(!e)return t;var r=1;return(e.match(br)||[]).forEach(function(n){var i=Pe(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function $j(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Le(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Hj(e,t,r){var n=[];return Yi(e,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function zj(e,t,r,n){if(!e)return e;var i=n||{},s=!1;Yi(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function Wj(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function Lw(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(a){var o=zr(a.ref);if(i?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[a.ref],!s){s={t:"z"},i?e[o.r][o.c]=s:e[a.ref]=s;var l=Pt(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Ye(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var u={a:a.author,t:a.t,r:a.r,T:r};a.h&&(u.h=a.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}s.c.push(u)})}function Gj(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Pe(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=zr(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&U_(f[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function Kj(e,t){var r=[],n=!1,i={},s=0;return e.replace(br,function(o,l){var c=Pe(o);switch(wi(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function qj(e,t){var r=[],n=!1;return e.replace(br,function(s){var a=Pe(s);switch(wi(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function Xj(e){var t={};t.iauthor=e.read_shift(4);var r=Xa(e);return t.rfx=r.s,t.ref=Le(r.s),e.l+=16,t}var Yj=Fr;function Qj(e,t){var r=[],n=[],i={},s=!1;return Yi(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var Jj="application/vnd.ms-office.vbaProject";function Zj(e){var t=Xe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Xe.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Xe.write(t)}function e$(){return{"!type":"dialog"}}function t$(){return{"!type":"dialog"}}function r$(){return{"!type":"macro"}}function n$(){return{"!type":"macro"}}var Lo=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,i+(o?"":"$")+Kt(u)+(l?"":"$")+mr(c)}return function(i,s){return t=s,i.replace(e,r)}}(),OR=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,i$=function(){return function(t,r){return t.replace(OR,function(n,i,s,a,o,l){var c=D_(a)-(s?0:r.c),u=N_(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",h=c==0?"":s?c+1:"["+c+"]";return i+"R"+f+"C"+h})}}();function LR(e,t){return e.replace(OR,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Kt(D_(s)+t.c))+(a=="$"?a+o:mr(N_(o)+t.r))})}function s$(e,t,r){var n=yl(t),i=n.s,s=zr(r),a={r:s.r-i.r,c:s.c-i.c};return LR(e,a)}function a$(e){return e.length!=1}function bw(e){return e.replace(/_xlfn\./g,"")}function bt(e){e.l+=1}function zs(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function bR(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return MR(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),a=zs(e,2),o=zs(e,2);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function MR(e){var t=zs(e,2),r=zs(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function o$(e,t,r){if(r.biff<8)return MR(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=zs(e,2),a=zs(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function VR(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return l$(e);var n=e.read_shift(r&&r.biff==12?4:2),i=zs(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function l$(e){var t=zs(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function c$(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function u$(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return f$(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function f$(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function h$(e,t,r){var n=(e[e.l++]&96)>>5,i=bR(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function d$(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=bR(e,s,r);return[n,i,a]}function p$(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function m$(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function g$(e,t,r){var n=(e[e.l++]&96)>>5,i=o$(e,t-1,r);return[n,i]}function v$(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Mw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function _$(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function x$(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function y$(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function E$(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function w$(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function UR(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function T$(e){return e.read_shift(2),UR(e)}function k$(e){return e.read_shift(2),UR(e)}function A$(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=VR(e,0,r);return[n,i]}function S$(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=u$(e,0,r);return[n,i]}function I$(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=VR(e,0,r);return[n,i,s]}function C$(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[RH[i],$R[i],n]}function R$(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:P$(e);return[i,(s[0]===0?$R:CH)[s[1]]]}function P$(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function F$(e,t,r){e.l+=r&&r.biff==2?3:4}function N$(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function D$(e){return e.l++,Ya[e.read_shift(1)]}function O$(e){return e.l++,e.read_shift(2)}function L$(e){return e.l++,e.read_shift(1)!==0}function b$(e){return e.l++,Ir(e)}function M$(e,t,r){return e.l++,Qu(e,t-1,r)}function V$(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Nt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ya[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ir(e);break;case 2:r[1]=Qa(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function U$(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Xa:Nd)(e));return i}function B$(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=V$(e,r.biff);return a}function j$(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function $$(e,t,r){if(r.biff==5)return H$(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function H$(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function z$(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function W$(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function G$(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function K$(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var q$=Lr,X$=Lr,Y$=Lr;function Zu(e,t,r){return e.l+=2,[c$(e)]}function j_(e){return e.l+=6,[]}var Q$=Zu,J$=j_,Z$=j_,eH=Zu;function BR(e){return e.l+=2,[Ut(e),e.read_shift(2)&1]}var tH=Zu,rH=BR,nH=j_,iH=Zu,sH=Zu,aH=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function oH(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=aH[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:i,C:s}}function lH(e){return e.l+=2,[e.read_shift(4)]}function cH(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function uH(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function fH(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function hH(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function dH(e){return e.l+=4,[0,0]}var Vw={1:{n:"PtgExp",f:N$},2:{n:"PtgTbl",f:Y$},3:{n:"PtgAdd",f:bt},4:{n:"PtgSub",f:bt},5:{n:"PtgMul",f:bt},6:{n:"PtgDiv",f:bt},7:{n:"PtgPower",f:bt},8:{n:"PtgConcat",f:bt},9:{n:"PtgLt",f:bt},10:{n:"PtgLe",f:bt},11:{n:"PtgEq",f:bt},12:{n:"PtgGe",f:bt},13:{n:"PtgGt",f:bt},14:{n:"PtgNe",f:bt},15:{n:"PtgIsect",f:bt},16:{n:"PtgUnion",f:bt},17:{n:"PtgRange",f:bt},18:{n:"PtgUplus",f:bt},19:{n:"PtgUminus",f:bt},20:{n:"PtgPercent",f:bt},21:{n:"PtgParen",f:bt},22:{n:"PtgMissArg",f:bt},23:{n:"PtgStr",f:M$},26:{n:"PtgSheet",f:cH},27:{n:"PtgEndSheet",f:uH},28:{n:"PtgErr",f:D$},29:{n:"PtgBool",f:L$},30:{n:"PtgInt",f:O$},31:{n:"PtgNum",f:b$},32:{n:"PtgArray",f:v$},33:{n:"PtgFunc",f:C$},34:{n:"PtgFuncVar",f:R$},35:{n:"PtgName",f:j$},36:{n:"PtgRef",f:A$},37:{n:"PtgArea",f:h$},38:{n:"PtgMemArea",f:z$},39:{n:"PtgMemErr",f:q$},40:{n:"PtgMemNoMem",f:X$},41:{n:"PtgMemFunc",f:W$},42:{n:"PtgRefErr",f:G$},43:{n:"PtgAreaErr",f:p$},44:{n:"PtgRefN",f:S$},45:{n:"PtgAreaN",f:g$},46:{n:"PtgMemAreaN",f:fH},47:{n:"PtgMemNoMemN",f:hH},57:{n:"PtgNameX",f:$$},58:{n:"PtgRef3d",f:I$},59:{n:"PtgArea3d",f:d$},60:{n:"PtgRefErr3d",f:K$},61:{n:"PtgAreaErr3d",f:m$},255:{}},pH={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},mH={1:{n:"PtgElfLel",f:BR},2:{n:"PtgElfRw",f:iH},3:{n:"PtgElfCol",f:Q$},6:{n:"PtgElfRwV",f:sH},7:{n:"PtgElfColV",f:eH},10:{n:"PtgElfRadical",f:tH},11:{n:"PtgElfRadicalS",f:nH},13:{n:"PtgElfColS",f:J$},15:{n:"PtgElfColSV",f:Z$},16:{n:"PtgElfRadicalLel",f:rH},25:{n:"PtgList",f:oH},29:{n:"PtgSxName",f:lH},255:{}},gH={0:{n:"PtgAttrNoop",f:dH},1:{n:"PtgAttrSemi",f:w$},2:{n:"PtgAttrIf",f:y$},4:{n:"PtgAttrChoose",f:_$},8:{n:"PtgAttrGoto",f:x$},16:{n:"PtgAttrSum",f:F$},32:{n:"PtgAttrBaxcel",f:Mw},33:{n:"PtgAttrBaxcel",f:Mw},64:{n:"PtgAttrSpace",f:T$},65:{n:"PtgAttrSpaceSemi",f:k$},128:{n:"PtgAttrIfError",f:E$},255:{}};function ef(e,t,r,n){if(n.biff<8)return Lr(e,t);for(var i=e.l+t,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=B$(e,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=U$(e,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&s.push(Lr(e,t)),s}function tf(e,t,r){for(var n=e.l+t,i,s,a=[];n!=e.l;)t=n-e.l,s=e[e.l],i=Vw[s]||Vw[pH[s]],(s===24||s===25)&&(i=(s===24?mH:gH)[e[e.l+1]]),!i||!i.f?Lr(e,t):a.push([i.n,i.f(e,t,r)]);return a}function vH(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var _H={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function xH(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function jR(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Uw(e,t,r){var n=jR(e,t,r);return n=="#REF"?n:xH(n,r)}function kr(e,t,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,f=0,h=0,d,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",x=0,_=e[0].length;x<_;++x){var v=e[0][x];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=It(" ",e[0][p][1][1]);break;case 1:g=It("\r",e[0][p][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}c=c+g,p=-1}o.push(c+_H[v[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=_c(v[1][1],a,i),o.push(xc(u,s));break;case"PtgRefN":u=r?_c(v[1][1],r,i):v[1][1],o.push(xc(u,s));break;case"PtgRef3d":f=v[1][1],u=_c(v[1][2],a,i),m=Uw(n,f,i),o.push(m+"!"+xc(u,s));break;case"PtgFunc":case"PtgFuncVar":var T=v[1][0],k=v[1][1];T||(T=0),T&=127;var A=T==0?[]:o.slice(-T);o.length-=T,k==="User"&&(k=A.shift()),o.push(k+"("+A.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":d=xw(v[1][1],r?{s:r}:a,i),o.push(qp(d,i));break;case"PtgArea":d=xw(v[1][1],a,i),o.push(qp(d,i));break;case"PtgArea3d":f=v[1][1],d=v[1][2],m=Uw(n,f,i),o.push(m+"!"+qp(d,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var E=(n.names||[])[h-1]||(n[0]||[])[h],F=E?E.Name:"SH33TJSNAME"+String(h);F&&F.slice(0,6)=="_xlfn."&&!i.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var O=v[1][1];h=v[1][2];var M;if(i.biff<=5)O<0&&(O=-O),n[O]&&(M=n[O][h]);else{var j="";if(((n[O]||[])[0]||[])[0]==14849||(((n[O]||[])[0]||[])[0]==1025?n[O][h]&&n[O][h].itab>0&&(j=n.SheetNames[n[O][h].itab-1]+"!"):j=n.SheetNames[h-1]+"!"),n[O]&&n[O][h])j+=n[O][h].Name;else if(n[0]&&n[0][h])j+=n[0][h].Name;else{var b=(jR(n,O,i)||"").split(";;");b[h-1]?j=b[h-1]:j+="SH33TJSERRX"}o.push(j);break}M||(M={Name:"SH33TJSERRY"}),o.push(M.Name);break;case"PtgParen":var X="(",ne=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:X=It(" ",e[0][p][1][1])+X;break;case 3:X=It("\r",e[0][p][1][1])+X;break;case 4:ne=It(" ",e[0][p][1][1])+ne;break;case 5:ne=It("\r",e[0][p][1][1])+ne;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(X+o.pop()+ne);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:v[1][1],r:v[1][0]};var re={c:r.c,r:r.r};if(n.sharedf[Le(u)]){var se=n.sharedf[Le(u)];o.push(kr(se,a,re,n,i))}else{var ue=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(kr(c[1],a,re,n,i)),ue=!0;break}ue||o.push(v[1])}break;case"PtgArray":o.push("{"+vH(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var te=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&te.indexOf(e[0][x][0])==-1){v=e[0][p];var V=!0;switch(v[1][0]){case 4:V=!1;case 0:g=It(" ",v[1][1]);break;case 5:V=!1;case 1:g=It("\r",v[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((V?g:"")+o.pop()+(V?"":g)),p=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function yH(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,a=e.read_shift(i);if(a==65535)return[[],Lr(e,t-2)];var o=tf(e,a,r);return t!==a+i&&(s=ef(e,t-a-i,o,r)),e.l=n,[o,s]}function EH(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,a=e.read_shift(i);if(a==65535)return[[],Lr(e,t-2)];var o=tf(e,a,r);return t!==a+i&&(s=ef(e,t-a-i,o,r)),e.l=n,[o,s]}function wH(e,t,r,n){var i=e.l+t,s=tf(e,n,r),a;return i!==e.l&&(a=ef(e,i-e.l,s,r)),[s,a]}function TH(e,t,r){var n=e.l+t,i,s=e.read_shift(2),a=tf(e,s,r);return s==65535?[[],Lr(e,t-2)]:(t!==s+2&&(i=ef(e,n-s-2,a,r)),[a,i])}function kH(e){var t;if(Di(e,e.l+6)!==65535)return[Ir(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Qp(e,t,r){var n=e.l+t,i=Ti(e);r.biff==2&&++e.l;var s=kH(e),a=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=EH(e,n-e.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function Dd(e,t,r){var n=e.read_shift(4),i=tf(e,n,r),s=e.read_shift(4),a=s>0?ef(e,s,i,r):null;return[i,a]}var AH=Dd,Od=Dd,SH=Dd,IH=Dd,CH={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},$R={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},RH={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Bw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Jp(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Tc={},bo={};function kc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function HR(e,t,r,n,i,s){try{n.cellNF&&(e.z=Me[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=rr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Me[t]==null&&ya(FV[t]||"General",t),e.t==="e")e.w=e.w||Ya[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=fu(e.v);else if(e.t==="d"){var a=qr(e.v);(a|0)===a?e.w=a.toString(10):e.w=fu(a)}else{if(e.v===void 0)return"";e.w=Oa(e.v,bo)}else e.t==="d"?e.w=On(t,qr(e.v),bo):e.w=On(t,e.v,bo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=w0(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=w0(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function PH(e,t){var r=Pt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ye(r))}var FH=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,NH=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,DH=/<(?:\w:)?hyperlink [^>]*>/mg,OH=/"(\w*:\w*)"/,LH=/<(?:\w:)?col\b[^>]*[\/]?>/g,bH=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,MH=/<(?:\w:)?pageMargins[^>]*\/>/g,zR=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,VH=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,UH=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function BH(e,t,r,n,i,s,a){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=e.match(NH);f?(c=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):c=u=e;var h=c.match(zR);h?$_(h[0],o,i,r):(h=c.match(VH))&&jH(h[0],h[1]||"",o,i,r);var d=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var m=c.slice(d,d+50).match(OH);m&&PH(o,m[1])}var p=c.match(UH);p&&p[1]&&KH(p[1],i);var g=[];if(t.cellStyles){var x=c.match(LH);x&&zH(g,x)}f&&qH(f[1],o,t,l,s,a);var _=u.match(bH);_&&(o["!autofilter"]=WH(_[0]));var v=[],T=u.match(FH);if(T)for(d=0;d!=T.length;++d)v[d]=Pt(T[d].slice(T[d].indexOf('"')+1));var k=u.match(DH);k&&$H(o,k,n);var A=u.match(MH);if(A&&(o["!margins"]=HH(Pe(A[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Ye(l)),t.sheetRows>0&&o["!ref"]){var E=Pt(o["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ye(E))}return g.length>0&&(o["!cols"]=g),v.length>0&&(o["!merges"]=v),o}function $_(e,t,r,n){var i=Pe(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Ze(lt(i.codeName)))}function jH(e,t,r,n,i){$_(e.slice(0,e.indexOf(">")),r,n,i)}function $H(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Pe(lt(t[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Ze(s.location))):(s.Target="#"+Ze(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Pt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Le({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function HH(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function zH(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Pe(t[n],!0);i.hidden&&(i.hidden=vt(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,B_(i.width)),el(i);s<=a;)e[s++]=pr(i)}}function WH(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var GH=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function KH(e,t){t.Views||(t.Views=[{}]),(e.match(GH)||[]).forEach(function(r,n){var i=Pe(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),vt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var qH=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=hu("v"),a=hu("f");return function(l,c,u,f,h,d){for(var m=0,p="",g=[],x=[],_=0,v=0,T=0,k="",A,E,F=0,O=0,M,j,b=0,X=0,ne=Array.isArray(d.CellXf),re,se=[],ue=[],te=Array.isArray(c),V=[],ce={},Ee=!1,N=!!u.sheetStubs,z=l.split(t),B=0,U=z.length;B!=U;++B){p=z[B].trim();var Z=p.length;if(Z!==0){var de=0;e:for(m=0;m<Z;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(E=Pe(p.slice(de,m),!0),F=E.r!=null?parseInt(E.r,10):F+1,O=-1,u.sheetRows&&u.sheetRows<F)continue;ce={},Ee=!1,E.ht&&(Ee=!0,ce.hpt=parseFloat(E.ht),ce.hpx=gu(ce.hpt)),E.hidden=="1"&&(Ee=!0,ce.hidden=!0),E.outlineLevel!=null&&(Ee=!0,ce.level=+E.outlineLevel),Ee&&(V[F-1]=ce)}break;case"<":de=m;break}if(de>=m)break;if(E=Pe(p.slice(de,m),!0),F=E.r!=null?parseInt(E.r,10):F+1,O=-1,!(u.sheetRows&&u.sheetRows<F)){f.s.r>F-1&&(f.s.r=F-1),f.e.r<F-1&&(f.e.r=F-1),u&&u.cellStyles&&(ce={},Ee=!1,E.ht&&(Ee=!0,ce.hpt=parseFloat(E.ht),ce.hpx=gu(ce.hpt)),E.hidden=="1"&&(Ee=!0,ce.hidden=!0),E.outlineLevel!=null&&(Ee=!0,ce.level=+E.outlineLevel),Ee&&(V[F-1]=ce)),g=p.slice(m).split(e);for(var xe=0;xe!=g.length&&g[xe].trim().charAt(0)=="<";++xe);for(g=g.slice(xe),m=0;m!=g.length;++m)if(p=g[m].trim(),p.length!==0){if(x=p.match(r),_=m,v=0,T=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,x!=null&&x.length===2){for(_=0,k=x[1],v=0;v!=k.length&&!((T=k.charCodeAt(v)-64)<1||T>26);++v)_=26*_+T;--_,O=_}else++O;for(v=0;v!=p.length&&p.charCodeAt(v)!==62;++v);if(++v,E=Pe(p.slice(0,v),!0),E.r||(E.r=Le({r:F-1,c:O})),k=p.slice(v),A={t:""},(x=k.match(s))!=null&&x[1]!==""&&(A.v=Ze(x[1])),u.cellFormula){if((x=k.match(a))!=null&&x[1]!==""){if(A.f=Ze(lt(x[1])).replace(/\r\n/g,`
`),u.xlfn||(A.f=bw(A.f)),x[0].indexOf('t="array"')>-1)A.F=(k.match(i)||[])[1],A.F.indexOf(":")>-1&&se.push([Pt(A.F),A.F]);else if(x[0].indexOf('t="shared"')>-1){j=Pe(x[0]);var me=Ze(lt(x[1]));u.xlfn||(me=bw(me)),ue[parseInt(j.si,10)]=[j,me,E.r]}}else(x=k.match(/<f[^>]*\/>/))&&(j=Pe(x[0]),ue[j.si]&&(A.f=s$(ue[j.si][1],ue[j.si][2],E.r)));var ae=zr(E.r);for(v=0;v<se.length;++v)ae.r>=se[v][0].s.r&&ae.r<=se[v][0].e.r&&ae.c>=se[v][0].s.c&&ae.c<=se[v][0].e.c&&(A.F=se[v][1])}if(E.t==null&&A.v===void 0)if(A.f||A.F)A.v=0,A.t="n";else if(N)A.t="z";else continue;else A.t=E.t||"n";switch(f.s.c>O&&(f.s.c=O),f.e.c<O&&(f.e.c=O),A.t){case"n":if(A.v==""||A.v==null){if(!N)continue;A.t="z"}else A.v=parseFloat(A.v);break;case"s":if(typeof A.v>"u"){if(!N)continue;A.t="z"}else M=Tc[parseInt(A.v,10)],A.v=M.t,A.r=M.r,u.cellHTML&&(A.h=M.h);break;case"str":A.t="s",A.v=A.v!=null?lt(A.v):"",u.cellHTML&&(A.h=R_(A.v));break;case"inlineStr":x=k.match(n),A.t="s",x!=null&&(M=U_(x[1]))?(A.v=M.t,u.cellHTML&&(A.h=M.h)):A.v="";break;case"b":A.v=vt(A.v);break;case"d":u.cellDates?A.v=rr(A.v,1):(A.v=qr(rr(A.v,1)),A.t="n");break;case"e":(!u||u.cellText!==!1)&&(A.w=A.v),A.v=fR[A.v];break}if(b=X=0,re=null,ne&&E.s!==void 0&&(re=d.CellXf[E.s],re!=null&&(re.numFmtId!=null&&(b=re.numFmtId),u.cellStyles&&re.fillId!=null&&(X=re.fillId))),HR(A,b,X,u,h,d),u.cellDates&&ne&&A.t=="n"&&xl(Me[b])&&(A.t="d",A.v=Fd(A.v)),E.cm&&u.xlmeta){var ze=(u.xlmeta.Cell||[])[+E.cm-1];ze&&ze.type=="XLDAPR"&&(A.D=!0)}if(te){var L=zr(E.r);c[L.r]||(c[L.r]=[]),c[L.r][L.c]=A}else c[E.r]=A}}}}V.length>0&&(c["!rows"]=V)}}();function XH(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}var YH=Xa;function QH(){}function JH(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=yU(e),r}function ZH(e){var t=bn(e);return[t]}function ez(e){var t=qa(e);return[t]}function tz(e){var t=bn(e),r=e.read_shift(1);return[t,r,"b"]}function rz(e){var t=qa(e),r=e.read_shift(1);return[t,r,"b"]}function nz(e){var t=bn(e),r=e.read_shift(1);return[t,r,"e"]}function iz(e){var t=qa(e),r=e.read_shift(1);return[t,r,"e"]}function sz(e){var t=bn(e),r=e.read_shift(4);return[t,r,"s"]}function az(e){var t=qa(e),r=e.read_shift(4);return[t,r,"s"]}function oz(e){var t=bn(e),r=Ir(e);return[t,r,"n"]}function WR(e){var t=qa(e),r=Ir(e);return[t,r,"n"]}function lz(e){var t=bn(e),r=b_(e);return[t,r,"n"]}function cz(e){var t=qa(e),r=b_(e);return[t,r,"n"]}function uz(e){var t=bn(e),r=O_(e);return[t,r,"is"]}function fz(e){var t=bn(e),r=Fr(e);return[t,r,"str"]}function hz(e){var t=qa(e),r=Fr(e);return[t,r,"str"]}function dz(e,t,r){var n=e.l+t,i=bn(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=Od(e,n-e.l,r);a[3]=kr(o,null,i,r.supbooks,r)}else e.l=n;return a}function pz(e,t,r){var n=e.l+t,i=bn(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=Od(e,n-e.l,r);a[3]=kr(o,null,i,r.supbooks,r)}else e.l=n;return a}function mz(e,t,r){var n=e.l+t,i=bn(e);i.r=r["!row"];var s=Ir(e),a=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=Od(e,n-e.l,r);a[3]=kr(o,null,i,r.supbooks,r)}else e.l=n;return a}function gz(e,t,r){var n=e.l+t,i=bn(e);i.r=r["!row"];var s=Fr(e),a=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=Od(e,n-e.l,r);a[3]=kr(o,null,i,r.supbooks,r)}else e.l=n;return a}var vz=Xa;function _z(e,t){var r=e.l+t,n=Xa(e),i=L_(e),s=Fr(e),a=Fr(e),o=Fr(e);e.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function xz(){}function yz(e,t,r){var n=e.l+t,i=lR(e),s=e.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=AH(e,n-e.l,r);a[1]=o}else e.l=n;return a}function Ez(e,t,r){var n=e.l+t,i=Xa(e),s=[i];if(r.cellFormula){var a=IH(e,n-e.l,r);s[1]=a,e.l=n}else e.l=n;return s}var wz=["left","right","top","bottom","header","footer"];function Tz(e){var t={};return wz.forEach(function(r){t[r]=Ir(e)}),t}function kz(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Az(){}function Sz(){}function Iz(e,t,r,n,i,s,a){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,d,m,p,g,x,_,v,T,k,A=[];o.biff=12,o["!row"]=0;var E=0,F=!1,O=[],M={},j=o.supbooks||i.supbooks||[[]];if(j.sharedf=M,j.arrayf=O,j.SheetNames=i.SheetNames||i.Sheets.map(function(te){return te.name}),!o.supbooks&&(o.supbooks=j,i.Names))for(var b=0;b<i.Names.length;++b)j[0][b+1]=i.Names[b];var X=[],ne=[],re=!1;A0[16]={n:"BrtShortReal",f:WR};var se;if(Yi(e,function(V,ce,Ee){if(!h)switch(Ee){case 148:c=V;break;case 0:d=V,o.sheetRows&&o.sheetRows<=d.r&&(h=!0),T=mr(g=d.r),o["!row"]=d.r,(V.hidden||V.hpt||V.level!=null)&&(V.hpt&&(V.hpx=gu(V.hpt)),ne[V.r]=V);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:V[2]},V[2]){case"n":m.v=V[1];break;case"s":v=Tc[V[1]],m.v=v.t,m.r=v.r;break;case"b":m.v=!!V[1];break;case"e":m.v=V[1],o.cellText!==!1&&(m.w=Ya[m.v]);break;case"str":m.t="s",m.v=V[1];break;case"is":m.t="s",m.v=V[1].t;break}if((p=a.CellXf[V[0].iStyleRef])&&HR(m,p.numFmtId,null,o,s,a),x=V[0].c==-1?x+1:V[0].c,o.dense?(l[g]||(l[g]=[]),l[g][x]=m):l[Kt(x)+T]=m,o.cellFormula){for(F=!1,E=0;E<O.length;++E){var N=O[E];d.r>=N[0].s.r&&d.r<=N[0].e.r&&x>=N[0].s.c&&x<=N[0].e.c&&(m.F=Ye(N[0]),F=!0)}!F&&V.length>3&&(m.f=V[3])}if(u.s.r>d.r&&(u.s.r=d.r),u.s.c>x&&(u.s.c=x),u.e.r<d.r&&(u.e.r=d.r),u.e.c<x&&(u.e.c=x),o.cellDates&&p&&m.t=="n"&&xl(Me[p.numFmtId])){var z=pa(m.v);z&&(m.t="d",m.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}se&&(se.type=="XLDAPR"&&(m.D=!0),se=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;m={t:"z",v:void 0},x=V[0].c==-1?x+1:V[0].c,o.dense?(l[g]||(l[g]=[]),l[g][x]=m):l[Kt(x)+T]=m,u.s.r>d.r&&(u.s.r=d.r),u.s.c>x&&(u.s.c=x),u.e.r<d.r&&(u.e.r=d.r),u.e.c<x&&(u.e.c=x),se&&(se.type=="XLDAPR"&&(m.D=!0),se=void 0);break;case 176:A.push(V);break;case 49:se=((o.xlmeta||{}).Cell||[])[V-1];break;case 494:var B=n["!id"][V.relId];for(B?(V.Target=B.Target,V.loc&&(V.Target+="#"+V.loc),V.Rel=B):V.relId==""&&(V.Target="#"+V.loc),g=V.rfx.s.r;g<=V.rfx.e.r;++g)for(x=V.rfx.s.c;x<=V.rfx.e.c;++x)o.dense?(l[g]||(l[g]=[]),l[g][x]||(l[g][x]={t:"z",v:void 0}),l[g][x].l=V):(_=Le({c:x,r:g}),l[_]||(l[_]={t:"z",v:void 0}),l[_].l=V);break;case 426:if(!o.cellFormula)break;O.push(V),k=o.dense?l[g][x]:l[Kt(x)+T],k.f=kr(V[1],u,{r:d.r,c:x},j,o),k.F=Ye(V[0]);break;case 427:if(!o.cellFormula)break;M[Le(V[0].s)]=V[1],k=o.dense?l[g][x]:l[Kt(x)+T],k.f=kr(V[1],u,{r:d.r,c:x},j,o);break;case 60:if(!o.cellStyles)break;for(;V.e>=V.s;)X[V.e--]={width:V.w/256,hidden:!!(V.flags&1),level:V.level},re||(re=!0,B_(V.w/256)),el(X[V.e+1]);break;case 161:l["!autofilter"]={ref:Ye(V)};break;case 476:l["!margins"]=V;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),V.name&&(i.Sheets[r].CodeName=V.name),(V.above||V.left)&&(l["!outline"]={above:V.above,left:V.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),V.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ce.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+Ee.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Ye(c||u)),o.sheetRows&&l["!ref"]){var ue=Pt(l["!ref"]);o.sheetRows<=+ue.e.r&&(ue.e.r=o.sheetRows-1,ue.e.r>u.e.r&&(ue.e.r=u.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>u.e.c&&(ue.e.c=u.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ye(ue))}return A.length>0&&(l["!merges"]=A),X.length>0&&(l["!cols"]=X),ne.length>0&&(l["!rows"]=ne),l}function Cz(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(t[+a[1]]=r?+a[2]:a[2])});var i=Ze((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function Rz(e,t,r,n,i,s){var a=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=Cz(f);u.s.r=u.s.c=0,u.e.c=o,c=Kt(o),h[0].forEach(function(d,m){a[c+mr(m)]={t:"n",v:d,z:h[1]},l=m}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(a["!ref"]=Ye(u)),a}function Pz(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=e.match(zR);return o&&$_(o[0],s,i,r),(a=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Fz(e,t){e.l+=10;var r=Fr(e);return{name:r}}function Nz(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Yi(e,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var GR=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Dz=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Oz=[],Lz=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function jw(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=vt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function $w(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=vt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function KR(e){$w(e.WBProps,GR),$w(e.CalcPr,Lz),jw(e.WBView,Dz),jw(e.Sheets,Oz),bo.date1904=vt(e.WBProps.date1904)}var bz="][*?/\\".split("");function Mz(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return bz.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var Vz=/<\w+:workbook/;function Uz(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(e.replace(br,function(l,c){var u=Pe(l);switch(wi(u[0])){case"<?xml":break;case"<workbook":l.match(Vz)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":GR.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=vt(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=lt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Ze(lt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=lt(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),vt(u.hidden||"0")&&(s.Hidden=!0),a=c+l.length;break;case"</definedName>":s.Ref=Ze(lt(e.slice(a,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),nU.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return KR(r),r}function Bz(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Vg(e),r.name=Fr(e),r}function jz(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Fr(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function $z(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Hz(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=EU(e),a=SH(e,0,r),o=L_(e);e.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function zz(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],A0[16]={n:"BrtFRTArchID$",f:$z},Yi(e,function(l,c,u){switch(u){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=kr(l.Ptg,null,null,a,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,l]):a[0]=[u,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),KR(r),r.Names=s,r.supbooks=a,r}function Wz(e,t,r){return t.slice(-4)===".bin"?zz(e,r):Uz(e,r)}function Gz(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?Iz(e,n,r,i,s,a,o):BH(e,n,r,i,s,a,o)}function Kz(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?Nz(e,n,r,i,s):Pz(e,n,r,i,s)}function qz(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?r$():n$()}function Xz(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?e$():t$()}function Yz(e,t,r,n){return t.slice(-4)===".bin"?vj(e,r,n):fj(e,r,n)}function Qz(e,t,r){return DR(e,r)}function Jz(e,t,r){return t.slice(-4)===".bin"?D7(e,r):F7(e,r)}function Zz(e,t,r){return t.slice(-4)===".bin"?Qj(e,r):Gj(e,r)}function eW(e,t,r){return t.slice(-4)===".bin"?Hj(e):jj(e)}function tW(e,t,r,n){return r.slice(-4)===".bin"?zj(e,t,r,n):void 0}function rW(e,t,r){return t.slice(-4)===".bin"?Uj(e,t,r):Bj(e,t,r)}var qR=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,XR=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Vn(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var i=e.match(qR),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(XR),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function nW(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(qR),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(XR),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var Ac;function iW(e,t){var r=Ac[e]||Ze(e);return r==="General"?Oa(t):On(r,t)}function sW(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=vt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=rr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ze(t)]=i}function aW(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ya[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=fu(e.v):e.w=Oa(e.v):e.w=iW(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Ac[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&xl(n)){var i=pa(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function oW(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=sj[n.Pattern]||n.Pattern)}e[t.ID]=t}function lW(e,t,r,n,i,s,a,o,l,c){var u="General",f=n.StyleID,h={};c=c||{};var d=[],m=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&a&&(f=a.StyleID);s[f]!==void 0&&(s[f].nf&&(u=s[f].nf),s[f].Interior&&d.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=vt(e);break;case"String":n.t="s",n.r=uw(Ze(e)),n.v=e.indexOf("<")>-1?Ze(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(rr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ze(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=fR[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=uw(t||e));break}if(aW(n,u,c),c.cellFormula!==!1)if(n.Formula){var p=Ze(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=Lo(p,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Lo("RC:RC",i):n.ArrayRange&&(n.F=Lo(n.ArrayRange,i),l.push([Pt(n.F),n.F]))}else for(m=0;m<l.length;++m)i.r>=l[m][0].s.r&&i.r<=l[m][0].e.r&&i.c>=l[m][0].s.c&&i.c<=l[m][0].e.c&&(n.F=l[m][1]);c.cellStyles&&(d.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function cW(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Zp(e,t){var r=t||{};bC();var n=Yl(P_(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=lt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=pr(r);return a.type="string",pu.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(W){i.indexOf("<"+W)>=0&&(s=!0)}),s)return _W(n,r);Ac={"General Number":"General","General Date":Me[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Me[15],"Short Date":Me[14],"Long Time":Me[19],"Medium Time":Me[18],"Short Time":Me[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Me[2],Standard:Me[4],Percent:Me[10],Scientific:Me[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},f=[],h=r.dense?[]:{},d="",m={},p={},g=Vn('<Data ss:Type="String">'),x=0,_=0,v=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},k={},A={},E="",F=0,O=[],M={},j={},b=0,X=[],ne=[],re={},se=[],ue,te=!1,V=[],ce=[],Ee={},N=0,z=0,B={Sheets:[],WBProps:{date1904:!1}},U={};du.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Z="";o=du.exec(n);)switch(o[3]=(Z=o[3]).toLowerCase()){case"data":if(Z=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?lW(n.slice(x,o.index),E,g,l[l.length-1][0]=="comment"?re:m,{c:_,r:v},k,se[_],p,V,r):(E="",g=Vn(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ne.length>0&&(m.c=ne),(!r.sheetRows||r.sheetRows>v)&&m.v!==void 0&&(r.dense?(h[v]||(h[v]=[]),h[v][_]=m):h[Kt(_)+mr(v)]=m),m.HRef&&(m.l={Target:Ze(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(N=_+(parseInt(m.MergeAcross,10)|0),z=v+(parseInt(m.MergeDown,10)|0),O.push({s:{c:_,r:v},e:{c:N,r:z}})),!r.sheetStubs)m.MergeAcross?_=N+1:++_;else if(m.MergeAcross||m.MergeDown){for(var de=_;de<=N;++de)for(var xe=v;xe<=z;++xe)(de>_||xe>v)&&(r.dense?(h[xe]||(h[xe]=[]),h[xe][de]={t:"z"}):h[Kt(de)+mr(xe)]={t:"z"});_=N+1}else++_;else m=nW(o[0]),m.Index&&(_=+m.Index-1),_<T.s.c&&(T.s.c=_),_>T.e.c&&(T.e.c=_),o[0].slice(-2)==="/>"&&++_,ne=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<T.s.r&&(T.s.r=v),v>T.e.r&&(T.e.r=v),o[0].slice(-2)==="/>"&&(p=Vn(o[0]),p.Index&&(v=+p.Index-1)),_=0,++v):(p=Vn(o[0]),p.Index&&(v=+p.Index-1),Ee={},(p.AutoFitHeight=="0"||p.Height)&&(Ee.hpx=parseInt(p.Height,10),Ee.hpt=NR(Ee.hpx),ce[v]=Ee),p.Hidden=="1"&&(Ee.hidden=!0,ce[v]=Ee));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(d),T.s.r<=T.e.r&&T.s.c<=T.e.c&&(h["!ref"]=Ye(T),r.sheetRows&&r.sheetRows<=T.e.r&&(h["!fullref"]=h["!ref"],T.e.r=r.sheetRows-1,h["!ref"]=Ye(T))),O.length&&(h["!merges"]=O),se.length>0&&(h["!cols"]=se),ce.length>0&&(h["!rows"]=ce),u[d]=h}else T={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=_=0,l.push([o[3],!1]),c=Vn(o[0]),d=Ze(c.Name),h=r.dense?[]:{},O=[],V=[],ce=[],U={name:d,Hidden:0},B.Sheets.push(U);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),se=[],te=!1}break;case"style":o[1]==="/"?oW(k,A,r):A=Vn(o[0]);break;case"numberformat":A.nf=Ze(Vn(o[0]).Format||"General"),Ac[A.nf]&&(A.nf=Ac[A.nf]);for(var me=0;me!=392&&Me[me]!=A.nf;++me);if(me==392){for(me=57;me!=392;++me)if(Me[me]==null){ya(A.nf,me);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ue=Vn(o[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!te&&ue.wpx>10){te=!0,$r=PR;for(var ae=0;ae<se.length;++ae)se[ae]&&el(se[ae])}te&&el(ue),se[ue.Index-1||se.length]=ue;for(var ze=0;ze<+ue.Span;++ze)se[se.length]=pr(ue);break;case"namedrange":if(o[1]==="/")break;B.Names||(B.Names=[]);var L=Pe(o[0]),mt={Name:L.Name,Ref:Lo(L.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(mt.Sheet=B.Sheets.length-1),B.Names.push(mt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?E+=n.slice(F,o.index):F=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;A.Interior=Vn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?GU(M,Z,n.slice(b,o.index)):b=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));cW(re),ne.push(re)}else l.push([o[3],!1]),c=Vn(o[0]),re={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Qe=Vn(o[0]);h["!autofilter"]={ref:Lo(Qe.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return qw(n,r);var it=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:it=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:it=!1}break;case"excelworkbook":switch(o[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:it=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:it=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(b,o.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2;break}else b=o.index+o[0].length;break;case"header":h["!margins"]||kc(h["!margins"]={},"xlml"),isNaN(+Pe(o[0]).Margin)||(h["!margins"].header=+Pe(o[0]).Margin);break;case"footer":h["!margins"]||kc(h["!margins"]={},"xlml"),isNaN(+Pe(o[0]).Margin)||(h["!margins"].footer=+Pe(o[0]).Margin);break;case"pagemargins":var Be=Pe(o[0]);h["!margins"]||kc(h["!margins"]={},"xlml"),isNaN(+Be.Top)||(h["!margins"].top=+Be.Top),isNaN(+Be.Left)||(h["!margins"].left=+Be.Left),isNaN(+Be.Right)||(h["!margins"].right=+Be.Right),isNaN(+Be.Bottom)||(h["!margins"].bottom=+Be.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:it=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:it=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:it=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:it=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:it=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:it=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:it=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:it=!1}break;case"smarttags":break;default:it=!1;break}if(it||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?sW(j,Z,X,n.slice(b,o.index)):(X=o,b=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var C={};return!r.bookSheets&&!r.bookProps&&(C.Sheets=u),C.SheetNames=f,C.Workbook=B,C.SSF=pr(Me),C.Props=M,C.Custprops=j,C}function $g(e,t){switch(W_(t=t||{}),t.type||"base64"){case"base64":return Zp(xn(e),t);case"binary":case"buffer":case"file":return Zp(e,t);case"array":return Zp(Ka(e),t)}}function uW(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=kU(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=AU(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var fW=[60,1084,2066,2165,2175];function hW(e,t,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=Di(r,r.l),c=Hg[l],u=0;c!=null&&fW.indexOf(l)>-1;)s=Di(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+s),a.push(o),r.l+=4+s,c=Hg[l=Di(r,r.l)];var f=hs(a);lr(f,0);var h=0;f.lens=[];for(var d=0;d<a.length;++d)f.lens.push(h),h+=a[d].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,i)}function ti(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Me[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ya[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=fu(e.v):e.w=Oa(e.v):e.w=On(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&xl(Me[n]||String(n))){var i=pa(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function $f(e,t,r){return{v:e,ixfe:t,t:r}}function dW(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},a={},o=null,l=[],c="",u={},f,h="",d,m,p,g,x={},_=[],v,T,k=[],A=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},O=function(Ue){return Ue<8?Ea[Ue]:Ue<64&&A[Ue-8]||Ea[Ue]},M=function(Ue,gt,Jr){var At=gt.XF.data;if(!(!At||!At.patternType||!Jr||!Jr.cellStyles)){gt.s={},gt.s.patternType=At.patternType;var ea;(ea=mu(O(At.icvFore)))&&(gt.s.fgColor={rgb:ea}),(ea=mu(O(At.icvBack)))&&(gt.s.bgColor={rgb:ea})}},j=function(Ue,gt,Jr){if(!(Ee>1)&&!(Jr.sheetRows&&Ue.r>=Jr.sheetRows)){if(Jr.cellStyles&&gt.XF&&gt.XF.data&&M(Ue,gt,Jr),delete gt.ixfe,delete gt.XF,f=Ue,h=Le(Ue),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),Ue.r<a.s.r&&(a.s.r=Ue.r),Ue.c<a.s.c&&(a.s.c=Ue.c),Ue.r+1>a.e.r&&(a.e.r=Ue.r+1),Ue.c+1>a.e.c&&(a.e.c=Ue.c+1),Jr.cellFormula&&gt.f){for(var At=0;At<_.length;++At)if(!(_[At][0].s.c>Ue.c||_[At][0].s.r>Ue.r)&&!(_[At][0].e.c<Ue.c||_[At][0].e.r<Ue.r)){gt.F=Ye(_[At][0]),(_[At][0].s.c!=Ue.c||_[At][0].s.r!=Ue.r)&&delete gt.f,gt.f&&(gt.f=""+kr(_[At][1],a,Ue,V,b));break}}Jr.dense?(i[Ue.r]||(i[Ue.r]=[]),i[Ue.r][Ue.c]=gt):i[h]=gt}},b={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(b.password=t.password);var X,ne=[],re=[],se=[],ue=[],te=!1,V=[];V.SheetNames=b.snames,V.sharedf=b.sharedf,V.arrayf=b.arrayf,V.names=[],V.XTI=[];var ce=0,Ee=0,N=0,z=[],B=[],U;b.codepage=1200,zn(1200);for(var Z=!1;e.l<e.length-1;){var de=e.l,xe=e.read_shift(2);if(xe===0&&ce===10)break;var me=e.l===e.length?0:e.read_shift(2),ae=Hg[xe];if(ae&&ae.f){if(t.bookSheets&&ce===133&&xe!==133)break;if(ce=xe,ae.r===2||ae.r==12){var ze=e.read_shift(2);if(me-=2,!b.enc&&ze!==xe&&((ze&255)<<8|ze>>8)!==xe)throw new Error("rt mismatch: "+ze+"!="+xe);ae.r==12&&(e.l+=10,me-=10)}var L={};if(xe===10?L=ae.f(e,me,b):L=hW(xe,ae,e,me,b),Ee==0&&[9,521,1033,2057].indexOf(ce)===-1)continue;switch(xe){case 34:r.opts.Date1904=E.WBProps.date1904=L;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(b.enc||(e.l=0),b.enc=L,!t.password)throw new Error("File is password-protected");if(L.valid==null)throw new Error("Encryption scheme unsupported");if(!L.valid)throw new Error("Password is incorrect");break;case 92:b.lastuser=L;break;case 66:var mt=Number(L);switch(mt){case 21010:mt=1200;break;case 32768:mt=1e4;break;case 32769:mt=1252;break}zn(b.codepage=mt),Z=!0;break;case 317:b.rrtabid=L;break;case 25:b.winlocked=L;break;case 439:r.opts.RefreshAll=L;break;case 12:r.opts.CalcCount=L;break;case 16:r.opts.CalcDelta=L;break;case 17:r.opts.CalcIter=L;break;case 13:r.opts.CalcMode=L;break;case 14:r.opts.CalcPrecision=L;break;case 95:r.opts.CalcSaveRecalc=L;break;case 15:b.CalcRefMode=L;break;case 2211:r.opts.FullCalc=L;break;case 129:L.fDialog&&(i["!type"]="dialog"),L.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),L.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:k.push(L);break;case 430:V.push([L]),V[V.length-1].XTI=[];break;case 35:case 547:V[V.length-1].push(L);break;case 24:case 536:U={Name:L.Name,Ref:kr(L.rgce,a,null,V,b)},L.itab>0&&(U.Sheet=L.itab-1),V.names.push(U),V[0]||(V[0]=[],V[0].XTI=[]),V[V.length-1].push(L),L.Name=="_xlnm._FilterDatabase"&&L.itab>0&&L.rgce&&L.rgce[0]&&L.rgce[0][0]&&L.rgce[0][0][0]=="PtgArea3d"&&(B[L.itab-1]={ref:Ye(L.rgce[0][0][1][2])});break;case 22:b.ExternCount=L;break;case 23:V.length==0&&(V[0]=[],V[0].XTI=[]),V[V.length-1].XTI=V[V.length-1].XTI.concat(L),V.XTI=V.XTI.concat(L);break;case 2196:if(b.biff<8)break;U!=null&&(U.Comment=L[1]);break;case 18:i["!protect"]=L;break;case 19:L!==0&&b.WTF&&console.error("Password verifier: "+L);break;case 133:s[L.pos]=L,b.snames.push(L.name);break;case 10:{if(--Ee)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=Ye(a),t.sheetRows&&t.sheetRows<=a.e.r){var Qe=a.e.r;a.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Ye(a),a.e.r=Qe}a.e.r++,a.e.c++}ne.length>0&&(i["!merges"]=ne),re.length>0&&(i["!objects"]=re),se.length>0&&(i["!cols"]=se),ue.length>0&&(i["!rows"]=ue),E.Sheets.push(F)}c===""?u=i:n[c]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(b.biff===8&&(b.biff={9:2,521:3,1033:4}[xe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[L.BIFFVer]||8),b.biffguess=L.BIFFVer==0,L.BIFFVer==0&&L.dt==4096&&(b.biff=5,Z=!0,zn(b.codepage=28591)),b.biff==8&&L.BIFFVer==0&&L.dt==16&&(b.biff=2),Ee++)break;if(i=t.dense?[]:{},b.biff<8&&!Z&&(Z=!0,zn(b.codepage=t.codepage||1252)),b.biff<5||L.BIFFVer==0&&L.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var it={pos:e.l-me,name:c};s[it.pos]=it,b.snames.push(c)}else c=(s[de]||{name:""}).name;L.dt==32&&(i["!type"]="chart"),L.dt==64&&(i["!type"]="macro"),ne=[],re=[],b.arrayf=_=[],se=[],ue=[],te=!1,F={Hidden:(s[de]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[L.r]||[])[L.c]:i[Le({c:L.c,r:L.r})])&&++L.c,v={ixfe:L.ixfe,XF:k[L.ixfe]||{},v:L.val,t:"n"},N>0&&(v.z=z[v.ixfe>>8&63]),ti(v,t,r.opts.Date1904),j({c:L.c,r:L.r},v,t);break;case 5:case 517:v={ixfe:L.ixfe,XF:k[L.ixfe],v:L.val,t:L.t},N>0&&(v.z=z[v.ixfe>>8&63]),ti(v,t,r.opts.Date1904),j({c:L.c,r:L.r},v,t);break;case 638:v={ixfe:L.ixfe,XF:k[L.ixfe],v:L.rknum,t:"n"},N>0&&(v.z=z[v.ixfe>>8&63]),ti(v,t,r.opts.Date1904),j({c:L.c,r:L.r},v,t);break;case 189:for(var Be=L.c;Be<=L.C;++Be){var C=L.rkrec[Be-L.c][0];v={ixfe:C,XF:k[C],v:L.rkrec[Be-L.c][1],t:"n"},N>0&&(v.z=z[v.ixfe>>8&63]),ti(v,t,r.opts.Date1904),j({c:Be,r:L.r},v,t)}break;case 6:case 518:case 1030:{if(L.val=="String"){o=L;break}if(v=$f(L.val,L.cell.ixfe,L.tt),v.XF=k[v.ixfe],t.cellFormula){var W=L.formula;if(W&&W[0]&&W[0][0]&&W[0][0][0]=="PtgExp"){var Q=W[0][0][1][0],we=W[0][0][1][1],pe=Le({r:Q,c:we});x[pe]?v.f=""+kr(L.formula,a,L.cell,V,b):v.F=((t.dense?(i[Q]||[])[we]:i[pe])||{}).F}else v.f=""+kr(L.formula,a,L.cell,V,b)}N>0&&(v.z=z[v.ixfe>>8&63]),ti(v,t,r.opts.Date1904),j(L.cell,v,t),o=L}break;case 7:case 519:if(o)o.val=L,v=$f(L,o.cell.ixfe,"s"),v.XF=k[v.ixfe],t.cellFormula&&(v.f=""+kr(o.formula,a,o.cell,V,b)),N>0&&(v.z=z[v.ixfe>>8&63]),ti(v,t,r.opts.Date1904),j(o.cell,v,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(L);var fe=Le(L[0].s);if(d=t.dense?(i[L[0].s.r]||[])[L[0].s.c]:i[fe],t.cellFormula&&d){if(!o||!fe||!d)break;d.f=""+kr(L[1],a,L[0],V,b),d.F=Ye(L[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;x[Le(o.cell)]=L[0],d=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[Le(o.cell)],(d||{}).f=""+kr(L[0],a,f,V,b)}}break;case 253:v=$f(l[L.isst].t,L.ixfe,"s"),l[L.isst].h&&(v.h=l[L.isst].h),v.XF=k[v.ixfe],N>0&&(v.z=z[v.ixfe>>8&63]),ti(v,t,r.opts.Date1904),j({c:L.c,r:L.r},v,t);break;case 513:t.sheetStubs&&(v={ixfe:L.ixfe,XF:k[L.ixfe],t:"z"},N>0&&(v.z=z[v.ixfe>>8&63]),ti(v,t,r.opts.Date1904),j({c:L.c,r:L.r},v,t));break;case 190:if(t.sheetStubs)for(var Ce=L.c;Ce<=L.C;++Ce){var je=L.ixfe[Ce-L.c];v={ixfe:je,XF:k[je],t:"z"},N>0&&(v.z=z[v.ixfe>>8&63]),ti(v,t,r.opts.Date1904),j({c:Ce,r:L.r},v,t)}break;case 214:case 516:case 4:v=$f(L.val,L.ixfe,"s"),v.XF=k[v.ixfe],N>0&&(v.z=z[v.ixfe>>8&63]),ti(v,t,r.opts.Date1904),j({c:L.c,r:L.r},v,t);break;case 0:case 512:Ee===1&&(a=L);break;case 252:l=L;break;case 1054:if(b.biff==4){z[N++]=L[1];for(var et=0;et<N+163&&Me[et]!=L[1];++et);et>=163&&ya(L[1],N+163)}else ya(L[1],L[0]);break;case 30:{z[N++]=L;for(var Mr=0;Mr<N+163&&Me[Mr]!=L;++Mr);Mr>=163&&ya(L,N+163)}break;case 229:ne=ne.concat(L);break;case 93:re[L.cmo[0]]=b.lastobj=L;break;case 438:b.lastobj.TxO=L;break;case 127:b.lastobj.ImData=L;break;case 440:for(g=L[0].s.r;g<=L[0].e.r;++g)for(p=L[0].s.c;p<=L[0].e.c;++p)d=t.dense?(i[g]||[])[p]:i[Le({c:p,r:g})],d&&(d.l=L[1]);break;case 2048:for(g=L[0].s.r;g<=L[0].e.r;++g)for(p=L[0].s.c;p<=L[0].e.c;++p)d=t.dense?(i[g]||[])[p]:i[Le({c:p,r:g})],d&&d.l&&(d.l.Tooltip=L[1]);break;case 28:{if(b.biff<=5&&b.biff>=2)break;d=t.dense?(i[L[0].r]||[])[L[0].c]:i[Le(L[0])];var Zs=re[L[2]];d||(t.dense?(i[L[0].r]||(i[L[0].r]=[]),d=i[L[0].r][L[0].c]={t:"z"}):d=i[Le(L[0])]={t:"z"},a.e.r=Math.max(a.e.r,L[0].r),a.s.r=Math.min(a.s.r,L[0].r),a.e.c=Math.max(a.e.c,L[0].c),a.s.c=Math.min(a.s.c,L[0].c)),d.c||(d.c=[]),m={a:L[1],t:Zs.TxO.t},d.c.push(m)}break;case 2173:Lj(k[L.ixfe],L.ext);break;case 125:{if(!b.cellStyles)break;for(;L.e>=L.s;)se[L.e--]={width:L.w/256,level:L.level||0,hidden:!!(L.flags&1)},te||(te=!0,B_(L.w/256)),el(se[L.e+1])}break;case 520:{var Ht={};L.level!=null&&(ue[L.r]=Ht,Ht.level=L.level),L.hidden&&(ue[L.r]=Ht,Ht.hidden=!0),L.hpt&&(ue[L.r]=Ht,Ht.hpt=L.hpt,Ht.hpx=gu(L.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||kc(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[xe]]=L;break;case 161:i["!margins"]||kc(i["!margins"]={}),i["!margins"].header=L.header,i["!margins"].footer=L.footer;break;case 574:L.RTL&&(E.Views[0].RTL=!0);break;case 146:A=L;break;case 2198:X=L;break;case 140:T=L;break;case 442:c?F.CodeName=L||F.name:E.WBProps.CodeName=L||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+xe.toString(16)),e.l+=me}return r.SheetNames=yi(s).sort(function(Qr,Ue){return Number(Qr)-Number(Ue)}).map(function(Qr){return s[Qr].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&B.forEach(function(Qr,Ue){r.Sheets[r.SheetNames[Ue]]["!autofilter"]=Qr}),r.Strings=l,r.SSF=pr(Me),b.enc&&(r.Encryption=b.enc),X&&(r.Themes=X),r.Metadata={},T!==void 0&&(r.Metadata.Country=T),V.names.length>0&&(E.Names=V.names),r.Workbook=E,r}var Hw={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function pW(e,t,r){var n=Xe.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=Sw(n,FU,Hw.DSI);for(var s in i)t[s]=i[s]}catch(c){if(r.WTF)throw c}var a=Xe.find(e,"/!SummaryInformation");if(a&&a.size>0)try{var o=Sw(a,NU,Hw.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(dR(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function YR(e,t){t||(t={}),W_(t),kC(),t.codepage&&T_(t.codepage);var r,n;if(e.FullPaths){if(Xe.find(e,"/encryption"))throw new Error("File is password-protected");r=Xe.find(e,"!CompObj"),n=Xe.find(e,"/Workbook")||Xe.find(e,"/Book")}else{switch(t.type){case"base64":e=Hn(xn(e));break;case"binary":e=Hn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}lr(e,0),n={content:e}}var i,s;if(r&&uW(r),t.bookProps&&!t.bookSheets)i={};else{var a=Ke?"buffer":"array";if(n&&n.content)i=dW(n.content,t);else if((s=Xe.find(e,"PerfectOffice_MAIN"))&&s.content)i=wc.to_workbook(s.content,(t.type=a,t));else if((s=Xe.find(e,"NativeContent_MAIN"))&&s.content)i=wc.to_workbook(s.content,(t.type=a,t));else throw(s=Xe.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Xe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=Zj(e))}var o={};return e.FullPaths&&pW(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}var A0={0:{f:XH},1:{f:ZH},2:{f:lz},3:{f:nz},4:{f:tz},5:{f:oz},6:{f:fz},7:{f:sz},8:{f:gz},9:{f:mz},10:{f:dz},11:{f:pz},12:{f:ez},13:{f:cz},14:{f:iz},15:{f:rz},16:{f:WR},17:{f:hz},18:{f:az},19:{f:O_},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Hz},40:{},42:{},43:{f:dj},44:{f:hj},45:{f:pj},46:{f:gj},47:{f:mj},48:{},49:{f:vU},50:{},51:{f:Mj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:AR},62:{f:uz},63:{f:$j},64:{f:Az},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Lr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:kz},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:JH},148:{f:YH,p:16},151:{f:xz},152:{},153:{f:jz},154:{},155:{},156:{f:Bz},157:{},158:{},159:{T:1,f:N7},160:{T:-1},161:{T:1,f:Xa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:vz},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:bj},336:{T:-1},337:{f:Vj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Vg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:kR},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:yz},427:{f:Ez},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Tz},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:QH},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:_z},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Vg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Yj},633:{T:1},634:{T:-1},635:{T:1,f:Xj},636:{T:-1},637:{f:xU},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Fz},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Sz},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Hg={6:{f:Qp},10:{f:es},12:{f:Ut},13:{f:Ut},14:{f:Nt},15:{f:Nt},16:{f:Ir},17:{f:Nt},18:{f:Nt},19:{f:Ut},20:{f:Pw},21:{f:Pw},23:{f:kR},24:{f:Nw},25:{f:Nt},26:{},27:{},28:{f:KB},29:{},34:{f:Nt},35:{f:Fw},38:{f:Ir},39:{f:Ir},40:{f:Ir},41:{f:Ir},42:{f:Nt},43:{f:Nt},47:{f:Q7},49:{f:CB},51:{f:Ut},60:{},61:{f:AB},64:{f:Nt},65:{f:IB},66:{f:Ut},77:{},80:{},81:{},82:{},85:{f:Ut},89:{},90:{},91:{},92:{f:vB},93:{f:XB},94:{},95:{f:Nt},96:{},97:{},99:{f:Nt},125:{f:AR},128:{f:VB},129:{f:_B},130:{f:Ut},131:{f:Nt},132:{f:Nt},133:{f:xB},134:{},140:{f:t7},141:{f:Ut},144:{},146:{f:n7},151:{},152:{},153:{},154:{},155:{},156:{f:Ut},157:{},158:{},160:{f:l7},161:{f:s7},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:OB},190:{f:LB},193:{f:es},197:{},198:{},199:{},200:{},201:{},202:{f:Nt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ut},220:{},221:{f:Nt},222:{},224:{f:MB},225:{f:gB},226:{f:es},227:{},229:{f:qB},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:yB},253:{f:RB},255:{f:EB},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:_R},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Nt},353:{f:es},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:BB},431:{f:Nt},432:{},433:{},434:{},437:{},438:{f:JB},439:{f:Nt},440:{f:ZB},441:{},442:{f:Ju},443:{},444:{f:Ut},445:{},446:{},448:{f:es},449:{f:kB,r:2},450:{f:es},512:{f:Cw},513:{f:o7},515:{f:UB},516:{f:PB},517:{f:Rw},519:{f:c7},520:{f:wB},523:{},545:{f:Dw},549:{f:Iw},566:{},574:{f:SB},638:{f:DB},659:{},1048:{},1054:{f:FB},1084:{},1212:{f:zB},2048:{f:e7},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Uf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:es},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:i7,r:12},2173:{f:Oj,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Nt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:HB,r:12},2197:{},2198:{f:Cj,r:12},2199:{},2200:{},2201:{},2202:{f:WB,r:12},2203:{f:es},2204:{},2205:{},2206:{},2207:{},2211:{f:TB},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ut},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:a7},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:r7},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Cw},1:{},2:{f:d7},3:{f:h7},4:{f:f7},5:{f:Rw},7:{f:p7},8:{},9:{f:Uf},11:{},22:{f:Ut},30:{f:NB},31:{},32:{},33:{f:Dw},36:{},37:{f:Iw},50:{f:m7},62:{},52:{},67:{},68:{f:Ut},69:{},86:{},126:{},127:{f:u7},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:g7},223:{},234:{},354:{},421:{},518:{f:Qp},521:{f:Uf},536:{f:Nw},547:{f:Fw},561:{},579:{},1030:{f:Qp},1033:{f:Uf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Un(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&sR(r)&&e.push(r)}}function zw(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),a=i.index,o=s&&s.index||e.length,l=BV(e.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,f=0,h=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(a=0;a<l.length;++a){var p=l[a].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var x=p.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var _=x[o].trim();if(_.match(/<t[dh]/i)){for(var v=_,T=0;v.charAt(0)=="<"&&(T=v.indexOf(">"))>-1;)v=v.slice(T+1);for(var k=0;k<m.length;++k){var A=m[k];A.s.c==u&&A.s.r<c&&c<=A.e.r&&(u=A.e.c+1,k=-1)}var E=Pe(_.slice(0,_.indexOf(">")));h=E.colspan?+E.colspan:1,((f=+E.rowspan)>1||h>1)&&m.push({s:{r:c,c:u},e:{r:c+(f||1)-1,c:u+h-1}});var F=E.t||E["data-t"]||"";if(!v.length){u+=h;continue}if(v=GC(v),d.s.r>c&&(d.s.r=c),d.e.r<c&&(d.e.r=c),d.s.c>u&&(d.s.c=u),d.e.c<u&&(d.e.c=u),!v.length){u+=h;continue}var O={t:"s",v};r.raw||!v.trim().length||F=="s"||(v==="TRUE"?O={t:"b",v:!0}:v==="FALSE"?O={t:"b",v:!1}:isNaN(Xn(v))?isNaN(Zo(v).getDate())||(O={t:"d",v:rr(v)},r.cellDates||(O={t:"n",v:qr(O.v)}),O.z=r.dateNF||Me[14]):O={t:"n",v:Xn(v)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=O):n[Le({r:c,c:u})]=O,u+=h}}}}return n["!ref"]=Ye(d),m.length&&(n["!merges"]=m),n}function mW(e,t,r,n){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=Le({r,c:a}),f=n.dense?(e[r]||[])[a]:e[u],h=f&&f.v!=null&&(f.h||R_(f.w||(Gi(f),f.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(d["data-t"]=f&&f.t||"z",f.v!=null&&(d["data-v"]=f.v),f.z!=null&&(d["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),d.id=(n.id||"sjs")+"-"+u,s.push(tU("td",h,d))}}var m="<tr>";return m+s.join("")+"</tr>"}var gW='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',vW="</body></html>";function _W(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Js(zw(r[0],t),t);var n=K_();return r.forEach(function(i,s){q_(n,zw(i,t),"Sheet"+(s+1))}),n}function xW(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function yW(e,t){var r=t||{},n=r.header!=null?r.header:gW,i=r.footer!=null?r.footer:vW,s=[n],a=yl(e["!ref"]);r.dense=Array.isArray(e),s.push(xW(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(mW(e,a,o,r));return s.push("</table>"+i),s.join("")}function QR(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?zr(n.origin):n.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=yl(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var f=[],h=0,d=e["!rows"]||(e["!rows"]=[]),m=0,p=0,g=0,x=0,_=0,v=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&p<l;++m){var T=o[m];if(Ww(T)){if(n.display)continue;d[p]={hidden:!0}}var k=T.children;for(g=x=0;g<k.length;++g){var A=k[g];if(!(n.display&&Ww(A))){var E=A.hasAttribute("data-v")?A.getAttribute("data-v"):A.hasAttribute("v")?A.getAttribute("v"):GC(A.innerHTML),F=A.getAttribute("data-z")||A.getAttribute("z");for(h=0;h<f.length;++h){var O=f[h];O.s.c==x+s&&O.s.r<p+i&&p+i<=O.e.r&&(x=O.e.c+1-s,h=-1)}v=+A.getAttribute("colspan")||1,((_=+A.getAttribute("rowspan")||1)>1||v>1)&&f.push({s:{r:p+i,c:x+s},e:{r:p+i+(_||1)-1,c:x+s+(v||1)-1}});var M={t:"s",v:E},j=A.getAttribute("data-t")||A.getAttribute("t")||"";E!=null&&(E.length==0?M.t=j||"z":n.raw||E.trim().length==0||j=="s"||(E==="TRUE"?M={t:"b",v:!0}:E==="FALSE"?M={t:"b",v:!1}:isNaN(Xn(E))?isNaN(Zo(E).getDate())||(M={t:"d",v:rr(E)},n.cellDates||(M={t:"n",v:qr(M.v)}),M.z=n.dateNF||Me[14]):M={t:"n",v:Xn(E)})),M.z===void 0&&F!=null&&(M.z=F);var b="",X=A.getElementsByTagName("A");if(X&&X.length)for(var ne=0;ne<X.length&&!(X[ne].hasAttribute("href")&&(b=X[ne].getAttribute("href"),b.charAt(0)!="#"));++ne);b&&b.charAt(0)!="#"&&(M.l={Target:b}),n.dense?(e[p+i]||(e[p+i]=[]),e[p+i][x+s]=M):e[Le({c:x+s,r:p+i})]=M,c.e.c<x+s&&(c.e.c=x+s),x+=v}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,p-1+i),e["!ref"]=Ye(c),p>=l&&(e["!fullref"]=Ye((c.e.r=o.length-m+p-1+i,c))),e}function JR(e,t){var r=t||{},n=r.dense?[]:{};return QR(n,e,t)}function EW(e,t){return Js(JR(e,t),t)}function Ww(e){var t="",r=wW(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function wW(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function TW(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ze(t.replace(/<[^>]*>/g,""));return[r]}var Gw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function ZR(e,t){var r=t||{},n=P_(e),i=[],s,a,o={name:""},l="",c=0,u,f,h={},d=[],m=r.dense?[]:{},p,g,x={value:""},_="",v=0,T=[],k=-1,A=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,O={},M=[],j={},b=0,X=0,ne=[],re=1,se=1,ue=[],te={Names:[]},V={},ce=["",""],Ee=[],N={},z="",B=0,U=!1,Z=!1,de=0;for(du.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=du.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"工作表":p[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?m["!ref"]=Ye(E):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(m["!fullref"]=m["!ref"],E.e.r=r.sheetRows-1,m["!ref"]=Ye(E)),M.length&&(m["!merges"]=M),ne.length&&(m["!rows"]=ne),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),d.push(u.name),h[u.name]=m,Z=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=Pe(p[0],!1),k=A=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,m=r.dense?[]:{},M=[],ne=[],Z=!0);break;case"table-row-group":p[1]==="/"?--F:++F;break;case"table-row":case"行":if(p[1]==="/"){k+=re,re=1;break}if(f=Pe(p[0],!1),f.行号?k=f.行号-1:k==-1&&(k=0),re=+f["number-rows-repeated"]||1,re<10)for(de=0;de<re;++de)F>0&&(ne[k+de]={level:F});A=-1;break;case"covered-table-cell":p[1]!=="/"&&++A,r.sheetStubs&&(r.dense?(m[k]||(m[k]=[]),m[k][A]={t:"z"}):m[Le({r:k,c:A})]={t:"z"}),_="",T=[];break;case"table-cell":case"数据":if(p[0].charAt(p[0].length-2)==="/")++A,x=Pe(p[0],!1),se=parseInt(x["number-columns-repeated"]||"1",10),g={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(g.f=Bw(Ze(x.formula))),(x.数据类型||x["value-type"])=="string"&&(g.t="s",g.v=Ze(x["string-value"]||""),r.dense?(m[k]||(m[k]=[]),m[k][A]=g):m[Le({r:k,c:A})]=g),A+=se-1;else if(p[1]!=="/"){++A,_="",v=0,T=[],se=1;var xe=re?k+re-1:k;if(A>E.e.c&&(E.e.c=A),A<E.s.c&&(E.s.c=A),k<E.s.r&&(E.s.r=k),xe>E.e.r&&(E.e.r=xe),x=Pe(p[0],!1),Ee=[],N={},g={t:x.数据类型||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=Ze(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(b=parseInt(x["number-matrix-rows-spanned"],10)||0,X=parseInt(x["number-matrix-columns-spanned"],10)||0,j={s:{r:k,c:A},e:{r:k+b-1,c:A+X-1}},g.F=Ye(j),ue.push([j,g.F])),x.formula)g.f=Bw(x.formula);else for(de=0;de<ue.length;++de)k>=ue[de][0].s.r&&k<=ue[de][0].e.r&&A>=ue[de][0].s.c&&A<=ue[de][0].e.c&&(g.F=ue[de][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(b=parseInt(x["number-rows-spanned"],10)||0,X=parseInt(x["number-columns-spanned"],10)||0,j={s:{r:k,c:A},e:{r:k+b-1,c:A+X-1}},M.push(j)),x["number-columns-repeated"]&&(se=parseInt(x["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=vt(x["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(x.value);break;case"percentage":g.t="n",g.v=parseFloat(x.value);break;case"currency":g.t="n",g.v=parseFloat(x.value);break;case"date":g.t="d",g.v=rr(x["date-value"]),r.cellDates||(g.t="n",g.v=qr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=MV(x["time-value"])/86400,r.cellDates&&(g.t="d",g.v=Fd(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(x.数据数值);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",x["string-value"]!=null&&(_=Ze(x["string-value"]),T=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(U=!1,g.t==="s"&&(g.v=_||"",T.length&&(g.R=T),U=v==0),V.Target&&(g.l=V),Ee.length>0&&(g.c=Ee,Ee=[]),_&&r.cellText!==!1&&(g.w=_),U&&(g.t="z",delete g.v),(!U||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=k))for(var me=0;me<re;++me){if(se=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(m[k+me]||(m[k+me]=[]),m[k+me][A]=me==0?g:pr(g);--se>0;)m[k+me][A+se]=pr(g);else for(m[Le({r:k+me,c:A})]=g;--se>0;)m[Le({r:k+me,c:A+se})]=pr(g);E.e.c<=A&&(E.e.c=A)}se=parseInt(x["number-columns-repeated"]||"1",10),A+=se-1,se=0,g={},_="",T=[]}V={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s;N.t=_,T.length&&(N.R=T),N.a=z,Ee.push(N)}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);z="",B=0,_="",v=0,T=[];break;case"creator":p[1]==="/"?z=n.slice(B,p.index):B=p.index+p[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);_="",v=0,T=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(O[o.name]=l,(s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(l="",o=Pe(p[0],!1),i.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Pe(p[0],!1),l+=Gw[p[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Pe(p[0],!1),l+=Gw[p[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,p.index);break}else c=p.index+p[0].length;break;case"named-range":a=Pe(p[0],!1),ce=Jp(a["cell-range-address"]);var ae={Name:a.name,Ref:ce[0]+"!"+ce[1]};Z&&(ae.Sheet=d.length),te.Names.push(ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(p[1]==="/"&&(!x||!x["string-value"])){var ze=TW(n.slice(v,p.index));_=(_.length>0?_+`
`:"")+ze[0]}else Pe(p[0],!1),v=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{ce=Jp(Pe(p[0])["target-range-address"]),h[ce[0]]["!autofilter"]={ref:ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(V=Pe(p[0],!1),!V.href)break;V.Target=Ze(V.href),delete V.href,V.Target.charAt(0)=="#"&&V.Target.indexOf(".")>-1?(ce=Jp(V.Target.slice(1)),V.Target="#"+ce[0]+"!"+ce[1]):V.Target.match(/^\.\.[\\\/]/)&&(V.Target=V.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(p)}}var L={Sheets:h,SheetNames:d,Workbook:te};return r.bookSheets&&delete L.Sheets,L}function Kw(e,t){t=t||{},kn(e,"META-INF/manifest.xml")&&UU(Vt(e,"META-INF/manifest.xml"),t);var r=fn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=ZR(lt(r),t);return kn(e,"meta.xml")&&(n.Props=hR(Vt(e,"meta.xml"))),n}function qw(e,t){return ZR(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function H_(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function zg(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):lt(Ka(e))}function Wg(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function Xw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function kW(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function vu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Xt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Cr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=vu(e,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=vu(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function z_(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function AW(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=vu(e,n),s=Cr(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:Xt(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Cr(o.data),c=Xt(l[3][0].data);a.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(a.merge=Xt(s[3][0].data)>>>0>0),r.push(a)}return r}function SW(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=vu(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Wg(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=Wg(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function IW(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(SW(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Wg(t)}function CW(e,t,r,n){var i=H_(e),s=i.getUint32(4,!0),a=(n>1?12:8)+Xw(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=Xw(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(c=i.getFloat64(a,!0),a+=8),s&64&&(u.setTime(u.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function RW(e,t,r){var n=H_(e),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);i&1&&(l=kW(e,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(a>-1)f={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return f}function PW(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return CW(e,t,r,e[0]);case 5:return RW(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ls(e){var t=Cr(e);return vu(t[1][0].data)}function Yw(e,t){var r=Cr(t.data),n=Xt(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=Cr(a.data),l=Xt(o[1][0].data)>>>0;switch(n){case 1:s[l]=zg(o[3][0].data);break;case 8:{var c=e[Ls(o[9][0].data)][0],u=Cr(c.data),f=e[Ls(u[1][0].data)][0],h=Xt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var d=Cr(f.data);s[l]=d[3].map(function(m){return zg(m.data)}).join("")}break}}),s}function FW(e,t){var r,n,i,s,a,o,l,c,u,f,h,d,m,p,g=Cr(e),x=Xt(g[1][0].data)>>>0,_=Xt(g[2][0].data)>>>0,v=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&Xt(g[8][0].data)>0||!1,T,k;if((s=(i=g[7])==null?void 0:i[0])!=null&&s.data&&t!=0)T=(o=(a=g[7])==null?void 0:a[0])==null?void 0:o.data,k=(c=(l=g[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=g[4])==null?void 0:u[0])!=null&&f.data&&t!=1)T=(d=(h=g[4])==null?void 0:h[0])==null?void 0:d.data,k=(p=(m=g[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var A=v?4:1,E=H_(T),F=[],O=0;O<T.length/2;++O){var M=E.getUint16(O*2,!0);M<65535&&F.push([O,M])}if(F.length!=_)throw"Expected ".concat(_," cells, found ").concat(F.length);var j=[];for(O=0;O<F.length-1;++O)j[F[O][0]]=k.subarray(F[O][1]*A,F[O+1][1]*A);return F.length>=1&&(j[F[F.length-1][0]]=k.subarray(F[F.length-1][1]*A)),{R:x,cells:j}}function NW(e,t){var r,n=Cr(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Xt(n[7][0].data)>>>0>0?1:0:-1,s=z_(n[5],function(a){return FW(a,i)});return{nrows:Xt(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function DW(e,t,r){var n,i=Cr(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Xt(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Xt(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Ye(s);var a=Cr(i[4][0].data),o=Yw(e,e[Ls(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?Yw(e,e[Ls(a[17][0].data)][0]):[],c=Cr(a[3][0].data),u=0;c[1].forEach(function(f){var h=Cr(f.data),d=e[Ls(h[2][0].data)][0],m=Xt(d.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=NW(e,d);p.data.forEach(function(g,x){g.forEach(function(_,v){var T=Le({r:u+x,c:v}),k=PW(_,o,l);k&&(r[T]=k)})}),u+=p.nrows})}function OW(e,t){var r=Cr(t.data),n={"!ref":"A1"},i=e[Ls(r[2][0].data)],s=Xt(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return DW(e,i[0],n),n}function LW(e,t){var r,n=Cr(t.data),i={name:(r=n[1])!=null&&r[0]?zg(n[1][0].data):"",sheets:[]},s=z_(n[2],Ls);return s.forEach(function(a){e[a].forEach(function(o){var l=Xt(o.meta[1][0].data);l==6e3&&i.sheets.push(OW(e,o))})}),i}function bW(e,t){var r=K_(),n=Cr(t.data),i=z_(n[1],Ls);if(i.forEach(function(s){e[s].forEach(function(a){var o=Xt(a.meta[1][0].data);if(o==2){var l=LW(e,a);l.sheets.forEach(function(c,u){q_(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function em(e){var t,r,n,i,s={},a=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=IW(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=AW(c)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){s[f.id]=f.messages,a.push(f.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Xt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(c){var u=Xt(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return bW(s,o)}function MW(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function W_(e){MW([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function VW(e){return wo.WS.indexOf(e)>-1?"sheet":e==wo.CS?"chart":e==wo.DS?"dialog":e==wo.MS?"macro":e&&e.length?e:"sheet"}function UW(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,VW(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function BW(e,t,r,n,i,s,a,o,l,c,u,f){try{s[n]=yc(fn(e,r,!0),t);var h=Vt(e,t),d;switch(o){case"sheet":d=Gz(h,t,i,l,s[n],c,u,f);break;case"chart":if(d=Kz(h,t,i,l,s[n],c,u,f),!d||!d["!drawel"])break;var m=Jl(d["!drawel"].Target,t),p=Ug(m),g=Wj(fn(e,m,!0),yc(fn(e,p,!0),m)),x=Jl(g,m),_=Ug(x);d=Rz(fn(e,x,!0),x,l,yc(fn(e,_,!0),x),c,d);break;case"macro":d=qz(h,t,i,l,s[n],c,u,f);break;case"dialog":d=Xz(h,t,i,l,s[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=d;var v=[];s&&s[n]&&yi(s[n]).forEach(function(T){var k="";if(s[n][T].Type==wo.CMNT){k=Jl(s[n][T].Target,t);var A=Zz(Vt(e,k,!0),k,l);if(!A||!A.length)return;Lw(d,A,!1)}s[n][T].Type==wo.TCMNT&&(k=Jl(s[n][T].Target,t),v=v.concat(Kj(Vt(e,k,!0),l)))}),v&&v.length&&Lw(d,v,!0,l.people||[])}catch(T){if(l.WTF)throw T}}function wn(e){return e.charAt(0)=="/"?e.slice(1):e}function jW(e,t){if(bC(),t=t||{},W_(t),kn(e,"META-INF/manifest.xml")||kn(e,"objectdata.xml"))return Kw(e,t);if(kn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof em<"u"){if(e.FileIndex)return em(e);var r=Xe.utils.cfb_new();return lw(e).forEach(function(ne){$V(r,ne,$C(e,ne))}),em(r)}throw new Error("Unsupported NUMBERS file")}if(!kn(e,"[Content_Types].xml"))throw kn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):kn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=lw(e),i=MU(fn(e,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Vt(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Vt(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Tc=[],i.sst)try{Tc=Jz(Vt(e,wn(i.sst)),i.sst,t)}catch(ne){if(t.WTF)throw ne}t.cellStyles&&i.themes.length&&(l=Qz(fn(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=Yz(Vt(e,wn(i.style)),i.style,l,t))}i.links.map(function(ne){try{var re=yc(fn(e,Ug(wn(ne))),ne);return tW(Vt(e,wn(ne)),re,ne,t)}catch{}});var u=Wz(Vt(e,wn(i.workbooks[0])),i.workbooks[0],t),f={},h="";i.coreprops.length&&(h=Vt(e,wn(i.coreprops[0]),!0),h&&(f=hR(h)),i.extprops.length!==0&&(h=Vt(e,wn(i.extprops[0]),!0),h&&$U(h,f,t)));var d={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(h=fn(e,wn(i.custprops[0]),!0),h&&(d=zU(h,t)));var m={};if((t.bookSheets||t.bookProps)&&(u.Sheets?a=u.Sheets.map(function(re){return re.name}):f.Worksheets&&f.SheetNames.length>0&&(a=f.SheetNames),t.bookProps&&(m.Props=f,m.Custprops=d),t.bookSheets&&typeof a<"u"&&(m.SheetNames=a),t.bookSheets?m.SheetNames:t.bookProps))return m;a={};var p={};t.bookDeps&&i.calcchain&&(p=eW(Vt(e,wn(i.calcchain)),i.calcchain));var g=0,x={},_,v;{var T=u.Sheets;f.Worksheets=T.length,f.SheetNames=[];for(var k=0;k!=T.length;++k)f.SheetNames[k]=T[k].name}var A=s?"bin":"xml",E=i.workbooks[0].lastIndexOf("/"),F=(i.workbooks[0].slice(0,E+1)+"_rels/"+i.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");kn(e,F)||(F="xl/_rels/workbook."+A+".rels");var O=yc(fn(e,F,!0),F.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=rW(Vt(e,wn(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=qj(Vt(e,wn(i.people[0])),t)),O&&(O=UW(O,u.Sheets));var M=Vt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var j="sheet";if(O&&O[g]?(_="xl/"+O[g][1].replace(/[\/]?xl\//,""),kn(e,_)||(_=O[g][1]),kn(e,_)||(_=F.replace(/_rels\/.*$/,"")+O[g][1]),j=O[g][2]):(_="xl/worksheets/sheet"+(g+1-M)+"."+A,_=_.replace(/sheet0\./,"sheet.")),v=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var b=!1,X=0;X!=t.sheets.length;++X)typeof t.sheets[X]=="number"&&t.sheets[X]==g&&(b=1),typeof t.sheets[X]=="string"&&t.sheets[X].toLowerCase()==f.SheetNames[g].toLowerCase()&&(b=1);if(!b)continue e}}BW(e,_,v,f.SheetNames[g],g,x,a,j,t,u,l,c)}return m={Directory:i,Workbook:u,Props:f,Custprops:d,Deps:p,Sheets:a,SheetNames:f.SheetNames,Strings:Tc,Styles:c,Themes:l,SSF:pr(Me)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(ne,re){ne=ne.replace(/^Root Entry[\/]/,""),m.keys.push(ne),m.files[ne]=e.FileIndex[re]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=Vt(e,wn(i.vba[0]),!0):i.defaults&&i.defaults.bin===Jj&&(m.vbaraw=Vt(e,"xl/vbaProject.bin",!0))),m}function $W(e,t){var r=t||{},n="Workbook",i=Xe.find(e,n);try{if(n="/!DataSpaces/Version",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(O7(i.content),n="/!DataSpaces/DataSpaceMap",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=b7(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=M7(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);U7(i.content)}catch{}if(n="/EncryptionInfo",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=B7(i.content);if(n="/EncryptedPackage",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function G_(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=xn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function HW(e,t){return Xe.find(e,"EncryptedPackage")?$W(e,t):YR(e,t)}function zW(e,t){var r,n=e,i=t||{};return i.type||(i.type=Ke&&Buffer.isBuffer(e)?"buffer":"base64"),r=HC(n,i),jW(r,i)}function e4(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return $g(e.slice(r),t);default:break e}return pu.to_workbook(e,t)}function WW(e,t){var r="",n=G_(e,t);switch(t.type){case"base64":r=xn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=La(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=lt(r)),t.type="binary",e4(r,t)}function GW(e,t){var r=e;return t.type=="base64"&&(r=xn(r)),r=fs.utils.decode(1200,r.slice(2),"str"),t.type="binary",e4(r,t)}function KW(e){return e.match(/[^\x00-\x7F]/)?Zl(e):e}function tm(e,t,r,n){return n?(r.type="string",pu.to_workbook(e,r)):pu.to_workbook(t,r)}function Gg(e,t){kC();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Gg(new Uint8Array(e),(r=pr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),bo={},r.dateNF&&(bo.dateNF=r.dateNF),r.type||(r.type=Ke&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ke?"buffer":"binary",n=LV(e),typeof Uint8Array<"u"&&!Ke&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=KW(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=pr(r),r.type="array",Gg(k_(n),r)}switch((i=G_(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return HW(Xe.read(n,r),r);break;case 9:if(i[1]<=8)return YR(n,r);break;case 60:return $g(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return E7(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return x7.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?zW(n,r):tm(e,n,r,s);case 239:return i[3]===60?$g(n,r):tm(e,n,r,s);case 255:if(i[1]===254)return GW(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return wc.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return wc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Ow.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return J7.to_workbook(n,r);break;case 10:case 13:case 32:return WW(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return v7.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Ow.to_workbook(n,r):tm(e,n,r,s)}function qW(e,t,r,n,i,s,a,o){var l=mr(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!a||e[r])for(var d=t.s.c;d<=t.e.c;++d){var m=a?e[r][d]:e[n[d]+l];if(m===void 0||m.t===void 0){if(c===void 0)continue;s[d]!=null&&(h[s[d]]=c);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[d]!=null){if(p==null)if(m.t=="e"&&p===null)h[s[d]]=null;else if(c!==void 0)h[s[d]]=c;else if(u&&p===null)h[s[d]]=null;else continue;else h[s[d]]=u&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?p:Gi(m,p,o);p!=null&&(f=!1)}}return{row:h,isempty:f}}function Kg(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Pt(u);break;case"number":l=Pt(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var f=mr(l.s.r),h=[],d=[],m=0,p=0,g=Array.isArray(e),x=l.s.r,_=0,v={};g&&!e[x]&&(e[x]=[]);var T=c.skipHidden&&e["!cols"]||[],k=c.skipHidden&&e["!rows"]||[];for(_=l.s.c;_<=l.e.c;++_)if(!(T[_]||{}).hidden)switch(h[_]=Kt(_),r=g?e[x][_]:e[h[_]+f],n){case 1:s[_]=_-l.s.c;break;case 2:s[_]=h[_];break;case 3:s[_]=c.header[_-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Gi(r,null,c),p=v[a]||0,!p)v[a]=1;else{do o=a+"_"+p++;while(v[o]);v[a]=p,v[o]=1}s[_]=o}for(x=l.s.r+i;x<=l.e.r;++x)if(!(k[x]||{}).hidden){var A=qW(e,l,x,h,n,s,g,c);(A.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(d[m++]=A.row)}return d.length=m,d}var Qw=/"/g;function XW(e,t,r,n,i,s,a,o){for(var l=!0,c=[],u="",f=mr(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var d=o.dense?(e[r]||[])[h]:e[n[h]+f];if(d==null)u="";else if(d.v!=null){l=!1,u=""+(o.rawNumbers&&d.t=="n"?d.v:Gi(d,null,o));for(var m=0,p=0;m!==u.length;++m)if((p=u.charCodeAt(m))===i||p===s||p===34||o.forceQuotes){u='"'+u.replace(Qw,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(l=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(Qw,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function t4(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=Pt(e["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(h[m]||{}).hidden||(f[m]=Kt(m));for(var p=0,g=i.s.r;g<=i.e.r;++g)(d[g]||{}).hidden||(u=XW(e,i,g,f,a,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((p++?o:"")+u)));return delete n.dense,r.join("")}function YW(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=t4(e,t);return r}function QW(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=Pt(e["!ref"]),s="",a=[],o,l=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=Kt(o);for(var u=i.s.r;u<=i.e.r;++u)for(s=mr(u),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function r4(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?zr(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var f=Pt(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(a=f.e.r+1,u.e.r=a+t.length-1+i)}else a==-1&&(a=0,u.e.r=t.length-1+i);var h=n.header||[],d=0;t.forEach(function(p,g){yi(p).forEach(function(x){(d=h.indexOf(x))==-1&&(h[d=h.length]=x);var _=p[x],v="z",T="",k=Le({c:o+d,r:a+g+i});c=_u(s,k),_&&typeof _=="object"&&!(_ instanceof Date)?s[k]=_:(typeof _=="number"?v="n":typeof _=="boolean"?v="b":typeof _=="string"?v="s":_ instanceof Date?(v="d",n.cellDates||(v="n",_=qr(_)),T=n.dateNF||Me[14]):_===null&&n.nullError&&(v="e",_=0),c?(c.t=v,c.v=_,delete c.w,delete c.R,T&&(c.z=T)):s[k]=c={t:v,v:_},T&&(c.z=T))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var m=mr(a);if(i)for(d=0;d<h.length;++d)s[Kt(d+o)+m]={t:"s",v:h[d]};return s["!ref"]=Ye(u),s}function JW(e,t){return r4(null,e,t)}function _u(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=zr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?_u(e,Le(t)):_u(e,Le({r:t,c:r||0}))}function ZW(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function K_(){return{SheetNames:[],Sheets:{}}}function q_(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(Mz(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function eG(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=ZW(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function tG(e,t){return e.z=t,e}function n4(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function rG(e,t,r){return n4(e,"#"+t,r)}function nG(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function iG(e,t,r,n){for(var i=typeof t!="string"?t:Pt(t),s=typeof t=="string"?t:Ye(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=_u(e,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var sG={encode_col:Kt,encode_row:mr,encode_cell:Le,encode_range:Ye,decode_col:D_,decode_row:N_,split_cell:gU,decode_cell:zr,decode_range:yl,format_cell:Gi,sheet_add_aoa:oR,sheet_add_json:r4,sheet_add_dom:QR,aoa_to_sheet:El,json_to_sheet:JW,table_to_sheet:JR,table_to_book:EW,sheet_to_csv:t4,sheet_to_txt:YW,sheet_to_json:Kg,sheet_to_html:yW,sheet_to_formulae:QW,sheet_to_row_object_array:Kg,sheet_get_cell:_u,book_new:K_,book_append_sheet:q_,book_set_sheet_visibility:eG,cell_set_number_format:tG,cell_set_hyperlink:n4,cell_set_internal_link:rG,cell_add_comment:nG,sheet_set_array_formula:iG,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function i4(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=i4(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function Es(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=i4(e))&&(n&&(n+=" "),n+=t);return n}const Sc=e=>typeof e=="number"&&!isNaN(e),Ma=e=>typeof e=="string",nn=e=>typeof e=="function",hh=e=>Ma(e)||nn(e)?e:null,rm=e=>Y.isValidElement(e)||Ma(e)||nn(e)||Sc(e);function aG(e,t,r){r===void 0&&(r=300);const{scrollHeight:n,style:i}=e;requestAnimationFrame(()=>{i.minHeight="initial",i.height=n+"px",i.transition=`all ${r}ms`,requestAnimationFrame(()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(t,r)})})}function Ld(e){let{enter:t,exit:r,appendPosition:n=!1,collapse:i=!0,collapseDuration:s=300}=e;return function(a){let{children:o,position:l,preventExitTransition:c,done:u,nodeRef:f,isIn:h}=a;const d=n?`${t}--${l}`:t,m=n?`${r}--${l}`:r,p=Y.useRef(0);return Y.useLayoutEffect(()=>{const g=f.current,x=d.split(" "),_=v=>{v.target===f.current&&(g.dispatchEvent(new Event("d")),g.removeEventListener("animationend",_),g.removeEventListener("animationcancel",_),p.current===0&&v.type!=="animationcancel"&&g.classList.remove(...x))};g.classList.add(...x),g.addEventListener("animationend",_),g.addEventListener("animationcancel",_)},[]),Y.useEffect(()=>{const g=f.current,x=()=>{g.removeEventListener("animationend",x),i?aG(g,u,s):u()};h||(c?x():(p.current=1,g.className+=` ${m}`,g.addEventListener("animationend",x)))},[h]),Se.createElement(Se.Fragment,null,o)}}function Jw(e,t){return e!=null?{content:e.content,containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,status:t}:{}}const An={list:new Map,emitQueue:new Map,on(e,t){return this.list.has(e)||this.list.set(e,[]),this.list.get(e).push(t),this},off(e,t){if(t){const r=this.list.get(e).filter(n=>n!==t);return this.list.set(e,r),this}return this.list.delete(e),this},cancelEmit(e){const t=this.emitQueue.get(e);return t&&(t.forEach(clearTimeout),this.emitQueue.delete(e)),this},emit(e){this.list.has(e)&&this.list.get(e).forEach(t=>{const r=setTimeout(()=>{t(...[].slice.call(arguments,1))},0);this.emitQueue.has(e)||this.emitQueue.set(e,[]),this.emitQueue.get(e).push(r)})}},Hf=e=>{let{theme:t,type:r,...n}=e;return Se.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:t==="colored"?"currentColor":`var(--toastify-icon-color-${r})`,...n})},nm={info:function(e){return Se.createElement(Hf,{...e},Se.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return Se.createElement(Hf,{...e},Se.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return Se.createElement(Hf,{...e},Se.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return Se.createElement(Hf,{...e},Se.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return Se.createElement("div",{className:"Toastify__spinner"})}};function oG(e){const[,t]=Y.useReducer(d=>d+1,0),[r,n]=Y.useState([]),i=Y.useRef(null),s=Y.useRef(new Map).current,a=d=>r.indexOf(d)!==-1,o=Y.useRef({toastKey:1,displayedToast:0,count:0,queue:[],props:e,containerId:null,isToastActive:a,getToast:d=>s.get(d)}).current;function l(d){let{containerId:m}=d;const{limit:p}=o.props;!p||m&&o.containerId!==m||(o.count-=o.queue.length,o.queue=[])}function c(d){n(m=>d==null?[]:m.filter(p=>p!==d))}function u(){const{toastContent:d,toastProps:m,staleId:p}=o.queue.shift();h(d,m,p)}function f(d,m){let{delay:p,staleId:g,...x}=m;if(!rm(d)||function(b){return!i.current||o.props.enableMultiContainer&&b.containerId!==o.props.containerId||s.has(b.toastId)&&b.updateId==null}(x))return;const{toastId:_,updateId:v,data:T}=x,{props:k}=o,A=()=>c(_),E=v==null;E&&o.count++;const F={...k,style:k.toastStyle,key:o.toastKey++,...Object.fromEntries(Object.entries(x).filter(b=>{let[X,ne]=b;return ne!=null})),toastId:_,updateId:v,data:T,closeToast:A,isIn:!1,className:hh(x.className||k.toastClassName),bodyClassName:hh(x.bodyClassName||k.bodyClassName),progressClassName:hh(x.progressClassName||k.progressClassName),autoClose:!x.isLoading&&(O=x.autoClose,M=k.autoClose,O===!1||Sc(O)&&O>0?O:M),deleteToast(){const b=Jw(s.get(_),"removed");s.delete(_),An.emit(4,b);const X=o.queue.length;if(o.count=_==null?o.count-o.displayedToast:o.count-1,o.count<0&&(o.count=0),X>0){const ne=_==null?o.props.limit:1;if(X===1||ne===1)o.displayedToast++,u();else{const re=ne>X?X:ne;o.displayedToast=re;for(let se=0;se<re;se++)u()}}else t()}};var O,M;F.iconOut=function(b){let{theme:X,type:ne,isLoading:re,icon:se}=b,ue=null;const te={theme:X,type:ne};return se===!1||(nn(se)?ue=se(te):Y.isValidElement(se)?ue=Y.cloneElement(se,te):Ma(se)||Sc(se)?ue=se:re?ue=nm.spinner():(V=>V in nm)(ne)&&(ue=nm[ne](te))),ue}(F),nn(x.onOpen)&&(F.onOpen=x.onOpen),nn(x.onClose)&&(F.onClose=x.onClose),F.closeButton=k.closeButton,x.closeButton===!1||rm(x.closeButton)?F.closeButton=x.closeButton:x.closeButton===!0&&(F.closeButton=!rm(k.closeButton)||k.closeButton);let j=d;Y.isValidElement(d)&&!Ma(d.type)?j=Y.cloneElement(d,{closeToast:A,toastProps:F,data:T}):nn(d)&&(j=d({closeToast:A,toastProps:F,data:T})),k.limit&&k.limit>0&&o.count>k.limit&&E?o.queue.push({toastContent:j,toastProps:F,staleId:g}):Sc(p)?setTimeout(()=>{h(j,F,g)},p):h(j,F,g)}function h(d,m,p){const{toastId:g}=m;p&&s.delete(p);const x={content:d,props:m};s.set(g,x),n(_=>[..._,g].filter(v=>v!==p)),An.emit(4,Jw(x,x.props.updateId==null?"added":"updated"))}return Y.useEffect(()=>(o.containerId=e.containerId,An.cancelEmit(3).on(0,f).on(1,d=>i.current&&c(d)).on(5,l).emit(2,o),()=>{s.clear(),An.emit(3,o)}),[]),Y.useEffect(()=>{o.props=e,o.isToastActive=a,o.displayedToast=r.length}),{getToastToRender:function(d){const m=new Map,p=Array.from(s.values());return e.newestOnTop&&p.reverse(),p.forEach(g=>{const{position:x}=g.props;m.has(x)||m.set(x,[]),m.get(x).push(g)}),Array.from(m,g=>d(g[0],g[1]))},containerRef:i,isToastActive:a}}function Zw(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientX:e.clientX}function eT(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientY:e.clientY}function lG(e){const[t,r]=Y.useState(!1),[n,i]=Y.useState(!1),s=Y.useRef(null),a=Y.useRef({start:0,x:0,y:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,boundingRect:null,didMove:!1}).current,o=Y.useRef(e),{autoClose:l,pauseOnHover:c,closeToast:u,onClick:f,closeOnClick:h}=e;function d(T){if(e.draggable){T.nativeEvent.type==="touchstart"&&T.nativeEvent.preventDefault(),a.didMove=!1,document.addEventListener("mousemove",x),document.addEventListener("mouseup",_),document.addEventListener("touchmove",x),document.addEventListener("touchend",_);const k=s.current;a.canCloseOnClick=!0,a.canDrag=!0,a.boundingRect=k.getBoundingClientRect(),k.style.transition="",a.x=Zw(T.nativeEvent),a.y=eT(T.nativeEvent),e.draggableDirection==="x"?(a.start=a.x,a.removalDistance=k.offsetWidth*(e.draggablePercent/100)):(a.start=a.y,a.removalDistance=k.offsetHeight*(e.draggablePercent===80?1.5*e.draggablePercent:e.draggablePercent/100))}}function m(T){if(a.boundingRect){const{top:k,bottom:A,left:E,right:F}=a.boundingRect;T.nativeEvent.type!=="touchend"&&e.pauseOnHover&&a.x>=E&&a.x<=F&&a.y>=k&&a.y<=A?g():p()}}function p(){r(!0)}function g(){r(!1)}function x(T){const k=s.current;a.canDrag&&k&&(a.didMove=!0,t&&g(),a.x=Zw(T),a.y=eT(T),a.delta=e.draggableDirection==="x"?a.x-a.start:a.y-a.start,a.start!==a.x&&(a.canCloseOnClick=!1),k.style.transform=`translate${e.draggableDirection}(${a.delta}px)`,k.style.opacity=""+(1-Math.abs(a.delta/a.removalDistance)))}function _(){document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",_),document.removeEventListener("touchmove",x),document.removeEventListener("touchend",_);const T=s.current;if(a.canDrag&&a.didMove&&T){if(a.canDrag=!1,Math.abs(a.delta)>a.removalDistance)return i(!0),void e.closeToast();T.style.transition="transform 0.2s, opacity 0.2s",T.style.transform=`translate${e.draggableDirection}(0)`,T.style.opacity="1"}}Y.useEffect(()=>{o.current=e}),Y.useEffect(()=>(s.current&&s.current.addEventListener("d",p,{once:!0}),nn(e.onOpen)&&e.onOpen(Y.isValidElement(e.children)&&e.children.props),()=>{const T=o.current;nn(T.onClose)&&T.onClose(Y.isValidElement(T.children)&&T.children.props)}),[]),Y.useEffect(()=>(e.pauseOnFocusLoss&&(document.hasFocus()||g(),window.addEventListener("focus",p),window.addEventListener("blur",g)),()=>{e.pauseOnFocusLoss&&(window.removeEventListener("focus",p),window.removeEventListener("blur",g))}),[e.pauseOnFocusLoss]);const v={onMouseDown:d,onTouchStart:d,onMouseUp:m,onTouchEnd:m};return l&&c&&(v.onMouseEnter=g,v.onMouseLeave=p),h&&(v.onClick=T=>{f&&f(T),a.canCloseOnClick&&u()}),{playToast:p,pauseToast:g,isRunning:t,preventExitTransition:n,toastRef:s,eventHandlers:v}}function s4(e){let{closeToast:t,theme:r,ariaLabel:n="close"}=e;return Se.createElement("button",{className:`Toastify__close-button Toastify__close-button--${r}`,type:"button",onClick:i=>{i.stopPropagation(),t(i)},"aria-label":n},Se.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Se.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function cG(e){let{delay:t,isRunning:r,closeToast:n,type:i="default",hide:s,className:a,style:o,controlledProgress:l,progress:c,rtl:u,isIn:f,theme:h}=e;const d=s||l&&c===0,m={...o,animationDuration:`${t}ms`,animationPlayState:r?"running":"paused",opacity:d?0:1};l&&(m.transform=`scaleX(${c})`);const p=Es("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${h}`,`Toastify__progress-bar--${i}`,{"Toastify__progress-bar--rtl":u}),g=nn(a)?a({rtl:u,type:i,defaultClassName:p}):Es(p,a);return Se.createElement("div",{role:"progressbar","aria-hidden":d?"true":"false","aria-label":"notification timer",className:g,style:m,[l&&c>=1?"onTransitionEnd":"onAnimationEnd"]:l&&c<1?null:()=>{f&&n()}})}const uG=e=>{const{isRunning:t,preventExitTransition:r,toastRef:n,eventHandlers:i}=lG(e),{closeButton:s,children:a,autoClose:o,onClick:l,type:c,hideProgressBar:u,closeToast:f,transition:h,position:d,className:m,style:p,bodyClassName:g,bodyStyle:x,progressClassName:_,progressStyle:v,updateId:T,role:k,progress:A,rtl:E,toastId:F,deleteToast:O,isIn:M,isLoading:j,iconOut:b,closeOnClick:X,theme:ne}=e,re=Es("Toastify__toast",`Toastify__toast-theme--${ne}`,`Toastify__toast--${c}`,{"Toastify__toast--rtl":E},{"Toastify__toast--close-on-click":X}),se=nn(m)?m({rtl:E,position:d,type:c,defaultClassName:re}):Es(re,m),ue=!!A||!o,te={closeToast:f,type:c,theme:ne};let V=null;return s===!1||(V=nn(s)?s(te):Y.isValidElement(s)?Y.cloneElement(s,te):s4(te)),Se.createElement(h,{isIn:M,done:O,position:d,preventExitTransition:r,nodeRef:n},Se.createElement("div",{id:F,onClick:l,className:se,...i,style:p,ref:n},Se.createElement("div",{...M&&{role:k},className:nn(g)?g({type:c}):Es("Toastify__toast-body",g),style:x},b!=null&&Se.createElement("div",{className:Es("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!j})},b),Se.createElement("div",null,a)),V,Se.createElement(cG,{...T&&!ue?{key:`pb-${T}`}:{},rtl:E,theme:ne,delay:o,isRunning:t,isIn:M,closeToast:f,hide:u,type:c,style:v,className:_,controlledProgress:ue,progress:A||0})))},bd=function(e,t){return t===void 0&&(t=!1),{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}},fG=Ld(bd("bounce",!0));Ld(bd("slide",!0));Ld(bd("zoom"));Ld(bd("flip"));const xu=Y.forwardRef((e,t)=>{const{getToastToRender:r,containerRef:n,isToastActive:i}=oG(e),{className:s,style:a,rtl:o,containerId:l}=e;function c(u){const f=Es("Toastify__toast-container",`Toastify__toast-container--${u}`,{"Toastify__toast-container--rtl":o});return nn(s)?s({position:u,rtl:o,defaultClassName:f}):Es(f,hh(s))}return Y.useEffect(()=>{t&&(t.current=n.current)},[]),Se.createElement("div",{ref:n,className:"Toastify",id:l},r((u,f)=>{const h=f.length?{...a}:{...a,pointerEvents:"none"};return Se.createElement("div",{className:c(u),style:h,key:`container-${u}`},f.map((d,m)=>{let{content:p,props:g}=d;return Se.createElement(uG,{...g,isIn:i(g.toastId),style:{...g.style,"--nth":m+1,"--len":f.length},key:`toast-${g.key}`},p)}))}))});xu.displayName="ToastContainer",xu.defaultProps={position:"top-right",transition:fG,autoClose:5e3,closeButton:s4,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,draggable:!0,draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};let im,sa=new Map,ec=[],hG=1;function a4(){return""+hG++}function dG(e){return e&&(Ma(e.toastId)||Sc(e.toastId))?e.toastId:a4()}function Ic(e,t){return sa.size>0?An.emit(0,e,t):ec.push({content:e,options:t}),t.toastId}function S0(e,t){return{...t,type:t&&t.type||e,toastId:dG(t)}}function zf(e){return(t,r)=>Ic(t,S0(e,r))}function We(e,t){return Ic(e,S0("default",t))}We.loading=(e,t)=>Ic(e,S0("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t})),We.promise=function(e,t,r){let n,{pending:i,error:s,success:a}=t;i&&(n=Ma(i)?We.loading(i,r):We.loading(i.render,{...r,...i}));const o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(u,f,h)=>{if(f==null)return void We.dismiss(n);const d={type:u,...o,...r,data:h},m=Ma(f)?{render:f}:f;return n?We.update(n,{...d,...m}):We(m.render,{...d,...m}),h},c=nn(e)?e():e;return c.then(u=>l("success",a,u)).catch(u=>l("error",s,u)),c},We.success=zf("success"),We.info=zf("info"),We.error=zf("error"),We.warning=zf("warning"),We.warn=We.warning,We.dark=(e,t)=>Ic(e,S0("default",{theme:"dark",...t})),We.dismiss=e=>{sa.size>0?An.emit(1,e):ec=ec.filter(t=>e!=null&&t.options.toastId!==e)},We.clearWaitingQueue=function(e){return e===void 0&&(e={}),An.emit(5,e)},We.isActive=e=>{let t=!1;return sa.forEach(r=>{r.isToastActive&&r.isToastActive(e)&&(t=!0)}),t},We.update=function(e,t){t===void 0&&(t={}),setTimeout(()=>{const r=function(n,i){let{containerId:s}=i;const a=sa.get(s||im);return a&&a.getToast(n)}(e,t);if(r){const{props:n,content:i}=r,s={delay:100,...n,...t,toastId:t.toastId||e,updateId:a4()};s.toastId!==e&&(s.staleId=e);const a=s.render||i;delete s.render,Ic(a,s)}},0)},We.done=e=>{We.update(e,{progress:1})},We.onChange=e=>(An.on(4,e),()=>{An.off(4,e)}),We.POSITION={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",TOP_CENTER:"top-center",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",BOTTOM_CENTER:"bottom-center"},We.TYPE={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error",DEFAULT:"default"},An.on(2,e=>{im=e.containerId||e,sa.set(im,e),ec.forEach(t=>{An.emit(0,t.content,t.options)}),ec=[]}).on(3,e=>{sa.delete(e.containerId||e),sa.size===0&&An.off(0).off(1).off(5)});const pG=e=>/^\d{4}-W\d{2}$/.test(e);function sm(e){let t=e.toLowerCase();return t=t.replace(/[áäâà]/g,"a").replace(/[éëêè]/g,"e").replace(/[íïîì]/g,"i").replace(/[óöôò]/g,"o").replace(/[úüûù]/g,"u").replace(/[^\w\s]/g,"").replace(/\s+/g,"_"),t}function mG(){const[e,t]=Y.useState([]),[r,n]=Y.useState(null),[i,s]=Y.useState(!1),a=Ln(),{control:o,handleSubmit:l,reset:c}=Pd({defaultValues:{week:"",team:""}}),u=h=>{const d=new FileReader;d.readAsBinaryString(h.target.files[0]),d.onload=m=>{const p=m.target.result,g=Gg(p,{type:"binary"}),x=[];["Impacto","Impacto ácido"].forEach(v=>{if(g.SheetNames.includes(v)){const T=g.Sheets[v],k=sG.sheet_to_json(T),A=k.length>0?Object.keys(k[0]):[],E=k.map(F=>{const O={};return A.forEach(M=>{O[sm(M)]=F[M]}),O});x.push({sheetName:v,data:E})}}),t(x)}},f=async h=>{try{const d=localStorage.getItem("userEmail"),m="RECIBIDO-MSMIN",{week:p,team:g}=h;if(!g||!pG(p)){We.error("Ha ocurrido un error: Debe completar campos de equipo, semana y seleccionar un archivo.");return}s(!0);const x=e.filter(M=>sm(M.sheetName)===g),_={created_at:new Date,created_by:d,team:g,week_name:p,file_name:`${p}.xlsx`},v=await _9(_),T=x[0].data,k=Object.values(T[0]).map(M=>sm(M)),E=T.slice(1).map(M=>{const j={};return k.forEach((b,X)=>{j[b]=Object.values(M)[X]||null}),j.week_id=v.id,j.week_name=p,j.created_by=d,j.created_at=new Date,j.current_status=m,x9(j)}),F=await Promise.all(E),O=F.map(M=>{const j={created_at:new Date,created_by:d,status:m,description:"",activity:M.id};return E9(j)});await Promise.all(O),A9(r,p),s(!1),t(F),We.success("Priorización importada correctamente"),c({week:"",team:""}),setTimeout(()=>{a("/home")},2e3)}catch(d){console.error("Error:",d),We.error(`Ha ocurrido un error: ${d.message}`),s(!1)}};return y.jsx("form",{onSubmit:l(f),className:"container mt-5",children:y.jsx("div",{className:"d-flex justify-content-center",children:y.jsx("div",{className:"col-md-7",children:y.jsx("div",{className:"card",children:y.jsxs("div",{className:"card-body",children:[y.jsx("h2",{className:"text-center mb-4",children:"CARGAR PRIORIZACIÓN"}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"week",children:"Semana:"}),y.jsx(Os,{name:"week",control:o,render:({field:h})=>y.jsx("input",{...h,type:"text",id:"week",placeholder:"Ejemplo: 2023-W37",className:"form-control mb-3",required:!0})})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"team",children:"Equipo:"}),y.jsx(Os,{name:"team",control:o,render:({field:h})=>y.jsxs("select",{...h,className:"form-control mb-3",id:"team",children:[y.jsx("option",{value:"",defaultValue:!0,children:"Seleccione un equipo"}),y.jsx("option",{value:"impacto",children:"Impacto"}),y.jsx("option",{value:"impacto_acido",children:"Impacto Acido"})]})})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"file",children:"Archivo:"}),y.jsx(Os,{name:"file",control:o,render:({field:h})=>y.jsx("input",{...h,type:"file",id:"file",className:"form-control mb-3",onChange:d=>{n(d.target.files[0]),u(d)}})})]}),y.jsx("div",{className:"form-group d-flex text-center justify-content-center",children:y.jsx("button",{type:"submit",className:"btn btn-dark btn-block text-center mt-3",disabled:i,children:i?y.jsx(xi,{}):"CARGAR PRIORIZACIÓN"})}),y.jsx(xu,{class:"custom-toast",position:"top-right",autoClose:3e3,hideProgressBar:!0})]})})})})})}function gG(){const e=Ln(),t=()=>{e("/home")};return y.jsxs(y.Fragment,{children:[y.jsx(Xu,{}),y.jsxs("section",{id:"upload-activities",children:[y.jsx(mG,{}),y.jsx("div",{className:"d-flex justify-content-center mt-5",children:y.jsx(_l,{text:"VOLVER",icon:"bi bi-arrow-return-left",marginClassName:"mb-5",btnClassName:"btn-link",onClick:t})})]})]})}function o4({documentId:e}){var s,a;const[t,r]=Y.useState({}),[n,i]=Y.useState(!0);return Y.useEffect(()=>{(async()=>{try{const l=await w9();console.log(l);const c=l.find(u=>(u==null?void 0:u.data.activity)===e);r(c),i(!1)}catch(l){console.error("Error al obtener datos: ",l)}})()},[e]),n?y.jsx(xi,{}):y.jsx("div",{className:"row justify-content-center",children:y.jsx("div",{className:"col-xl",children:y.jsx("div",{className:"card",children:y.jsxs("div",{className:"card-body",children:[y.jsx("h2",{className:"text-center mb-4",children:"ESTADO IMPACTO"}),y.jsxs("dl",{className:"dl-horizontal",children:[y.jsx("dt",{children:"Estado:"}),y.jsx("dd",{children:(s=t==null?void 0:t.data)==null?void 0:s.status})]}),y.jsx("dt",{children:"Descripción:"}),y.jsx("dd",{children:(a=t==null?void 0:t.data)==null?void 0:a.description})]})})})})}o4.propTypes={documentId:at.string.isRequired};function l4({documentId:e}){const{control:t,handleSubmit:r,reset:n}=Pd({defaultValues:{status:"",description:""}}),[i,s]=Y.useState(!1),a=Ln(),o=async l=>{try{const c=localStorage.getItem("userEmail"),{status:u,description:f}=l;if(!u||!f){We.error("Ha ocurrido un error: Debe completar el estado y la descripción.");return}const h={created_by:c,created_at:new Date,status:u,description:f};s(!0),await T9(e,h),await k9(e,l.status),s(!1),We.success("Estado actualizado exitosamente"),n({status:"",description:""}),setTimeout(()=>{a("/home")},2e3)}catch(c){console.error("Error:",c),We.error(`Ha ocurrido un error: ${c.message}`),s(!1)}};return y.jsx("form",{onSubmit:r(o),className:"container mt-5",children:y.jsx("div",{className:"row justify-content-center",children:y.jsx("div",{className:"col-xl",children:y.jsx("div",{className:"card",children:y.jsxs("div",{className:"card-body",children:[y.jsx("h2",{className:"text-center mb-4",children:" ACTUALIZAR ESTADO IMPACTO"}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"status",children:"Ingresar Estado:"}),y.jsx(Os,{name:"status",control:t,render:({field:l})=>y.jsxs("select",{...l,className:"form-control mb-3",id:"status",children:[y.jsx("option",{value:"",defaultValue:!0,children:"Seleccione un Estado"}),y.jsx("option",{value:"ACEPTADO",children:"Aceptado"}),y.jsx("option",{value:"RECHAZADO",children:"Rechazado"}),y.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),y.jsx("option",{value:"PROGRAMADO",children:"Programado"}),y.jsx("option",{value:"EJECUTADO",children:"Ejecutado"}),y.jsx("option",{value:"REPETIDO",children:"Repetido"}),y.jsx("option",{value:"OTRO",children:"Otro"})]})})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"description",children:"Descripción u observación:"}),y.jsx(Os,{name:"description",control:t,render:({field:l})=>y.jsx("textarea",{...l,id:"description",className:"form-control mb-3",placeholder:"Escribe una descripción"})})]}),y.jsx("div",{className:"form-group d-flex text-center justify-content-center",children:y.jsx("button",{type:"submit",className:"btn btn-dark btn-block text-center mt-3",disabled:i,children:i?y.jsx(xi,{}):"ACTUALIZAR ESTADO IMPACTO"})}),y.jsx(xu,{className:"custom-toast",position:"top-right",autoClose:3e3,hideProgressBar:!0})]})})})})})}l4.propTypes={documentId:at.string.isRequired};function vG(){const e=Ln(),{documentId:t}=K1(),r=()=>{e("/home")};return y.jsxs(y.Fragment,{children:[y.jsx(Xu,{}),y.jsxs("section",{id:"update-activity-status",children:[y.jsx("div",{className:"container",children:y.jsxs("div",{className:"row",children:[y.jsx("div",{className:"col-md-6 mt-5",children:y.jsx(o4,{documentId:t})}),y.jsx("div",{className:"col-md-6",children:y.jsx(l4,{documentId:t})})]})}),y.jsx("div",{className:"d-flex justify-content-center mt-5",children:y.jsx(_l,{text:"VOLVER",icon:"bi bi-arrow-return-left",marginClassName:"mb-5",btnClassName:"btn-link",onClick:r})})]})]})}const _G=()=>new Promise((e,t)=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(r=>{const{latitude:n,longitude:i}=r.coords;e(`${n}, ${i}`)},r=>{t(r)}):t(new Error("Geolocation is not available in this browser."))});function c4({documentId:e}){const[t,r]=Y.useState(""),[n,i]=Y.useState(""),[s,a]=Y.useState(!1),[o,l]=Y.useState(!1),c=Ln(),{control:u,handleSubmit:f,reset:h,setValue:d}=Pd({defaultValues:{activity_log_description:""}}),{fields:m,append:p,remove:g}=$9({control:u,name:"activity_log_files"});Y.useEffect(()=>{x()||We.error("Speech recognition is not supported in this browser.")},[]);const x=()=>"SpeechRecognition"in window||"webkitSpeechRecognition"in window||"mozSpeechRecognition"in window||"msSpeechRecognition"in window,_=async()=>{try{const E=await _G();r(E)}catch(E){console.error("Error getting GPS coordinates:",E),We.error(`Error getting GPS coordinates: ${E.message}`)}},v=()=>{if(s)T();else try{const E=window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition,F=new E;F.continuous=!0,F.onresult=O=>{const M=O.results[0][0].transcript;i(M),T(),console.log(n)},F.start(),a(!0)}catch(E){console.error("Error starting speech recognition:",E),We.error(`Error starting speech recognition: ${E.message}`)}},T=()=>{a(!1)},k=s?y.jsxs(y.Fragment,{children:[y.jsx("i",{className:"bi bi-mic-mute align-middle"})," DETENER GRABACIÓN POR VOZ"]}):y.jsxs(y.Fragment,{children:[y.jsx("i",{className:"bi bi-mic align-middle"})," INICIAR GRABACIÓN POR VOZ"]}),A=async E=>{try{const F=localStorage.getItem("userEmail");if(!t||!n){We.error("Ha ocurrido un error: Debe completar las coordenadas GPS y la descripción del registro.");return}const O={activity:e,activity_log_written_by:F,activity_log_creation_date:new Date,activity_log_GPS:t,activity_log_description:n,activity_log_file_names:[]};if(l(!0),E.activity_log_files&&E.activity_log_files.length>0)for(let M=0;M<E.activity_log_files.length;M++){const j=E.activity_log_files[M];await I9([j]),O.activity_log_file_names.push(j.name)}l(!1),await S9(e,O),We.success("Registro ingresado exitosamente"),h({activity_log_GPS:"",activity_log_description:"",activity_log_files:[]}),setTimeout(()=>{c("/home")},2e3)}catch(F){console.error("Error:",F),We.error(`Ha ocurrido un error: ${F.message}`),l(!1)}};return y.jsxs(y.Fragment,{children:[y.jsx("form",{onSubmit:f(A),className:"container mt-5",children:y.jsx("div",{className:"row justify-content-center",children:y.jsx("div",{className:"col-md-7",children:y.jsxs("div",{className:"card",children:[y.jsxs("div",{className:"card-body",children:[y.jsx("h2",{className:"text-center mb-4",children:" INGRESAR REGISTRO"}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"activity_log_GPS",children:"GPS:"}),y.jsx(Os,{name:"activity_log_GPS",control:u,render:({field:E})=>y.jsx("textarea",{...E,id:"activity_log_GPS",className:"form-control",placeholder:"Ingrese las coordenadas GPS.",value:t})}),y.jsx("div",{className:"input-group-append",children:y.jsxs("button",{className:"btn btn-dark mt-2 mb-3",type:"button",onClick:_,children:[y.jsx("i",{className:"bi bi-geo-alt align-middle"})," OBTENER GPS"]})})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"activity_log_description",children:"Descripción del registro:"}),y.jsx(Os,{name:"activity_log_description",control:u,defaultValue:"",render:({field:E})=>y.jsx("textarea",{...E,id:"activity_log_description",className:"form-control",placeholder:"Ingrese descripción del registro.",value:n,onChange:F=>{i(F.target.value),E.onChange(F)}})})]}),y.jsx("div",{className:"form-group",children:y.jsx("button",{type:"button",className:"btn btn-dark mt-2 mb-3",onClick:v,children:k})}),y.jsxs("div",{className:"form-group mt-2 mb-3 d-flex flex-column ",children:[y.jsxs("label",{children:["Imagen/es ",y.jsx("span",{className:"text-muted",children:"(opcional)"}),":"]}),m.map((E,F)=>y.jsxs("div",{className:"d-flex mb-2",children:[y.jsx(Os,{name:`activity_log_files_${F}`,control:u,render:({field:O})=>y.jsx("input",{...O,type:"file",className:"form-control",onChange:M=>{d(`activity_log_files[${F}]`,M.target.files[0])}})}),y.jsx("button",{type:"button",className:"btn btn-danger ms-2",onClick:()=>g(F),children:y.jsx("i",{className:"bi bi-x-circle align-middle"})})]},E.id)),y.jsx("div",{children:y.jsxs("button",{type:"button",className:"btn btn-success",onClick:()=>p({}),children:[y.jsx("i",{className:"bi bi-plus-circle align-middle"})," AGREGAR"]})})]})]}),y.jsx("div",{className:"form-group d-flex text-center justify-content-center",children:y.jsx("button",{type:"submit",className:"btn btn-dark btn-block mb-4",disabled:o,children:o?y.jsx(y.Fragment,{children:y.jsx(xi,{})}):"INGRESAR REGISTRO"})})]})})})}),y.jsx(xu,{className:"custom-toast",position:"top-right",autoClose:3e3,hideProgressBar:!0})]})}c4.propTypes={documentId:at.string.isRequired};function xG(){const e=Ln(),{documentId:t}=K1(),r=()=>{e("/home")};return y.jsxs(y.Fragment,{children:[y.jsx(Xu,{}),y.jsxs("section",{id:"upload-activity-log",children:[y.jsx(c4,{documentId:t}),y.jsx("div",{className:"d-flex justify-content-center mt-5",children:y.jsx(_l,{text:"VOLVER",icon:"bi bi-arrow-return-left",marginClassName:"mb-5",btnClassName:"btn-link",onClick:r})})]})]})}function u4({isLoading:e,weekDocument:t,activityDocument:r}){var n,i,s,a,o,l,c;return y.jsx(y.Fragment,{children:e?y.jsx(xi,{}):y.jsxs("div",{className:"table-responsive",children:[y.jsx("h1",{className:"my-2 text-center mt-3 mb-3",children:"Información de Actividad"}),y.jsx("table",{className:"table table-hover table-bordered",children:y.jsxs("tbody",{children:[y.jsxs("tr",{children:[y.jsx("th",{scope:"row",children:"Empresa:"}),y.jsx("td",{children:(t==null?void 0:t.data.team)==="impacto_acido"?"Impacto Ácido":(t==null?void 0:t.data.team)==="impacto"?"Impacto":t==null?void 0:t.data.team}),y.jsx("th",{scope:"row",children:"Semana:"}),y.jsxs("td",{children:[" ",t==null?void 0:t.data.week_name," "]})]}),y.jsxs("tr",{children:[y.jsx("th",{scope:"row",children:"Fecha de creación:"}),y.jsxs("td",{children:[" ",t.data.created_at.toDate().toLocaleString()," "]}),y.jsx("th",{scope:"row",children:"Creado por:"}),y.jsxs("td",{children:[" ",t.data.created_by]})]}),y.jsxs("tr",{children:[y.jsx("th",{scope:"row",children:"Prioridad:"}),y.jsx("td",{colSpan:3,children:(n=r.data)==null?void 0:n.prioridad})]}),y.jsxs("tr",{children:[y.jsx("th",{scope:"row",children:"N° Aviso:"}),y.jsx("td",{colSpan:3,children:(i=r.data)==null?void 0:i.n_aviso})]}),y.jsxs("tr",{children:[y.jsx("th",{scope:"row",children:"Equipo o Sistema: "}),y.jsx("td",{colSpan:3,children:(s=r.data)==null?void 0:s.equipo_o_sistema})]}),y.jsxs("tr",{children:[y.jsx("th",{scope:"row",children:"Unidad Técnica:"}),y.jsx("td",{colSpan:3,children:(a=r.data)==null?void 0:a.u_tecnica})]}),y.jsxs("tr",{children:[y.jsx("th",{scope:"row",children:"Descripción del Trabajo:"}),y.jsx("td",{colSpan:3,children:(o=r.data)==null?void 0:o.descripcion_del_trabajo})]}),y.jsxs("tr",{children:[y.jsx("th",{scope:"row",children:"Descripción del Aviso:"}),y.jsx("td",{colSpan:3,children:(l=r.data)==null?void 0:l.descripcion_del_aviso})]}),y.jsxs("tr",{children:[y.jsx("th",{scope:"row",children:"Vulnerabilidad"}),y.jsxs("td",{colSpan:3,children:[(c=r.data)==null?void 0:c.vulnerabilidad_1," "]})]})]})})]})})}u4.propTypes={isLoading:at.bool,weekDocument:at.object,activityDocument:at.object,activityStatusDocument:at.object,activityLogDocument:at.object};function f4({isLoading:e,activityStatusDocument:t}){var r;return y.jsx("div",{children:e?y.jsx(xi,{}):y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"table-responsive",children:[y.jsx("h1",{className:"my-2 text-center mt-3 mb-3",children:"Estado Impacto Actual"}),y.jsx("table",{className:"table table-hover table-bordered",children:y.jsxs("tbody",{children:[y.jsxs("tr",{children:[y.jsx("th",{scope:"row",children:"Fecha de creación:"}),y.jsx("td",{children:t==null?void 0:t.data.created_at.toDate().toLocaleString()})]}),y.jsxs("tr",{children:[y.jsx("th",{scope:"row",children:"Estado actual:"}),y.jsx("td",{children:t==null?void 0:t.data.status})]}),y.jsxs("tr",{children:[y.jsx("th",{scope:"row",children:"Descripción:"}),y.jsx("td",{children:t!=null&&t.data.description?t.data.description:"Sin descripción."})]}),y.jsxs("tr",{children:[y.jsx("th",{scope:"row",children:"Creado por:"}),y.jsx("td",{children:t==null?void 0:t.data.created_by})]})]})})]}),y.jsxs("div",{className:"mt-4",children:[y.jsx("h2",{children:"Historial de Estados:"}),y.jsx("div",{className:"table-responsive",children:y.jsxs("table",{className:"table table-hover table-bordered",children:[y.jsx("thead",{children:y.jsxs("tr",{className:"align-middle",children:[y.jsx("th",{children:"Fecha de creación"}),y.jsx("th",{children:"Estado"}),y.jsx("th",{children:"Descripción"}),y.jsx("th",{children:"Creado por"})]})}),y.jsx("tbody",{children:(r=t==null?void 0:t.data)!=null&&r.status_history?t.data.status_history.filter(n=>n&&n.previous_created_at).slice().sort((n,i)=>i.previous_created_at-n.previous_created_at).map((n,i)=>y.jsxs("tr",{children:[y.jsx("td",{children:n.previous_created_at.toDate().toLocaleString()}),y.jsx("td",{children:n.previous_status}),y.jsx("td",{children:n.previous_status_description?n.previous_status_description:"Sin descripción."}),y.jsx("td",{children:n.previous_created_by})]},i)):y.jsx("tr",{children:y.jsx("td",{colSpan:"4",children:"No hay historial de estados disponible."})})})]})})]})]})})}f4.propTypes={isLoading:at.bool,activityStatusDocument:at.object};function h4({activityLogDocument:e}){const[t,r]=Y.useState([]),[n,i]=Y.useState([]),[s,a]=Y.useState(""),[o,l]=Y.useState(!1),c=Y.useRef(null),[u,f]=Y.useState({});Y.useEffect(()=>{f(e)},[e]),Y.useEffect(()=>{u.data&&u.data.activity_log_file_names&&r(u.data.activity_log_file_names)},[u]),Y.useEffect(()=>{const p=async()=>{const g=await Promise.all(t.map(async x=>await tC(x)));i(g)};t.length>0&&p()},[t]);const h=p=>{a(p),l(!0)},d=()=>{a(""),l(!1)},m=()=>{c.current.click()};return y.jsxs("div",{className:"container",children:[y.jsx("h1",{children:"Imágenes:"}),n.length===0?y.jsx("p",{children:"Sin imágenes disponibles."}):y.jsx("div",{className:"row",children:n.map((p,g)=>y.jsx("div",{className:"col-md-4 mb-4",children:y.jsx("div",{className:"card",style:{width:"15rem",height:"15rem"},children:y.jsx("img",{src:p,alt:`Image ${g}`,className:"card-img-top h-100",style:{objectFit:"cover"},onClick:()=>h(p)})})},g))}),o&&y.jsx("div",{className:"modal fade show",style:{display:"block"},tabIndex:"-1",children:y.jsx("div",{className:"modal-dialog modal-lg",children:y.jsxs("div",{className:"modal-content",children:[y.jsx("div",{className:"modal-header",children:y.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:d})}),y.jsxs("div",{className:"modal-body",children:[y.jsx("img",{src:s,alt:"Selected Image",className:"img-fluid"}),y.jsxs("div",{className:"d-grid mt-2 mb-2",children:[y.jsx("a",{ref:c,href:s,download:"nombre-de-la-imagen.jpg",target:"_blank",rel:"noopener noreferrer",style:{display:"none"}}),y.jsx("button",{type:"button",className:"btn btn-dark mt-2",onClick:m,children:"VER IMAGEN EN TAMAÑO COMPLETO"})]})]})]})})})]})}h4.propTypes={activityLogDocument:at.object};function d4({activityLogDocument:e,activityId:t,closeModal:r}){const[n,i]=Y.useState([]),[s,a]=Y.useState([]),[o,l]=Y.useState(!1);return Y.useEffect(()=>{if(console.log(t),e&&t){const c=e.data.history.find(u=>u.activity_id===t);c?i(c.activity_log_file_names||[]):console.log(`No log found for activityId: ${t}`)}},[e,t]),Y.useEffect(()=>{const c=async()=>{try{l(!0);const u=await Promise.all(n.map(async f=>await tC(f)));a(u)}catch(u){console.error("Error fetching image URLs:",u)}finally{l(!1)}};n.length>0&&c()},[n]),y.jsx("div",{className:"container",children:y.jsx("div",{className:"modal fade show",style:{display:"block"},tabIndex:"-1",children:y.jsx("div",{className:"modal-dialog modal-lg",children:y.jsxs("div",{className:"modal-content",children:[y.jsx("div",{className:"modal-header",children:y.jsx("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:r})}),y.jsxs("div",{className:"modal-body",children:[y.jsx("h1",{className:"text-center mb-4",children:"GALERÍA DE IMÁGENES"}),o?y.jsx(xi,{}):y.jsx("div",{className:"row d-flex justify-content-center",children:s.length>0?s.map((c,u)=>y.jsx("div",{className:"col-md-4 mb-4",children:y.jsx("div",{className:"card",style:{width:"15rem",height:"15rem"},children:y.jsx("img",{src:c,alt:`Image ${u}`,className:"card-img-top h-100",style:{objectFit:"cover"}})})},u)):y.jsx("p",{children:"Sin imágenes disponibles"})})]})]})})})})}d4.propTypes={activityLogDocument:at.object,activityId:at.string,closeModal:at.func.isRequired};function p4({isLoading:e,activityLogDocument:t}){var u,f,h,d,m,p;const r=!!((u=t==null?void 0:t.data)!=null&&u.activity_log_GPS),[n,i]=Y.useState(!1),[s,a]=Y.useState(null),o=g=>{a(g),i(!0)},l=()=>{a(null),i(!1)};if(!t||!t.data)return y.jsx("div",{children:e?y.jsx(xi,{}):y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"table-responsive",children:[y.jsx("h1",{className:"my-2 text-center mt-3 mb-3",children:"Registro Actual"}),y.jsx("table",{className:"table table-hover table-bordered",children:y.jsx("tbody",{children:y.jsx("tr",{children:y.jsx("td",{colSpan:"2",children:"Sin registros disponibles"})})})})]}),y.jsxs("div",{className:"mt-4",children:[y.jsx("h2",{children:"Historial de Registros:"}),y.jsx("div",{className:"table-responsive",children:y.jsx("table",{className:"table table-hover table-bordered",children:y.jsx("tbody",{children:y.jsx("tr",{children:y.jsx("td",{colSpan:"2",children:"Sin historial de registros disponible"})})})})})]})]})});const c=t.data.history&&t.data.history.length>0;return y.jsx("div",{children:e?y.jsx(xi,{}):y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"table-responsive",children:[y.jsx("h1",{className:"my-2 text-center mt-3 mb-3",children:"Registro Actual"}),y.jsx("table",{className:"table table-hover table-bordered",children:y.jsx("tbody",{children:r&&y.jsxs(y.Fragment,{children:[y.jsxs("tr",{children:[y.jsx("th",{scope:"row",children:"Fecha de creación:"}),y.jsx("td",{children:((h=(f=t==null?void 0:t.data)==null?void 0:f.activity_log_creation_date)==null?void 0:h.toDate().toLocaleString())||"Sin fecha"})]}),y.jsxs("tr",{children:[y.jsx("th",{scope:"row",children:"Descripción de Registro:"}),y.jsx("td",{children:((d=t==null?void 0:t.data)==null?void 0:d.activity_log_description)||"Sin descripción."})]}),y.jsxs("tr",{children:[y.jsx("th",{scope:"row",children:"Coordenadas GPS:"}),y.jsx("td",{children:(m=t==null?void 0:t.data)==null?void 0:m.activity_log_GPS})]}),y.jsxs("tr",{children:[y.jsx("th",{scope:"row",children:"Creado por:"}),y.jsx("td",{children:(p=t==null?void 0:t.data)==null?void 0:p.activity_log_written_by})]})]})})})]}),y.jsx(h4,{isLoading:e,activityLogDocument:t}),y.jsxs("div",{className:"mt-4",children:[y.jsx("h2",{children:"Historial de Registros:"}),y.jsx("div",{className:"table-responsive",children:y.jsxs("table",{className:"table table-hover table-bordered",children:[y.jsx("thead",{children:y.jsxs("tr",{className:"align-middle",children:[y.jsx("th",{children:"Fecha de creación"}),y.jsx("th",{children:"Descripción de Registro"}),y.jsx("th",{children:"Coordenadas GPS"}),y.jsx("th",{children:"Creado por"})]})}),y.jsx("tbody",{children:c?t.data.history.filter(g=>g&&g.activity_log_creation_date).slice().sort((g,x)=>x.activity_log_creation_date-g.activity_log_creation_date).map((g,x)=>{var _;return y.jsxs("tr",{children:[y.jsx("td",{children:(_=g==null?void 0:g.activity_log_creation_date)==null?void 0:_.toDate().toLocaleString()}),y.jsx("td",{children:(g==null?void 0:g.activity_log_description)||"Sin descripción."}),y.jsx("td",{children:g==null?void 0:g.activity_log_GPS}),y.jsx("td",{children:g==null?void 0:g.activity_log_written_by}),y.jsxs("td",{children:[y.jsx("button",{className:"btn btn-dark",onClick:()=>o(g.activity_id),children:"VER"}),n&&y.jsx(d4,{activityLogDocument:t,activityId:s,closeModal:l})]})]},x)}):y.jsx("tr",{children:y.jsx("td",{colSpan:"2",children:"Sin historial de registros disponible."})})})]})})]})]})})}p4.propTypes={isLoading:at.bool,activityLogDocument:at.object,documentId:at.string};function yG(){const{documentId:e}=K1(),[t,r]=Y.useState({}),[n,i]=Y.useState({}),[s,a]=Y.useState({}),[o,l]=Y.useState({}),[c,u]=Y.useState(!0),f=Ln();Y.useEffect(()=>{(async()=>{try{const[m,p,g,x]=await Promise.all([R9(),C9(),P9(),F9()]),_=m.find(A=>A.id===e),v=p.find(A=>A.id===(_==null?void 0:_.data.week_id)),T=g.find(A=>(A==null?void 0:A.data.activity)===e),k=x.find(A=>A.id===e);r(v),i(_),a(T),l(k),u(!1)}catch(m){console.error("Error al obtener documentos: ",m)}})()},[e]);const h=()=>{f("/home")};return y.jsxs(y.Fragment,{children:[y.jsx(Xu,{}),y.jsxs("section",{id:"view-dossier",children:[y.jsxs("div",{className:"container",children:[y.jsx(u4,{isLoading:c,weekDocument:t,activityDocument:n}),y.jsx(f4,{isLoading:c,activityStatusDocument:s}),y.jsx(p4,{isLoading:c,activityLogDocument:o})]}),y.jsx("div",{className:"d-flex justify-content-center mt-5",children:y.jsx(_l,{text:"VOLVER",icon:"bi bi-arrow-return-left",marginClassName:"mb-5",btnClassName:"btn-link",onClick:h})})]})]})}const EG=mk(document.getElementById("root"));function Vl({element:e}){return eC()?e:y.jsx(Zm,{to:"/login",replace:!0})}EG.render(y.jsx(Se.StrictMode,{children:y.jsx(YN,{children:y.jsxs(zN,{children:[y.jsx(ts,{path:"/",element:eC()?y.jsx(Zm,{to:"/home",replace:!0}):y.jsx(Zm,{to:"/login"})}),y.jsx(ts,{path:"/home",element:y.jsx(Vl,{element:y.jsx(iV,{})})}),y.jsx(ts,{path:"/upload-activities",element:y.jsx(Vl,{element:y.jsx(gG,{})})}),y.jsx(ts,{path:"/update-activity-status/:documentId",element:y.jsx(Vl,{element:y.jsx(vG,{})})}),y.jsx(ts,{path:"/upload-activity-log/:documentId",element:y.jsx(Vl,{element:y.jsx(xG,{})})}),y.jsx(ts,{path:"/view-activity-info/:documentId",element:y.jsx(Vl,{element:y.jsx(yG,{})})}),y.jsx(ts,{path:"/login",element:y.jsx(Q9,{})})]})})}));
