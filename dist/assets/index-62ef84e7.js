function s4(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function jw(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var zw={exports:{}},y0={},Hw={exports:{}},ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hu=Symbol.for("react.element"),a4=Symbol.for("react.portal"),o4=Symbol.for("react.fragment"),l4=Symbol.for("react.strict_mode"),c4=Symbol.for("react.profiler"),u4=Symbol.for("react.provider"),f4=Symbol.for("react.context"),h4=Symbol.for("react.forward_ref"),d4=Symbol.for("react.suspense"),p4=Symbol.for("react.memo"),m4=Symbol.for("react.lazy"),$_=Symbol.iterator;function g4(e){return e===null||typeof e!="object"?null:(e=$_&&e[$_]||e["@@iterator"],typeof e=="function"?e:null)}var Ww={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Gw=Object.assign,Kw={};function Yo(e,t,r){this.props=e,this.context=t,this.refs=Kw,this.updater=r||Ww}Yo.prototype.isReactComponent={};Yo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Yo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function qw(){}qw.prototype=Yo.prototype;function Bg(e,t,r){this.props=e,this.context=t,this.refs=Kw,this.updater=r||Ww}var Ug=Bg.prototype=new qw;Ug.constructor=Bg;Gw(Ug,Yo.prototype);Ug.isPureReactComponent=!0;var j_=Array.isArray,Xw=Object.prototype.hasOwnProperty,$g={current:null},Yw={key:!0,ref:!0,__self:!0,__source:!0};function Qw(e,t,r){var n,i={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)Xw.call(t,n)&&!Yw.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:hu,type:e,key:s,ref:a,props:i,_owner:$g.current}}function v4(e,t){return{$$typeof:hu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function jg(e){return typeof e=="object"&&e!==null&&e.$$typeof===hu}function _4(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var z_=/\/+/g;function Pd(e,t){return typeof e=="object"&&e!==null&&e.key!=null?_4(""+e.key):t.toString(36)}function Vf(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case hu:case a4:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+Pd(a,0):n,j_(i)?(r="",e!=null&&(r=e.replace(z_,"$&/")+"/"),Vf(i,t,r,"",function(c){return c})):i!=null&&(jg(i)&&(i=v4(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(z_,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",j_(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+Pd(s,o);a+=Vf(s,t,r,l,i)}else if(l=g4(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+Pd(s,o++),a+=Vf(s,t,r,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Yu(e,t,r){if(e==null)return e;var n=[],i=0;return Vf(e,n,"","",function(s){return t.call(r,s,i++)}),n}function x4(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Gr={current:null},Bf={transition:null},y4={ReactCurrentDispatcher:Gr,ReactCurrentBatchConfig:Bf,ReactCurrentOwner:$g};ze.Children={map:Yu,forEach:function(e,t,r){Yu(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Yu(e,function(){t++}),t},toArray:function(e){return Yu(e,function(t){return t})||[]},only:function(e){if(!jg(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ze.Component=Yo;ze.Fragment=o4;ze.Profiler=c4;ze.PureComponent=Bg;ze.StrictMode=l4;ze.Suspense=d4;ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=y4;ze.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Gw({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=$g.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Xw.call(t,l)&&!Yw.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:hu,type:e.type,key:i,ref:s,props:n,_owner:a}};ze.createContext=function(e){return e={$$typeof:f4,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:u4,_context:e},e.Consumer=e};ze.createElement=Qw;ze.createFactory=function(e){var t=Qw.bind(null,e);return t.type=e,t};ze.createRef=function(){return{current:null}};ze.forwardRef=function(e){return{$$typeof:h4,render:e}};ze.isValidElement=jg;ze.lazy=function(e){return{$$typeof:m4,_payload:{_status:-1,_result:e},_init:x4}};ze.memo=function(e,t){return{$$typeof:p4,type:e,compare:t===void 0?null:t}};ze.startTransition=function(e){var t=Bf.transition;Bf.transition={};try{e()}finally{Bf.transition=t}};ze.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ze.useCallback=function(e,t){return Gr.current.useCallback(e,t)};ze.useContext=function(e){return Gr.current.useContext(e)};ze.useDebugValue=function(){};ze.useDeferredValue=function(e){return Gr.current.useDeferredValue(e)};ze.useEffect=function(e,t){return Gr.current.useEffect(e,t)};ze.useId=function(){return Gr.current.useId()};ze.useImperativeHandle=function(e,t,r){return Gr.current.useImperativeHandle(e,t,r)};ze.useInsertionEffect=function(e,t){return Gr.current.useInsertionEffect(e,t)};ze.useLayoutEffect=function(e,t){return Gr.current.useLayoutEffect(e,t)};ze.useMemo=function(e,t){return Gr.current.useMemo(e,t)};ze.useReducer=function(e,t,r){return Gr.current.useReducer(e,t,r)};ze.useRef=function(e){return Gr.current.useRef(e)};ze.useState=function(e){return Gr.current.useState(e)};ze.useSyncExternalStore=function(e,t,r){return Gr.current.useSyncExternalStore(e,t,r)};ze.useTransition=function(){return Gr.current.useTransition()};ze.version="18.2.0";Hw.exports=ze;var ee=Hw.exports;const Se=jw(ee),E4=s4({__proto__:null,default:Se},[ee]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w4=ee,T4=Symbol.for("react.element"),k4=Symbol.for("react.fragment"),A4=Object.prototype.hasOwnProperty,S4=w4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,I4={key:!0,ref:!0,__self:!0,__source:!0};function Jw(e,t,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)A4.call(t,n)&&!I4.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:T4,type:e,key:s,ref:a,props:i,_owner:S4.current}}y0.Fragment=k4;y0.jsx=Jw;y0.jsxs=Jw;zw.exports=y0;var N=zw.exports,Zw={exports:{}},xn={},eT={exports:{}},tT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(te,b){var ce=te.length;te.push(b);e:for(;0<ce;){var Ee=ce-1>>>1,F=te[Ee];if(0<i(F,b))te[Ee]=b,te[ce]=F,ce=Ee;else break e}}function r(te){return te.length===0?null:te[0]}function n(te){if(te.length===0)return null;var b=te[0],ce=te.pop();if(ce!==b){te[0]=ce;e:for(var Ee=0,F=te.length,H=F>>>1;Ee<H;){var B=2*(Ee+1)-1,V=te[B],J=B+1,de=te[J];if(0>i(V,ce))J<F&&0>i(de,V)?(te[Ee]=de,te[J]=ce,Ee=J):(te[Ee]=V,te[B]=ce,Ee=B);else if(J<F&&0>i(de,ce))te[Ee]=de,te[J]=ce,Ee=J;else break e}}return b}function i(te,b){var ce=te.sortIndex-b.sortIndex;return ce!==0?ce:te.id-b.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,f=null,h=3,d=!1,p=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(te){for(var b=r(c);b!==null;){if(b.callback===null)n(c);else if(b.startTime<=te)n(c),b.sortIndex=b.expirationTime,t(l,b);else break;b=r(c)}}function w(te){if(m=!1,g(te),!p)if(r(l)!==null)p=!0,se(T);else{var b=r(c);b!==null&&ue(w,b.startTime-te)}}function T(te,b){p=!1,m&&(m=!1,x(P),P=-1),d=!0;var ce=h;try{for(g(b),f=r(l);f!==null&&(!(f.expirationTime>b)||te&&!j());){var Ee=f.callback;if(typeof Ee=="function"){f.callback=null,h=f.priorityLevel;var F=Ee(f.expirationTime<=b);b=e.unstable_now(),typeof F=="function"?f.callback=F:f===r(l)&&n(l),g(b)}else n(l);f=r(l)}if(f!==null)var H=!0;else{var B=r(c);B!==null&&ue(w,B.startTime-b),H=!1}return H}finally{f=null,h=ce,d=!1}}var k=!1,y=null,P=-1,O=5,U=-1;function j(){return!(e.unstable_now()-U<O)}function M(){if(y!==null){var te=e.unstable_now();U=te;var b=!0;try{b=y(!0,te)}finally{b?X():(k=!1,y=null)}}else k=!1}var X;if(typeof _=="function")X=function(){_(M)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,re=ne.port2;ne.port1.onmessage=M,X=function(){re.postMessage(null)}}else X=function(){v(M,0)};function se(te){y=te,k||(k=!0,X())}function ue(te,b){P=v(function(){te(e.unstable_now())},b)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(te){te.callback=null},e.unstable_continueExecution=function(){p||d||(p=!0,se(T))},e.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<te?Math.floor(1e3/te):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(te){switch(h){case 1:case 2:case 3:var b=3;break;default:b=h}var ce=h;h=b;try{return te()}finally{h=ce}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(te,b){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var ce=h;h=te;try{return b()}finally{h=ce}},e.unstable_scheduleCallback=function(te,b,ce){var Ee=e.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?Ee+ce:Ee):ce=Ee,te){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=ce+F,te={id:u++,callback:b,priorityLevel:te,startTime:ce,expirationTime:F,sortIndex:-1},ce>Ee?(te.sortIndex=ce,t(c,te),r(l)===null&&te===r(c)&&(m?(x(P),P=-1):m=!0,ue(w,ce-Ee))):(te.sortIndex=F,t(l,te),p||d||(p=!0,se(T))),te},e.unstable_shouldYield=j,e.unstable_wrapCallback=function(te){var b=h;return function(){var ce=h;h=b;try{return te.apply(this,arguments)}finally{h=ce}}}})(tT);eT.exports=tT;var C4=eT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rT=ee,gn=C4;function le(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var nT=new Set,yc={};function Oa(e,t){No(e,t),No(e+"Capture",t)}function No(e,t){for(yc[e]=t,e=0;e<t.length;e++)nT.add(t[e])}var Mi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qp=Object.prototype.hasOwnProperty,R4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,H_={},W_={};function P4(e){return Qp.call(W_,e)?!0:Qp.call(H_,e)?!1:R4.test(e)?W_[e]=!0:(H_[e]=!0,!1)}function F4(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function N4(e,t,r,n){if(t===null||typeof t>"u"||F4(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Kr(e,t,r,n,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var pr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){pr[e]=new Kr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];pr[t]=new Kr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){pr[e]=new Kr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){pr[e]=new Kr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){pr[e]=new Kr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){pr[e]=new Kr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){pr[e]=new Kr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){pr[e]=new Kr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){pr[e]=new Kr(e,5,!1,e.toLowerCase(),null,!1,!1)});var zg=/[\-:]([a-z])/g;function Hg(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(zg,Hg);pr[t]=new Kr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(zg,Hg);pr[t]=new Kr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(zg,Hg);pr[t]=new Kr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){pr[e]=new Kr(e,1,!1,e.toLowerCase(),null,!1,!1)});pr.xlinkHref=new Kr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){pr[e]=new Kr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Wg(e,t,r,n){var i=pr.hasOwnProperty(t)?pr[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(N4(t,r,i,n)&&(r=null),n||i===null?P4(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Wi=rT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qu=Symbol.for("react.element"),to=Symbol.for("react.portal"),ro=Symbol.for("react.fragment"),Gg=Symbol.for("react.strict_mode"),Jp=Symbol.for("react.profiler"),iT=Symbol.for("react.provider"),sT=Symbol.for("react.context"),Kg=Symbol.for("react.forward_ref"),Zp=Symbol.for("react.suspense"),em=Symbol.for("react.suspense_list"),qg=Symbol.for("react.memo"),Ji=Symbol.for("react.lazy"),aT=Symbol.for("react.offscreen"),G_=Symbol.iterator;function _l(e){return e===null||typeof e!="object"?null:(e=G_&&e[G_]||e["@@iterator"],typeof e=="function"?e:null)}var wt=Object.assign,Fd;function Fl(e){if(Fd===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Fd=t&&t[1]||""}return`
`+Fd+e}var Nd=!1;function Dd(e,t){if(!e||Nd)return"";Nd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{Nd=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Fl(e):""}function D4(e){switch(e.tag){case 5:return Fl(e.type);case 16:return Fl("Lazy");case 13:return Fl("Suspense");case 19:return Fl("SuspenseList");case 0:case 2:case 15:return e=Dd(e.type,!1),e;case 11:return e=Dd(e.type.render,!1),e;case 1:return e=Dd(e.type,!0),e;default:return""}}function tm(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ro:return"Fragment";case to:return"Portal";case Jp:return"Profiler";case Gg:return"StrictMode";case Zp:return"Suspense";case em:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case sT:return(e.displayName||"Context")+".Consumer";case iT:return(e._context.displayName||"Context")+".Provider";case Kg:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case qg:return t=e.displayName||null,t!==null?t:tm(e.type)||"Memo";case Ji:t=e._payload,e=e._init;try{return tm(e(t))}catch{}}return null}function O4(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return tm(t);case 8:return t===Gg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Fs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function oT(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function L4(e){var t=oT(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ju(e){e._valueTracker||(e._valueTracker=L4(e))}function lT(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=oT(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function ah(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function rm(e,t){var r=t.checked;return wt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function K_(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Fs(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function cT(e,t){t=t.checked,t!=null&&Wg(e,"checked",t,!1)}function nm(e,t){cT(e,t);var r=Fs(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?im(e,t.type,r):t.hasOwnProperty("defaultValue")&&im(e,t.type,Fs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function q_(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function im(e,t,r){(t!=="number"||ah(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Nl=Array.isArray;function _o(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Fs(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function sm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(le(91));return wt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function X_(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(le(92));if(Nl(r)){if(1<r.length)throw Error(le(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Fs(r)}}function uT(e,t){var r=Fs(t.value),n=Fs(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Y_(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function fT(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function am(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?fT(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Zu,hT=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Zu=Zu||document.createElement("div"),Zu.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Zu.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ec(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Kl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},M4=["Webkit","ms","Moz","O"];Object.keys(Kl).forEach(function(e){M4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Kl[t]=Kl[e]})});function dT(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Kl.hasOwnProperty(e)&&Kl[e]?(""+t).trim():t+"px"}function pT(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=dT(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var b4=wt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function om(e,t){if(t){if(b4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(le(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(le(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(le(61))}if(t.style!=null&&typeof t.style!="object")throw Error(le(62))}}function lm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cm=null;function Xg(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var um=null,xo=null,yo=null;function Q_(e){if(e=mu(e)){if(typeof um!="function")throw Error(le(280));var t=e.stateNode;t&&(t=A0(t),um(e.stateNode,e.type,t))}}function mT(e){xo?yo?yo.push(e):yo=[e]:xo=e}function gT(){if(xo){var e=xo,t=yo;if(yo=xo=null,Q_(e),t)for(e=0;e<t.length;e++)Q_(t[e])}}function vT(e,t){return e(t)}function _T(){}var Od=!1;function xT(e,t,r){if(Od)return e(t,r);Od=!0;try{return vT(e,t,r)}finally{Od=!1,(xo!==null||yo!==null)&&(_T(),gT())}}function wc(e,t){var r=e.stateNode;if(r===null)return null;var n=A0(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(le(231,t,typeof r));return r}var fm=!1;if(Mi)try{var xl={};Object.defineProperty(xl,"passive",{get:function(){fm=!0}}),window.addEventListener("test",xl,xl),window.removeEventListener("test",xl,xl)}catch{fm=!1}function V4(e,t,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var ql=!1,oh=null,lh=!1,hm=null,B4={onError:function(e){ql=!0,oh=e}};function U4(e,t,r,n,i,s,a,o,l){ql=!1,oh=null,V4.apply(B4,arguments)}function $4(e,t,r,n,i,s,a,o,l){if(U4.apply(this,arguments),ql){if(ql){var c=oh;ql=!1,oh=null}else throw Error(le(198));lh||(lh=!0,hm=c)}}function La(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function yT(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function J_(e){if(La(e)!==e)throw Error(le(188))}function j4(e){var t=e.alternate;if(!t){if(t=La(e),t===null)throw Error(le(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return J_(i),e;if(s===n)return J_(i),t;s=s.sibling}throw Error(le(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(le(189))}}if(r.alternate!==n)throw Error(le(190))}if(r.tag!==3)throw Error(le(188));return r.stateNode.current===r?e:t}function ET(e){return e=j4(e),e!==null?wT(e):null}function wT(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=wT(e);if(t!==null)return t;e=e.sibling}return null}var TT=gn.unstable_scheduleCallback,Z_=gn.unstable_cancelCallback,z4=gn.unstable_shouldYield,H4=gn.unstable_requestPaint,Pt=gn.unstable_now,W4=gn.unstable_getCurrentPriorityLevel,Yg=gn.unstable_ImmediatePriority,kT=gn.unstable_UserBlockingPriority,ch=gn.unstable_NormalPriority,G4=gn.unstable_LowPriority,AT=gn.unstable_IdlePriority,E0=null,li=null;function K4(e){if(li&&typeof li.onCommitFiberRoot=="function")try{li.onCommitFiberRoot(E0,e,void 0,(e.current.flags&128)===128)}catch{}}var Hn=Math.clz32?Math.clz32:Y4,q4=Math.log,X4=Math.LN2;function Y4(e){return e>>>=0,e===0?32:31-(q4(e)/X4|0)|0}var ef=64,tf=4194304;function Dl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function uh(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Dl(o):(s&=a,s!==0&&(n=Dl(s)))}else a=r&~i,a!==0?n=Dl(a):s!==0&&(n=Dl(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Hn(t),i=1<<r,n|=e[r],t&=~i;return n}function Q4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function J4(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-Hn(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=Q4(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function dm(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ST(){var e=ef;return ef<<=1,!(ef&4194240)&&(ef=64),e}function Ld(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function du(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Hn(t),e[t]=r}function Z4(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Hn(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function Qg(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Hn(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var rt=0;function IT(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var CT,Jg,RT,PT,FT,pm=!1,rf=[],_s=null,xs=null,ys=null,Tc=new Map,kc=new Map,es=[],eP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ex(e,t){switch(e){case"focusin":case"focusout":_s=null;break;case"dragenter":case"dragleave":xs=null;break;case"mouseover":case"mouseout":ys=null;break;case"pointerover":case"pointerout":Tc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":kc.delete(t.pointerId)}}function yl(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=mu(t),t!==null&&Jg(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function tP(e,t,r,n,i){switch(t){case"focusin":return _s=yl(_s,e,t,r,n,i),!0;case"dragenter":return xs=yl(xs,e,t,r,n,i),!0;case"mouseover":return ys=yl(ys,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Tc.set(s,yl(Tc.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,kc.set(s,yl(kc.get(s)||null,e,t,r,n,i)),!0}return!1}function NT(e){var t=na(e.target);if(t!==null){var r=La(t);if(r!==null){if(t=r.tag,t===13){if(t=yT(r),t!==null){e.blockedOn=t,FT(e.priority,function(){RT(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Uf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=mm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);cm=n,r.target.dispatchEvent(n),cm=null}else return t=mu(r),t!==null&&Jg(t),e.blockedOn=r,!1;t.shift()}return!0}function tx(e,t,r){Uf(e)&&r.delete(t)}function rP(){pm=!1,_s!==null&&Uf(_s)&&(_s=null),xs!==null&&Uf(xs)&&(xs=null),ys!==null&&Uf(ys)&&(ys=null),Tc.forEach(tx),kc.forEach(tx)}function El(e,t){e.blockedOn===t&&(e.blockedOn=null,pm||(pm=!0,gn.unstable_scheduleCallback(gn.unstable_NormalPriority,rP)))}function Ac(e){function t(i){return El(i,e)}if(0<rf.length){El(rf[0],e);for(var r=1;r<rf.length;r++){var n=rf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(_s!==null&&El(_s,e),xs!==null&&El(xs,e),ys!==null&&El(ys,e),Tc.forEach(t),kc.forEach(t),r=0;r<es.length;r++)n=es[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<es.length&&(r=es[0],r.blockedOn===null);)NT(r),r.blockedOn===null&&es.shift()}var Eo=Wi.ReactCurrentBatchConfig,fh=!0;function nP(e,t,r,n){var i=rt,s=Eo.transition;Eo.transition=null;try{rt=1,Zg(e,t,r,n)}finally{rt=i,Eo.transition=s}}function iP(e,t,r,n){var i=rt,s=Eo.transition;Eo.transition=null;try{rt=4,Zg(e,t,r,n)}finally{rt=i,Eo.transition=s}}function Zg(e,t,r,n){if(fh){var i=mm(e,t,r,n);if(i===null)Wd(e,t,n,hh,r),ex(e,n);else if(tP(i,e,t,r,n))n.stopPropagation();else if(ex(e,n),t&4&&-1<eP.indexOf(e)){for(;i!==null;){var s=mu(i);if(s!==null&&CT(s),s=mm(e,t,r,n),s===null&&Wd(e,t,n,hh,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Wd(e,t,n,null,r)}}var hh=null;function mm(e,t,r,n){if(hh=null,e=Xg(n),e=na(e),e!==null)if(t=La(e),t===null)e=null;else if(r=t.tag,r===13){if(e=yT(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return hh=e,null}function DT(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(W4()){case Yg:return 1;case kT:return 4;case ch:case G4:return 16;case AT:return 536870912;default:return 16}default:return 16}}var cs=null,e1=null,$f=null;function OT(){if($f)return $f;var e,t=e1,r=t.length,n,i="value"in cs?cs.value:cs.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[s-n];n++);return $f=i.slice(e,1<n?1-n:void 0)}function jf(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function nf(){return!0}function rx(){return!1}function yn(e){function t(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?nf:rx,this.isPropagationStopped=rx,this}return wt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=nf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=nf)},persist:function(){},isPersistent:nf}),t}var Qo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},t1=yn(Qo),pu=wt({},Qo,{view:0,detail:0}),sP=yn(pu),Md,bd,wl,w0=wt({},pu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:r1,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==wl&&(wl&&e.type==="mousemove"?(Md=e.screenX-wl.screenX,bd=e.screenY-wl.screenY):bd=Md=0,wl=e),Md)},movementY:function(e){return"movementY"in e?e.movementY:bd}}),nx=yn(w0),aP=wt({},w0,{dataTransfer:0}),oP=yn(aP),lP=wt({},pu,{relatedTarget:0}),Vd=yn(lP),cP=wt({},Qo,{animationName:0,elapsedTime:0,pseudoElement:0}),uP=yn(cP),fP=wt({},Qo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),hP=yn(fP),dP=wt({},Qo,{data:0}),ix=yn(dP),pP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vP(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=gP[e])?!!t[e]:!1}function r1(){return vP}var _P=wt({},pu,{key:function(e){if(e.key){var t=pP[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=jf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?mP[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:r1,charCode:function(e){return e.type==="keypress"?jf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?jf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),xP=yn(_P),yP=wt({},w0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sx=yn(yP),EP=wt({},pu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:r1}),wP=yn(EP),TP=wt({},Qo,{propertyName:0,elapsedTime:0,pseudoElement:0}),kP=yn(TP),AP=wt({},w0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),SP=yn(AP),IP=[9,13,27,32],n1=Mi&&"CompositionEvent"in window,Xl=null;Mi&&"documentMode"in document&&(Xl=document.documentMode);var CP=Mi&&"TextEvent"in window&&!Xl,LT=Mi&&(!n1||Xl&&8<Xl&&11>=Xl),ax=String.fromCharCode(32),ox=!1;function MT(e,t){switch(e){case"keyup":return IP.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bT(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var no=!1;function RP(e,t){switch(e){case"compositionend":return bT(t);case"keypress":return t.which!==32?null:(ox=!0,ax);case"textInput":return e=t.data,e===ax&&ox?null:e;default:return null}}function PP(e,t){if(no)return e==="compositionend"||!n1&&MT(e,t)?(e=OT(),$f=e1=cs=null,no=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return LT&&t.locale!=="ko"?null:t.data;default:return null}}var FP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!FP[e.type]:t==="textarea"}function VT(e,t,r,n){mT(n),t=dh(t,"onChange"),0<t.length&&(r=new t1("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Yl=null,Sc=null;function NP(e){XT(e,0)}function T0(e){var t=ao(e);if(lT(t))return e}function DP(e,t){if(e==="change")return t}var BT=!1;if(Mi){var Bd;if(Mi){var Ud="oninput"in document;if(!Ud){var cx=document.createElement("div");cx.setAttribute("oninput","return;"),Ud=typeof cx.oninput=="function"}Bd=Ud}else Bd=!1;BT=Bd&&(!document.documentMode||9<document.documentMode)}function ux(){Yl&&(Yl.detachEvent("onpropertychange",UT),Sc=Yl=null)}function UT(e){if(e.propertyName==="value"&&T0(Sc)){var t=[];VT(t,Sc,e,Xg(e)),xT(NP,t)}}function OP(e,t,r){e==="focusin"?(ux(),Yl=t,Sc=r,Yl.attachEvent("onpropertychange",UT)):e==="focusout"&&ux()}function LP(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return T0(Sc)}function MP(e,t){if(e==="click")return T0(t)}function bP(e,t){if(e==="input"||e==="change")return T0(t)}function VP(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Kn=typeof Object.is=="function"?Object.is:VP;function Ic(e,t){if(Kn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Qp.call(t,i)||!Kn(e[i],t[i]))return!1}return!0}function fx(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hx(e,t){var r=fx(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=fx(r)}}function $T(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?$T(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function jT(){for(var e=window,t=ah();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=ah(e.document)}return t}function i1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function BP(e){var t=jT(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&$T(r.ownerDocument.documentElement,r)){if(n!==null&&i1(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=hx(r,s);var a=hx(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var UP=Mi&&"documentMode"in document&&11>=document.documentMode,io=null,gm=null,Ql=null,vm=!1;function dx(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;vm||io==null||io!==ah(n)||(n=io,"selectionStart"in n&&i1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ql&&Ic(Ql,n)||(Ql=n,n=dh(gm,"onSelect"),0<n.length&&(t=new t1("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=io)))}function sf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var so={animationend:sf("Animation","AnimationEnd"),animationiteration:sf("Animation","AnimationIteration"),animationstart:sf("Animation","AnimationStart"),transitionend:sf("Transition","TransitionEnd")},$d={},zT={};Mi&&(zT=document.createElement("div").style,"AnimationEvent"in window||(delete so.animationend.animation,delete so.animationiteration.animation,delete so.animationstart.animation),"TransitionEvent"in window||delete so.transitionend.transition);function k0(e){if($d[e])return $d[e];if(!so[e])return e;var t=so[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in zT)return $d[e]=t[r];return e}var HT=k0("animationend"),WT=k0("animationiteration"),GT=k0("animationstart"),KT=k0("transitionend"),qT=new Map,px="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Us(e,t){qT.set(e,t),Oa(t,[e])}for(var jd=0;jd<px.length;jd++){var zd=px[jd],$P=zd.toLowerCase(),jP=zd[0].toUpperCase()+zd.slice(1);Us($P,"on"+jP)}Us(HT,"onAnimationEnd");Us(WT,"onAnimationIteration");Us(GT,"onAnimationStart");Us("dblclick","onDoubleClick");Us("focusin","onFocus");Us("focusout","onBlur");Us(KT,"onTransitionEnd");No("onMouseEnter",["mouseout","mouseover"]);No("onMouseLeave",["mouseout","mouseover"]);No("onPointerEnter",["pointerout","pointerover"]);No("onPointerLeave",["pointerout","pointerover"]);Oa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Oa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Oa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Oa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Oa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Oa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ol="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ol));function mx(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,$4(n,t,void 0,e),e.currentTarget=null}function XT(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;mx(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;mx(i,o,c),s=l}}}if(lh)throw e=hm,lh=!1,hm=null,e}function lt(e,t){var r=t[wm];r===void 0&&(r=t[wm]=new Set);var n=e+"__bubble";r.has(n)||(YT(t,e,2,!1),r.add(n))}function Hd(e,t,r){var n=0;t&&(n|=4),YT(r,e,n,t)}var af="_reactListening"+Math.random().toString(36).slice(2);function Cc(e){if(!e[af]){e[af]=!0,nT.forEach(function(r){r!=="selectionchange"&&(zP.has(r)||Hd(r,!1,e),Hd(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[af]||(t[af]=!0,Hd("selectionchange",!1,t))}}function YT(e,t,r,n){switch(DT(t)){case 1:var i=nP;break;case 4:i=iP;break;default:i=Zg}r=i.bind(null,t,r,e),i=void 0,!fm||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Wd(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=na(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}xT(function(){var c=s,u=Xg(r),f=[];e:{var h=qT.get(e);if(h!==void 0){var d=t1,p=e;switch(e){case"keypress":if(jf(r)===0)break e;case"keydown":case"keyup":d=xP;break;case"focusin":p="focus",d=Vd;break;case"focusout":p="blur",d=Vd;break;case"beforeblur":case"afterblur":d=Vd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=nx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=oP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=wP;break;case HT:case WT:case GT:d=uP;break;case KT:d=kP;break;case"scroll":d=sP;break;case"wheel":d=SP;break;case"copy":case"cut":case"paste":d=hP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=sx}var m=(t&4)!==0,v=!m&&e==="scroll",x=m?h!==null?h+"Capture":null:h;m=[];for(var _=c,g;_!==null;){g=_;var w=g.stateNode;if(g.tag===5&&w!==null&&(g=w,x!==null&&(w=wc(_,x),w!=null&&m.push(Rc(_,w,g)))),v)break;_=_.return}0<m.length&&(h=new d(h,p,null,r,u),f.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",d=e==="mouseout"||e==="pointerout",h&&r!==cm&&(p=r.relatedTarget||r.fromElement)&&(na(p)||p[bi]))break e;if((d||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,d?(p=r.relatedTarget||r.toElement,d=c,p=p?na(p):null,p!==null&&(v=La(p),p!==v||p.tag!==5&&p.tag!==6)&&(p=null)):(d=null,p=c),d!==p)){if(m=nx,w="onMouseLeave",x="onMouseEnter",_="mouse",(e==="pointerout"||e==="pointerover")&&(m=sx,w="onPointerLeave",x="onPointerEnter",_="pointer"),v=d==null?h:ao(d),g=p==null?h:ao(p),h=new m(w,_+"leave",d,r,u),h.target=v,h.relatedTarget=g,w=null,na(u)===c&&(m=new m(x,_+"enter",p,r,u),m.target=g,m.relatedTarget=v,w=m),v=w,d&&p)t:{for(m=d,x=p,_=0,g=m;g;g=Ka(g))_++;for(g=0,w=x;w;w=Ka(w))g++;for(;0<_-g;)m=Ka(m),_--;for(;0<g-_;)x=Ka(x),g--;for(;_--;){if(m===x||x!==null&&m===x.alternate)break t;m=Ka(m),x=Ka(x)}m=null}else m=null;d!==null&&gx(f,h,d,m,!1),p!==null&&v!==null&&gx(f,v,p,m,!0)}}e:{if(h=c?ao(c):window,d=h.nodeName&&h.nodeName.toLowerCase(),d==="select"||d==="input"&&h.type==="file")var T=DP;else if(lx(h))if(BT)T=bP;else{T=LP;var k=OP}else(d=h.nodeName)&&d.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(T=MP);if(T&&(T=T(e,c))){VT(f,T,r,u);break e}k&&k(e,h,c),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&im(h,"number",h.value)}switch(k=c?ao(c):window,e){case"focusin":(lx(k)||k.contentEditable==="true")&&(io=k,gm=c,Ql=null);break;case"focusout":Ql=gm=io=null;break;case"mousedown":vm=!0;break;case"contextmenu":case"mouseup":case"dragend":vm=!1,dx(f,r,u);break;case"selectionchange":if(UP)break;case"keydown":case"keyup":dx(f,r,u)}var y;if(n1)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else no?MT(e,r)&&(P="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(LT&&r.locale!=="ko"&&(no||P!=="onCompositionStart"?P==="onCompositionEnd"&&no&&(y=OT()):(cs=u,e1="value"in cs?cs.value:cs.textContent,no=!0)),k=dh(c,P),0<k.length&&(P=new ix(P,e,null,r,u),f.push({event:P,listeners:k}),y?P.data=y:(y=bT(r),y!==null&&(P.data=y)))),(y=CP?RP(e,r):PP(e,r))&&(c=dh(c,"onBeforeInput"),0<c.length&&(u=new ix("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:c}),u.data=y))}XT(f,t)})}function Rc(e,t,r){return{instance:e,listener:t,currentTarget:r}}function dh(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=wc(e,r),s!=null&&n.unshift(Rc(e,s,i)),s=wc(e,t),s!=null&&n.push(Rc(e,s,i))),e=e.return}return n}function Ka(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function gx(e,t,r,n,i){for(var s=t._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=wc(r,s),l!=null&&a.unshift(Rc(r,l,o))):i||(l=wc(r,s),l!=null&&a.push(Rc(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var HP=/\r\n?/g,WP=/\u0000|\uFFFD/g;function vx(e){return(typeof e=="string"?e:""+e).replace(HP,`
`).replace(WP,"")}function of(e,t,r){if(t=vx(t),vx(e)!==t&&r)throw Error(le(425))}function ph(){}var _m=null,xm=null;function ym(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Em=typeof setTimeout=="function"?setTimeout:void 0,GP=typeof clearTimeout=="function"?clearTimeout:void 0,_x=typeof Promise=="function"?Promise:void 0,KP=typeof queueMicrotask=="function"?queueMicrotask:typeof _x<"u"?function(e){return _x.resolve(null).then(e).catch(qP)}:Em;function qP(e){setTimeout(function(){throw e})}function Gd(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Ac(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Ac(t)}function Es(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function xx(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Jo=Math.random().toString(36).slice(2),ri="__reactFiber$"+Jo,Pc="__reactProps$"+Jo,bi="__reactContainer$"+Jo,wm="__reactEvents$"+Jo,XP="__reactListeners$"+Jo,YP="__reactHandles$"+Jo;function na(e){var t=e[ri];if(t)return t;for(var r=e.parentNode;r;){if(t=r[bi]||r[ri]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=xx(e);e!==null;){if(r=e[ri])return r;e=xx(e)}return t}e=r,r=e.parentNode}return null}function mu(e){return e=e[ri]||e[bi],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ao(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(le(33))}function A0(e){return e[Pc]||null}var Tm=[],oo=-1;function $s(e){return{current:e}}function ht(e){0>oo||(e.current=Tm[oo],Tm[oo]=null,oo--)}function at(e,t){oo++,Tm[oo]=e.current,e.current=t}var Ns={},Pr=$s(Ns),tn=$s(!1),_a=Ns;function Do(e,t){var r=e.type.contextTypes;if(!r)return Ns;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function rn(e){return e=e.childContextTypes,e!=null}function mh(){ht(tn),ht(Pr)}function yx(e,t,r){if(Pr.current!==Ns)throw Error(le(168));at(Pr,t),at(tn,r)}function QT(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(le(108,O4(e)||"Unknown",i));return wt({},r,n)}function gh(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ns,_a=Pr.current,at(Pr,e),at(tn,tn.current),!0}function Ex(e,t,r){var n=e.stateNode;if(!n)throw Error(le(169));r?(e=QT(e,t,_a),n.__reactInternalMemoizedMergedChildContext=e,ht(tn),ht(Pr),at(Pr,e)):ht(tn),at(tn,r)}var Ai=null,S0=!1,Kd=!1;function JT(e){Ai===null?Ai=[e]:Ai.push(e)}function QP(e){S0=!0,JT(e)}function js(){if(!Kd&&Ai!==null){Kd=!0;var e=0,t=rt;try{var r=Ai;for(rt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ai=null,S0=!1}catch(i){throw Ai!==null&&(Ai=Ai.slice(e+1)),TT(Yg,js),i}finally{rt=t,Kd=!1}}return null}var lo=[],co=0,vh=null,_h=0,An=[],Sn=0,xa=null,Si=1,Ii="";function Qs(e,t){lo[co++]=_h,lo[co++]=vh,vh=e,_h=t}function ZT(e,t,r){An[Sn++]=Si,An[Sn++]=Ii,An[Sn++]=xa,xa=e;var n=Si;e=Ii;var i=32-Hn(n)-1;n&=~(1<<i),r+=1;var s=32-Hn(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Si=1<<32-Hn(t)+i|r<<i|n,Ii=s+e}else Si=1<<s|r<<i|n,Ii=e}function s1(e){e.return!==null&&(Qs(e,1),ZT(e,1,0))}function a1(e){for(;e===vh;)vh=lo[--co],lo[co]=null,_h=lo[--co],lo[co]=null;for(;e===xa;)xa=An[--Sn],An[Sn]=null,Ii=An[--Sn],An[Sn]=null,Si=An[--Sn],An[Sn]=null}var mn=null,fn=null,vt=!1,Un=null;function e2(e,t){var r=Rn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function wx(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,mn=e,fn=Es(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,mn=e,fn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=xa!==null?{id:Si,overflow:Ii}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Rn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,mn=e,fn=null,!0):!1;default:return!1}}function km(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Am(e){if(vt){var t=fn;if(t){var r=t;if(!wx(e,t)){if(km(e))throw Error(le(418));t=Es(r.nextSibling);var n=mn;t&&wx(e,t)?e2(n,r):(e.flags=e.flags&-4097|2,vt=!1,mn=e)}}else{if(km(e))throw Error(le(418));e.flags=e.flags&-4097|2,vt=!1,mn=e}}}function Tx(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;mn=e}function lf(e){if(e!==mn)return!1;if(!vt)return Tx(e),vt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ym(e.type,e.memoizedProps)),t&&(t=fn)){if(km(e))throw t2(),Error(le(418));for(;t;)e2(e,t),t=Es(t.nextSibling)}if(Tx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(le(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){fn=Es(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}fn=null}}else fn=mn?Es(e.stateNode.nextSibling):null;return!0}function t2(){for(var e=fn;e;)e=Es(e.nextSibling)}function Oo(){fn=mn=null,vt=!1}function o1(e){Un===null?Un=[e]:Un.push(e)}var JP=Wi.ReactCurrentBatchConfig;function Vn(e,t){if(e&&e.defaultProps){t=wt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}var xh=$s(null),yh=null,uo=null,l1=null;function c1(){l1=uo=yh=null}function u1(e){var t=xh.current;ht(xh),e._currentValue=t}function Sm(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function wo(e,t){yh=e,l1=uo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Zr=!0),e.firstContext=null)}function Fn(e){var t=e._currentValue;if(l1!==e)if(e={context:e,memoizedValue:t,next:null},uo===null){if(yh===null)throw Error(le(308));uo=e,yh.dependencies={lanes:0,firstContext:e}}else uo=uo.next=e;return t}var ia=null;function f1(e){ia===null?ia=[e]:ia.push(e)}function r2(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,f1(t)):(r.next=i.next,i.next=r),t.interleaved=r,Vi(e,n)}function Vi(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Zi=!1;function h1(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function n2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ni(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ws(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Je&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Vi(e,r)}return i=n.interleaved,i===null?(t.next=t,f1(n)):(t.next=i.next,i.next=t),n.interleaved=t,Vi(e,r)}function zf(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Qg(e,r)}}function kx(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Eh(e,t,r,n){var i=e.updateQueue;Zi=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;a=0,u=c=l=null,o=s;do{var h=o.lane,d=o.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(h=t,d=r,m.tag){case 1:if(p=m.payload,typeof p=="function"){f=p.call(d,f,h);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(d,f,h):p,h==null)break e;f=wt({},f,h);break e;case 2:Zi=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else d={eventTime:d,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=d,l=f):u=u.next=d,a|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(u===null&&(l=f),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Ea|=a,e.lanes=a,e.memoizedState=f}}function Ax(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(le(191,i));i.call(n)}}}var i2=new rT.Component().refs;function Im(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:wt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var I0={isMounted:function(e){return(e=e._reactInternals)?La(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=zr(),i=ks(e),s=Ni(n,i);s.payload=t,r!=null&&(s.callback=r),t=ws(e,s,i),t!==null&&(Wn(t,e,i,n),zf(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=zr(),i=ks(e),s=Ni(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=ws(e,s,i),t!==null&&(Wn(t,e,i,n),zf(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=zr(),n=ks(e),i=Ni(r,n);i.tag=2,t!=null&&(i.callback=t),t=ws(e,i,n),t!==null&&(Wn(t,e,n,r),zf(t,e,n))}};function Sx(e,t,r,n,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!Ic(r,n)||!Ic(i,s):!0}function s2(e,t,r){var n=!1,i=Ns,s=t.contextType;return typeof s=="object"&&s!==null?s=Fn(s):(i=rn(t)?_a:Pr.current,n=t.contextTypes,s=(n=n!=null)?Do(e,i):Ns),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=I0,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function Ix(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&I0.enqueueReplaceState(t,t.state,null)}function Cm(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=i2,h1(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Fn(s):(s=rn(t)?_a:Pr.current,i.context=Do(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Im(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&I0.enqueueReplaceState(i,i.state,null),Eh(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Tl(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(le(309));var n=r.stateNode}if(!n)throw Error(le(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=i.refs;o===i2&&(o=i.refs={}),a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(le(284));if(!r._owner)throw Error(le(290,e))}return e}function cf(e,t){throw e=Object.prototype.toString.call(t),Error(le(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Cx(e){var t=e._init;return t(e._payload)}function a2(e){function t(x,_){if(e){var g=x.deletions;g===null?(x.deletions=[_],x.flags|=16):g.push(_)}}function r(x,_){if(!e)return null;for(;_!==null;)t(x,_),_=_.sibling;return null}function n(x,_){for(x=new Map;_!==null;)_.key!==null?x.set(_.key,_):x.set(_.index,_),_=_.sibling;return x}function i(x,_){return x=As(x,_),x.index=0,x.sibling=null,x}function s(x,_,g){return x.index=g,e?(g=x.alternate,g!==null?(g=g.index,g<_?(x.flags|=2,_):g):(x.flags|=2,_)):(x.flags|=1048576,_)}function a(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,_,g,w){return _===null||_.tag!==6?(_=ep(g,x.mode,w),_.return=x,_):(_=i(_,g),_.return=x,_)}function l(x,_,g,w){var T=g.type;return T===ro?u(x,_,g.props.children,w,g.key):_!==null&&(_.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Ji&&Cx(T)===_.type)?(w=i(_,g.props),w.ref=Tl(x,_,g),w.return=x,w):(w=Xf(g.type,g.key,g.props,null,x.mode,w),w.ref=Tl(x,_,g),w.return=x,w)}function c(x,_,g,w){return _===null||_.tag!==4||_.stateNode.containerInfo!==g.containerInfo||_.stateNode.implementation!==g.implementation?(_=tp(g,x.mode,w),_.return=x,_):(_=i(_,g.children||[]),_.return=x,_)}function u(x,_,g,w,T){return _===null||_.tag!==7?(_=ha(g,x.mode,w,T),_.return=x,_):(_=i(_,g),_.return=x,_)}function f(x,_,g){if(typeof _=="string"&&_!==""||typeof _=="number")return _=ep(""+_,x.mode,g),_.return=x,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Qu:return g=Xf(_.type,_.key,_.props,null,x.mode,g),g.ref=Tl(x,null,_),g.return=x,g;case to:return _=tp(_,x.mode,g),_.return=x,_;case Ji:var w=_._init;return f(x,w(_._payload),g)}if(Nl(_)||_l(_))return _=ha(_,x.mode,g,null),_.return=x,_;cf(x,_)}return null}function h(x,_,g,w){var T=_!==null?_.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return T!==null?null:o(x,_,""+g,w);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Qu:return g.key===T?l(x,_,g,w):null;case to:return g.key===T?c(x,_,g,w):null;case Ji:return T=g._init,h(x,_,T(g._payload),w)}if(Nl(g)||_l(g))return T!==null?null:u(x,_,g,w,null);cf(x,g)}return null}function d(x,_,g,w,T){if(typeof w=="string"&&w!==""||typeof w=="number")return x=x.get(g)||null,o(_,x,""+w,T);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Qu:return x=x.get(w.key===null?g:w.key)||null,l(_,x,w,T);case to:return x=x.get(w.key===null?g:w.key)||null,c(_,x,w,T);case Ji:var k=w._init;return d(x,_,g,k(w._payload),T)}if(Nl(w)||_l(w))return x=x.get(g)||null,u(_,x,w,T,null);cf(_,w)}return null}function p(x,_,g,w){for(var T=null,k=null,y=_,P=_=0,O=null;y!==null&&P<g.length;P++){y.index>P?(O=y,y=null):O=y.sibling;var U=h(x,y,g[P],w);if(U===null){y===null&&(y=O);break}e&&y&&U.alternate===null&&t(x,y),_=s(U,_,P),k===null?T=U:k.sibling=U,k=U,y=O}if(P===g.length)return r(x,y),vt&&Qs(x,P),T;if(y===null){for(;P<g.length;P++)y=f(x,g[P],w),y!==null&&(_=s(y,_,P),k===null?T=y:k.sibling=y,k=y);return vt&&Qs(x,P),T}for(y=n(x,y);P<g.length;P++)O=d(y,x,P,g[P],w),O!==null&&(e&&O.alternate!==null&&y.delete(O.key===null?P:O.key),_=s(O,_,P),k===null?T=O:k.sibling=O,k=O);return e&&y.forEach(function(j){return t(x,j)}),vt&&Qs(x,P),T}function m(x,_,g,w){var T=_l(g);if(typeof T!="function")throw Error(le(150));if(g=T.call(g),g==null)throw Error(le(151));for(var k=T=null,y=_,P=_=0,O=null,U=g.next();y!==null&&!U.done;P++,U=g.next()){y.index>P?(O=y,y=null):O=y.sibling;var j=h(x,y,U.value,w);if(j===null){y===null&&(y=O);break}e&&y&&j.alternate===null&&t(x,y),_=s(j,_,P),k===null?T=j:k.sibling=j,k=j,y=O}if(U.done)return r(x,y),vt&&Qs(x,P),T;if(y===null){for(;!U.done;P++,U=g.next())U=f(x,U.value,w),U!==null&&(_=s(U,_,P),k===null?T=U:k.sibling=U,k=U);return vt&&Qs(x,P),T}for(y=n(x,y);!U.done;P++,U=g.next())U=d(y,x,P,U.value,w),U!==null&&(e&&U.alternate!==null&&y.delete(U.key===null?P:U.key),_=s(U,_,P),k===null?T=U:k.sibling=U,k=U);return e&&y.forEach(function(M){return t(x,M)}),vt&&Qs(x,P),T}function v(x,_,g,w){if(typeof g=="object"&&g!==null&&g.type===ro&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Qu:e:{for(var T=g.key,k=_;k!==null;){if(k.key===T){if(T=g.type,T===ro){if(k.tag===7){r(x,k.sibling),_=i(k,g.props.children),_.return=x,x=_;break e}}else if(k.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Ji&&Cx(T)===k.type){r(x,k.sibling),_=i(k,g.props),_.ref=Tl(x,k,g),_.return=x,x=_;break e}r(x,k);break}else t(x,k);k=k.sibling}g.type===ro?(_=ha(g.props.children,x.mode,w,g.key),_.return=x,x=_):(w=Xf(g.type,g.key,g.props,null,x.mode,w),w.ref=Tl(x,_,g),w.return=x,x=w)}return a(x);case to:e:{for(k=g.key;_!==null;){if(_.key===k)if(_.tag===4&&_.stateNode.containerInfo===g.containerInfo&&_.stateNode.implementation===g.implementation){r(x,_.sibling),_=i(_,g.children||[]),_.return=x,x=_;break e}else{r(x,_);break}else t(x,_);_=_.sibling}_=tp(g,x.mode,w),_.return=x,x=_}return a(x);case Ji:return k=g._init,v(x,_,k(g._payload),w)}if(Nl(g))return p(x,_,g,w);if(_l(g))return m(x,_,g,w);cf(x,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,_!==null&&_.tag===6?(r(x,_.sibling),_=i(_,g),_.return=x,x=_):(r(x,_),_=ep(g,x.mode,w),_.return=x,x=_),a(x)):r(x,_)}return v}var Lo=a2(!0),o2=a2(!1),gu={},ci=$s(gu),Fc=$s(gu),Nc=$s(gu);function sa(e){if(e===gu)throw Error(le(174));return e}function d1(e,t){switch(at(Nc,t),at(Fc,e),at(ci,gu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:am(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=am(t,e)}ht(ci),at(ci,t)}function Mo(){ht(ci),ht(Fc),ht(Nc)}function l2(e){sa(Nc.current);var t=sa(ci.current),r=am(t,e.type);t!==r&&(at(Fc,e),at(ci,r))}function p1(e){Fc.current===e&&(ht(ci),ht(Fc))}var yt=$s(0);function wh(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var qd=[];function m1(){for(var e=0;e<qd.length;e++)qd[e]._workInProgressVersionPrimary=null;qd.length=0}var Hf=Wi.ReactCurrentDispatcher,Xd=Wi.ReactCurrentBatchConfig,ya=0,Et=null,Ht=null,Zt=null,Th=!1,Jl=!1,Dc=0,ZP=0;function gr(){throw Error(le(321))}function g1(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Kn(e[r],t[r]))return!1;return!0}function v1(e,t,r,n,i,s){if(ya=s,Et=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Hf.current=e===null||e.memoizedState===null?nF:iF,e=r(n,i),Jl){s=0;do{if(Jl=!1,Dc=0,25<=s)throw Error(le(301));s+=1,Zt=Ht=null,t.updateQueue=null,Hf.current=sF,e=r(n,i)}while(Jl)}if(Hf.current=kh,t=Ht!==null&&Ht.next!==null,ya=0,Zt=Ht=Et=null,Th=!1,t)throw Error(le(300));return e}function _1(){var e=Dc!==0;return Dc=0,e}function ti(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zt===null?Et.memoizedState=Zt=e:Zt=Zt.next=e,Zt}function Nn(){if(Ht===null){var e=Et.alternate;e=e!==null?e.memoizedState:null}else e=Ht.next;var t=Zt===null?Et.memoizedState:Zt.next;if(t!==null)Zt=t,Ht=e;else{if(e===null)throw Error(le(310));Ht=e,e={memoizedState:Ht.memoizedState,baseState:Ht.baseState,baseQueue:Ht.baseQueue,queue:Ht.queue,next:null},Zt===null?Et.memoizedState=Zt=e:Zt=Zt.next=e}return Zt}function Oc(e,t){return typeof t=="function"?t(e):t}function Yd(e){var t=Nn(),r=t.queue;if(r===null)throw Error(le(311));r.lastRenderedReducer=e;var n=Ht,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((ya&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=f,a=n):l=l.next=f,Et.lanes|=u,Ea|=u}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,Kn(n,t.memoizedState)||(Zr=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Et.lanes|=s,Ea|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Qd(e){var t=Nn(),r=t.queue;if(r===null)throw Error(le(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);Kn(s,t.memoizedState)||(Zr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function c2(){}function u2(e,t){var r=Et,n=Nn(),i=t(),s=!Kn(n.memoizedState,i);if(s&&(n.memoizedState=i,Zr=!0),n=n.queue,x1(d2.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Zt!==null&&Zt.memoizedState.tag&1){if(r.flags|=2048,Lc(9,h2.bind(null,r,n,i,t),void 0,null),er===null)throw Error(le(349));ya&30||f2(r,t,i)}return i}function f2(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Et.updateQueue,t===null?(t={lastEffect:null,stores:null},Et.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function h2(e,t,r,n){t.value=r,t.getSnapshot=n,p2(t)&&m2(e)}function d2(e,t,r){return r(function(){p2(t)&&m2(e)})}function p2(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Kn(e,r)}catch{return!0}}function m2(e){var t=Vi(e,1);t!==null&&Wn(t,e,1,-1)}function Rx(e){var t=ti();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oc,lastRenderedState:e},t.queue=e,e=e.dispatch=rF.bind(null,Et,e),[t.memoizedState,e]}function Lc(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Et.updateQueue,t===null?(t={lastEffect:null,stores:null},Et.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function g2(){return Nn().memoizedState}function Wf(e,t,r,n){var i=ti();Et.flags|=e,i.memoizedState=Lc(1|t,r,void 0,n===void 0?null:n)}function C0(e,t,r,n){var i=Nn();n=n===void 0?null:n;var s=void 0;if(Ht!==null){var a=Ht.memoizedState;if(s=a.destroy,n!==null&&g1(n,a.deps)){i.memoizedState=Lc(t,r,s,n);return}}Et.flags|=e,i.memoizedState=Lc(1|t,r,s,n)}function Px(e,t){return Wf(8390656,8,e,t)}function x1(e,t){return C0(2048,8,e,t)}function v2(e,t){return C0(4,2,e,t)}function _2(e,t){return C0(4,4,e,t)}function x2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function y2(e,t,r){return r=r!=null?r.concat([e]):null,C0(4,4,x2.bind(null,t,e),r)}function y1(){}function E2(e,t){var r=Nn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&g1(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function w2(e,t){var r=Nn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&g1(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function T2(e,t,r){return ya&21?(Kn(r,t)||(r=ST(),Et.lanes|=r,Ea|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Zr=!0),e.memoizedState=r)}function eF(e,t){var r=rt;rt=r!==0&&4>r?r:4,e(!0);var n=Xd.transition;Xd.transition={};try{e(!1),t()}finally{rt=r,Xd.transition=n}}function k2(){return Nn().memoizedState}function tF(e,t,r){var n=ks(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},A2(e))S2(t,r);else if(r=r2(e,t,r,n),r!==null){var i=zr();Wn(r,e,n,i),I2(r,t,n)}}function rF(e,t,r){var n=ks(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(A2(e))S2(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Kn(o,a)){var l=t.interleaved;l===null?(i.next=i,f1(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=r2(e,t,i,n),r!==null&&(i=zr(),Wn(r,e,n,i),I2(r,t,n))}}function A2(e){var t=e.alternate;return e===Et||t!==null&&t===Et}function S2(e,t){Jl=Th=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function I2(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Qg(e,r)}}var kh={readContext:Fn,useCallback:gr,useContext:gr,useEffect:gr,useImperativeHandle:gr,useInsertionEffect:gr,useLayoutEffect:gr,useMemo:gr,useReducer:gr,useRef:gr,useState:gr,useDebugValue:gr,useDeferredValue:gr,useTransition:gr,useMutableSource:gr,useSyncExternalStore:gr,useId:gr,unstable_isNewReconciler:!1},nF={readContext:Fn,useCallback:function(e,t){return ti().memoizedState=[e,t===void 0?null:t],e},useContext:Fn,useEffect:Px,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Wf(4194308,4,x2.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Wf(4194308,4,e,t)},useInsertionEffect:function(e,t){return Wf(4,2,e,t)},useMemo:function(e,t){var r=ti();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ti();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=tF.bind(null,Et,e),[n.memoizedState,e]},useRef:function(e){var t=ti();return e={current:e},t.memoizedState=e},useState:Rx,useDebugValue:y1,useDeferredValue:function(e){return ti().memoizedState=e},useTransition:function(){var e=Rx(!1),t=e[0];return e=eF.bind(null,e[1]),ti().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Et,i=ti();if(vt){if(r===void 0)throw Error(le(407));r=r()}else{if(r=t(),er===null)throw Error(le(349));ya&30||f2(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Px(d2.bind(null,n,s,e),[e]),n.flags|=2048,Lc(9,h2.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=ti(),t=er.identifierPrefix;if(vt){var r=Ii,n=Si;r=(n&~(1<<32-Hn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Dc++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=ZP++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},iF={readContext:Fn,useCallback:E2,useContext:Fn,useEffect:x1,useImperativeHandle:y2,useInsertionEffect:v2,useLayoutEffect:_2,useMemo:w2,useReducer:Yd,useRef:g2,useState:function(){return Yd(Oc)},useDebugValue:y1,useDeferredValue:function(e){var t=Nn();return T2(t,Ht.memoizedState,e)},useTransition:function(){var e=Yd(Oc)[0],t=Nn().memoizedState;return[e,t]},useMutableSource:c2,useSyncExternalStore:u2,useId:k2,unstable_isNewReconciler:!1},sF={readContext:Fn,useCallback:E2,useContext:Fn,useEffect:x1,useImperativeHandle:y2,useInsertionEffect:v2,useLayoutEffect:_2,useMemo:w2,useReducer:Qd,useRef:g2,useState:function(){return Qd(Oc)},useDebugValue:y1,useDeferredValue:function(e){var t=Nn();return Ht===null?t.memoizedState=e:T2(t,Ht.memoizedState,e)},useTransition:function(){var e=Qd(Oc)[0],t=Nn().memoizedState;return[e,t]},useMutableSource:c2,useSyncExternalStore:u2,useId:k2,unstable_isNewReconciler:!1};function bo(e,t){try{var r="",n=t;do r+=D4(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Jd(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Rm(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var aF=typeof WeakMap=="function"?WeakMap:Map;function C2(e,t,r){r=Ni(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Sh||(Sh=!0,Bm=n),Rm(e,t)},r}function R2(e,t,r){r=Ni(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Rm(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Rm(e,t),typeof n!="function"&&(Ts===null?Ts=new Set([this]):Ts.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function Fx(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new aF;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=yF.bind(null,e,t,r),t.then(e,e))}function Nx(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Dx(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ni(-1,1),t.tag=2,ws(r,t,1))),r.lanes|=1),e)}var oF=Wi.ReactCurrentOwner,Zr=!1;function br(e,t,r,n){t.child=e===null?o2(t,null,r,n):Lo(t,e.child,r,n)}function Ox(e,t,r,n,i){r=r.render;var s=t.ref;return wo(t,i),n=v1(e,t,r,n,s,i),r=_1(),e!==null&&!Zr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Bi(e,t,i)):(vt&&r&&s1(t),t.flags|=1,br(e,t,n,i),t.child)}function Lx(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!C1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,P2(e,t,s,n,i)):(e=Xf(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Ic,r(a,n)&&e.ref===t.ref)return Bi(e,t,i)}return t.flags|=1,e=As(s,n),e.ref=t.ref,e.return=t,t.child=e}function P2(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(Ic(s,n)&&e.ref===t.ref)if(Zr=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(Zr=!0);else return t.lanes=e.lanes,Bi(e,t,i)}return Pm(e,t,r,n,i)}function F2(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},at(ho,an),an|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,at(ho,an),an|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,at(ho,an),an|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,at(ho,an),an|=n;return br(e,t,i,r),t.child}function N2(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Pm(e,t,r,n,i){var s=rn(r)?_a:Pr.current;return s=Do(t,s),wo(t,i),r=v1(e,t,r,n,s,i),n=_1(),e!==null&&!Zr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Bi(e,t,i)):(vt&&n&&s1(t),t.flags|=1,br(e,t,r,i),t.child)}function Mx(e,t,r,n,i){if(rn(r)){var s=!0;gh(t)}else s=!1;if(wo(t,i),t.stateNode===null)Gf(e,t),s2(t,r,n),Cm(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=Fn(c):(c=rn(r)?_a:Pr.current,c=Do(t,c));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&Ix(t,a,n,c),Zi=!1;var h=t.memoizedState;a.state=h,Eh(t,n,a,i),l=t.memoizedState,o!==n||h!==l||tn.current||Zi?(typeof u=="function"&&(Im(t,r,u,n),l=t.memoizedState),(o=Zi||Sx(t,r,o,n,h,l,c))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,n2(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Vn(t.type,o),a.props=c,f=t.pendingProps,h=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Fn(l):(l=rn(r)?_a:Pr.current,l=Do(t,l));var d=r.getDerivedStateFromProps;(u=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==f||h!==l)&&Ix(t,a,n,l),Zi=!1,h=t.memoizedState,a.state=h,Eh(t,n,a,i);var p=t.memoizedState;o!==f||h!==p||tn.current||Zi?(typeof d=="function"&&(Im(t,r,d,n),p=t.memoizedState),(c=Zi||Sx(t,r,c,n,h,p,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,p,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,p,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),a.props=n,a.state=p,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Fm(e,t,r,n,s,i)}function Fm(e,t,r,n,i,s){N2(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&Ex(t,r,!1),Bi(e,t,s);n=t.stateNode,oF.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=Lo(t,e.child,null,s),t.child=Lo(t,null,o,s)):br(e,t,o,s),t.memoizedState=n.state,i&&Ex(t,r,!0),t.child}function D2(e){var t=e.stateNode;t.pendingContext?yx(e,t.pendingContext,t.pendingContext!==t.context):t.context&&yx(e,t.context,!1),d1(e,t.containerInfo)}function bx(e,t,r,n,i){return Oo(),o1(i),t.flags|=256,br(e,t,r,n),t.child}var Nm={dehydrated:null,treeContext:null,retryLane:0};function Dm(e){return{baseLanes:e,cachePool:null,transitions:null}}function O2(e,t,r){var n=t.pendingProps,i=yt.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),at(yt,i&1),e===null)return Am(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=F0(a,n,0,null),e=ha(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Dm(r),t.memoizedState=Nm,e):E1(t,a));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return lF(e,t,a,n,o,i,r);if(s){s=n.fallback,a=t.mode,i=e.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=As(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=As(o,s):(s=ha(s,a,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?Dm(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=Nm,n}return s=e.child,e=s.sibling,n=As(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function E1(e,t){return t=F0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function uf(e,t,r,n){return n!==null&&o1(n),Lo(t,e.child,null,r),e=E1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function lF(e,t,r,n,i,s,a){if(r)return t.flags&256?(t.flags&=-257,n=Jd(Error(le(422))),uf(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=F0({mode:"visible",children:n.children},i,0,null),s=ha(s,i,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Lo(t,e.child,null,a),t.child.memoizedState=Dm(a),t.memoizedState=Nm,s);if(!(t.mode&1))return uf(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(le(419)),n=Jd(s,n,void 0),uf(e,t,a,n)}if(o=(a&e.childLanes)!==0,Zr||o){if(n=er,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Vi(e,i),Wn(n,e,i,-1))}return I1(),n=Jd(Error(le(421))),uf(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=EF.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,fn=Es(i.nextSibling),mn=t,vt=!0,Un=null,e!==null&&(An[Sn++]=Si,An[Sn++]=Ii,An[Sn++]=xa,Si=e.id,Ii=e.overflow,xa=t),t=E1(t,n.children),t.flags|=4096,t)}function Vx(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Sm(e.return,t,r)}function Zd(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function L2(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(br(e,t,n.children,r),n=yt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Vx(e,r,t);else if(e.tag===19)Vx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(at(yt,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&wh(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Zd(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&wh(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Zd(t,!0,r,null,s);break;case"together":Zd(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Gf(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Bi(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ea|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(le(153));if(t.child!==null){for(e=t.child,r=As(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=As(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function cF(e,t,r){switch(t.tag){case 3:D2(t),Oo();break;case 5:l2(t);break;case 1:rn(t.type)&&gh(t);break;case 4:d1(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;at(xh,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(at(yt,yt.current&1),t.flags|=128,null):r&t.child.childLanes?O2(e,t,r):(at(yt,yt.current&1),e=Bi(e,t,r),e!==null?e.sibling:null);at(yt,yt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return L2(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),at(yt,yt.current),n)break;return null;case 22:case 23:return t.lanes=0,F2(e,t,r)}return Bi(e,t,r)}var M2,Om,b2,V2;M2=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Om=function(){};b2=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,sa(ci.current);var s=null;switch(r){case"input":i=rm(e,i),n=rm(e,n),s=[];break;case"select":i=wt({},i,{value:void 0}),n=wt({},n,{value:void 0}),s=[];break;case"textarea":i=sm(e,i),n=sm(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=ph)}om(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(yc.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(yc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&lt("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};V2=function(e,t,r,n){r!==n&&(t.flags|=4)};function kl(e,t){if(!vt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function vr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function uF(e,t,r){var n=t.pendingProps;switch(a1(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vr(t),null;case 1:return rn(t.type)&&mh(),vr(t),null;case 3:return n=t.stateNode,Mo(),ht(tn),ht(Pr),m1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(lf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Un!==null&&(jm(Un),Un=null))),Om(e,t),vr(t),null;case 5:p1(t);var i=sa(Nc.current);if(r=t.type,e!==null&&t.stateNode!=null)b2(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(le(166));return vr(t),null}if(e=sa(ci.current),lf(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[ri]=t,n[Pc]=s,e=(t.mode&1)!==0,r){case"dialog":lt("cancel",n),lt("close",n);break;case"iframe":case"object":case"embed":lt("load",n);break;case"video":case"audio":for(i=0;i<Ol.length;i++)lt(Ol[i],n);break;case"source":lt("error",n);break;case"img":case"image":case"link":lt("error",n),lt("load",n);break;case"details":lt("toggle",n);break;case"input":K_(n,s),lt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},lt("invalid",n);break;case"textarea":X_(n,s),lt("invalid",n)}om(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&of(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&of(n.textContent,o,e),i=["children",""+o]):yc.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&lt("scroll",n)}switch(r){case"input":Ju(n),q_(n,s,!0);break;case"textarea":Ju(n),Y_(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=ph)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=fT(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[ri]=t,e[Pc]=n,M2(e,t,!1,!1),t.stateNode=e;e:{switch(a=lm(r,n),r){case"dialog":lt("cancel",e),lt("close",e),i=n;break;case"iframe":case"object":case"embed":lt("load",e),i=n;break;case"video":case"audio":for(i=0;i<Ol.length;i++)lt(Ol[i],e);i=n;break;case"source":lt("error",e),i=n;break;case"img":case"image":case"link":lt("error",e),lt("load",e),i=n;break;case"details":lt("toggle",e),i=n;break;case"input":K_(e,n),i=rm(e,n),lt("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=wt({},n,{value:void 0}),lt("invalid",e);break;case"textarea":X_(e,n),i=sm(e,n),lt("invalid",e);break;default:i=n}om(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?pT(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&hT(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Ec(e,l):typeof l=="number"&&Ec(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(yc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&lt("scroll",e):l!=null&&Wg(e,s,l,a))}switch(r){case"input":Ju(e),q_(e,n,!1);break;case"textarea":Ju(e),Y_(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Fs(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?_o(e,!!n.multiple,s,!1):n.defaultValue!=null&&_o(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=ph)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return vr(t),null;case 6:if(e&&t.stateNode!=null)V2(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(le(166));if(r=sa(Nc.current),sa(ci.current),lf(t)){if(n=t.stateNode,r=t.memoizedProps,n[ri]=t,(s=n.nodeValue!==r)&&(e=mn,e!==null))switch(e.tag){case 3:of(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&of(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ri]=t,t.stateNode=n}return vr(t),null;case 13:if(ht(yt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(vt&&fn!==null&&t.mode&1&&!(t.flags&128))t2(),Oo(),t.flags|=98560,s=!1;else if(s=lf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(le(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(le(317));s[ri]=t}else Oo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;vr(t),s=!1}else Un!==null&&(jm(Un),Un=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||yt.current&1?Wt===0&&(Wt=3):I1())),t.updateQueue!==null&&(t.flags|=4),vr(t),null);case 4:return Mo(),Om(e,t),e===null&&Cc(t.stateNode.containerInfo),vr(t),null;case 10:return u1(t.type._context),vr(t),null;case 17:return rn(t.type)&&mh(),vr(t),null;case 19:if(ht(yt),s=t.memoizedState,s===null)return vr(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)kl(s,!1);else{if(Wt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=wh(e),a!==null){for(t.flags|=128,kl(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return at(yt,yt.current&1|2),t.child}e=e.sibling}s.tail!==null&&Pt()>Vo&&(t.flags|=128,n=!0,kl(s,!1),t.lanes=4194304)}else{if(!n)if(e=wh(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),kl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!vt)return vr(t),null}else 2*Pt()-s.renderingStartTime>Vo&&r!==1073741824&&(t.flags|=128,n=!0,kl(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Pt(),t.sibling=null,r=yt.current,at(yt,n?r&1|2:r&1),t):(vr(t),null);case 22:case 23:return S1(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?an&1073741824&&(vr(t),t.subtreeFlags&6&&(t.flags|=8192)):vr(t),null;case 24:return null;case 25:return null}throw Error(le(156,t.tag))}function fF(e,t){switch(a1(t),t.tag){case 1:return rn(t.type)&&mh(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Mo(),ht(tn),ht(Pr),m1(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return p1(t),null;case 13:if(ht(yt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(le(340));Oo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ht(yt),null;case 4:return Mo(),null;case 10:return u1(t.type._context),null;case 22:case 23:return S1(),null;case 24:return null;default:return null}}var ff=!1,Tr=!1,hF=typeof WeakSet=="function"?WeakSet:Set,Ae=null;function fo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){At(e,t,n)}else r.current=null}function Lm(e,t,r){try{r()}catch(n){At(e,t,n)}}var Bx=!1;function dF(e,t){if(_m=fh,e=jT(),i1(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,u=0,f=e,h=null;t:for(;;){for(var d;f!==r||i!==0&&f.nodeType!==3||(o=a+i),f!==s||n!==0&&f.nodeType!==3||(l=a+n),f.nodeType===3&&(a+=f.nodeValue.length),(d=f.firstChild)!==null;)h=f,f=d;for(;;){if(f===e)break t;if(h===r&&++c===i&&(o=a),h===s&&++u===n&&(l=a),(d=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=d}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(xm={focusedElem:e,selectionRange:r},fh=!1,Ae=t;Ae!==null;)if(t=Ae,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ae=e;else for(;Ae!==null;){t=Ae;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,v=p.memoizedState,x=t.stateNode,_=x.getSnapshotBeforeUpdate(t.elementType===t.type?m:Vn(t.type,m),v);x.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(le(163))}}catch(w){At(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,Ae=e;break}Ae=t.return}return p=Bx,Bx=!1,p}function Zl(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&Lm(t,r,s)}i=i.next}while(i!==n)}}function R0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Mm(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function B2(e){var t=e.alternate;t!==null&&(e.alternate=null,B2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ri],delete t[Pc],delete t[wm],delete t[XP],delete t[YP])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function U2(e){return e.tag===5||e.tag===3||e.tag===4}function Ux(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||U2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function bm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=ph));else if(n!==4&&(e=e.child,e!==null))for(bm(e,t,r),e=e.sibling;e!==null;)bm(e,t,r),e=e.sibling}function Vm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Vm(e,t,r),e=e.sibling;e!==null;)Vm(e,t,r),e=e.sibling}var ir=null,Bn=!1;function qi(e,t,r){for(r=r.child;r!==null;)$2(e,t,r),r=r.sibling}function $2(e,t,r){if(li&&typeof li.onCommitFiberUnmount=="function")try{li.onCommitFiberUnmount(E0,r)}catch{}switch(r.tag){case 5:Tr||fo(r,t);case 6:var n=ir,i=Bn;ir=null,qi(e,t,r),ir=n,Bn=i,ir!==null&&(Bn?(e=ir,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ir.removeChild(r.stateNode));break;case 18:ir!==null&&(Bn?(e=ir,r=r.stateNode,e.nodeType===8?Gd(e.parentNode,r):e.nodeType===1&&Gd(e,r),Ac(e)):Gd(ir,r.stateNode));break;case 4:n=ir,i=Bn,ir=r.stateNode.containerInfo,Bn=!0,qi(e,t,r),ir=n,Bn=i;break;case 0:case 11:case 14:case 15:if(!Tr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Lm(r,t,a),i=i.next}while(i!==n)}qi(e,t,r);break;case 1:if(!Tr&&(fo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){At(r,t,o)}qi(e,t,r);break;case 21:qi(e,t,r);break;case 22:r.mode&1?(Tr=(n=Tr)||r.memoizedState!==null,qi(e,t,r),Tr=n):qi(e,t,r);break;default:qi(e,t,r)}}function $x(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new hF),t.forEach(function(n){var i=wF.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Ln(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:ir=o.stateNode,Bn=!1;break e;case 3:ir=o.stateNode.containerInfo,Bn=!0;break e;case 4:ir=o.stateNode.containerInfo,Bn=!0;break e}o=o.return}if(ir===null)throw Error(le(160));$2(s,a,i),ir=null,Bn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){At(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)j2(t,e),t=t.sibling}function j2(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ln(t,e),Jn(e),n&4){try{Zl(3,e,e.return),R0(3,e)}catch(m){At(e,e.return,m)}try{Zl(5,e,e.return)}catch(m){At(e,e.return,m)}}break;case 1:Ln(t,e),Jn(e),n&512&&r!==null&&fo(r,r.return);break;case 5:if(Ln(t,e),Jn(e),n&512&&r!==null&&fo(r,r.return),e.flags&32){var i=e.stateNode;try{Ec(i,"")}catch(m){At(e,e.return,m)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&cT(i,s),lm(o,a);var c=lm(o,s);for(a=0;a<l.length;a+=2){var u=l[a],f=l[a+1];u==="style"?pT(i,f):u==="dangerouslySetInnerHTML"?hT(i,f):u==="children"?Ec(i,f):Wg(i,u,f,c)}switch(o){case"input":nm(i,s);break;case"textarea":uT(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var d=s.value;d!=null?_o(i,!!s.multiple,d,!1):h!==!!s.multiple&&(s.defaultValue!=null?_o(i,!!s.multiple,s.defaultValue,!0):_o(i,!!s.multiple,s.multiple?[]:"",!1))}i[Pc]=s}catch(m){At(e,e.return,m)}}break;case 6:if(Ln(t,e),Jn(e),n&4){if(e.stateNode===null)throw Error(le(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(m){At(e,e.return,m)}}break;case 3:if(Ln(t,e),Jn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ac(t.containerInfo)}catch(m){At(e,e.return,m)}break;case 4:Ln(t,e),Jn(e);break;case 13:Ln(t,e),Jn(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(k1=Pt())),n&4&&$x(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Tr=(c=Tr)||u,Ln(t,e),Tr=c):Ln(t,e),Jn(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(Ae=e,u=e.child;u!==null;){for(f=Ae=u;Ae!==null;){switch(h=Ae,d=h.child,h.tag){case 0:case 11:case 14:case 15:Zl(4,h,h.return);break;case 1:fo(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){At(n,r,m)}}break;case 5:fo(h,h.return);break;case 22:if(h.memoizedState!==null){zx(f);continue}}d!==null?(d.return=h,Ae=d):zx(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,l=f.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=dT("display",a))}catch(m){At(e,e.return,m)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(m){At(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ln(t,e),Jn(e),n&4&&$x(e);break;case 21:break;default:Ln(t,e),Jn(e)}}function Jn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(U2(r)){var n=r;break e}r=r.return}throw Error(le(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Ec(i,""),n.flags&=-33);var s=Ux(e);Vm(e,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=Ux(e);bm(e,o,a);break;default:throw Error(le(161))}}catch(l){At(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function pF(e,t,r){Ae=e,z2(e)}function z2(e,t,r){for(var n=(e.mode&1)!==0;Ae!==null;){var i=Ae,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||ff;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Tr;o=ff;var c=Tr;if(ff=a,(Tr=l)&&!c)for(Ae=i;Ae!==null;)a=Ae,l=a.child,a.tag===22&&a.memoizedState!==null?Hx(i):l!==null?(l.return=a,Ae=l):Hx(i);for(;s!==null;)Ae=s,z2(s),s=s.sibling;Ae=i,ff=o,Tr=c}jx(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Ae=s):jx(e)}}function jx(e){for(;Ae!==null;){var t=Ae;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Tr||R0(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Tr)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Vn(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Ax(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Ax(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Ac(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(le(163))}Tr||t.flags&512&&Mm(t)}catch(h){At(t,t.return,h)}}if(t===e){Ae=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ae=r;break}Ae=t.return}}function zx(e){for(;Ae!==null;){var t=Ae;if(t===e){Ae=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ae=r;break}Ae=t.return}}function Hx(e){for(;Ae!==null;){var t=Ae;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{R0(4,t)}catch(l){At(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){At(t,i,l)}}var s=t.return;try{Mm(t)}catch(l){At(t,s,l)}break;case 5:var a=t.return;try{Mm(t)}catch(l){At(t,a,l)}}}catch(l){At(t,t.return,l)}if(t===e){Ae=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ae=o;break}Ae=t.return}}var mF=Math.ceil,Ah=Wi.ReactCurrentDispatcher,w1=Wi.ReactCurrentOwner,Pn=Wi.ReactCurrentBatchConfig,Je=0,er=null,bt=null,cr=0,an=0,ho=$s(0),Wt=0,Mc=null,Ea=0,P0=0,T1=0,ec=null,Qr=null,k1=0,Vo=1/0,ki=null,Sh=!1,Bm=null,Ts=null,hf=!1,us=null,Ih=0,tc=0,Um=null,Kf=-1,qf=0;function zr(){return Je&6?Pt():Kf!==-1?Kf:Kf=Pt()}function ks(e){return e.mode&1?Je&2&&cr!==0?cr&-cr:JP.transition!==null?(qf===0&&(qf=ST()),qf):(e=rt,e!==0||(e=window.event,e=e===void 0?16:DT(e.type)),e):1}function Wn(e,t,r,n){if(50<tc)throw tc=0,Um=null,Error(le(185));du(e,r,n),(!(Je&2)||e!==er)&&(e===er&&(!(Je&2)&&(P0|=r),Wt===4&&ts(e,cr)),nn(e,n),r===1&&Je===0&&!(t.mode&1)&&(Vo=Pt()+500,S0&&js()))}function nn(e,t){var r=e.callbackNode;J4(e,t);var n=uh(e,e===er?cr:0);if(n===0)r!==null&&Z_(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Z_(r),t===1)e.tag===0?QP(Wx.bind(null,e)):JT(Wx.bind(null,e)),KP(function(){!(Je&6)&&js()}),r=null;else{switch(IT(n)){case 1:r=Yg;break;case 4:r=kT;break;case 16:r=ch;break;case 536870912:r=AT;break;default:r=ch}r=Q2(r,H2.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function H2(e,t){if(Kf=-1,qf=0,Je&6)throw Error(le(327));var r=e.callbackNode;if(To()&&e.callbackNode!==r)return null;var n=uh(e,e===er?cr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Ch(e,n);else{t=n;var i=Je;Je|=2;var s=G2();(er!==e||cr!==t)&&(ki=null,Vo=Pt()+500,fa(e,t));do try{_F();break}catch(o){W2(e,o)}while(1);c1(),Ah.current=s,Je=i,bt!==null?t=0:(er=null,cr=0,t=Wt)}if(t!==0){if(t===2&&(i=dm(e),i!==0&&(n=i,t=$m(e,i))),t===1)throw r=Mc,fa(e,0),ts(e,n),nn(e,Pt()),r;if(t===6)ts(e,n);else{if(i=e.current.alternate,!(n&30)&&!gF(i)&&(t=Ch(e,n),t===2&&(s=dm(e),s!==0&&(n=s,t=$m(e,s))),t===1))throw r=Mc,fa(e,0),ts(e,n),nn(e,Pt()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(le(345));case 2:Js(e,Qr,ki);break;case 3:if(ts(e,n),(n&130023424)===n&&(t=k1+500-Pt(),10<t)){if(uh(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){zr(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Em(Js.bind(null,e,Qr,ki),t);break}Js(e,Qr,ki);break;case 4:if(ts(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-Hn(n);s=1<<a,a=t[a],a>i&&(i=a),n&=~s}if(n=i,n=Pt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*mF(n/1960))-n,10<n){e.timeoutHandle=Em(Js.bind(null,e,Qr,ki),n);break}Js(e,Qr,ki);break;case 5:Js(e,Qr,ki);break;default:throw Error(le(329))}}}return nn(e,Pt()),e.callbackNode===r?H2.bind(null,e):null}function $m(e,t){var r=ec;return e.current.memoizedState.isDehydrated&&(fa(e,t).flags|=256),e=Ch(e,t),e!==2&&(t=Qr,Qr=r,t!==null&&jm(t)),e}function jm(e){Qr===null?Qr=e:Qr.push.apply(Qr,e)}function gF(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Kn(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ts(e,t){for(t&=~T1,t&=~P0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Hn(t),n=1<<r;e[r]=-1,t&=~n}}function Wx(e){if(Je&6)throw Error(le(327));To();var t=uh(e,0);if(!(t&1))return nn(e,Pt()),null;var r=Ch(e,t);if(e.tag!==0&&r===2){var n=dm(e);n!==0&&(t=n,r=$m(e,n))}if(r===1)throw r=Mc,fa(e,0),ts(e,t),nn(e,Pt()),r;if(r===6)throw Error(le(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Js(e,Qr,ki),nn(e,Pt()),null}function A1(e,t){var r=Je;Je|=1;try{return e(t)}finally{Je=r,Je===0&&(Vo=Pt()+500,S0&&js())}}function wa(e){us!==null&&us.tag===0&&!(Je&6)&&To();var t=Je;Je|=1;var r=Pn.transition,n=rt;try{if(Pn.transition=null,rt=1,e)return e()}finally{rt=n,Pn.transition=r,Je=t,!(Je&6)&&js()}}function S1(){an=ho.current,ht(ho)}function fa(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,GP(r)),bt!==null)for(r=bt.return;r!==null;){var n=r;switch(a1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&mh();break;case 3:Mo(),ht(tn),ht(Pr),m1();break;case 5:p1(n);break;case 4:Mo();break;case 13:ht(yt);break;case 19:ht(yt);break;case 10:u1(n.type._context);break;case 22:case 23:S1()}r=r.return}if(er=e,bt=e=As(e.current,null),cr=an=t,Wt=0,Mc=null,T1=P0=Ea=0,Qr=ec=null,ia!==null){for(t=0;t<ia.length;t++)if(r=ia[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}ia=null}return e}function W2(e,t){do{var r=bt;try{if(c1(),Hf.current=kh,Th){for(var n=Et.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Th=!1}if(ya=0,Zt=Ht=Et=null,Jl=!1,Dc=0,w1.current=null,r===null||r.return===null){Wt=1,Mc=t,bt=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=cr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var d=Nx(a);if(d!==null){d.flags&=-257,Dx(d,a,o,s,t),d.mode&1&&Fx(s,c,t),t=d,l=c;var p=t.updateQueue;if(p===null){var m=new Set;m.add(l),t.updateQueue=m}else p.add(l);break e}else{if(!(t&1)){Fx(s,c,t),I1();break e}l=Error(le(426))}}else if(vt&&o.mode&1){var v=Nx(a);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Dx(v,a,o,s,t),o1(bo(l,o));break e}}s=l=bo(l,o),Wt!==4&&(Wt=2),ec===null?ec=[s]:ec.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=C2(s,l,t);kx(s,x);break e;case 1:o=l;var _=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Ts===null||!Ts.has(g)))){s.flags|=65536,t&=-t,s.lanes|=t;var w=R2(s,o,t);kx(s,w);break e}}s=s.return}while(s!==null)}q2(r)}catch(T){t=T,bt===r&&r!==null&&(bt=r=r.return);continue}break}while(1)}function G2(){var e=Ah.current;return Ah.current=kh,e===null?kh:e}function I1(){(Wt===0||Wt===3||Wt===2)&&(Wt=4),er===null||!(Ea&268435455)&&!(P0&268435455)||ts(er,cr)}function Ch(e,t){var r=Je;Je|=2;var n=G2();(er!==e||cr!==t)&&(ki=null,fa(e,t));do try{vF();break}catch(i){W2(e,i)}while(1);if(c1(),Je=r,Ah.current=n,bt!==null)throw Error(le(261));return er=null,cr=0,Wt}function vF(){for(;bt!==null;)K2(bt)}function _F(){for(;bt!==null&&!z4();)K2(bt)}function K2(e){var t=Y2(e.alternate,e,an);e.memoizedProps=e.pendingProps,t===null?q2(e):bt=t,w1.current=null}function q2(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=fF(r,t),r!==null){r.flags&=32767,bt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Wt=6,bt=null;return}}else if(r=uF(r,t,an),r!==null){bt=r;return}if(t=t.sibling,t!==null){bt=t;return}bt=t=e}while(t!==null);Wt===0&&(Wt=5)}function Js(e,t,r){var n=rt,i=Pn.transition;try{Pn.transition=null,rt=1,xF(e,t,r,n)}finally{Pn.transition=i,rt=n}return null}function xF(e,t,r,n){do To();while(us!==null);if(Je&6)throw Error(le(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(le(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(Z4(e,s),e===er&&(bt=er=null,cr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||hf||(hf=!0,Q2(ch,function(){return To(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Pn.transition,Pn.transition=null;var a=rt;rt=1;var o=Je;Je|=4,w1.current=null,dF(e,r),j2(r,e),BP(xm),fh=!!_m,xm=_m=null,e.current=r,pF(r),H4(),Je=o,rt=a,Pn.transition=s}else e.current=r;if(hf&&(hf=!1,us=e,Ih=i),s=e.pendingLanes,s===0&&(Ts=null),K4(r.stateNode),nn(e,Pt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Sh)throw Sh=!1,e=Bm,Bm=null,e;return Ih&1&&e.tag!==0&&To(),s=e.pendingLanes,s&1?e===Um?tc++:(tc=0,Um=e):tc=0,js(),null}function To(){if(us!==null){var e=IT(Ih),t=Pn.transition,r=rt;try{if(Pn.transition=null,rt=16>e?16:e,us===null)var n=!1;else{if(e=us,us=null,Ih=0,Je&6)throw Error(le(331));var i=Je;for(Je|=4,Ae=e.current;Ae!==null;){var s=Ae,a=s.child;if(Ae.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ae=c;Ae!==null;){var u=Ae;switch(u.tag){case 0:case 11:case 15:Zl(8,u,s)}var f=u.child;if(f!==null)f.return=u,Ae=f;else for(;Ae!==null;){u=Ae;var h=u.sibling,d=u.return;if(B2(u),u===c){Ae=null;break}if(h!==null){h.return=d,Ae=h;break}Ae=d}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}Ae=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Ae=a;else e:for(;Ae!==null;){if(s=Ae,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Zl(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,Ae=x;break e}Ae=s.return}}var _=e.current;for(Ae=_;Ae!==null;){a=Ae;var g=a.child;if(a.subtreeFlags&2064&&g!==null)g.return=a,Ae=g;else e:for(a=_;Ae!==null;){if(o=Ae,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:R0(9,o)}}catch(T){At(o,o.return,T)}if(o===a){Ae=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,Ae=w;break e}Ae=o.return}}if(Je=i,js(),li&&typeof li.onPostCommitFiberRoot=="function")try{li.onPostCommitFiberRoot(E0,e)}catch{}n=!0}return n}finally{rt=r,Pn.transition=t}}return!1}function Gx(e,t,r){t=bo(r,t),t=C2(e,t,1),e=ws(e,t,1),t=zr(),e!==null&&(du(e,1,t),nn(e,t))}function At(e,t,r){if(e.tag===3)Gx(e,e,r);else for(;t!==null;){if(t.tag===3){Gx(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ts===null||!Ts.has(n))){e=bo(r,e),e=R2(t,e,1),t=ws(t,e,1),e=zr(),t!==null&&(du(t,1,e),nn(t,e));break}}t=t.return}}function yF(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=zr(),e.pingedLanes|=e.suspendedLanes&r,er===e&&(cr&r)===r&&(Wt===4||Wt===3&&(cr&130023424)===cr&&500>Pt()-k1?fa(e,0):T1|=r),nn(e,t)}function X2(e,t){t===0&&(e.mode&1?(t=tf,tf<<=1,!(tf&130023424)&&(tf=4194304)):t=1);var r=zr();e=Vi(e,t),e!==null&&(du(e,t,r),nn(e,r))}function EF(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),X2(e,r)}function wF(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(le(314))}n!==null&&n.delete(t),X2(e,r)}var Y2;Y2=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||tn.current)Zr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Zr=!1,cF(e,t,r);Zr=!!(e.flags&131072)}else Zr=!1,vt&&t.flags&1048576&&ZT(t,_h,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Gf(e,t),e=t.pendingProps;var i=Do(t,Pr.current);wo(t,r),i=v1(null,t,n,e,i,r);var s=_1();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,rn(n)?(s=!0,gh(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,h1(t),i.updater=I0,t.stateNode=i,i._reactInternals=t,Cm(t,n,e,r),t=Fm(null,t,n,!0,s,r)):(t.tag=0,vt&&s&&s1(t),br(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Gf(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=kF(n),e=Vn(n,e),i){case 0:t=Pm(null,t,n,e,r);break e;case 1:t=Mx(null,t,n,e,r);break e;case 11:t=Ox(null,t,n,e,r);break e;case 14:t=Lx(null,t,n,Vn(n.type,e),r);break e}throw Error(le(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Vn(n,i),Pm(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Vn(n,i),Mx(e,t,n,i,r);case 3:e:{if(D2(t),e===null)throw Error(le(387));n=t.pendingProps,s=t.memoizedState,i=s.element,n2(e,t),Eh(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=bo(Error(le(423)),t),t=bx(e,t,n,r,i);break e}else if(n!==i){i=bo(Error(le(424)),t),t=bx(e,t,n,r,i);break e}else for(fn=Es(t.stateNode.containerInfo.firstChild),mn=t,vt=!0,Un=null,r=o2(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Oo(),n===i){t=Bi(e,t,r);break e}br(e,t,n,r)}t=t.child}return t;case 5:return l2(t),e===null&&Am(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,ym(n,i)?a=null:s!==null&&ym(n,s)&&(t.flags|=32),N2(e,t),br(e,t,a,r),t.child;case 6:return e===null&&Am(t),null;case 13:return O2(e,t,r);case 4:return d1(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Lo(t,null,n,r):br(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Vn(n,i),Ox(e,t,n,i,r);case 7:return br(e,t,t.pendingProps,r),t.child;case 8:return br(e,t,t.pendingProps.children,r),t.child;case 12:return br(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,at(xh,n._currentValue),n._currentValue=a,s!==null)if(Kn(s.value,a)){if(s.children===i.children&&!tn.current){t=Bi(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Ni(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Sm(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(le(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Sm(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}br(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,wo(t,r),i=Fn(i),n=n(i),t.flags|=1,br(e,t,n,r),t.child;case 14:return n=t.type,i=Vn(n,t.pendingProps),i=Vn(n.type,i),Lx(e,t,n,i,r);case 15:return P2(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Vn(n,i),Gf(e,t),t.tag=1,rn(n)?(e=!0,gh(t)):e=!1,wo(t,r),s2(t,n,i),Cm(t,n,i,r),Fm(null,t,n,!0,e,r);case 19:return L2(e,t,r);case 22:return F2(e,t,r)}throw Error(le(156,t.tag))};function Q2(e,t){return TT(e,t)}function TF(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rn(e,t,r,n){return new TF(e,t,r,n)}function C1(e){return e=e.prototype,!(!e||!e.isReactComponent)}function kF(e){if(typeof e=="function")return C1(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Kg)return 11;if(e===qg)return 14}return 2}function As(e,t){var r=e.alternate;return r===null?(r=Rn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Xf(e,t,r,n,i,s){var a=2;if(n=e,typeof e=="function")C1(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case ro:return ha(r.children,i,s,t);case Gg:a=8,i|=8;break;case Jp:return e=Rn(12,r,t,i|2),e.elementType=Jp,e.lanes=s,e;case Zp:return e=Rn(13,r,t,i),e.elementType=Zp,e.lanes=s,e;case em:return e=Rn(19,r,t,i),e.elementType=em,e.lanes=s,e;case aT:return F0(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case iT:a=10;break e;case sT:a=9;break e;case Kg:a=11;break e;case qg:a=14;break e;case Ji:a=16,n=null;break e}throw Error(le(130,e==null?e:typeof e,""))}return t=Rn(a,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function ha(e,t,r,n){return e=Rn(7,e,n,t),e.lanes=r,e}function F0(e,t,r,n){return e=Rn(22,e,n,t),e.elementType=aT,e.lanes=r,e.stateNode={isHidden:!1},e}function ep(e,t,r){return e=Rn(6,e,null,t),e.lanes=r,e}function tp(e,t,r){return t=Rn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function AF(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ld(0),this.expirationTimes=Ld(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ld(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function R1(e,t,r,n,i,s,a,o,l){return e=new AF(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Rn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},h1(s),e}function SF(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:to,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function J2(e){if(!e)return Ns;e=e._reactInternals;e:{if(La(e)!==e||e.tag!==1)throw Error(le(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(rn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(le(171))}if(e.tag===1){var r=e.type;if(rn(r))return QT(e,r,t)}return t}function Z2(e,t,r,n,i,s,a,o,l){return e=R1(r,n,!0,e,i,s,a,o,l),e.context=J2(null),r=e.current,n=zr(),i=ks(r),s=Ni(n,i),s.callback=t??null,ws(r,s,i),e.current.lanes=i,du(e,i,n),nn(e,n),e}function N0(e,t,r,n){var i=t.current,s=zr(),a=ks(i);return r=J2(r),t.context===null?t.context=r:t.pendingContext=r,t=Ni(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ws(i,t,a),e!==null&&(Wn(e,i,a,s),zf(e,i,a)),a}function Rh(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Kx(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function P1(e,t){Kx(e,t),(e=e.alternate)&&Kx(e,t)}function IF(){return null}var ek=typeof reportError=="function"?reportError:function(e){console.error(e)};function F1(e){this._internalRoot=e}D0.prototype.render=F1.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(le(409));N0(e,t,null,null)};D0.prototype.unmount=F1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;wa(function(){N0(null,e,null,null)}),t[bi]=null}};function D0(e){this._internalRoot=e}D0.prototype.unstable_scheduleHydration=function(e){if(e){var t=PT();e={blockedOn:null,target:e,priority:t};for(var r=0;r<es.length&&t!==0&&t<es[r].priority;r++);es.splice(r,0,e),r===0&&NT(e)}};function N1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function O0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function qx(){}function CF(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=Rh(a);s.call(c)}}var a=Z2(t,n,e,0,null,!1,!1,"",qx);return e._reactRootContainer=a,e[bi]=a.current,Cc(e.nodeType===8?e.parentNode:e),wa(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=Rh(l);o.call(c)}}var l=R1(e,0,!1,null,null,!1,!1,"",qx);return e._reactRootContainer=l,e[bi]=l.current,Cc(e.nodeType===8?e.parentNode:e),wa(function(){N0(t,l,r,n)}),l}function L0(e,t,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Rh(a);o.call(l)}}N0(t,a,e,i)}else a=CF(r,t,e,i,n);return Rh(a)}CT=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Dl(t.pendingLanes);r!==0&&(Qg(t,r|1),nn(t,Pt()),!(Je&6)&&(Vo=Pt()+500,js()))}break;case 13:wa(function(){var n=Vi(e,1);if(n!==null){var i=zr();Wn(n,e,1,i)}}),P1(e,1)}};Jg=function(e){if(e.tag===13){var t=Vi(e,134217728);if(t!==null){var r=zr();Wn(t,e,134217728,r)}P1(e,134217728)}};RT=function(e){if(e.tag===13){var t=ks(e),r=Vi(e,t);if(r!==null){var n=zr();Wn(r,e,t,n)}P1(e,t)}};PT=function(){return rt};FT=function(e,t){var r=rt;try{return rt=e,t()}finally{rt=r}};um=function(e,t,r){switch(t){case"input":if(nm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=A0(n);if(!i)throw Error(le(90));lT(n),nm(n,i)}}}break;case"textarea":uT(e,r);break;case"select":t=r.value,t!=null&&_o(e,!!r.multiple,t,!1)}};vT=A1;_T=wa;var RF={usingClientEntryPoint:!1,Events:[mu,ao,A0,mT,gT,A1]},Al={findFiberByHostInstance:na,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},PF={bundleType:Al.bundleType,version:Al.version,rendererPackageName:Al.rendererPackageName,rendererConfig:Al.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Wi.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=ET(e),e===null?null:e.stateNode},findFiberByHostInstance:Al.findFiberByHostInstance||IF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var df=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!df.isDisabled&&df.supportsFiber)try{E0=df.inject(PF),li=df}catch{}}xn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=RF;xn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!N1(t))throw Error(le(200));return SF(e,t,null,r)};xn.createRoot=function(e,t){if(!N1(e))throw Error(le(299));var r=!1,n="",i=ek;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=R1(e,1,!1,null,null,r,!1,n,i),e[bi]=t.current,Cc(e.nodeType===8?e.parentNode:e),new F1(t)};xn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(le(188)):(e=Object.keys(e).join(","),Error(le(268,e)));return e=ET(t),e=e===null?null:e.stateNode,e};xn.flushSync=function(e){return wa(e)};xn.hydrate=function(e,t,r){if(!O0(t))throw Error(le(200));return L0(null,e,t,!0,r)};xn.hydrateRoot=function(e,t,r){if(!N1(e))throw Error(le(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=ek;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=Z2(t,null,e,1,r??null,i,!1,s,a),e[bi]=t.current,Cc(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new D0(t)};xn.render=function(e,t,r){if(!O0(t))throw Error(le(200));return L0(null,e,t,!1,r)};xn.unmountComponentAtNode=function(e){if(!O0(e))throw Error(le(40));return e._reactRootContainer?(wa(function(){L0(null,null,e,!1,function(){e._reactRootContainer=null,e[bi]=null})}),!0):!1};xn.unstable_batchedUpdates=A1;xn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!O0(r))throw Error(le(200));if(e==null||e._reactInternals===void 0)throw Error(le(38));return L0(e,t,r,!1,n)};xn.version="18.2.0-next-9e3b772b8-20220608";function tk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tk)}catch(e){console.error(e)}}tk(),Zw.exports=xn;var FF=Zw.exports,rk,Xx=FF;rk=Xx.createRoot,Xx.hydrateRoot;/**
 * @remix-run/router v1.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bc(){return bc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bc.apply(this,arguments)}var fs;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(fs||(fs={}));const Yx="popstate";function NF(e){e===void 0&&(e={});function t(n,i){let{pathname:s,search:a,hash:o}=n.location;return zm("",{pathname:s,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Ph(i)}return OF(t,r,null,e)}function Ft(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function D1(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function DF(){return Math.random().toString(36).substr(2,8)}function Qx(e,t){return{usr:e.state,key:e.key,idx:t}}function zm(e,t,r,n){return r===void 0&&(r=null),bc({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Zo(t):t,{state:r,key:t&&t.key||n||DF()})}function Ph(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Zo(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function OF(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,a=i.history,o=fs.Pop,l=null,c=u();c==null&&(c=0,a.replaceState(bc({},a.state,{idx:c}),""));function u(){return(a.state||{idx:null}).idx}function f(){o=fs.Pop;let v=u(),x=v==null?null:v-c;c=v,l&&l({action:o,location:m.location,delta:x})}function h(v,x){o=fs.Push;let _=zm(m.location,v,x);r&&r(_,v),c=u()+1;let g=Qx(_,c),w=m.createHref(_);try{a.pushState(g,"",w)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;i.location.assign(w)}s&&l&&l({action:o,location:m.location,delta:1})}function d(v,x){o=fs.Replace;let _=zm(m.location,v,x);r&&r(_,v),c=u();let g=Qx(_,c),w=m.createHref(_);a.replaceState(g,"",w),s&&l&&l({action:o,location:m.location,delta:0})}function p(v){let x=i.location.origin!=="null"?i.location.origin:i.location.href,_=typeof v=="string"?v:Ph(v);return Ft(x,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,x)}let m={get action(){return o},get location(){return e(i,a)},listen(v){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(Yx,f),l=v,()=>{i.removeEventListener(Yx,f),l=null}},createHref(v){return t(i,v)},createURL:p,encodeLocation(v){let x=p(v);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:h,replace:d,go(v){return a.go(v)}};return m}var Jx;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Jx||(Jx={}));function LF(e,t,r){r===void 0&&(r="/");let n=typeof t=="string"?Zo(t):t,i=O1(n.pathname||"/",r);if(i==null)return null;let s=nk(e);MF(s);let a=null;for(let o=0;a==null&&o<s.length;++o)a=WF(s[o],qF(i));return a}function nk(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(Ft(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=Ss([n,l.relativePath]),u=r.concat(l);s.children&&s.children.length>0&&(Ft(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),nk(s.children,t,u,c)),!(s.path==null&&!s.index)&&t.push({path:c,score:zF(c,s.index),routesMeta:u})};return e.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let l of ik(s.path))i(s,a,l)}),t}function ik(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let a=ik(n.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),i&&o.push(...a),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function MF(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:HF(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const bF=/^:\w+$/,VF=3,BF=2,UF=1,$F=10,jF=-2,Zx=e=>e==="*";function zF(e,t){let r=e.split("/"),n=r.length;return r.some(Zx)&&(n+=jF),t&&(n+=BF),r.filter(i=>!Zx(i)).reduce((i,s)=>i+(bF.test(s)?VF:s===""?UF:$F),n)}function HF(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function WF(e,t){let{routesMeta:r}=e,n={},i="/",s=[];for(let a=0;a<r.length;++a){let o=r[a],l=a===r.length-1,c=i==="/"?t:t.slice(i.length)||"/",u=GF({path:o.relativePath,caseSensitive:o.caseSensitive,end:l},c);if(!u)return null;Object.assign(n,u.params);let f=o.route;s.push({params:n,pathname:Ss([i,u.pathname]),pathnameBase:JF(Ss([i,u.pathnameBase])),route:f}),u.pathnameBase!=="/"&&(i=Ss([i,u.pathnameBase]))}return s}function GF(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=KF(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((c,u,f)=>{let{paramName:h,isOptional:d}=u;if(h==="*"){let m=o[f]||"";a=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const p=o[f];return d&&!p?c[h]=void 0:c[h]=XF(p||"",h),c},{}),pathname:s,pathnameBase:a,pattern:e}}function KF(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),D1(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(a,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function qF(e){try{return decodeURI(e)}catch(t){return D1(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function XF(e,t){try{return decodeURIComponent(e)}catch(r){return D1(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+r+").")),e}}function O1(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function YF(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?Zo(e):e;return{pathname:r?r.startsWith("/")?r:QF(r,t):t,search:ZF(n),hash:eN(i)}}function QF(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function rp(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function L1(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function M1(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=Zo(e):(i=bc({},e),Ft(!i.pathname||!i.pathname.includes("?"),rp("?","pathname","search",i)),Ft(!i.pathname||!i.pathname.includes("#"),rp("#","pathname","hash",i)),Ft(!i.search||!i.search.includes("#"),rp("#","search","hash",i)));let s=e===""||i.pathname==="",a=s?"/":i.pathname,o;if(n||a==null)o=r;else{let f=t.length-1;if(a.startsWith("..")){let h=a.split("/");for(;h[0]==="..";)h.shift(),f-=1;i.pathname=h.join("/")}o=f>=0?t[f]:"/"}let l=YF(i,o),c=a&&a!=="/"&&a.endsWith("/"),u=(s||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Ss=e=>e.join("/").replace(/\/\/+/g,"/"),JF=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ZF=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,eN=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function tN(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const sk=["post","put","patch","delete"];new Set(sk);const rN=["get",...sk];new Set(rN);/**
 * React Router v6.18.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fh(){return Fh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fh.apply(this,arguments)}const b1=ee.createContext(null),nN=ee.createContext(null),el=ee.createContext(null),M0=ee.createContext(null),Gi=ee.createContext({outlet:null,matches:[],isDataRoute:!1}),ak=ee.createContext(null);function iN(e,t){let{relative:r}=t===void 0?{}:t;tl()||Ft(!1);let{basename:n,navigator:i}=ee.useContext(el),{hash:s,pathname:a,search:o}=ck(e,{relative:r}),l=a;return n!=="/"&&(l=a==="/"?n:Ss([n,a])),i.createHref({pathname:l,search:o,hash:s})}function tl(){return ee.useContext(M0)!=null}function vu(){return tl()||Ft(!1),ee.useContext(M0).location}function ok(e){ee.useContext(el).static||ee.useLayoutEffect(e)}function Qn(){let{isDataRoute:e}=ee.useContext(Gi);return e?vN():sN()}function sN(){tl()||Ft(!1);let e=ee.useContext(b1),{basename:t,navigator:r}=ee.useContext(el),{matches:n}=ee.useContext(Gi),{pathname:i}=vu(),s=JSON.stringify(L1(n).map(l=>l.pathnameBase)),a=ee.useRef(!1);return ok(()=>{a.current=!0}),ee.useCallback(function(l,c){if(c===void 0&&(c={}),!a.current)return;if(typeof l=="number"){r.go(l);return}let u=M1(l,JSON.parse(s),i,c.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:Ss([t,u.pathname])),(c.replace?r.replace:r.push)(u,c.state,c)},[t,r,s,i,e])}function lk(){let{matches:e}=ee.useContext(Gi),t=e[e.length-1];return t?t.params:{}}function ck(e,t){let{relative:r}=t===void 0?{}:t,{matches:n}=ee.useContext(Gi),{pathname:i}=vu(),s=JSON.stringify(L1(n).map(a=>a.pathnameBase));return ee.useMemo(()=>M1(e,JSON.parse(s),i,r==="path"),[e,s,i,r])}function aN(e,t){return oN(e,t)}function oN(e,t,r){tl()||Ft(!1);let{navigator:n}=ee.useContext(el),{matches:i}=ee.useContext(Gi),s=i[i.length-1],a=s?s.params:{};s&&s.pathname;let o=s?s.pathnameBase:"/";s&&s.route;let l=vu(),c;if(t){var u;let m=typeof t=="string"?Zo(t):t;o==="/"||(u=m.pathname)!=null&&u.startsWith(o)||Ft(!1),c=m}else c=l;let f=c.pathname||"/",h=o==="/"?f:f.slice(o.length)||"/",d=LF(e,{pathname:h}),p=hN(d&&d.map(m=>Object.assign({},m,{params:Object.assign({},a,m.params),pathname:Ss([o,n.encodeLocation?n.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?o:Ss([o,n.encodeLocation?n.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),i,r);return t&&p?ee.createElement(M0.Provider,{value:{location:Fh({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:fs.Pop}},p):p}function lN(){let e=gN(),t=tN(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return ee.createElement(ee.Fragment,null,ee.createElement("h2",null,"Unexpected Application Error!"),ee.createElement("h3",{style:{fontStyle:"italic"}},t),r?ee.createElement("pre",{style:i},r):null,s)}const cN=ee.createElement(lN,null);class uN extends ee.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error||r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error?ee.createElement(Gi.Provider,{value:this.props.routeContext},ee.createElement(ak.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function fN(e){let{routeContext:t,match:r,children:n}=e,i=ee.useContext(b1);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),ee.createElement(Gi.Provider,{value:t},n)}function hN(e,t,r){var n;if(t===void 0&&(t=[]),r===void 0&&(r=null),e==null){var i;if((i=r)!=null&&i.errors)e=r.matches;else return null}let s=e,a=(n=r)==null?void 0:n.errors;if(a!=null){let o=s.findIndex(l=>l.route.id&&(a==null?void 0:a[l.route.id]));o>=0||Ft(!1),s=s.slice(0,Math.min(s.length,o+1))}return s.reduceRight((o,l,c)=>{let u=l.route.id?a==null?void 0:a[l.route.id]:null,f=null;r&&(f=l.route.errorElement||cN);let h=t.concat(s.slice(0,c+1)),d=()=>{let p;return u?p=f:l.route.Component?p=ee.createElement(l.route.Component,null):l.route.element?p=l.route.element:p=o,ee.createElement(fN,{match:l,routeContext:{outlet:o,matches:h,isDataRoute:r!=null},children:p})};return r&&(l.route.ErrorBoundary||l.route.errorElement||c===0)?ee.createElement(uN,{location:r.location,revalidation:r.revalidation,component:f,error:u,children:d(),routeContext:{outlet:null,matches:h,isDataRoute:!0}}):d()},null)}var uk=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(uk||{}),Nh=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Nh||{});function dN(e){let t=ee.useContext(b1);return t||Ft(!1),t}function pN(e){let t=ee.useContext(nN);return t||Ft(!1),t}function mN(e){let t=ee.useContext(Gi);return t||Ft(!1),t}function fk(e){let t=mN(),r=t.matches[t.matches.length-1];return r.route.id||Ft(!1),r.route.id}function gN(){var e;let t=ee.useContext(ak),r=pN(Nh.UseRouteError),n=fk(Nh.UseRouteError);return t||((e=r.errors)==null?void 0:e[n])}function vN(){let{router:e}=dN(uk.UseNavigateStable),t=fk(Nh.UseNavigateStable),r=ee.useRef(!1);return ok(()=>{r.current=!0}),ee.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,Fh({fromRouteId:t},s)))},[e,t])}function Hm(e){let{to:t,replace:r,state:n,relative:i}=e;tl()||Ft(!1);let{matches:s}=ee.useContext(Gi),{pathname:a}=vu(),o=Qn(),l=M1(t,L1(s).map(u=>u.pathnameBase),a,i==="path"),c=JSON.stringify(l);return ee.useEffect(()=>o(JSON.parse(c),{replace:r,state:n,relative:i}),[o,c,i,r,n]),null}function Zs(e){Ft(!1)}function _N(e){let{basename:t="/",children:r=null,location:n,navigationType:i=fs.Pop,navigator:s,static:a=!1}=e;tl()&&Ft(!1);let o=t.replace(/^\/*/,"/"),l=ee.useMemo(()=>({basename:o,navigator:s,static:a}),[o,s,a]);typeof n=="string"&&(n=Zo(n));let{pathname:c="/",search:u="",hash:f="",state:h=null,key:d="default"}=n,p=ee.useMemo(()=>{let m=O1(c,o);return m==null?null:{location:{pathname:m,search:u,hash:f,state:h,key:d},navigationType:i}},[o,c,u,f,h,d,i]);return p==null?null:ee.createElement(el.Provider,{value:l},ee.createElement(M0.Provider,{children:r,value:p}))}function xN(e){let{children:t,location:r}=e;return aN(Wm(t),r)}new Promise(()=>{});function Wm(e,t){t===void 0&&(t=[]);let r=[];return ee.Children.forEach(e,(n,i)=>{if(!ee.isValidElement(n))return;let s=[...t,i];if(n.type===ee.Fragment){r.push.apply(r,Wm(n.props.children,s));return}n.type!==Zs&&Ft(!1),!n.props.index||!n.props.children||Ft(!1);let a={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=Wm(n.props.children,s)),r.push(a)}),r}/**
 * React Router DOM v6.18.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gm(){return Gm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gm.apply(this,arguments)}function yN(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function EN(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function wN(e,t){return e.button===0&&(!t||t==="_self")&&!EN(e)}const TN=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],kN="startTransition",ey=E4[kN];function AN(e){let{basename:t,children:r,future:n,window:i}=e,s=ee.useRef();s.current==null&&(s.current=NF({window:i,v5Compat:!0}));let a=s.current,[o,l]=ee.useState({action:a.action,location:a.location}),{v7_startTransition:c}=n||{},u=ee.useCallback(f=>{c&&ey?ey(()=>l(f)):l(f)},[l,c]);return ee.useLayoutEffect(()=>a.listen(u),[a,u]),ee.createElement(_N,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:a})}const SN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",IN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,np=ee.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:s,replace:a,state:o,target:l,to:c,preventScrollReset:u,unstable_viewTransition:f}=t,h=yN(t,TN),{basename:d}=ee.useContext(el),p,m=!1;if(typeof c=="string"&&IN.test(c)&&(p=c,SN))try{let g=new URL(window.location.href),w=c.startsWith("//")?new URL(g.protocol+c):new URL(c),T=O1(w.pathname,d);w.origin===g.origin&&T!=null?c=T+w.search+w.hash:m=!0}catch{}let v=iN(c,{relative:i}),x=CN(c,{replace:a,state:o,target:l,preventScrollReset:u,relative:i,unstable_viewTransition:f});function _(g){n&&n(g),g.defaultPrevented||x(g)}return ee.createElement("a",Gm({},h,{href:p||v,onClick:m||s?n:_,ref:r,target:l}))});var ty;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(ty||(ty={}));var ry;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(ry||(ry={}));function CN(e,t){let{target:r,replace:n,state:i,preventScrollReset:s,relative:a,unstable_viewTransition:o}=t===void 0?{}:t,l=Qn(),c=vu(),u=ck(e,{relative:a});return ee.useCallback(f=>{if(wN(f,r)){f.preventDefault();let h=n!==void 0?n:Ph(c)===Ph(u);l(e,{replace:h,state:i,preventScrollReset:s,relative:a,unstable_viewTransition:o})}},[c,l,u,n,i,r,e,s,a,o])}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hk=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=i&63|128):(i&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=i&63|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=i&63|128)}return t},RN=function(e){const t=[];let r=0,n=0;for(;r<e.length;){const i=e[r++];if(i<128)t[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[r++];t[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=e[r++],a=e[r++],o=e[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;t[n++]=String.fromCharCode(55296+(l>>10)),t[n++]=String.fromCharCode(56320+(l&1023))}else{const s=e[r++],a=e[r++];t[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return t.join("")},dk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<e.length;i+=3){const s=e[i],a=i+1<e.length,o=a?e[i+1]:0,l=i+2<e.length,c=l?e[i+2]:0,u=s>>2,f=(s&3)<<4|o>>4;let h=(o&15)<<2|c>>6,d=c&63;l||(d=64,a||(h=64)),n.push(r[u],r[f],r[h],r[d])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(hk(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):RN(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<e.length;){const s=r[e.charAt(i++)],o=i<e.length?r[e.charAt(i)]:0;++i;const c=i<e.length?r[e.charAt(i)]:64;++i;const f=i<e.length?r[e.charAt(i)]:64;if(++i,s==null||o==null||c==null||f==null)throw new PN;const h=s<<2|o>>4;if(n.push(h),c!==64){const d=o<<4&240|c>>2;if(n.push(d),f!==64){const p=c<<6&192|f;n.push(p)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class PN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const FN=function(e){const t=hk(e);return dk.encodeByteArray(t,!0)},Dh=function(e){return FN(e).replace(/\./g,"")},pk=function(e){try{return dk.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DN=()=>NN().__FIREBASE_DEFAULTS__,ON=()=>{if(typeof process>"u"||typeof process.env>"u")return;const e={}.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},LN=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&pk(e[1]);return t&&JSON.parse(t)},b0=()=>{try{return DN()||ON()||LN()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},mk=e=>{var t,r;return(r=(t=b0())===null||t===void 0?void 0:t.emulatorHosts)===null||r===void 0?void 0:r[e]},gk=e=>{const t=mk(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),n]:[t.substring(0,r),n]},vk=()=>{var e;return(e=b0())===null||e===void 0?void 0:e.config},_k=e=>{var t;return(t=b0())===null||t===void 0?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xk(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e),o="";return[Dh(JSON.stringify(r)),Dh(JSON.stringify(a)),o].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function bN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fr())}function VN(){var e;const t=(e=b0())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function BN(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function UN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $N(){const e=Fr();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function jN(){try{return typeof indexedDB=="object"}catch{return!1}}function zN(){return new Promise((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;t(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HN="FirebaseError";class xi extends Error{constructor(t,r,n){super(r),this.code=t,this.customData=n,this.name=HN,Object.setPrototypeOf(this,xi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_u.prototype.create)}}class _u{constructor(t,r,n){this.service=t,this.serviceName=r,this.errors=n}create(t,...r){const n=r[0]||{},i=`${this.service}/${t}`,s=this.errors[t],a=s?WN(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new xi(i,o,n)}}function WN(e,t){return e.replace(GN,(r,n)=>{const i=t[n];return i!=null?String(i):`<${n}?>`})}const GN=/\{\$([^}]+)}/g;function KN(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Oh(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const i of r){if(!n.includes(i))return!1;const s=e[i],a=t[i];if(ny(s)&&ny(a)){if(!Oh(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function ny(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xu(e){const t=[];for(const[r,n]of Object.entries(e))Array.isArray(n)?n.forEach(i=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function Ll(e){const t={};return e.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");t[decodeURIComponent(i)]=decodeURIComponent(s)}}),t}function Ml(e){const t=e.indexOf("?");if(!t)return"";const r=e.indexOf("#",t);return e.substring(t,r>0?r:void 0)}function qN(e,t){const r=new XN(e,t);return r.subscribe.bind(r)}class XN{constructor(t,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{t(this)}).catch(n=>{this.error(n)})}next(t){this.forEachObserver(r=>{r.next(t)})}error(t){this.forEachObserver(r=>{r.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,r,n){let i;if(t===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");YN(t,["next","error","complete"])?i=t:i={next:t,error:r,complete:n},i.next===void 0&&(i.next=ip),i.error===void 0&&(i.error=ip),i.complete===void 0&&(i.complete=ip);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,t)}sendOne(t,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{r(this.observers[t])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function YN(e,t){if(typeof e!="object"||e===null)return!1;for(const r of t)if(r in e&&typeof e[r]=="function")return!0;return!1}function ip(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bt(e){return e&&e._delegate?e._delegate:e}class Ds{constructor(t,r,n){this.name=t,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ea="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const n=new MN;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){var r;const n=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),i=(r=t==null?void 0:t.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(ZN(t))try{this.getOrInitializeService({instanceIdentifier:ea})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(t=ea){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=ea){return this.instances.has(t)}getOptions(t=ea){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(t,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&t(a,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:JN(t),options:r}),this.instances.set(t,n),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=ea){return this.component?this.component.multipleInstances?t:ea:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function JN(e){return e===ea?void 0:e}function ZN(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eD{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new QN(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ge;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Ge||(Ge={}));const tD={debug:Ge.DEBUG,verbose:Ge.VERBOSE,info:Ge.INFO,warn:Ge.WARN,error:Ge.ERROR,silent:Ge.SILENT},rD=Ge.INFO,nD={[Ge.DEBUG]:"log",[Ge.VERBOSE]:"log",[Ge.INFO]:"info",[Ge.WARN]:"warn",[Ge.ERROR]:"error"},iD=(e,t,...r)=>{if(t<e.logLevel)return;const n=new Date().toISOString(),i=nD[t];if(i)console[i](`[${n}]  ${e.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class V1{constructor(t){this.name=t,this._logLevel=rD,this._logHandler=iD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Ge))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?tD[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Ge.DEBUG,...t),this._logHandler(this,Ge.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Ge.VERBOSE,...t),this._logHandler(this,Ge.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Ge.INFO,...t),this._logHandler(this,Ge.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Ge.WARN,...t),this._logHandler(this,Ge.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Ge.ERROR,...t),this._logHandler(this,Ge.ERROR,...t)}}const sD=(e,t)=>t.some(r=>e instanceof r);let iy,sy;function aD(){return iy||(iy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function oD(){return sy||(sy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const yk=new WeakMap,Km=new WeakMap,Ek=new WeakMap,sp=new WeakMap,B1=new WeakMap;function lD(e){const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",a)},s=()=>{r(Is(e.result)),i()},a=()=>{n(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",a)});return t.then(r=>{r instanceof IDBCursor&&yk.set(r,e)}).catch(()=>{}),B1.set(t,e),t}function cD(e){if(Km.has(e))return;const t=new Promise((r,n)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",a),e.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",a),e.addEventListener("abort",a)});Km.set(e,t)}let qm={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return Km.get(e);if(t==="objectStoreNames")return e.objectStoreNames||Ek.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Is(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function uD(e){qm=e(qm)}function fD(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const n=e.call(ap(this),t,...r);return Ek.set(n,t.sort?t.sort():[t]),Is(n)}:oD().includes(e)?function(...t){return e.apply(ap(this),t),Is(yk.get(this))}:function(...t){return Is(e.apply(ap(this),t))}}function hD(e){return typeof e=="function"?fD(e):(e instanceof IDBTransaction&&cD(e),sD(e,aD())?new Proxy(e,qm):e)}function Is(e){if(e instanceof IDBRequest)return lD(e);if(sp.has(e))return sp.get(e);const t=hD(e);return t!==e&&(sp.set(e,t),B1.set(t,e)),t}const ap=e=>B1.get(e);function dD(e,t,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(e,t),o=Is(a);return n&&a.addEventListener("upgradeneeded",l=>{n(Is(a.result),l.oldVersion,l.newVersion,Is(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const pD=["get","getKey","getAll","getAllKeys","count"],mD=["put","add","delete","clear"],op=new Map;function ay(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(op.get(t))return op.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,i=mD.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||pD.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return op.set(t,s),s}uD(e=>({...e,get:(t,r,n)=>ay(t,r)||e.get(t,r,n),has:(t,r)=>!!ay(t,r)||e.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(vD(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function vD(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Xm="@firebase/app",oy="0.9.22";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ta=new V1("@firebase/app"),_D="@firebase/app-compat",xD="@firebase/analytics-compat",yD="@firebase/analytics",ED="@firebase/app-check-compat",wD="@firebase/app-check",TD="@firebase/auth",kD="@firebase/auth-compat",AD="@firebase/database",SD="@firebase/database-compat",ID="@firebase/functions",CD="@firebase/functions-compat",RD="@firebase/installations",PD="@firebase/installations-compat",FD="@firebase/messaging",ND="@firebase/messaging-compat",DD="@firebase/performance",OD="@firebase/performance-compat",LD="@firebase/remote-config",MD="@firebase/remote-config-compat",bD="@firebase/storage",VD="@firebase/storage-compat",BD="@firebase/firestore",UD="@firebase/firestore-compat",$D="firebase",jD="10.5.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ym="[DEFAULT]",zD={[Xm]:"fire-core",[_D]:"fire-core-compat",[yD]:"fire-analytics",[xD]:"fire-analytics-compat",[wD]:"fire-app-check",[ED]:"fire-app-check-compat",[TD]:"fire-auth",[kD]:"fire-auth-compat",[AD]:"fire-rtdb",[SD]:"fire-rtdb-compat",[ID]:"fire-fn",[CD]:"fire-fn-compat",[RD]:"fire-iid",[PD]:"fire-iid-compat",[FD]:"fire-fcm",[ND]:"fire-fcm-compat",[DD]:"fire-perf",[OD]:"fire-perf-compat",[LD]:"fire-rc",[MD]:"fire-rc-compat",[bD]:"fire-gcs",[VD]:"fire-gcs-compat",[BD]:"fire-fst",[UD]:"fire-fst-compat","fire-js":"fire-js",[$D]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lh=new Map,Qm=new Map;function HD(e,t){try{e.container.addComponent(t)}catch(r){Ta.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function ka(e){const t=e.name;if(Qm.has(t))return Ta.debug(`There were multiple attempts to register component ${t}.`),!1;Qm.set(t,e);for(const r of Lh.values())HD(r,e);return!0}function V0(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Cs=new _u("app","Firebase",WD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(t,r,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ds("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Cs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma=jD;function wk(e,t={}){let r=e;typeof t!="object"&&(t={name:t});const n=Object.assign({name:Ym,automaticDataCollectionEnabled:!1},t),i=n.name;if(typeof i!="string"||!i)throw Cs.create("bad-app-name",{appName:String(i)});if(r||(r=vk()),!r)throw Cs.create("no-options");const s=Lh.get(i);if(s){if(Oh(r,s.options)&&Oh(n,s.config))return s;throw Cs.create("duplicate-app",{appName:i})}const a=new eD(i);for(const l of Qm.values())a.addComponent(l);const o=new GD(r,n,a);return Lh.set(i,o),o}function U1(e=Ym){const t=Lh.get(e);if(!t&&e===Ym&&vk())return wk();if(!t)throw Cs.create("no-app",{appName:e});return t}function ui(e,t,r){var n;let i=(n=zD[e])!==null&&n!==void 0?n:e;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${t}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Ta.warn(o.join(" "));return}ka(new Ds(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KD="firebase-heartbeat-database",qD=1,Vc="firebase-heartbeat-store";let lp=null;function Tk(){return lp||(lp=dD(KD,qD,{upgrade:(e,t)=>{switch(t){case 0:e.createObjectStore(Vc)}}}).catch(e=>{throw Cs.create("idb-open",{originalErrorMessage:e.message})})),lp}async function XD(e){try{return await(await Tk()).transaction(Vc).objectStore(Vc).get(kk(e))}catch(t){if(t instanceof xi)Ta.warn(t.message);else{const r=Cs.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Ta.warn(r.message)}}}async function ly(e,t){try{const n=(await Tk()).transaction(Vc,"readwrite");await n.objectStore(Vc).put(t,kk(e)),await n.done}catch(r){if(r instanceof xi)Ta.warn(r.message);else{const n=Cs.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Ta.warn(n.message)}}}function kk(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD=1024,QD=30*24*60*60*1e3;class JD{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new e3(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=cy();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n)))return this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const s=new Date(i.date).valueOf();return Date.now()-s<=QD}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const t=cy(),{heartbeatsToSend:r,unsentEntries:n}=ZD(this._heartbeatsCache.heartbeats),i=Dh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function cy(){return new Date().toISOString().substring(0,10)}function ZD(e,t=YD){const r=[];let n=e.slice();for(const i of e){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),uy(r)>t){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),uy(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class e3{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jN()?zN().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await XD(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(t){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return ly(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return ly(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function uy(e){return Dh(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t3(e){ka(new Ds("platform-logger",t=>new gD(t),"PRIVATE")),ka(new Ds("heartbeat",t=>new JD(t),"PRIVATE")),ui(Xm,oy,e),ui(Xm,oy,"esm2017"),ui("fire-js","")}t3("");function $1(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Ak(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const r3=Ak,Sk=new _u("auth","Firebase",Ak());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mh=new V1("@firebase/auth");function n3(e,...t){Mh.logLevel<=Ge.WARN&&Mh.warn(`Auth (${Ma}): ${e}`,...t)}function Yf(e,...t){Mh.logLevel<=Ge.ERROR&&Mh.error(`Auth (${Ma}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qn(e,...t){throw j1(e,...t)}function fi(e,...t){return j1(e,...t)}function i3(e,t,r){const n=Object.assign(Object.assign({},r3()),{[t]:r});return new _u("auth","Firebase",n).create(t,{appName:e.name})}function j1(e,...t){if(typeof e!="string"){const r=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(r,...n)}return Sk.create(e,...t)}function Fe(e,t,...r){if(!e)throw j1(t,...r)}function Ci(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Yf(t),new Error(t)}function Ui(e,t){e||Ci(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jm(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.href)||""}function s3(){return fy()==="http:"||fy()==="https:"}function fy(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a3(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(s3()||BN()||"connection"in navigator)?navigator.onLine:!0}function o3(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(t,r){this.shortDelay=t,this.longDelay=r,Ui(r>t,"Short delay should be less than long delay!"),this.isMobile=bN()||UN()}get(){return a3()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z1(e,t){Ui(e.emulator,"Emulator should always be set here");const{url:r}=e.emulator;return t?`${r}${t.startsWith("/")?t.slice(1):t}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{static initialize(t,r,n){this.fetchImpl=t,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ci("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ci("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ci("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l3={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c3=new yu(3e4,6e4);function rl(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function ba(e,t,r,n,i={}){return Ck(e,i,async()=>{let s={},a={};n&&(t==="GET"?a=n:s={body:JSON.stringify(n)});const o=xu(Object.assign({key:e.config.apiKey},a)).slice(1),l=await e._getAdditionalHeaders();return l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode),Ik.fetch()(Rk(e,e.config.apiHost,r,o),Object.assign({method:t,headers:l,referrerPolicy:"no-referrer"},s))})}async function Ck(e,t,r){e._canInitEmulator=!1;const n=Object.assign(Object.assign({},l3),t);try{const i=new f3(e),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw pf(e,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw pf(e,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw pf(e,"email-already-in-use",a);if(l==="USER_DISABLED")throw pf(e,"user-disabled",a);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw i3(e,u,c);qn(e,u)}}catch(i){if(i instanceof xi)throw i;qn(e,"network-request-failed",{message:String(i)})}}async function B0(e,t,r,n,i={}){const s=await ba(e,t,r,n,i);return"mfaPendingCredential"in s&&qn(e,"multi-factor-auth-required",{_serverResponse:s}),s}function Rk(e,t,r,n){const i=`${t}${r}?${n}`;return e.config.emulator?z1(e.config,i):`${e.config.apiScheme}://${i}`}function u3(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class f3{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(fi(this.auth,"network-request-failed")),c3.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function pf(e,t,r){const n={appName:e.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=fi(e,t,n);return i.customData._tokenResponse=r,i}function hy(e){return e!==void 0&&e.enterprise!==void 0}class h3{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],t.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===t)return u3(r.enforcementState);return null}isProviderEnabled(t){return this.getProviderEnforcementState(t)==="ENFORCE"||this.getProviderEnforcementState(t)==="AUDIT"}}async function d3(e,t){return ba(e,"GET","/v2/recaptchaConfig",rl(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p3(e,t){return ba(e,"POST","/v1/accounts:delete",t)}async function m3(e,t){return ba(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rc(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function g3(e,t=!1){const r=Bt(e),n=await r.getIdToken(t),i=H1(n);Fe(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:rc(cp(i.auth_time)),issuedAtTime:rc(cp(i.iat)),expirationTime:rc(cp(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function cp(e){return Number(e)*1e3}function H1(e){const[t,r,n]=e.split(".");if(t===void 0||r===void 0||n===void 0)return Yf("JWT malformed, contained fewer than 3 sections"),null;try{const i=pk(r);return i?JSON.parse(i):(Yf("Failed to decode base64 JWT payload"),null)}catch(i){return Yf("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function v3(e){const t=H1(e);return Fe(t,"internal-error"),Fe(typeof t.exp<"u","internal-error"),Fe(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bc(e,t,r=!1){if(r)return t;try{return await t}catch(n){throw n instanceof xi&&_3(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}function _3({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x3{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var r;if(t){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(t=!1){if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(t,r){this.createdAt=t,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=rc(this.lastLoginAt),this.creationTime=rc(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bh(e){var t;const r=e.auth,n=await e.getIdToken(),i=await Bc(e,m3(r,{idToken:n}));Fe(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const a=!((t=s.providerUserInfo)===null||t===void 0)&&t.length?w3(s.providerUserInfo):[],o=E3(e.providerData,a),l=e.isAnonymous,c=!(e.email&&s.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Pk(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(e,f)}async function y3(e){const t=Bt(e);await bh(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function E3(e,t){return[...e.filter(n=>!t.some(i=>i.providerId===n.providerId)),...t]}function w3(e){return e.map(t=>{var{providerId:r}=t,n=$1(t,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T3(e,t){const r=await Ck(e,{},async()=>{const n=xu({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:s}=e.config,a=Rk(e,i,"/v1/token",`key=${s}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Ik.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Fe(t.idToken,"internal-error"),Fe(typeof t.idToken<"u","internal-error"),Fe(typeof t.refreshToken<"u","internal-error");const r="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):v3(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,r)}async getToken(t,r=!1){return Fe(!this.accessToken||this.refreshToken,t,"user-token-expired"),!r&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(t,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await T3(t,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(t,r,n){this.refreshToken=r||null,this.accessToken=t||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(t,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new Uc;return n&&(Fe(typeof n=="string","internal-error",{appName:t}),a.refreshToken=n),i&&(Fe(typeof i=="string","internal-error",{appName:t}),a.accessToken=i),s&&(Fe(typeof s=="number","internal-error",{appName:t}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Uc,this.toJSON())}_performRefresh(){return Ci("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(e,t){Fe(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class da{constructor(t){var{uid:r,auth:n,stsTokenManager:i}=t,s=$1(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new x3(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Pk(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const r=await Bc(this,this.stsTokenManager.getToken(this.auth,t));return Fe(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(t){return g3(this,t)}reload(){return y3(this)}_assign(t){this!==t&&(Fe(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(r=>Object.assign({},r)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const r=new da(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(t){Fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,r=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),r&&await bh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await Bc(this,p3(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,r){var n,i,s,a,o,l,c,u;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,h=(i=r.email)!==null&&i!==void 0?i:void 0,d=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,p=(a=r.photoURL)!==null&&a!==void 0?a:void 0,m=(o=r.tenantId)!==null&&o!==void 0?o:void 0,v=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,x=(c=r.createdAt)!==null&&c!==void 0?c:void 0,_=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:g,emailVerified:w,isAnonymous:T,providerData:k,stsTokenManager:y}=r;Fe(g&&y,t,"internal-error");const P=Uc.fromJSON(this.name,y);Fe(typeof g=="string",t,"internal-error"),Xi(f,t.name),Xi(h,t.name),Fe(typeof w=="boolean",t,"internal-error"),Fe(typeof T=="boolean",t,"internal-error"),Xi(d,t.name),Xi(p,t.name),Xi(m,t.name),Xi(v,t.name),Xi(x,t.name),Xi(_,t.name);const O=new da({uid:g,auth:t,email:h,emailVerified:w,displayName:f,isAnonymous:T,photoURL:p,phoneNumber:d,tenantId:m,stsTokenManager:P,createdAt:x,lastLoginAt:_});return k&&Array.isArray(k)&&(O.providerData=k.map(U=>Object.assign({},U))),v&&(O._redirectEventId=v),O}static async _fromIdTokenResponse(t,r,n=!1){const i=new Uc;i.updateFromServerResponse(r);const s=new da({uid:r.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await bh(s),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dy=new Map;function Ri(e){Ui(e instanceof Function,"Expected a class definition");let t=dy.get(e);return t?(Ui(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,dy.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){const r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}Fk.type="NONE";const py=Fk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qf(e,t,r){return`firebase:${e}:${t}:${r}`}class ko{constructor(t,r,n){this.persistence=t,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Qf(this.userKey,i.apiKey,s),this.fullPersistenceKey=Qf("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?da._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,r,n="authUser"){if(!r.length)return new ko(Ri(py),t,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||Ri(py);const a=Qf(n,t.config.apiKey,t.name);let o=null;for(const c of r)try{const u=await c._get(a);if(u){const f=da._fromJSON(t,u);c!==s&&(o=f),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new ko(s,t,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new ko(s,t,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function my(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Ok(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Nk(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Mk(t))return"Blackberry";if(bk(t))return"Webos";if(W1(t))return"Safari";if((t.includes("chrome/")||Dk(t))&&!t.includes("edge/"))return"Chrome";if(Lk(t))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function Nk(e=Fr()){return/firefox\//i.test(e)}function W1(e=Fr()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Dk(e=Fr()){return/crios\//i.test(e)}function Ok(e=Fr()){return/iemobile/i.test(e)}function Lk(e=Fr()){return/android/i.test(e)}function Mk(e=Fr()){return/blackberry/i.test(e)}function bk(e=Fr()){return/webos/i.test(e)}function U0(e=Fr()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function k3(e=Fr()){var t;return U0(e)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function A3(){return $N()&&document.documentMode===10}function Vk(e=Fr()){return U0(e)||Lk(e)||bk(e)||Mk(e)||/windows phone/i.test(e)||Ok(e)}function S3(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bk(e,t=[]){let r;switch(e){case"Browser":r=my(Fr());break;case"Worker":r=`${my(Fr())}-${e}`;break;default:r=e}const n=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${Ma}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I3{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,r){const n=s=>new Promise((a,o)=>{try{const l=t(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const r=[];try{for(const n of this.queue)await n(t),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C3(e,t={}){return ba(e,"GET","/v2/passwordPolicy",rl(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R3=6;class P3{constructor(t){var r,n,i,s;const a=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:R3,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=t.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=t.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,l),this.validatePasswordCharacterOptions(t,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(t,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=t.length>=n),i&&(r.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<t.length;i++)n=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F3{constructor(t,r,n,i){this.app=t,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gy(this),this.idTokenSubscription=new gy(this),this.beforeStateQueue=new I3(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Sk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,r){return r&&(this._popupRedirectResolver=Ri(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await ko.create(this,t),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUser(t){var r;const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(t);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(t){try{await bh(t)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=o3()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const r=t?Bt(t):null;return r&&Fe(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(t,r=!1){if(!this._deleted)return t&&Fe(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(t){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Ri(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await C3(this),r=new P3(t);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new _u("auth","Firebase",t())}onAuthStateChanged(t,r,n){return this.registerStateListener(this.authStateSubscription,t,r,n)}beforeAuthStateChanged(t,r){return this.beforeStateQueue.pushCallback(t,r)}onIdTokenChanged(t,r,n){return this.registerStateListener(this.idTokenSubscription,t,r,n)}authStateReady(){return new Promise((t,r)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged(()=>{n(),t()},r)}})}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,r){const n=await this.getOrInitRedirectPersistenceManager(r);return t===null?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const r=t&&Ri(t)||this._popupRedirectResolver;Fe(r,this,"argument-error"),this.redirectPersistenceManager=await ko.create(this,[Ri(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===t?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Fe(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=t.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=t.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Bk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var t;const r=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return r!=null&&r.error&&n3(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function nl(e){return Bt(e)}class gy{constructor(t){this.auth=t,this.observer=null,this.addObserver=qN(r=>this.observer=r)}get next(){return Fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N3(){var e,t;return(t=(e=document.getElementsByTagName("head"))===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:document}function Uk(e){return new Promise((t,r)=>{const n=document.createElement("script");n.setAttribute("src",e),n.onload=t,n.onerror=i=>{const s=fi("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",N3().appendChild(n)})}function D3(e){return`__${e}${Math.floor(Math.random()*1e6)}`}const O3="https://www.google.com/recaptcha/enterprise.js?render=",L3="recaptcha-enterprise",M3="NO_RECAPTCHA";class b3{constructor(t){this.type=L3,this.auth=nl(t)}async verify(t="verify",r=!1){async function n(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,o)=>{d3(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new h3(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,a(c.siteKey)}}).catch(l=>{o(l)})})}function i(s,a,o){const l=window.grecaptcha;hy(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:t}).then(c=>{a(c)}).catch(()=>{a(M3)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{n(this.auth).then(o=>{if(!r&&hy(window.grecaptcha))i(o,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}Uk(O3+o).then(()=>{i(o,s,a)}).catch(l=>{a(l)})}}).catch(o=>{a(o)})})}}async function vy(e,t,r,n=!1){const i=new b3(e);let s;try{s=await i.verify(r)}catch{s=await i.verify(r,!0)}const a=Object.assign({},t);return n?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function V3(e,t,r,n){var i;if(!((i=e._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await vy(e,t,r,r==="getOobCode");return n(e,s)}else return n(e,t).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await vy(e,t,r,r==="getOobCode");return n(e,a)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B3(e,t){const r=V0(e,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(Oh(s,t??{}))return i;qn(i,"already-initialized")}return r.initialize({options:t})}function U3(e,t){const r=(t==null?void 0:t.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Ri);t!=null&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(n,t==null?void 0:t.popupRedirectResolver)}function $3(e,t,r){const n=nl(e);Fe(n._canInitEmulator,n,"emulator-config-failed"),Fe(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");const i=!!(r!=null&&r.disableWarnings),s=$k(t),{host:a,port:o}=j3(t),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||z3()}function $k(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function j3(e){const t=$k(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:_y(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:_y(a)}}}function _y(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function z3(){function e(){const t=document.createElement("p"),r=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(t,r){this.providerId=t,this.signInMethod=r}toJSON(){return Ci("not implemented")}_getIdTokenResponse(t){return Ci("not implemented")}_linkToIdToken(t,r){return Ci("not implemented")}_getReauthenticationResolver(t){return Ci("not implemented")}}async function H3(e,t){return ba(e,"POST","/v1/accounts:update",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W3(e,t){return B0(e,"POST","/v1/accounts:signInWithPassword",rl(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G3(e,t){return B0(e,"POST","/v1/accounts:signInWithEmailLink",rl(e,t))}async function K3(e,t){return B0(e,"POST","/v1/accounts:signInWithEmailLink",rl(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c extends G1{constructor(t,r,n,i=null){super("password",n),this._email=t,this._password=r,this._tenantId=i}static _fromEmailAndPassword(t,r){return new $c(t,r,"password")}static _fromEmailAndCode(t,r,n=null){return new $c(t,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return V3(t,r,"signInWithPassword",W3);case"emailLink":return G3(t,{email:this._email,oobCode:this._password});default:qn(t,"internal-error")}}async _linkToIdToken(t,r){switch(this.signInMethod){case"password":return H3(t,{idToken:r,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return K3(t,{idToken:r,email:this._email,oobCode:this._password});default:qn(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ao(e,t){return B0(e,"POST","/v1/accounts:signInWithIdp",rl(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q3="http://localhost";class Aa extends G1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const r=new Aa(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(r.idToken=t.idToken),t.accessToken&&(r.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(r.nonce=t.nonce),t.pendingToken&&(r.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(r.accessToken=t.oauthToken,r.secret=t.oauthTokenSecret):qn("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t,{providerId:n,signInMethod:i}=r,s=$1(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new Aa(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(t){const r=this.buildRequest();return Ao(t,r)}_linkToIdToken(t,r){const n=this.buildRequest();return n.idToken=r,Ao(t,n)}_getReauthenticationResolver(t){const r=this.buildRequest();return r.autoCreate=!1,Ao(t,r)}buildRequest(){const t={requestUri:q3,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),t.postBody=xu(r)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X3(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Y3(e){const t=Ll(Ml(e)).link,r=t?Ll(Ml(t)).deep_link_id:null,n=Ll(Ml(e)).deep_link_id;return(n?Ll(Ml(n)).link:null)||n||r||t||e}class K1{constructor(t){var r,n,i,s,a,o;const l=Ll(Ml(t)),c=(r=l.apiKey)!==null&&r!==void 0?r:null,u=(n=l.oobCode)!==null&&n!==void 0?n:null,f=X3((i=l.mode)!==null&&i!==void 0?i:null);Fe(c&&u&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=u,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=l.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(o=l.tenantId)!==null&&o!==void 0?o:null}static parseLink(t){const r=Y3(t);try{return new K1(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(){this.providerId=il.PROVIDER_ID}static credential(t,r){return $c._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){const n=K1.parseLink(r);return Fe(n,"argument-error"),$c._fromEmailAndCode(t,n.code,n.tenantId)}}il.PROVIDER_ID="password";il.EMAIL_PASSWORD_SIGN_IN_METHOD="password";il.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jk{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu extends jk{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs extends Eu{constructor(){super("facebook.com")}static credential(t){return Aa._fromParams({providerId:rs.PROVIDER_ID,signInMethod:rs.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return rs.credentialFromTaggedObject(t)}static credentialFromError(t){return rs.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return rs.credential(t.oauthAccessToken)}catch{return null}}}rs.FACEBOOK_SIGN_IN_METHOD="facebook.com";rs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns extends Eu{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return Aa._fromParams({providerId:ns.PROVIDER_ID,signInMethod:ns.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return ns.credentialFromTaggedObject(t)}static credentialFromError(t){return ns.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:r,oauthAccessToken:n}=t;if(!r&&!n)return null;try{return ns.credential(r,n)}catch{return null}}}ns.GOOGLE_SIGN_IN_METHOD="google.com";ns.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is extends Eu{constructor(){super("github.com")}static credential(t){return Aa._fromParams({providerId:is.PROVIDER_ID,signInMethod:is.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return is.credentialFromTaggedObject(t)}static credentialFromError(t){return is.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return is.credential(t.oauthAccessToken)}catch{return null}}}is.GITHUB_SIGN_IN_METHOD="github.com";is.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss extends Eu{constructor(){super("twitter.com")}static credential(t,r){return Aa._fromParams({providerId:ss.PROVIDER_ID,signInMethod:ss.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return ss.credentialFromTaggedObject(t)}static credentialFromError(t){return ss.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=t;if(!r||!n)return null;try{return ss.credential(r,n)}catch{return null}}}ss.TWITTER_SIGN_IN_METHOD="twitter.com";ss.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,r,n,i=!1){const s=await da._fromIdTokenResponse(t,n,i),a=xy(n);return new Bo({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(t,r,n){await t._updateTokensIfNecessary(n,!0);const i=xy(n);return new Bo({user:t,providerId:i,_tokenResponse:n,operationType:r})}}function xy(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh extends xi{constructor(t,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Vh.prototype),this.customData={appName:t.name,tenantId:(s=t.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,r,n,i){return new Vh(t,r,n,i)}}function zk(e,t,r,n){return(t==="reauthenticate"?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Vh._fromErrorAndOperation(e,s,t,n):s})}async function Q3(e,t,r=!1){const n=await Bc(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return Bo._forOperation(e,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J3(e,t,r=!1){const{auth:n}=e,i="reauthenticate";try{const s=await Bc(e,zk(n,i,t,e),r);Fe(s.idToken,n,"internal-error");const a=H1(s.idToken);Fe(a,n,"internal-error");const{sub:o}=a;return Fe(e.uid===o,n,"user-mismatch"),Bo._forOperation(e,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&qn(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hk(e,t,r=!1){const n="signIn",i=await zk(e,n,t),s=await Bo._fromIdTokenResponse(e,n,i);return r||await e._updateCurrentUser(s.user),s}async function Z3(e,t){return Hk(nl(e),t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eO(e){const t=nl(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function tO(e,t,r){return Z3(Bt(e),il.credential(t,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&eO(e),n})}function rO(e,t,r,n){return Bt(e).onIdTokenChanged(t,r,n)}function nO(e,t,r){return Bt(e).beforeAuthStateChanged(t,r)}function iO(e){return Bt(e).signOut()}const Bh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk{constructor(t,r){this.storageRetriever=t,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Bh,"1"),this.storage.removeItem(Bh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,r){return this.storage.setItem(t,JSON.stringify(r)),Promise.resolve()}_get(t){const r=this.storage.getItem(t);return Promise.resolve(r?JSON.parse(r):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sO(){const e=Fr();return W1(e)||U0(e)}const aO=1e3,oO=10;class Gk extends Wk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=sO()&&S3(),this.fallbackToPolling=Vk(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&t(r,i,n)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=t.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(n);if(t.newValue!==a)t.newValue!==null?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!r)return}const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);A3()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,oO):i()}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:n}),!0)})},aO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){const r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}Gk.type="LOCAL";const lO=Gk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk extends Wk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}Kk.type="SESSION";const qk=Kk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cO(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const r=this.receivers.find(i=>i.isListeningto(t));if(r)return r;const n=new $0(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const r=t,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await cO(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}$0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q1(e="",t=10){let r="";for(let n=0;n<t;n++)r+=Math.floor(Math.random()*10);return e+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=q1("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(f){const h=f;if(h.data.eventId===c)switch(h.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(h.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:t,eventId:c,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(){return window}function fO(e){hi().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xk(){return typeof hi().WorkerGlobalScope<"u"&&typeof hi().importScripts=="function"}async function hO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function dO(){var e;return((e=navigator==null?void 0:navigator.serviceWorker)===null||e===void 0?void 0:e.controller)||null}function pO(){return Xk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yk="firebaseLocalStorageDb",mO=1,Uh="firebaseLocalStorage",Qk="fbase_key";class wu{constructor(t){this.request=t}toPromise(){return new Promise((t,r)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function j0(e,t){return e.transaction([Uh],t?"readwrite":"readonly").objectStore(Uh)}function gO(){const e=indexedDB.deleteDatabase(Yk);return new wu(e).toPromise()}function Zm(){const e=indexedDB.open(Yk,mO);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{const n=e.result;try{n.createObjectStore(Uh,{keyPath:Qk})}catch(i){r(i)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Uh)?t(n):(n.close(),await gO(),t(await Zm()))})})}async function yy(e,t,r){const n=j0(e,!0).put({[Qk]:t,value:r});return new wu(n).toPromise()}async function vO(e,t){const r=j0(e,!1).get(t),n=await new wu(r).toPromise();return n===void 0?null:n.value}function Ey(e,t){const r=j0(e,!0).delete(t);return new wu(r).toPromise()}const _O=800,xO=3;class Jk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Zm(),this.db)}async _withRetries(t){let r=0;for(;;)try{const n=await this._openDb();return await t(n)}catch(n){if(r++>xO)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Xk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=$0._getInstance(pO()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await hO(),!this.activeServiceWorker)return;this.sender=new uO(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((t=n[0])===null||t===void 0)&&t.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||dO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Zm();return await yy(t,Bh,"1"),await Ey(t,Bh),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>yy(n,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){const r=await this._withRetries(n=>vO(n,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Ey(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(i=>{const s=j0(i,!1).getAll();return new wu(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;for(const{fbase_key:i,value:s}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_O)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Jk.type="LOCAL";const yO=Jk;new yu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EO(e,t){return t?Ri(t):(Fe(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1 extends G1{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Ao(t,this._buildIdpRequest())}_linkToIdToken(t,r){return Ao(t,this._buildIdpRequest(r))}_getReauthenticationResolver(t){return Ao(t,this._buildIdpRequest())}_buildIdpRequest(t){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(r.idToken=t),r}}function wO(e){return Hk(e.auth,new X1(e),e.bypassAuthState)}function TO(e){const{auth:t,user:r}=e;return Fe(r,t,"internal-error"),J3(r,new X1(e),e.bypassAuthState)}async function kO(e){const{auth:t,user:r}=e;return Fe(r,t,"internal-error"),Q3(r,new X1(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zk{constructor(t,r,n,i,s=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(t,r)=>{this.pendingPromise={resolve:t,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(t){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=t;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return wO;case"linkViaPopup":case"linkViaRedirect":return kO;case"reauthViaPopup":case"reauthViaRedirect":return TO;default:qn(this.auth,"internal-error")}}resolve(t){Ui(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Ui(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AO=new yu(2e3,1e4);class po extends Zk{constructor(t,r,n,i,s){super(t,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,po.currentPopupAction&&po.currentPopupAction.cancel(),po.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Fe(t,this.auth,"internal-error"),t}async onExecution(){Ui(this.filter.length===1,"Popup operations only handle one event");const t=q1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(fi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(fi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,po.currentPopupAction=null}pollUserCancellation(){const t=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(fi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,AO.get())};t()}}po.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SO="pendingRedirect",Jf=new Map;class IO extends Zk{constructor(t,r,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let t=Jf.get(this.auth._key());if(!t){try{const n=await CO(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(n)}catch(r){t=()=>Promise.reject(r)}Jf.set(this.auth._key(),t)}return this.bypassAuthState||Jf.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const r=await this.auth._redirectUserForId(t.eventId);if(r)return this.user=r,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function CO(e,t){const r=FO(t),n=PO(e);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function RO(e,t){Jf.set(e._key(),t)}function PO(e){return Ri(e._redirectPersistence)}function FO(e){return Qf(SO,e.config.apiKey,e.name)}async function NO(e,t,r=!1){const n=nl(e),i=EO(n,t),a=await new IO(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,t)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DO=10*60*1e3;class OO{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(r=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!LO(t)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=t,r=!0)),r}sendToConsumer(t,r){var n;if(t.error&&!eA(t)){const i=((n=t.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(fi(this.auth,i))}else r.onAuthEvent(t)}isEventForConsumer(t,r){const n=r.eventId===null||!!t.eventId&&t.eventId===r.eventId;return r.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=DO&&this.cachedEventUids.clear(),this.cachedEventUids.has(wy(t))}saveEventToCache(t){this.cachedEventUids.add(wy(t)),this.lastProcessedEventTime=Date.now()}}function wy(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function eA({type:e,error:t}){return e==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function LO(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return eA(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MO(e,t={}){return ba(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,VO=/^https?/;async function BO(e){if(e.config.emulator)return;const{authorizedDomains:t}=await MO(e);for(const r of t)try{if(UO(r))return}catch{}qn(e,"unauthorized-domain")}function UO(e){const t=Jm(),{protocol:r,hostname:n}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return a.hostname===""&&n===""?r==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!VO.test(r))return!1;if(bO.test(e))return n===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $O=new yu(3e4,6e4);function Ty(){const e=hi().___jsl;if(e!=null&&e.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}}function jO(e){return new Promise((t,r)=>{var n,i,s;function a(){Ty(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Ty(),r(fi(e,"network-request-failed"))},timeout:$O.get()})}if(!((i=(n=hi().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)t(gapi.iframes.getContext());else if(!((s=hi().gapi)===null||s===void 0)&&s.load)a();else{const o=D3("iframefcb");return hi()[o]=()=>{gapi.load?a():r(fi(e,"network-request-failed"))},Uk(`https://apis.google.com/js/api.js?onload=${o}`).catch(l=>r(l))}}).catch(t=>{throw Zf=null,t})}let Zf=null;function zO(e){return Zf=Zf||jO(e),Zf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HO=new yu(5e3,15e3),WO="__/auth/iframe",GO="emulator/auth/iframe",KO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},qO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function XO(e){const t=e.config;Fe(t.authDomain,e,"auth-domain-config-required");const r=t.emulator?z1(t,GO):`https://${e.config.authDomain}/${WO}`,n={apiKey:t.apiKey,appName:e.name,v:Ma},i=qO.get(e.config.apiHost);i&&(n.eid=i);const s=e._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${xu(n).slice(1)}`}async function YO(e){const t=await zO(e),r=hi().gapi;return Fe(r,e,"internal-error"),t.open({where:document.body,url:XO(e),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:KO,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=fi(e,"network-request-failed"),o=hi().setTimeout(()=>{s(a)},HO.get());function l(){hi().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},JO=500,ZO=600,eL="_blank",tL="http://localhost";class ky{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function rL(e,t,r,n=JO,i=ZO){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},QO),{width:n.toString(),height:i.toString(),top:s,left:a}),c=Fr().toLowerCase();r&&(o=Dk(c)?eL:r),Nk(c)&&(t=t||tL,l.scrollbars="yes");const u=Object.entries(l).reduce((h,[d,p])=>`${h}${d}=${p},`,"");if(k3(c)&&o!=="_self")return nL(t||"",o),new ky(null);const f=window.open(t||"",o,u);Fe(f,e,"popup-blocked");try{f.focus()}catch{}return new ky(f)}function nL(e,t){const r=document.createElement("a");r.href=e,r.target=t;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iL="__/auth/handler",sL="emulator/auth/handler",aL=encodeURIComponent("fac");async function Ay(e,t,r,n,i,s){Fe(e.config.authDomain,e,"auth-domain-config-required"),Fe(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:n,v:Ma,eventId:i};if(t instanceof jk){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",KN(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,f]of Object.entries(s||{}))a[u]=f}if(t instanceof Eu){const u=t.getScopes().filter(f=>f!=="");u.length>0&&(a.scopes=u.join(","))}e.tenantId&&(a.tid=e.tenantId);const o=a;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await e._getAppCheckToken(),c=l?`#${aL}=${encodeURIComponent(l)}`:"";return`${oL(e)}?${xu(o).slice(1)}${c}`}function oL({config:e}){return e.emulator?z1(e,sL):`https://${e.authDomain}/${iL}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up="webStorageSupport";class lL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qk,this._completeRedirectFn=NO,this._overrideRedirectResult=RO}async _openPopup(t,r,n,i){var s;Ui((s=this.eventManagers[t._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await Ay(t,r,n,Jm(),i);return rL(t,a,q1())}async _openRedirect(t,r,n,i){await this._originValidation(t);const s=await Ay(t,r,n,Jm(),i);return fO(s),new Promise(()=>{})}_initialize(t){const r=t._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(Ui(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(t);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(t){const r=await YO(t),n=new OO(t);return r.register("authEvent",i=>(Fe(i==null?void 0:i.authEvent,t,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=r,n}_isIframeWebStorageSupported(t,r){this.iframes[t._key()].send(up,{type:up},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[up];a!==void 0&&r(!!a),qn(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const r=t._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=BO(t)),this.originValidationPromises[r]}get _shouldInitProactively(){return Vk()||W1()||U0()}}const cL=lL;var Sy="@firebase/auth",Iy="1.3.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const r=this.auth.onIdTokenChanged(n=>{t((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,r),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const r=this.internalListeners.get(t);r&&(this.internalListeners.delete(t),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fL(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function hL(e){ka(new Ds("auth",(t,{options:r})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Fe(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Bk(e)},c=new F3(n,i,s,l);return U3(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,r,n)=>{t.getProvider("auth-internal").initialize()})),ka(new Ds("auth-internal",t=>{const r=nl(t.getProvider("auth").getImmediate());return(n=>new uL(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),ui(Sy,Iy,fL(e)),ui(Sy,Iy,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dL=5*60,pL=_k("authIdTokenMaxAge")||dL;let Cy=null;const mL=e=>async t=>{const r=t&&await t.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>pL)return;const i=r==null?void 0:r.token;Cy!==i&&(Cy=i,await fetch(e,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function gL(e=U1()){const t=V0(e,"auth");if(t.isInitialized())return t.getImmediate();const r=B3(e,{popupRedirectResolver:cL,persistence:[yO,lO,qk]}),n=_k("authTokenSyncURL");if(n){const s=mL(n);nO(r,s,()=>s(r.currentUser)),rO(r,a=>s(a))}const i=mk("auth");return i&&$3(r,`http://${i}`),r}hL("Browser");var vL="firebase",_L="10.5.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ui(vL,_L,"app");var xL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_e,Y1=Y1||{},De=xL||self;function z0(e){var t=typeof e;return t=t!="object"?t:e?Array.isArray(e)?"array":t:"null",t=="array"||t=="object"&&typeof e.length=="number"}function Tu(e){var t=typeof e;return t=="object"&&e!=null||t=="function"}function yL(e){return Object.prototype.hasOwnProperty.call(e,fp)&&e[fp]||(e[fp]=++EL)}var fp="closure_uid_"+(1e9*Math.random()>>>0),EL=0;function wL(e,t,r){return e.call.apply(e.bind,arguments)}function TL(e,t,r){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),e.apply(t,i)}}return function(){return e.apply(t,arguments)}}function Ir(e,t,r){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ir=wL:Ir=TL,Ir.apply(null,arguments)}function mf(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var n=r.slice();return n.push.apply(n,arguments),e.apply(this,n)}}function nr(e,t){function r(){}r.prototype=t.prototype,e.$=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.ac=function(n,i,s){for(var a=Array(arguments.length-2),o=2;o<arguments.length;o++)a[o-2]=arguments[o];return t.prototype[i].apply(n,a)}}function zs(){this.s=this.s,this.o=this.o}var kL=0;zs.prototype.s=!1;zs.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),kL!=0)&&yL(this)};zs.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const tA=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(typeof e=="string")return typeof t!="string"||t.length!=1?-1:e.indexOf(t,0);for(let r=0;r<e.length;r++)if(r in e&&e[r]===t)return r;return-1};function Q1(e){const t=e.length;if(0<t){const r=Array(t);for(let n=0;n<t;n++)r[n]=e[n];return r}return[]}function Ry(e,t){for(let r=1;r<arguments.length;r++){const n=arguments[r];if(z0(n)){const i=e.length||0,s=n.length||0;e.length=i+s;for(let a=0;a<s;a++)e[i+a]=n[a]}else e.push(n)}}function Cr(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Cr.prototype.h=function(){this.defaultPrevented=!0};var AL=function(){if(!De.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{De.addEventListener("test",()=>{},t),De.removeEventListener("test",()=>{},t)}catch{}return e}();function jc(e){return/^[\s\xa0]*$/.test(e)}function H0(){var e=De.navigator;return e&&(e=e.userAgent)?e:""}function ni(e){return H0().indexOf(e)!=-1}function J1(e){return J1[" "](e),e}J1[" "]=function(){};function SL(e,t){var r=_6;return Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=t(e)}var IL=ni("Opera"),Uo=ni("Trident")||ni("MSIE"),rA=ni("Edge"),eg=rA||Uo,nA=ni("Gecko")&&!(H0().toLowerCase().indexOf("webkit")!=-1&&!ni("Edge"))&&!(ni("Trident")||ni("MSIE"))&&!ni("Edge"),CL=H0().toLowerCase().indexOf("webkit")!=-1&&!ni("Edge");function iA(){var e=De.document;return e?e.documentMode:void 0}var tg;e:{var hp="",dp=function(){var e=H0();if(nA)return/rv:([^\);]+)(\)|;)/.exec(e);if(rA)return/Edge\/([\d\.]+)/.exec(e);if(Uo)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(CL)return/WebKit\/(\S+)/.exec(e);if(IL)return/(?:Version)[ \/]?(\S+)/.exec(e)}();if(dp&&(hp=dp?dp[1]:""),Uo){var pp=iA();if(pp!=null&&pp>parseFloat(hp)){tg=String(pp);break e}}tg=hp}var rg;if(De.document&&Uo){var Py=iA();rg=Py||parseInt(tg,10)||void 0}else rg=void 0;var RL=rg;function zc(e,t){if(Cr.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var r=this.type=e.type,n=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(nA){e:{try{J1(t.nodeName);var i=!0;break e}catch{}i=!1}i||(t=null)}}else r=="mouseover"?t=e.fromElement:r=="mouseout"&&(t=e.toElement);this.relatedTarget=t,n?(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=e.clientX!==void 0?e.clientX:e.pageX,this.clientY=e.clientY!==void 0?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=typeof e.pointerType=="string"?e.pointerType:PL[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&zc.$.h.call(this)}}nr(zc,Cr);var PL={2:"touch",3:"pen",4:"mouse"};zc.prototype.h=function(){zc.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var ku="closure_listenable_"+(1e6*Math.random()|0),FL=0;function NL(e,t,r,n,i){this.listener=e,this.proxy=null,this.src=t,this.type=r,this.capture=!!n,this.la=i,this.key=++FL,this.fa=this.ia=!1}function W0(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function Z1(e,t,r){for(const n in e)t.call(r,e[n],n,e)}function DL(e,t){for(const r in e)t.call(void 0,e[r],r,e)}function sA(e){const t={};for(const r in e)t[r]=e[r];return t}const Fy="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function aA(e,t){let r,n;for(let i=1;i<arguments.length;i++){n=arguments[i];for(r in n)e[r]=n[r];for(let s=0;s<Fy.length;s++)r=Fy[s],Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}}function G0(e){this.src=e,this.g={},this.h=0}G0.prototype.add=function(e,t,r,n,i){var s=e.toString();e=this.g[s],e||(e=this.g[s]=[],this.h++);var a=ig(e,t,n,i);return-1<a?(t=e[a],r||(t.ia=!1)):(t=new NL(t,this.src,s,!!n,i),t.ia=r,e.push(t)),t};function ng(e,t){var r=t.type;if(r in e.g){var n=e.g[r],i=tA(n,t),s;(s=0<=i)&&Array.prototype.splice.call(n,i,1),s&&(W0(t),e.g[r].length==0&&(delete e.g[r],e.h--))}}function ig(e,t,r,n){for(var i=0;i<e.length;++i){var s=e[i];if(!s.fa&&s.listener==t&&s.capture==!!r&&s.la==n)return i}return-1}var ev="closure_lm_"+(1e6*Math.random()|0),mp={};function oA(e,t,r,n,i){if(n&&n.once)return cA(e,t,r,n,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)oA(e,t[s],r,n,i);return null}return r=nv(r),e&&e[ku]?e.O(t,r,Tu(n)?!!n.capture:!!n,i):lA(e,t,r,!1,n,i)}function lA(e,t,r,n,i,s){if(!t)throw Error("Invalid event type");var a=Tu(i)?!!i.capture:!!i,o=rv(e);if(o||(e[ev]=o=new G0(e)),r=o.add(t,r,n,a,s),r.proxy)return r;if(n=OL(),r.proxy=n,n.src=e,n.listener=r,e.addEventListener)AL||(i=a),i===void 0&&(i=!1),e.addEventListener(t.toString(),n,i);else if(e.attachEvent)e.attachEvent(fA(t.toString()),n);else if(e.addListener&&e.removeListener)e.addListener(n);else throw Error("addEventListener and attachEvent are unavailable.");return r}function OL(){function e(r){return t.call(e.src,e.listener,r)}const t=LL;return e}function cA(e,t,r,n,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)cA(e,t[s],r,n,i);return null}return r=nv(r),e&&e[ku]?e.P(t,r,Tu(n)?!!n.capture:!!n,i):lA(e,t,r,!0,n,i)}function uA(e,t,r,n,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)uA(e,t[s],r,n,i);else n=Tu(n)?!!n.capture:!!n,r=nv(r),e&&e[ku]?(e=e.i,t=String(t).toString(),t in e.g&&(s=e.g[t],r=ig(s,r,n,i),-1<r&&(W0(s[r]),Array.prototype.splice.call(s,r,1),s.length==0&&(delete e.g[t],e.h--)))):e&&(e=rv(e))&&(t=e.g[t.toString()],e=-1,t&&(e=ig(t,r,n,i)),(r=-1<e?t[e]:null)&&tv(r))}function tv(e){if(typeof e!="number"&&e&&!e.fa){var t=e.src;if(t&&t[ku])ng(t.i,e);else{var r=e.type,n=e.proxy;t.removeEventListener?t.removeEventListener(r,n,e.capture):t.detachEvent?t.detachEvent(fA(r),n):t.addListener&&t.removeListener&&t.removeListener(n),(r=rv(t))?(ng(r,e),r.h==0&&(r.src=null,t[ev]=null)):W0(e)}}}function fA(e){return e in mp?mp[e]:mp[e]="on"+e}function LL(e,t){if(e.fa)e=!0;else{t=new zc(t,this);var r=e.listener,n=e.la||e.src;e.ia&&tv(e),e=r.call(n,t)}return e}function rv(e){return e=e[ev],e instanceof G0?e:null}var gp="__closure_events_fn_"+(1e9*Math.random()>>>0);function nv(e){return typeof e=="function"?e:(e[gp]||(e[gp]=function(t){return e.handleEvent(t)}),e[gp])}function rr(){zs.call(this),this.i=new G0(this),this.S=this,this.J=null}nr(rr,zs);rr.prototype[ku]=!0;rr.prototype.removeEventListener=function(e,t,r,n){uA(this,e,t,r,n)};function ur(e,t){var r,n=e.J;if(n)for(r=[];n;n=n.J)r.push(n);if(e=e.S,n=t.type||t,typeof t=="string")t=new Cr(t,e);else if(t instanceof Cr)t.target=t.target||e;else{var i=t;t=new Cr(n,e),aA(t,i)}if(i=!0,r)for(var s=r.length-1;0<=s;s--){var a=t.g=r[s];i=gf(a,n,!0,t)&&i}if(a=t.g=e,i=gf(a,n,!0,t)&&i,i=gf(a,n,!1,t)&&i,r)for(s=0;s<r.length;s++)a=t.g=r[s],i=gf(a,n,!1,t)&&i}rr.prototype.N=function(){if(rr.$.N.call(this),this.i){var e=this.i,t;for(t in e.g){for(var r=e.g[t],n=0;n<r.length;n++)W0(r[n]);delete e.g[t],e.h--}}this.J=null};rr.prototype.O=function(e,t,r,n){return this.i.add(String(e),t,!1,r,n)};rr.prototype.P=function(e,t,r,n){return this.i.add(String(e),t,!0,r,n)};function gf(e,t,r,n){if(t=e.i.g[String(t)],!t)return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var a=t[s];if(a&&!a.fa&&a.capture==r){var o=a.listener,l=a.la||a.src;a.ia&&ng(e.i,a),i=o.call(l,n)!==!1&&i}}return i&&!n.defaultPrevented}var iv=De.JSON.stringify;class ML{constructor(t,r){this.i=t,this.j=r,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}function bL(){var e=sv;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}class VL{constructor(){this.h=this.g=null}add(t,r){const n=hA.get();n.set(t,r),this.h?this.h.next=n:this.g=n,this.h=n}}var hA=new ML(()=>new BL,e=>e.reset());class BL{constructor(){this.next=this.g=this.h=null}set(t,r){this.h=t,this.g=r,this.next=null}reset(){this.next=this.g=this.h=null}}function UL(e){var t=1;e=e.split(":");const r=[];for(;0<t&&e.length;)r.push(e.shift()),t--;return e.length&&r.push(e.join(":")),r}function $L(e){De.setTimeout(()=>{throw e},0)}let Hc,Wc=!1,sv=new VL,dA=()=>{const e=De.Promise.resolve(void 0);Hc=()=>{e.then(jL)}};var jL=()=>{for(var e;e=bL();){try{e.h.call(e.g)}catch(r){$L(r)}var t=hA;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Wc=!1};function K0(e,t){rr.call(this),this.h=e||1,this.g=t||De,this.j=Ir(this.qb,this),this.l=Date.now()}nr(K0,rr);_e=K0.prototype;_e.ga=!1;_e.T=null;_e.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ur(this,"tick"),this.ga&&(av(this),this.start()))}};_e.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function av(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}_e.N=function(){K0.$.N.call(this),av(this),delete this.g};function ov(e,t,r){if(typeof e=="function")r&&(e=Ir(e,r));else if(e&&typeof e.handleEvent=="function")e=Ir(e.handleEvent,e);else throw Error("Invalid listener argument");return 2147483647<Number(t)?-1:De.setTimeout(e,t||0)}function pA(e){e.g=ov(()=>{e.g=null,e.i&&(e.i=!1,pA(e))},e.j);const t=e.h;e.h=null,e.m.apply(null,t)}class zL extends zs{constructor(t,r){super(),this.m=t,this.j=r,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:pA(this)}N(){super.N(),this.g&&(De.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gc(e){zs.call(this),this.h=e,this.g={}}nr(Gc,zs);var Ny=[];function mA(e,t,r,n){Array.isArray(r)||(r&&(Ny[0]=r.toString()),r=Ny);for(var i=0;i<r.length;i++){var s=oA(t,r[i],n||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function gA(e){Z1(e.g,function(t,r){this.g.hasOwnProperty(r)&&tv(t)},e),e.g={}}Gc.prototype.N=function(){Gc.$.N.call(this),gA(this)};Gc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function q0(){this.g=!0}q0.prototype.Ea=function(){this.g=!1};function HL(e,t,r,n,i,s){e.info(function(){if(e.g)if(s)for(var a="",o=s.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var f=u.split("_");a=2<=f.length&&f[1]=="type"?a+(u+"="+c+"&"):a+(u+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+n+") [attempt "+i+"]: "+t+`
`+r+`
`+a})}function WL(e,t,r,n,i,s,a){e.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+i+"]: "+t+`
`+r+`
`+s+" "+a})}function mo(e,t,r,n){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+KL(e,r)+(n?" "+n:"")})}function GL(e,t){e.info(function(){return"TIMEOUT: "+t})}q0.prototype.info=function(){};function KL(e,t){if(!e.g)return t;if(!t)return null;try{var r=JSON.parse(t);if(r){for(e=0;e<r.length;e++)if(Array.isArray(r[e])){var n=r[e];if(!(2>n.length)){var i=n[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var a=1;a<i.length;a++)i[a]=""}}}}return iv(r)}catch{return t}}var Va={},Dy=null;function X0(){return Dy=Dy||new rr}Va.Ta="serverreachability";function vA(e){Cr.call(this,Va.Ta,e)}nr(vA,Cr);function Kc(e){const t=X0();ur(t,new vA(t))}Va.STAT_EVENT="statevent";function _A(e,t){Cr.call(this,Va.STAT_EVENT,e),this.stat=t}nr(_A,Cr);function $r(e){const t=X0();ur(t,new _A(t,e))}Va.Ua="timingevent";function xA(e,t){Cr.call(this,Va.Ua,e),this.size=t}nr(xA,Cr);function Au(e,t){if(typeof e!="function")throw Error("Fn must not be null and must be a function");return De.setTimeout(function(){e()},t)}var Y0={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},yA={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function lv(){}lv.prototype.h=null;function Oy(e){return e.h||(e.h=e.i())}function EA(){}var Su={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function cv(){Cr.call(this,"d")}nr(cv,Cr);function uv(){Cr.call(this,"c")}nr(uv,Cr);var sg;function Q0(){}nr(Q0,lv);Q0.prototype.g=function(){return new XMLHttpRequest};Q0.prototype.i=function(){return{}};sg=new Q0;function Iu(e,t,r,n){this.l=e,this.j=t,this.m=r,this.W=n||1,this.U=new Gc(this),this.P=qL,e=eg?125:void 0,this.V=new K0(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new wA}function wA(){this.i=null,this.g="",this.h=!1}var qL=45e3,ag={},$h={};_e=Iu.prototype;_e.setTimeout=function(e){this.P=e};function og(e,t,r){e.L=1,e.v=Z0($i(t)),e.s=r,e.S=!0,TA(e,null)}function TA(e,t){e.G=Date.now(),Cu(e),e.A=$i(e.v);var r=e.A,n=e.W;Array.isArray(n)||(n=[String(n)]),FA(r.i,"t",n),e.C=0,r=e.l.J,e.h=new wA,e.g=JA(e.l,r?t:null,!e.s),0<e.O&&(e.M=new zL(Ir(e.Pa,e,e.g),e.O)),mA(e.U,e.g,"readystatechange",e.nb),t=e.I?sA(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),Kc(),HL(e.j,e.u,e.A,e.m,e.W,e.s)}_e.nb=function(e){e=e.target;const t=this.M;t&&ii(e)==3?t.l():this.Pa(e)};_e.Pa=function(e){try{if(e==this.g)e:{const u=ii(this.g);var t=this.g.Ia();const f=this.g.da();if(!(3>u)&&(u!=3||eg||this.g&&(this.h.h||this.g.ja()||Vy(this.g)))){this.J||u!=4||t==7||(t==8||0>=f?Kc(3):Kc(2)),J0(this);var r=this.g.da();this.ca=r;t:if(kA(this)){var n=Vy(this.g);e="";var i=n.length,s=ii(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){aa(this),nc(this);var a="";break t}this.h.i=new De.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(n[t],{stream:s&&t==i-1});n.splice(0,i),this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.ja();if(this.i=r==200,WL(this.j,this.u,this.A,this.m,this.W,u,r),this.i){if(this.aa&&!this.K){t:{if(this.g){var o,l=this.g;if((o=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!jc(o)){var c=o;break t}}c=null}if(r=c)mo(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,lg(this,r);else{this.i=!1,this.o=3,$r(12),aa(this),nc(this);break e}}this.S?(AA(this,u,a),eg&&this.i&&u==3&&(mA(this.U,this.V,"tick",this.mb),this.V.start())):(mo(this.j,this.m,a,null),lg(this,a)),u==4&&aa(this),this.i&&!this.J&&(u==4?qA(this.l,this):(this.i=!1,Cu(this)))}else m6(this.g),r==400&&0<a.indexOf("Unknown SID")?(this.o=3,$r(12)):(this.o=0,$r(13)),aa(this),nc(this)}}}catch{}finally{}};function kA(e){return e.g?e.u=="GET"&&e.L!=2&&e.l.Ha:!1}function AA(e,t,r){let n=!0,i;for(;!e.J&&e.C<r.length;)if(i=XL(e,r),i==$h){t==4&&(e.o=4,$r(14),n=!1),mo(e.j,e.m,null,"[Incomplete Response]");break}else if(i==ag){e.o=4,$r(15),mo(e.j,e.m,r,"[Invalid Chunk]"),n=!1;break}else mo(e.j,e.m,i,null),lg(e,i);kA(e)&&i!=$h&&i!=ag&&(e.h.g="",e.C=0),t!=4||r.length!=0||e.h.h||(e.o=1,$r(16),n=!1),e.i=e.i&&n,n?0<r.length&&!e.ba&&(e.ba=!0,t=e.l,t.g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+r.length),gv(t),t.M=!0,$r(11))):(mo(e.j,e.m,r,"[Invalid Chunked Response]"),aa(e),nc(e))}_e.mb=function(){if(this.g){var e=ii(this.g),t=this.g.ja();this.C<t.length&&(J0(this),AA(this,e,t),this.i&&e!=4&&Cu(this))}};function XL(e,t){var r=e.C,n=t.indexOf(`
`,r);return n==-1?$h:(r=Number(t.substring(r,n)),isNaN(r)?ag:(n+=1,n+r>t.length?$h:(t=t.slice(n,n+r),e.C=n+r,t)))}_e.cancel=function(){this.J=!0,aa(this)};function Cu(e){e.Y=Date.now()+e.P,SA(e,e.P)}function SA(e,t){if(e.B!=null)throw Error("WatchDog timer not null");e.B=Au(Ir(e.lb,e),t)}function J0(e){e.B&&(De.clearTimeout(e.B),e.B=null)}_e.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(GL(this.j,this.A),this.L!=2&&(Kc(),$r(17)),aa(this),this.o=2,nc(this)):SA(this,this.Y-e)};function nc(e){e.l.H==0||e.J||qA(e.l,e)}function aa(e){J0(e);var t=e.M;t&&typeof t.sa=="function"&&t.sa(),e.M=null,av(e.V),gA(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function lg(e,t){try{var r=e.l;if(r.H!=0&&(r.g==e||cg(r.i,e))){if(!e.K&&cg(r.i,e)&&r.H==3){try{var n=r.Ja.g.parse(t)}catch{n=null}if(Array.isArray(n)&&n.length==3){var i=n;if(i[0]==0){e:if(!r.u){if(r.g)if(r.g.G+3e3<e.G)Hh(r),rd(r);else break e;mv(r),$r(18)}}else r.Fa=i[1],0<r.Fa-r.V&&37500>i[2]&&r.G&&r.A==0&&!r.v&&(r.v=Au(Ir(r.ib,r),6e3));if(1>=OA(r.i)&&r.oa){try{r.oa()}catch{}r.oa=void 0}}else oa(r,11)}else if((e.K||r.g==e)&&Hh(r),!jc(t))for(i=r.Ja.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(r.V=c[0],c=c[1],r.H==2)if(c[0]=="c"){r.K=c[1],r.pa=c[2];const u=c[3];u!=null&&(r.ra=u,r.l.info("VER="+r.ra));const f=c[4];f!=null&&(r.Ga=f,r.l.info("SVER="+r.Ga));const h=c[5];h!=null&&typeof h=="number"&&0<h&&(n=1.5*h,r.L=n,r.l.info("backChannelRequestTimeoutMs_="+n)),n=r;const d=e.g;if(d){const p=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=n.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(fv(s,s.h),s.h=null))}if(n.F){const m=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;m&&(n.Da=m,ut(n.I,n.F,m))}}r.H=3,r.h&&r.h.Ba(),r.ca&&(r.S=Date.now()-e.G,r.l.info("Handshake RTT: "+r.S+"ms")),n=r;var a=e;if(n.wa=QA(n,n.J?n.pa:null,n.Y),a.K){LA(n.i,a);var o=a,l=n.L;l&&o.setTimeout(l),o.B&&(J0(o),Cu(o)),n.g=a}else GA(n);0<r.j.length&&nd(r)}else c[0]!="stop"&&c[0]!="close"||oa(r,7);else r.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?oa(r,7):pv(r):c[0]!="noop"&&r.h&&r.h.Aa(c),r.A=0)}}Kc(4)}catch{}}function YL(e){if(e.Z&&typeof e.Z=="function")return e.Z();if(typeof Map<"u"&&e instanceof Map||typeof Set<"u"&&e instanceof Set)return Array.from(e.values());if(typeof e=="string")return e.split("");if(z0(e)){for(var t=[],r=e.length,n=0;n<r;n++)t.push(e[n]);return t}t=[],r=0;for(n in e)t[r++]=e[n];return t}function QL(e){if(e.ta&&typeof e.ta=="function")return e.ta();if(!e.Z||typeof e.Z!="function"){if(typeof Map<"u"&&e instanceof Map)return Array.from(e.keys());if(!(typeof Set<"u"&&e instanceof Set)){if(z0(e)||typeof e=="string"){var t=[];e=e.length;for(var r=0;r<e;r++)t.push(r);return t}t=[],r=0;for(const n in e)t[r++]=n;return t}}}function IA(e,t){if(e.forEach&&typeof e.forEach=="function")e.forEach(t,void 0);else if(z0(e)||typeof e=="string")Array.prototype.forEach.call(e,t,void 0);else for(var r=QL(e),n=YL(e),i=n.length,s=0;s<i;s++)t.call(void 0,n[s],r&&r[s],e)}var CA=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function JL(e,t){if(e){e=e.split("&");for(var r=0;r<e.length;r++){var n=e[r].indexOf("="),i=null;if(0<=n){var s=e[r].substring(0,n);i=e[r].substring(n+1)}else s=e[r];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function pa(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof pa){this.h=e.h,jh(this,e.j),this.s=e.s,this.g=e.g,zh(this,e.m),this.l=e.l;var t=e.i,r=new qc;r.i=t.i,t.g&&(r.g=new Map(t.g),r.h=t.h),Ly(this,r),this.o=e.o}else e&&(t=String(e).match(CA))?(this.h=!1,jh(this,t[1]||"",!0),this.s=bl(t[2]||""),this.g=bl(t[3]||"",!0),zh(this,t[4]),this.l=bl(t[5]||"",!0),Ly(this,t[6]||"",!0),this.o=bl(t[7]||"")):(this.h=!1,this.i=new qc(null,this.h))}pa.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Vl(t,My,!0),":");var r=this.g;return(r||t=="file")&&(e.push("//"),(t=this.s)&&e.push(Vl(t,My,!0),"@"),e.push(encodeURIComponent(String(r)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),r=this.m,r!=null&&e.push(":",String(r))),(r=this.l)&&(this.g&&r.charAt(0)!="/"&&e.push("/"),e.push(Vl(r,r.charAt(0)=="/"?t6:e6,!0))),(r=this.i.toString())&&e.push("?",r),(r=this.o)&&e.push("#",Vl(r,n6)),e.join("")};function $i(e){return new pa(e)}function jh(e,t,r){e.j=r?bl(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function zh(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Ly(e,t,r){t instanceof qc?(e.i=t,i6(e.i,e.h)):(r||(t=Vl(t,r6)),e.i=new qc(t,e.h))}function ut(e,t,r){e.i.set(t,r)}function Z0(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function bl(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Vl(e,t,r){return typeof e=="string"?(e=encodeURI(e).replace(t,ZL),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ZL(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)}var My=/[#\/\?@]/g,e6=/[#\?:]/g,t6=/[#\?]/g,r6=/[#\?@]/g,n6=/#/g;function qc(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Hs(e){e.g||(e.g=new Map,e.h=0,e.i&&JL(e.i,function(t,r){e.add(decodeURIComponent(t.replace(/\+/g," ")),r)}))}_e=qc.prototype;_e.add=function(e,t){Hs(this),this.i=null,e=sl(this,e);var r=this.g.get(e);return r||this.g.set(e,r=[]),r.push(t),this.h+=1,this};function RA(e,t){Hs(e),t=sl(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function PA(e,t){return Hs(e),t=sl(e,t),e.g.has(t)}_e.forEach=function(e,t){Hs(this),this.g.forEach(function(r,n){r.forEach(function(i){e.call(t,i,n,this)},this)},this)};_e.ta=function(){Hs(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),r=[];for(let n=0;n<t.length;n++){const i=e[n];for(let s=0;s<i.length;s++)r.push(t[n])}return r};_e.Z=function(e){Hs(this);let t=[];if(typeof e=="string")PA(this,e)&&(t=t.concat(this.g.get(sl(this,e))));else{e=Array.from(this.g.values());for(let r=0;r<e.length;r++)t=t.concat(e[r])}return t};_e.set=function(e,t){return Hs(this),this.i=null,e=sl(this,e),PA(this,e)&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this};_e.get=function(e,t){return e?(e=this.Z(e),0<e.length?String(e[0]):t):t};function FA(e,t,r){RA(e,t),0<r.length&&(e.i=null,e.g.set(sl(e,t),Q1(r)),e.h+=r.length)}_e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var r=0;r<t.length;r++){var n=t[r];const s=encodeURIComponent(String(n)),a=this.Z(n);for(n=0;n<a.length;n++){var i=s;a[n]!==""&&(i+="="+encodeURIComponent(String(a[n]))),e.push(i)}}return this.i=e.join("&")};function sl(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function i6(e,t){t&&!e.j&&(Hs(e),e.i=null,e.g.forEach(function(r,n){var i=n.toLowerCase();n!=i&&(RA(this,n),FA(this,i,r))},e)),e.j=t}var s6=class{constructor(e,t){this.g=e,this.map=t}};function NA(e){this.l=e||a6,De.PerformanceNavigationTiming?(e=De.performance.getEntriesByType("navigation"),e=0<e.length&&(e[0].nextHopProtocol=="hq"||e[0].nextHopProtocol=="h2")):e=!!(De.g&&De.g.Ka&&De.g.Ka()&&De.g.Ka().dc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var a6=10;function DA(e){return e.h?!0:e.g?e.g.size>=e.j:!1}function OA(e){return e.h?1:e.g?e.g.size:0}function cg(e,t){return e.h?e.h==t:e.g?e.g.has(t):!1}function fv(e,t){e.g?e.g.add(t):e.h=t}function LA(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}NA.prototype.cancel=function(){if(this.i=MA(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const e of this.g.values())e.cancel();this.g.clear()}};function MA(e){if(e.h!=null)return e.i.concat(e.h.F);if(e.g!=null&&e.g.size!==0){let t=e.i;for(const r of e.g.values())t=t.concat(r.F);return t}return Q1(e.i)}var o6=class{stringify(e){return De.JSON.stringify(e,void 0)}parse(e){return De.JSON.parse(e,void 0)}};function l6(){this.g=new o6}function c6(e,t,r){const n=r||"";try{IA(e,function(i,s){let a=i;Tu(i)&&(a=iv(i)),t.push(n+s+"="+encodeURIComponent(a))})}catch(i){throw t.push(n+"type="+encodeURIComponent("_badmap")),i}}function u6(e,t){const r=new q0;if(De.Image){const n=new Image;n.onload=mf(vf,r,n,"TestLoadImage: loaded",!0,t),n.onerror=mf(vf,r,n,"TestLoadImage: error",!1,t),n.onabort=mf(vf,r,n,"TestLoadImage: abort",!1,t),n.ontimeout=mf(vf,r,n,"TestLoadImage: timeout",!1,t),De.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=e}else t(!1)}function vf(e,t,r,n,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(n)}catch{}}function Ru(e){this.l=e.ec||null,this.j=e.ob||!1}nr(Ru,lv);Ru.prototype.g=function(){return new ed(this.l,this.j)};Ru.prototype.i=function(e){return function(){return e}}({});function ed(e,t){rr.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=hv,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}nr(ed,rr);var hv=0;_e=ed.prototype;_e.open=function(e,t){if(this.readyState!=hv)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Xc(this)};_e.send=function(e){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||De).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))};_e.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Pu(this)),this.readyState=hv};_e.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Xc(this)),this.g&&(this.readyState=3,Xc(this),this.g)))if(this.responseType==="arraybuffer")e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof De.ReadableStream<"u"&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;bA(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))};function bA(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}_e.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Pu(this):Xc(this),this.readyState==3&&bA(this)}};_e.Za=function(e){this.g&&(this.response=this.responseText=e,Pu(this))};_e.Ya=function(e){this.g&&(this.response=e,Pu(this))};_e.ka=function(){this.g&&Pu(this)};function Pu(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Xc(e)}_e.setRequestHeader=function(e,t){this.v.append(e,t)};_e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""};_e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var r=t.next();!r.done;)r=r.value,e.push(r[0]+": "+r[1]),r=t.next();return e.join(`\r
`)};function Xc(e){e.onreadystatechange&&e.onreadystatechange.call(e)}Object.defineProperty(ed.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(e){this.m=e?"include":"same-origin"}});var f6=De.JSON.parse;function It(e){rr.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=VA,this.L=this.M=!1}nr(It,rr);var VA="",h6=/^https?$/i,d6=["POST","PUT"];_e=It.prototype;_e.Oa=function(e){this.M=e};_e.ha=function(e,t,r,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():sg.g(),this.C=this.u?Oy(this.u):Oy(sg),this.g.onreadystatechange=Ir(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(s){by(this,s);return}if(e=r||"",r=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var i in n)r.set(i,n[i]);else if(typeof n.keys=="function"&&typeof n.get=="function")for(const s of n.keys())r.set(s,n.get(s));else throw Error("Unknown input type for opt_headers: "+String(n));n=Array.from(r.keys()).find(s=>s.toLowerCase()=="content-type"),i=De.FormData&&e instanceof De.FormData,!(0<=tA(d6,t))||n||i||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of r)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{$A(this),0<this.B&&((this.L=p6(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ir(this.ua,this)):this.A=ov(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){by(this,s)}};function p6(e){return Uo&&typeof e.timeout=="number"&&e.ontimeout!==void 0}_e.ua=function(){typeof Y1<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ur(this,"timeout"),this.abort(8))};function by(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,BA(e),td(e)}function BA(e){e.F||(e.F=!0,ur(e,"complete"),ur(e,"error"))}_e.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,ur(this,"complete"),ur(this,"abort"),td(this))};_e.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),td(this,!0)),It.$.N.call(this)};_e.La=function(){this.s||(this.G||this.v||this.l?UA(this):this.kb())};_e.kb=function(){UA(this)};function UA(e){if(e.h&&typeof Y1<"u"&&(!e.C[1]||ii(e)!=4||e.da()!=2)){if(e.v&&ii(e)==4)ov(e.La,0,e);else if(ur(e,"readystatechange"),ii(e)==4){e.h=!1;try{const a=e.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var r;if(!(r=t)){var n;if(n=a===0){var i=String(e.I).match(CA)[1]||null;!i&&De.self&&De.self.location&&(i=De.self.location.protocol.slice(0,-1)),n=!h6.test(i?i.toLowerCase():"")}r=n}if(r)ur(e,"complete"),ur(e,"success");else{e.m=6;try{var s=2<ii(e)?e.g.statusText:""}catch{s=""}e.j=s+" ["+e.da()+"]",BA(e)}}finally{td(e)}}}}function td(e,t){if(e.g){$A(e);const r=e.g,n=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||ur(e,"ready");try{r.onreadystatechange=n}catch{}}}function $A(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(De.clearTimeout(e.A),e.A=null)}_e.isActive=function(){return!!this.g};function ii(e){return e.g?e.g.readyState:0}_e.da=function(){try{return 2<ii(this)?this.g.status:-1}catch{return-1}};_e.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};_e.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&t.indexOf(e)==0&&(t=t.substring(e.length)),f6(t)}};function Vy(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case VA:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}function m6(e){const t={};e=(e.g&&2<=ii(e)&&e.g.getAllResponseHeaders()||"").split(`\r
`);for(let n=0;n<e.length;n++){if(jc(e[n]))continue;var r=UL(e[n]);const i=r[0];if(r=r[1],typeof r!="string")continue;r=r.trim();const s=t[i]||[];t[i]=s,s.push(r)}DL(t,function(n){return n.join(", ")})}_e.Ia=function(){return this.m};_e.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function jA(e){let t="";return Z1(e,function(r,n){t+=n,t+=":",t+=r,t+=`\r
`}),t}function dv(e,t,r){e:{for(n in r){var n=!1;break e}n=!0}n||(r=jA(r),typeof e=="string"?r!=null&&encodeURIComponent(String(r)):ut(e,t,r))}function Sl(e,t,r){return r&&r.internalChannelParams&&r.internalChannelParams[e]||t}function zA(e){this.Ga=0,this.j=[],this.l=new q0,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Sl("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Sl("baseRetryDelayMs",5e3,e),this.hb=Sl("retryDelaySeedMs",1e4,e),this.eb=Sl("forwardChannelMaxRetries",2,e),this.xa=Sl("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new NA(e&&e.concurrentRequestLimit),this.Ja=new l6,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}_e=zA.prototype;_e.ra=8;_e.H=1;function pv(e){if(HA(e),e.H==3){var t=e.W++,r=$i(e.I);if(ut(r,"SID",e.K),ut(r,"RID",t),ut(r,"TYPE","terminate"),Fu(e,r),t=new Iu(e,e.l,t),t.L=2,t.v=Z0($i(r)),r=!1,De.navigator&&De.navigator.sendBeacon)try{r=De.navigator.sendBeacon(t.v.toString(),"")}catch{}!r&&De.Image&&(new Image().src=t.v,r=!0),r||(t.g=JA(t.l,null),t.g.ha(t.v)),t.G=Date.now(),Cu(t)}YA(e)}function rd(e){e.g&&(gv(e),e.g.cancel(),e.g=null)}function HA(e){rd(e),e.u&&(De.clearTimeout(e.u),e.u=null),Hh(e),e.i.cancel(),e.m&&(typeof e.m=="number"&&De.clearTimeout(e.m),e.m=null)}function nd(e){if(!DA(e.i)&&!e.m){e.m=!0;var t=e.Na;Hc||dA(),Wc||(Hc(),Wc=!0),sv.add(t,e),e.C=0}}function g6(e,t){return OA(e.i)>=e.i.j-(e.m?1:0)?!1:e.m?(e.j=t.F.concat(e.j),!0):e.H==1||e.H==2||e.C>=(e.cb?0:e.eb)?!1:(e.m=Au(Ir(e.Na,e,t),XA(e,e.C)),e.C++,!0)}_e.Na=function(e){if(this.m)if(this.m=null,this.H==1){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const i=new Iu(this,this.l,e);let s=this.s;if(this.U&&(s?(s=sA(s),aA(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var t=0,r=0;r<this.j.length;r++){t:{var n=this.j[r];if("__data__"in n.map&&(n=n.map.__data__,typeof n=="string")){n=n.length;break t}n=void 0}if(n===void 0)break;if(t+=n,4096<t){t=r;break e}if(t===4096||r===this.j.length-1){t=r+1;break e}}t=1e3}else t=1e3;t=WA(this,i,t),r=$i(this.I),ut(r,"RID",e),ut(r,"CVER",22),this.F&&ut(r,"X-HTTP-Session-Id",this.F),Fu(this,r),s&&(this.O?t="headers="+encodeURIComponent(String(jA(s)))+"&"+t:this.o&&dv(r,this.o,s)),fv(this.i,i),this.bb&&ut(r,"TYPE","init"),this.P?(ut(r,"$req",t),ut(r,"SID","null"),i.aa=!0,og(i,r,null)):og(i,r,t),this.H=2}}else this.H==3&&(e?By(this,e):this.j.length==0||DA(this.i)||By(this))};function By(e,t){var r;t?r=t.m:r=e.W++;const n=$i(e.I);ut(n,"SID",e.K),ut(n,"RID",r),ut(n,"AID",e.V),Fu(e,n),e.o&&e.s&&dv(n,e.o,e.s),r=new Iu(e,e.l,r,e.C+1),e.o===null&&(r.I=e.s),t&&(e.j=t.F.concat(e.j)),t=WA(e,r,1e3),r.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),fv(e.i,r),og(r,n,t)}function Fu(e,t){e.na&&Z1(e.na,function(r,n){ut(t,n,r)}),e.h&&IA({},function(r,n){ut(t,n,r)})}function WA(e,t,r){r=Math.min(e.j.length,r);var n=e.h?Ir(e.h.Va,e.h,e):null;e:{var i=e.j;let s=-1;for(;;){const a=["count="+r];s==-1?0<r?(s=i[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let o=!0;for(let l=0;l<r;l++){let c=i[l].g;const u=i[l].map;if(c-=s,0>c)s=Math.max(0,i[l].g-100),o=!1;else try{c6(u,a,"req"+c+"_")}catch{n&&n(u)}}if(o){n=a.join("&");break e}}}return e=e.j.splice(0,r),t.F=e,n}function GA(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Hc||dA(),Wc||(Hc(),Wc=!0),sv.add(t,e),e.A=0}}function mv(e){return e.g||e.u||3<=e.A?!1:(e.ba++,e.u=Au(Ir(e.Ma,e),XA(e,e.A)),e.A++,!0)}_e.Ma=function(){if(this.u=null,KA(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=Au(Ir(this.jb,this),e)}};_e.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,$r(10),rd(this),KA(this))};function gv(e){e.B!=null&&(De.clearTimeout(e.B),e.B=null)}function KA(e){e.g=new Iu(e,e.l,"rpc",e.ba),e.o===null&&(e.g.I=e.s),e.g.O=0;var t=$i(e.wa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.V),ut(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&ut(t,"TO",e.qa),ut(t,"TYPE","xmlhttp"),Fu(e,t),e.o&&e.s&&dv(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var r=e.g;e=e.pa,r.L=1,r.v=Z0($i(t)),r.s=null,r.S=!0,TA(r,e)}_e.ib=function(){this.v!=null&&(this.v=null,rd(this),mv(this),$r(19))};function Hh(e){e.v!=null&&(De.clearTimeout(e.v),e.v=null)}function qA(e,t){var r=null;if(e.g==t){Hh(e),gv(e),e.g=null;var n=2}else if(cg(e.i,t))r=t.F,LA(e.i,t),n=1;else return;if(e.H!=0){if(t.i)if(n==1){r=t.s?t.s.length:0,t=Date.now()-t.G;var i=e.C;n=X0(),ur(n,new xA(n,r)),nd(e)}else GA(e);else if(i=t.o,i==3||i==0&&0<t.ca||!(n==1&&g6(e,t)||n==2&&mv(e)))switch(r&&0<r.length&&(t=e.i,t.i=t.i.concat(r)),i){case 1:oa(e,5);break;case 4:oa(e,10);break;case 3:oa(e,6);break;default:oa(e,2)}}}function XA(e,t){let r=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(r*=2),r*t}function oa(e,t){if(e.l.info("Error code "+t),t==2){var r=null;e.h&&(r=null);var n=Ir(e.pb,e);r||(r=new pa("//www.google.com/images/cleardot.gif"),De.location&&De.location.protocol=="http"||jh(r,"https"),Z0(r)),u6(r.toString(),n)}else $r(2);e.H=0,e.h&&e.h.za(t),YA(e),HA(e)}_e.pb=function(e){e?(this.l.info("Successfully pinged google.com"),$r(2)):(this.l.info("Failed to ping google.com"),$r(1))};function YA(e){if(e.H=0,e.ma=[],e.h){const t=MA(e.i);(t.length!=0||e.j.length!=0)&&(Ry(e.ma,t),Ry(e.ma,e.j),e.i.i.length=0,Q1(e.j),e.j.length=0),e.h.ya()}}function QA(e,t,r){var n=r instanceof pa?$i(r):new pa(r);if(n.g!="")t&&(n.g=t+"."+n.g),zh(n,n.m);else{var i=De.location;n=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new pa(null);n&&jh(s,n),t&&(s.g=t),i&&zh(s,i),r&&(s.l=r),n=s}return r=e.F,t=e.Da,r&&t&&ut(n,r,t),ut(n,"VER",e.ra),Fu(e,n),n}function JA(e,t,r){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return t=r&&e.Ha&&!e.va?new It(new Ru({ob:!0})):new It(e.va),t.Oa(e.J),t}_e.isActive=function(){return!!this.h&&this.h.isActive(this)};function ZA(){}_e=ZA.prototype;_e.Ba=function(){};_e.Aa=function(){};_e.za=function(){};_e.ya=function(){};_e.isActive=function(){return!0};_e.Va=function(){};function Wh(){if(Uo&&!(10<=Number(RL)))throw Error("Environmental error: no available transport.")}Wh.prototype.g=function(e,t){return new vn(e,t)};function vn(e,t){rr.call(this),this.g=new zA(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!jc(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!jc(t)&&(this.g.F=t,e=this.h,e!==null&&t in e&&(e=this.h,t in e&&delete e[t])),this.j=new al(this)}nr(vn,rr);vn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,r=this.h||void 0;$r(0),e.Y=t,e.na=r||{},e.G=e.aa,e.I=QA(e,null,e.Y),nd(e)};vn.prototype.close=function(){pv(this.g)};vn.prototype.u=function(e){var t=this.g;if(typeof e=="string"){var r={};r.__data__=e,e=r}else this.v&&(r={},r.__data__=iv(e),e=r);t.j.push(new s6(t.fb++,e)),t.H==3&&nd(t)};vn.prototype.N=function(){this.g.h=null,delete this.j,pv(this.g),delete this.g,vn.$.N.call(this)};function eS(e){cv.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const r in t){e=r;break e}e=void 0}(this.i=e)&&(e=this.i,t=t!==null&&e in t?t[e]:void 0),this.data=t}else this.data=e}nr(eS,cv);function tS(){uv.call(this),this.status=1}nr(tS,uv);function al(e){this.g=e}nr(al,ZA);al.prototype.Ba=function(){ur(this.g,"a")};al.prototype.Aa=function(e){ur(this.g,new eS(e))};al.prototype.za=function(e){ur(this.g,new tS)};al.prototype.ya=function(){ur(this.g,"b")};function v6(){this.blockSize=-1}function Xn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}nr(Xn,v6);Xn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function vp(e,t,r){r||(r=0);var n=Array(16);if(typeof t=="string")for(var i=0;16>i;++i)n[i]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(i=0;16>i;++i)n[i]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],i=e.g[2];var s=e.g[3],a=t+(s^r&(i^s))+n[0]+3614090360&4294967295;t=r+(a<<7&4294967295|a>>>25),a=s+(i^t&(r^i))+n[1]+3905402710&4294967295,s=t+(a<<12&4294967295|a>>>20),a=i+(r^s&(t^r))+n[2]+606105819&4294967295,i=s+(a<<17&4294967295|a>>>15),a=r+(t^i&(s^t))+n[3]+3250441966&4294967295,r=i+(a<<22&4294967295|a>>>10),a=t+(s^r&(i^s))+n[4]+4118548399&4294967295,t=r+(a<<7&4294967295|a>>>25),a=s+(i^t&(r^i))+n[5]+1200080426&4294967295,s=t+(a<<12&4294967295|a>>>20),a=i+(r^s&(t^r))+n[6]+2821735955&4294967295,i=s+(a<<17&4294967295|a>>>15),a=r+(t^i&(s^t))+n[7]+4249261313&4294967295,r=i+(a<<22&4294967295|a>>>10),a=t+(s^r&(i^s))+n[8]+1770035416&4294967295,t=r+(a<<7&4294967295|a>>>25),a=s+(i^t&(r^i))+n[9]+2336552879&4294967295,s=t+(a<<12&4294967295|a>>>20),a=i+(r^s&(t^r))+n[10]+4294925233&4294967295,i=s+(a<<17&4294967295|a>>>15),a=r+(t^i&(s^t))+n[11]+2304563134&4294967295,r=i+(a<<22&4294967295|a>>>10),a=t+(s^r&(i^s))+n[12]+1804603682&4294967295,t=r+(a<<7&4294967295|a>>>25),a=s+(i^t&(r^i))+n[13]+4254626195&4294967295,s=t+(a<<12&4294967295|a>>>20),a=i+(r^s&(t^r))+n[14]+2792965006&4294967295,i=s+(a<<17&4294967295|a>>>15),a=r+(t^i&(s^t))+n[15]+1236535329&4294967295,r=i+(a<<22&4294967295|a>>>10),a=t+(i^s&(r^i))+n[1]+4129170786&4294967295,t=r+(a<<5&4294967295|a>>>27),a=s+(r^i&(t^r))+n[6]+3225465664&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^r&(s^t))+n[11]+643717713&4294967295,i=s+(a<<14&4294967295|a>>>18),a=r+(s^t&(i^s))+n[0]+3921069994&4294967295,r=i+(a<<20&4294967295|a>>>12),a=t+(i^s&(r^i))+n[5]+3593408605&4294967295,t=r+(a<<5&4294967295|a>>>27),a=s+(r^i&(t^r))+n[10]+38016083&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^r&(s^t))+n[15]+3634488961&4294967295,i=s+(a<<14&4294967295|a>>>18),a=r+(s^t&(i^s))+n[4]+3889429448&4294967295,r=i+(a<<20&4294967295|a>>>12),a=t+(i^s&(r^i))+n[9]+568446438&4294967295,t=r+(a<<5&4294967295|a>>>27),a=s+(r^i&(t^r))+n[14]+3275163606&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^r&(s^t))+n[3]+4107603335&4294967295,i=s+(a<<14&4294967295|a>>>18),a=r+(s^t&(i^s))+n[8]+1163531501&4294967295,r=i+(a<<20&4294967295|a>>>12),a=t+(i^s&(r^i))+n[13]+2850285829&4294967295,t=r+(a<<5&4294967295|a>>>27),a=s+(r^i&(t^r))+n[2]+4243563512&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^r&(s^t))+n[7]+1735328473&4294967295,i=s+(a<<14&4294967295|a>>>18),a=r+(s^t&(i^s))+n[12]+2368359562&4294967295,r=i+(a<<20&4294967295|a>>>12),a=t+(r^i^s)+n[5]+4294588738&4294967295,t=r+(a<<4&4294967295|a>>>28),a=s+(t^r^i)+n[8]+2272392833&4294967295,s=t+(a<<11&4294967295|a>>>21),a=i+(s^t^r)+n[11]+1839030562&4294967295,i=s+(a<<16&4294967295|a>>>16),a=r+(i^s^t)+n[14]+4259657740&4294967295,r=i+(a<<23&4294967295|a>>>9),a=t+(r^i^s)+n[1]+2763975236&4294967295,t=r+(a<<4&4294967295|a>>>28),a=s+(t^r^i)+n[4]+1272893353&4294967295,s=t+(a<<11&4294967295|a>>>21),a=i+(s^t^r)+n[7]+4139469664&4294967295,i=s+(a<<16&4294967295|a>>>16),a=r+(i^s^t)+n[10]+3200236656&4294967295,r=i+(a<<23&4294967295|a>>>9),a=t+(r^i^s)+n[13]+681279174&4294967295,t=r+(a<<4&4294967295|a>>>28),a=s+(t^r^i)+n[0]+3936430074&4294967295,s=t+(a<<11&4294967295|a>>>21),a=i+(s^t^r)+n[3]+3572445317&4294967295,i=s+(a<<16&4294967295|a>>>16),a=r+(i^s^t)+n[6]+76029189&4294967295,r=i+(a<<23&4294967295|a>>>9),a=t+(r^i^s)+n[9]+3654602809&4294967295,t=r+(a<<4&4294967295|a>>>28),a=s+(t^r^i)+n[12]+3873151461&4294967295,s=t+(a<<11&4294967295|a>>>21),a=i+(s^t^r)+n[15]+530742520&4294967295,i=s+(a<<16&4294967295|a>>>16),a=r+(i^s^t)+n[2]+3299628645&4294967295,r=i+(a<<23&4294967295|a>>>9),a=t+(i^(r|~s))+n[0]+4096336452&4294967295,t=r+(a<<6&4294967295|a>>>26),a=s+(r^(t|~i))+n[7]+1126891415&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~r))+n[14]+2878612391&4294967295,i=s+(a<<15&4294967295|a>>>17),a=r+(s^(i|~t))+n[5]+4237533241&4294967295,r=i+(a<<21&4294967295|a>>>11),a=t+(i^(r|~s))+n[12]+1700485571&4294967295,t=r+(a<<6&4294967295|a>>>26),a=s+(r^(t|~i))+n[3]+2399980690&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~r))+n[10]+4293915773&4294967295,i=s+(a<<15&4294967295|a>>>17),a=r+(s^(i|~t))+n[1]+2240044497&4294967295,r=i+(a<<21&4294967295|a>>>11),a=t+(i^(r|~s))+n[8]+1873313359&4294967295,t=r+(a<<6&4294967295|a>>>26),a=s+(r^(t|~i))+n[15]+4264355552&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~r))+n[6]+2734768916&4294967295,i=s+(a<<15&4294967295|a>>>17),a=r+(s^(i|~t))+n[13]+1309151649&4294967295,r=i+(a<<21&4294967295|a>>>11),a=t+(i^(r|~s))+n[4]+4149444226&4294967295,t=r+(a<<6&4294967295|a>>>26),a=s+(r^(t|~i))+n[11]+3174756917&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~r))+n[2]+718787259&4294967295,i=s+(a<<15&4294967295|a>>>17),a=r+(s^(i|~t))+n[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}Xn.prototype.j=function(e,t){t===void 0&&(t=e.length);for(var r=t-this.blockSize,n=this.m,i=this.h,s=0;s<t;){if(i==0)for(;s<=r;)vp(this,e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(n[i++]=e.charCodeAt(s++),i==this.blockSize){vp(this,n),i=0;break}}else for(;s<t;)if(n[i++]=e[s++],i==this.blockSize){vp(this,n),i=0;break}}this.h=i,this.i+=t};Xn.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var r=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=r&255,r/=256;for(this.j(e),e=Array(16),t=r=0;4>t;++t)for(var n=0;32>n;n+=8)e[r++]=this.g[t]>>>n&255;return e};function nt(e,t){this.h=t;for(var r=[],n=!0,i=e.length-1;0<=i;i--){var s=e[i]|0;n&&s==t||(r[i]=s,n=!1)}this.g=r}var _6={};function vv(e){return-128<=e&&128>e?SL(e,function(t){return new nt([t|0],0>t?-1:0)}):new nt([e|0],0>e?-1:0)}function si(e){if(isNaN(e)||!isFinite(e))return So;if(0>e)return or(si(-e));for(var t=[],r=1,n=0;e>=r;n++)t[n]=e/r|0,r*=ug;return new nt(t,0)}function rS(e,t){if(e.length==0)throw Error("number format error: empty string");if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(e.charAt(0)=="-")return or(rS(e.substring(1),t));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=si(Math.pow(t,8)),n=So,i=0;i<e.length;i+=8){var s=Math.min(8,e.length-i),a=parseInt(e.substring(i,i+s),t);8>s?(s=si(Math.pow(t,s)),n=n.R(s).add(si(a))):(n=n.R(r),n=n.add(si(a)))}return n}var ug=4294967296,So=vv(0),fg=vv(1),Uy=vv(16777216);_e=nt.prototype;_e.ea=function(){if(In(this))return-or(this).ea();for(var e=0,t=1,r=0;r<this.g.length;r++){var n=this.D(r);e+=(0<=n?n:ug+n)*t,t*=ug}return e};_e.toString=function(e){if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(Pi(this))return"0";if(In(this))return"-"+or(this).toString(e);for(var t=si(Math.pow(e,6)),r=this,n="";;){var i=Kh(r,t).g;r=Gh(r,i.R(t));var s=((0<r.g.length?r.g[0]:r.h)>>>0).toString(e);if(r=i,Pi(r))return s+n;for(;6>s.length;)s="0"+s;n=s+n}};_e.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h};function Pi(e){if(e.h!=0)return!1;for(var t=0;t<e.g.length;t++)if(e.g[t]!=0)return!1;return!0}function In(e){return e.h==-1}_e.X=function(e){return e=Gh(this,e),In(e)?-1:Pi(e)?0:1};function or(e){for(var t=e.g.length,r=[],n=0;n<t;n++)r[n]=~e.g[n];return new nt(r,~e.h).add(fg)}_e.abs=function(){return In(this)?or(this):this};_e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0,i=0;i<=t;i++){var s=n+(this.D(i)&65535)+(e.D(i)&65535),a=(s>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);n=a>>>16,s&=65535,a&=65535,r[i]=a<<16|s}return new nt(r,r[r.length-1]&-2147483648?-1:0)};function Gh(e,t){return e.add(or(t))}_e.R=function(e){if(Pi(this)||Pi(e))return So;if(In(this))return In(e)?or(this).R(or(e)):or(or(this).R(e));if(In(e))return or(this.R(or(e)));if(0>this.X(Uy)&&0>e.X(Uy))return si(this.ea()*e.ea());for(var t=this.g.length+e.g.length,r=[],n=0;n<2*t;n++)r[n]=0;for(n=0;n<this.g.length;n++)for(var i=0;i<e.g.length;i++){var s=this.D(n)>>>16,a=this.D(n)&65535,o=e.D(i)>>>16,l=e.D(i)&65535;r[2*n+2*i]+=a*l,_f(r,2*n+2*i),r[2*n+2*i+1]+=s*l,_f(r,2*n+2*i+1),r[2*n+2*i+1]+=a*o,_f(r,2*n+2*i+1),r[2*n+2*i+2]+=s*o,_f(r,2*n+2*i+2)}for(n=0;n<t;n++)r[n]=r[2*n+1]<<16|r[2*n];for(n=t;n<2*t;n++)r[n]=0;return new nt(r,0)};function _f(e,t){for(;(e[t]&65535)!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Il(e,t){this.g=e,this.h=t}function Kh(e,t){if(Pi(t))throw Error("division by zero");if(Pi(e))return new Il(So,So);if(In(e))return t=Kh(or(e),t),new Il(or(t.g),or(t.h));if(In(t))return t=Kh(e,or(t)),new Il(or(t.g),t.h);if(30<e.g.length){if(In(e)||In(t))throw Error("slowDivide_ only works with positive integers.");for(var r=fg,n=t;0>=n.X(e);)r=$y(r),n=$y(n);var i=qa(r,1),s=qa(n,1);for(n=qa(n,2),r=qa(r,2);!Pi(n);){var a=s.add(n);0>=a.X(e)&&(i=i.add(r),s=a),n=qa(n,1),r=qa(r,1)}return t=Gh(e,i.R(t)),new Il(i,t)}for(i=So;0<=e.X(t);){for(r=Math.max(1,Math.floor(e.ea()/t.ea())),n=Math.ceil(Math.log(r)/Math.LN2),n=48>=n?1:Math.pow(2,n-48),s=si(r),a=s.R(t);In(a)||0<a.X(e);)r-=n,s=si(r),a=s.R(t);Pi(s)&&(s=fg),i=i.add(s),e=Gh(e,a)}return new Il(i,e)}_e.gb=function(e){return Kh(this,e).h};_e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.D(n)&e.D(n);return new nt(r,this.h&e.h)};_e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.D(n)|e.D(n);return new nt(r,this.h|e.h)};_e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.D(n)^e.D(n);return new nt(r,this.h^e.h)};function $y(e){for(var t=e.g.length+1,r=[],n=0;n<t;n++)r[n]=e.D(n)<<1|e.D(n-1)>>>31;return new nt(r,e.h)}function qa(e,t){var r=t>>5;t%=32;for(var n=e.g.length-r,i=[],s=0;s<n;s++)i[s]=0<t?e.D(s+r)>>>t|e.D(s+r+1)<<32-t:e.D(s+r);return new nt(i,e.h)}Wh.prototype.createWebChannel=Wh.prototype.g;vn.prototype.send=vn.prototype.u;vn.prototype.open=vn.prototype.m;vn.prototype.close=vn.prototype.close;Y0.NO_ERROR=0;Y0.TIMEOUT=8;Y0.HTTP_ERROR=6;yA.COMPLETE="complete";EA.EventType=Su;Su.OPEN="a";Su.CLOSE="b";Su.ERROR="c";Su.MESSAGE="d";rr.prototype.listen=rr.prototype.O;It.prototype.listenOnce=It.prototype.P;It.prototype.getLastError=It.prototype.Sa;It.prototype.getLastErrorCode=It.prototype.Ia;It.prototype.getStatus=It.prototype.da;It.prototype.getResponseJson=It.prototype.Wa;It.prototype.getResponseText=It.prototype.ja;It.prototype.send=It.prototype.ha;It.prototype.setWithCredentials=It.prototype.Oa;Xn.prototype.digest=Xn.prototype.l;Xn.prototype.reset=Xn.prototype.reset;Xn.prototype.update=Xn.prototype.j;nt.prototype.add=nt.prototype.add;nt.prototype.multiply=nt.prototype.R;nt.prototype.modulo=nt.prototype.gb;nt.prototype.compare=nt.prototype.X;nt.prototype.toNumber=nt.prototype.ea;nt.prototype.toString=nt.prototype.toString;nt.prototype.getBits=nt.prototype.D;nt.fromNumber=si;nt.fromString=rS;var x6=function(){return new Wh},y6=function(){return X0()},_p=Y0,E6=yA,w6=Va,jy={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},T6=Ru,xf=EA,k6=It,A6=Xn,Io=nt;const zy="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}yr.UNAUTHENTICATED=new yr(null),yr.GOOGLE_CREDENTIALS=new yr("google-credentials-uid"),yr.FIRST_PARTY=new yr("first-party-uid"),yr.MOCK_USER=new yr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ol="10.5.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sa=new V1("@firebase/firestore");function Cl(){return Sa.logLevel}function Ie(e,...t){if(Sa.logLevel<=Ge.DEBUG){const r=t.map(_v);Sa.debug(`Firestore (${ol}): ${e}`,...r)}}function ji(e,...t){if(Sa.logLevel<=Ge.ERROR){const r=t.map(_v);Sa.error(`Firestore (${ol}): ${e}`,...r)}}function $o(e,...t){if(Sa.logLevel<=Ge.WARN){const r=t.map(_v);Sa.warn(`Firestore (${ol}): ${e}`,...r)}}function _v(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ne(e="Unexpected state"){const t=`FIRESTORE (${ol}) INTERNAL ASSERTION FAILED: `+e;throw ji(t),new Error(t)}function dt(e,t){e||Ne()}function Ve(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends xi{constructor(t,r){super(t,r),this.code=t,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(){this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS{constructor(t,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class S6{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,r){t.enqueueRetryable(()=>r(yr.UNAUTHENTICATED))}shutdown(){}}class I6{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,r){this.changeListener=r,t.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class C6{constructor(t){this.t=t,this.currentUser=yr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,r){let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new Di;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Di,t.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;t.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Ie("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Ie("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Di)}},0),a()}getToken(){const t=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==t?(Ie("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(dt(typeof n.accessToken=="string"),new nS(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return dt(t===null||typeof t=="string"),new yr(t)}}class R6{constructor(t,r,n){this.l=t,this.h=r,this.P=n,this.type="FirstParty",this.user=yr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class P6{constructor(t,r,n){this.l=t,this.h=r,this.P=n}getToken(){return Promise.resolve(new R6(this.l,this.h,this.P))}start(t,r){t.enqueueRetryable(()=>r(yr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class F6{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class N6{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,r){const n=s=>{s.error!=null&&Ie("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Ie("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>n(s))};const i=s=>{Ie("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Ie("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(r=>r?(dt(typeof r.token=="string"),this.R=r.token,new F6(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D6(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(r);else for(let n=0;n<e;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iS{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const i=D6(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=t.charAt(i[s]%t.length))}return n}}function tt(e,t){return e<t?-1:e>t?1:0}function jo(e,t,r){return e.length===t.length&&e.every((n,i)=>r(n,t[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(t,r){if(this.seconds=t,this.nanoseconds=r,r<0)throw new Te(Z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Te(Z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(t<-62135596800)throw new Te(Z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Te(Z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Kt.fromMillis(Date.now())}static fromDate(t){return Kt.fromMillis(t.getTime())}static fromMillis(t){const r=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*r));return new Kt(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?tt(this.nanoseconds,t.nanoseconds):tt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Oe(t)}static min(){return new Oe(new Kt(0,0))}static max(){return new Oe(new Kt(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{constructor(t,r,n){r===void 0?r=0:r>t.length&&Ne(),n===void 0?n=t.length-r:n>t.length-r&&Ne(),this.segments=t,this.offset=r,this.len=n}get length(){return this.len}isEqual(t){return Yc.comparator(this,t)===0}child(t){const r=this.segments.slice(this.offset,this.limit());return t instanceof Yc?t.forEach(n=>{r.push(n)}):r.push(t),this.construct(r)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}forEach(t){for(let r=this.offset,n=this.limit();r<n;r++)t(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,r){const n=Math.min(t.length,r.length);for(let i=0;i<n;i++){const s=t.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return t.length<r.length?-1:t.length>r.length?1:0}}class ft extends Yc{construct(t,r,n){return new ft(t,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const r=[];for(const n of t){if(n.indexOf("//")>=0)throw new Te(Z.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new ft(r)}static emptyPath(){return new ft([])}}const O6=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class lr extends Yc{construct(t,r,n){return new lr(t,r,n)}static isValidIdentifier(t){return O6.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),lr.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new lr(["__name__"])}static fromServerFormat(t){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new Te(Z.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<t.length;){const o=t[i];if(o==="\\"){if(i+1===t.length)throw new Te(Z.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Te(Z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new Te(Z.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new lr(r)}static emptyPath(){return new lr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(t){this.path=t}static fromPath(t){return new Re(ft.fromString(t))}static fromName(t){return new Re(ft.fromString(t).popFirst(5))}static empty(){return new Re(ft.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&ft.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,r){return ft.comparator(t.path,r.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Re(new ft(t.slice()))}}function L6(e,t){const r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1,i=Oe.fromTimestamp(n===1e9?new Kt(r+1,0):new Kt(r,n));return new Os(i,Re.empty(),t)}function M6(e){return new Os(e.readTime,e.key,-1)}class Os{constructor(t,r,n){this.readTime=t,this.documentKey=r,this.largestBatchId=n}static min(){return new Os(Oe.min(),Re.empty(),-1)}static max(){return new Os(Oe.max(),Re.empty(),-1)}}function b6(e,t){let r=e.readTime.compareTo(t.readTime);return r!==0?r:(r=Re.comparator(e.documentKey,t.documentKey),r!==0?r:tt(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class B6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nu(e){if(e.code!==Z.FAILED_PRECONDITION||e.message!==V6)throw e;Ie("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(t){return this.next(void 0,t)}next(t,r){return this.callbackAttached&&Ne(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(t,this.result):new ie((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((t,r)=>{this.next(t,r)})}wrapUserFunction(t){try{const r=t();return r instanceof ie?r:ie.resolve(r)}catch(r){return ie.reject(r)}}wrapSuccess(t,r){return t?this.wrapUserFunction(()=>t(r)):ie.resolve(r)}wrapFailure(t,r){return t?this.wrapUserFunction(()=>t(r)):ie.reject(r)}static resolve(t){return new ie((r,n)=>{r(t)})}static reject(t){return new ie((r,n)=>{n(t)})}static waitFor(t){return new ie((r,n)=>{let i=0,s=0,a=!1;t.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(t){let r=ie.resolve(!1);for(const n of t)r=r.next(i=>i?ie.resolve(i):n());return r}static forEach(t,r){const n=[];return t.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(t,r){return new ie((n,i)=>{const s=t.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(t[c]).next(u=>{a[c]=u,++o,o===s&&n(a)},u=>i(u))}})}static doWhile(t,r){return new ie((n,i)=>{const s=()=>{t()===!0?r().next(()=>{s()},i):n()};s()})}}function Du(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=n=>this.se(n),this.oe=n=>r.writeSequenceNumber(n))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}xv._e=-1;function id(e){return e==null}function qh(e){return e===0&&1/e==-1/0}function U6(e){return typeof e=="number"&&Number.isInteger(e)&&!qh(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hy(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function Ba(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function sS(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(t,r){this.comparator=t,this.root=r||sr.EMPTY}insert(t,r){return new Tt(this.comparator,this.root.insert(t,r,this.comparator).copy(null,null,sr.BLACK,null,null))}remove(t){return new Tt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,sr.BLACK,null,null))}get(t){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(t,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(t){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((r,n)=>(t(r,n),!1))}toString(){const t=[];return this.inorderTraversal((r,n)=>(t.push(`${r}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new yf(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new yf(this.root,t,this.comparator,!1)}getReverseIterator(){return new yf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new yf(this.root,t,this.comparator,!0)}}class yf{constructor(t,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=r?n(t.key,r):1,r&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const r={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class sr{constructor(t,r,n,i,s){this.key=t,this.value=r,this.color=n??sr.RED,this.left=i??sr.EMPTY,this.right=s??sr.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,n,i,s){return new sr(t??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,n){let i=this;const s=n(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(t,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return sr.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let n,i=this;if(r(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(t,i.key)===0){if(i.right.isEmpty())return sr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,sr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,sr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ne();const t=this.left.check();if(t!==this.right.check())throw Ne();return t+(this.isRed()?0:1)}}sr.EMPTY=null,sr.RED=!0,sr.BLACK=!1;sr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ne()}get value(){throw Ne()}get color(){throw Ne()}get left(){throw Ne()}get right(){throw Ne()}copy(t,r,n,i,s){return this}insert(t,r,n){return new sr(t,r)}remove(t,r){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(t){this.comparator=t,this.data=new Tt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((r,n)=>(t(r),!1))}forEachInRange(t,r){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;r(i.key)}}forEachWhile(t,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const r=this.data.getIteratorFrom(t);return r.hasNext()?r.getNext().key:null}getIterator(){return new Wy(this.data.getIterator())}getIteratorFrom(t){return new Wy(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let r=this;return r.size<t.size&&(r=t,t=this),t.forEach(n=>{r=r.add(n)}),r}isEqual(t){if(!(t instanceof fr)||this.size!==t.size)return!1;const r=this.data.getIterator(),n=t.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(r=>{t.push(r)}),t}toString(){const t=[];return this.forEach(r=>t.push(r)),"SortedSet("+t.toString()+")"}copy(t){const r=new fr(this.comparator);return r.data=t,r}}class Wy{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(t){this.fields=t,t.sort(lr.comparator)}static empty(){return new hn([])}unionWith(t){let r=new fr(lr.comparator);for(const n of this.fields)r=r.add(n);for(const n of t)r=r.add(n);return new hn(r.toArray())}covers(t){for(const r of this.fields)if(r.isPrefixOf(t))return!0;return!1}isEqual(t){return jo(this.fields,t.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(t){this.binaryString=t}static fromBase64String(t){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new aS("Invalid base64 string: "+s):s}}(t);return new Nr(r)}static fromUint8Array(t){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(t);return new Nr(r)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return tt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Nr.EMPTY_BYTE_STRING=new Nr("");const $6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ls(e){if(dt(!!e),typeof e=="string"){let t=0;const r=$6.exec(e);if(dt(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),t=Number(i)}const n=new Date(e);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:Mt(e.seconds),nanos:Mt(e.nanos)}}function Mt(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Ia(e){return typeof e=="string"?Nr.fromBase64String(e):Nr.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function Ev(e){const t=e.mapValue.fields.__previous_value__;return yv(t)?Ev(t):t}function Qc(e){const t=Ls(e.mapValue.fields.__local_write_time__.timestampValue);return new Kt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j6{constructor(t,r,n,i,s,a,o,l,c){this.databaseId=t,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class Jc{constructor(t,r){this.projectId=t,this.database=r||"(default)"}static empty(){return new Jc("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof Jc&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ef={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ca(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?yv(e)?4:z6(e)?9007199254740991:10:Ne()}function vi(e,t){if(e===t)return!0;const r=Ca(e);if(r!==Ca(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Qc(e).isEqual(Qc(t));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Ls(i.timestampValue),o=Ls(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(i,s){return Ia(i.bytesValue).isEqual(Ia(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(i,s){return Mt(i.geoPointValue.latitude)===Mt(s.geoPointValue.latitude)&&Mt(i.geoPointValue.longitude)===Mt(s.geoPointValue.longitude)}(e,t);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Mt(i.integerValue)===Mt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Mt(i.doubleValue),o=Mt(s.doubleValue);return a===o?qh(a)===qh(o):isNaN(a)&&isNaN(o)}return!1}(e,t);case 9:return jo(e.arrayValue.values||[],t.arrayValue.values||[],vi);case 10:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(Hy(a)!==Hy(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!vi(a[l],o[l])))return!1;return!0}(e,t);default:return Ne()}}function Zc(e,t){return(e.values||[]).find(r=>vi(r,t))!==void 0}function zo(e,t){if(e===t)return 0;const r=Ca(e),n=Ca(t);if(r!==n)return tt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return tt(e.booleanValue,t.booleanValue);case 2:return function(s,a){const o=Mt(s.integerValue||s.doubleValue),l=Mt(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(e,t);case 3:return Gy(e.timestampValue,t.timestampValue);case 4:return Gy(Qc(e),Qc(t));case 5:return tt(e.stringValue,t.stringValue);case 6:return function(s,a){const o=Ia(s),l=Ia(a);return o.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=tt(o[c],l[c]);if(u!==0)return u}return tt(o.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,a){const o=tt(Mt(s.latitude),Mt(a.latitude));return o!==0?o:tt(Mt(s.longitude),Mt(a.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(s,a){const o=s.values||[],l=a.values||[];for(let c=0;c<o.length&&c<l.length;++c){const u=zo(o[c],l[c]);if(u)return u}return tt(o.length,l.length)}(e.arrayValue,t.arrayValue);case 10:return function(s,a){if(s===Ef.mapValue&&a===Ef.mapValue)return 0;if(s===Ef.mapValue)return 1;if(a===Ef.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let f=0;f<l.length&&f<u.length;++f){const h=tt(l[f],u[f]);if(h!==0)return h;const d=zo(o[l[f]],c[u[f]]);if(d!==0)return d}return tt(l.length,u.length)}(e.mapValue,t.mapValue);default:throw Ne()}}function Gy(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return tt(e,t);const r=Ls(e),n=Ls(t),i=tt(r.seconds,n.seconds);return i!==0?i:tt(r.nanos,n.nanos)}function Ho(e){return hg(e)}function hg(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(r){const n=Ls(r);return`time(${n.seconds},${n.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(r){return Ia(r).toBase64()}(e.bytesValue):"referenceValue"in e?function(r){return Re.fromName(r).toString()}(e.referenceValue):"geoPointValue"in e?function(r){return`geo(${r.latitude},${r.longitude})`}(e.geoPointValue):"arrayValue"in e?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=hg(s);return n+"]"}(e.arrayValue):"mapValue"in e?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${hg(r.fields[a])}`;return i+"}"}(e.mapValue):Ne()}function Ky(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function dg(e){return!!e&&"integerValue"in e}function wv(e){return!!e&&"arrayValue"in e}function qy(e){return!!e&&"nullValue"in e}function Xy(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function eh(e){return!!e&&"mapValue"in e}function ic(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Ba(e.mapValue.fields,(r,n)=>t.mapValue.fields[r]=ic(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=ic(e.arrayValue.values[r]);return t}return Object.assign({},e)}function z6(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr{constructor(t){this.value=t}static empty(){return new Jr({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let r=this.value;for(let n=0;n<t.length-1;++n)if(r=(r.mapValue.fields||{})[t.get(n)],!eh(r))return null;return r=(r.mapValue.fields||{})[t.lastSegment()],r||null}}set(t,r){this.getFieldsMap(t.popLast())[t.lastSegment()]=ic(r)}setAll(t){let r=lr.emptyPath(),n={},i=[];t.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=ic(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(t){const r=this.field(t.popLast());eh(r)&&r.mapValue.fields&&delete r.mapValue.fields[t.lastSegment()]}isEqual(t){return vi(this.value,t.value)}getFieldsMap(t){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=r.mapValue.fields[t.get(n)];eh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[t.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(t,r,n){Ba(r,(i,s)=>t[i]=s);for(const i of n)delete t[i]}clone(){return new Jr(ic(this.value))}}function oS(e){const t=[];return Ba(e.fields,(r,n)=>{const i=new lr([r]);if(eh(n)){const s=oS(n.mapValue).fields;if(s.length===0)t.push(i);else for(const a of s)t.push(i.child(a))}else t.push(i)}),new hn(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(t,r,n,i,s,a,o){this.key=t,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(t){return new kr(t,0,Oe.min(),Oe.min(),Oe.min(),Jr.empty(),0)}static newFoundDocument(t,r,n,i){return new kr(t,1,r,Oe.min(),n,i,0)}static newNoDocument(t,r){return new kr(t,2,r,Oe.min(),Oe.min(),Jr.empty(),0)}static newUnknownDocument(t,r){return new kr(t,3,r,Oe.min(),Oe.min(),Jr.empty(),2)}convertToFoundDocument(t,r){return!this.createTime.isEqual(Oe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Jr.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Jr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Oe.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof kr&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new kr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(t,r){this.position=t,this.inclusive=r}}function Yy(e,t,r){let n=0;for(let i=0;i<e.position.length;i++){const s=t[i],a=e.position[i];if(s.field.isKeyField()?n=Re.comparator(Re.fromName(a.referenceValue),r.key):n=zo(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function Qy(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!vi(e.position[r],t.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(t,r="asc"){this.field=t,this.dir=r}}function H6(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{}class Vt extends lS{constructor(t,r,n){super(),this.field=t,this.op=r,this.value=n}static create(t,r,n){return t.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(t,r,n):new G6(t,r,n):r==="array-contains"?new X6(t,n):r==="in"?new Y6(t,n):r==="not-in"?new Q6(t,n):r==="array-contains-any"?new J6(t,n):new Vt(t,r,n)}static createKeyFieldInFilter(t,r,n){return r==="in"?new K6(t,n):new q6(t,n)}matches(t){const r=t.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(zo(r,this.value)):r!==null&&Ca(this.value)===Ca(r)&&this.matchesComparison(zo(r,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Ne()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Yn extends lS{constructor(t,r){super(),this.filters=t,this.op=r,this.ue=null}static create(t,r){return new Yn(t,r)}matches(t){return cS(this)?this.filters.find(r=>!r.matches(t))===void 0:this.filters.find(r=>r.matches(t))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((t,r)=>t.concat(r.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function cS(e){return e.op==="and"}function uS(e){return W6(e)&&cS(e)}function W6(e){for(const t of e.filters)if(t instanceof Yn)return!1;return!0}function pg(e){if(e instanceof Vt)return e.field.canonicalString()+e.op.toString()+Ho(e.value);if(uS(e))return e.filters.map(t=>pg(t)).join(",");{const t=e.filters.map(r=>pg(r)).join(",");return`${e.op}(${t})`}}function fS(e,t){return e instanceof Vt?function(n,i){return i instanceof Vt&&n.op===i.op&&n.field.isEqual(i.field)&&vi(n.value,i.value)}(e,t):e instanceof Yn?function(n,i){return i instanceof Yn&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&fS(a,i.filters[o]),!0):!1}(e,t):void Ne()}function hS(e){return e instanceof Vt?function(r){return`${r.field.canonicalString()} ${r.op} ${Ho(r.value)}`}(e):e instanceof Yn?function(r){return r.op.toString()+" {"+r.getFilters().map(hS).join(" ,")+"}"}(e):"Filter"}class G6 extends Vt{constructor(t,r,n){super(t,r,n),this.key=Re.fromName(n.referenceValue)}matches(t){const r=Re.comparator(t.key,this.key);return this.matchesComparison(r)}}class K6 extends Vt{constructor(t,r){super(t,"in",r),this.keys=dS("in",r)}matches(t){return this.keys.some(r=>r.isEqual(t.key))}}class q6 extends Vt{constructor(t,r){super(t,"not-in",r),this.keys=dS("not-in",r)}matches(t){return!this.keys.some(r=>r.isEqual(t.key))}}function dS(e,t){var r;return(((r=t.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Re.fromName(n.referenceValue))}class X6 extends Vt{constructor(t,r){super(t,"array-contains",r)}matches(t){const r=t.data.field(this.field);return wv(r)&&Zc(r.arrayValue,this.value)}}class Y6 extends Vt{constructor(t,r){super(t,"in",r)}matches(t){const r=t.data.field(this.field);return r!==null&&Zc(this.value.arrayValue,r)}}class Q6 extends Vt{constructor(t,r){super(t,"not-in",r)}matches(t){if(Zc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=t.data.field(this.field);return r!==null&&!Zc(this.value.arrayValue,r)}}class J6 extends Vt{constructor(t,r){super(t,"array-contains-any",r)}matches(t){const r=t.data.field(this.field);return!(!wv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Zc(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z6{constructor(t,r=null,n=[],i=[],s=null,a=null,o=null){this.path=t,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ce=null}}function Jy(e,t=null,r=[],n=[],i=null,s=null,a=null){return new Z6(e,t,r,n,i,s,a)}function Tv(e){const t=Ve(e);if(t.ce===null){let r=t.path.canonicalString();t.collectionGroup!==null&&(r+="|cg:"+t.collectionGroup),r+="|f:",r+=t.filters.map(n=>pg(n)).join(","),r+="|ob:",r+=t.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),id(t.limit)||(r+="|l:",r+=t.limit),t.startAt&&(r+="|lb:",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(n=>Ho(n)).join(",")),t.endAt&&(r+="|ub:",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(n=>Ho(n)).join(",")),t.ce=r}return t.ce}function kv(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!H6(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!fS(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Qy(e.startAt,t.startAt)&&Qy(e.endAt,t.endAt)}function mg(e){return Re.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(t,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=t,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function eM(e,t,r,n,i,s,a,o){return new ll(e,t,r,n,i,s,a,o)}function Av(e){return new ll(e)}function Zy(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function pS(e){return e.collectionGroup!==null}function sc(e){const t=Ve(e);if(t.le===null){t.le=[];const r=new Set;for(const s of t.explicitOrderBy)t.le.push(s),r.add(s.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new fr(lr.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(t).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||t.le.push(new eu(s,n))}),r.has(lr.keyField().canonicalString())||t.le.push(new eu(lr.keyField(),n))}return t.le}function di(e){const t=Ve(e);return t.he||(t.he=tM(t,sc(e))),t.he}function tM(e,t){if(e.limitType==="F")return Jy(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new eu(i.field,s)});const r=e.endAt?new Xh(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new Xh(e.startAt.position,e.startAt.inclusive):null;return Jy(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function gg(e,t){const r=e.filters.concat([t]);return new ll(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function Yh(e,t,r){return new ll(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function sd(e,t){return kv(di(e),di(t))&&e.limitType===t.limitType}function mS(e){return`${Tv(di(e))}|lt:${e.limitType}`}function Qa(e){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>hS(i)).join(", ")}]`),id(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Ho(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Ho(i)).join(",")),`Target(${n})`}(di(e))}; limitType=${e.limitType})`}function ad(e,t){return t.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Re.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(e,t)&&function(n,i){for(const s of sc(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(e,t)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(e,t)&&function(n,i){return!(n.startAt&&!function(a,o,l){const c=Yy(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,sc(n),i)||n.endAt&&!function(a,o,l){const c=Yy(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,sc(n),i))}(e,t)}function rM(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function gS(e){return(t,r)=>{let n=!1;for(const i of sc(e)){const s=nM(i,t,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function nM(e,t,r){const n=e.field.isKeyField()?Re.comparator(t.key,r.key):function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?zo(l,c):Ne()}(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return Ne()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(t,r){this.mapKeyFn=t,this.equalsFn=r,this.inner={},this.innerSize=0}get(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,t))return s}}has(t){return this.get(t)!==void 0}set(t,r){const n=this.mapKeyFn(t),i=this.inner[n];if(i===void 0)return this.inner[n]=[[t,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,r]);i.push([t,r]),this.innerSize++}delete(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Ba(this.inner,(r,n)=>{for(const[i,s]of n)t(i,s)})}isEmpty(){return sS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iM=new Tt(Re.comparator);function zi(){return iM}const vS=new Tt(Re.comparator);function Bl(...e){let t=vS;for(const r of e)t=t.insert(r.key,r);return t}function _S(e){let t=vS;return e.forEach((r,n)=>t=t.insert(r,n.overlayedDocument)),t}function la(){return ac()}function xS(){return ac()}function ac(){return new cl(e=>e.toString(),(e,t)=>e.isEqual(t))}const sM=new Tt(Re.comparator),aM=new fr(Re.comparator);function je(...e){let t=aM;for(const r of e)t=t.add(r);return t}const oM=new fr(tt);function lM(){return oM}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yS(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qh(t)?"-0":t}}function ES(e){return{integerValue:""+e}}function cM(e,t){return U6(t)?ES(t):yS(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(){this._=void 0}}function uM(e,t,r){return e instanceof Qh?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&yv(s)&&(s=Ev(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,t):e instanceof tu?TS(e,t):e instanceof ru?kS(e,t):function(i,s){const a=wS(i,s),o=eE(a)+eE(i.Ie);return dg(a)&&dg(i.Ie)?ES(o):yS(i.serializer,o)}(e,t)}function fM(e,t,r){return e instanceof tu?TS(e,t):e instanceof ru?kS(e,t):r}function wS(e,t){return e instanceof Jh?function(n){return dg(n)||function(s){return!!s&&"doubleValue"in s}(n)}(t)?t:{integerValue:0}:null}class Qh extends od{}class tu extends od{constructor(t){super(),this.elements=t}}function TS(e,t){const r=AS(t);for(const n of e.elements)r.some(i=>vi(i,n))||r.push(n);return{arrayValue:{values:r}}}class ru extends od{constructor(t){super(),this.elements=t}}function kS(e,t){let r=AS(t);for(const n of e.elements)r=r.filter(i=>!vi(i,n));return{arrayValue:{values:r}}}class Jh extends od{constructor(t,r){super(),this.serializer=t,this.Ie=r}}function eE(e){return Mt(e.integerValue||e.doubleValue)}function AS(e){return wv(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function hM(e,t){return e.field.isEqual(t.field)&&function(n,i){return n instanceof tu&&i instanceof tu||n instanceof ru&&i instanceof ru?jo(n.elements,i.elements,vi):n instanceof Jh&&i instanceof Jh?vi(n.Ie,i.Ie):n instanceof Qh&&i instanceof Qh}(e.transform,t.transform)}class dM{constructor(t,r){this.version=t,this.transformResults=r}}class pi{constructor(t,r){this.updateTime=t,this.exists=r}static none(){return new pi}static exists(t){return new pi(void 0,t)}static updateTime(t){return new pi(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function th(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class ld{}function SS(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new CS(e.key,pi.none()):new Ou(e.key,e.data,pi.none());{const r=e.data,n=Jr.empty();let i=new fr(lr.comparator);for(let s of t.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new Ws(e.key,n,new hn(i.toArray()),pi.none())}}function pM(e,t,r){e instanceof Ou?function(i,s,a){const o=i.value.clone(),l=rE(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(e,t,r):e instanceof Ws?function(i,s,a){if(!th(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=rE(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(IS(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(e,t,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,t,r)}function oc(e,t,r,n){return e instanceof Ou?function(s,a,o,l){if(!th(s.precondition,a))return o;const c=s.value.clone(),u=nE(s.fieldTransforms,l,a);return c.setAll(u),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(e,t,r,n):e instanceof Ws?function(s,a,o,l){if(!th(s.precondition,a))return o;const c=nE(s.fieldTransforms,l,a),u=a.data;return u.setAll(IS(s)),u.setAll(c),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(e,t,r,n):function(s,a,o){return th(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(e,t,r)}function mM(e,t){let r=null;for(const n of e.fieldTransforms){const i=t.data.field(n.field),s=wS(n.transform,i||null);s!=null&&(r===null&&(r=Jr.empty()),r.set(n.field,s))}return r||null}function tE(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&jo(n,i,(s,a)=>hM(s,a))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Ou extends ld{constructor(t,r,n,i=[]){super(),this.key=t,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ws extends ld{constructor(t,r,n,i,s=[]){super(),this.key=t,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function IS(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=e.data.field(r);t.set(r,n)}}),t}function rE(e,t,r){const n=new Map;dt(e.length===r.length);for(let i=0;i<r.length;i++){const s=e[i],a=s.transform,o=t.data.field(s.field);n.set(s.field,fM(a,o,r[i]))}return n}function nE(e,t,r){const n=new Map;for(const i of e){const s=i.transform,a=r.data.field(i.field);n.set(i.field,uM(s,a,t))}return n}class CS extends ld{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class gM extends ld{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(t,r,n,i){this.batchId=t,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(t.key)&&pM(s,t,n[i])}}applyToLocalView(t,r){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(r=oc(n,t,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(r=oc(n,t,r,this.localWriteTime));return r}applyToLocalDocumentSet(t,r){const n=xS();return this.mutations.forEach(i=>{const s=t.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=SS(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Oe.min())}),n}keys(){return this.mutations.reduce((t,r)=>t.add(r.key),je())}isEqual(t){return this.batchId===t.batchId&&jo(this.mutations,t.mutations,(r,n)=>tE(r,n))&&jo(this.baseMutations,t.baseMutations,(r,n)=>tE(r,n))}}class Sv{constructor(t,r,n,i){this.batch=t,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(t,r,n){dt(t.mutations.length===n.length);let i=function(){return sM}();const s=t.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new Sv(t,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _M{constructor(t,r){this.largestBatchId=t,this.mutation=r}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(t,r){this.count=t,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dt,qe;function yM(e){switch(e){default:return Ne();case Z.CANCELLED:case Z.UNKNOWN:case Z.DEADLINE_EXCEEDED:case Z.RESOURCE_EXHAUSTED:case Z.INTERNAL:case Z.UNAVAILABLE:case Z.UNAUTHENTICATED:return!1;case Z.INVALID_ARGUMENT:case Z.NOT_FOUND:case Z.ALREADY_EXISTS:case Z.PERMISSION_DENIED:case Z.FAILED_PRECONDITION:case Z.ABORTED:case Z.OUT_OF_RANGE:case Z.UNIMPLEMENTED:case Z.DATA_LOSS:return!0}}function RS(e){if(e===void 0)return ji("GRPC error has no .code"),Z.UNKNOWN;switch(e){case Dt.OK:return Z.OK;case Dt.CANCELLED:return Z.CANCELLED;case Dt.UNKNOWN:return Z.UNKNOWN;case Dt.DEADLINE_EXCEEDED:return Z.DEADLINE_EXCEEDED;case Dt.RESOURCE_EXHAUSTED:return Z.RESOURCE_EXHAUSTED;case Dt.INTERNAL:return Z.INTERNAL;case Dt.UNAVAILABLE:return Z.UNAVAILABLE;case Dt.UNAUTHENTICATED:return Z.UNAUTHENTICATED;case Dt.INVALID_ARGUMENT:return Z.INVALID_ARGUMENT;case Dt.NOT_FOUND:return Z.NOT_FOUND;case Dt.ALREADY_EXISTS:return Z.ALREADY_EXISTS;case Dt.PERMISSION_DENIED:return Z.PERMISSION_DENIED;case Dt.FAILED_PRECONDITION:return Z.FAILED_PRECONDITION;case Dt.ABORTED:return Z.ABORTED;case Dt.OUT_OF_RANGE:return Z.OUT_OF_RANGE;case Dt.UNIMPLEMENTED:return Z.UNIMPLEMENTED;case Dt.DATA_LOSS:return Z.DATA_LOSS;default:return Ne()}}(qe=Dt||(Dt={}))[qe.OK=0]="OK",qe[qe.CANCELLED=1]="CANCELLED",qe[qe.UNKNOWN=2]="UNKNOWN",qe[qe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",qe[qe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",qe[qe.NOT_FOUND=5]="NOT_FOUND",qe[qe.ALREADY_EXISTS=6]="ALREADY_EXISTS",qe[qe.PERMISSION_DENIED=7]="PERMISSION_DENIED",qe[qe.UNAUTHENTICATED=16]="UNAUTHENTICATED",qe[qe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",qe[qe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",qe[qe.ABORTED=10]="ABORTED",qe[qe.OUT_OF_RANGE=11]="OUT_OF_RANGE",qe[qe.UNIMPLEMENTED=12]="UNIMPLEMENTED",qe[qe.INTERNAL=13]="INTERNAL",qe[qe.UNAVAILABLE=14]="UNAVAILABLE",qe[qe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EM(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wM=new Io([4294967295,4294967295],0);function iE(e){const t=EM().encode(e),r=new A6;return r.update(t),new Uint8Array(r.digest())}function sE(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Io([r,n],0),new Io([i,s],0)]}class Iv{constructor(t,r,n){if(this.bitmap=t,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Ul(`Invalid padding: ${r}`);if(n<0)throw new Ul(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new Ul(`Invalid hash count: ${n}`);if(t.length===0&&r!==0)throw new Ul(`Invalid padding when bitmap length is 0: ${r}`);this.Te=8*t.length-r,this.Ee=Io.fromNumber(this.Te)}de(t,r,n){let i=t.add(r.multiply(Io.fromNumber(n)));return i.compare(wM)===1&&(i=new Io([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Te===0)return!1;const r=iE(t),[n,i]=sE(r);for(let s=0;s<this.hashCount;s++){const a=this.de(n,i,s);if(!this.Ae(a))return!1}return!0}static create(t,r,n){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),a=new Iv(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(t){if(this.Te===0)return;const r=iE(t),[n,i]=sE(r);for(let s=0;s<this.hashCount;s++){const a=this.de(n,i,s);this.Re(a)}}Re(t){const r=Math.floor(t/8),n=t%8;this.bitmap[r]|=1<<n}}class Ul extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(t,r,n,i,s){this.snapshotVersion=t,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,r,n){const i=new Map;return i.set(t,Lu.createSynthesizedTargetChangeForCurrentChange(t,r,n)),new cd(Oe.min(),i,new Tt(tt),zi(),je())}}class Lu{constructor(t,r,n,i,s){this.resumeToken=t,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,r,n){return new Lu(n,r,je(),je(),je())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(t,r,n,i){this.Ve=t,this.removedTargetIds=r,this.key=n,this.me=i}}class PS{constructor(t,r){this.targetId=t,this.fe=r}}class FS{constructor(t,r,n=Nr.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=r,this.resumeToken=n,this.cause=i}}class aE{constructor(){this.ge=0,this.pe=lE(),this.ye=Nr.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=je(),r=je(),n=je();return this.pe.forEach((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Ne()}}),new Lu(this.ye,this.we,t,r,n)}Fe(){this.Se=!1,this.pe=lE()}Me(t,r){this.Se=!0,this.pe=this.pe.insert(t,r)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1}Be(){this.Se=!0,this.we=!0}}class TM{constructor(t){this.Le=t,this.ke=new Map,this.qe=zi(),this.Qe=oE(),this.Ke=new Tt(tt)}$e(t){for(const r of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(r,t.me):this.We(r,t.key,t.me);for(const r of t.removedTargetIds)this.We(r,t.key,t.me)}Ge(t){this.forEachTarget(t,r=>{const n=this.ze(r);switch(t.state){case 0:this.je(r)&&n.Ce(t.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(t.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(r);break;case 3:this.je(r)&&(n.Be(),n.Ce(t.resumeToken));break;case 4:this.je(r)&&(this.He(r),n.Ce(t.resumeToken));break;default:Ne()}})}forEachTarget(t,r){t.targetIds.length>0?t.targetIds.forEach(r):this.ke.forEach((n,i)=>{this.je(i)&&r(i)})}Je(t){const r=t.targetId,n=t.fe.count,i=this.Ye(r);if(i){const s=i.target;if(mg(s))if(n===0){const a=new Re(s.path);this.We(r,a,kr.newNoDocument(a,Oe.min()))}else dt(n===1);else{const a=this.Ze(r);if(a!==n){const o=this.Xe(t),l=o?this.et(o,t,a):1;if(l!==0){this.He(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(r,c)}}}}}Xe(t){const r=t.fe.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=Ia(n).toUint8Array()}catch(l){if(l instanceof aS)return $o("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Iv(a,i,s)}catch(l){return $o(l instanceof Ul?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Te===0?null:o}et(t,r,n){return r.fe.count===n-this.rt(t,r.targetId)?0:2}rt(t,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.nt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;t.mightContain(o)||(this.We(r,s,null),i++)}),i}it(t){const r=new Map;this.ke.forEach((s,a)=>{const o=this.Ye(a);if(o){if(s.current&&mg(o.target)){const l=new Re(o.target.path);this.qe.get(l)!==null||this.st(a,l)||this.We(a,l,kr.newNoDocument(l,t))}s.De&&(r.set(a,s.ve()),s.Fe())}});let n=je();this.Qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Ye(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.qe.forEach((s,a)=>a.setReadTime(t));const i=new cd(t,r,this.Ke,this.qe,n);return this.qe=zi(),this.Qe=oE(),this.Ke=new Tt(tt),i}Ue(t,r){if(!this.je(t))return;const n=this.st(t,r.key)?2:0;this.ze(t).Me(r.key,n),this.qe=this.qe.insert(r.key,r),this.Qe=this.Qe.insert(r.key,this.ot(r.key).add(t))}We(t,r,n){if(!this.je(t))return;const i=this.ze(t);this.st(t,r)?i.Me(r,1):i.xe(r),this.Qe=this.Qe.insert(r,this.ot(r).delete(t)),n&&(this.qe=this.qe.insert(r,n))}removeTarget(t){this.ke.delete(t)}Ze(t){const r=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+r.addedDocuments.size-r.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let r=this.ke.get(t);return r||(r=new aE,this.ke.set(t,r)),r}ot(t){let r=this.Qe.get(t);return r||(r=new fr(tt),this.Qe=this.Qe.insert(t,r)),r}je(t){const r=this.Ye(t)!==null;return r||Ie("WatchChangeAggregator","Detected inactive target",t),r}Ye(t){const r=this.ke.get(t);return r&&r.be?null:this.Le._t(t)}He(t){this.ke.set(t,new aE),this.Le.getRemoteKeysForTarget(t).forEach(r=>{this.We(t,r,null)})}st(t,r){return this.Le.getRemoteKeysForTarget(t).has(r)}}function oE(){return new Tt(Re.comparator)}function lE(){return new Tt(Re.comparator)}const kM=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),AM=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),SM=(()=>({and:"AND",or:"OR"}))();class IM{constructor(t,r){this.databaseId=t,this.useProto3Json=r}}function vg(e,t){return e.useProto3Json||id(t)?t:{value:t}}function Zh(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function NS(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function CM(e,t){return Zh(e,t.toTimestamp())}function mi(e){return dt(!!e),Oe.fromTimestamp(function(r){const n=Ls(r);return new Kt(n.seconds,n.nanos)}(e))}function Cv(e,t){return function(n){return new ft(["projects",n.projectId,"databases",n.database])}(e).child("documents").child(t).canonicalString()}function DS(e){const t=ft.fromString(e);return dt(bS(t)),t}function _g(e,t){return Cv(e.databaseId,t.path)}function xp(e,t){const r=DS(t);if(r.get(1)!==e.databaseId.projectId)throw new Te(Z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new Te(Z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new Re(OS(r))}function xg(e,t){return Cv(e.databaseId,t)}function RM(e){const t=DS(e);return t.length===4?ft.emptyPath():OS(t)}function yg(e){return new ft(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function OS(e){return dt(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function cE(e,t,r){return{name:_g(e,t),fields:r.value.mapValue.fields}}function PM(e,t){let r;if("targetChange"in t){t.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Ne()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(c,u){return c.useProto3Json?(dt(u===void 0||typeof u=="string"),Nr.fromBase64String(u||"")):(dt(u===void 0||u instanceof Uint8Array),Nr.fromUint8Array(u||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,o=a&&function(c){const u=c.code===void 0?Z.UNKNOWN:RS(c.code);return new Te(u,c.message||"")}(a);r=new FS(n,i,s,o||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const i=xp(e,n.document.name),s=mi(n.document.updateTime),a=n.document.createTime?mi(n.document.createTime):Oe.min(),o=new Jr({mapValue:{fields:n.document.fields}}),l=kr.newFoundDocument(i,s,a,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new rh(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const i=xp(e,n.document),s=n.readTime?mi(n.readTime):Oe.min(),a=kr.newNoDocument(i,s),o=n.removedTargetIds||[];r=new rh([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const i=xp(e,n.document),s=n.removedTargetIds||[];r=new rh([],s,i,null)}else{if(!("filter"in t))return Ne();{t.filter;const n=t.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new xM(i,s),o=n.targetId;r=new PS(o,a)}}return r}function FM(e,t){let r;if(t instanceof Ou)r={update:cE(e,t.key,t.value)};else if(t instanceof CS)r={delete:_g(e,t.key)};else if(t instanceof Ws)r={update:cE(e,t.key,t.data),updateMask:UM(t.fieldMask)};else{if(!(t instanceof gM))return Ne();r={verify:_g(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof Qh)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof tu)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof ru)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Jh)return{fieldPath:a.field.canonicalString(),increment:o.Ie};throw Ne()}(0,n))),t.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:CM(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ne()}(e,t.precondition)),r}function NM(e,t){return e&&e.length>0?(dt(t!==void 0),e.map(r=>function(i,s){let a=i.updateTime?mi(i.updateTime):mi(s);return a.isEqual(Oe.min())&&(a=mi(s)),new dM(a,i.transformResults||[])}(r,t))):[]}function DM(e,t){return{documents:[xg(e,t.path)]}}function OM(e,t){const r={structuredQuery:{}},n=t.path;t.collectionGroup!==null?(r.parent=xg(e,n),r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r.parent=xg(e,n.popLast()),r.structuredQuery.from=[{collectionId:n.lastSegment()}]);const i=function(l){if(l.length!==0)return MS(Yn.create(l,"and"))}(t.filters);i&&(r.structuredQuery.where=i);const s=function(l){if(l.length!==0)return l.map(c=>function(f){return{field:Ja(f.field),direction:bM(f.dir)}}(c))}(t.orderBy);s&&(r.structuredQuery.orderBy=s);const a=vg(e,t.limit);return a!==null&&(r.structuredQuery.limit=a),t.startAt&&(r.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(t.endAt)),r}function LM(e){let t=RM(e.parent);const r=e.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){dt(n===1);const u=r.from[0];u.allDescendants?i=u.collectionId:t=t.child(u.collectionId)}let s=[];r.where&&(s=function(f){const h=LS(f);return h instanceof Yn&&uS(h)?h.getFilters():[h]}(r.where));let a=[];r.orderBy&&(a=function(f){return f.map(h=>function(p){return new eu(Za(p.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(r.orderBy));let o=null;r.limit&&(o=function(f){let h;return h=typeof f=="object"?f.value:f,id(h)?null:h}(r.limit));let l=null;r.startAt&&(l=function(f){const h=!!f.before,d=f.values||[];return new Xh(d,h)}(r.startAt));let c=null;return r.endAt&&(c=function(f){const h=!f.before,d=f.values||[];return new Xh(d,h)}(r.endAt)),eM(t,i,a,s,o,"F",l,c)}function MM(e,t){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ne()}}(t.purpose);return r==null?null:{"goog-listen-tags":r}}function LS(e){return e.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Za(r.unaryFilter.field);return Vt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Za(r.unaryFilter.field);return Vt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Za(r.unaryFilter.field);return Vt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Za(r.unaryFilter.field);return Vt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Ne()}}(e):e.fieldFilter!==void 0?function(r){return Vt.create(Za(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ne()}}(r.fieldFilter.op),r.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(r){return Yn.create(r.compositeFilter.filters.map(n=>LS(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ne()}}(r.compositeFilter.op))}(e):Ne()}function bM(e){return kM[e]}function VM(e){return AM[e]}function BM(e){return SM[e]}function Ja(e){return{fieldPath:e.canonicalString()}}function Za(e){return lr.fromServerFormat(e.fieldPath)}function MS(e){return e instanceof Vt?function(r){if(r.op==="=="){if(Xy(r.value))return{unaryFilter:{field:Ja(r.field),op:"IS_NAN"}};if(qy(r.value))return{unaryFilter:{field:Ja(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Xy(r.value))return{unaryFilter:{field:Ja(r.field),op:"IS_NOT_NAN"}};if(qy(r.value))return{unaryFilter:{field:Ja(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ja(r.field),op:VM(r.op),value:r.value}}}(e):e instanceof Yn?function(r){const n=r.getFilters().map(i=>MS(i));return n.length===1?n[0]:{compositeFilter:{op:BM(r.op),filters:n}}}(e):Ne()}function UM(e){const t=[];return e.fields.forEach(r=>t.push(r.canonicalString())),{fieldPaths:t}}function bS(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(t,r,n,i,s=Oe.min(),a=Oe.min(),o=Nr.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(t){return new hs(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,r){return new hs(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new hs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new hs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $M{constructor(t){this.ut=t}}function jM(e){const t=LM({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Yh(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zM{constructor(){this.on=new HM}addToCollectionParentIndex(t,r){return this.on.add(r),ie.resolve()}getCollectionParents(t,r){return ie.resolve(this.on.getEntries(r))}addFieldIndex(t,r){return ie.resolve()}deleteFieldIndex(t,r){return ie.resolve()}deleteAllFieldIndexes(t){return ie.resolve()}createTargetIndexes(t,r){return ie.resolve()}getDocumentsMatchingTarget(t,r){return ie.resolve(null)}getIndexType(t,r){return ie.resolve(0)}getFieldIndexes(t,r){return ie.resolve([])}getNextCollectionGroupToUpdate(t){return ie.resolve(null)}getMinOffset(t,r){return ie.resolve(Os.min())}getMinOffsetFromCollectionGroup(t,r){return ie.resolve(Os.min())}updateCollectionGroup(t,r,n){return ie.resolve()}updateIndexEntries(t,r){return ie.resolve()}}class HM{constructor(){this.index={}}add(t){const r=t.lastSegment(),n=t.popLast(),i=this.index[r]||new fr(ft.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(t){const r=t.lastSegment(),n=t.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(t){return(this.index[t]||new fr(ft.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(t){this.xn=t}next(){return this.xn+=2,this.xn}static On(){return new Wo(0)}static Nn(){return new Wo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WM{constructor(){this.changes=new cl(t=>t.toString(),(t,r)=>t.isEqual(r)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,r){this.assertNotApplied(),this.changes.set(t,kr.newInvalidDocument(t).setReadTime(r))}getEntry(t,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ie.resolve(n):this.getFromCache(t,r)}getEntries(t,r){return this.getAllFromCache(t,r)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GM{constructor(t,r){this.overlayedDocument=t,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KM{constructor(t,r,n,i){this.remoteDocumentCache=t,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,r){let n=null;return this.documentOverlayCache.getOverlay(t,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(t,r))).next(i=>(n!==null&&oc(n.mutation,i,hn.empty(),Kt.now()),i))}getDocuments(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.getLocalViewOfDocuments(t,n,je()).next(()=>n))}getLocalViewOfDocuments(t,r,n=je()){const i=la();return this.populateOverlays(t,i,r).next(()=>this.computeViews(t,r,i,n).next(s=>{let a=Bl();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(t,r){const n=la();return this.populateOverlays(t,n,r).next(()=>this.computeViews(t,r,n,je()))}populateOverlays(t,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(t,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(t,r,n,i){let s=zi();const a=ac(),o=function(){return ac()}();return r.forEach((l,c)=>{const u=n.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof Ws)?s=s.insert(c.key,c):u!==void 0?(a.set(c.key,u.mutation.getFieldMask()),oc(u.mutation,c,u.mutation.getFieldMask(),Kt.now())):a.set(c.key,hn.empty())}),this.recalculateAndSaveOverlays(t,s).next(l=>(l.forEach((c,u)=>a.set(c,u)),r.forEach((c,u)=>{var f;return o.set(c,new GM(u,(f=a.get(c))!==null&&f!==void 0?f:null))}),o))}recalculateAndSaveOverlays(t,r){const n=ac();let i=new Tt((a,o)=>a-o),s=je();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||hn.empty();u=o.applyToLocalView(c,u),n.set(l,u);const f=(i.get(o.batchId)||je()).add(l);i=i.insert(o.batchId,f)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,f=xS();u.forEach(h=>{if(!s.has(h)){const d=SS(r.get(h),n.get(h));d!==null&&f.set(h,d),s=s.add(h)}}),a.push(this.documentOverlayCache.saveOverlays(t,c,f))}return ie.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.recalculateAndSaveOverlays(t,n))}getDocumentsMatchingQuery(t,r,n,i){return function(a){return Re.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(t,r.path):pS(r)?this.getDocumentsMatchingCollectionGroupQuery(t,r,n,i):this.getDocumentsMatchingCollectionQuery(t,r,n,i)}getNextDocuments(t,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,r,n.largestBatchId,i-s.size):ie.resolve(la());let o=-1,l=s;return a.next(c=>ie.forEach(c,(u,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),s.get(u)?ie.resolve():this.remoteDocumentCache.getEntry(t,u).next(h=>{l=l.insert(u,h)}))).next(()=>this.populateOverlays(t,c,s)).next(()=>this.computeViews(t,l,c,je())).next(u=>({batchId:o,changes:_S(u)})))})}getDocumentsMatchingDocumentQuery(t,r){return this.getDocument(t,new Re(r)).next(n=>{let i=Bl();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(t,r,n,i){const s=r.collectionGroup;let a=Bl();return this.indexManager.getCollectionParents(t,s).next(o=>ie.forEach(o,l=>{const c=function(f,h){return new ll(h,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(t,c,n,i).next(u=>{u.forEach((f,h)=>{a=a.insert(f,h)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(t,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(t,r,n,s,i))).next(a=>{s.forEach((l,c)=>{const u=c.getKey();a.get(u)===null&&(a=a.insert(u,kr.newInvalidDocument(u)))});let o=Bl();return a.forEach((l,c)=>{const u=s.get(l);u!==void 0&&oc(u.mutation,c,hn.empty(),Kt.now()),ad(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qM{constructor(t){this.serializer=t,this.ur=new Map,this.cr=new Map}getBundleMetadata(t,r){return ie.resolve(this.ur.get(r))}saveBundleMetadata(t,r){return this.ur.set(r.id,function(i){return{id:i.id,version:i.version,createTime:mi(i.createTime)}}(r)),ie.resolve()}getNamedQuery(t,r){return ie.resolve(this.cr.get(r))}saveNamedQuery(t,r){return this.cr.set(r.name,function(i){return{name:i.name,query:jM(i.bundledQuery),readTime:mi(i.readTime)}}(r)),ie.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XM{constructor(){this.overlays=new Tt(Re.comparator),this.lr=new Map}getOverlay(t,r){return ie.resolve(this.overlays.get(r))}getOverlays(t,r){const n=la();return ie.forEach(r,i=>this.getOverlay(t,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(t,r,n){return n.forEach((i,s)=>{this.lt(t,r,s)}),ie.resolve()}removeOverlaysForBatchId(t,r,n){const i=this.lr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(n)),ie.resolve()}getOverlaysForCollection(t,r,n){const i=la(),s=r.length+1,a=new Re(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return ie.resolve(i)}getOverlaysForCollectionGroup(t,r,n,i){let s=new Tt((c,u)=>c-u);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=s.get(c.largestBatchId);u===null&&(u=la(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=la(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=i)););return ie.resolve(o)}lt(t,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.lr.get(i.largestBatchId).delete(n.key);this.lr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new _M(r,n));let s=this.lr.get(r);s===void 0&&(s=je(),this.lr.set(r,s)),this.lr.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(){this.hr=new fr(Qt.Pr),this.Ir=new fr(Qt.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(t,r){const n=new Qt(t,r);this.hr=this.hr.add(n),this.Ir=this.Ir.add(n)}Er(t,r){t.forEach(n=>this.addReference(n,r))}removeReference(t,r){this.dr(new Qt(t,r))}Ar(t,r){t.forEach(n=>this.removeReference(n,r))}Rr(t){const r=new Re(new ft([])),n=new Qt(r,t),i=new Qt(r,t+1),s=[];return this.Ir.forEachInRange([n,i],a=>{this.dr(a),s.push(a.key)}),s}Vr(){this.hr.forEach(t=>this.dr(t))}dr(t){this.hr=this.hr.delete(t),this.Ir=this.Ir.delete(t)}mr(t){const r=new Re(new ft([])),n=new Qt(r,t),i=new Qt(r,t+1);let s=je();return this.Ir.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(t){const r=new Qt(t,0),n=this.hr.firstAfterOrEqual(r);return n!==null&&t.isEqual(n.key)}}class Qt{constructor(t,r){this.key=t,this.gr=r}static Pr(t,r){return Re.comparator(t.key,r.key)||tt(t.gr,r.gr)}static Tr(t,r){return tt(t.gr,r.gr)||Re.comparator(t.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(t,r){this.indexManager=t,this.referenceDelegate=r,this.mutationQueue=[],this.pr=1,this.yr=new fr(Qt.Pr)}checkEmpty(t){return ie.resolve(this.mutationQueue.length===0)}addMutationBatch(t,r,n,i){const s=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new vM(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.yr=this.yr.add(new Qt(o.key,s)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return ie.resolve(a)}lookupMutationBatch(t,r){return ie.resolve(this.wr(r))}getNextMutationBatchAfterBatchId(t,r){const n=r+1,i=this.Sr(n),s=i<0?0:i;return ie.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(t){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,r){const n=new Qt(r,0),i=new Qt(r,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([n,i],a=>{const o=this.wr(a.gr);s.push(o)}),ie.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,r){let n=new fr(tt);return r.forEach(i=>{const s=new Qt(i,0),a=new Qt(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,a],o=>{n=n.add(o.gr)})}),ie.resolve(this.br(n))}getAllMutationBatchesAffectingQuery(t,r){const n=r.path,i=n.length+1;let s=n;Re.isDocumentKey(s)||(s=s.child(""));const a=new Qt(new Re(s),0);let o=new fr(tt);return this.yr.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.gr)),!0)},a),ie.resolve(this.br(o))}br(t){const r=[];return t.forEach(n=>{const i=this.wr(n);i!==null&&r.push(i)}),r}removeMutationBatch(t,r){dt(this.Dr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.yr;return ie.forEach(r.mutations,i=>{const s=new Qt(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)}).next(()=>{this.yr=n})}Fn(t){}containsKey(t,r){const n=new Qt(r,0),i=this.yr.firstAfterOrEqual(n);return ie.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,ie.resolve()}Dr(t,r){return this.Sr(t)}Sr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}wr(t){const r=this.Sr(t);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(t){this.Cr=t,this.docs=function(){return new Tt(Re.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Cr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const r=this.docs.get(t);r&&(this.docs=this.docs.remove(t),this.size-=r.size)}getEntry(t,r){const n=this.docs.get(r);return ie.resolve(n?n.document.mutableCopy():kr.newInvalidDocument(r))}getEntries(t,r){let n=zi();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():kr.newInvalidDocument(i))}),ie.resolve(n)}getDocumentsMatchingQuery(t,r,n,i){let s=zi();const a=r.path,o=new Re(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||b6(M6(u),n)<=0||(i.has(u.key)||ad(r,u))&&(s=s.insert(u.key,u.mutableCopy()))}return ie.resolve(s)}getAllFromCollectionGroup(t,r,n,i){Ne()}vr(t,r){return ie.forEach(this.docs,n=>r(n))}newChangeBuffer(t){return new JM(this)}getSize(t){return ie.resolve(this.size)}}class JM extends WM{constructor(t){super(),this._r=t}applyChanges(t){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this._r.addEntry(t,i)):this._r.removeEntry(n)}),ie.waitFor(r)}getFromCache(t,r){return this._r.getEntry(t,r)}getAllFromCache(t,r){return this._r.getEntries(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(t){this.persistence=t,this.Fr=new cl(r=>Tv(r),kv),this.lastRemoteSnapshotVersion=Oe.min(),this.highestTargetId=0,this.Mr=0,this.Or=new Rv,this.targetCount=0,this.Nr=Wo.On()}forEachTarget(t,r){return this.Fr.forEach((n,i)=>r(i)),ie.resolve()}getLastRemoteSnapshotVersion(t){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return ie.resolve(this.Mr)}allocateTargetId(t){return this.highestTargetId=this.Nr.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(t,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Mr&&(this.Mr=r),ie.resolve()}kn(t){this.Fr.set(t.target,t);const r=t.targetId;r>this.highestTargetId&&(this.Nr=new Wo(r),this.highestTargetId=r),t.sequenceNumber>this.Mr&&(this.Mr=t.sequenceNumber)}addTargetData(t,r){return this.kn(r),this.targetCount+=1,ie.resolve()}updateTargetData(t,r){return this.kn(r),ie.resolve()}removeTargetData(t,r){return this.Fr.delete(r.target),this.Or.Rr(r.targetId),this.targetCount-=1,ie.resolve()}removeTargets(t,r,n){let i=0;const s=[];return this.Fr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Fr.delete(a),s.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)}),ie.waitFor(s).next(()=>i)}getTargetCount(t){return ie.resolve(this.targetCount)}getTargetData(t,r){const n=this.Fr.get(r)||null;return ie.resolve(n)}addMatchingKeys(t,r,n){return this.Or.Er(r,n),ie.resolve()}removeMatchingKeys(t,r,n){this.Or.Ar(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(t,a))}),ie.waitFor(s)}removeMatchingKeysForTargetId(t,r){return this.Or.Rr(r),ie.resolve()}getMatchingKeysForTargetId(t,r){const n=this.Or.mr(r);return ie.resolve(n)}containsKey(t,r){return ie.resolve(this.Or.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(t,r){this.Br={},this.overlays={},this.Lr=new xv(0),this.kr=!1,this.kr=!0,this.referenceDelegate=t(this),this.qr=new ZM(this),this.indexManager=new zM,this.remoteDocumentCache=function(i){return new QM(i)}(n=>this.referenceDelegate.Qr(n)),this.serializer=new $M(r),this.Kr=new qM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let r=this.overlays[t.toKey()];return r||(r=new XM,this.overlays[t.toKey()]=r),r}getMutationQueue(t,r){let n=this.Br[t.toKey()];return n||(n=new YM(r,this.referenceDelegate),this.Br[t.toKey()]=n),n}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(t,r,n){Ie("MemoryPersistence","Starting transaction:",t);const i=new tb(this.Lr.next());return this.referenceDelegate.$r(),n(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(t,r){return ie.or(Object.values(this.Br).map(n=>()=>n.containsKey(t,r)))}}class tb extends B6{constructor(t){super(),this.currentSequenceNumber=t}}class Pv{constructor(t){this.persistence=t,this.Gr=new Rv,this.zr=null}static jr(t){return new Pv(t)}get Hr(){if(this.zr)return this.zr;throw Ne()}addReference(t,r,n){return this.Gr.addReference(n,r),this.Hr.delete(n.toString()),ie.resolve()}removeReference(t,r,n){return this.Gr.removeReference(n,r),this.Hr.add(n.toString()),ie.resolve()}markPotentiallyOrphaned(t,r){return this.Hr.add(r.toString()),ie.resolve()}removeTarget(t,r){this.Gr.Rr(r.targetId).forEach(i=>this.Hr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,r.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>n.removeTargetData(t,r))}$r(){this.zr=new Set}Ur(t){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.Hr,n=>{const i=Re.fromPath(n);return this.Jr(t,i).next(s=>{s||r.removeEntry(i,Oe.min())})}).next(()=>(this.zr=null,r.apply(t)))}updateLimboDocument(t,r){return this.Jr(t,r).next(n=>{n?this.Hr.delete(r.toString()):this.Hr.add(r.toString())})}Qr(t){return 0}Jr(t,r){return ie.or([()=>ie.resolve(this.Gr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(t,r),()=>this.persistence.Wr(t,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(t,r,n,i){this.targetId=t,this.fromCache=r,this.ki=n,this.qi=i}static Qi(t,r){let n=je(),i=je();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Fv(t,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(t,r){this.Gi=t,this.indexManager=r,this.Ki=!0}getDocumentsMatchingQuery(t,r,n,i){const s={result:null};return this.zi(t,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ji(t,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new rb;return this.Hi(t,r,a).next(o=>{if(s.result=o,this.$i)return this.Ji(t,r,a,o.size)})}).next(()=>s.result)}Ji(t,r,n,i){return n.documentReadCount<this.Ui?(Cl()<=Ge.DEBUG&&Ie("QueryEngine","SDK will not create cache indexes for query:",Qa(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),ie.resolve()):(Cl()<=Ge.DEBUG&&Ie("QueryEngine","Query:",Qa(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Wi*i?(Cl()<=Ge.DEBUG&&Ie("QueryEngine","The SDK decides to create cache indexes for query:",Qa(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,di(r))):ie.resolve())}zi(t,r){if(Zy(r))return ie.resolve(null);let n=di(r);return this.indexManager.getIndexType(t,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Yh(r,null,"F"),n=di(r)),this.indexManager.getDocumentsMatchingTarget(t,n).next(s=>{const a=je(...s);return this.Gi.getDocuments(t,a).next(o=>this.indexManager.getMinOffset(t,n).next(l=>{const c=this.Yi(r,o);return this.Zi(r,c,a,l.readTime)?this.zi(t,Yh(r,null,"F")):this.Xi(t,c,r,l)}))})))}ji(t,r,n,i){return Zy(r)||i.isEqual(Oe.min())?ie.resolve(null):this.Gi.getDocuments(t,n).next(s=>{const a=this.Yi(r,s);return this.Zi(r,a,n,i)?ie.resolve(null):(Cl()<=Ge.DEBUG&&Ie("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Qa(r)),this.Xi(t,a,r,L6(i,-1)).next(o=>o))})}Yi(t,r){let n=new fr(gS(t));return r.forEach((i,s)=>{ad(t,s)&&(n=n.add(s))}),n}Zi(t,r,n,i){if(t.limit===null)return!1;if(n.size!==r.size)return!0;const s=t.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(t,r,n){return Cl()<=Ge.DEBUG&&Ie("QueryEngine","Using full collection scan to execute query:",Qa(r)),this.Gi.getDocumentsMatchingQuery(t,r,Os.min(),n)}Xi(t,r,n,i){return this.Gi.getDocumentsMatchingQuery(t,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(t,r,n,i){this.persistence=t,this.es=r,this.serializer=i,this.ts=new Tt(tt),this.ns=new cl(s=>Tv(s),kv),this.rs=new Map,this.ss=t.getRemoteDocumentCache(),this.qr=t.getTargetCache(),this.Kr=t.getBundleCache(),this.os(n)}os(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new KM(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>t.collect(r,this.ts))}}function sb(e,t,r,n){return new ib(e,t,r,n)}async function VS(e,t){const r=Ve(e);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.os(t),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=je();for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({_s:c,removedBatchIds:a,addedBatchIds:o}))})})}function ab(e,t){const r=Ve(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=t.batch.keys(),s=r.ss.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const f=c.batch,h=f.keys();let d=ie.resolve();return h.forEach(p=>{d=d.next(()=>u.getEntry(l,p)).next(m=>{const v=c.docVersions.get(p);dt(v!==null),m.version.compareTo(v)<0&&(f.applyToRemoteDocument(m,c),m.isValidDocument()&&(m.setReadTime(c.commitVersion),u.addEntry(m)))})}),d.next(()=>o.mutationQueue.removeMutationBatch(l,f))}(r,n,t,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=je();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(t))).next(()=>r.localDocuments.getDocuments(n,i))})}function BS(e){const t=Ve(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",r=>t.qr.getLastRemoteSnapshotVersion(r))}function ob(e,t){const r=Ve(e),n=t.snapshotVersion;let i=r.ts;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.ss.newChangeBuffer({trackRemovals:!0});i=r.ts;const o=[];t.targetChanges.forEach((u,f)=>{const h=i.get(f);if(!h)return;o.push(r.qr.removeMatchingKeys(s,u.removedDocuments,f).next(()=>r.qr.addMatchingKeys(s,u.addedDocuments,f)));let d=h.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(f)!==null?d=d.withResumeToken(Nr.EMPTY_BYTE_STRING,Oe.min()).withLastLimboFreeSnapshotVersion(Oe.min()):u.resumeToken.approximateByteSize()>0&&(d=d.withResumeToken(u.resumeToken,n)),i=i.insert(f,d),function(m,v,x){return m.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(h,d,u)&&o.push(r.qr.updateTargetData(s,d))});let l=zi(),c=je();if(t.documentUpdates.forEach(u=>{t.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,u))}),o.push(lb(s,a,t.documentUpdates).next(u=>{l=u.us,c=u.cs})),!n.isEqual(Oe.min())){const u=r.qr.getLastRemoteSnapshotVersion(s).next(f=>r.qr.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(u)}return ie.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.ts=i,s))}function lb(e,t,r){let n=je(),i=je();return r.forEach(s=>n=n.add(s)),t.getEntries(e,n).next(s=>{let a=zi();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Oe.min())?(t.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),a=a.insert(o,l)):Ie("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{us:a,cs:i}})}function cb(e,t){const r=Ve(e);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(t===void 0&&(t=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,t)))}function ub(e,t){const r=Ve(e);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.qr.getTargetData(n,t).next(s=>s?(i=s,ie.resolve(i)):r.qr.allocateTargetId(n).next(a=>(i=new hs(t,a,"TargetPurposeListen",n.currentSequenceNumber),r.qr.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.ts.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.ts=r.ts.insert(n.targetId,n),r.ns.set(t,n.targetId)),n})}async function Eg(e,t,r){const n=Ve(e),i=n.ts.get(t),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Du(a))throw a;Ie("LocalStore",`Failed to update sequence numbers for target ${t}: ${a}`)}n.ts=n.ts.remove(t),n.ns.delete(i.target)}function uE(e,t,r){const n=Ve(e);let i=Oe.min(),s=je();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,u){const f=Ve(l),h=f.ns.get(u);return h!==void 0?ie.resolve(f.ts.get(h)):f.qr.getTargetData(c,u)}(n,a,di(t)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.qr.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.es.getDocumentsMatchingQuery(a,t,r?i:Oe.min(),r?s:je())).next(o=>(fb(n,rM(t),o),{documents:o,ls:s})))}function fb(e,t,r){let n=e.rs.get(t)||Oe.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),e.rs.set(t,n)}class fE{constructor(){this.activeTargetIds=lM()}ds(t){this.activeTargetIds=this.activeTargetIds.add(t)}As(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Es(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class hb{constructor(){this.eo=new fE,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,r,n){}addLocalQueryTarget(t){return this.eo.ds(t),this.no[t]||"not-current"}updateQueryState(t,r,n){this.no[t]=r}removeLocalQueryTarget(t){this.eo.As(t)}isLocalQueryTarget(t){return this.eo.activeTargetIds.has(t)}clearQueryState(t){delete this.no[t]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(t){return this.eo.activeTargetIds.has(t)}start(){return this.eo=new fE,Promise.resolve()}handleUserChange(t,r,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class db{ro(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hE{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(t){this.ao.push(t)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){Ie("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ao)t(0)}_o(){Ie("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ao)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wf=null;function yp(){return wf===null?wf=function(){return 268435456+Math.round(2147483648*Math.random())}():wf++,"0x"+wf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb{constructor(t){this.co=t.co,this.lo=t.lo}ho(t){this.Po=t}Io(t){this.To=t}onMessage(t){this.Eo=t}close(){this.lo()}send(t){this.co(t)}Ao(){this.Po()}Ro(t){this.To(t)}Vo(t){this.Eo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _r="WebChannelConnection";class gb extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=n+"://"+r.host,this.fo=`projects/${i}/databases/${s}`,this.po=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(r,n,i,s,a){const o=yp(),l=this.So(r,n);Ie("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(c,s,a),this.Do(r,l,c,i).then(u=>(Ie("RestConnection",`Received RPC '${r}' ${o}: `,u),u),u=>{throw $o("RestConnection",`RPC '${r}' ${o} failed with error: `,u,"url: ",l,"request:",i),u})}Co(r,n,i,s,a,o){return this.wo(r,n,i,s,a)}bo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ol}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}So(r,n){const i=pb[r];return`${this.mo}/v1/${n}:${i}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Do(t,r,n,i){const s=yp();return new Promise((a,o)=>{const l=new k6;l.setWithCredentials(!0),l.listenOnce(E6.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case _p.NO_ERROR:const u=l.getResponseJson();Ie(_r,`XHR for RPC '${t}' ${s} received:`,JSON.stringify(u)),a(u);break;case _p.TIMEOUT:Ie(_r,`RPC '${t}' ${s} timed out`),o(new Te(Z.DEADLINE_EXCEEDED,"Request time out"));break;case _p.HTTP_ERROR:const f=l.getStatus();if(Ie(_r,`RPC '${t}' ${s} failed with status:`,f,"response text:",l.getResponseText()),f>0){let h=l.getResponseJson();Array.isArray(h)&&(h=h[0]);const d=h==null?void 0:h.error;if(d&&d.status&&d.message){const p=function(v){const x=v.toLowerCase().replace(/_/g,"-");return Object.values(Z).indexOf(x)>=0?x:Z.UNKNOWN}(d.status);o(new Te(p,d.message))}else o(new Te(Z.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new Te(Z.UNAVAILABLE,"Connection failed."));break;default:Ne()}}finally{Ie(_r,`RPC '${t}' ${s} completed.`)}});const c=JSON.stringify(i);Ie(_r,`RPC '${t}' ${s} sending request:`,i),l.send(r,"POST",c,n,15)})}vo(t,r,n){const i=yp(),s=[this.mo,"/","google.firestore.v1.Firestore","/",t,"/channel"],a=x6(),o=y6(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.xmlHttpFactory=new T6({})),this.bo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=s.join("");Ie(_r,`Creating RPC '${t}' stream ${i}: ${u}`,l);const f=a.createWebChannel(u,l);let h=!1,d=!1;const p=new mb({co:v=>{d?Ie(_r,`Not sending because RPC '${t}' stream ${i} is closed:`,v):(h||(Ie(_r,`Opening RPC '${t}' stream ${i} transport.`),f.open(),h=!0),Ie(_r,`RPC '${t}' stream ${i} sending:`,v),f.send(v))},lo:()=>f.close()}),m=(v,x,_)=>{v.listen(x,g=>{try{_(g)}catch(w){setTimeout(()=>{throw w},0)}})};return m(f,xf.EventType.OPEN,()=>{d||Ie(_r,`RPC '${t}' stream ${i} transport opened.`)}),m(f,xf.EventType.CLOSE,()=>{d||(d=!0,Ie(_r,`RPC '${t}' stream ${i} transport closed`),p.Ro())}),m(f,xf.EventType.ERROR,v=>{d||(d=!0,$o(_r,`RPC '${t}' stream ${i} transport errored:`,v),p.Ro(new Te(Z.UNAVAILABLE,"The operation could not be completed")))}),m(f,xf.EventType.MESSAGE,v=>{var x;if(!d){const _=v.data[0];dt(!!_);const g=_,w=g.error||((x=g[0])===null||x===void 0?void 0:x.error);if(w){Ie(_r,`RPC '${t}' stream ${i} received error:`,w);const T=w.status;let k=function(O){const U=Dt[O];if(U!==void 0)return RS(U)}(T),y=w.message;k===void 0&&(k=Z.INTERNAL,y="Unknown error status: "+T+" with message "+w.message),d=!0,p.Ro(new Te(k,y)),f.close()}else Ie(_r,`RPC '${t}' stream ${i} received:`,_),p.Vo(_)}}),m(o,w6.STAT_EVENT,v=>{v.stat===jy.PROXY?Ie(_r,`RPC '${t}' stream ${i} detected buffering proxy`):v.stat===jy.NOPROXY&&Ie(_r,`RPC '${t}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.Ao()},0),p}}function Ep(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ud(e){return new IM(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(t,r,n=1e3,i=1.5,s=6e4){this.si=t,this.timerId=r,this.Fo=n,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(t){this.cancel();const r=Math.floor(this.Oo+this.qo()),n=Math.max(0,Date.now()-this.Bo),i=Math.max(0,r-n);i>0&&Ie("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),t())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){this.No!==null&&(this.No.skipDelay(),this.No=null)}cancel(){this.No!==null&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{constructor(t,r,n,i,s,a,o,l){this.si=t,this.Ko=n,this.$o=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new US(t,r)}jo(){return this.state===1||this.state===5||this.Ho()}Ho(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&this.Wo===null&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(t){this.t_(),this.stream.send(t)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(t,r){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,t!==4?this.zo.reset():r&&r.code===Z.RESOURCE_EXHAUSTED?(ji(r.toString()),ji("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):r&&r.code===Z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.r_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Io(r)}r_(){}auth(){this.state=1;const t=this.i_(this.Uo),r=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Uo===r&&this.s_(n,i)},n=>{t(()=>{const i=new Te(Z.UNKNOWN,"Fetching auth token failed: "+n.message);return this.o_(i)})})}s_(t,r){const n=this.i_(this.Uo);this.stream=this.__(t,r),this.stream.ho(()=>{n(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{n(()=>this.o_(i))}),this.stream.onMessage(i=>{n(()=>this.onMessage(i))})}Jo(){this.state=5,this.zo.ko(async()=>{this.state=0,this.start()})}o_(t){return Ie("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}i_(t){return r=>{this.si.enqueueAndForget(()=>this.Uo===t?r():(Ie("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class vb extends $S{constructor(t,r,n,i,s,a){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}__(t,r){return this.connection.vo("Listen",t,r)}onMessage(t){this.zo.reset();const r=PM(this.serializer,t),n=function(s){if(!("targetChange"in s))return Oe.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Oe.min():a.readTime?mi(a.readTime):Oe.min()}(t);return this.listener.a_(r,n)}u_(t){const r={};r.database=yg(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=mg(l)?{documents:DM(s,l)}:{query:OM(s,l)},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=NS(s,a.resumeToken);const c=vg(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Oe.min())>0){o.readTime=Zh(s,a.snapshotVersion.toTimestamp());const c=vg(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,t);const n=MM(this.serializer,t);n&&(r.labels=n),this.e_(r)}c_(t){const r={};r.database=yg(this.serializer),r.removeTarget=t,this.e_(r)}}class _b extends $S{constructor(t,r,n,i,s,a){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(t,r){return this.connection.vo("Write",t,r)}onMessage(t){if(dt(!!t.streamToken),this.lastStreamToken=t.streamToken,this.l_){this.zo.reset();const r=NM(t.writeResults,t.commitTime),n=mi(t.commitTime);return this.listener.I_(n,r)}return dt(!t.writeResults||t.writeResults.length===0),this.l_=!0,this.listener.T_()}E_(){const t={};t.database=yg(this.serializer),this.e_(t)}P_(t){const r={streamToken:this.lastStreamToken,writes:t.map(n=>FM(this.serializer,n))};this.e_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb extends class{}{constructor(t,r,n,i){super(),this.authCredentials=t,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new Te(Z.FAILED_PRECONDITION,"The client has already been terminated.")}wo(t,r,n){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(t,r,n,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Te(Z.UNKNOWN,i.toString())})}Co(t,r,n,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Co(t,r,n,s,a,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Te(Z.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class yb{constructor(t,r){this.asyncQueue=t,this.onlineStateHandler=r,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){this.V_===0&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(t){this.state==="Online"?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.p_("Offline")))}set(t){this.S_(),this.V_=0,t==="Online"&&(this.f_=!1),this.p_(t)}p_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}y_(t){const r=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(ji(r),this.f_=!1):Ie("OnlineStateTracker",r)}S_(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eb{constructor(t,r,n,i,s){this.localStore=t,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{n.enqueueAndForget(async()=>{Ua(this)&&(Ie("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=Ve(l);c.C_.add(4),await Mu(c),c.M_.set("Unknown"),c.C_.delete(4),await fd(c)}(this))})}),this.M_=new yb(n,i)}}async function fd(e){if(Ua(e))for(const t of e.v_)await t(!0)}async function Mu(e){for(const t of e.v_)await t(!1)}function jS(e,t){const r=Ve(e);r.D_.has(t.targetId)||(r.D_.set(t.targetId,t),Ov(r)?Dv(r):ul(r).Ho()&&Nv(r,t))}function zS(e,t){const r=Ve(e),n=ul(r);r.D_.delete(t),n.Ho()&&HS(r,t),r.D_.size===0&&(n.Ho()?n.Zo():Ua(r)&&r.M_.set("Unknown"))}function Nv(e,t){if(e.x_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Oe.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}ul(e).u_(t)}function HS(e,t){e.x_.Oe(t),ul(e).c_(t)}function Dv(e){e.x_=new TM({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>e.D_.get(t)||null,nt:()=>e.datastore.serializer.databaseId}),ul(e).start(),e.M_.g_()}function Ov(e){return Ua(e)&&!ul(e).jo()&&e.D_.size>0}function Ua(e){return Ve(e).C_.size===0}function WS(e){e.x_=void 0}async function wb(e){e.D_.forEach((t,r)=>{Nv(e,t)})}async function Tb(e,t){WS(e),Ov(e)?(e.M_.w_(t),Dv(e)):e.M_.set("Unknown")}async function kb(e,t,r){if(e.M_.set("Online"),t instanceof FS&&t.state===2&&t.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.D_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.D_.delete(o),i.x_.removeTarget(o))}(e,t)}catch(n){Ie("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await e0(e,n)}else if(t instanceof rh?e.x_.$e(t):t instanceof PS?e.x_.Je(t):e.x_.Ge(t),!r.isEqual(Oe.min()))try{const n=await BS(e.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.x_.it(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=s.D_.get(c);u&&s.D_.set(c,u.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const u=s.D_.get(l);if(!u)return;s.D_.set(l,u.withResumeToken(Nr.EMPTY_BYTE_STRING,u.snapshotVersion)),HS(s,l);const f=new hs(u.target,l,c,u.sequenceNumber);Nv(s,f)}),s.remoteSyncer.applyRemoteEvent(o)}(e,r)}catch(n){Ie("RemoteStore","Failed to raise snapshot:",n),await e0(e,n)}}async function e0(e,t,r){if(!Du(t))throw t;e.C_.add(1),await Mu(e),e.M_.set("Offline"),r||(r=()=>BS(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Ie("RemoteStore","Retrying IndexedDB access"),await r(),e.C_.delete(1),await fd(e)})}function GS(e,t){return t().catch(r=>e0(e,r,t))}async function hd(e){const t=Ve(e),r=Ms(t);let n=t.b_.length>0?t.b_[t.b_.length-1].batchId:-1;for(;Ab(t);)try{const i=await cb(t.localStore,n);if(i===null){t.b_.length===0&&r.Zo();break}n=i.batchId,Sb(t,i)}catch(i){await e0(t,i)}KS(t)&&qS(t)}function Ab(e){return Ua(e)&&e.b_.length<10}function Sb(e,t){e.b_.push(t);const r=Ms(e);r.Ho()&&r.h_&&r.P_(t.mutations)}function KS(e){return Ua(e)&&!Ms(e).jo()&&e.b_.length>0}function qS(e){Ms(e).start()}async function Ib(e){Ms(e).E_()}async function Cb(e){const t=Ms(e);for(const r of e.b_)t.P_(r.mutations)}async function Rb(e,t,r){const n=e.b_.shift(),i=Sv.from(n,t,r);await GS(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await hd(e)}async function Pb(e,t){t&&Ms(e).h_&&await async function(n,i){if(function(a){return yM(a)&&a!==Z.ABORTED}(i.code)){const s=n.b_.shift();Ms(n).Yo(),await GS(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await hd(n)}}(e,t),KS(e)&&qS(e)}async function dE(e,t){const r=Ve(e);r.asyncQueue.verifyOperationInProgress(),Ie("RemoteStore","RemoteStore received new credentials");const n=Ua(r);r.C_.add(3),await Mu(r),n&&r.M_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.C_.delete(3),await fd(r)}async function Fb(e,t){const r=Ve(e);t?(r.C_.delete(2),await fd(r)):t||(r.C_.add(2),await Mu(r),r.M_.set("Unknown"))}function ul(e){return e.O_||(e.O_=function(r,n,i){const s=Ve(r);return s.A_(),new vb(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{ho:wb.bind(null,e),Io:Tb.bind(null,e),a_:kb.bind(null,e)}),e.v_.push(async t=>{t?(e.O_.Yo(),Ov(e)?Dv(e):e.M_.set("Unknown")):(await e.O_.stop(),WS(e))})),e.O_}function Ms(e){return e.N_||(e.N_=function(r,n,i){const s=Ve(r);return s.A_(),new _b(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(e.datastore,e.asyncQueue,{ho:Ib.bind(null,e),Io:Pb.bind(null,e),T_:Cb.bind(null,e),I_:Rb.bind(null,e)}),e.v_.push(async t=>{t?(e.N_.Yo(),await hd(e)):(await e.N_.stop(),e.b_.length>0&&(Ie("RemoteStore",`Stopping write stream with ${e.b_.length} pending writes`),e.b_=[]))})),e.N_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lv{constructor(t,r,n,i,s){this.asyncQueue=t,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Di,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,r,n,i,s){const a=Date.now()+n,o=new Lv(t,r,a,i,s);return o.start(n),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Te(Z.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Mv(e,t){if(ji("AsyncQueue",`${t}: ${e}`),Du(e))return new Te(Z.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(t){this.comparator=t?(r,n)=>t(r,n)||Re.comparator(r.key,n.key):(r,n)=>Re.comparator(r.key,n.key),this.keyedMap=Bl(),this.sortedSet=new Tt(this.comparator)}static emptySet(t){return new Co(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const r=this.keyedMap.get(t);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((r,n)=>(t(r),!1))}add(t){const r=this.delete(t.key);return r.copy(r.keyedMap.insert(t.key,t),r.sortedSet.insert(t,null))}delete(t){const r=this.get(t);return r?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(r)):this}isEqual(t){if(!(t instanceof Co)||this.size!==t.size)return!1;const r=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(r=>{t.push(r.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,r){const n=new Co;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{constructor(){this.B_=new Tt(Re.comparator)}track(t){const r=t.doc.key,n=this.B_.get(r);n?t.type!==0&&n.type===3?this.B_=this.B_.insert(r,t):t.type===3&&n.type!==1?this.B_=this.B_.insert(r,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.B_=this.B_.insert(r,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.B_=this.B_.insert(r,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.B_=this.B_.remove(r):t.type===1&&n.type===2?this.B_=this.B_.insert(r,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.B_=this.B_.insert(r,{type:2,doc:t.doc}):Ne():this.B_=this.B_.insert(r,t)}L_(){const t=[];return this.B_.inorderTraversal((r,n)=>{t.push(n)}),t}}class Go{constructor(t,r,n,i,s,a,o,l,c){this.query=t,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Go(t,r,Co.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&sd(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const r=this.docChanges,n=t.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(){this.k_=void 0,this.listeners=[]}}class Db{constructor(){this.queries=new cl(t=>mS(t),sd),this.onlineState="Unknown",this.q_=new Set}}async function XS(e,t){const r=Ve(e),n=t.query;let i=!1,s=r.queries.get(n);if(s||(i=!0,s=new Nb),i)try{s.k_=await r.onListen(n)}catch(a){const o=Mv(a,`Initialization of query '${Qa(t.query)}' failed`);return void t.onError(o)}r.queries.set(n,s),s.listeners.push(t),t.Q_(r.onlineState),s.k_&&t.K_(s.k_)&&bv(r)}async function YS(e,t){const r=Ve(e),n=t.query;let i=!1;const s=r.queries.get(n);if(s){const a=s.listeners.indexOf(t);a>=0&&(s.listeners.splice(a,1),i=s.listeners.length===0)}if(i)return r.queries.delete(n),r.onUnlisten(n)}function Ob(e,t){const r=Ve(e);let n=!1;for(const i of t){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.listeners)o.K_(i)&&(n=!0);a.k_=i}}n&&bv(r)}function Lb(e,t,r){const n=Ve(e),i=n.queries.get(t);if(i)for(const s of i.listeners)s.onError(r);n.queries.delete(t)}function bv(e){e.q_.forEach(t=>{t.next()})}class QS{constructor(t,r,n){this.query=t,this.U_=r,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=n||{}}K_(t){if(!this.options.includeMetadataChanges){const n=[];for(const i of t.docChanges)i.type!==3&&n.push(i);t=new Go(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let r=!1;return this.W_?this.z_(t)&&(this.U_.next(t),r=!0):this.j_(t,this.onlineState)&&(this.H_(t),r=!0),this.G_=t,r}onError(t){this.U_.error(t)}Q_(t){this.onlineState=t;let r=!1;return this.G_&&!this.W_&&this.j_(this.G_,t)&&(this.H_(this.G_),r=!0),r}j_(t,r){if(!t.fromCache)return!0;const n=r!=="Offline";return(!this.options.J_||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||r==="Offline")}z_(t){if(t.docChanges.length>0)return!0;const r=this.G_&&this.G_.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}H_(t){t=Go.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.W_=!0,this.U_.next(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(t){this.key=t}}class ZS{constructor(t){this.key=t}}class Mb{constructor(t,r){this.query=t,this.ia=r,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=je(),this.mutatedKeys=je(),this._a=gS(t),this.aa=new Co(this._a)}get ua(){return this.ia}ca(t,r){const n=r?r.la:new pE,i=r?r.aa:this.aa;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((u,f)=>{const h=i.get(u),d=ad(this.query,f)?f:null,p=!!h&&this.mutatedKeys.has(h.key),m=!!d&&(d.hasLocalMutations||this.mutatedKeys.has(d.key)&&d.hasCommittedMutations);let v=!1;h&&d?h.data.isEqual(d.data)?p!==m&&(n.track({type:3,doc:d}),v=!0):this.ha(h,d)||(n.track({type:2,doc:d}),v=!0,(l&&this._a(d,l)>0||c&&this._a(d,c)<0)&&(o=!0)):!h&&d?(n.track({type:0,doc:d}),v=!0):h&&!d&&(n.track({type:1,doc:h}),v=!0,(l||c)&&(o=!0)),v&&(d?(a=a.add(d),s=m?s.add(u):s.delete(u)):(a=a.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),s=s.delete(u.key),n.track({type:1,doc:u})}return{aa:a,la:n,Zi:o,mutatedKeys:s}}ha(t,r){return t.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(t,r,n){const i=this.aa;this.aa=t.aa,this.mutatedKeys=t.mutatedKeys;const s=t.la.L_();s.sort((c,u)=>function(h,d){const p=m=>{switch(m){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ne()}};return p(h)-p(d)}(c.type,u.type)||this._a(c.doc,u.doc)),this.Pa(n);const a=r?this.Ia():[],o=this.oa.size===0&&this.current?1:0,l=o!==this.sa;return this.sa=o,s.length!==0||l?{snapshot:new Go(this.query,t.aa,i,s,t.mutatedKeys,o===0,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ta:a}:{Ta:a}}Q_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({aa:this.aa,la:new pE,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(t){return!this.ia.has(t)&&!!this.aa.has(t)&&!this.aa.get(t).hasLocalMutations}Pa(t){t&&(t.addedDocuments.forEach(r=>this.ia=this.ia.add(r)),t.modifiedDocuments.forEach(r=>{}),t.removedDocuments.forEach(r=>this.ia=this.ia.delete(r)),this.current=t.current)}Ia(){if(!this.current)return[];const t=this.oa;this.oa=je(),this.aa.forEach(n=>{this.Ea(n.key)&&(this.oa=this.oa.add(n.key))});const r=[];return t.forEach(n=>{this.oa.has(n)||r.push(new ZS(n))}),this.oa.forEach(n=>{t.has(n)||r.push(new JS(n))}),r}da(t){this.ia=t.ls,this.oa=je();const r=this.ca(t.documents);return this.applyChanges(r,!0)}Aa(){return Go.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,this.sa===0,this.hasCachedResults)}}class bb{constructor(t,r,n){this.query=t,this.targetId=r,this.view=n}}class Vb{constructor(t){this.key=t,this.Ra=!1}}class Bb{constructor(t,r,n,i,s,a){this.localStore=t,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Va={},this.ma=new cl(o=>mS(o),sd),this.fa=new Map,this.ga=new Set,this.pa=new Tt(Re.comparator),this.ya=new Map,this.wa=new Rv,this.Sa={},this.ba=new Map,this.Da=Wo.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return this.Ca===!0}}async function Ub(e,t){const r=Yb(e);let n,i;const s=r.ma.get(t);if(s)n=s.targetId,r.sharedClientState.addLocalQueryTarget(n),i=s.view.Aa();else{const a=await ub(r.localStore,di(t)),o=r.sharedClientState.addLocalQueryTarget(a.targetId);n=a.targetId,i=await $b(r,t,n,o==="current",a.resumeToken),r.isPrimaryClient&&jS(r.remoteStore,a)}return i}async function $b(e,t,r,n,i){e.va=(f,h,d)=>async function(m,v,x,_){let g=v.view.ca(x);g.Zi&&(g=await uE(m.localStore,v.query,!1).then(({documents:k})=>v.view.ca(k,g)));const w=_&&_.targetChanges.get(v.targetId),T=v.view.applyChanges(g,m.isPrimaryClient,w);return gE(m,v.targetId,T.Ta),T.snapshot}(e,f,h,d);const s=await uE(e.localStore,t,!0),a=new Mb(t,s.ls),o=a.ca(s.documents),l=Lu.createSynthesizedTargetChangeForCurrentChange(r,n&&e.onlineState!=="Offline",i),c=a.applyChanges(o,e.isPrimaryClient,l);gE(e,r,c.Ta);const u=new bb(t,r,a);return e.ma.set(t,u),e.fa.has(r)?e.fa.get(r).push(t):e.fa.set(r,[t]),c.snapshot}async function jb(e,t){const r=Ve(e),n=r.ma.get(t),i=r.fa.get(n.targetId);if(i.length>1)return r.fa.set(n.targetId,i.filter(s=>!sd(s,t))),void r.ma.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(n.targetId),r.sharedClientState.isActiveQueryTarget(n.targetId)||await Eg(r.localStore,n.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(n.targetId),zS(r.remoteStore,n.targetId),wg(r,n.targetId)}).catch(Nu)):(wg(r,n.targetId),await Eg(r.localStore,n.targetId,!0))}async function zb(e,t,r){const n=Qb(e);try{const i=await function(a,o){const l=Ve(a),c=Kt.now(),u=o.reduce((d,p)=>d.add(p.key),je());let f,h;return l.persistence.runTransaction("Locally write mutations","readwrite",d=>{let p=zi(),m=je();return l.ss.getEntries(d,u).next(v=>{p=v,p.forEach((x,_)=>{_.isValidDocument()||(m=m.add(x))})}).next(()=>l.localDocuments.getOverlayedDocuments(d,p)).next(v=>{f=v;const x=[];for(const _ of o){const g=mM(_,f.get(_.key).overlayedDocument);g!=null&&x.push(new Ws(_.key,g,oS(g.value.mapValue),pi.exists(!0)))}return l.mutationQueue.addMutationBatch(d,c,x,o)}).next(v=>{h=v;const x=v.applyToLocalDocumentSet(f,m);return l.documentOverlayCache.saveOverlays(d,v.batchId,x)})}).then(()=>({batchId:h.batchId,changes:_S(f)}))}(n.localStore,t);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let c=a.Sa[a.currentUser.toKey()];c||(c=new Tt(tt)),c=c.insert(o,l),a.Sa[a.currentUser.toKey()]=c}(n,i.batchId,r),await bu(n,i.changes),await hd(n.remoteStore)}catch(i){const s=Mv(i,"Failed to persist write");r.reject(s)}}async function eI(e,t){const r=Ve(e);try{const n=await ob(r.localStore,t);t.targetChanges.forEach((i,s)=>{const a=r.ya.get(s);a&&(dt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.Ra=!0:i.modifiedDocuments.size>0?dt(a.Ra):i.removedDocuments.size>0&&(dt(a.Ra),a.Ra=!1))}),await bu(r,n,t)}catch(n){await Nu(n)}}function mE(e,t,r){const n=Ve(e);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.ma.forEach((s,a)=>{const o=a.view.Q_(t);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=Ve(a);l.onlineState=o;let c=!1;l.queries.forEach((u,f)=>{for(const h of f.listeners)h.Q_(o)&&(c=!0)}),c&&bv(l)}(n.eventManager,t),i.length&&n.Va.a_(i),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function Hb(e,t,r){const n=Ve(e);n.sharedClientState.updateQueryState(t,"rejected",r);const i=n.ya.get(t),s=i&&i.key;if(s){let a=new Tt(Re.comparator);a=a.insert(s,kr.newNoDocument(s,Oe.min()));const o=je().add(s),l=new cd(Oe.min(),new Map,new Tt(tt),a,o);await eI(n,l),n.pa=n.pa.remove(s),n.ya.delete(t),Vv(n)}else await Eg(n.localStore,t,!1).then(()=>wg(n,t,r)).catch(Nu)}async function Wb(e,t){const r=Ve(e),n=t.batch.batchId;try{const i=await ab(r.localStore,t);rI(r,n,null),tI(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await bu(r,i)}catch(i){await Nu(i)}}async function Gb(e,t,r){const n=Ve(e);try{const i=await function(a,o){const l=Ve(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(f=>(dt(f!==null),u=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,t);rI(n,t,r),tI(n,t),n.sharedClientState.updateMutationState(t,"rejected",r),await bu(n,i)}catch(i){await Nu(i)}}function tI(e,t){(e.ba.get(t)||[]).forEach(r=>{r.resolve()}),e.ba.delete(t)}function rI(e,t,r){const n=Ve(e);let i=n.Sa[n.currentUser.toKey()];if(i){const s=i.get(t);s&&(r?s.reject(r):s.resolve(),i=i.remove(t)),n.Sa[n.currentUser.toKey()]=i}}function wg(e,t,r=null){e.sharedClientState.removeLocalQueryTarget(t);for(const n of e.fa.get(t))e.ma.delete(n),r&&e.Va.Fa(n,r);e.fa.delete(t),e.isPrimaryClient&&e.wa.Rr(t).forEach(n=>{e.wa.containsKey(n)||nI(e,n)})}function nI(e,t){e.ga.delete(t.path.canonicalString());const r=e.pa.get(t);r!==null&&(zS(e.remoteStore,r),e.pa=e.pa.remove(t),e.ya.delete(r),Vv(e))}function gE(e,t,r){for(const n of r)n instanceof JS?(e.wa.addReference(n.key,t),Kb(e,n)):n instanceof ZS?(Ie("SyncEngine","Document no longer in limbo: "+n.key),e.wa.removeReference(n.key,t),e.wa.containsKey(n.key)||nI(e,n.key)):Ne()}function Kb(e,t){const r=t.key,n=r.path.canonicalString();e.pa.get(r)||e.ga.has(n)||(Ie("SyncEngine","New document in limbo: "+r),e.ga.add(n),Vv(e))}function Vv(e){for(;e.ga.size>0&&e.pa.size<e.maxConcurrentLimboResolutions;){const t=e.ga.values().next().value;e.ga.delete(t);const r=new Re(ft.fromString(t)),n=e.Da.next();e.ya.set(n,new Vb(r)),e.pa=e.pa.insert(r,n),jS(e.remoteStore,new hs(di(Av(r.path)),n,"TargetPurposeLimboResolution",xv._e))}}async function bu(e,t,r){const n=Ve(e),i=[],s=[],a=[];n.ma.isEmpty()||(n.ma.forEach((o,l)=>{a.push(n.va(l,t,r).then(c=>{if((c||r)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(l.targetId,c!=null&&c.fromCache?"not-current":"current"),c){i.push(c);const u=Fv.Qi(l.targetId,c);s.push(u)}}))}),await Promise.all(a),n.Va.a_(i),await async function(l,c){const u=Ve(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>ie.forEach(c,h=>ie.forEach(h.ki,d=>u.persistence.referenceDelegate.addReference(f,h.targetId,d)).next(()=>ie.forEach(h.qi,d=>u.persistence.referenceDelegate.removeReference(f,h.targetId,d)))))}catch(f){if(!Du(f))throw f;Ie("LocalStore","Failed to update sequence numbers: "+f)}for(const f of c){const h=f.targetId;if(!f.fromCache){const d=u.ts.get(h),p=d.snapshotVersion,m=d.withLastLimboFreeSnapshotVersion(p);u.ts=u.ts.insert(h,m)}}}(n.localStore,s))}async function qb(e,t){const r=Ve(e);if(!r.currentUser.isEqual(t)){Ie("SyncEngine","User change. New user:",t.toKey());const n=await VS(r.localStore,t);r.currentUser=t,function(s,a){s.ba.forEach(o=>{o.forEach(l=>{l.reject(new Te(Z.CANCELLED,a))})}),s.ba.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await bu(r,n._s)}}function Xb(e,t){const r=Ve(e),n=r.ya.get(t);if(n&&n.Ra)return je().add(n.key);{let i=je();const s=r.fa.get(t);if(!s)return i;for(const a of s){const o=r.ma.get(a);i=i.unionWith(o.view.ua)}return i}}function Yb(e){const t=Ve(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=eI.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Xb.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Hb.bind(null,t),t.Va.a_=Ob.bind(null,t.eventManager),t.Va.Fa=Lb.bind(null,t.eventManager),t}function Qb(e){const t=Ve(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Wb.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Gb.bind(null,t),t}class vE{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=ud(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,r){return null}createIndexBackfillerScheduler(t,r){return null}createLocalStore(t){return sb(this.persistence,new nb,t.initialUser,this.serializer)}createPersistence(t){return new eb(Pv.jr,this.serializer)}createSharedClientState(t){return new hb}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Jb{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>mE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=qb.bind(null,this.syncEngine),await Fb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new Db}()}createDatastore(t){const r=ud(t.databaseInfo.databaseId),n=function(s){return new gb(s)}(t.databaseInfo);return function(s,a,o,l){return new xb(s,a,o,l)}(t.authCredentials,t.appCheckCredentials,n,r)}createRemoteStore(t){return function(n,i,s,a,o){return new Eb(n,i,s,a,o)}(this.localStore,this.datastore,t.asyncQueue,r=>mE(this.syncEngine,r,0),function(){return hE.D()?new hE:new db}())}createSyncEngine(t,r){return function(i,s,a,o,l,c,u){const f=new Bb(i,s,a,o,l,c);return u&&(f.Ca=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return async function(r){const n=Ve(r);Ie("RemoteStore","RemoteStore shutting down."),n.C_.add(5),await Mu(n),n.F_.shutdown(),n.M_.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iI{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Oa(this.observer.next,t)}error(t){this.observer.error?this.Oa(this.observer.error,t):ji("Uncaught Error in snapshot listener:",t.toString())}Na(){this.muted=!0}Oa(t,r){this.muted||setTimeout(()=>{this.muted||t(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zb{constructor(t,r,n,i){this.authCredentials=t,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=yr.UNAUTHENTICATED,this.clientId=iS.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,async s=>{Ie("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(Ie("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Te(Z.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Di;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(r){const n=Mv(r,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function wp(e,t){e.asyncQueue.verifyOperationInProgress(),Ie("FirestoreClient","Initializing OfflineComponentProvider");const r=await e.getConfiguration();await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async i=>{n.isEqual(i)||(await VS(t.localStore,i),n=i)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function _E(e,t){e.asyncQueue.verifyOperationInProgress();const r=await t8(e);Ie("FirestoreClient","Initializing OnlineComponentProvider");const n=await e.getConfiguration();await t.initialize(r,n),e.setCredentialChangeListener(i=>dE(t.remoteStore,i)),e.setAppCheckTokenChangeListener((i,s)=>dE(t.remoteStore,s)),e._onlineComponents=t}function e8(e){return e.name==="FirebaseError"?e.code===Z.FAILED_PRECONDITION||e.code===Z.UNIMPLEMENTED:!(typeof DOMException<"u"&&e instanceof DOMException)||e.code===22||e.code===20||e.code===11}async function t8(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Ie("FirestoreClient","Using user provided OfflineComponentProvider");try{await wp(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!e8(r))throw r;$o("Error using user provided cache. Falling back to memory cache: "+r),await wp(e,new vE)}}else Ie("FirestoreClient","Using default OfflineComponentProvider"),await wp(e,new vE);return e._offlineComponents}async function sI(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Ie("FirestoreClient","Using user provided OnlineComponentProvider"),await _E(e,e._uninitializedComponentsProvider._online)):(Ie("FirestoreClient","Using default OnlineComponentProvider"),await _E(e,new Jb))),e._onlineComponents}function r8(e){return sI(e).then(t=>t.syncEngine)}async function aI(e){const t=await sI(e),r=t.eventManager;return r.onListen=Ub.bind(null,t.syncEngine),r.onUnlisten=jb.bind(null,t.syncEngine),r}function n8(e,t,r={}){const n=new Di;return e.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const u=new iI({next:h=>{a.enqueueAndForget(()=>YS(s,f));const d=h.docs.has(o);!d&&h.fromCache?c.reject(new Te(Z.UNAVAILABLE,"Failed to get document because the client is offline.")):d&&h.fromCache&&l&&l.source==="server"?c.reject(new Te(Z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),f=new QS(Av(o.path),u,{includeMetadataChanges:!0,J_:!0});return XS(s,f)}(await aI(e),e.asyncQueue,t,r,n)),n.promise}function i8(e,t,r={}){const n=new Di;return e.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const u=new iI({next:h=>{a.enqueueAndForget(()=>YS(s,f)),h.fromCache&&l.source==="server"?c.reject(new Te(Z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),f=new QS(o,u,{includeMetadataChanges:!0,J_:!0});return XS(s,f)}(await aI(e),e.asyncQueue,t,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oI(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lI(e,t,r){if(!r)throw new Te(Z.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function s8(e,t,r,n){if(t===!0&&n===!0)throw new Te(Z.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)}function yE(e){if(!Re.isDocumentKey(e))throw new Te(Z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function EE(e){if(Re.isDocumentKey(e))throw new Te(Z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function dd(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(n){return n.constructor?n.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":Ne()}function bs(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Te(Z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=dd(e);throw new Te(Z.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}function a8(e,t){if(t<=0)throw new Te(Z.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(t){var r,n;if(t.host===void 0){if(t.ssl!==void 0)throw new Te(Z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(r=t.ssl)===null||r===void 0||r;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new Te(Z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}s8("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=oI((n=t.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Te(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Te(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Te(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class pd{constructor(t,r,n,i){this._authCredentials=t,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new wE({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Te(Z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(t){if(this._settingsFrozen)throw new Te(Z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new wE(t),t.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new S6;switch(n.type){case"firstParty":return new P6(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Te(Z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=xE.get(r);n&&(Ie("ComponentProvider","Removing Datastore"),xE.delete(r),n.terminate())}(this),Promise.resolve()}}function o8(e,t,r,n={}){var i;const s=(e=bs(e,pd))._getSettings(),a=`${t}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&$o("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=yr.MOCK_USER;else{o=xk(n.mockUserToken,(i=e._app)===null||i===void 0?void 0:i.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new Te(Z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new yr(c)}e._authCredentials=new I6(new nS(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(t,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Gs(this.firestore,t,this._query)}}class sn{constructor(t,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rs(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new sn(this.firestore,t,this._key)}}class Rs extends Gs{constructor(t,r,n){super(t,r,Av(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new sn(this.firestore,null,new Re(t))}withConverter(t){return new Rs(this.firestore,t,this._path)}}function Bv(e,t,...r){if(e=Bt(e),lI("collection","path",t),e instanceof pd){const n=ft.fromString(t,...r);return EE(n),new Rs(e,null,n)}{if(!(e instanceof sn||e instanceof Rs))throw new Te(Z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(ft.fromString(t,...r));return EE(n),new Rs(e.firestore,null,n)}}function Uv(e,t,...r){if(e=Bt(e),arguments.length===1&&(t=iS.newId()),lI("doc","path",t),e instanceof pd){const n=ft.fromString(t,...r);return yE(n),new sn(e,null,new Re(n))}{if(!(e instanceof sn||e instanceof Rs))throw new Te(Z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(ft.fromString(t,...r));return yE(n),new sn(e.firestore,e instanceof Rs?e.converter:null,new Re(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l8{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new US(this,"async_queue_retry"),this.iu=()=>{const r=Ep();r&&Ie("AsyncQueue","Visibility state changed to "+r.visibilityState),this.zo.Qo()};const t=Ep();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.su(),this.ou(t)}enterRestrictedMode(t){if(!this.Za){this.Za=!0,this.nu=t||!1;const r=Ep();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.iu)}}enqueue(t){if(this.su(),this.Za)return new Promise(()=>{});const r=new Di;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Ya.push(t),this._u()))}async _u(){if(this.Ya.length!==0){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(t){if(!Du(t))throw t;Ie("AsyncQueue","Operation failed with retryable error: "+t)}this.Ya.length>0&&this.zo.ko(()=>this._u())}}ou(t){const r=this.Ja.then(()=>(this.tu=!0,t().catch(n=>{this.eu=n,this.tu=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw ji("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.tu=!1,n))));return this.Ja=r,r}enqueueAfterDelay(t,r,n){this.su(),this.ru.indexOf(t)>-1&&(r=0);const i=Lv.createAndSchedule(this,t,r,n,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&Ne()}verifyOperationInProgress(){}async uu(){let t;do t=this.Ja,await t;while(t!==this.Ja)}cu(t){for(const r of this.Xa)if(r.timerId===t)return!0;return!1}lu(t){return this.uu().then(()=>{this.Xa.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Xa)if(r.skipDelay(),t!=="all"&&r.timerId===t)break;return this.uu()})}hu(t){this.ru.push(t)}au(t){const r=this.Xa.indexOf(t);this.Xa.splice(r,1)}}class Vu extends pd{constructor(t,r,n,i){super(t,r,n,i),this.type="firestore",this._queue=function(){return new l8}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||cI(this),this._firestoreClient.terminate()}}function c8(e,t){const r=typeof e=="object"?e:U1(),n=typeof e=="string"?e:t||"(default)",i=V0(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=gk("firestore");s&&o8(i,...s)}return i}function $v(e){return e._firestoreClient||cI(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function cI(e){var t,r,n;const i=e._freezeSettings(),s=function(o,l,c,u){return new j6(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,oI(u.experimentalLongPollingOptions),u.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new Zb(e._authCredentials,e._appCheckCredentials,e._queue,s),!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ko(Nr.fromBase64String(t))}catch(r){throw new Te(Z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(t){return new Ko(Nr.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(...t){for(let r=0;r<t.length;++r)if(t[r].length===0)throw new Te(Z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lr(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jv{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(t,r){if(!isFinite(t)||t<-90||t>90)throw new Te(Z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(r)||r<-180||r>180)throw new Te(Z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=t,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return tt(this._lat,t._lat)||tt(this._long,t._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u8=/^__.*__$/;class f8{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return this.fieldMask!==null?new Ws(t,this.data,this.fieldMask,r,this.fieldTransforms):new Ou(t,this.data,r,this.fieldTransforms)}}class uI{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return new Ws(t,this.data,this.fieldMask,r,this.fieldTransforms)}}function fI(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ne()}}class Hv{constructor(t,r,n,i,s,a){this.settings=t,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(t){return new Hv(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),i=this.Tu({path:n,du:!1});return i.Au(t),i}Ru(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),i=this.Tu({path:n,du:!1});return i.Pu(),i}Vu(t){return this.Tu({path:void 0,du:!0})}mu(t){return t0(t,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(t){return this.fieldMask.find(r=>t.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>t.isPrefixOf(r.field))!==void 0}Pu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Au(this.path.get(t))}Au(t){if(t.length===0)throw this.mu("Document fields must not be empty");if(fI(this.Iu)&&u8.test(t))throw this.mu('Document fields cannot begin and end with "__"')}}class h8{constructor(t,r,n){this.databaseId=t,this.ignoreUndefinedProperties=r,this.serializer=n||ud(t)}pu(t,r,n,i=!1){return new Hv({Iu:t,methodName:r,gu:n,path:lr.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Wv(e){const t=e._freezeSettings(),r=ud(e._databaseId);return new h8(e._databaseId,!!t.ignoreUndefinedProperties,r)}function d8(e,t,r,n,i,s={}){const a=e.pu(s.merge||s.mergeFields?2:0,t,r,i);Gv("Data must be an object, but it was:",a,n);const o=hI(n,a);let l,c;if(s.merge)l=new hn(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const u=[];for(const f of s.mergeFields){const h=Tg(t,f,r);if(!a.contains(h))throw new Te(Z.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);pI(u,h)||u.push(h)}l=new hn(u),c=a.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=a.fieldTransforms;return new f8(new Jr(o),l,c)}class gd extends jv{_toFieldTransform(t){if(t.Iu!==2)throw t.Iu===1?t.mu(`${this._methodName}() can only appear at the top level of your update data`):t.mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof gd}}function p8(e,t,r,n){const i=e.pu(1,t,r);Gv("Data must be an object, but it was:",i,n);const s=[],a=Jr.empty();Ba(n,(l,c)=>{const u=Kv(t,l,r);c=Bt(c);const f=i.Ru(u);if(c instanceof gd)s.push(u);else{const h=Bu(c,f);h!=null&&(s.push(u),a.set(u,h))}});const o=new hn(s);return new uI(a,o,i.fieldTransforms)}function m8(e,t,r,n,i,s){const a=e.pu(1,t,r),o=[Tg(t,n,r)],l=[i];if(s.length%2!=0)throw new Te(Z.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)o.push(Tg(t,s[h])),l.push(s[h+1]);const c=[],u=Jr.empty();for(let h=o.length-1;h>=0;--h)if(!pI(c,o[h])){const d=o[h];let p=l[h];p=Bt(p);const m=a.Ru(d);if(p instanceof gd)c.push(d);else{const v=Bu(p,m);v!=null&&(c.push(d),u.set(d,v))}}const f=new hn(c);return new uI(u,f,a.fieldTransforms)}function g8(e,t,r,n=!1){return Bu(r,e.pu(n?4:3,t))}function Bu(e,t){if(dI(e=Bt(e)))return Gv("Unsupported field value:",t,e),hI(e,t);if(e instanceof jv)return function(n,i){if(!fI(i.Iu))throw i.mu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.du&&t.Iu!==4)throw t.mu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=Bu(o,i.Vu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(e,t)}return function(n,i){if((n=Bt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return cM(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Kt.fromDate(n);return{timestampValue:Zh(i.serializer,s)}}if(n instanceof Kt){const s=new Kt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Zh(i.serializer,s)}}if(n instanceof zv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ko)return{bytesValue:NS(i.serializer,n._byteString)};if(n instanceof sn){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Cv(n.firestore._databaseId||i.databaseId,n._key.path)}}throw i.mu(`Unsupported field value: ${dd(n)}`)}(e,t)}function hI(e,t){const r={};return sS(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ba(e,(n,i)=>{const s=Bu(i,t.Eu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function dI(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof Kt||e instanceof zv||e instanceof Ko||e instanceof sn||e instanceof jv)}function Gv(e,t,r){if(!dI(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=dd(r);throw n==="an object"?t.mu(e+" a custom object"):t.mu(e+" "+n)}}function Tg(e,t,r){if((t=Bt(t))instanceof md)return t._internalPath;if(typeof t=="string")return Kv(e,t);throw t0("Field path arguments must be of type string or ",e,!1,void 0,r)}const v8=new RegExp("[~\\*/\\[\\]]");function Kv(e,t,r){if(t.search(v8)>=0)throw t0(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new md(...t.split("."))._internalPath}catch{throw t0(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function t0(e,t,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new Te(Z.INVALID_ARGUMENT,o+e+l)}function pI(e,t){return e.some(r=>r.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI{constructor(t,r,n,i,s){this._firestore=t,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new sn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new _8(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const r=this._document.data.field(qv("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r)}}}class _8 extends mI{data(){return super.data()}}function qv(e,t){return typeof t=="string"?Kv(e,t):t instanceof md?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x8(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new Te(Z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Xv{}class Yv extends Xv{}function y8(e,t,...r){let n=[];t instanceof Xv&&n.push(t),n=n.concat(r),function(s){const a=s.filter(l=>l instanceof Jv).length,o=s.filter(l=>l instanceof Qv).length;if(a>1||a>0&&o>0)throw new Te(Z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)e=i._apply(e);return e}class Qv extends Yv{constructor(t,r,n){super(),this._field=t,this._op=r,this._value=n,this.type="where"}static _create(t,r,n){return new Qv(t,r,n)}_apply(t){const r=this._parse(t);return gI(t._query,r),new Gs(t.firestore,t.converter,gg(t._query,r))}_parse(t){const r=Wv(t.firestore);return function(s,a,o,l,c,u,f){let h;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Te(Z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){kE(f,u);const d=[];for(const p of f)d.push(TE(l,s,p));h={arrayValue:{values:d}}}else h=TE(l,s,f)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||kE(f,u),h=g8(o,a,f,u==="in"||u==="not-in");return Vt.create(c,u,h)}(t._query,"where",r,t.firestore._databaseId,this._field,this._op,this._value)}}class Jv extends Xv{constructor(t,r){super(),this.type=t,this._queryConstraints=r}static _create(t,r){return new Jv(t,r)}_parse(t){const r=this._queryConstraints.map(n=>n._parse(t)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Yn.create(r,this._getOperator())}_apply(t){const r=this._parse(t);return r.getFilters().length===0?t:(function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)gI(a,l),a=gg(a,l)}(t._query,r),new Gs(t.firestore,t.converter,gg(t._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Zv extends Yv{constructor(t,r){super(),this._field=t,this._direction=r,this.type="orderBy"}static _create(t,r){return new Zv(t,r)}_apply(t){const r=function(i,s,a){if(i.startAt!==null)throw new Te(Z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Te(Z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new eu(s,a)}(t._query,this._field,this._direction);return new Gs(t.firestore,t.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new ll(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(t._query,r))}}function E8(e,t="asc"){const r=t,n=qv("orderBy",e);return Zv._create(n,r)}class e_ extends Yv{constructor(t,r,n){super(),this.type=t,this._limit=r,this._limitType=n}static _create(t,r,n){return new e_(t,r,n)}_apply(t){return new Gs(t.firestore,t.converter,Yh(t._query,this._limit,this._limitType))}}function w8(e){return a8("limit",e),e_._create("limit",e,"F")}function TE(e,t,r){if(typeof(r=Bt(r))=="string"){if(r==="")throw new Te(Z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!pS(t)&&r.indexOf("/")!==-1)throw new Te(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=t.path.child(ft.fromString(r));if(!Re.isDocumentKey(n))throw new Te(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Ky(e,new Re(n))}if(r instanceof sn)return Ky(e,r._key);throw new Te(Z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${dd(r)}.`)}function kE(e,t){if(!Array.isArray(e)||e.length===0)throw new Te(Z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function gI(e,t){const r=function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(e.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(r!==null)throw r===t.op?new Te(Z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Te(Z.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}class T8{convertValue(t,r="none"){switch(Ca(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Mt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,r);case 5:return t.stringValue;case 6:return this.convertBytes(Ia(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,r);case 10:return this.convertObject(t.mapValue,r);default:throw Ne()}}convertObject(t,r){return this.convertObjectMap(t.fields,r)}convertObjectMap(t,r="none"){const n={};return Ba(t,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertGeoPoint(t){return new zv(Mt(t.latitude),Mt(t.longitude))}convertArray(t,r){return(t.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(t,r){switch(r){case"previous":const n=Ev(t);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Qc(t));default:return null}}convertTimestamp(t){const r=Ls(t);return new Kt(r.seconds,r.nanos)}convertDocumentKey(t,r){const n=ft.fromString(t);dt(bS(n));const i=new Jc(n.get(1),n.get(3)),s=new Re(n.popFirst(5));return i.isEqual(r)||ji(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k8(e,t,r){let n;return n=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(t,r){this.hasPendingWrites=t,this.fromCache=r}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class vI extends mI{constructor(t,r,n,i,s,a){super(t,r,n,i,a),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const r=new nh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,r={}){if(this._document){const n=this._document.data.field(qv("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class nh extends vI{data(t={}){return super.data(t)}}class A8{constructor(t,r,n,i){this._firestore=t,this._userDataWriter=r,this._snapshot=i,this.metadata=new $l(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach(r=>t.push(r)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,r){this._snapshot.docs.forEach(n=>{t.call(r,new nh(this._firestore,this._userDataWriter,n.key,n,new $l(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const r=!!t.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Te(Z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new nh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new $l(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new nh(i._firestore,i._userDataWriter,o.doc.key,o.doc,new $l(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,u=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),u=a.indexOf(o.doc.key)),{type:S8(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function S8(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ne()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I8(e){e=bs(e,sn);const t=bs(e.firestore,Vu);return n8($v(t),e._key).then(r=>R8(t,e,r))}class _I extends T8{constructor(t){super(),this.firestore=t}convertBytes(t){return new Ko(t)}convertReference(t){const r=this.convertDocumentKey(t,this.firestore._databaseId);return new sn(this.firestore,null,r)}}function xI(e){e=bs(e,Gs);const t=bs(e.firestore,Vu),r=$v(t),n=new _I(t);return x8(e._query),i8(r,e._query).then(i=>new A8(t,n,e,i))}function yI(e,t,r,...n){e=bs(e,sn);const i=bs(e.firestore,Vu),s=Wv(i);let a;return a=typeof(t=Bt(t))=="string"||t instanceof md?m8(s,"updateDoc",e._key,t,r,n):p8(s,"updateDoc",e._key,t),EI(i,[a.toMutation(e._key,pi.exists(!0))])}function C8(e,t){const r=bs(e.firestore,Vu),n=Uv(e),i=k8(e.converter,t);return EI(r,[d8(Wv(e.firestore),"addDoc",n._key,i,e.converter!==null,{}).toMutation(n._key,pi.exists(!1))]).then(()=>n)}function EI(e,t){return function(n,i){const s=new Di;return n.asyncQueue.enqueueAndForget(async()=>zb(await r8(n),i,s)),s.promise}($v(e),t)}function R8(e,t,r){const n=r.docs.get(t._key),i=new _I(e);return new vI(e,i,t._key,n,new $l(r.hasPendingWrites,r.fromCache),t.converter)}(function(t,r=!0){(function(i){ol=i})(Ma),ka(new Ds("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new Vu(new C6(n.getProvider("auth-internal")),new N6(n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Te(Z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jc(c.options.projectId,u)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),ui(zy,"4.3.2",t),ui(zy,"4.3.2","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wI="firebasestorage.googleapis.com",TI="storageBucket",P8=2*60*1e3,F8=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t extends xi{constructor(t,r,n=0){super(Tp(t),`Firebase Storage: ${r} (${Tp(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,$t.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return Tp(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ut;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ut||(Ut={}));function Tp(e){return"storage/"+e}function t_(){const e="An unknown error occurred, please check the error payload for server response.";return new $t(Ut.UNKNOWN,e)}function N8(e){return new $t(Ut.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function D8(){const e="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new $t(Ut.UNAUTHENTICATED,e)}function O8(){return new $t(Ut.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function L8(e){return new $t(Ut.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function M8(){return new $t(Ut.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function b8(){return new $t(Ut.CANCELED,"User canceled the upload/download.")}function V8(e){return new $t(Ut.INVALID_URL,"Invalid URL '"+e+"'.")}function B8(e){return new $t(Ut.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function U8(){return new $t(Ut.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+TI+"' property when initializing the app?")}function $8(){return new $t(Ut.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function j8(e){return new $t(Ut.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function kg(e){return new $t(Ut.INVALID_ARGUMENT,e)}function kI(){return new $t(Ut.APP_DELETED,"The Firebase app was deleted.")}function z8(e){return new $t(Ut.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function lc(e,t){return new $t(Ut.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function Rl(e){throw new $t(Ut.INTERNAL_ERROR,"Internal error: "+e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(t,r){this.bucket=t,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,r){let n;try{n=dn.makeFromUrl(t,r)}catch{return new dn(t,"")}if(n.path==="")return n;throw B8(t)}static makeFromUrl(t,r){let n=null;const i="([A-Za-z0-9.\\-_]+)";function s(w){w.path.charAt(w.path.length-1)==="/"&&(w.path_=w.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function c(w){w.path_=decodeURIComponent(w.path)}const u="v[A-Za-z0-9_]+",f=r.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",d=new RegExp(`^https?://${f}/${u}/b/${i}/o${h}`,"i"),p={bucket:1,path:3},m=r===wI?"(?:storage.googleapis.com|storage.cloud.google.com)":r,v="([^?#]*)",x=new RegExp(`^https?://${m}/${i}/${v}`,"i"),g=[{regex:o,indices:l,postModify:s},{regex:d,indices:p,postModify:c},{regex:x,indices:{bucket:1,path:2},postModify:c}];for(let w=0;w<g.length;w++){const T=g[w],k=T.regex.exec(t);if(k){const y=k[T.indices.bucket];let P=k[T.indices.path];P||(P=""),n=new dn(y,P),T.postModify(n);break}}if(n==null)throw V8(t);return n}}class H8{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W8(e,t,r){let n=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let c=!1;function u(...v){c||(c=!0,t.apply(null,v))}function f(v){i=setTimeout(()=>{i=null,e(d,l())},v)}function h(){s&&clearTimeout(s)}function d(v,...x){if(c){h();return}if(v){h(),u.call(null,v,...x);return}if(l()||a){h(),u.call(null,v,...x);return}n<64&&(n*=2);let g;o===1?(o=2,g=0):g=(n+Math.random())*1e3,f(g)}let p=!1;function m(v){p||(p=!0,h(),!c&&(i!==null?(v||(o=2),clearTimeout(i),f(0)):v||(o=1)))}return f(0),s=setTimeout(()=>{a=!0,m(!0)},r),m}function G8(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K8(e){return e!==void 0}function q8(e){return typeof e=="object"&&!Array.isArray(e)}function AI(e){return typeof e=="string"||e instanceof String}function AE(e){return r_()&&e instanceof Blob}function r_(){return typeof Blob<"u"&&!VN()}function SE(e,t,r,n){if(n<t)throw kg(`Invalid value for '${e}'. Expected ${t} or greater.`);if(n>r)throw kg(`Invalid value for '${e}'. Expected ${r} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X8(e,t,r){let n=t;return r==null&&(n=`https://${t}`),`${r}://${n}/v0${e}`}function Y8(e){const t=encodeURIComponent;let r="?";for(const n in e)if(e.hasOwnProperty(n)){const i=t(n)+"="+t(e[n]);r=r+i+"&"}return r=r.slice(0,-1),r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ma;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(ma||(ma={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q8(e,t){const r=e>=500&&e<600,i=[408,429].indexOf(e)!==-1,s=t.indexOf(e)!==-1;return r||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J8{constructor(t,r,n,i,s,a,o,l,c,u,f,h=!0){this.url_=t,this.method_=r,this.headers_=n,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=f,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((d,p)=>{this.resolve_=d,this.reject_=p,this.start_()})}start_(){const t=(n,i)=>{if(i){n(!1,new Tf(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===ma.NO_ERROR,l=s.getStatus();if(!o||Q8(l,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===ma.ABORT;n(!1,new Tf(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new Tf(c,s))})},r=(n,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());K8(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=t_();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?kI():b8();a(l)}else{const l=M8();a(l)}};this.canceled_?r(!1,new Tf(!1,null,!0)):this.backoffId_=W8(t,r,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&G8(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Tf{constructor(t,r,n){this.wasSuccessCode=t,this.connection=r,this.canceled=!!n}}function Z8(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function e5(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function t5(e,t){t&&(e["X-Firebase-GMPID"]=t)}function r5(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function n5(e,t,r,n,i,s,a=!0){const o=Y8(e.urlParams),l=e.url+o,c=Object.assign({},e.headers);return t5(c,t),Z8(c,r),e5(c,s),r5(c,n),new J8(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i5(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function s5(...e){const t=i5();if(t!==void 0){const r=new t;for(let n=0;n<e.length;n++)r.append(e[n]);return r.getBlob()}else{if(r_())return new Blob(e);throw new $t(Ut.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function a5(e,t,r){return e.webkitSlice?e.webkitSlice(t,r):e.mozSlice?e.mozSlice(t,r):e.slice?e.slice(t,r):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o5(e){if(typeof atob>"u")throw j8("base-64");return atob(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ai={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class kp{constructor(t,r){this.data=t,this.contentType=r||null}}function l5(e,t){switch(e){case ai.RAW:return new kp(SI(t));case ai.BASE64:case ai.BASE64URL:return new kp(II(e,t));case ai.DATA_URL:return new kp(u5(t),f5(t))}throw t_()}function SI(e){const t=[];for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);if(n<=127)t.push(n);else if(n<=2047)t.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(r<e.length-1&&(e.charCodeAt(r+1)&64512)===56320))t.push(239,191,189);else{const s=n,a=e.charCodeAt(++r);n=65536|(s&1023)<<10|a&1023,t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?t.push(239,191,189):t.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(t)}function c5(e){let t;try{t=decodeURIComponent(e)}catch{throw lc(ai.DATA_URL,"Malformed data URL.")}return SI(t)}function II(e,t){switch(e){case ai.BASE64:{const i=t.indexOf("-")!==-1,s=t.indexOf("_")!==-1;if(i||s)throw lc(e,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case ai.BASE64URL:{const i=t.indexOf("+")!==-1,s=t.indexOf("/")!==-1;if(i||s)throw lc(e,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=o5(t)}catch(i){throw i.message.includes("polyfill")?i:lc(e,"Invalid character found")}const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}class CI{constructor(t){this.base64=!1,this.contentType=null;const r=t.match(/^data:([^,]+)?,/);if(r===null)throw lc(ai.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=r[1]||null;n!=null&&(this.base64=h5(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=t.substring(t.indexOf(",")+1)}}function u5(e){const t=new CI(e);return t.base64?II(ai.BASE64,t.rest):c5(t.rest)}function f5(e){return new CI(e).contentType}function h5(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(t,r){let n=0,i="";AE(t)?(this.data_=t,n=t.size,i=t.type):t instanceof ArrayBuffer?(r?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(r?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=i}size(){return this.size_}type(){return this.type_}slice(t,r){if(AE(this.data_)){const n=this.data_,i=a5(n,t,r);return i===null?null:new as(i)}else{const n=new Uint8Array(this.data_.buffer,t,r-t);return new as(n,!0)}}static getBlob(...t){if(r_()){const r=t.map(n=>n instanceof as?n.data_:n);return new as(s5.apply(null,r))}else{const r=t.map(a=>AI(a)?l5(ai.RAW,a).data:a.data_);let n=0;r.forEach(a=>{n+=a.byteLength});const i=new Uint8Array(n);let s=0;return r.forEach(a=>{for(let o=0;o<a.length;o++)i[s++]=a[o]}),new as(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d5(e){let t;try{t=JSON.parse(e)}catch{return null}return q8(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p5(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function m5(e,t){const r=t.split("/").filter(n=>n.length>0).join("/");return e.length===0?r:e+"/"+r}function RI(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g5(e,t){return t}class Mr{constructor(t,r,n,i){this.server=t,this.local=r||t,this.writable=!!n,this.xform=i||g5}}let kf=null;function v5(e){return!AI(e)||e.length<2?e:RI(e)}function _5(){if(kf)return kf;const e=[];e.push(new Mr("bucket")),e.push(new Mr("generation")),e.push(new Mr("metageneration")),e.push(new Mr("name","fullPath",!0));function t(s,a){return v5(a)}const r=new Mr("name");r.xform=t,e.push(r);function n(s,a){return a!==void 0?Number(a):a}const i=new Mr("size");return i.xform=n,e.push(i),e.push(new Mr("timeCreated")),e.push(new Mr("updated")),e.push(new Mr("md5Hash",null,!0)),e.push(new Mr("cacheControl",null,!0)),e.push(new Mr("contentDisposition",null,!0)),e.push(new Mr("contentEncoding",null,!0)),e.push(new Mr("contentLanguage",null,!0)),e.push(new Mr("contentType",null,!0)),e.push(new Mr("metadata","customMetadata",!0)),kf=e,kf}function x5(e,t){function r(){const n=e.bucket,i=e.fullPath,s=new dn(n,i);return t._makeStorageReference(s)}Object.defineProperty(e,"ref",{get:r})}function y5(e,t,r){const n={};n.type="file";const i=r.length;for(let s=0;s<i;s++){const a=r[s];n[a.local]=a.xform(n,t[a.server])}return x5(n,e),n}function E5(e,t,r){const n=d5(t);return n===null?null:y5(e,n,r)}function w5(e,t){const r={},n=t.length;for(let i=0;i<n;i++){const s=t[i];s.writable&&(r[s.server]=e[s.local])}return JSON.stringify(r)}class T5{constructor(t,r,n,i){this.url=t,this.method=r,this.handler=n,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k5(e){if(!e)throw t_()}function A5(e,t){function r(n,i){const s=E5(e,i,t);return k5(s!==null),s}return r}function S5(e){function t(r,n){let i;return r.getStatus()===401?r.getErrorText().includes("Firebase App Check token is invalid")?i=O8():i=D8():r.getStatus()===402?i=N8(e.bucket):r.getStatus()===403?i=L8(e.path):i=n,i.status=r.getStatus(),i.serverResponse=n.serverResponse,i}return t}function I5(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function C5(e,t,r){const n=Object.assign({},r);return n.fullPath=e.path,n.size=t.size(),n.contentType||(n.contentType=I5(null,t)),n}function R5(e,t,r,n,i){const s=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function o(){let g="";for(let w=0;w<2;w++)g=g+Math.random().toString().slice(2);return g}const l=o();a["Content-Type"]="multipart/related; boundary="+l;const c=C5(t,n,i),u=w5(c,r),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,h=`\r
--`+l+"--",d=as.getBlob(f,n,h);if(d===null)throw $8();const p={name:c.fullPath},m=X8(s,e.host,e._protocol),v="POST",x=e.maxUploadRetryTime,_=new T5(m,v,A5(e,r),x);return _.urlParams=p,_.headers=a,_.body=d.uploadData(),_.errorHandler=S5(t),_}class P5{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ma.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ma.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ma.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,r,n,i){if(this.sent_)throw Rl("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(r,t,!0),i!==void 0)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return n!==void 0?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Rl("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Rl("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Rl("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Rl("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class F5 extends P5{initXhr(){this.xhr_.responseType="text"}}function N5(){return new F5}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(t,r){this._service=t,r instanceof dn?this._location=r:this._location=dn.makeFromUrl(r,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,r){return new Ra(t,r)}get root(){const t=new dn(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return RI(this._location.path)}get storage(){return this._service}get parent(){const t=p5(this._location.path);if(t===null)return null;const r=new dn(this._location.bucket,t);return new Ra(this._service,r)}_throwIfRoot(t){if(this._location.path==="")throw z8(t)}}function D5(e,t,r){e._throwIfRoot("uploadBytes");const n=R5(e.storage,e._location,_5(),new as(t,!0),r);return e.storage.makeRequestWithTokens(n,N5).then(i=>({metadata:i,ref:e}))}function O5(e,t){const r=m5(e._location.path,t),n=new dn(e._location.bucket,r);return new Ra(e.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L5(e){return/^[A-Za-z]+:\/\//.test(e)}function M5(e,t){return new Ra(e,t)}function PI(e,t){if(e instanceof n_){const r=e;if(r._bucket==null)throw U8();const n=new Ra(r,r._bucket);return t!=null?PI(n,t):n}else return t!==void 0?O5(e,t):e}function b5(e,t){if(t&&L5(t)){if(e instanceof n_)return M5(e,t);throw kg("To use ref(service, url), the first argument must be a Storage instance.")}else return PI(e,t)}function IE(e,t){const r=t==null?void 0:t[TI];return r==null?null:dn.makeFromBucketSpec(r,e)}function V5(e,t,r,n={}){e.host=`${t}:${r}`,e._protocol="http";const{mockUserToken:i}=n;i&&(e._overrideAuthToken=typeof i=="string"?i:xk(i,e.app.options.projectId))}class n_{constructor(t,r,n,i,s){this.app=t,this._authProvider=r,this._appCheckProvider=n,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=wI,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=P8,this._maxUploadRetryTime=F8,this._requests=new Set,i!=null?this._bucket=dn.makeFromBucketSpec(i,this._host):this._bucket=IE(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=dn.makeFromBucketSpec(this._url,t):this._bucket=IE(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){SE("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){SE("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const r=await t.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Ra(this,t)}_makeRequest(t,r,n,i,s=!0){if(this._deleted)return new H8(kI());{const a=n5(t,this._appId,n,i,r,this._firebaseVersion,s);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(t,r){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,r,n,i).getPromise()}}const CE="@firebase/storage",RE="0.11.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI="storage";function NI(e,t,r){return e=Bt(e),D5(e,t,r)}function DI(e,t){return e=Bt(e),b5(e,t)}function B5(e=U1(),t){e=Bt(e);const n=V0(e,FI).getImmediate({identifier:t}),i=gk("storage");return i&&U5(n,...i),n}function U5(e,t,r,n={}){V5(e,t,r,n)}function $5(e,{instanceIdentifier:t}){const r=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new n_(r,n,i,t,Ma)}function j5(){ka(new Ds(FI,$5,"PUBLIC").setMultipleInstances(!0)),ui(CE,RE,""),ui(CE,RE,"esm2017")}j5();const z5={apiKey:"AIzaSyAJdw_K38o0kuEaY-8_To8-wGhlvoMBjmk",authDomain:"portal-impacto-609ff.firebaseapp.com",projectId:"portal-impacto-609ff",storageBucket:"portal-impacto-609ff.appspot.com",messagingSenderId:{}.VITE_FIREBASE_MESSAGING_ID,appId:"1:1084328635509:web:352477ec68d951718f9c3c"},i_=wk(z5),vd=gL(i_),Uu=c8(i_),OI=B5(i_),H5=(e,t)=>tO(vd,e,t),LI=()=>vd.currentUser!==null,W5=async()=>{try{await iO(vd)}catch(e){console.error("logout",e)}},G5=async e=>{try{const t=await C8(Bv(Uu,"PriorizationObject"),{...e,userId:vd.currentUser.uid})}catch(t){console.error("Error adding document: ",t)}};async function K5(e,t){const r=DI(OI,`${t}.xlsx`);await NI(r,e)}const q5=async({itemsPerPage:e})=>{try{const t=y8(Bv(Uu,"PriorizationObject"),E8("week_name","desc"),w8(e)),r=await xI(t),n=[];return r.forEach(i=>{const s=i.data();n.push({id:i.id,data:s})}),n}catch(t){throw console.error("Error al obtener documentos: ",t),t}},X5=async(e,t)=>{try{const r=Uv(Uu,"PriorizationObject",e),n=await I8(r);if(n.exists()){const i=n.data();if(i.status_history||(i.status_history=[]),i.status_history.push({impacto_status:i.impacto_status||"",impacto_status_description:i.impacto_status_description||"",status_updated_by:i.status_updated_by||"",status_updated_date:i.status_updated_date||""}),Object.keys(t).every(a=>t[a]!==void 0)){const a={...t,status_history:i.status_history};console.log("Payload:",a);try{const o=await yI(r,a)}catch(o){console.error("Error al actualizar el documento:",o)}}else console.error("Error: Los datos de actualización contienen valores indefinidos.")}}catch(r){console.error("Error:",r)}};async function Y5(e){const t=DI(OI,e[0].name);await NI(t,e[0])}const Q5=async(e,t)=>{const r=Uv(Uu,"PriorizationObject",e);await yI(r,t)},J5=async()=>{try{const e=await xI(Bv(Uu,"PriorizationObject")),t=[];return e.forEach(r=>{const n=r.data();t.push({id:r.id,data:n})}),t}catch(e){console.error("Error fetching data:",e)}};var $u=e=>e.type==="checkbox",go=e=>e instanceof Date,Vr=e=>e==null;const MI=e=>typeof e=="object";var Xt=e=>!Vr(e)&&!Array.isArray(e)&&MI(e)&&!go(e),bI=e=>Xt(e)&&e.target?$u(e.target)?e.target.checked:e.target.value:e,Z5=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,VI=(e,t)=>e.has(Z5(t)),e9=e=>{const t=e.constructor&&e.constructor.prototype;return Xt(t)&&t.hasOwnProperty("isPrototypeOf")},s_=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Er(e){let t;const r=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(s_&&(e instanceof Blob||e instanceof FileList))&&(r||Xt(e)))if(t=r?[]:{},!r&&!e9(e))t=e;else for(const n in e)e.hasOwnProperty(n)&&(t[n]=Er(e[n]));else return e;return t}var fl=e=>Array.isArray(e)?e.filter(Boolean):[],ct=e=>e===void 0,ve=(e,t,r)=>{if(!t||!Xt(e))return r;const n=fl(t.split(/[,[\].]+?/)).reduce((i,s)=>Vr(i)?i:i[s],e);return ct(n)||n===e?ct(e[t])?r:e[t]:n},ds=e=>typeof e=="boolean";const r0={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Cn={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ti={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},t9=Se.createContext(null),_d=()=>Se.useContext(t9);var BI=(e,t,r,n=!0)=>{const i={defaultValues:t._defaultValues};for(const s in e)Object.defineProperty(i,s,{get:()=>{const a=s;return t._proxyFormState[a]!==Cn.all&&(t._proxyFormState[a]=!n||Cn.all),r&&(r[a]=!0),e[a]}});return i},on=e=>Xt(e)&&!Object.keys(e).length,UI=(e,t,r,n)=>{r(e);const{name:i,...s}=e;return on(s)||Object.keys(s).length>=Object.keys(t).length||Object.keys(s).find(a=>t[a]===(!n||Cn.all))},pn=e=>Array.isArray(e)?e:[e],$I=(e,t,r)=>!e||!t||e===t||pn(e).some(n=>n&&(r?n===t:n.startsWith(t)||t.startsWith(n)));function xd(e){const t=Se.useRef(e);t.current=e,Se.useEffect(()=>{const r=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{r&&r.unsubscribe()}},[e.disabled])}function r9(e){const t=_d(),{control:r=t.control,disabled:n,name:i,exact:s}=e||{},[a,o]=Se.useState(r._formState),l=Se.useRef(!0),c=Se.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),u=Se.useRef(i);return u.current=i,xd({disabled:n,next:f=>l.current&&$I(u.current,f.name,s)&&UI(f,c.current,r._updateFormState)&&o({...r._formState,...f}),subject:r._subjects.state}),Se.useEffect(()=>(l.current=!0,c.current.isValid&&r._updateValid(!0),()=>{l.current=!1}),[r]),BI(a,r,c.current,!1)}var oi=e=>typeof e=="string",jI=(e,t,r,n,i)=>oi(e)?(n&&t.watch.add(e),ve(r,e,i)):Array.isArray(e)?e.map(s=>(n&&t.watch.add(s),ve(r,s))):(n&&(t.watchAll=!0),r);function n9(e){const t=_d(),{control:r=t.control,name:n,defaultValue:i,disabled:s,exact:a}=e||{},o=Se.useRef(n);o.current=n,xd({disabled:s,subject:r._subjects.values,next:u=>{$I(o.current,u.name,a)&&c(Er(jI(o.current,r._names,u.values||r._formValues,!1,i)))}});const[l,c]=Se.useState(r._getWatch(n,i));return Se.useEffect(()=>r._removeUnmounted()),l}var a_=e=>/^\w*$/.test(e),zI=e=>fl(e.replace(/["|']|\]/g,"").split(/\.|\[/));function st(e,t,r){let n=-1;const i=a_(t)?[t]:zI(t),s=i.length,a=s-1;for(;++n<s;){const o=i[n];let l=r;if(n!==a){const c=e[o];l=Xt(c)||Array.isArray(c)?c:isNaN(+i[n+1])?{}:[]}e[o]=l,e=e[o]}return e}function i9(e){const t=_d(),{name:r,disabled:n,control:i=t.control,shouldUnregister:s}=e,a=VI(i._names.array,r),o=n9({control:i,name:r,defaultValue:ve(i._formValues,r,ve(i._defaultValues,r,e.defaultValue)),exact:!0}),l=r9({control:i,name:r}),c=Se.useRef(i.register(r,{...e.rules,value:o}));return c.current=i.register(r,e.rules),Se.useEffect(()=>{const u=i._options.shouldUnregister||s,f=(h,d)=>{const p=ve(i._fields,h);p&&(p._f.mount=d)};if(f(r,!0),u){const h=Er(ve(i._options.defaultValues,r));st(i._defaultValues,r,h),ct(ve(i._formValues,r))&&st(i._formValues,r,h)}return()=>{(a?u&&!i._state.action:u)?i.unregister(r):f(r,!1)}},[r,i,a,s]),Se.useEffect(()=>{ve(i._fields,r)&&i._updateDisabledField({disabled:n,fields:i._fields,name:r})},[n,r,i]),{field:{name:r,value:o,...ds(n)?{disabled:n}:{},onChange:Se.useCallback(u=>c.current.onChange({target:{value:bI(u),name:r},type:r0.CHANGE}),[r]),onBlur:Se.useCallback(()=>c.current.onBlur({target:{value:ve(i._formValues,r),name:r},type:r0.BLUR}),[r,i]),ref:u=>{const f=ve(i._fields,r);f&&u&&(f._f.ref={focus:()=>u.focus(),select:()=>u.select(),setCustomValidity:h=>u.setCustomValidity(h),reportValidity:()=>u.reportValidity()})}},formState:l,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!ve(l.errors,r)},isDirty:{enumerable:!0,get:()=>!!ve(l.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!ve(l.touchedFields,r)},error:{enumerable:!0,get:()=>ve(l.errors,r)}})}}const gi=e=>e.render(i9(e));var s9=(e,t,r,n,i)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[n]:i||!0}}:{};const n0=(e,t,r)=>{for(const n of r||Object.keys(e)){const i=ve(e,n);if(i){const{_f:s,...a}=i;if(s&&t(s.name)){if(s.ref.focus){s.ref.focus();break}else if(s.refs&&s.refs[0].focus){s.refs[0].focus();break}}else Xt(a)&&n0(a,t)}}};var Yi=()=>{const e=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const r=(Math.random()*16+e)%16|0;return(t=="x"?r:r&3|8).toString(16)})},Ap=(e,t,r={})=>r.shouldFocus||ct(r.shouldFocus)?r.focusName||`${e}.${ct(r.focusIndex)?t:r.focusIndex}.`:"",Ag=e=>({isOnSubmit:!e||e===Cn.onSubmit,isOnBlur:e===Cn.onBlur,isOnChange:e===Cn.onChange,isOnAll:e===Cn.all,isOnTouch:e===Cn.onTouched}),Sg=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length)))),HI=(e,t,r)=>{const n=fl(ve(e,r));return st(n,"root",t[r]),st(e,r,n),e},o_=e=>e.type==="file",ps=e=>typeof e=="function",i0=e=>{if(!s_)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},ih=e=>oi(e),l_=e=>e.type==="radio",s0=e=>e instanceof RegExp;const PE={value:!1,isValid:!1},FE={value:!0,isValid:!0};var WI=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!ct(e[0].attributes.value)?ct(e[0].value)||e[0].value===""?FE:{value:e[0].value,isValid:!0}:FE:PE}return PE};const NE={isValid:!1,value:null};var GI=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,NE):NE;function DE(e,t,r="validate"){if(ih(e)||Array.isArray(e)&&e.every(ih)||ds(e)&&!e)return{type:r,message:ih(e)?e:"",ref:t}}var Xa=e=>Xt(e)&&!s0(e)?e:{value:e,message:""},Ig=async(e,t,r,n,i)=>{const{ref:s,refs:a,required:o,maxLength:l,minLength:c,min:u,max:f,pattern:h,validate:d,name:p,valueAsNumber:m,mount:v,disabled:x}=e._f,_=ve(t,p);if(!v||x)return{};const g=a?a[0]:s,w=M=>{n&&g.reportValidity&&(g.setCustomValidity(ds(M)?"":M||""),g.reportValidity())},T={},k=l_(s),y=$u(s),P=k||y,O=(m||o_(s))&&ct(s.value)&&ct(_)||i0(s)&&s.value===""||_===""||Array.isArray(_)&&!_.length,U=s9.bind(null,p,r,T),j=(M,X,ne,re=Ti.maxLength,se=Ti.minLength)=>{const ue=M?X:ne;T[p]={type:M?re:se,message:ue,ref:s,...U(M?re:se,ue)}};if(i?!Array.isArray(_)||!_.length:o&&(!P&&(O||Vr(_))||ds(_)&&!_||y&&!WI(a).isValid||k&&!GI(a).isValid)){const{value:M,message:X}=ih(o)?{value:!!o,message:o}:Xa(o);if(M&&(T[p]={type:Ti.required,message:X,ref:g,...U(Ti.required,X)},!r))return w(X),T}if(!O&&(!Vr(u)||!Vr(f))){let M,X;const ne=Xa(f),re=Xa(u);if(!Vr(_)&&!isNaN(_)){const se=s.valueAsNumber||_&&+_;Vr(ne.value)||(M=se>ne.value),Vr(re.value)||(X=se<re.value)}else{const se=s.valueAsDate||new Date(_),ue=ce=>new Date(new Date().toDateString()+" "+ce),te=s.type=="time",b=s.type=="week";oi(ne.value)&&_&&(M=te?ue(_)>ue(ne.value):b?_>ne.value:se>new Date(ne.value)),oi(re.value)&&_&&(X=te?ue(_)<ue(re.value):b?_<re.value:se<new Date(re.value))}if((M||X)&&(j(!!M,ne.message,re.message,Ti.max,Ti.min),!r))return w(T[p].message),T}if((l||c)&&!O&&(oi(_)||i&&Array.isArray(_))){const M=Xa(l),X=Xa(c),ne=!Vr(M.value)&&_.length>+M.value,re=!Vr(X.value)&&_.length<+X.value;if((ne||re)&&(j(ne,M.message,X.message),!r))return w(T[p].message),T}if(h&&!O&&oi(_)){const{value:M,message:X}=Xa(h);if(s0(M)&&!_.match(M)&&(T[p]={type:Ti.pattern,message:X,ref:s,...U(Ti.pattern,X)},!r))return w(X),T}if(d){if(ps(d)){const M=await d(_,t),X=DE(M,g);if(X&&(T[p]={...X,...U(Ti.validate,X.message)},!r))return w(X.message),T}else if(Xt(d)){let M={};for(const X in d){if(!on(M)&&!r)break;const ne=DE(await d[X](_,t),g,X);ne&&(M={...ne,...U(X,ne.message)},w(ne.message),r&&(T[p]=M))}if(!on(M)&&(T[p]={ref:g,...M},!r))return T}}return w(!0),T};function Sp(e,t){return[...e,...pn(t)]}var Ip=e=>Array.isArray(e)?e.map(()=>{}):void 0;function Cp(e,t,r){return[...e.slice(0,t),...pn(r),...e.slice(t)]}var Rp=(e,t,r)=>Array.isArray(e)?(ct(e[r])&&(e[r]=void 0),e.splice(r,0,e.splice(t,1)[0]),e):[];function Pp(e,t){return[...pn(t),...pn(e)]}function a9(e,t){let r=0;const n=[...e];for(const i of t)n.splice(i-r,1),r++;return fl(n).length?n:[]}var Fp=(e,t)=>ct(t)?[]:a9(e,pn(t).sort((r,n)=>r-n)),Np=(e,t,r)=>{e[t]=[e[r],e[r]=e[t]][0]};function o9(e,t){const r=t.slice(0,-1).length;let n=0;for(;n<r;)e=ct(e)?n++:e[t[n++]];return e}function l9(e){for(const t in e)if(e.hasOwnProperty(t)&&!ct(e[t]))return!1;return!0}function Yt(e,t){const r=Array.isArray(t)?t:a_(t)?[t]:zI(t),n=r.length===1?e:o9(e,r),i=r.length-1,s=r[i];return n&&delete n[s],i!==0&&(Xt(n)&&on(n)||Array.isArray(n)&&l9(n))&&Yt(e,r.slice(0,-1)),e}var OE=(e,t,r)=>(e[t]=r,e);function c9(e){const t=_d(),{control:r=t.control,name:n,keyName:i="id",shouldUnregister:s}=e,[a,o]=Se.useState(r._getFieldArray(n)),l=Se.useRef(r._getFieldArray(n).map(Yi)),c=Se.useRef(a),u=Se.useRef(n),f=Se.useRef(!1);u.current=n,c.current=a,r._names.array.add(n),e.rules&&r.register(n,e.rules),xd({next:({values:T,name:k})=>{if(k===u.current||!k){const y=ve(T,u.current);Array.isArray(y)&&(o(y),l.current=y.map(Yi))}},subject:r._subjects.array});const h=Se.useCallback(T=>{f.current=!0,r._updateFieldArray(n,T)},[r,n]),d=(T,k)=>{const y=pn(Er(T)),P=Sp(r._getFieldArray(n),y);r._names.focus=Ap(n,P.length-1,k),l.current=Sp(l.current,y.map(Yi)),h(P),o(P),r._updateFieldArray(n,P,Sp,{argA:Ip(T)})},p=(T,k)=>{const y=pn(Er(T)),P=Pp(r._getFieldArray(n),y);r._names.focus=Ap(n,0,k),l.current=Pp(l.current,y.map(Yi)),h(P),o(P),r._updateFieldArray(n,P,Pp,{argA:Ip(T)})},m=T=>{const k=Fp(r._getFieldArray(n),T);l.current=Fp(l.current,T),h(k),o(k),r._updateFieldArray(n,k,Fp,{argA:T})},v=(T,k,y)=>{const P=pn(Er(k)),O=Cp(r._getFieldArray(n),T,P);r._names.focus=Ap(n,T,y),l.current=Cp(l.current,T,P.map(Yi)),h(O),o(O),r._updateFieldArray(n,O,Cp,{argA:T,argB:Ip(k)})},x=(T,k)=>{const y=r._getFieldArray(n);Np(y,T,k),Np(l.current,T,k),h(y),o(y),r._updateFieldArray(n,y,Np,{argA:T,argB:k},!1)},_=(T,k)=>{const y=r._getFieldArray(n);Rp(y,T,k),Rp(l.current,T,k),h(y),o(y),r._updateFieldArray(n,y,Rp,{argA:T,argB:k},!1)},g=(T,k)=>{const y=Er(k),P=OE(r._getFieldArray(n),T,y);l.current=[...P].map((O,U)=>!O||U===T?Yi():l.current[U]),h(P),o([...P]),r._updateFieldArray(n,P,OE,{argA:T,argB:y},!0,!1)},w=T=>{const k=pn(Er(T));l.current=k.map(Yi),h([...k]),o([...k]),r._updateFieldArray(n,[...k],y=>y,{},!0,!1)};return Se.useEffect(()=>{if(r._state.action=!1,Sg(n,r._names)&&r._subjects.state.next({...r._formState}),f.current&&(!Ag(r._options.mode).isOnSubmit||r._formState.isSubmitted))if(r._options.resolver)r._executeSchema([n]).then(T=>{const k=ve(T.errors,n),y=ve(r._formState.errors,n);(y?!k&&y.type||k&&(y.type!==k.type||y.message!==k.message):k&&k.type)&&(k?st(r._formState.errors,n,k):Yt(r._formState.errors,n),r._subjects.state.next({errors:r._formState.errors}))});else{const T=ve(r._fields,n);T&&T._f&&Ig(T,r._formValues,r._options.criteriaMode===Cn.all,r._options.shouldUseNativeValidation,!0).then(k=>!on(k)&&r._subjects.state.next({errors:HI(r._formState.errors,k,n)}))}r._subjects.values.next({name:n,values:{...r._formValues}}),r._names.focus&&n0(r._fields,T=>!!T&&T.startsWith(r._names.focus||"")),r._names.focus="",r._updateValid(),f.current=!1},[a,n,r]),Se.useEffect(()=>(!ve(r._formValues,n)&&r._updateFieldArray(n),()=>{(r._options.shouldUnregister||s)&&r.unregister(n)}),[n,r,i,s]),{swap:Se.useCallback(x,[h,n,r]),move:Se.useCallback(_,[h,n,r]),prepend:Se.useCallback(p,[h,n,r]),append:Se.useCallback(d,[h,n,r]),remove:Se.useCallback(m,[h,n,r]),insert:Se.useCallback(v,[h,n,r]),update:Se.useCallback(g,[h,n,r]),replace:Se.useCallback(w,[h,n,r]),fields:Se.useMemo(()=>a.map((T,k)=>({...T,[i]:l.current[k]||Yi()})),[a,i])}}function Dp(){let e=[];return{get observers(){return e},next:i=>{for(const s of e)s.next&&s.next(i)},subscribe:i=>(e.push(i),{unsubscribe:()=>{e=e.filter(s=>s!==i)}}),unsubscribe:()=>{e=[]}}}var a0=e=>Vr(e)||!MI(e);function ca(e,t){if(a0(e)||a0(t))return e===t;if(go(e)&&go(t))return e.getTime()===t.getTime();const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const i of r){const s=e[i];if(!n.includes(i))return!1;if(i!=="ref"){const a=t[i];if(go(s)&&go(a)||Xt(s)&&Xt(a)||Array.isArray(s)&&Array.isArray(a)?!ca(s,a):s!==a)return!1}}return!0}var KI=e=>e.type==="select-multiple",u9=e=>l_(e)||$u(e),Op=e=>i0(e)&&e.isConnected,qI=e=>{for(const t in e)if(ps(e[t]))return!0;return!1};function o0(e,t={}){const r=Array.isArray(e);if(Xt(e)||r)for(const n in e)Array.isArray(e[n])||Xt(e[n])&&!qI(e[n])?(t[n]=Array.isArray(e[n])?[]:{},o0(e[n],t[n])):Vr(e[n])||(t[n]=!0);return t}function XI(e,t,r){const n=Array.isArray(e);if(Xt(e)||n)for(const i in e)Array.isArray(e[i])||Xt(e[i])&&!qI(e[i])?ct(t)||a0(r[i])?r[i]=Array.isArray(e[i])?o0(e[i],[]):{...o0(e[i])}:XI(e[i],Vr(t)?{}:t[i],r[i]):r[i]=!ca(e[i],t[i]);return r}var Lp=(e,t)=>XI(e,t,o0(t)),YI=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:n})=>ct(e)?e:t?e===""?NaN:e&&+e:r&&oi(e)?new Date(e):n?n(e):e;function Mp(e){const t=e.ref;if(!(e.refs?e.refs.every(r=>r.disabled):t.disabled))return o_(t)?t.files:l_(t)?GI(e.refs).value:KI(t)?[...t.selectedOptions].map(({value:r})=>r):$u(t)?WI(e.refs).value:YI(ct(t.value)?e.ref.value:t.value,e)}var f9=(e,t,r,n)=>{const i={};for(const s of e){const a=ve(t,s);a&&st(i,s,a._f)}return{criteriaMode:r,names:[...e],fields:i,shouldUseNativeValidation:n}},Pl=e=>ct(e)?e:s0(e)?e.source:Xt(e)?s0(e.value)?e.value.source:e.value:e,h9=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function LE(e,t,r){const n=ve(e,r);if(n||a_(r))return{error:n,name:r};const i=r.split(".");for(;i.length;){const s=i.join("."),a=ve(t,s),o=ve(e,s);if(a&&!Array.isArray(a)&&r!==s)return{name:r};if(o&&o.type)return{name:s,error:o};i.pop()}return{name:r}}var d9=(e,t,r,n,i)=>i.isOnAll?!1:!r&&i.isOnTouch?!(t||e):(r?n.isOnBlur:i.isOnBlur)?!e:(r?n.isOnChange:i.isOnChange)?e:!0,p9=(e,t)=>!fl(ve(e,t)).length&&Yt(e,t);const m9={mode:Cn.onSubmit,reValidateMode:Cn.onChange,shouldFocusError:!0};function g9(e={},t){let r={...m9,...e},n={submitCount:0,isDirty:!1,isLoading:ps(r.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{}},i={},s=Xt(r.defaultValues)||Xt(r.values)?Er(r.defaultValues||r.values)||{}:{},a=r.shouldUnregister?{}:Er(s),o={action:!1,mount:!1,watch:!1},l={mount:new Set,unMount:new Set,array:new Set,watch:new Set},c,u=0;const f={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},h={values:Dp(),array:Dp(),state:Dp()},d=e.resetOptions&&e.resetOptions.keepDirtyValues,p=Ag(r.mode),m=Ag(r.reValidateMode),v=r.criteriaMode===Cn.all,x=I=>W=>{clearTimeout(u),u=setTimeout(I,W)},_=async I=>{if(f.isValid||I){const W=r.resolver?on((await O()).errors):await j(i,!0);W!==n.isValid&&h.state.next({isValid:W})}},g=I=>f.isValidating&&h.state.next({isValidating:I}),w=(I,W=[],Y,we,pe=!0,fe=!0)=>{if(we&&Y){if(o.action=!0,fe&&Array.isArray(ve(i,I))){const Ce=Y(ve(i,I),we.argA,we.argB);pe&&st(i,I,Ce)}if(fe&&Array.isArray(ve(n.errors,I))){const Ce=Y(ve(n.errors,I),we.argA,we.argB);pe&&st(n.errors,I,Ce),p9(n.errors,I)}if(f.touchedFields&&fe&&Array.isArray(ve(n.touchedFields,I))){const Ce=Y(ve(n.touchedFields,I),we.argA,we.argB);pe&&st(n.touchedFields,I,Ce)}f.dirtyFields&&(n.dirtyFields=Lp(s,a)),h.state.next({name:I,isDirty:X(I,W),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else st(a,I,W)},T=(I,W)=>{st(n.errors,I,W),h.state.next({errors:n.errors})},k=(I,W,Y,we)=>{const pe=ve(i,I);if(pe){const fe=ve(a,I,ct(Y)?ve(s,I):Y);ct(fe)||we&&we.defaultChecked||W?st(a,I,W?fe:Mp(pe._f)):se(I,fe),o.mount&&_()}},y=(I,W,Y,we,pe)=>{let fe=!1,Ce=!1;const $e={name:I};if(!Y||we){f.isDirty&&(Ce=n.isDirty,n.isDirty=$e.isDirty=X(),fe=Ce!==$e.isDirty);const et=ca(ve(s,I),W);Ce=ve(n.dirtyFields,I),et?Yt(n.dirtyFields,I):st(n.dirtyFields,I,!0),$e.dirtyFields=n.dirtyFields,fe=fe||f.dirtyFields&&Ce!==!et}if(Y){const et=ve(n.touchedFields,I);et||(st(n.touchedFields,I,Y),$e.touchedFields=n.touchedFields,fe=fe||f.touchedFields&&et!==Y)}return fe&&pe&&h.state.next($e),fe?$e:{}},P=(I,W,Y,we)=>{const pe=ve(n.errors,I),fe=f.isValid&&ds(W)&&n.isValid!==W;if(e.delayError&&Y?(c=x(()=>T(I,Y)),c(e.delayError)):(clearTimeout(u),c=null,Y?st(n.errors,I,Y):Yt(n.errors,I)),(Y?!ca(pe,Y):pe)||!on(we)||fe){const Ce={...we,...fe&&ds(W)?{isValid:W}:{},errors:n.errors,name:I};n={...n,...Ce},h.state.next(Ce)}g(!1)},O=async I=>r.resolver(a,r.context,f9(I||l.mount,i,r.criteriaMode,r.shouldUseNativeValidation)),U=async I=>{const{errors:W}=await O(I);if(I)for(const Y of I){const we=ve(W,Y);we?st(n.errors,Y,we):Yt(n.errors,Y)}else n.errors=W;return W},j=async(I,W,Y={valid:!0})=>{for(const we in I){const pe=I[we];if(pe){const{_f:fe,...Ce}=pe;if(fe){const $e=l.array.has(fe.name),et=await Ig(pe,a,v,r.shouldUseNativeValidation&&!W,$e);if(et[fe.name]&&(Y.valid=!1,W))break;!W&&(ve(et,fe.name)?$e?HI(n.errors,et,fe.name):st(n.errors,fe.name,et[fe.name]):Yt(n.errors,fe.name))}Ce&&await j(Ce,W,Y)}}return Y.valid},M=()=>{for(const I of l.unMount){const W=ve(i,I);W&&(W._f.refs?W._f.refs.every(Y=>!Op(Y)):!Op(W._f.ref))&&J(I)}l.unMount=new Set},X=(I,W)=>(I&&W&&st(a,I,W),!ca(Ee(),s)),ne=(I,W,Y)=>jI(I,l,{...o.mount?a:ct(W)?s:oi(I)?{[I]:W}:W},Y,W),re=I=>fl(ve(o.mount?a:s,I,e.shouldUnregister?ve(s,I,[]):[])),se=(I,W,Y={})=>{const we=ve(i,I);let pe=W;if(we){const fe=we._f;fe&&(!fe.disabled&&st(a,I,YI(W,fe)),pe=i0(fe.ref)&&Vr(W)?"":W,KI(fe.ref)?[...fe.ref.options].forEach(Ce=>Ce.selected=pe.includes(Ce.value)):fe.refs?$u(fe.ref)?fe.refs.length>1?fe.refs.forEach(Ce=>(!Ce.defaultChecked||!Ce.disabled)&&(Ce.checked=Array.isArray(pe)?!!pe.find($e=>$e===Ce.value):pe===Ce.value)):fe.refs[0]&&(fe.refs[0].checked=!!pe):fe.refs.forEach(Ce=>Ce.checked=Ce.value===pe):o_(fe.ref)?fe.ref.value="":(fe.ref.value=pe,fe.ref.type||h.values.next({name:I,values:{...a}})))}(Y.shouldDirty||Y.shouldTouch)&&y(I,pe,Y.shouldTouch,Y.shouldDirty,!0),Y.shouldValidate&&ce(I)},ue=(I,W,Y)=>{for(const we in W){const pe=W[we],fe=`${I}.${we}`,Ce=ve(i,fe);(l.array.has(I)||!a0(pe)||Ce&&!Ce._f)&&!go(pe)?ue(fe,pe,Y):se(fe,pe,Y)}},te=(I,W,Y={})=>{const we=ve(i,I),pe=l.array.has(I),fe=Er(W);st(a,I,fe),pe?(h.array.next({name:I,values:{...a}}),(f.isDirty||f.dirtyFields)&&Y.shouldDirty&&h.state.next({name:I,dirtyFields:Lp(s,a),isDirty:X(I,fe)})):we&&!we._f&&!Vr(fe)?ue(I,fe,Y):se(I,fe,Y),Sg(I,l)&&h.state.next({...n}),h.values.next({name:I,values:{...a}}),!o.mount&&t()},b=async I=>{const W=I.target;let Y=W.name,we=!0;const pe=ve(i,Y),fe=()=>W.type?Mp(pe._f):bI(I);if(pe){let Ce,$e;const et=fe(),Lr=I.type===r0.BLUR||I.type===r0.FOCUS_OUT,qs=!h9(pe._f)&&!r.resolver&&!ve(n.errors,Y)&&!pe._f.deps||d9(Lr,ve(n.touchedFields,Y),n.isSubmitted,m,p),jt=Sg(Y,l,Lr);st(a,Y,et),Lr?(pe._f.onBlur&&pe._f.onBlur(I),c&&c(0)):pe._f.onChange&&pe._f.onChange(I);const qr=y(Y,et,Lr,!1),Be=!on(qr)||jt;if(!Lr&&h.values.next({name:Y,type:I.type,values:{...a}}),qs)return f.isValid&&_(),Be&&h.state.next({name:Y,...jt?{}:qr});if(!Lr&&jt&&h.state.next({...n}),g(!0),r.resolver){const{errors:mt}=await O([Y]),Xr=LE(n.errors,i,Y),kt=LE(mt,i,Xr.name||Y);Ce=kt.error,Y=kt.name,$e=on(mt)}else Ce=(await Ig(pe,a,v,r.shouldUseNativeValidation))[Y],we=Number.isNaN(et)||et===ve(a,Y,et),we&&(Ce?$e=!1:f.isValid&&($e=await j(i,!0)));we&&(pe._f.deps&&ce(pe._f.deps),P(Y,$e,Ce,qr))}},ce=async(I,W={})=>{let Y,we;const pe=pn(I);if(g(!0),r.resolver){const fe=await U(ct(I)?I:pe);Y=on(fe),we=I?!pe.some(Ce=>ve(fe,Ce)):Y}else I?(we=(await Promise.all(pe.map(async fe=>{const Ce=ve(i,fe);return await j(Ce&&Ce._f?{[fe]:Ce}:Ce)}))).every(Boolean),!(!we&&!n.isValid)&&_()):we=Y=await j(i);return h.state.next({...!oi(I)||f.isValid&&Y!==n.isValid?{}:{name:I},...r.resolver||!I?{isValid:Y}:{},errors:n.errors,isValidating:!1}),W.shouldFocus&&!we&&n0(i,fe=>fe&&ve(n.errors,fe),I?pe:l.mount),we},Ee=I=>{const W={...s,...o.mount?a:{}};return ct(I)?W:oi(I)?ve(W,I):I.map(Y=>ve(W,Y))},F=(I,W)=>({invalid:!!ve((W||n).errors,I),isDirty:!!ve((W||n).dirtyFields,I),isTouched:!!ve((W||n).touchedFields,I),error:ve((W||n).errors,I)}),H=I=>{I&&pn(I).forEach(W=>Yt(n.errors,W)),h.state.next({errors:I?n.errors:{}})},B=(I,W,Y)=>{const we=(ve(i,I,{_f:{}})._f||{}).ref;st(n.errors,I,{...W,ref:we}),h.state.next({name:I,errors:n.errors,isValid:!1}),Y&&Y.shouldFocus&&we&&we.focus&&we.focus()},V=(I,W)=>ps(I)?h.values.subscribe({next:Y=>I(ne(void 0,W),Y)}):ne(I,W,!0),J=(I,W={})=>{for(const Y of I?pn(I):l.mount)l.mount.delete(Y),l.array.delete(Y),W.keepValue||(Yt(i,Y),Yt(a,Y)),!W.keepError&&Yt(n.errors,Y),!W.keepDirty&&Yt(n.dirtyFields,Y),!W.keepTouched&&Yt(n.touchedFields,Y),!r.shouldUnregister&&!W.keepDefaultValue&&Yt(s,Y);h.values.next({values:{...a}}),h.state.next({...n,...W.keepDirty?{isDirty:X()}:{}}),!W.keepIsValid&&_()},de=({disabled:I,name:W,field:Y,fields:we})=>{if(ds(I)){const pe=I?void 0:ve(a,W,Mp(Y?Y._f:ve(we,W)._f));st(a,W,pe),y(W,pe,!1,!1,!0)}},xe=(I,W={})=>{let Y=ve(i,I);const we=ds(W.disabled);return st(i,I,{...Y||{},_f:{...Y&&Y._f?Y._f:{ref:{name:I}},name:I,mount:!0,...W}}),l.mount.add(I),Y?de({field:Y,disabled:W.disabled,name:I}):k(I,!0,W.value),{...we?{disabled:W.disabled}:{},...r.progressive?{required:!!W.required,min:Pl(W.min),max:Pl(W.max),minLength:Pl(W.minLength),maxLength:Pl(W.maxLength),pattern:Pl(W.pattern)}:{},name:I,onChange:b,onBlur:b,ref:pe=>{if(pe){xe(I,W),Y=ve(i,I);const fe=ct(pe.value)&&pe.querySelectorAll&&pe.querySelectorAll("input,select,textarea")[0]||pe,Ce=u9(fe),$e=Y._f.refs||[];if(Ce?$e.find(et=>et===fe):fe===Y._f.ref)return;st(i,I,{_f:{...Y._f,...Ce?{refs:[...$e.filter(Op),fe,...Array.isArray(ve(s,I))?[{}]:[]],ref:{type:fe.type,name:I}}:{ref:fe}}}),k(I,!1,void 0,fe)}else Y=ve(i,I,{}),Y._f&&(Y._f.mount=!1),(r.shouldUnregister||W.shouldUnregister)&&!(VI(l.array,I)&&o.action)&&l.unMount.add(I)}}},me=()=>r.shouldFocusError&&n0(i,I=>I&&ve(n.errors,I),l.mount),ae=(I,W)=>async Y=>{Y&&(Y.preventDefault&&Y.preventDefault(),Y.persist&&Y.persist());let we=Er(a);if(h.state.next({isSubmitting:!0}),r.resolver){const{errors:pe,values:fe}=await O();n.errors=pe,we=fe}else await j(i);Yt(n.errors,"root"),on(n.errors)?(h.state.next({errors:{}}),await I(we,Y)):(W&&await W({...n.errors},Y),me(),setTimeout(me)),h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:on(n.errors),submitCount:n.submitCount+1,errors:n.errors})},He=(I,W={})=>{ve(i,I)&&(ct(W.defaultValue)?te(I,ve(s,I)):(te(I,W.defaultValue),st(s,I,W.defaultValue)),W.keepTouched||Yt(n.touchedFields,I),W.keepDirty||(Yt(n.dirtyFields,I),n.isDirty=W.defaultValue?X(I,ve(s,I)):X()),W.keepError||(Yt(n.errors,I),f.isValid&&_()),h.state.next({...n}))},L=(I,W={})=>{const Y=I?Er(I):s,we=Er(Y),pe=I&&!on(I)?we:s;if(W.keepDefaultValues||(s=Y),!W.keepValues){if(W.keepDirtyValues||d)for(const fe of l.mount)ve(n.dirtyFields,fe)?st(pe,fe,ve(a,fe)):te(fe,ve(pe,fe));else{if(s_&&ct(I))for(const fe of l.mount){const Ce=ve(i,fe);if(Ce&&Ce._f){const $e=Array.isArray(Ce._f.refs)?Ce._f.refs[0]:Ce._f.ref;if(i0($e)){const et=$e.closest("form");if(et){et.reset();break}}}}i={}}a=e.shouldUnregister?W.keepDefaultValues?Er(s):{}:Er(pe),h.array.next({values:{...pe}}),h.values.next({values:{...pe}})}l={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!o.mount&&t(),o.mount=!f.isValid||!!W.keepIsValid,o.watch=!!e.shouldUnregister,h.state.next({submitCount:W.keepSubmitCount?n.submitCount:0,isDirty:W.keepDirty?n.isDirty:!!(W.keepDefaultValues&&!ca(I,s)),isSubmitted:W.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:W.keepDirtyValues?n.dirtyFields:W.keepDefaultValues&&I?Lp(s,I):{},touchedFields:W.keepTouched?n.touchedFields:{},errors:W.keepErrors?n.errors:{},isSubmitSuccessful:W.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1})},pt=(I,W)=>L(ps(I)?I(a):I,W);return{control:{register:xe,unregister:J,getFieldState:F,handleSubmit:ae,setError:B,_executeSchema:O,_getWatch:ne,_getDirty:X,_updateValid:_,_removeUnmounted:M,_updateFieldArray:w,_updateDisabledField:de,_getFieldArray:re,_reset:L,_resetDefaultValues:()=>ps(r.defaultValues)&&r.defaultValues().then(I=>{pt(I,r.resetOptions),h.state.next({isLoading:!1})}),_updateFormState:I=>{n={...n,...I}},_subjects:h,_proxyFormState:f,get _fields(){return i},get _formValues(){return a},get _state(){return o},set _state(I){o=I},get _defaultValues(){return s},get _names(){return l},set _names(I){l=I},get _formState(){return n},set _formState(I){n=I},get _options(){return r},set _options(I){r={...r,...I}}},trigger:ce,register:xe,handleSubmit:ae,watch:V,setValue:te,getValues:Ee,reset:pt,resetField:He,clearErrors:H,unregister:J,setError:B,setFocus:(I,W={})=>{const Y=ve(i,I),we=Y&&Y._f;if(we){const pe=we.refs?we.refs[0]:we.ref;pe.focus&&(pe.focus(),W.shouldSelect&&pe.select())}},getFieldState:F}}function yd(e={}){const t=Se.useRef(),r=Se.useRef(),[n,i]=Se.useState({isDirty:!1,isValidating:!1,isLoading:ps(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},defaultValues:ps(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...g9(e,()=>i(a=>({...a}))),formState:n});const s=t.current.control;return s._options=e,xd({subject:s._subjects.state,next:a=>{UI(a,s._proxyFormState,s._updateFormState,!0)&&i({...s._formState})}}),Se.useEffect(()=>{e.values&&!ca(e.values,r.current)?(s._reset(e.values,s._options.resetOptions),r.current=e.values):s._resetDefaultValues()},[e.values,s]),Se.useEffect(()=>{s._state.mount||(s._updateValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),t.current.formState=BI(n,s),t.current}const v9=e=>{console.log(e.code);const t=e.code;return t==="auth/invalid-login-credentials"?"Verifique que su usuario y/o contraseña sean correctos.":t==="auth/too-many-requests"?"Se han realizado demasiados intentos fállidos.":"Ha ocurrido un error en el inicio de sesión."};function _9(){const[e,t]=ee.useState(""),{control:r,handleSubmit:n,formState:{errors:i}}=yd(),s=Qn(),a=async o=>{try{await H5(o.email,o.password),localStorage.setItem("userEmail",o.email),s("/home")}catch(l){const c=v9(l);t(c)}};return N.jsx("section",{id:"login",className:"d-flex align-items-center justify-content-center bg-white",style:{height:"100vh"},children:N.jsxs("div",{className:"container p-5 text-center bg-light shadow-sm rounded border",style:{maxWidth:"500px"},children:[N.jsx("h2",{children:"PORTAL IMPACTO"}),N.jsxs("form",{onSubmit:n(a),children:[N.jsxs("div",{className:"form-group",children:[N.jsx(gi,{name:"email",control:r,defaultValue:"",rules:{required:"Ingrese su correo electrónico"},render:({field:o})=>N.jsx("input",{type:"email",...o,className:"form-control mt-5 mb-5 bg-white",placeholder:"E-mail",autoComplete:"email"})}),i.email&&N.jsx("span",{className:"text-danger",children:i.email.message})]}),N.jsxs("div",{className:"form-group",children:[N.jsx(gi,{name:"password",control:r,defaultValue:"",rules:{required:"Ingrese su contraseña"},render:({field:o})=>N.jsx("input",{type:"password",...o,className:"form-control mb-5 col-8 bg-white",placeholder:"Contraseña",autoComplete:"current-password"})}),i.password&&N.jsx("span",{className:"text-danger",children:i.password.message})]}),e&&N.jsx("span",{className:"text-danger",children:e}),N.jsx("div",{className:"form-group",children:N.jsx("button",{type:"submit",className:"btn btn-dark btn-block w-100",children:"INGRESAR"})})]})]})})}function Ed(){const e=Qn(),t=async()=>{try{await W5(),localStorage.removeItem("userEmail"),e("/login")}catch(r){console.log(r)}};return N.jsx("nav",{className:"navbar navbar-expand-md navbar-dark",style:{backgroundColor:"#4b4a4a"},children:N.jsxs("div",{className:"container-fluid",children:[N.jsx("a",{className:"navbar-brand",children:"PORTAL IMPACTO"}),N.jsx("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation",children:N.jsx("span",{className:"navbar-toggler-icon"})}),N.jsx("div",{className:"collapse navbar-collapse justify-content-end",id:"navbarNav",children:N.jsx("ul",{className:"navbar-nav",children:N.jsx("li",{className:"nav-item",children:N.jsxs("button",{type:"button",className:"btn text-white",onClick:t,children:["CERRAR SESIÓN",N.jsx("i",{className:"bi bi-box-arrow-right",style:{fontSize:"24px",marginLeft:"8px"}})]})})})})]})})}var QI={exports:{}},x9="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",y9=x9,E9=y9;function JI(){}function ZI(){}ZI.resetWarningCache=JI;var w9=function(){function e(n,i,s,a,o,l){if(l!==E9){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:ZI,resetWarningCache:JI};return r.PropTypes=r,r};QI.exports=w9();var T9=QI.exports;const cn=jw(T9);function ju({onClick:e,text:t,icon:r,marginClassName:n,btnClassName:i}){return N.jsxs("button",{type:"button",className:`btn ${i} ${n}`,onClick:e,children:[t," ",r&&N.jsx("i",{className:`bi ${r}`,style:{marginLeft:"4px"}})]})}ju.propTypes={text:cn.string.isRequired,icon:cn.string,marginClassName:cn.string,btnClassName:cn.string,onClick:cn.func.isRequired};function eC({handleFilterChange:e}){return N.jsx(N.Fragment,{children:N.jsxs("form",{className:"row gx-3 gy-1 align-items-center",children:[N.jsxs("div",{className:"col-sm-1",children:[N.jsx("label",{className:"visually-hidden",htmlFor:"week-input",children:"Sem"}),N.jsx("input",{type:"text",className:"form-control",id:"week-input",placeholder:"Sem",onChange:t=>e("week_name",t.target.value)})]}),N.jsxs("div",{className:"col-sm-2",children:[N.jsx("label",{className:"visually-hidden",htmlFor:"vulnerability-input",children:"Vulnerabilidad"}),N.jsx("input",{type:"text",className:"form-control",id:"vulnerability-input",placeholder:"Vulnerabilidad",onChange:t=>e("vulnerabilidad_1",t.target.value)})]}),N.jsxs("div",{className:"col-sm-2",children:[N.jsx("label",{className:"visually-hidden",htmlFor:"technical-unit-input",children:"Unidad Técnica"}),N.jsx("input",{type:"text",className:"form-control",id:"technical-unit-input",placeholder:"Unidad Técnica",onChange:t=>e("u_tecnica",t.target.value)})]}),N.jsxs("div",{className:"col-sm-2",children:[N.jsx("label",{className:"visually-hidden",htmlFor:"equipment-system-input",children:"Equipo Sistema"}),N.jsx("input",{type:"text",className:"form-control",id:"equipment-system-input",placeholder:"Equipo Sistema",onChange:t=>e("equipo_o_sistema",t.target.value)})]}),N.jsxs("div",{className:"col-sm-2",children:[N.jsx("label",{className:"visually-hidden",htmlFor:"description",children:"Descripción"}),N.jsx("input",{type:"text",className:"form-control",id:"description",placeholder:"Descripción",onChange:t=>e("description",t.target.value)})]}),N.jsxs("div",{className:"col-sm-2",children:[N.jsx("label",{className:"visually-hidden",htmlFor:"impacto_status",children:"Estado"}),N.jsx("input",{type:"text",className:"form-control",id:"impacto_status",placeholder:"Estado",onChange:t=>e("impacto_status",t.target.value)})]})]})})}eC.propTypes={handleFilterChange:cn.func.isRequired};function Af(e=""){return e.replace(/[^\p{L}\d\s]/gu,"").normalize("NFD").replace(/\p{Diacritic}/gu,"")}function tC({currentPage:e,totalPages:t,handlePageChange:r}){return N.jsx("div",{className:"d-flex justify-content-center",children:N.jsx("ul",{className:"pagination",children:Array(t).fill(0).map((n,i)=>N.jsx("li",{className:`page-item ${i+1===e?"active":""}`,children:N.jsx("button",{className:"page-link",onClick:()=>r(i+1),children:i+1})},i))})})}tC.propTypes={currentPage:cn.number.isRequired,totalPages:cn.number.isRequired,handlePageChange:cn.func.isRequired};function c_(){return N.jsx("div",{className:"d-flex justify-content-center",children:N.jsx("div",{className:"spinner-border text-secondary",role:"status",children:N.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}function rC({filters:e}){const[t,r]=ee.useState([]),[n,i]=ee.useState(1),[s,a]=ee.useState(!0),o=20,l=h=>{h>0&&h<=u&&i(h)};ee.useEffect(()=>{Object.values(e).some(h=>h!=="")&&i(1)},[e]),ee.useEffect(()=>{(async()=>{try{const d=(n-1)*o,m=(await q5({limit:o,offset:d})).map(v=>({id:v.id,...v.data}));r(m),a(!1)}catch(d){console.error("Error al obtener documentos: ",d)}})()},[n,o,e]);const c=t.filter(h=>Object.keys(e).every(d=>{const p=Af(e[d]).toLowerCase(),m=Af(h[d]).toLowerCase();if(d==="week_name"&&p){if(m.slice(-2)!==p)return!1}else if(d==="description"&&p){if(!((Af(h.descripcion_del_trabajo)||"N/A")+(Af(h.descripcion_del_aviso)||"N/A")).toLowerCase().includes(p))return!1}else if(p&&m&&!m.includes(p))return!1;return!0})),u=Math.ceil(c.length/o),f=c.slice((n-1)*o,n*o);return N.jsxs(N.Fragment,{children:[s?N.jsx(c_,{}):N.jsx("div",{className:"table-responsive-xxl",children:N.jsxs("table",{className:"table table-hover",children:[N.jsx("thead",{className:"table-secondary",children:N.jsxs("tr",{className:"align-middle",children:[N.jsx("th",{scope:"col",children:"N°"}),N.jsx("th",{scope:"col",children:"Sem"}),N.jsx("th",{scope:"col",children:"Vulnerabilidad"}),N.jsx("th",{scope:"col",children:"Unidad Técnica"}),N.jsx("th",{scope:"col",children:"Equipo Sistema"}),N.jsx("th",{scope:"col",children:"Descripción del trabajo"}),N.jsx("th",{scope:"col",children:"Descripción del aviso"}),N.jsx("th",{scope:"col",children:"Estado Impacto"}),N.jsx("th",{scope:"col",children:"Estado Final"}),N.jsx("th",{scope:"col",colSpan:"3",className:"text-center",children:"Acciones"})]})}),N.jsx("tbody",{children:f.map((h,d)=>{const p=(n-1)*o+d+1;return N.jsxs("tr",{children:[N.jsx("td",{children:p}),N.jsx("td",{children:h.week_name.slice(-2)||"N/A"}),N.jsx("td",{children:h.vulnerabilidad_1||"N/A"}),N.jsx("td",{children:h.u_tecnica||"N/A"}),N.jsx("td",{children:h.equipo_o_sistema||"N/A"}),N.jsx("td",{children:h.descripcion_del_trabajo||"N/A"}),N.jsx("td",{children:h.descripcion_del_aviso||"N/A"}),N.jsx("td",{children:h.impacto_status}),N.jsx("td",{children:"documento"}),N.jsx("td",{children:N.jsx(np,{to:`/update-status/${h.id}`,children:"E.I"})}),N.jsx("td",{children:N.jsx(np,{to:`/enter-record/${h.id}`,children:"I.R."})}),N.jsx("td",{children:N.jsx(np,{to:`/view-dossier/${h.id}`,children:"V.D."})})]},d)})})]})}),N.jsx(tC,{currentPage:n,totalPages:u,handlePageChange:l})]})}rC.propTypes={filters:cn.object};function k9(){const e=Qn(),[t,r]=ee.useState({week:"",vulnerability:"",technicalUnit:"",equipmentSystem:"",description:"",impactoStatus:""}),n=(s,a)=>{r({...t,[s]:a})},i=()=>{e("/upload-priorization")};return N.jsx(N.Fragment,{children:N.jsxs("section",{id:"priorization",children:[N.jsx("h1",{className:"my-2 text-center mt-3",children:"PRIORIZACIÓN"}),N.jsx("div",{className:"row",children:N.jsx("div",{className:"col text-start mb-3",children:N.jsx(ju,{text:"CARGAR PRIORIZACIÓN",icon:"bi bi-plus-lg",btnClassName:"btn-dark",onClick:i})})}),N.jsx("div",{className:"row mb-3",children:N.jsx("div",{className:"col",children:N.jsx(eC,{filters:t,handleFilterChange:n})})}),N.jsx(rC,{filters:t})]})})}function A9(){return N.jsxs(N.Fragment,{children:[N.jsx(Ed,{}),N.jsx("div",{className:"container",children:N.jsx(k9,{})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var nC=1252,S9=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],u_={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},f_=function(e){S9.indexOf(e)!=-1&&(nC=u_[0]=e)};function I9(){f_(1252)}var jn=function(e){f_(e)};function iC(){jn(1200),I9()}function ME(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function C9(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function sC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var jl=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?C9(e.slice(2)):t==254&&r==255?sC(e.slice(2)):t==65279?e.slice(1):e},Sf=function(t){return String.fromCharCode(t)},bE=function(t){return String.fromCharCode(t)},os,ms="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function VE(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),a=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=ms.charAt(s)+ms.charAt(a)+ms.charAt(o)+ms.charAt(l);return t}function _n(e){var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=ms.indexOf(e.charAt(c++)),a=ms.indexOf(e.charAt(c++)),r=s<<2|a>>4,t+=String.fromCharCode(r),o=ms.indexOf(e.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=ms.indexOf(e.charAt(c++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var Ke=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),$a=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Vs(e){return Ke?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function BE(e){return Ke?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var $n=function(t){return Ke?$a(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function ja(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function h_(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return h_(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ls=Ke?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:$a(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function R9(e){for(var t=[],r=0,n=e.length+250,i=Vs(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Vs(65535),n=65530)}return t.push(i.slice(0,r)),ls(t)}var Hr=/\u0000/g,zl=/[\u0001-\u0006]/g;function Ro(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function zn(e,t){var r=""+e;return r.length>=t?r:St("0",t-r.length)+r}function d_(e,t){var r=""+e;return r.length>=t?r:St(" ",t-r.length)+r}function l0(e,t){var r=""+e;return r.length>=t?r:r+St(" ",t-r.length)}function P9(e,t){var r=""+Math.round(e);return r.length>=t?r:St("0",t-r.length)+r}function F9(e,t){var r=""+e;return r.length>=t?r:St("0",t-r.length)+r}var UE=Math.pow(2,32);function Ya(e,t){if(e>UE||e<-UE)return P9(e,t);var r=Math.round(e);return F9(r,t)}function c0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var $E=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],bp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function N9(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var be={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},jE={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},D9={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function u0(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,a=1,o=0,l=1,c=0,u=0,f=Math.floor(i);c<t&&(f=Math.floor(i),o=f*a+s,u=f*c+l,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=a)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function ua(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,a=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=B9(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var aC=new Date(1899,11,31,0,0,0),O9=aC.getTime(),L9=new Date(1900,2,1,0,0,0);function oC(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=L9&&(r+=24*60*60*1e3),(r-(O9+(e.getTimezoneOffset()-aC.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function p_(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function M9(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function b9(e){var t=e<0?12:11,r=p_(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function V9(e){var t=p_(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function nu(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=b9(e):t===10?r=e.toFixed(10).substr(0,12):r=V9(e),p_(M9(r.toUpperCase()))}function Pa(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):nu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Dn(14,oC(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function B9(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function U9(e,t,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return bp[r.m-1][1];case 5:return bp[r.m-1][0];default:return bp[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return $E[r.q][0];default:return $E[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?zn(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=zn(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?zn(l,c):"";return u}function gs(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var lC=/%/g;function $9(e,t,r){var n=t.replace(lC,""),i=t.length-n.length;return Oi(e,n,r*Math.pow(10,2*i))+St("%",i)}function j9(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Oi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function cC(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+cC(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var uC=/# (\?+)( ?)\/( ?)(\d+)/;function z9(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?St(" ",e[1].length+1+e[4].length):d_(a,e[1].length)+e[2]+"/"+e[3]+zn(o,e[4].length))}function H9(e,t,r){return r+(t===0?"":""+t)+St(" ",e[1].length+2+e[4].length)}var fC=/^#*0*\.([0#]+)/,hC=/\).*[0#]/,dC=/\(###\) ###\\?-####/;function Br(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function zE(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function HE(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function W9(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function G9(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function wn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(hC)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?wn("n",n,r):"("+wn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return j9(e,t,r);if(t.indexOf("%")!==-1)return $9(e,t,r);if(t.indexOf("E")!==-1)return cC(t,r);if(t.charCodeAt(0)===36)return"$"+wn(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Ya(l,t.length);if(t.match(/^[#?]+$/))return i=Ya(r,0),i==="0"&&(i=""),i.length>t.length?i:Br(t.substr(0,t.length-i.length))+i;if(s=t.match(uC))return z9(s,l,c);if(t.match(/^#+0+$/))return c+Ya(l,t.length-t.indexOf("0"));if(s=t.match(fC))return i=zE(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Br(s[1])).replace(/\.$/,"."+Br(s[1])).replace(/\.(\d*)$/,function(p,m){return"."+m+St("0",Br(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+zE(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+gs(Ya(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+wn(e,t,-r):gs(""+(Math.floor(r)+W9(r,s[1].length)))+"."+zn(HE(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return wn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ro(wn(e,t.replace(/[\\-]/g,""),r)),a=0,Ro(Ro(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<i.length?i.charAt(a++):p==="0"?"0":""}));if(t.match(dC))return i=wn(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=u0(l,Math.pow(10,a)-1,!1),i=""+c,u=Oi("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=l0(o[2],a),u.length<s[4].length&&(u=Br(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=u0(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?d_(o[1],a)+s[2]+"/"+s[3]+l0(o[2],a):St(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=Ya(r,0),t.length<=i.length?i:Br(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=t.indexOf(".")-a,h=t.length-i.length-f;return Br(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=HE(r,s[1].length),r<0?"-"+wn(e,t,-r):gs(G9(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?zn(0,3-p.length):"")+p})+"."+zn(a,s[1].length);switch(t){case"###,##0.00":return wn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=gs(Ya(l,0));return d!=="0"?c+d:"";case"###,###.00":return wn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return wn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function K9(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Oi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function q9(e,t,r){var n=t.replace(lC,""),i=t.length-n.length;return Oi(e,n,r*Math.pow(10,2*i))+St("%",i)}function pC(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+pC(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ei(e,t,r){if(e.charCodeAt(0)===40&&!t.match(hC)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ei("n",n,r):"("+ei("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return K9(e,t,r);if(t.indexOf("%")!==-1)return q9(e,t,r);if(t.indexOf("E")!==-1)return pC(t,r);if(t.charCodeAt(0)===36)return"$"+ei(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+zn(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Br(t.substr(0,t.length-i.length))+i;if(s=t.match(uC))return H9(s,l,c);if(t.match(/^#+0+$/))return c+zn(l,t.length-t.indexOf("0"));if(s=t.match(fC))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Br(s[1])).replace(/\.$/,"."+Br(s[1])),i=i.replace(/\.(\d*)$/,function(p,m){return"."+m+St("0",Br(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+gs(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ei(e,t,-r):gs(""+r)+"."+St("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ei(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ro(ei(e,t.replace(/[\\-]/g,""),r)),a=0,Ro(Ro(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<i.length?i.charAt(a++):p==="0"?"0":""}));if(t.match(dC))return i=ei(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=u0(l,Math.pow(10,a)-1,!1),i=""+c,u=Oi("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=l0(o[2],a),u.length<s[4].length&&(u=Br(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=u0(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?d_(o[1],a)+s[2]+"/"+s[3]+l0(o[2],a):St(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Br(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=t.indexOf(".")-a,h=t.length-i.length-f;return Br(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ei(e,t,-r):gs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?zn(0,3-p.length):"")+p})+"."+zn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=gs(""+l);return d!=="0"?c+d:"";default:if(t.match(/\.[0#?]*$/))return ei(e,t.slice(0,t.lastIndexOf(".")),r)+Br(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Oi(e,t,r){return(r|0)===r?ei(e,t,r):wn(e,t,r)}function X9(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var mC=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function hl(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":c0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(mC))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Y9(e,t,r,n){for(var i=[],s="",a=0,o="",l="t",c,u,f,h="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!c0(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var d=e.charAt(++a),p=d==="("||d===")"?d:"t";i[i.length]={t:p,v:d},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(c==null&&(c=ua(t,r,e.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=ua(t,r),c==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"上":var m={t:o,v:o};if(c==null&&(c=ua(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",h="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",a+=5,h="h"):e.substr(a,5).toUpperCase()==="上午/下午"?(c!=null&&(m.v=c.H>=12?"下午":"上午"),m.t="T",a+=5,h="h"):(m.t="t",++a),c==null&&m.t==="T")return"";i[i.length]=m,l=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(mC)){if(c==null&&(c=ua(t,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",hl(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var v=0,x=0,_;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=h,l="h",v<1&&(v=1);break;case"s":(_=i[a].v.match(/\.0+$/))&&(x=Math.max(x,_[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&i[a].v.match(/[Hh]/)&&(v=1),v<2&&i[a].v.match(/[Mm]/)&&(v=2),v<3&&i[a].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var g="",w;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=U9(i[a].t.charCodeAt(0),i[a].v,c,x),i[a].t="t";break;case"n":case"?":for(w=a+1;i[w]!=null&&((o=i[w].t)==="?"||o==="D"||(o===" "||o==="t")&&i[w+1]!=null&&(i[w+1].t==="?"||i[w+1].t==="t"&&i[w+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[w].v==="/"||i[w].v===" "&&i[w+1]!=null&&i[w+1].t=="?"));)i[a].v+=i[w].v,i[w]={v:"",t:";"},++w;g+=i[a].v,a=w-1;break;case"G":i[a].t="t",i[a].v=Pa(t,r);break}var T="",k,y;if(g.length>0){g.charCodeAt(0)==40?(k=t<0&&g.charCodeAt(0)===45?-t:t,y=Oi("n",g,k)):(k=t<0&&n>1?-t:t,y=Oi("n",g,k),k<0&&i[0]&&i[0].t=="t"&&(y=y.substr(1),i[0].v="-"+i[0].v)),w=y.length-1;var P=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){P=a;break}var O=i.length;if(P===i.length&&y.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(w>=i[a].v.length-1?(w-=i[a].v.length,i[a].v=y.substr(w+1,i[a].v.length)):w<0?i[a].v="":(i[a].v=y.substr(0,w+1),w=-1),i[a].t="t",O=a);w>=0&&O<i.length&&(i[O].v=y.substr(0,w+1)+i[O].v)}else if(P!==i.length&&y.indexOf("E")===-1){for(w=y.indexOf(".")-1,a=P;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(u=i[a].v.indexOf(".")>-1&&a===P?i[a].v.indexOf(".")-1:i[a].v.length-1,T=i[a].v.substr(u+1);u>=0;--u)w>=0&&(i[a].v.charAt(u)==="0"||i[a].v.charAt(u)==="#")&&(T=y.charAt(w--)+T);i[a].v=T,i[a].t="t",O=a}for(w>=0&&O<i.length&&(i[O].v=y.substr(0,w+1)+i[O].v),w=y.indexOf(".")+1,a=P;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==P)){for(u=i[a].v.indexOf(".")>-1&&a===P?i[a].v.indexOf(".")+1:0,T=i[a].v.substr(0,u);u<i[a].v.length;++u)w<y.length&&(T+=y.charAt(w++));i[a].v=T,i[a].t="t",O=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(k=n>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=Oi(i[a].t,i[a].v,k),i[a].t="t");var U="";for(a=0;a!==i.length;++a)i[a]!=null&&(U+=i[a].v);return U}var WE=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function GE(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Q9(e,t){var r=X9(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(WE),o=r[1].match(WE);return GE(t,a)?[n,r[0]]:GE(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Dn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:be)[e],n==null&&(n=r.table&&r.table[jE[e]]||be[jE[e]]),n==null&&(n=D9[e]||"General");break}if(c0(n,0))return Pa(t,r);t instanceof Date&&(t=oC(t,r.date1904));var i=Q9(n,t);if(c0(i[1]))return Pa(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Y9(i[1],t,r,i[0])}function ga(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(be[r]==null){t<0&&(t=r);continue}if(be[r]==e){t=r;break}}t<0&&(t=391)}return be[t]=e,t}function gC(){be=N9()}var J9={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},vC=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Z9(e){var t=typeof e=="number"?be[e]:e;return t=t.replace(vC,"(\\d+)"),new RegExp("^"+t+"$")}function eV(e,t,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(t.match(vC)||[]).forEach(function(f,h){var d=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=d;break;case"d":s=d;break;case"h":a=d;break;case"s":l=d;break;case"m":a>=0?o=d:i=d;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?u:c+"T"+u}var tV=function(){var e={};e.version="1.2.0";function t(){for(var y=0,P=new Array(256),O=0;O!=256;++O)y=O,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,P[O]=y;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function n(y){var P=0,O=0,U=0,j=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)j[U]=y[U];for(U=0;U!=256;++U)for(O=y[U],P=256+U;P<4096;P+=256)O=j[P]=O>>>8^y[O&255];var M=[];for(U=1;U!=16;++U)M[U-1]=typeof Int32Array<"u"?j.subarray(U*256,U*256+256):j.slice(U*256,U*256+256);return M}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],f=i[6],h=i[7],d=i[8],p=i[9],m=i[10],v=i[11],x=i[12],_=i[13],g=i[14];function w(y,P){for(var O=P^-1,U=0,j=y.length;U<j;)O=O>>>8^r[(O^y.charCodeAt(U++))&255];return~O}function T(y,P){for(var O=P^-1,U=y.length-15,j=0;j<U;)O=g[y[j++]^O&255]^_[y[j++]^O>>8&255]^x[y[j++]^O>>16&255]^v[y[j++]^O>>>24]^m[y[j++]]^p[y[j++]]^d[y[j++]]^h[y[j++]]^f[y[j++]]^u[y[j++]]^c[y[j++]]^l[y[j++]]^o[y[j++]]^a[y[j++]]^s[y[j++]]^r[y[j++]];for(U+=15;j<U;)O=O>>>8^r[(O^y[j++])&255];return~O}function k(y,P){for(var O=P^-1,U=0,j=y.length,M=0,X=0;U<j;)M=y.charCodeAt(U++),M<128?O=O>>>8^r[(O^M)&255]:M<2048?(O=O>>>8^r[(O^(192|M>>6&31))&255],O=O>>>8^r[(O^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,X=y.charCodeAt(U++)&1023,O=O>>>8^r[(O^(240|M>>8&7))&255],O=O>>>8^r[(O^(128|M>>2&63))&255],O=O>>>8^r[(O^(128|X>>6&15|(M&3)<<4))&255],O=O>>>8^r[(O^(128|X&63))&255]):(O=O>>>8^r[(O^(224|M>>12&15))&255],O=O>>>8^r[(O^(128|M>>6&63))&255],O=O>>>8^r[(O^(128|M&63))&255]);return~O}return e.table=r,e.bstr=w,e.buf=T,e.str=k,e}(),Xe=function(){var t={};t.version="1.2.1";function r(E,C){for(var A=E.split("/"),S=C.split("/"),R=0,D=0,G=Math.min(A.length,S.length);R<G;++R){if(D=A[R].length-S[R].length)return D;if(A[R]!=S[R])return A[R]<S[R]?-1:1}return A.length-S.length}function n(E){if(E.charAt(E.length-1)=="/")return E.slice(0,-1).indexOf("/")===-1?E:n(E.slice(0,-1));var C=E.lastIndexOf("/");return C===-1?E:E.slice(0,C+1)}function i(E){if(E.charAt(E.length-1)=="/")return i(E.slice(0,-1));var C=E.lastIndexOf("/");return C===-1?E:E.slice(C+1)}function s(E,C){typeof C=="string"&&(C=new Date(C));var A=C.getHours();A=A<<6|C.getMinutes(),A=A<<5|C.getSeconds()>>>1,E.write_shift(2,A);var S=C.getFullYear()-1980;S=S<<4|C.getMonth()+1,S=S<<5|C.getDate(),E.write_shift(2,S)}function a(E){var C=E.read_shift(2)&65535,A=E.read_shift(2)&65535,S=new Date,R=A&31;A>>>=5;var D=A&15;A>>>=4,S.setMilliseconds(0),S.setFullYear(A+1980),S.setMonth(D-1),S.setDate(R);var G=C&31;C>>>=5;var Q=C&63;return C>>>=6,S.setHours(C),S.setMinutes(Q),S.setSeconds(G<<1),S}function o(E){ar(E,0);for(var C={},A=0;E.l<=E.length-4;){var S=E.read_shift(2),R=E.read_shift(2),D=E.l+R,G={};switch(S){case 21589:A=E.read_shift(1),A&1&&(G.mtime=E.read_shift(4)),R>5&&(A&2&&(G.atime=E.read_shift(4)),A&4&&(G.ctime=E.read_shift(4))),G.mtime&&(G.mt=new Date(G.mtime*1e3));break}E.l=D,C[S]=G}return C}var l;function c(){return l||(l={})}function u(E,C){if(E[0]==80&&E[1]==75)return U_(E,C);if((E[0]|32)==109&&(E[1]|32)==105)return ZR(E,C);if(E.length<512)throw new Error("CFB file size "+E.length+" < 512");var A=3,S=512,R=0,D=0,G=0,Q=0,z=0,K=[],q=E.slice(0,512);ar(q,0);var oe=f(q);switch(A=oe[0],A){case 3:S=512;break;case 4:S=4096;break;case 0:if(oe[1]==0)return U_(E,C);default:throw new Error("Major Version: Expected 3 or 4 saw "+A)}S!==512&&(q=E.slice(0,S),ar(q,28));var ge=E.slice(0,S);h(q,A);var ke=q.read_shift(4,"i");if(A===3&&ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ke);q.l+=4,G=q.read_shift(4,"i"),q.l+=4,q.chk("00100000","Mini Stream Cutoff Size: "),Q=q.read_shift(4,"i"),R=q.read_shift(4,"i"),z=q.read_shift(4,"i"),D=q.read_shift(4,"i");for(var he=-1,ye=0;ye<109&&(he=q.read_shift(4,"i"),!(he<0));++ye)K[ye]=he;var Me=d(E,S);v(z,D,Me,S,K);var _t=_(Me,G,K,S);_t[G].name="!Directory",R>0&&Q!==X&&(_t[Q].name="!MiniFAT"),_t[K[0]].name="!FAT",_t.fat_addrs=K,_t.ssz=S;var xt={},mr=[],ml=[],gl=[];g(G,_t,Me,mr,R,xt,ml,Q),p(ml,gl,mr),mr.shift();var vl={FileIndex:ml,FullPaths:gl};return C&&C.raw&&(vl.raw={header:ge,sectors:Me}),vl}function f(E){if(E[E.l]==80&&E[E.l+1]==75)return[0,0];E.chk(ne,"Header Signature: "),E.l+=16;var C=E.read_shift(2,"u");return[E.read_shift(2,"u"),C]}function h(E,C){var A=9;switch(E.l+=2,A=E.read_shift(2)){case 9:if(C!=3)throw new Error("Sector Shift: Expected 9 saw "+A);break;case 12:if(C!=4)throw new Error("Sector Shift: Expected 12 saw "+A);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+A)}E.chk("0600","Mini Sector Shift: "),E.chk("000000000000","Reserved: ")}function d(E,C){for(var A=Math.ceil(E.length/C)-1,S=[],R=1;R<A;++R)S[R-1]=E.slice(R*C,(R+1)*C);return S[A-1]=E.slice(A*C),S}function p(E,C,A){for(var S=0,R=0,D=0,G=0,Q=0,z=A.length,K=[],q=[];S<z;++S)K[S]=q[S]=S,C[S]=A[S];for(;Q<q.length;++Q)S=q[Q],R=E[S].L,D=E[S].R,G=E[S].C,K[S]===S&&(R!==-1&&K[R]!==R&&(K[S]=K[R]),D!==-1&&K[D]!==D&&(K[S]=K[D])),G!==-1&&(K[G]=S),R!==-1&&S!=K[S]&&(K[R]=K[S],q.lastIndexOf(R)<Q&&q.push(R)),D!==-1&&S!=K[S]&&(K[D]=K[S],q.lastIndexOf(D)<Q&&q.push(D));for(S=1;S<z;++S)K[S]===S&&(D!==-1&&K[D]!==D?K[S]=K[D]:R!==-1&&K[R]!==R&&(K[S]=K[R]));for(S=1;S<z;++S)if(E[S].type!==0){if(Q=S,Q!=K[Q])do Q=K[Q],C[S]=C[Q]+"/"+C[S];while(Q!==0&&K[Q]!==-1&&Q!=K[Q]);K[S]=-1}for(C[0]+="/",S=1;S<z;++S)E[S].type!==2&&(C[S]+="/")}function m(E,C,A){for(var S=E.start,R=E.size,D=[],G=S;A&&R>0&&G>=0;)D.push(C.slice(G*M,G*M+M)),R-=M,G=ra(A,G*4);return D.length===0?zt(0):ls(D).slice(0,E.size)}function v(E,C,A,S,R){var D=X;if(E===X){if(C!==0)throw new Error("DIFAT chain shorter than expected")}else if(E!==-1){var G=A[E],Q=(S>>>2)-1;if(!G)return;for(var z=0;z<Q&&(D=ra(G,z*4))!==X;++z)R.push(D);v(ra(G,S-4),C-1,A,S,R)}}function x(E,C,A,S,R){var D=[],G=[];R||(R=[]);var Q=S-1,z=0,K=0;for(z=C;z>=0;){R[z]=!0,D[D.length]=z,G.push(E[z]);var q=A[Math.floor(z*4/S)];if(K=z*4&Q,S<4+K)throw new Error("FAT boundary crossed: "+z+" 4 "+S);if(!E[q])break;z=ra(E[q],K)}return{nodes:D,data:rw([G])}}function _(E,C,A,S){var R=E.length,D=[],G=[],Q=[],z=[],K=S-1,q=0,oe=0,ge=0,ke=0;for(q=0;q<R;++q)if(Q=[],ge=q+C,ge>=R&&(ge-=R),!G[ge]){z=[];var he=[];for(oe=ge;oe>=0;){he[oe]=!0,G[oe]=!0,Q[Q.length]=oe,z.push(E[oe]);var ye=A[Math.floor(oe*4/S)];if(ke=oe*4&K,S<4+ke)throw new Error("FAT boundary crossed: "+oe+" 4 "+S);if(!E[ye]||(oe=ra(E[ye],ke),he[oe]))break}D[ge]={nodes:Q,data:rw([z])}}return D}function g(E,C,A,S,R,D,G,Q){for(var z=0,K=S.length?2:0,q=C[E].data,oe=0,ge=0,ke;oe<q.length;oe+=128){var he=q.slice(oe,oe+128);ar(he,64),ge=he.read_shift(2),ke=x_(he,0,ge-K),S.push(ke);var ye={name:ke,type:he.read_shift(1),color:he.read_shift(1),L:he.read_shift(4,"i"),R:he.read_shift(4,"i"),C:he.read_shift(4,"i"),clsid:he.read_shift(16),state:he.read_shift(4,"i"),start:0,size:0},Me=he.read_shift(2)+he.read_shift(2)+he.read_shift(2)+he.read_shift(2);Me!==0&&(ye.ct=w(he,he.l-8));var _t=he.read_shift(2)+he.read_shift(2)+he.read_shift(2)+he.read_shift(2);_t!==0&&(ye.mt=w(he,he.l-8)),ye.start=he.read_shift(4,"i"),ye.size=he.read_shift(4,"i"),ye.size<0&&ye.start<0&&(ye.size=ye.type=0,ye.start=X,ye.name=""),ye.type===5?(z=ye.start,R>0&&z!==X&&(C[z].name="!StreamData")):ye.size>=4096?(ye.storage="fat",C[ye.start]===void 0&&(C[ye.start]=x(A,ye.start,C.fat_addrs,C.ssz)),C[ye.start].name=ye.name,ye.content=C[ye.start].data.slice(0,ye.size)):(ye.storage="minifat",ye.size<0?ye.size=0:z!==X&&ye.start!==X&&C[z]&&(ye.content=m(ye,C[z].data,(C[Q]||{}).data))),ye.content&&ar(ye.content,0),D[ke]=ye,G.push(ye)}}function w(E,C){return new Date((ln(E,C+4)/1e7*Math.pow(2,32)+ln(E,C)/1e7-11644473600)*1e3)}function T(E,C){return c(),u(l.readFileSync(E),C)}function k(E,C){var A=C&&C.type;switch(A||Ke&&Buffer.isBuffer(E)&&(A="buffer"),A||"base64"){case"file":return T(E,C);case"base64":return u($n(_n(E)),C);case"binary":return u($n(E),C)}return u(E,C)}function y(E,C){var A=C||{},S=A.root||"Root Entry";if(E.FullPaths||(E.FullPaths=[]),E.FileIndex||(E.FileIndex=[]),E.FullPaths.length!==E.FileIndex.length)throw new Error("inconsistent CFB structure");E.FullPaths.length===0&&(E.FullPaths[0]=S+"/",E.FileIndex[0]={name:S,type:5}),A.CLSID&&(E.FileIndex[0].clsid=A.CLSID),P(E)}function P(E){var C="Sh33tJ5";if(!Xe.find(E,"/"+C)){var A=zt(4);A[0]=55,A[1]=A[3]=50,A[2]=54,E.FileIndex.push({name:C,type:2,content:A,size:4,L:69,R:69,C:69}),E.FullPaths.push(E.FullPaths[0]+C),O(E)}}function O(E,C){y(E);for(var A=!1,S=!1,R=E.FullPaths.length-1;R>=0;--R){var D=E.FileIndex[R];switch(D.type){case 0:S?A=!0:(E.FileIndex.pop(),E.FullPaths.pop());break;case 1:case 2:case 5:S=!0,isNaN(D.R*D.L*D.C)&&(A=!0),D.R>-1&&D.L>-1&&D.R==D.L&&(A=!0);break;default:A=!0;break}}if(!(!A&&!C)){var G=new Date(1987,1,19),Q=0,z=Object.create?Object.create(null):{},K=[];for(R=0;R<E.FullPaths.length;++R)z[E.FullPaths[R]]=!0,E.FileIndex[R].type!==0&&K.push([E.FullPaths[R],E.FileIndex[R]]);for(R=0;R<K.length;++R){var q=n(K[R][0]);S=z[q],S||(K.push([q,{name:i(q).replace("/",""),type:1,clsid:se,ct:G,mt:G,content:null}]),z[q]=!0)}for(K.sort(function(ke,he){return r(ke[0],he[0])}),E.FullPaths=[],E.FileIndex=[],R=0;R<K.length;++R)E.FullPaths[R]=K[R][0],E.FileIndex[R]=K[R][1];for(R=0;R<K.length;++R){var oe=E.FileIndex[R],ge=E.FullPaths[R];if(oe.name=i(ge).replace("/",""),oe.L=oe.R=oe.C=-(oe.color=1),oe.size=oe.content?oe.content.length:0,oe.start=0,oe.clsid=oe.clsid||se,R===0)oe.C=K.length>1?1:-1,oe.size=0,oe.type=5;else if(ge.slice(-1)=="/"){for(Q=R+1;Q<K.length&&n(E.FullPaths[Q])!=ge;++Q);for(oe.C=Q>=K.length?-1:Q,Q=R+1;Q<K.length&&n(E.FullPaths[Q])!=n(ge);++Q);oe.R=Q>=K.length?-1:Q,oe.type=1}else n(E.FullPaths[R+1]||"")==n(ge)&&(oe.R=R+1),oe.type=2}}}function U(E,C){var A=C||{};if(A.fileType=="mad")return e4(E,A);switch(O(E),A.fileType){case"zip":return KR(E,A)}var S=function(ke){for(var he=0,ye=0,Me=0;Me<ke.FileIndex.length;++Me){var _t=ke.FileIndex[Me];if(_t.content){var xt=_t.content.length;xt>0&&(xt<4096?he+=xt+63>>6:ye+=xt+511>>9)}}for(var mr=ke.FullPaths.length+3>>2,ml=he+7>>3,gl=he+127>>7,vl=ml+ye+mr+gl,Ys=vl+127>>7,Rd=Ys<=109?0:Math.ceil((Ys-109)/127);vl+Ys+Rd+127>>7>Ys;)Rd=++Ys<=109?0:Math.ceil((Ys-109)/127);var wi=[1,Rd,Ys,gl,mr,ye,he,0];return ke.FileIndex[0].size=he<<6,wi[7]=(ke.FileIndex[0].start=wi[0]+wi[1]+wi[2]+wi[3]+wi[4]+wi[5])+(wi[6]+7>>3),wi}(E),R=zt(S[7]<<9),D=0,G=0;{for(D=0;D<8;++D)R.write_shift(1,re[D]);for(D=0;D<8;++D)R.write_shift(2,0);for(R.write_shift(2,62),R.write_shift(2,3),R.write_shift(2,65534),R.write_shift(2,9),R.write_shift(2,6),D=0;D<3;++D)R.write_shift(2,0);for(R.write_shift(4,0),R.write_shift(4,S[2]),R.write_shift(4,S[0]+S[1]+S[2]+S[3]-1),R.write_shift(4,0),R.write_shift(4,4096),R.write_shift(4,S[3]?S[0]+S[1]+S[2]-1:X),R.write_shift(4,S[3]),R.write_shift(-4,S[1]?S[0]-1:X),R.write_shift(4,S[1]),D=0;D<109;++D)R.write_shift(-4,D<S[2]?S[1]+D:-1)}if(S[1])for(G=0;G<S[1];++G){for(;D<236+G*127;++D)R.write_shift(-4,D<S[2]?S[1]+D:-1);R.write_shift(-4,G===S[1]-1?X:G+1)}var Q=function(ke){for(G+=ke;D<G-1;++D)R.write_shift(-4,D+1);ke&&(++D,R.write_shift(-4,X))};for(G=D=0,G+=S[1];D<G;++D)R.write_shift(-4,ue.DIFSECT);for(G+=S[2];D<G;++D)R.write_shift(-4,ue.FATSECT);Q(S[3]),Q(S[4]);for(var z=0,K=0,q=E.FileIndex[0];z<E.FileIndex.length;++z)q=E.FileIndex[z],q.content&&(K=q.content.length,!(K<4096)&&(q.start=G,Q(K+511>>9)));for(Q(S[6]+7>>3);R.l&511;)R.write_shift(-4,ue.ENDOFCHAIN);for(G=D=0,z=0;z<E.FileIndex.length;++z)q=E.FileIndex[z],q.content&&(K=q.content.length,!(!K||K>=4096)&&(q.start=G,Q(K+63>>6)));for(;R.l&511;)R.write_shift(-4,ue.ENDOFCHAIN);for(D=0;D<S[4]<<2;++D){var oe=E.FullPaths[D];if(!oe||oe.length===0){for(z=0;z<17;++z)R.write_shift(4,0);for(z=0;z<3;++z)R.write_shift(4,-1);for(z=0;z<12;++z)R.write_shift(4,0);continue}q=E.FileIndex[D],D===0&&(q.start=q.size?q.start-1:X);var ge=D===0&&A.root||q.name;if(K=2*(ge.length+1),R.write_shift(64,ge,"utf16le"),R.write_shift(2,K),R.write_shift(1,q.type),R.write_shift(1,q.color),R.write_shift(-4,q.L),R.write_shift(-4,q.R),R.write_shift(-4,q.C),q.clsid)R.write_shift(16,q.clsid,"hex");else for(z=0;z<4;++z)R.write_shift(4,0);R.write_shift(4,q.state||0),R.write_shift(4,0),R.write_shift(4,0),R.write_shift(4,0),R.write_shift(4,0),R.write_shift(4,q.start),R.write_shift(4,q.size),R.write_shift(4,0)}for(D=1;D<E.FileIndex.length;++D)if(q=E.FileIndex[D],q.size>=4096)if(R.l=q.start+1<<9,Ke&&Buffer.isBuffer(q.content))q.content.copy(R,R.l,0,q.size),R.l+=q.size+511&-512;else{for(z=0;z<q.size;++z)R.write_shift(1,q.content[z]);for(;z&511;++z)R.write_shift(1,0)}for(D=1;D<E.FileIndex.length;++D)if(q=E.FileIndex[D],q.size>0&&q.size<4096)if(Ke&&Buffer.isBuffer(q.content))q.content.copy(R,R.l,0,q.size),R.l+=q.size+63&-64;else{for(z=0;z<q.size;++z)R.write_shift(1,q.content[z]);for(;z&63;++z)R.write_shift(1,0)}if(Ke)R.l=R.length;else for(;R.l<R.length;)R.write_shift(1,0);return R}function j(E,C){var A=E.FullPaths.map(function(z){return z.toUpperCase()}),S=A.map(function(z){var K=z.split("/");return K[K.length-(z.slice(-1)=="/"?2:1)]}),R=!1;C.charCodeAt(0)===47?(R=!0,C=A[0].slice(0,-1)+C):R=C.indexOf("/")!==-1;var D=C.toUpperCase(),G=R===!0?A.indexOf(D):S.indexOf(D);if(G!==-1)return E.FileIndex[G];var Q=!D.match(zl);for(D=D.replace(Hr,""),Q&&(D=D.replace(zl,"!")),G=0;G<A.length;++G)if((Q?A[G].replace(zl,"!"):A[G]).replace(Hr,"")==D||(Q?S[G].replace(zl,"!"):S[G]).replace(Hr,"")==D)return E.FileIndex[G];return null}var M=64,X=-2,ne="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],se="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:X,FREESECT:-1,HEADER_SIGNATURE:ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function te(E,C,A){c();var S=U(E,A);l.writeFileSync(C,S)}function b(E){for(var C=new Array(E.length),A=0;A<E.length;++A)C[A]=String.fromCharCode(E[A]);return C.join("")}function ce(E,C){var A=U(E,C);switch(C&&C.type||"buffer"){case"file":return c(),l.writeFileSync(C.filename,A),A;case"binary":return typeof A=="string"?A:b(A);case"base64":return VE(typeof A=="string"?A:b(A));case"buffer":if(Ke)return Buffer.isBuffer(A)?A:$a(A);case"array":return typeof A=="string"?$n(A):A}return A}var Ee;function F(E){try{var C=E.InflateRaw,A=new C;if(A._processChunk(new Uint8Array([3,0]),A._finishFlushFlag),A.bytesRead)Ee=E;else throw new Error("zlib does not expose bytesRead")}catch(S){console.error("cannot use native zlib: "+(S.message||S))}}function H(E,C){if(!Ee)return V_(E,C);var A=Ee.InflateRaw,S=new A,R=S._processChunk(E.slice(E.l),S._finishFlushFlag);return E.l+=S.bytesRead,R}function B(E){return Ee?Ee.deflateRawSync(E):Be(E)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],de=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function xe(E){var C=(E<<1|E<<11)&139536|(E<<5|E<<15)&558144;return(C>>16|C>>8|C)&255}for(var me=typeof Uint8Array<"u",ae=me?new Uint8Array(256):[],He=0;He<256;++He)ae[He]=xe(He);function L(E,C){var A=ae[E&255];return C<=8?A>>>8-C:(A=A<<8|ae[E>>8&255],C<=16?A>>>16-C:(A=A<<8|ae[E>>16&255],A>>>24-C))}function pt(E,C){var A=C&7,S=C>>>3;return(E[S]|(A<=6?0:E[S+1]<<8))>>>A&3}function Qe(E,C){var A=C&7,S=C>>>3;return(E[S]|(A<=5?0:E[S+1]<<8))>>>A&7}function it(E,C){var A=C&7,S=C>>>3;return(E[S]|(A<=4?0:E[S+1]<<8))>>>A&15}function Ue(E,C){var A=C&7,S=C>>>3;return(E[S]|(A<=3?0:E[S+1]<<8))>>>A&31}function I(E,C){var A=C&7,S=C>>>3;return(E[S]|(A<=1?0:E[S+1]<<8))>>>A&127}function W(E,C,A){var S=C&7,R=C>>>3,D=(1<<A)-1,G=E[R]>>>S;return A<8-S||(G|=E[R+1]<<8-S,A<16-S)||(G|=E[R+2]<<16-S,A<24-S)||(G|=E[R+3]<<24-S),G&D}function Y(E,C,A){var S=C&7,R=C>>>3;return S<=5?E[R]|=(A&7)<<S:(E[R]|=A<<S&255,E[R+1]=(A&7)>>8-S),C+3}function we(E,C,A){var S=C&7,R=C>>>3;return A=(A&1)<<S,E[R]|=A,C+1}function pe(E,C,A){var S=C&7,R=C>>>3;return A<<=S,E[R]|=A&255,A>>>=8,E[R+1]=A,C+8}function fe(E,C,A){var S=C&7,R=C>>>3;return A<<=S,E[R]|=A&255,A>>>=8,E[R+1]=A&255,E[R+2]=A>>>8,C+16}function Ce(E,C){var A=E.length,S=2*A>C?2*A:C+5,R=0;if(A>=C)return E;if(Ke){var D=BE(S);if(E.copy)E.copy(D);else for(;R<E.length;++R)D[R]=E[R];return D}else if(me){var G=new Uint8Array(S);if(G.set)G.set(E);else for(;R<A;++R)G[R]=E[R];return G}return E.length=S,E}function $e(E){for(var C=new Array(E),A=0;A<E;++A)C[A]=0;return C}function et(E,C,A){var S=1,R=0,D=0,G=0,Q=0,z=E.length,K=me?new Uint16Array(32):$e(32);for(D=0;D<32;++D)K[D]=0;for(D=z;D<A;++D)E[D]=0;z=E.length;var q=me?new Uint16Array(z):$e(z);for(D=0;D<z;++D)K[R=E[D]]++,S<R&&(S=R),q[D]=0;for(K[0]=0,D=1;D<=S;++D)K[D+16]=Q=Q+K[D-1]<<1;for(D=0;D<z;++D)Q=E[D],Q!=0&&(q[D]=K[Q+16]++);var oe=0;for(D=0;D<z;++D)if(oe=E[D],oe!=0)for(Q=L(q[D],S)>>S-oe,G=(1<<S+4-oe)-1;G>=0;--G)C[Q|G<<oe]=oe&15|D<<4;return S}var Lr=me?new Uint16Array(512):$e(512),qs=me?new Uint16Array(32):$e(32);if(!me){for(var jt=0;jt<512;++jt)Lr[jt]=0;for(jt=0;jt<32;++jt)qs[jt]=0}(function(){for(var E=[],C=0;C<32;C++)E.push(5);et(E,qs,32);var A=[];for(C=0;C<=143;C++)A.push(8);for(;C<=255;C++)A.push(9);for(;C<=279;C++)A.push(7);for(;C<=287;C++)A.push(8);et(A,Lr,288)})();var qr=function(){for(var C=me?new Uint8Array(32768):[],A=0,S=0;A<de.length-1;++A)for(;S<de[A+1];++S)C[S]=A;for(;S<32768;++S)C[S]=29;var R=me?new Uint8Array(259):[];for(A=0,S=0;A<J.length-1;++A)for(;S<J[A+1];++S)R[S]=A;function D(Q,z){for(var K=0;K<Q.length;){var q=Math.min(65535,Q.length-K),oe=K+q==Q.length;for(z.write_shift(1,+oe),z.write_shift(2,q),z.write_shift(2,~q&65535);q-- >0;)z[z.l++]=Q[K++]}return z.l}function G(Q,z){for(var K=0,q=0,oe=me?new Uint16Array(32768):[];q<Q.length;){var ge=Math.min(65535,Q.length-q);if(ge<10){for(K=Y(z,K,+(q+ge==Q.length)),K&7&&(K+=8-(K&7)),z.l=K/8|0,z.write_shift(2,ge),z.write_shift(2,~ge&65535);ge-- >0;)z[z.l++]=Q[q++];K=z.l*8;continue}K=Y(z,K,+(q+ge==Q.length)+2);for(var ke=0;ge-- >0;){var he=Q[q];ke=(ke<<5^he)&32767;var ye=-1,Me=0;if((ye=oe[ke])&&(ye|=q&-32768,ye>q&&(ye-=32768),ye<q))for(;Q[ye+Me]==Q[q+Me]&&Me<250;)++Me;if(Me>2){he=R[Me],he<=22?K=pe(z,K,ae[he+1]>>1)-1:(pe(z,K,3),K+=5,pe(z,K,ae[he-23]>>5),K+=3);var _t=he<8?0:he-4>>2;_t>0&&(fe(z,K,Me-J[he]),K+=_t),he=C[q-ye],K=pe(z,K,ae[he]>>3),K-=3;var xt=he<4?0:he-2>>1;xt>0&&(fe(z,K,q-ye-de[he]),K+=xt);for(var mr=0;mr<Me;++mr)oe[ke]=q&32767,ke=(ke<<5^Q[q])&32767,++q;ge-=Me-1}else he<=143?he=he+48:K=we(z,K,1),K=pe(z,K,ae[he]),oe[ke]=q&32767,++q}K=pe(z,K,0)-1}return z.l=(K+7)/8|0,z.l}return function(z,K){return z.length<8?D(z,K):G(z,K)}}();function Be(E){var C=zt(50+Math.floor(E.length*1.1)),A=qr(E,C);return C.slice(0,A)}var mt=me?new Uint16Array(32768):$e(32768),Xr=me?new Uint16Array(32768):$e(32768),kt=me?new Uint16Array(128):$e(128),Xs=1,b_=1;function HR(E,C){var A=Ue(E,C)+257;C+=5;var S=Ue(E,C)+1;C+=5;var R=it(E,C)+4;C+=4;for(var D=0,G=me?new Uint8Array(19):$e(19),Q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z=1,K=me?new Uint8Array(8):$e(8),q=me?new Uint8Array(8):$e(8),oe=G.length,ge=0;ge<R;++ge)G[V[ge]]=D=Qe(E,C),z<D&&(z=D),K[D]++,C+=3;var ke=0;for(K[0]=0,ge=1;ge<=z;++ge)q[ge]=ke=ke+K[ge-1]<<1;for(ge=0;ge<oe;++ge)(ke=G[ge])!=0&&(Q[ge]=q[ke]++);var he=0;for(ge=0;ge<oe;++ge)if(he=G[ge],he!=0){ke=ae[Q[ge]]>>8-he;for(var ye=(1<<7-he)-1;ye>=0;--ye)kt[ke|ye<<he]=he&7|ge<<3}var Me=[];for(z=1;Me.length<A+S;)switch(ke=kt[I(E,C)],C+=ke&7,ke>>>=3){case 16:for(D=3+pt(E,C),C+=2,ke=Me[Me.length-1];D-- >0;)Me.push(ke);break;case 17:for(D=3+Qe(E,C),C+=3;D-- >0;)Me.push(0);break;case 18:for(D=11+I(E,C),C+=7;D-- >0;)Me.push(0);break;default:Me.push(ke),z<ke&&(z=ke);break}var _t=Me.slice(0,A),xt=Me.slice(A);for(ge=A;ge<286;++ge)_t[ge]=0;for(ge=S;ge<30;++ge)xt[ge]=0;return Xs=et(_t,mt,286),b_=et(xt,Xr,30),C}function WR(E,C){if(E[0]==3&&!(E[1]&3))return[Vs(C),2];for(var A=0,S=0,R=BE(C||1<<18),D=0,G=R.length>>>0,Q=0,z=0;!(S&1);){if(S=Qe(E,A),A+=3,S>>>1)S>>1==1?(Q=9,z=5):(A=HR(E,A),Q=Xs,z=b_);else{A&7&&(A+=8-(A&7));var K=E[A>>>3]|E[(A>>>3)+1]<<8;if(A+=32,K>0)for(!C&&G<D+K&&(R=Ce(R,D+K),G=R.length);K-- >0;)R[D++]=E[A>>>3],A+=8;continue}for(;;){!C&&G<D+32767&&(R=Ce(R,D+32767),G=R.length);var q=W(E,A,Q),oe=S>>>1==1?Lr[q]:mt[q];if(A+=oe&15,oe>>>=4,!(oe>>>8&255))R[D++]=oe;else{if(oe==256)break;oe-=257;var ge=oe<8?0:oe-4>>2;ge>5&&(ge=0);var ke=D+J[oe];ge>0&&(ke+=W(E,A,ge),A+=ge),q=W(E,A,z),oe=S>>>1==1?qs[q]:Xr[q],A+=oe&15,oe>>>=4;var he=oe<4?0:oe-2>>1,ye=de[oe];for(he>0&&(ye+=W(E,A,he),A+=he),!C&&G<ke&&(R=Ce(R,ke+100),G=R.length);D<ke;)R[D]=R[D-ye],++D}}}return C?[R,A+7>>>3]:[R.slice(0,D),A+7>>>3]}function V_(E,C){var A=E.slice(E.l||0),S=WR(A,C);return E.l+=S[1],S[0]}function B_(E,C){if(E)typeof console<"u"&&console.error(C);else throw new Error(C)}function U_(E,C){var A=E;ar(A,0);var S=[],R=[],D={FileIndex:S,FullPaths:R};y(D,{root:C.root});for(var G=A.length-4;(A[G]!=80||A[G+1]!=75||A[G+2]!=5||A[G+3]!=6)&&G>=0;)--G;A.l=G+4,A.l+=4;var Q=A.read_shift(2);A.l+=6;var z=A.read_shift(4);for(A.l=z,G=0;G<Q;++G){A.l+=20;var K=A.read_shift(4),q=A.read_shift(4),oe=A.read_shift(2),ge=A.read_shift(2),ke=A.read_shift(2);A.l+=8;var he=A.read_shift(4),ye=o(A.slice(A.l+oe,A.l+oe+ge));A.l+=oe+ge+ke;var Me=A.l;A.l=he+4,GR(A,K,q,D,ye),A.l=Me}return D}function GR(E,C,A,S,R){E.l+=2;var D=E.read_shift(2),G=E.read_shift(2),Q=a(E);if(D&8257)throw new Error("Unsupported ZIP encryption");for(var z=E.read_shift(4),K=E.read_shift(4),q=E.read_shift(4),oe=E.read_shift(2),ge=E.read_shift(2),ke="",he=0;he<oe;++he)ke+=String.fromCharCode(E[E.l++]);if(ge){var ye=o(E.slice(E.l,E.l+ge));(ye[21589]||{}).mt&&(Q=ye[21589].mt),((R||{})[21589]||{}).mt&&(Q=R[21589].mt)}E.l+=ge;var Me=E.slice(E.l,E.l+K);switch(G){case 8:Me=H(E,q);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var _t=!1;D&8&&(z=E.read_shift(4),z==134695760&&(z=E.read_shift(4),_t=!0),K=E.read_shift(4),q=E.read_shift(4)),K!=C&&B_(_t,"Bad compressed size: "+C+" != "+K),q!=A&&B_(_t,"Bad uncompressed size: "+A+" != "+q),Cd(S,ke,Me,{unsafe:!0,mt:Q})}function KR(E,C){var A=C||{},S=[],R=[],D=zt(1),G=A.compression?8:0,Q=0,z=0,K=0,q=0,oe=0,ge=E.FullPaths[0],ke=ge,he=E.FileIndex[0],ye=[],Me=0;for(z=1;z<E.FullPaths.length;++z)if(ke=E.FullPaths[z].slice(ge.length),he=E.FileIndex[z],!(!he.size||!he.content||ke=="Sh33tJ5")){var _t=q,xt=zt(ke.length);for(K=0;K<ke.length;++K)xt.write_shift(1,ke.charCodeAt(K)&127);xt=xt.slice(0,xt.l),ye[oe]=tV.buf(he.content,0);var mr=he.content;G==8&&(mr=B(mr)),D=zt(30),D.write_shift(4,67324752),D.write_shift(2,20),D.write_shift(2,Q),D.write_shift(2,G),he.mt?s(D,he.mt):D.write_shift(4,0),D.write_shift(-4,ye[oe]),D.write_shift(4,mr.length),D.write_shift(4,he.content.length),D.write_shift(2,xt.length),D.write_shift(2,0),q+=D.length,S.push(D),q+=xt.length,S.push(xt),q+=mr.length,S.push(mr),D=zt(46),D.write_shift(4,33639248),D.write_shift(2,0),D.write_shift(2,20),D.write_shift(2,Q),D.write_shift(2,G),D.write_shift(4,0),D.write_shift(-4,ye[oe]),D.write_shift(4,mr.length),D.write_shift(4,he.content.length),D.write_shift(2,xt.length),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(4,0),D.write_shift(4,_t),Me+=D.l,R.push(D),Me+=xt.length,R.push(xt),++oe}return D=zt(22),D.write_shift(4,101010256),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(2,oe),D.write_shift(2,oe),D.write_shift(4,Me),D.write_shift(4,q),D.write_shift(2,0),ls([ls(S),ls(R),D])}var Xu={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function qR(E,C){if(E.ctype)return E.ctype;var A=E.name||"",S=A.match(/\.([^\.]+)$/);return S&&Xu[S[1]]||C&&(S=(A=C).match(/[\.\\]([^\.\\])+$/),S&&Xu[S[1]])?Xu[S[1]]:"application/octet-stream"}function XR(E){for(var C=VE(E),A=[],S=0;S<C.length;S+=76)A.push(C.slice(S,S+76));return A.join(`\r
`)+`\r
`}function YR(E){var C=E.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(K){var q=K.charCodeAt(0).toString(16).toUpperCase();return"="+(q.length==1?"0"+q:q)});C=C.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),C.charAt(0)==`
`&&(C="=0D"+C.slice(1)),C=C.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var A=[],S=C.split(`\r
`),R=0;R<S.length;++R){var D=S[R];if(D.length==0){A.push("");continue}for(var G=0;G<D.length;){var Q=76,z=D.slice(G,G+Q);z.charAt(Q-1)=="="?Q--:z.charAt(Q-2)=="="?Q-=2:z.charAt(Q-3)=="="&&(Q-=3),z=D.slice(G,G+Q),G+=Q,G<D.length&&(z+="="),A.push(z)}}return A.join(`\r
`)}function QR(E){for(var C=[],A=0;A<E.length;++A){for(var S=E[A];A<=E.length&&S.charAt(S.length-1)=="=";)S=S.slice(0,S.length-1)+E[++A];C.push(S)}for(var R=0;R<C.length;++R)C[R]=C[R].replace(/[=][0-9A-Fa-f]{2}/g,function(D){return String.fromCharCode(parseInt(D.slice(1),16))});return $n(C.join(`\r
`))}function JR(E,C,A){for(var S="",R="",D="",G,Q=0;Q<10;++Q){var z=C[Q];if(!z||z.match(/^\s*$/))break;var K=z.match(/^(.*?):\s*([^\s].*)$/);if(K)switch(K[1].toLowerCase()){case"content-location":S=K[2].trim();break;case"content-type":D=K[2].trim();break;case"content-transfer-encoding":R=K[2].trim();break}}switch(++Q,R.toLowerCase()){case"base64":G=$n(_n(C.slice(Q).join("")));break;case"quoted-printable":G=QR(C.slice(Q));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+R)}var q=Cd(E,S.slice(A.length),G,{unsafe:!0});D&&(q.ctype=D)}function ZR(E,C){if(b(E.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var A=C&&C.root||"",S=(Ke&&Buffer.isBuffer(E)?E.toString("binary"):b(E)).split(`\r
`),R=0,D="";for(R=0;R<S.length;++R)if(D=S[R],!!/^Content-Location:/i.test(D)&&(D=D.slice(D.indexOf("file")),A||(A=D.slice(0,D.lastIndexOf("/")+1)),D.slice(0,A.length)!=A))for(;A.length>0&&(A=A.slice(0,A.length-1),A=A.slice(0,A.lastIndexOf("/")+1),D.slice(0,A.length)!=A););var G=(S[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var Q="--"+(G[1]||""),z=[],K=[],q={FileIndex:z,FullPaths:K};y(q);var oe,ge=0;for(R=0;R<S.length;++R){var ke=S[R];ke!==Q&&ke!==Q+"--"||(ge++&&JR(q,S.slice(oe,R),A),oe=R)}return q}function e4(E,C){var A=C||{},S=A.boundary||"SheetJS";S="------="+S;for(var R=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+S.slice(2)+'"',"","",""],D=E.FullPaths[0],G=D,Q=E.FileIndex[0],z=1;z<E.FullPaths.length;++z)if(G=E.FullPaths[z].slice(D.length),Q=E.FileIndex[z],!(!Q.size||!Q.content||G=="Sh33tJ5")){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Me){return"_x"+Me.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Me){return"_u"+Me.charCodeAt(0).toString(16)+"_"});for(var K=Q.content,q=Ke&&Buffer.isBuffer(K)?K.toString("binary"):b(K),oe=0,ge=Math.min(1024,q.length),ke=0,he=0;he<=ge;++he)(ke=q.charCodeAt(he))>=32&&ke<128&&++oe;var ye=oe>=ge*4/5;R.push(S),R.push("Content-Location: "+(A.root||"file:///C:/SheetJS/")+G),R.push("Content-Transfer-Encoding: "+(ye?"quoted-printable":"base64")),R.push("Content-Type: "+qR(Q,G)),R.push(""),R.push(ye?YR(q):XR(q))}return R.push(S+`--\r
`),R.join(`\r
`)}function t4(E){var C={};return y(C,E),C}function Cd(E,C,A,S){var R=S&&S.unsafe;R||y(E);var D=!R&&Xe.find(E,C);if(!D){var G=E.FullPaths[0];C.slice(0,G.length)==G?G=C:(G.slice(-1)!="/"&&(G+="/"),G=(G+C).replace("//","/")),D={name:i(C),type:2},E.FileIndex.push(D),E.FullPaths.push(G),R||Xe.utils.cfb_gc(E)}return D.content=A,D.size=A?A.length:0,S&&(S.CLSID&&(D.clsid=S.CLSID),S.mt&&(D.mt=S.mt),S.ct&&(D.ct=S.ct)),D}function r4(E,C){y(E);var A=Xe.find(E,C);if(A){for(var S=0;S<E.FileIndex.length;++S)if(E.FileIndex[S]==A)return E.FileIndex.splice(S,1),E.FullPaths.splice(S,1),!0}return!1}function n4(E,C,A){y(E);var S=Xe.find(E,C);if(S){for(var R=0;R<E.FileIndex.length;++R)if(E.FileIndex[R]==S)return E.FileIndex[R].name=i(A),E.FullPaths[R]=A,!0}return!1}function i4(E){O(E,!0)}return t.find=j,t.read=k,t.parse=u,t.write=ce,t.writeFile=te,t.utils={cfb_new:t4,cfb_add:Cd,cfb_del:r4,cfb_mov:n4,cfb_gc:i4,ReadShift:cc,CheckField:UC,prep_blob:ar,bconcat:ls,use_zlib:F,_deflateRaw:Be,_inflateRaw:V_,consts:ue},t}();function rV(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function _i(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function m_(e){for(var t=[],r=_i(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var f0=new Date(1899,11,30,0,0,0);function Wr(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=f0.getTime()+(e.getTimezoneOffset()-f0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var _C=new Date,nV=f0.getTime()+(_C.getTimezoneOffset()-f0.getTimezoneOffset())*6e4,KE=_C.getTimezoneOffset();function wd(e){var t=new Date;return t.setTime(e*24*60*60*1e3+nV),t.getTimezoneOffset()!==KE&&t.setTime(t.getTime()+(t.getTimezoneOffset()-KE)*6e4),t}function iV(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var qE=new Date("2017-02-19T19:06:09.000Z"),xC=isNaN(qE.getFullYear())?new Date("2/19/17"):qE,sV=xC.getFullYear()==2017;function tr(e,t){var r=new Date(e);if(sV)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(xC.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Fa(e,t){if(Ke&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Wl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Wl(sC(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Wl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Wl(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function hr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=hr(e[r]));return t}function St(e,t){for(var r="";r.length<t;)r+=e;return r}function Gn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var aV=["january","february","march","april","may","june","july","august","september","october","november","december"];function qo(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&aV.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var oV=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function yC(e){return e?e.content&&e.type?Fa(e.content,!0):e.data?jl(e.data):e.asNodeBuffer&&Ke?jl(e.asNodeBuffer().toString("binary")):e.asBinary?jl(e.asBinary()):e._data&&e._data.getContent?jl(Fa(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function EC(e){if(!e)return null;if(e.data)return ME(e.data);if(e.asNodeBuffer&&Ke)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?ME(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function lV(e){return e&&e.name.slice(-4)===".bin"?EC(e):yC(e)}function Tn(e,t){for(var r=e.FullPaths||_i(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function g_(e,t){var r=Tn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Ot(e,t,r){if(!r)return lV(g_(e,t));if(!t)return null;try{return Ot(e,t)}catch{return null}}function un(e,t,r){if(!r)return yC(g_(e,t));if(!t)return null;try{return un(e,t)}catch{return null}}function wC(e,t,r){if(!r)return EC(g_(e,t));if(!t)return null;try{return wC(e,t)}catch{return null}}function XE(e){for(var t=e.FullPaths||_i(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function cV(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ke?n=$a(r):n=R9(r),Xe.utils.cfb_add(e,t,n)}Xe.utils.cfb_add(e,t,r)}else e.file(t,r)}function TC(e,t){switch(t.type){case"base64":return Xe.read(e,{type:"base64"});case"binary":return Xe.read(e,{type:"binary"});case"buffer":case"array":return Xe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Hl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var kC=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,uV=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,YE=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,fV=/<[^>]*>/g,Or=kC.match(YE)?YE:fV,hV=/<\w*:/,dV=/<(\/?)\w+:/;function Pe(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var a=e.match(uV),o=0,l="",c=0,u="",f="",h=1;if(a)for(c=0;c!=a.length;++c){for(f=a[c],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(u=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(h=(i=f.charCodeAt(s+1))==34||i==39?1:0,l=f.slice(s+1+h,f.length-h),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,r||(n[u.toLowerCase()]=l);else{var d=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[d]&&u.slice(o-3,o)=="ext")continue;n[d]=l,r||(n[d.toLowerCase()]=l)}}return n}function yi(e){return e.replace(dV,"<$1")}var AC={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},pV=m_(AC),Ze=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(o,l){return AC[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),mV=/[&<>'"]/g,gV=/[\u0000-\u001f]/g;function v_(e){var t=e+"";return t.replace(mV,function(r){return pV[r]}).replace(/\n/g,"<br/>").replace(gV,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var QE=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function gt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Vp(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function JE(e){var t=Vs(2*e.length),r,n,i=1,s=0,a=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function ZE(e){return $a(e,"binary").toString("utf8")}var If="foo bar bazâð£",ot=Ke&&(ZE(If)==Vp(If)&&ZE||JE(If)==Vp(If)&&JE)||Vp,Wl=Ke?function(e){return $a(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},iu=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),SC=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),vV=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),_V=/<\/?(?:vt:)?variant>/g,xV=/<(?:vt:)([^>]*)>([\s\S]*)</;function ew(e,t){var r=Pe(e),n=e.match(vV(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(_V,"").match(xV);a&&i.push({v:ot(a[2]),t:a[1]})}),i}var yV=/(^\s|\s$|\n)/;function EV(e){return _i(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function wV(e,t,r){return"<"+e+(r!=null?EV(r):"")+(t!=null?(t.match(yV)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function __(e){if(Ke&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ot(ja(h_(e)));throw new Error("Bad input format: expected Buffer or string")}var su=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,TV={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},kV=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function AV(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function SV(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=n?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var tw=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},rw=Ke?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:$a(t)})):tw(e)}:tw,nw=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Fi(e,i)));return n.join("").replace(Hr,"")},x_=Ke?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Hr,""):nw(e,t,r)}:nw,iw=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},IC=Ke?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):iw(e,t,r)}:iw,sw=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(eo(e,i)));return n.join("")},zu=Ke?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):sw(t,r,n)}:sw,CC=function(e,t){var r=ln(e,t);return r>0?zu(e,t+4,t+4+r-1):""},RC=CC,PC=function(e,t){var r=ln(e,t);return r>0?zu(e,t+4,t+4+r-1):""},FC=PC,NC=function(e,t){var r=2*ln(e,t);return r>0?zu(e,t+4,t+4+r-1):""},DC=NC,OC=function(t,r){var n=ln(t,r);return n>0?x_(t,r+4,r+4+n):""},LC=OC,MC=function(e,t){var r=ln(e,t);return r>0?zu(e,t+4,t+4+r):""},bC=MC,VC=function(e,t){return AV(e,t)},h0=VC,BC=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ke&&(RC=function(t,r){if(!Buffer.isBuffer(t))return CC(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},FC=function(t,r){if(!Buffer.isBuffer(t))return PC(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},DC=function(t,r){if(!Buffer.isBuffer(t))return NC(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},LC=function(t,r){if(!Buffer.isBuffer(t))return OC(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},bC=function(t,r){if(!Buffer.isBuffer(t))return MC(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},h0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):VC(t,r)},BC=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var eo=function(e,t){return e[t]},Fi=function(e,t){return e[t+1]*256+e[t]},IV=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ln=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ra=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},CV=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function cc(e,t){var r="",n,i,s=[],a,o,l,c;switch(t){case"dbcs":if(c=this.l,Ke&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Fi(this,c)),c+=2;e*=2;break;case"utf8":r=zu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=x_(this,this.l,this.l+e);break;case"wstr":return cc.call(this,e,"dbcs");case"lpstr-ansi":r=RC(this,this.l),e=4+ln(this,this.l);break;case"lpstr-cp":r=FC(this,this.l),e=4+ln(this,this.l);break;case"lpwstr":r=DC(this,this.l),e=4+2*ln(this,this.l);break;case"lpp4":e=4+ln(this,this.l),r=LC(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ln(this,this.l),r=bC(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=eo(this,this.l+e++))!==0;)s.push(Sf(a));r=s.join("");break;case"_wstr":for(e=0,r="";(a=Fi(this,this.l+e))!==0;)s.push(Sf(a)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=eo(this,c),this.l=c+1,o=cc.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Sf(Fi(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=eo(this,c),this.l=c+1,o=cc.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Sf(eo(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=eo(this,this.l),this.l++,n;case 2:return n=(t==="i"?IV:Fi)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ra:CV)(this,this.l),this.l+=4,n):(i=ln(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=h0(this,this.l):i=h0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=IC(this,this.l,e);break}}return this.l+=e,r}var RV=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},PV=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},FV=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function NV(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)FV(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,RV(this,t,this.l);break;case 8:if(n=8,r==="f"){SV(this,t,this.l);break}case 16:break;case-4:n=4,PV(this,t,this.l);break}return this.l+=n,this}function UC(e,t){var r=IC(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ar(e,t){e.l=t,e.read_shift=cc,e.chk=UC,e.write_shift=NV}function Dr(e,t){e.l+=t}function zt(e){var t=Vs(e);return ar(t,0),t}function Ki(e,t,r){if(e){var n,i,s;ar(e,e.l||0);for(var a=e.length,o=0,l=0;e.l<a;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=_0[o]||_0[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;l=e.l+s;var u=c.f&&c.f(e,s,r);if(e.l=l,t(u,c,o))return}}}function Cg(){var e=[],t=Ke?256:2048,r=function(c){var u=zt(c);return ar(u,0),u},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},a=function(){return i(),ls(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function uc(e,t,r){var n=hr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function aw(e,t,r){var n=hr(e);return n.s=uc(n.s,t.s,r),n.e=uc(n.e,t.s,r),n}function fc(e,t){if(e.cRel&&e.c<0)for(e=hr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=hr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Le(e);return!e.cRel&&e.cRel!=null&&(r=LV(r)),!e.rRel&&e.rRel!=null&&(r=DV(r)),r}function Bp(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Gt(e.s.c)+":"+(e.e.cRel?"":"$")+Gt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+dr(e.s.r)+":"+(e.e.rRel?"":"$")+dr(e.e.r):fc(e.s,t.biff)+":"+fc(e.e,t.biff)}function y_(e){return parseInt(OV(e),10)-1}function dr(e){return""+(e+1)}function DV(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function OV(e){return e.replace(/\$(\d+)$/,"$1")}function E_(e){for(var t=MV(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Gt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function LV(e){return e.replace(/^([A-Z])/,"$$$1")}function MV(e){return e.replace(/^\$([A-Z])/,"$1")}function bV(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function jr(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Le(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function dl(e){var t=e.indexOf(":");return t==-1?{s:jr(e),e:jr(e)}:{s:jr(e.slice(0,t)),e:jr(e.slice(t+1))}}function Ye(e,t){return typeof t>"u"||typeof t=="number"?Ye(e.s,e.e):(typeof e!="string"&&(e=Le(e)),typeof t!="string"&&(t=Le(t)),e==t?e:e+":"+t)}function Ct(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function ow(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Dn(e.z,r?Wr(t):t)}catch{}try{return e.w=Dn((e.XF||{}).numFmtId||(r?14:0),r?Wr(t):t)}catch{return""+t}}function Hi(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Wa[e.v]||e.v:t==null?ow(e,e.v):ow(e,t))}function Ks(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function $C(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?jr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Ct(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var d={v:t[f][h]},p=a+f,m=o+h;if(c.s.r>p&&(c.s.r=p),c.s.c>m&&(c.s.c=m),c.e.r<p&&(c.e.r=p),c.e.c<m&&(c.e.c=m),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))d=t[f][h];else if(Array.isArray(d.v)&&(d.f=t[f][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||be[14],n.cellDates?(d.t="d",d.w=Dn(d.z,Wr(d.v))):(d.t="n",d.v=Wr(d.v),d.w=Dn(d.z,d.v))):d.t="s";if(i)s[p]||(s[p]=[]),s[p][m]&&s[p][m].z&&(d.z=s[p][m].z),s[p][m]=d;else{var v=Le({c:m,r:p});s[v]&&s[v].z&&(d.z=s[v].z),s[v]=d}}}return c.s.c<1e7&&(s["!ref"]=Ye(c)),s}function pl(e,t){return $C(null,e,t)}function VV(e){return e.read_shift(4,"i")}function Rr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function BV(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function w_(e,t){var r=e.l,n=e.read_shift(1),i=Rr(e),s=[],a={t:i,h:i};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(BV(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}var UV=w_;function On(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function za(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var $V=Rr;function T_(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var jV=Rr,Rg=T_;function k_(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?h0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ra(t,0)>>2;return r?i/100:i}function jC(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Ha=jC;function Ar(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function zV(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=va[i];c&&(t.rgb=ou(c));break;case 2:t.rgb=ou([a,o,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function HV(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function zC(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function WV(e){return zC(e,1)}function GV(e){return zC(e,2)}var A_=2,Yr=3,Cf=11,lw=12,d0=19,Rf=64,KV=65,qV=71,XV=4108,YV=4126,Jt=80,HC=81,QV=[Jt,HC],JV={1:{n:"CodePage",t:A_},2:{n:"Category",t:Jt},3:{n:"PresentationFormat",t:Jt},4:{n:"ByteCount",t:Yr},5:{n:"LineCount",t:Yr},6:{n:"ParagraphCount",t:Yr},7:{n:"SlideCount",t:Yr},8:{n:"NoteCount",t:Yr},9:{n:"HiddenCount",t:Yr},10:{n:"MultimediaClipCount",t:Yr},11:{n:"ScaleCrop",t:Cf},12:{n:"HeadingPairs",t:XV},13:{n:"TitlesOfParts",t:YV},14:{n:"Manager",t:Jt},15:{n:"Company",t:Jt},16:{n:"LinksUpToDate",t:Cf},17:{n:"CharacterCount",t:Yr},19:{n:"SharedDoc",t:Cf},22:{n:"HyperlinksChanged",t:Cf},23:{n:"AppVersion",t:Yr,p:"version"},24:{n:"DigSig",t:KV},26:{n:"ContentType",t:Jt},27:{n:"ContentStatus",t:Jt},28:{n:"Language",t:Jt},29:{n:"Version",t:Jt},255:{},2147483648:{n:"Locale",t:d0},2147483651:{n:"Behavior",t:d0},1919054434:{}},ZV={1:{n:"CodePage",t:A_},2:{n:"Title",t:Jt},3:{n:"Subject",t:Jt},4:{n:"Author",t:Jt},5:{n:"Keywords",t:Jt},6:{n:"Comments",t:Jt},7:{n:"Template",t:Jt},8:{n:"LastAuthor",t:Jt},9:{n:"RevNumber",t:Jt},10:{n:"EditTime",t:Rf},11:{n:"LastPrinted",t:Rf},12:{n:"CreatedDate",t:Rf},13:{n:"ModifiedDate",t:Rf},14:{n:"PageCount",t:Yr},15:{n:"WordCount",t:Yr},16:{n:"CharCount",t:Yr},17:{n:"Thumbnail",t:qV},18:{n:"Application",t:Jt},19:{n:"DocSecurity",t:Yr},255:{},2147483648:{n:"Locale",t:d0},2147483651:{n:"Behavior",t:d0},1919054434:{}},cw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},eB=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function tB(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var rB=tB([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),va=hr(rB),Wa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},WC={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},uw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function nB(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function iB(e){var t=nB();if(!e||!e.match)return t;var r={};if((e.match(Or)||[]).forEach(function(n){var i=Pe(n);switch(i[0].replace(hV,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[uw[i.ContentType]]!==void 0&&t[uw[i.ContentType]].push(i.PartName);break}}),t.xmlns!==TV.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var vo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Pg(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function hc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Or)||[]).forEach(function(i){var s=Pe(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Hl(s.Target,t);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}var sB="application/vnd.oasis.opendocument.spreadsheet";function aB(e,t){for(var r=__(e),n,i;n=su.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Pe(n[0],!1),i.path=="/"&&i.type!==sB)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var dc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],oB=function(){for(var e=new Array(dc.length),t=0;t<dc.length;++t){var r=dc[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function GC(e){var t={};e=ot(e);for(var r=0;r<dc.length;++r){var n=dc[r],i=e.match(oB[r]);i!=null&&i.length>0&&(t[n[1]]=Ze(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=tr(t[n[1]]))}return t}var lB=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function KC(e,t,r,n){var i=[];if(typeof e=="string")i=ew(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(u){return{v:u}}));var a=typeof t=="string"?ew(t,n).map(function(u){return u.v}):t,o=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function cB(e,t,r){var n={};return t||(t={}),e=ot(e),lB.forEach(function(i){var s=(e.match(iu(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=Ze(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var a=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&KC(n.HeadingPairs,n.TitlesOfParts,t,r),t}var uB=/<[^>]+>[^<]*/g;function fB(e,t){var r={},n="",i=e.match(uB);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=Pe(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ze(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Ze(u);break;case"bool":r[n]=gt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=tr(u);break;case"cy":case"error":r[n]=Ze(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(t.WTF)throw new Error(a)}}}return r}var hB={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Up;function dB(e,t,r){Up||(Up=m_(hB)),t=Up[t]||t,e[t]=r}function S_(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function qC(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function XC(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function YC(e,t,r){return t===31?XC(e):qC(e,t,r)}function Fg(e,t,r){return YC(e,t,r===!1?0:4)}function pB(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return YC(e,t,0)}function mB(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Hr,""),e.l-i&2&&(e.l+=2)}return r}function gB(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Hr,"");return r}function vB(e){var t=e.l,r=p0(e,HC);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=p0(e,Yr);return[r,n]}function _B(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(vB(e));return r}function fw(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),a=e.read_shift(4);n[s]=e.read_shift(a,t===1200?"utf16le":"utf8").replace(Hr,"").replace(zl,"!"),t===1200&&a%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function QC(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function xB(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function p0(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==lw&&n!==t&&QV.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===lw?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return qC(e,n,4).replace(Hr,"");case 31:return XC(e);case 64:return S_(e);case 65:return QC(e);case 71:return xB(e);case 80:return Fg(e,n,!s.raw).replace(Hr,"");case 81:return pB(e,n).replace(Hr,"");case 4108:return _B(e);case 4126:case 4127:return n==4127?mB(e):gB(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function hw(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],a=0,o=0,l=-1,c={};for(a=0;a!=i;++a){var u=e.read_shift(4),f=e.read_shift(4);s[a]=[u,f+r]}s.sort(function(_,g){return _[1]-g[1]});var h={};for(a=0;a!=i;++a){if(e.l!==s[a][1]){var d=!0;if(a>0&&t)switch(t[s[a-1][0]].t){case 2:e.l+2===s[a][1]&&(e.l+=2,d=!1);break;case 80:e.l<=s[a][1]&&(e.l=s[a][1],d=!1);break;case 4108:e.l<=s[a][1]&&(e.l=s[a][1],d=!1);break}if((!t||a==0)&&e.l<=s[a][1]&&(d=!1,e.l=s[a][1]),d)throw new Error("Read Error: Expected address "+s[a][1]+" at "+e.l+" :"+a)}if(t){var p=t[s[a][0]];if(h[p.n]=p0(e,p.t,{raw:!0}),p.p==="version"&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(h[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:jn(o=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(s[a][0]===1){if(o=h.CodePage=p0(e,A_),jn(o),l!==-1){var m=e.l;e.l=s[l][1],c=fw(e,o),e.l=m}}else if(s[a][0]===0){if(o===0){l=a,e.l=s[a+1][1];continue}c=fw(e,o)}else{var v=c[s[a][0]],x;switch(e[e.l]){case 65:e.l+=4,x=QC(e);break;case 30:e.l+=4,x=Fg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=Fg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=Rt(e,4);break;case 64:e.l+=4,x=tr(S_(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[v]=x}}return e.l=r+n,h}function dw(e,t,r){var n=e.content;if(!n)return{};ar(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Xe.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var f=hw(n,t),h={SystemIdentifier:c};for(var d in f)h[d]=f[d];if(h.FMTID=s,i===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var p;try{p=hw(n,null)}catch{}for(d in p)h[d]=p[d];return h.FMTID=[s,a],h}function Qi(e,t){return e.read_shift(t),null}function yB(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Rt(e,t){return e.read_shift(t)===1}function Lt(e){return e.read_shift(2,"u")}function JC(e,t){return yB(e,t,Lt)}function EB(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Hu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return a}function wB(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return i&&(e.l+=4*a),n&&(e.l+=o),l.t=u,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Na(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Wu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Na(e,n,r)}function Ga(e,t,r){if(r.biff>5)return Wu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function TB(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function kB(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Hr,"");return n&&(e.l+=24),i}function AB(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=e.read_shift(s>>1,"utf16le").replace(Hr,"");return r+a}function SB(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return kB(e);case"0303000000000000c000000000000046":return AB(e);default:throw new Error("Unsupported Moniker "+r)}}function Pf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Hr,""):"";return r}function IB(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,a,o,l,c="",u,f;i&16&&(s=Pf(e,r-e.l)),i&128&&(a=Pf(e,r-e.l)),(i&257)===257&&(o=Pf(e,r-e.l)),(i&257)===1&&(l=SB(e,r-e.l)),i&8&&(c=Pf(e,r-e.l)),i&32&&(u=e.read_shift(16)),i&64&&(f=S_(e)),e.l=r;var h=a||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var d={Target:h};return u&&(d.guid=u),f&&(d.time=f),s&&(d.Tooltip=s),d}function ZC(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function eR(e,t){var r=ZC(e);return r[3]=0,r}function Ei(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function CB(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function RB(e,t,r){return t===0?"":Ga(e,t,r)}function PB(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[i,s,a]}function tR(e){var t=e.read_shift(2),r=k_(e);return[t,r]}function FB(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=Hu(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function Td(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function rR(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var NB=rR;function nR(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function DB(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function OB(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function xr(e){e.l+=2,e.l+=e.read_shift(2)}var LB={0:xr,4:xr,5:xr,6:xr,7:OB,8:xr,9:xr,10:xr,11:xr,12:xr,13:DB,14:xr,15:xr,16:xr,17:xr,18:xr,19:xr,20:xr,21:nR};function MB(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(LB[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Ff(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function bB(e,t){return t===0||e.read_shift(2),1200}function VB(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Ga(e,0,r);return e.read_shift(t+n-e.l),i}function BB(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function UB(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Hu(e,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function $B(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],a=0;a!=i&&e.l<r;++a)s.push(wB(e));return s.Count=n,s.Unique=i,s}function jB(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function zB(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function HB(e){var t=CB(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function WB(e){return e.read_shift(2),e.read_shift(4)}function pw(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function GB(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function KB(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function qB(){}function XB(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Hu(e,0,r),n}function YB(e){var t=Ei(e);return t.isst=e.read_shift(4),t}function QB(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=Ei(e);r.biff==2&&e.l++;var s=Wu(e,n-e.l,r);return i.val=s,i}function JB(e,t,r){var n=e.read_shift(2),i=Ga(e,0,r);return[n,i]}var ZB=Ga;function mw(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),a=e.read_shift(i),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function eU(e){var t=e.read_shift(2),r=e.read_shift(2),n=tR(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function tU(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(tR(e));if(e.l!==r)throw new Error("MulRK read error");var a=e.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function rU(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var a=e.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function nU(e,t,r,n){var i={},s=e.read_shift(4),a=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return i.patternType=eB[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function iU(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=nU(e,t,n.fStyle,r),n}function sU(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function gw(e,t,r){var n=Ei(e);(r.biff==2||t==9)&&++e.l;var i=EB(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function aU(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ei(e),i=Ar(e);return n.val=i,n}var vw=RB;function oU(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Na(e,s),o=[];n>e.l;)o.push(Wu(e));return[s,i,a,o]}function _w(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=FB(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var lU=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function xw(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),a=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Na(e,a,r);i&32&&(c=lU[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var f=n==e.l||o===0||!(u>0)?[]:zj(e,u,r,o);return{chKey:s,Name:c,itab:l,rgce:f}}function iR(e,t,r){if(r.biff<8)return cU(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(PB(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function cU(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Hu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function uU(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=Na(e,n,r),a=Na(e,i,r);return[s,a]}function fU(e,t,r){var n=rR(e);e.l++;var i=e.read_shift(1);return t-=8,[Hj(e,t,r),i,n]}function yw(e,t,r){var n=NB(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,$j(e,t,r)]}function hU(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function dU(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=Ga(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,a,s]}}function pU(e,t,r){return dU(e,t,r)}function mU(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Td(e));return r}function gU(e,t,r){if(r&&r.biff<8)return _U(e,t,r);var n=nR(e),i=MB(e,t-22,n[1]);return{cmo:n,ft:i}}var vU={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function _U(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var a=[];return a.push((vU[n]||Dr)(e,t,r)),{cmo:[i,n,s],ft:a}}function xU(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:a=TB(e,6,r);var o=e.read_shift(2);e.read_shift(2),Lt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],f=Na(e,e.lens[c+1]-e.lens[c]-1);if(i+=f,i.length>=(u?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function yU(e,t){var r=Td(e);e.l+=16;var n=IB(e,t-24);return[r,n]}function EU(e,t){e.read_shift(2);var r=Td(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Hr,""),[r,n]}function wU(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=cw[r]||r,r=e.read_shift(2),t[1]=cw[r]||r,t}function TU(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(eR(e));return r}function kU(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(eR(e));return r}function AU(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function sR(e,t,r){if(!r.cellStyles)return Dr(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function SU(e,t){var r={};return t<32||(e.l+=16,r.header=Ar(e),r.footer=Ar(e),e.l+=2),r}function IU(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var CU=Ei,RU=JC,PU=Wu;function FU(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function NU(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ei(e);++e.l;var i=Ga(e,t-7,r);return n.t="str",n.val=i,n}function DU(e){var t=Ei(e);++e.l;var r=Ar(e);return t.t="n",t.val=r,t}function OU(e){var t=Ei(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function LU(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function MU(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function bU(e,t,r){var n=e.l+t,i=Ei(e),s=e.read_shift(2),a=Na(e,s,r);return e.l=n,i.t="str",i.val=a,i}var VU=[2,3,48,49,131,139,140,245],Ew=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=m_({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=Vs(1);switch(l.type){case"base64":u=$n(_n(o));break;case"binary":u=$n(o);break;case"buffer":case"array":u=o;break}ar(u,0);var f=u.read_shift(1),h=!!(f&136),d=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,v=521;f==2&&(m=u.read_shift(2)),u.l+=3,f!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(v=u.read_shift(2));var x=u.read_shift(2),_=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(_=e[u[u.l]]),u.l+=1,u.l+=2),p&&(u.l+=36);for(var g=[],w={},T=Math.min(u.length,f==2?521:v-10-(d?264:0)),k=p?32:11;u.l<T&&u[u.l]!=13;)switch(w={},w.name=os.utils.decode(_,u.slice(u.l,u.l+k)).replace(/[\u0000\r\n].*$/g,""),u.l+=k,w.type=String.fromCharCode(u.read_shift(1)),f!=2&&!p&&(w.offset=u.read_shift(4)),w.len=u.read_shift(1),f==2&&(w.offset=u.read_shift(2)),w.dec=u.read_shift(1),w.name.length&&g.push(w),f!=2&&(u.l+=p?13:14),w.type){case"B":(!d||w.len!=8)&&l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(u[u.l]!==13&&(u.l=v-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=v;var y=0,P=0;for(c[0]=[],P=0;P!=g.length;++P)c[0][P]=g[P].name;for(;m-- >0;){if(u[u.l]===42){u.l+=x;continue}for(++u.l,c[++y]=[],P=0,P=0;P!=g.length;++P){var O=u.slice(u.l,u.l+g[P].len);u.l+=g[P].len,ar(O,0);var U=os.utils.decode(_,O);switch(g[P].type){case"C":U.trim().length&&(c[y][P]=U.replace(/\s+$/,""));break;case"D":U.length===8?c[y][P]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):c[y][P]=U;break;case"F":c[y][P]=parseFloat(U.trim());break;case"+":case"I":c[y][P]=p?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":c[y][P]=!0;break;case"N":case"F":c[y][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[y][P]="##MEMO##"+(p?parseInt(U.trim(),10):O.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(c[y][P]=+U||0);break;case"@":c[y][P]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":c[y][P]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":c[y][P]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[y][P]=-O.read_shift(-8,"f");break;case"B":if(d&&g[P].len==8){c[y][P]=O.read_shift(8,"f");break}case"G":case"P":O.l+=g[P].len;break;case"0":if(g[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+g[P].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=g,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=pl(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function i(o,l){try{return Ks(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&jn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Cg(),f=Vg(o,{header:1,raw:!0,cellDates:!0}),h=f[0],d=f.slice(1),p=o["!cols"]||[],m=0,v=0,x=0,_=1;for(m=0;m<h.length;++m){if(((p[m]||{}).DBF||{}).name){h[m]=p[m].DBF.name,++x;continue}if(h[m]!=null){if(++x,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(v=0;v<1024;++v)if(h.indexOf(h[m]+"_"+v)==-1){h[m]+="_"+v;break}}}}var g=Ct(o["!ref"]),w=[],T=[],k=[];for(m=0;m<=g.e.c-g.s.c;++m){var y="",P="",O=0,U=[];for(v=0;v<d.length;++v)d[v][m]!=null&&U.push(d[v][m]);if(U.length==0||h[m]==null){w[m]="?";continue}for(v=0;v<U.length;++v){switch(typeof U[v]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=U[v]instanceof Date?"D":"C";break;default:P="C"}O=Math.max(O,String(U[v]).length),y=y&&y!=P?"C":P}O>250&&(O=250),P=((p[m]||{}).DBF||{}).type,P=="C"&&p[m].DBF.len>O&&(O=p[m].DBF.len),y=="B"&&P=="N"&&(y="N",k[m]=p[m].DBF.dec,O=p[m].DBF.len),T[m]=y=="C"||P=="N"?O:s[y]||0,_+=T[m],w[m]=y}var j=u.next(32);for(j.write_shift(4,318902576),j.write_shift(4,d.length),j.write_shift(2,296+32*x),j.write_shift(2,_),m=0;m<4;++m)j.write_shift(4,0);for(j.write_shift(4,0|(+t[nC]||3)<<8),m=0,v=0;m<h.length;++m)if(h[m]!=null){var M=u.next(32),X=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,X,"sbcs"),M.write_shift(1,w[m]=="?"?"C":w[m],"sbcs"),M.write_shift(4,v),M.write_shift(1,T[m]||s[w[m]]||0),M.write_shift(1,k[m]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),v+=T[m]||s[w[m]]||0}var ne=u.next(264);for(ne.write_shift(4,13),m=0;m<65;++m)ne.write_shift(4,0);for(m=0;m<d.length;++m){var re=u.next(_);for(re.write_shift(1,0),v=0;v<h.length;++v)if(h[v]!=null)switch(w[v]){case"L":re.write_shift(1,d[m][v]==null?63:d[m][v]?84:70);break;case"B":re.write_shift(8,d[m][v]||0,"f");break;case"N":var se="0";for(typeof d[m][v]=="number"&&(se=d[m][v].toFixed(k[v]||0)),x=0;x<T[v]-se.length;++x)re.write_shift(1,32);re.write_shift(1,se,"sbcs");break;case"D":d[m][v]?(re.write_shift(4,("0000"+d[m][v].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(d[m][v].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+d[m][v].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(d[m][v]!=null?d[m][v]:"").slice(0,T[v]);for(re.write_shift(1,ue,"sbcs"),x=0;x<T[v]-ue.length;++x)re.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),BU=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+_i(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,d){var p=e[d];return typeof p=="number"?bE(p):p},n=function(h,d,p){var m=d.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return m==59?h:bE(m)};e["|"]=254;function i(h,d){switch(d.type){case"base64":return s(_n(h),d);case"binary":return s(h,d);case"buffer":return s(Ke&&Buffer.isBuffer(h)?h.toString("binary"):ja(h),d);case"array":return s(Fa(h),d)}throw new Error("Unrecognized type "+d.type)}function s(h,d){var p=h.split(/[\n\r]+/),m=-1,v=-1,x=0,_=0,g=[],w=[],T=null,k={},y=[],P=[],O=[],U=0,j;for(+d.codepage>=0&&jn(+d.codepage);x!==p.length;++x){U=0;var M=p[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),X=M.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),ne=X[0],re;if(M.length>0)switch(ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":X[1].charAt(0)=="P"&&w.push(M.slice(3).replace(/;;/g,";"));break;case"C":var se=!1,ue=!1,te=!1,b=!1,ce=-1,Ee=-1;for(_=1;_<X.length;++_)switch(X[_].charAt(0)){case"A":break;case"X":v=parseInt(X[_].slice(1))-1,ue=!0;break;case"Y":for(m=parseInt(X[_].slice(1))-1,ue||(v=0),j=g.length;j<=m;++j)g[j]=[];break;case"K":re=X[_].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(Gn(re))?isNaN(qo(re).getDate())||(re=tr(re)):(re=Gn(re),T!==null&&hl(T)&&(re=wd(re))),se=!0;break;case"E":b=!0;var F=Po(X[_].slice(1),{r:m,c:v});g[m][v]=[g[m][v],F];break;case"S":te=!0,g[m][v]=[g[m][v],"S5S"];break;case"G":break;case"R":ce=parseInt(X[_].slice(1))-1;break;case"C":Ee=parseInt(X[_].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+M)}if(se&&(g[m][v]&&g[m][v].length==2?g[m][v][0]=re:g[m][v]=re,T=null),te){if(b)throw new Error("SYLK shared formula cannot have own formula");var H=ce>-1&&g[ce][Ee];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");g[m][v][1]=mR(H[1],{r:m-ce,c:v-Ee})}break;case"F":var B=0;for(_=1;_<X.length;++_)switch(X[_].charAt(0)){case"X":v=parseInt(X[_].slice(1))-1,++B;break;case"Y":for(m=parseInt(X[_].slice(1))-1,j=g.length;j<=m;++j)g[j]=[];break;case"M":U=parseInt(X[_].slice(1))/20;break;case"F":break;case"G":break;case"P":T=w[parseInt(X[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=X[_].slice(1).split(" "),j=parseInt(O[0],10);j<=parseInt(O[1],10);++j)U=parseInt(O[2],10),P[j-1]=U===0?{hidden:!0}:{wch:U},Xo(P[j-1]);break;case"C":v=parseInt(X[_].slice(1))-1,P[v]||(P[v]={});break;case"R":m=parseInt(X[_].slice(1))-1,y[m]||(y[m]={}),U>0?(y[m].hpt=U,y[m].hpx=lu(U)):U===0&&(y[m].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+M)}B<1&&(T=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+M)}}return y.length>0&&(k["!rows"]=y),P.length>0&&(k["!cols"]=P),d&&d.sheetRows&&(g=g.slice(0,d.sheetRows)),[g,k]}function a(h,d){var p=i(h,d),m=p[0],v=p[1],x=pl(m,d);return _i(v).forEach(function(_){x[_]=v[_]}),x}function o(h,d){return Ks(a(h,d),d)}function l(h,d,p,m){var v="C;Y"+(p+1)+";X"+(m+1)+";K";switch(h.t){case"n":v+=h.v||0,h.f&&!h.F&&(v+=";E"+A$(h.f,{r:p,c:m}));break;case"b":v+=h.v?"TRUE":"FALSE";break;case"e":v+=h.w||h.v;break;case"d":v+='"'+(h.w||h.v)+'"';break;case"s":v+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function c(h,d){d.forEach(function(p,m){var v="F;W"+(m+1)+" "+(m+1)+" ";p.hidden?v+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=g0(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=v0(p.wpx)),typeof p.wch=="number"&&(v+=Math.round(p.wch))),v.charAt(v.length-1)!=" "&&h.push(v)})}function u(h,d){d.forEach(function(p,m){var v="F;";p.hidden?v+="M0;":p.hpt?v+="M"+20*p.hpt+";":p.hpx&&(v+="M"+20*hR(p.hpx)+";"),v.length>2&&h.push(v+"R"+(m+1))})}function f(h,d){var p=["ID;PWXL;N;E"],m=[],v=Ct(h["!ref"]),x,_=Array.isArray(h),g=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),h["!cols"]&&c(p,h["!cols"]),h["!rows"]&&u(p,h["!rows"]),p.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var w=v.s.r;w<=v.e.r;++w)for(var T=v.s.c;T<=v.e.c;++T){var k=Le({r:w,c:T});x=_?(h[w]||[])[T]:h[k],!(!x||x.v==null&&(!x.f||x.F))&&m.push(l(x,h,w,T))}return p.join(g)+g+m.join(g)+g+"E"+g}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),UU=function(){function e(s,a){switch(a.type){case"base64":return t(_n(s),a);case"binary":return t(s,a);case"buffer":return t(Ke&&Buffer.isBuffer(s)?s.toString("binary"):ja(s),a);case"array":return t(Fa(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var h=o[u].trim().split(","),d=h[0],p=h[1];++u;for(var m=o[u]||"";(m.match(/["]/g)||[]).length&1&&u<o.length-1;)m+=`
`+o[++u];switch(m=m.trim(),+d){case-1:if(m==="BOT"){f[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[l][c]=!0:m==="FALSE"?f[l][c]=!1:isNaN(Gn(p))?isNaN(qo(p).getDate())?f[l][c]=p:f[l][c]=tr(p):f[l][c]=Gn(p),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(s,a){return pl(e(s,a),a)}function n(s,a){return Ks(r(s,a),a)}var i=function(){var s=function(l,c,u,f,h){l.push(c),l.push(u+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},a=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=Ct(l["!ref"]),f,h=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){a(c,-1,0,"BOT");for(var p=u.s.c;p<=u.e.c;++p){var m=Le({r:d,c:p});if(f=h?(l[d]||[])[p]:l[m],!f){a(c,1,0,"");continue}switch(f.t){case"n":var v=f.w;!v&&f.v!=null&&(v=f.v),v==null?f.f&&!f.F?a(c,1,0,"="+f.f):a(c,1,0,""):a(c,0,v,"V");break;case"b":a(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Dn(f.z||be[14],Wr(tr(f.v)))),a(c,0,f.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var x=`\r
`,_=c.join(x);return _}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),$U=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var d=f.split(`
`),p=-1,m=-1,v=0,x=[];v!==d.length;++v){var _=d[v].trim().split(":");if(_[0]==="cell"){var g=jr(_[1]);if(x.length<=g.r)for(p=x.length;p<=g.r;++p)x[p]||(x[p]=[]);switch(p=g.r,m=g.c,_[2]){case"t":x[p][m]=e(_[3]);break;case"v":x[p][m]=+_[3];break;case"vtf":var w=_[_.length-1];case"vtc":switch(_[3]){case"nl":x[p][m]=!!+_[4];break;default:x[p][m]=+_[4];break}_[2]=="vtf"&&(x[p][m]=[x[p][m],w])}}}return h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),x}function n(f,h){return pl(r(f,h),h)}function i(f,h){return Ks(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],d=[],p,m="",v=dl(f["!ref"]),x=Array.isArray(f),_=v.s.r;_<=v.e.r;++_)for(var g=v.s.c;g<=v.e.c;++g)if(m=Le({r:_,c:g}),p=x?(f[_]||[])[g]:f[m],!(!p||p.v==null||p.t==="z")){switch(d=["cell",m,"t"],p.t){case"s":case"str":d.push(t(p.v));break;case"n":p.f?(d[2]="vtf",d[3]="n",d[4]=p.v,d[5]=t(p.f)):(d[2]="v",d[3]=p.v);break;case"b":d[2]="vt"+(p.f?"f":"c"),d[3]="nl",d[4]=p.v?"1":"0",d[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var w=Wr(tr(p.v));d[2]="vtc",d[3]="nd",d[4]=""+w,d[5]=p.w||Dn(p.z||be[14],w);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[s,a,o,a,c(f),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),au=function(){function e(u,f,h,d,p){p.raw?f[h][d]=u:u===""||(u==="TRUE"?f[h][d]=!0:u==="FALSE"?f[h][d]=!1:isNaN(Gn(u))?isNaN(qo(u).getDate())?f[h][d]=u:f[h][d]=tr(u):f[h][d]=Gn(u))}function t(u,f){var h=f||{},d=[];if(!u||u.length===0)return d;for(var p=u.split(/[\r\n]/),m=p.length-1;m>=0&&p[m].length===0;)--m;for(var v=10,x=0,_=0;_<=m;++_)x=p[_].indexOf(" "),x==-1?x=p[_].length:x++,v=Math.max(v,x);for(_=0;_<=m;++_){d[_]=[];var g=0;for(e(p[_].slice(0,v).trim(),d,_,g,h),g=1;g<=(p[_].length-v)/10+1;++g)e(p[_].slice(v+(g-1)*10,v+g*10).trim(),d,_,g,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var f={},h=!1,d=0,p=0;d<u.length;++d)(p=u.charCodeAt(d))==34?h=!h:!h&&p in r&&(f[p]=(f[p]||0)+1);p=[];for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&p.push([f[d],d]);if(!p.length){f=n;for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&p.push([f[d],d])}return p.sort(function(m,v){return m[0]-v[0]||n[m[1]]-n[v[1]]}),r[p.pop()[1]]||44}function s(u,f){var h=f||{},d="",p=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=i(u.slice(0,1024)):h&&h.FS?d=h.FS:d=i(u.slice(0,1024));var v=0,x=0,_=0,g=0,w=0,T=d.charCodeAt(0),k=!1,y=0,P=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var O=h.dateNF!=null?Z9(h.dateNF):null;function U(){var j=u.slice(g,w),M={};if(j.charAt(0)=='"'&&j.charAt(j.length-1)=='"'&&(j=j.slice(1,-1).replace(/""/g,'"')),j.length===0)M.t="z";else if(h.raw)M.t="s",M.v=j;else if(j.trim().length===0)M.t="s",M.v=j;else if(j.charCodeAt(0)==61)j.charCodeAt(1)==34&&j.charCodeAt(j.length-1)==34?(M.t="s",M.v=j.slice(2,-1).replace(/""/g,'"')):I$(j)?(M.t="n",M.f=j.slice(1)):(M.t="s",M.v=j);else if(j=="TRUE")M.t="b",M.v=!0;else if(j=="FALSE")M.t="b",M.v=!1;else if(!isNaN(_=Gn(j)))M.t="n",h.cellText!==!1&&(M.w=j),M.v=_;else if(!isNaN(qo(j).getDate())||O&&j.match(O)){M.z=h.dateNF||be[14];var X=0;O&&j.match(O)&&(j=eV(j,h.dateNF,j.match(O)||[]),X=1),h.cellDates?(M.t="d",M.v=tr(j,X)):(M.t="n",M.v=Wr(tr(j,X))),h.cellText!==!1&&(M.w=Dn(M.z,M.v instanceof Date?Wr(M.v):M.v)),h.cellNF||delete M.z}else M.t="s",M.v=j;if(M.t=="z"||(h.dense?(p[v]||(p[v]=[]),p[v][x]=M):p[Le({c:x,r:v})]=M),g=w+1,P=u.charCodeAt(g),m.e.c<x&&(m.e.c=x),m.e.r<v&&(m.e.r=v),y==T)++x;else if(x=0,++v,h.sheetRows&&h.sheetRows<=v)return!0}e:for(;w<u.length;++w)switch(y=u.charCodeAt(w)){case 34:P===34&&(k=!k);break;case T:case 10:case 13:if(!k&&U())break e;break}return w-g>0&&U(),p["!ref"]=Ye(m),p}function a(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,f):pl(t(u,f),f)}function o(u,f){var h="",d=f.type=="string"?[0,0,0,0]:O_(u,f);switch(f.type){case"base64":h=_n(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof os<"u"?h=os.utils.decode(f.codepage,u):h=Ke&&Buffer.isBuffer(u)?u.toString("binary"):ja(u);break;case"array":h=Fa(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=ot(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=ot(h):f.type=="binary"&&typeof os<"u"&&f.codepage&&(h=os.utils.decode(f.codepage,os.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?$U.to_sheet(f.type=="string"?h:ot(h),f):a(h,f)}function l(u,f){return Ks(o(u,f),f)}function c(u){for(var f=[],h=Ct(u["!ref"]),d,p=Array.isArray(u),m=h.s.r;m<=h.e.r;++m){for(var v=[],x=h.s.c;x<=h.e.c;++x){var _=Le({r:m,c:x});if(d=p?(u[m]||[])[x]:u[_],!d||d.v==null){v.push("          ");continue}for(var g=(d.w||(Hi(d),d.w)||"").slice(0,10);g.length<10;)g+=" ";v.push(g+(x===0?" ":""))}f.push(v.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function jU(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=BU.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return au.to_workbook(e,t)}}var pc=function(){function e(F,H,B){if(F){ar(F,F.l||0);for(var V=B.Enum||ce;F.l<F.length;){var J=F.read_shift(2),de=V[J]||V[65535],xe=F.read_shift(2),me=F.l+xe,ae=de.f&&de.f(F,xe,B);if(F.l=me,H(ae,de,J))return}}}function t(F,H){switch(H.type){case"base64":return r($n(_n(F)),H);case"binary":return r($n(F),H);case"buffer":case"array":return r(F,H)}throw"Unsupported type "+H.type}function r(F,H){if(!F)return F;var B=H||{},V=B.dense?[]:{},J="Sheet1",de="",xe=0,me={},ae=[],He=[],L={s:{r:0,c:0},e:{r:0,c:0}},pt=B.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)B.Enum=ce,e(F,function(I,W,Y){switch(Y){case 0:B.vers=I,I>=4096&&(B.qpro=!0);break;case 6:L=I;break;case 204:I&&(de=I);break;case 222:de=I;break;case 15:case 51:B.qpro||(I[1].v=I[1].v.slice(1));case 13:case 14:case 16:Y==14&&(I[2]&112)==112&&(I[2]&15)>1&&(I[2]&15)<15&&(I[1].z=B.dateNF||be[14],B.cellDates&&(I[1].t="d",I[1].v=wd(I[1].v))),B.qpro&&I[3]>xe&&(V["!ref"]=Ye(L),me[J]=V,ae.push(J),V=B.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},xe=I[3],J=de||"Sheet"+(xe+1),de="");var we=B.dense?(V[I[0].r]||[])[I[0].c]:V[Le(I[0])];if(we){we.t=I[1].t,we.v=I[1].v,I[1].z!=null&&(we.z=I[1].z),I[1].f!=null&&(we.f=I[1].f);break}B.dense?(V[I[0].r]||(V[I[0].r]=[]),V[I[0].r][I[0].c]=I[1]):V[Le(I[0])]=I[1];break}},B);else if(F[2]==26||F[2]==14)B.Enum=Ee,F[2]==14&&(B.qpro=!0,F.l=0),e(F,function(I,W,Y){switch(Y){case 204:J=I;break;case 22:I[1].v=I[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(I[3]>xe&&(V["!ref"]=Ye(L),me[J]=V,ae.push(J),V=B.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},xe=I[3],J="Sheet"+(xe+1)),pt>0&&I[0].r>=pt)break;B.dense?(V[I[0].r]||(V[I[0].r]=[]),V[I[0].r][I[0].c]=I[1]):V[Le(I[0])]=I[1],L.e.c<I[0].c&&(L.e.c=I[0].c),L.e.r<I[0].r&&(L.e.r=I[0].r);break;case 27:I[14e3]&&(He[I[14e3][0]]=I[14e3][1]);break;case 1537:He[I[0]]=I[1],I[0]==xe&&(J=I[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(V["!ref"]=Ye(L),me[de||J]=V,ae.push(de||J),!He.length)return{SheetNames:ae,Sheets:me};for(var Qe={},it=[],Ue=0;Ue<He.length;++Ue)me[ae[Ue]]?(it.push(He[Ue]||ae[Ue]),Qe[He[Ue]]=me[He[Ue]]||me[ae[Ue]]):(it.push(He[Ue]),Qe[He[Ue]]={"!ref":"A1"});return{SheetNames:it,Sheets:Qe}}function n(F,H){var B=H||{};if(+B.codepage>=0&&jn(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var V=Cg(),J=Ct(F["!ref"]),de=Array.isArray(F),xe=[];bn(V,0,s(1030)),bn(V,6,l(J));for(var me=Math.min(J.e.r,8191),ae=J.s.r;ae<=me;++ae)for(var He=dr(ae),L=J.s.c;L<=J.e.c;++L){ae===J.s.r&&(xe[L]=Gt(L));var pt=xe[L]+He,Qe=de?(F[ae]||[])[L]:F[pt];if(!(!Qe||Qe.t=="z"))if(Qe.t=="n")(Qe.v|0)==Qe.v&&Qe.v>=-32768&&Qe.v<=32767?bn(V,13,d(ae,L,Qe.v)):bn(V,14,m(ae,L,Qe.v));else{var it=Hi(Qe);bn(V,15,f(ae,L,it.slice(0,239)))}}return bn(V,1),V.end()}function i(F,H){var B=H||{};if(+B.codepage>=0&&jn(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var V=Cg();bn(V,0,a(F));for(var J=0,de=0;J<F.SheetNames.length;++J)(F.Sheets[F.SheetNames[J]]||{})["!ref"]&&bn(V,27,b(F.SheetNames[J],de++));var xe=0;for(J=0;J<F.SheetNames.length;++J){var me=F.Sheets[F.SheetNames[J]];if(!(!me||!me["!ref"])){for(var ae=Ct(me["!ref"]),He=Array.isArray(me),L=[],pt=Math.min(ae.e.r,8191),Qe=ae.s.r;Qe<=pt;++Qe)for(var it=dr(Qe),Ue=ae.s.c;Ue<=ae.e.c;++Ue){Qe===ae.s.r&&(L[Ue]=Gt(Ue));var I=L[Ue]+it,W=He?(me[Qe]||[])[Ue]:me[I];if(!(!W||W.t=="z"))if(W.t=="n")bn(V,23,U(Qe,Ue,xe,W.v));else{var Y=Hi(W);bn(V,22,y(Qe,Ue,xe,Y.slice(0,239)))}}++xe}}return bn(V,1),V.end()}function s(F){var H=zt(2);return H.write_shift(2,F),H}function a(F){var H=zt(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var B=0,V=0,J=0,de=0;de<F.SheetNames.length;++de){var xe=F.SheetNames[de],me=F.Sheets[xe];if(!(!me||!me["!ref"])){++J;var ae=dl(me["!ref"]);B<ae.e.r&&(B=ae.e.r),V<ae.e.c&&(V=ae.e.c)}}return B>8191&&(B=8191),H.write_shift(2,B),H.write_shift(1,J),H.write_shift(1,V),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function o(F,H,B){var V={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&B.qpro?(V.s.c=F.read_shift(1),F.l++,V.s.r=F.read_shift(2),V.e.c=F.read_shift(1),F.l++,V.e.r=F.read_shift(2),V):(V.s.c=F.read_shift(2),V.s.r=F.read_shift(2),H==12&&B.qpro&&(F.l+=2),V.e.c=F.read_shift(2),V.e.r=F.read_shift(2),H==12&&B.qpro&&(F.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function l(F){var H=zt(8);return H.write_shift(2,F.s.c),H.write_shift(2,F.s.r),H.write_shift(2,F.e.c),H.write_shift(2,F.e.r),H}function c(F,H,B){var V=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(V[0].c=F.read_shift(1),V[3]=F.read_shift(1),V[0].r=F.read_shift(2),F.l+=2):(V[2]=F.read_shift(1),V[0].c=F.read_shift(2),V[0].r=F.read_shift(2)),V}function u(F,H,B){var V=F.l+H,J=c(F,H,B);if(J[1].t="s",B.vers==20768){F.l++;var de=F.read_shift(1);return J[1].v=F.read_shift(de,"utf8"),J}return B.qpro&&F.l++,J[1].v=F.read_shift(V-F.l,"cstr"),J}function f(F,H,B){var V=zt(7+B.length);V.write_shift(1,255),V.write_shift(2,H),V.write_shift(2,F),V.write_shift(1,39);for(var J=0;J<V.length;++J){var de=B.charCodeAt(J);V.write_shift(1,de>=128?95:de)}return V.write_shift(1,0),V}function h(F,H,B){var V=c(F,H,B);return V[1].v=F.read_shift(2,"i"),V}function d(F,H,B){var V=zt(7);return V.write_shift(1,255),V.write_shift(2,H),V.write_shift(2,F),V.write_shift(2,B,"i"),V}function p(F,H,B){var V=c(F,H,B);return V[1].v=F.read_shift(8,"f"),V}function m(F,H,B){var V=zt(13);return V.write_shift(1,255),V.write_shift(2,H),V.write_shift(2,F),V.write_shift(8,B,"f"),V}function v(F,H,B){var V=F.l+H,J=c(F,H,B);if(J[1].v=F.read_shift(8,"f"),B.qpro)F.l=V;else{var de=F.read_shift(2);w(F.slice(F.l,F.l+de),J),F.l+=de}return J}function x(F,H,B){var V=H&32768;return H&=-32769,H=(V?F:0)+(H>=8192?H-16384:H),(V?"":"$")+(B?Gt(H):dr(H))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(F,H){ar(F,0);for(var B=[],V=0,J="",de="",xe="",me="";F.l<F.length;){var ae=F[F.l++];switch(ae){case 0:B.push(F.read_shift(8,"f"));break;case 1:de=x(H[0].c,F.read_shift(2),!0),J=x(H[0].r,F.read_shift(2),!1),B.push(de+J);break;case 2:{var He=x(H[0].c,F.read_shift(2),!0),L=x(H[0].r,F.read_shift(2),!1);de=x(H[0].c,F.read_shift(2),!0),J=x(H[0].r,F.read_shift(2),!1),B.push(He+L+":"+de+J)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(F.read_shift(2));break;case 6:{for(var pt="";ae=F[F.l++];)pt+=String.fromCharCode(ae);B.push('"'+pt.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:me=B.pop(),xe=B.pop(),B.push(["AND","OR"][ae-20]+"("+xe+","+me+")");break;default:if(ae<32&&g[ae])me=B.pop(),xe=B.pop(),B.push(xe+g[ae]+me);else if(_[ae]){if(V=_[ae][1],V==69&&(V=F[F.l++]),V>B.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+B.join("|")+"|");return}var Qe=B.slice(-V);B.length-=V,B.push(_[ae][0]+"("+Qe.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}B.length==1?H[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function T(F){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=F.read_shift(2),H[3]=F[F.l++],H[0].c=F[F.l++],H}function k(F,H){var B=T(F);return B[1].t="s",B[1].v=F.read_shift(H-4,"cstr"),B}function y(F,H,B,V){var J=zt(6+V.length);J.write_shift(2,F),J.write_shift(1,B),J.write_shift(1,H),J.write_shift(1,39);for(var de=0;de<V.length;++de){var xe=V.charCodeAt(de);J.write_shift(1,xe>=128?95:xe)}return J.write_shift(1,0),J}function P(F,H){var B=T(F);B[1].v=F.read_shift(2);var V=B[1].v>>1;if(B[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return B[1].v=V,B}function O(F,H){var B=T(F),V=F.read_shift(4),J=F.read_shift(4),de=F.read_shift(2);if(de==65535)return V===0&&J===3221225472?(B[1].t="e",B[1].v=15):V===0&&J===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var xe=de&32768;return de=(de&32767)-16446,B[1].v=(1-xe*2)*(J*Math.pow(2,de+32)+V*Math.pow(2,de)),B}function U(F,H,B,V){var J=zt(14);if(J.write_shift(2,F),J.write_shift(1,B),J.write_shift(1,H),V==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var de=0,xe=0,me=0,ae=0;return V<0&&(de=1,V=-V),xe=Math.log2(V)|0,V/=Math.pow(2,xe-31),ae=V>>>0,ae&2147483648||(V/=2,++xe,ae=V>>>0),V-=ae,ae|=2147483648,ae>>>=0,V*=Math.pow(2,32),me=V>>>0,J.write_shift(4,me),J.write_shift(4,ae),xe+=16383+(de?32768:0),J.write_shift(2,xe),J}function j(F,H){var B=O(F);return F.l+=H-14,B}function M(F,H){var B=T(F),V=F.read_shift(4);return B[1].v=V>>6,B}function X(F,H){var B=T(F),V=F.read_shift(8,"f");return B[1].v=V,B}function ne(F,H){var B=X(F);return F.l+=H-10,B}function re(F,H){return F[F.l+H-1]==0?F.read_shift(H,"cstr"):""}function se(F,H){var B=F[F.l++];B>H-1&&(B=H-1);for(var V="";V.length<B;)V+=String.fromCharCode(F[F.l++]);return V}function ue(F,H,B){if(!(!B.qpro||H<21)){var V=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var J=F.read_shift(H-21,"cstr");return[V,J]}}function te(F,H){for(var B={},V=F.l+H;F.l<V;){var J=F.read_shift(2);if(J==14e3){for(B[J]=[0,""],B[J][0]=F.read_shift(2);F[F.l];)B[J][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return B}function b(F,H){var B=zt(5+F.length);B.write_shift(2,14e3),B.write_shift(2,H);for(var V=0;V<F.length;++V){var J=F.charCodeAt(V);B[B.l++]=J>127?95:J}return B[B.l++]=0,B}var ce={0:{n:"BOF",f:Lt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:se},65535:{n:""}},Ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:j},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:te},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:X},40:{n:"FORMULA28",f:ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function zU(e){var t={},r=e.match(Or),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Pe(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=u_[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var HU=function(){var e=iu("t"),t=iu("rPr");function r(s){var a=s.match(e);if(!a)return{t:"s",v:""};var o={t:"s",v:Ze(a[1])},l=s.match(t);return l&&(o.s=zU(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),WU=function(){var t=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),GU=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,KU=/<(?:\w+:)?r>/,qU=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function I_(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ze(ot(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ot(e),r&&(n.h=v_(n.t))):e.match(KU)&&(n.r=ot(e),n.t=Ze(ot((e.replace(qU,"").match(GU)||[]).join("").replace(Or,""))),r&&(n.h=WU(HU(n.r)))),n):{t:""}}var XU=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,YU=/<(?:\w+:)?(?:si|sstItem)>/g,QU=/<\/(?:\w+:)?(?:si|sstItem)>/;function JU(e,t){var r=[],n="";if(!e)return r;var i=e.match(XU);if(i){n=i[2].replace(YU,"").split(QU);for(var s=0;s!=n.length;++s){var a=I_(n[s].trim(),t);a!=null&&(r[r.length]=a)}i=Pe(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function ZU(e){return[e.read_shift(4),e.read_shift(4)]}function e7(e,t){var r=[],n=!1;return Ki(e,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function aR(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Li(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function t7(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Li(e,4),t.U=Li(e,4),t.W=Li(e,4),t}function r7(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function n7(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(r7(e));return t}function i7(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function s7(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Li(e,4),t.U=Li(e,4),t.W=Li(e,4),t}function a7(e){var t=s7(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function oR(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function lR(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function o7(e){var t=Li(e);switch(t.Minor){case 2:return[t.Minor,l7(e)];case 3:return[t.Minor,c7()];case 4:return[t.Minor,u7(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function l7(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=oR(e,r),i=lR(e,e.length-e.l);return{t:"Std",h:n,v:i}}function c7(){throw new Error("File is password-protected: ECMA-376 Extensible")}function u7(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Or,function(s){var a=Pe(s);switch(yi(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function f7(e,t){var r={},n=r.EncryptionVersionInfo=Li(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=oR(e,i),t-=i,r.EncryptionVerifier=lR(e,t),r}function h7(e){var t={},r=t.EncryptionVersionInfo=Li(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function d7(e){var t=0,r,n=aR(e),i=n.length+1,s,a,o,l,c;for(r=Vs(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^a;return t^52811}var cR=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=t[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var u=a[c],f=0;f!=7;++f)u&64&&(o^=r[l]),u*=2,--l;return o};return function(a){for(var o=aR(a),l=s(o),c=o.length,u=Vs(16),f=0;f!=16;++f)u[f]=0;var h,d,p;for((c&1)===1&&(h=l>>8,u[c]=i(e[0],h),--c,h=l&255,d=o[o.length-1],u[c]=i(d,h));c>0;)--c,h=l>>8,u[c]=i(o[c],h),--c,h=l&255,u[c]=i(o[c],h);for(c=15,p=15-o.length;p>0;)h=l>>8,u[c]=i(e[p],h),--c,--p,h=l&255,u[c]=i(o[c],h),--c,--p;return u}}(),p7=function(e,t,r,n,i){i||(i=t),n||(n=cR(e));var s,a;for(s=0;s!=t.length;++s)a=t[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},m7=function(e){var t=0,r=cR(e);return function(n){var i=p7("",n,t,r);return t=i[1],i[0]}};function g7(e,t,r,n){var i={key:Lt(e),verificationBytes:Lt(e)};return r.password&&(i.verifier=d7(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=m7(r.password)),i}function v7(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=h7(e):n.Data=f7(e,t),n}function _7(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?v7(e,t-2,n):g7(e,r.biff>=8?t:t-2,r,n),n}var x7=function(){function e(i,s){switch(s.type){case"base64":return t(_n(i),s);case"binary":return t(i,s);case"buffer":return t(Ke&&Buffer.isBuffer(i)?i.toString("binary"):ja(i),s);case"array":return t(Fa(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,d=0,p,m=-1;p=h.exec(u);){switch(p[0]){case"\\cell":var v=u.slice(d,h.lastIndex-p[0].length);if(v[0]==" "&&(v=v.slice(1)),++m,v.length){var x={v,t:"s"};Array.isArray(o)?o[f][m]=x:o[Le({r:f,c:m})]=x}break}d=h.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=Ye(c),o}function r(i,s){return Ks(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Ct(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var f=Le({r:c,c:u});o=l?(i[c]||[])[u]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Hi(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function y7(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ou(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function E7(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),a=i-s;if(a===0)return[0,0,t];var o=0,l=0,c=i+s;switch(l=a/(c>1?2-c:c),i){case t:o=((r-n)/a+6)%6;break;case r:o=(n-t)/a+2;break;case n:o=(t-r)/a+4;break}return[o/6,l,c/2]}function w7(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function m0(e,t){if(t===0)return e;var r=E7(y7(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ou(w7(r))}var uR=6,T7=15,k7=1,Ur=uR;function g0(e){return Math.floor((e+Math.round(128/Ur)/256)*Ur)}function v0(e){return Math.floor((e-5)/Ur*100+.5)/100}function Ng(e){return Math.round((e*Ur+5)/Ur*256)/256}function $p(e){return Ng(v0(g0(e)))}function C_(e){var t=Math.abs(e-$p(e)),r=Ur;if(t>.005)for(Ur=k7;Ur<T7;++Ur)Math.abs(e-$p(e))<=t&&(t=Math.abs(e-$p(e)),r=Ur);Ur=r}function Xo(e){e.width?(e.wpx=g0(e.width),e.wch=v0(e.wpx),e.MDW=Ur):e.wpx?(e.wch=v0(e.wpx),e.width=Ng(e.wch),e.MDW=Ur):typeof e.wch=="number"&&(e.width=Ng(e.wch),e.wpx=g0(e.width),e.MDW=Ur),e.customWidth&&delete e.customWidth}var A7=96,fR=A7;function hR(e){return e*96/fR}function lu(e){return e*fR/96}var S7={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function I7(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(Or)||[]).forEach(function(a){var o=Pe(a);switch(yi(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=gt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=gt(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function C7(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(Or)||[]).forEach(function(a){var o=Pe(a);switch(yi(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function R7(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(Or)||[]).forEach(function(a){var o=Pe(a);switch(yi(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=ot(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?gt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?gt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?gt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?gt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?gt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?gt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?gt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=u_[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=gt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=va[i.color.index];i.color.index==81&&(l=va[1]),l||(l=va[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=m0(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function P7(e,t,r){t.NumberFmt=[];for(var n=_i(be),i=0;i<n.length;++i)t.NumberFmt[n[i]]=be[n[i]];var s=e[0].match(Or);if(s)for(i=0;i<s.length;++i){var a=Pe(s[i]);switch(yi(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ze(ot(a.formatCode)),l=parseInt(a.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}ga(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var Nf=["numFmtId","fillId","fontId","borderId","xfId"],Df=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function F7(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Or)||[]).forEach(function(s){var a=Pe(s),o=0;switch(yi(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Nf.length;++o)n[Nf[o]]&&(n[Nf[o]]=parseInt(n[Nf[o]],10));for(o=0;o<Df.length;++o)n[Df[o]]&&(n[Df[o]]=gt(n[Df[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=gt(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var N7=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&P7(f,u,c),(f=o.match(i))&&R7(f,u,l,c),(f=o.match(n))&&C7(f,u,l,c),(f=o.match(s))&&I7(f,u,l,c),(f=o.match(r))&&F7(f,u,c),u}}();function D7(e,t){var r=e.read_shift(2),n=Rr(e);return[r,n]}function O7(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=HV(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=zV(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Rr(e),n}var L7=Dr;function M7(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var b7=Dr;function V7(e,t,r){var n={};n.NumberFmt=[];for(var i in be)n.NumberFmt[i]=be[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return Ki(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],ga(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=m0(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(u),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var B7=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function U7(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Or)||[]).forEach(function(i){var s=Pe(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[B7.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function $7(){}function j7(){}var z7=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,H7=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,W7=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function G7(e,t,r){t.themeElements={};var n;[["clrScheme",z7,U7],["fontScheme",H7,$7],["fmtScheme",W7,j7]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var K7=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function dR(e,t){(!e||e.length===0)&&(e=q7());var r,n={};if(!(r=e.match(K7)))throw new Error("themeElements not found in theme");return G7(r[0],n,t),n.raw=e,n}function q7(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[kC];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function X7(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var a;try{a=TC(s,{type:"array"})}catch{return}var o=un(a,"theme/theme/theme1.xml",!0);if(o)return dR(o,r)}}function Y7(e){return e.read_shift(4)}function Q7(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=J7(e,4);break;case 2:t.xclrValue=ZC(e);break;case 3:t.xclrValue=Y7(e);break;case 4:e.l+=4;break}return e.l+=8,t}function J7(e,t){return Dr(e,t)}function Z7(e,t){return Dr(e,t)}function e$(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Q7(e);break;case 6:n[1]=Z7(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function t$(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(e$(e,r-e.l));return{ixfe:n,ext:s}}function r$(e,t){t.forEach(function(r){switch(r[0]){}})}function n$(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Rr(e)}}function i$(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function s$(e){return e.l+=4,e.read_shift(4)!=0}function a$(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return Ki(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(u),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function o$(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,a;return e.replace(Or,function(o){var l=Pe(o);switch(yi(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function l$(e){var t=[];if(!e)return t;var r=1;return(e.match(Or)||[]).forEach(function(n){var i=Pe(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function c$(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Le(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function u$(e,t,r){var n=[];return Ki(e,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function f$(e,t,r,n){if(!e)return e;var i=n||{},s=!1;Ki(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function h$(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function ww(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(a){var o=jr(a.ref);if(i?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[a.ref],!s){s={t:"z"},i?e[o.r][o.c]=s:e[a.ref]=s;var l=Ct(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Ye(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var u={a:a.author,t:a.t,r:a.r,T:r};a.h&&(u.h=a.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}s.c.push(u)})}function d$(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Pe(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=jr(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&I_(f[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function p$(e,t){var r=[],n=!1,i={},s=0;return e.replace(Or,function(o,l){var c=Pe(o);switch(yi(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function m$(e,t){var r=[],n=!1;return e.replace(Or,function(s){var a=Pe(s);switch(yi(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function g$(e){var t={};t.iauthor=e.read_shift(4);var r=Ha(e);return t.rfx=r.s,t.ref=Le(r.s),e.l+=16,t}var v$=Rr;function _$(e,t){var r=[],n=[],i={},s=!1;return Ki(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var x$="application/vnd.ms-office.vbaProject";function y$(e){var t=Xe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Xe.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Xe.write(t)}function E$(){return{"!type":"dialog"}}function w$(){return{"!type":"dialog"}}function T$(){return{"!type":"macro"}}function k$(){return{"!type":"macro"}}var Po=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,i+(o?"":"$")+Gt(u)+(l?"":"$")+dr(c)}return function(i,s){return t=s,i.replace(e,r)}}(),pR=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,A$=function(){return function(t,r){return t.replace(pR,function(n,i,s,a,o,l){var c=E_(a)-(s?0:r.c),u=y_(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",h=c==0?"":s?c+1:"["+c+"]";return i+"R"+f+"C"+h})}}();function mR(e,t){return e.replace(pR,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Gt(E_(s)+t.c))+(a=="$"?a+o:dr(y_(o)+t.r))})}function S$(e,t,r){var n=dl(t),i=n.s,s=jr(r),a={r:s.r-i.r,c:s.c-i.c};return mR(e,a)}function I$(e){return e.length!=1}function Tw(e){return e.replace(/_xlfn\./g,"")}function Nt(e){e.l+=1}function Bs(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function gR(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return vR(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),a=Bs(e,2),o=Bs(e,2);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function vR(e){var t=Bs(e,2),r=Bs(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function C$(e,t,r){if(r.biff<8)return vR(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=Bs(e,2),a=Bs(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function _R(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return R$(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Bs(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function R$(e){var t=Bs(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function P$(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function F$(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return N$(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function N$(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function D$(e,t,r){var n=(e[e.l++]&96)>>5,i=gR(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function O$(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=gR(e,s,r);return[n,i,a]}function L$(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function M$(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function b$(e,t,r){var n=(e[e.l++]&96)>>5,i=C$(e,t-1,r);return[n,i]}function V$(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function kw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function B$(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function U$(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function $$(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function j$(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function z$(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function xR(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function H$(e){return e.read_shift(2),xR(e)}function W$(e){return e.read_shift(2),xR(e)}function G$(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=_R(e,0,r);return[n,i]}function K$(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=F$(e,0,r);return[n,i]}function q$(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=_R(e,0,r);return[n,i,s]}function X$(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[Yj[i],wR[i],n]}function Y$(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Q$(e);return[i,(s[0]===0?wR:Xj)[s[1]]]}function Q$(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function J$(e,t,r){e.l+=r&&r.biff==2?3:4}function Z$(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function ej(e){return e.l++,Wa[e.read_shift(1)]}function tj(e){return e.l++,e.read_shift(2)}function rj(e){return e.l++,e.read_shift(1)!==0}function nj(e){return e.l++,Ar(e)}function ij(e,t,r){return e.l++,Hu(e,t-1,r)}function sj(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Rt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Wa[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ar(e);break;case 2:r[1]=Ga(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function aj(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Ha:Td)(e));return i}function oj(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=sj(e,r.biff);return a}function lj(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function cj(e,t,r){if(r.biff==5)return uj(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function uj(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function fj(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function hj(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function dj(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function pj(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var mj=Dr,gj=Dr,vj=Dr;function Gu(e,t,r){return e.l+=2,[P$(e)]}function R_(e){return e.l+=6,[]}var _j=Gu,xj=R_,yj=R_,Ej=Gu;function yR(e){return e.l+=2,[Lt(e),e.read_shift(2)&1]}var wj=Gu,Tj=yR,kj=R_,Aj=Gu,Sj=Gu,Ij=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Cj(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=Ij[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:i,C:s}}function Rj(e){return e.l+=2,[e.read_shift(4)]}function Pj(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Fj(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Nj(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Dj(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Oj(e){return e.l+=4,[0,0]}var Aw={1:{n:"PtgExp",f:Z$},2:{n:"PtgTbl",f:vj},3:{n:"PtgAdd",f:Nt},4:{n:"PtgSub",f:Nt},5:{n:"PtgMul",f:Nt},6:{n:"PtgDiv",f:Nt},7:{n:"PtgPower",f:Nt},8:{n:"PtgConcat",f:Nt},9:{n:"PtgLt",f:Nt},10:{n:"PtgLe",f:Nt},11:{n:"PtgEq",f:Nt},12:{n:"PtgGe",f:Nt},13:{n:"PtgGt",f:Nt},14:{n:"PtgNe",f:Nt},15:{n:"PtgIsect",f:Nt},16:{n:"PtgUnion",f:Nt},17:{n:"PtgRange",f:Nt},18:{n:"PtgUplus",f:Nt},19:{n:"PtgUminus",f:Nt},20:{n:"PtgPercent",f:Nt},21:{n:"PtgParen",f:Nt},22:{n:"PtgMissArg",f:Nt},23:{n:"PtgStr",f:ij},26:{n:"PtgSheet",f:Pj},27:{n:"PtgEndSheet",f:Fj},28:{n:"PtgErr",f:ej},29:{n:"PtgBool",f:rj},30:{n:"PtgInt",f:tj},31:{n:"PtgNum",f:nj},32:{n:"PtgArray",f:V$},33:{n:"PtgFunc",f:X$},34:{n:"PtgFuncVar",f:Y$},35:{n:"PtgName",f:lj},36:{n:"PtgRef",f:G$},37:{n:"PtgArea",f:D$},38:{n:"PtgMemArea",f:fj},39:{n:"PtgMemErr",f:mj},40:{n:"PtgMemNoMem",f:gj},41:{n:"PtgMemFunc",f:hj},42:{n:"PtgRefErr",f:dj},43:{n:"PtgAreaErr",f:L$},44:{n:"PtgRefN",f:K$},45:{n:"PtgAreaN",f:b$},46:{n:"PtgMemAreaN",f:Nj},47:{n:"PtgMemNoMemN",f:Dj},57:{n:"PtgNameX",f:cj},58:{n:"PtgRef3d",f:q$},59:{n:"PtgArea3d",f:O$},60:{n:"PtgRefErr3d",f:pj},61:{n:"PtgAreaErr3d",f:M$},255:{}},Lj={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Mj={1:{n:"PtgElfLel",f:yR},2:{n:"PtgElfRw",f:Aj},3:{n:"PtgElfCol",f:_j},6:{n:"PtgElfRwV",f:Sj},7:{n:"PtgElfColV",f:Ej},10:{n:"PtgElfRadical",f:wj},11:{n:"PtgElfRadicalS",f:kj},13:{n:"PtgElfColS",f:xj},15:{n:"PtgElfColSV",f:yj},16:{n:"PtgElfRadicalLel",f:Tj},25:{n:"PtgList",f:Cj},29:{n:"PtgSxName",f:Rj},255:{}},bj={0:{n:"PtgAttrNoop",f:Oj},1:{n:"PtgAttrSemi",f:z$},2:{n:"PtgAttrIf",f:$$},4:{n:"PtgAttrChoose",f:B$},8:{n:"PtgAttrGoto",f:U$},16:{n:"PtgAttrSum",f:J$},32:{n:"PtgAttrBaxcel",f:kw},33:{n:"PtgAttrBaxcel",f:kw},64:{n:"PtgAttrSpace",f:H$},65:{n:"PtgAttrSpaceSemi",f:W$},128:{n:"PtgAttrIfError",f:j$},255:{}};function Ku(e,t,r,n){if(n.biff<8)return Dr(e,t);for(var i=e.l+t,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=oj(e,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=aj(e,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&s.push(Dr(e,t)),s}function qu(e,t,r){for(var n=e.l+t,i,s,a=[];n!=e.l;)t=n-e.l,s=e[e.l],i=Aw[s]||Aw[Lj[s]],(s===24||s===25)&&(i=(s===24?Mj:bj)[e[e.l+1]]),!i||!i.f?Dr(e,t):a.push([i.n,i.f(e,t,r)]);return a}function Vj(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var Bj={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Uj(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function ER(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Sw(e,t,r){var n=ER(e,t,r);return n=="#REF"?n:Uj(n,r)}function wr(e,t,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,f=0,h=0,d,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,v="",x=0,_=e[0].length;x<_;++x){var g=e[0][x];switch(g[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:v=St(" ",e[0][m][1][1]);break;case 1:v=St("\r",e[0][m][1][1]);break;default:if(v="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+v,m=-1}o.push(c+Bj[g[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=uc(g[1][1],a,i),o.push(fc(u,s));break;case"PtgRefN":u=r?uc(g[1][1],r,i):g[1][1],o.push(fc(u,s));break;case"PtgRef3d":f=g[1][1],u=uc(g[1][2],a,i),p=Sw(n,f,i),o.push(p+"!"+fc(u,s));break;case"PtgFunc":case"PtgFuncVar":var w=g[1][0],T=g[1][1];w||(w=0),w&=127;var k=w==0?[]:o.slice(-w);o.length-=w,T==="User"&&(T=k.shift()),o.push(T+"("+k.join(",")+")");break;case"PtgBool":o.push(g[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(g[1]);break;case"PtgNum":o.push(String(g[1]));break;case"PtgStr":o.push('"'+g[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(g[1]);break;case"PtgAreaN":d=aw(g[1][1],r?{s:r}:a,i),o.push(Bp(d,i));break;case"PtgArea":d=aw(g[1][1],a,i),o.push(Bp(d,i));break;case"PtgArea3d":f=g[1][1],d=g[1][2],p=Sw(n,f,i),o.push(p+"!"+Bp(d,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=g[1][2];var y=(n.names||[])[h-1]||(n[0]||[])[h],P=y?y.Name:"SH33TJSNAME"+String(h);P&&P.slice(0,6)=="_xlfn."&&!i.xlfn&&(P=P.slice(6)),o.push(P);break;case"PtgNameX":var O=g[1][1];h=g[1][2];var U;if(i.biff<=5)O<0&&(O=-O),n[O]&&(U=n[O][h]);else{var j="";if(((n[O]||[])[0]||[])[0]==14849||(((n[O]||[])[0]||[])[0]==1025?n[O][h]&&n[O][h].itab>0&&(j=n.SheetNames[n[O][h].itab-1]+"!"):j=n.SheetNames[h-1]+"!"),n[O]&&n[O][h])j+=n[O][h].Name;else if(n[0]&&n[0][h])j+=n[0][h].Name;else{var M=(ER(n,O,i)||"").split(";;");M[h-1]?j=M[h-1]:j+="SH33TJSERRX"}o.push(j);break}U||(U={Name:"SH33TJSERRY"}),o.push(U.Name);break;case"PtgParen":var X="(",ne=")";if(m>=0){switch(v="",e[0][m][1][0]){case 2:X=St(" ",e[0][m][1][1])+X;break;case 3:X=St("\r",e[0][m][1][1])+X;break;case 4:ne=St(" ",e[0][m][1][1])+ne;break;case 5:ne=St("\r",e[0][m][1][1])+ne;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(X+o.pop()+ne);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:g[1][1],r:g[1][0]};var re={c:r.c,r:r.r};if(n.sharedf[Le(u)]){var se=n.sharedf[Le(u)];o.push(wr(se,a,re,n,i))}else{var ue=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(wr(c[1],a,re,n,i)),ue=!0;break}ue||o.push(g[1])}break;case"PtgArray":o.push("{"+Vj(g[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+g[1].idx+"[#"+g[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(g));default:throw new Error("Unrecognized Formula Token: "+String(g))}var te=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&te.indexOf(e[0][x][0])==-1){g=e[0][m];var b=!0;switch(g[1][0]){case 4:b=!1;case 0:v=St(" ",g[1][1]);break;case 5:b=!1;case 1:v=St("\r",g[1][1]);break;default:if(v="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[1][0])}o.push((b?v:"")+o.pop()+(b?"":v)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function $j(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,a=e.read_shift(i);if(a==65535)return[[],Dr(e,t-2)];var o=qu(e,a,r);return t!==a+i&&(s=Ku(e,t-a-i,o,r)),e.l=n,[o,s]}function jj(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,a=e.read_shift(i);if(a==65535)return[[],Dr(e,t-2)];var o=qu(e,a,r);return t!==a+i&&(s=Ku(e,t-a-i,o,r)),e.l=n,[o,s]}function zj(e,t,r,n){var i=e.l+t,s=qu(e,n,r),a;return i!==e.l&&(a=Ku(e,i-e.l,s,r)),[s,a]}function Hj(e,t,r){var n=e.l+t,i,s=e.read_shift(2),a=qu(e,s,r);return s==65535?[[],Dr(e,t-2)]:(t!==s+2&&(i=Ku(e,n-s-2,a,r)),[a,i])}function Wj(e){var t;if(Fi(e,e.l+6)!==65535)return[Ar(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function jp(e,t,r){var n=e.l+t,i=Ei(e);r.biff==2&&++e.l;var s=Wj(e),a=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=jj(e,n-e.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function kd(e,t,r){var n=e.read_shift(4),i=qu(e,n,r),s=e.read_shift(4),a=s>0?Ku(e,s,i,r):null;return[i,a]}var Gj=kd,Ad=kd,Kj=kd,qj=kd,Xj={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},wR={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Yj={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Iw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function zp(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var mc={},Fo={};function gc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function TR(e,t,r,n,i,s){try{n.cellNF&&(e.z=be[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=tr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(be[t]==null&&ga(J9[t]||"General",t),e.t==="e")e.w=e.w||Wa[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=nu(e.v);else if(e.t==="d"){var a=Wr(e.v);(a|0)===a?e.w=a.toString(10):e.w=nu(a)}else{if(e.v===void 0)return"";e.w=Pa(e.v,Fo)}else e.t==="d"?e.w=Dn(t,Wr(e.v),Fo):e.w=Dn(t,e.v,Fo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=m0(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=m0(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function Qj(e,t){var r=Ct(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ye(r))}var Jj=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Zj=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,ez=/<(?:\w:)?hyperlink [^>]*>/mg,tz=/"(\w*:\w*)"/,rz=/<(?:\w:)?col\b[^>]*[\/]?>/g,nz=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,iz=/<(?:\w:)?pageMargins[^>]*\/>/g,kR=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,sz=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,az=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function oz(e,t,r,n,i,s,a){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=e.match(Zj);f?(c=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):c=u=e;var h=c.match(kR);h?P_(h[0],o,i,r):(h=c.match(sz))&&lz(h[0],h[1]||"",o,i,r);var d=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var p=c.slice(d,d+50).match(tz);p&&Qj(o,p[1])}var m=c.match(az);m&&m[1]&&pz(m[1],i);var v=[];if(t.cellStyles){var x=c.match(rz);x&&fz(v,x)}f&&mz(f[1],o,t,l,s,a);var _=u.match(nz);_&&(o["!autofilter"]=hz(_[0]));var g=[],w=u.match(Jj);if(w)for(d=0;d!=w.length;++d)g[d]=Ct(w[d].slice(w[d].indexOf('"')+1));var T=u.match(ez);T&&cz(o,T,n);var k=u.match(iz);if(k&&(o["!margins"]=uz(Pe(k[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Ye(l)),t.sheetRows>0&&o["!ref"]){var y=Ct(o["!ref"]);t.sheetRows<=+y.e.r&&(y.e.r=t.sheetRows-1,y.e.r>l.e.r&&(y.e.r=l.e.r),y.e.r<y.s.r&&(y.s.r=y.e.r),y.e.c>l.e.c&&(y.e.c=l.e.c),y.e.c<y.s.c&&(y.s.c=y.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ye(y))}return v.length>0&&(o["!cols"]=v),g.length>0&&(o["!merges"]=g),o}function P_(e,t,r,n){var i=Pe(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Ze(ot(i.codeName)))}function lz(e,t,r,n,i){P_(e.slice(0,e.indexOf(">")),r,n,i)}function cz(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Pe(ot(t[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Ze(s.location))):(s.Target="#"+Ze(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Ct(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Le({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function uz(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function fz(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Pe(t[n],!0);i.hidden&&(i.hidden=gt(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,C_(i.width)),Xo(i);s<=a;)e[s++]=hr(i)}}function hz(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var dz=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function pz(e,t){t.Views||(t.Views=[{}]),(e.match(dz)||[]).forEach(function(r,n){var i=Pe(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),gt(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var mz=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=iu("v"),a=iu("f");return function(l,c,u,f,h,d){for(var p=0,m="",v=[],x=[],_=0,g=0,w=0,T="",k,y,P=0,O=0,U,j,M=0,X=0,ne=Array.isArray(d.CellXf),re,se=[],ue=[],te=Array.isArray(c),b=[],ce={},Ee=!1,F=!!u.sheetStubs,H=l.split(t),B=0,V=H.length;B!=V;++B){m=H[B].trim();var J=m.length;if(J!==0){var de=0;e:for(p=0;p<J;++p)switch(m[p]){case">":if(m[p-1]!="/"){++p;break e}if(u&&u.cellStyles){if(y=Pe(m.slice(de,p),!0),P=y.r!=null?parseInt(y.r,10):P+1,O=-1,u.sheetRows&&u.sheetRows<P)continue;ce={},Ee=!1,y.ht&&(Ee=!0,ce.hpt=parseFloat(y.ht),ce.hpx=lu(ce.hpt)),y.hidden=="1"&&(Ee=!0,ce.hidden=!0),y.outlineLevel!=null&&(Ee=!0,ce.level=+y.outlineLevel),Ee&&(b[P-1]=ce)}break;case"<":de=p;break}if(de>=p)break;if(y=Pe(m.slice(de,p),!0),P=y.r!=null?parseInt(y.r,10):P+1,O=-1,!(u.sheetRows&&u.sheetRows<P)){f.s.r>P-1&&(f.s.r=P-1),f.e.r<P-1&&(f.e.r=P-1),u&&u.cellStyles&&(ce={},Ee=!1,y.ht&&(Ee=!0,ce.hpt=parseFloat(y.ht),ce.hpx=lu(ce.hpt)),y.hidden=="1"&&(Ee=!0,ce.hidden=!0),y.outlineLevel!=null&&(Ee=!0,ce.level=+y.outlineLevel),Ee&&(b[P-1]=ce)),v=m.slice(p).split(e);for(var xe=0;xe!=v.length&&v[xe].trim().charAt(0)=="<";++xe);for(v=v.slice(xe),p=0;p!=v.length;++p)if(m=v[p].trim(),m.length!==0){if(x=m.match(r),_=p,g=0,w=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,x!=null&&x.length===2){for(_=0,T=x[1],g=0;g!=T.length&&!((w=T.charCodeAt(g)-64)<1||w>26);++g)_=26*_+w;--_,O=_}else++O;for(g=0;g!=m.length&&m.charCodeAt(g)!==62;++g);if(++g,y=Pe(m.slice(0,g),!0),y.r||(y.r=Le({r:P-1,c:O})),T=m.slice(g),k={t:""},(x=T.match(s))!=null&&x[1]!==""&&(k.v=Ze(x[1])),u.cellFormula){if((x=T.match(a))!=null&&x[1]!==""){if(k.f=Ze(ot(x[1])).replace(/\r\n/g,`
`),u.xlfn||(k.f=Tw(k.f)),x[0].indexOf('t="array"')>-1)k.F=(T.match(i)||[])[1],k.F.indexOf(":")>-1&&se.push([Ct(k.F),k.F]);else if(x[0].indexOf('t="shared"')>-1){j=Pe(x[0]);var me=Ze(ot(x[1]));u.xlfn||(me=Tw(me)),ue[parseInt(j.si,10)]=[j,me,y.r]}}else(x=T.match(/<f[^>]*\/>/))&&(j=Pe(x[0]),ue[j.si]&&(k.f=S$(ue[j.si][1],ue[j.si][2],y.r)));var ae=jr(y.r);for(g=0;g<se.length;++g)ae.r>=se[g][0].s.r&&ae.r<=se[g][0].e.r&&ae.c>=se[g][0].s.c&&ae.c<=se[g][0].e.c&&(k.F=se[g][1])}if(y.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(F)k.t="z";else continue;else k.t=y.t||"n";switch(f.s.c>O&&(f.s.c=O),f.e.c<O&&(f.e.c=O),k.t){case"n":if(k.v==""||k.v==null){if(!F)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!F)continue;k.t="z"}else U=mc[parseInt(k.v,10)],k.v=U.t,k.r=U.r,u.cellHTML&&(k.h=U.h);break;case"str":k.t="s",k.v=k.v!=null?ot(k.v):"",u.cellHTML&&(k.h=v_(k.v));break;case"inlineStr":x=T.match(n),k.t="s",x!=null&&(U=I_(x[1]))?(k.v=U.t,u.cellHTML&&(k.h=U.h)):k.v="";break;case"b":k.v=gt(k.v);break;case"d":u.cellDates?k.v=tr(k.v,1):(k.v=Wr(tr(k.v,1)),k.t="n");break;case"e":(!u||u.cellText!==!1)&&(k.w=k.v),k.v=WC[k.v];break}if(M=X=0,re=null,ne&&y.s!==void 0&&(re=d.CellXf[y.s],re!=null&&(re.numFmtId!=null&&(M=re.numFmtId),u.cellStyles&&re.fillId!=null&&(X=re.fillId))),TR(k,M,X,u,h,d),u.cellDates&&ne&&k.t=="n"&&hl(be[M])&&(k.t="d",k.v=wd(k.v)),y.cm&&u.xlmeta){var He=(u.xlmeta.Cell||[])[+y.cm-1];He&&He.type=="XLDAPR"&&(k.D=!0)}if(te){var L=jr(y.r);c[L.r]||(c[L.r]=[]),c[L.r][L.c]=k}else c[y.r]=k}}}}b.length>0&&(c["!rows"]=b)}}();function gz(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}var vz=Ha;function _z(){}function xz(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=$V(e),r}function yz(e){var t=On(e);return[t]}function Ez(e){var t=za(e);return[t]}function wz(e){var t=On(e),r=e.read_shift(1);return[t,r,"b"]}function Tz(e){var t=za(e),r=e.read_shift(1);return[t,r,"b"]}function kz(e){var t=On(e),r=e.read_shift(1);return[t,r,"e"]}function Az(e){var t=za(e),r=e.read_shift(1);return[t,r,"e"]}function Sz(e){var t=On(e),r=e.read_shift(4);return[t,r,"s"]}function Iz(e){var t=za(e),r=e.read_shift(4);return[t,r,"s"]}function Cz(e){var t=On(e),r=Ar(e);return[t,r,"n"]}function AR(e){var t=za(e),r=Ar(e);return[t,r,"n"]}function Rz(e){var t=On(e),r=k_(e);return[t,r,"n"]}function Pz(e){var t=za(e),r=k_(e);return[t,r,"n"]}function Fz(e){var t=On(e),r=w_(e);return[t,r,"is"]}function Nz(e){var t=On(e),r=Rr(e);return[t,r,"str"]}function Dz(e){var t=za(e),r=Rr(e);return[t,r,"str"]}function Oz(e,t,r){var n=e.l+t,i=On(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=Ad(e,n-e.l,r);a[3]=wr(o,null,i,r.supbooks,r)}else e.l=n;return a}function Lz(e,t,r){var n=e.l+t,i=On(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=Ad(e,n-e.l,r);a[3]=wr(o,null,i,r.supbooks,r)}else e.l=n;return a}function Mz(e,t,r){var n=e.l+t,i=On(e);i.r=r["!row"];var s=Ar(e),a=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=Ad(e,n-e.l,r);a[3]=wr(o,null,i,r.supbooks,r)}else e.l=n;return a}function bz(e,t,r){var n=e.l+t,i=On(e);i.r=r["!row"];var s=Rr(e),a=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=Ad(e,n-e.l,r);a[3]=wr(o,null,i,r.supbooks,r)}else e.l=n;return a}var Vz=Ha;function Bz(e,t){var r=e.l+t,n=Ha(e),i=T_(e),s=Rr(e),a=Rr(e),o=Rr(e);e.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function Uz(){}function $z(e,t,r){var n=e.l+t,i=jC(e),s=e.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=Gj(e,n-e.l,r);a[1]=o}else e.l=n;return a}function jz(e,t,r){var n=e.l+t,i=Ha(e),s=[i];if(r.cellFormula){var a=qj(e,n-e.l,r);s[1]=a,e.l=n}else e.l=n;return s}var zz=["left","right","top","bottom","header","footer"];function Hz(e){var t={};return zz.forEach(function(r){t[r]=Ar(e)}),t}function Wz(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Gz(){}function Kz(){}function qz(e,t,r,n,i,s,a){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,d,p,m,v,x,_,g,w,T,k=[];o.biff=12,o["!row"]=0;var y=0,P=!1,O=[],U={},j=o.supbooks||i.supbooks||[[]];if(j.sharedf=U,j.arrayf=O,j.SheetNames=i.SheetNames||i.Sheets.map(function(te){return te.name}),!o.supbooks&&(o.supbooks=j,i.Names))for(var M=0;M<i.Names.length;++M)j[0][M+1]=i.Names[M];var X=[],ne=[],re=!1;_0[16]={n:"BrtShortReal",f:AR};var se;if(Ki(e,function(b,ce,Ee){if(!h)switch(Ee){case 148:c=b;break;case 0:d=b,o.sheetRows&&o.sheetRows<=d.r&&(h=!0),w=dr(v=d.r),o["!row"]=d.r,(b.hidden||b.hpt||b.level!=null)&&(b.hpt&&(b.hpx=lu(b.hpt)),ne[b.r]=b);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:b[2]},b[2]){case"n":p.v=b[1];break;case"s":g=mc[b[1]],p.v=g.t,p.r=g.r;break;case"b":p.v=!!b[1];break;case"e":p.v=b[1],o.cellText!==!1&&(p.w=Wa[p.v]);break;case"str":p.t="s",p.v=b[1];break;case"is":p.t="s",p.v=b[1].t;break}if((m=a.CellXf[b[0].iStyleRef])&&TR(p,m.numFmtId,null,o,s,a),x=b[0].c==-1?x+1:b[0].c,o.dense?(l[v]||(l[v]=[]),l[v][x]=p):l[Gt(x)+w]=p,o.cellFormula){for(P=!1,y=0;y<O.length;++y){var F=O[y];d.r>=F[0].s.r&&d.r<=F[0].e.r&&x>=F[0].s.c&&x<=F[0].e.c&&(p.F=Ye(F[0]),P=!0)}!P&&b.length>3&&(p.f=b[3])}if(u.s.r>d.r&&(u.s.r=d.r),u.s.c>x&&(u.s.c=x),u.e.r<d.r&&(u.e.r=d.r),u.e.c<x&&(u.e.c=x),o.cellDates&&m&&p.t=="n"&&hl(be[m.numFmtId])){var H=ua(p.v);H&&(p.t="d",p.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}se&&(se.type=="XLDAPR"&&(p.D=!0),se=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;p={t:"z",v:void 0},x=b[0].c==-1?x+1:b[0].c,o.dense?(l[v]||(l[v]=[]),l[v][x]=p):l[Gt(x)+w]=p,u.s.r>d.r&&(u.s.r=d.r),u.s.c>x&&(u.s.c=x),u.e.r<d.r&&(u.e.r=d.r),u.e.c<x&&(u.e.c=x),se&&(se.type=="XLDAPR"&&(p.D=!0),se=void 0);break;case 176:k.push(b);break;case 49:se=((o.xlmeta||{}).Cell||[])[b-1];break;case 494:var B=n["!id"][b.relId];for(B?(b.Target=B.Target,b.loc&&(b.Target+="#"+b.loc),b.Rel=B):b.relId==""&&(b.Target="#"+b.loc),v=b.rfx.s.r;v<=b.rfx.e.r;++v)for(x=b.rfx.s.c;x<=b.rfx.e.c;++x)o.dense?(l[v]||(l[v]=[]),l[v][x]||(l[v][x]={t:"z",v:void 0}),l[v][x].l=b):(_=Le({c:x,r:v}),l[_]||(l[_]={t:"z",v:void 0}),l[_].l=b);break;case 426:if(!o.cellFormula)break;O.push(b),T=o.dense?l[v][x]:l[Gt(x)+w],T.f=wr(b[1],u,{r:d.r,c:x},j,o),T.F=Ye(b[0]);break;case 427:if(!o.cellFormula)break;U[Le(b[0].s)]=b[1],T=o.dense?l[v][x]:l[Gt(x)+w],T.f=wr(b[1],u,{r:d.r,c:x},j,o);break;case 60:if(!o.cellStyles)break;for(;b.e>=b.s;)X[b.e--]={width:b.w/256,hidden:!!(b.flags&1),level:b.level},re||(re=!0,C_(b.w/256)),Xo(X[b.e+1]);break;case 161:l["!autofilter"]={ref:Ye(b)};break;case 476:l["!margins"]=b;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),b.name&&(i.Sheets[r].CodeName=b.name),(b.above||b.left)&&(l["!outline"]={above:b.above,left:b.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),b.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ce.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+Ee.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Ye(c||u)),o.sheetRows&&l["!ref"]){var ue=Ct(l["!ref"]);o.sheetRows<=+ue.e.r&&(ue.e.r=o.sheetRows-1,ue.e.r>u.e.r&&(ue.e.r=u.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>u.e.c&&(ue.e.c=u.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ye(ue))}return k.length>0&&(l["!merges"]=k),X.length>0&&(l["!cols"]=X),ne.length>0&&(l["!rows"]=ne),l}function Xz(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(t[+a[1]]=r?+a[2]:a[2])});var i=Ze((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function Yz(e,t,r,n,i,s){var a=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=Xz(f);u.s.r=u.s.c=0,u.e.c=o,c=Gt(o),h[0].forEach(function(d,p){a[c+dr(p)]={t:"n",v:d,z:h[1]},l=p}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(a["!ref"]=Ye(u)),a}function Qz(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=e.match(kR);return o&&P_(o[0],s,i,r),(a=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Jz(e,t){e.l+=10;var r=Rr(e);return{name:r}}function Zz(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Ki(e,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var SR=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],eH=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],tH=[],rH=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Cw(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=gt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Rw(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=gt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function IR(e){Rw(e.WBProps,SR),Rw(e.CalcPr,rH),Cw(e.WBView,eH),Cw(e.Sheets,tH),Fo.date1904=gt(e.WBProps.date1904)}var nH="][*?/\\".split("");function iH(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return nH.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var sH=/<\w+:workbook/;function aH(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(e.replace(Or,function(l,c){var u=Pe(l);switch(yi(u[0])){case"<?xml":break;case"<workbook":l.match(sH)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":SR.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=gt(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=ot(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Ze(ot(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=ot(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),gt(u.hidden||"0")&&(s.Hidden=!0),a=c+l.length;break;case"</definedName>":s.Ref=Ze(ot(e.slice(a,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),kV.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return IR(r),r}function oH(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Rg(e),r.name=Rr(e),r}function lH(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Rr(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function cH(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function uH(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=jV(e),a=Kj(e,0,r),o=T_(e);e.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function fH(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],_0[16]={n:"BrtFRTArchID$",f:cH},Ki(e,function(l,c,u){switch(u){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=wr(l.Ptg,null,null,a,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,l]):a[0]=[u,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),IR(r),r.Names=s,r.supbooks=a,r}function hH(e,t,r){return t.slice(-4)===".bin"?fH(e,r):aH(e,r)}function dH(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?qz(e,n,r,i,s,a,o):oz(e,n,r,i,s,a,o)}function pH(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?Zz(e,n,r,i,s):Qz(e,n,r,i,s)}function mH(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?T$():k$()}function gH(e,t,r,n,i,s,a,o){return t.slice(-4)===".bin"?E$():w$()}function vH(e,t,r,n){return t.slice(-4)===".bin"?V7(e,r,n):N7(e,r,n)}function _H(e,t,r){return dR(e,r)}function xH(e,t,r){return t.slice(-4)===".bin"?e7(e,r):JU(e,r)}function yH(e,t,r){return t.slice(-4)===".bin"?_$(e,r):d$(e,r)}function EH(e,t,r){return t.slice(-4)===".bin"?u$(e):l$(e)}function wH(e,t,r,n){return r.slice(-4)===".bin"?f$(e,t,r,n):void 0}function TH(e,t,r){return t.slice(-4)===".bin"?a$(e,t,r):o$(e,t,r)}var CR=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,RR=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Mn(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var i=e.match(CR),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(RR),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function kH(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(CR),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(RR),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var vc;function AH(e,t){var r=vc[e]||Ze(e);return r==="General"?Pa(t):Dn(r,t)}function SH(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=gt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=tr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ze(t)]=i}function IH(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Wa[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=nu(e.v):e.w=Pa(e.v):e.w=AH(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=vc[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&hl(n)){var i=ua(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function CH(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=S7[n.Pattern]||n.Pattern)}e[t.ID]=t}function RH(e,t,r,n,i,s,a,o,l,c){var u="General",f=n.StyleID,h={};c=c||{};var d=[],p=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&a&&(f=a.StyleID);s[f]!==void 0&&(s[f].nf&&(u=s[f].nf),s[f].Interior&&d.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=gt(e);break;case"String":n.t="s",n.r=QE(Ze(e)),n.v=e.indexOf("<")>-1?Ze(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(tr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ze(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=WC[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=QE(t||e));break}if(IH(n,u,c),c.cellFormula!==!1)if(n.Formula){var m=Ze(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Po(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Po("RC:RC",i):n.ArrayRange&&(n.F=Po(n.ArrayRange,i),l.push([Ct(n.F),n.F]))}else for(p=0;p<l.length;++p)i.r>=l[p][0].s.r&&i.r<=l[p][0].e.r&&i.c>=l[p][0].s.c&&i.c<=l[p][0].e.c&&(n.F=l[p][1]);c.cellStyles&&(d.forEach(function(v){!h.patternType&&v.patternType&&(h.patternType=v.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function PH(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Hp(e,t){var r=t||{};gC();var n=jl(__(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=ot(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=hr(r);return a.type="string",au.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(W){i.indexOf("<"+W)>=0&&(s=!0)}),s)return BH(n,r);vc={"General Number":"General","General Date":be[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":be[15],"Short Date":be[14],"Long Time":be[19],"Medium Time":be[18],"Short Time":be[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:be[2],Standard:be[4],Percent:be[10],Scientific:be[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},f=[],h=r.dense?[]:{},d="",p={},m={},v=Mn('<Data ss:Type="String">'),x=0,_=0,g=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},k={},y="",P=0,O=[],U={},j={},M=0,X=[],ne=[],re={},se=[],ue,te=!1,b=[],ce=[],Ee={},F=0,H=0,B={Sheets:[],WBProps:{date1904:!1}},V={};su.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";o=su.exec(n);)switch(o[3]=(J=o[3]).toLowerCase()){case"data":if(J=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?RH(n.slice(x,o.index),y,v,l[l.length-1][0]=="comment"?re:p,{c:_,r:g},T,se[_],m,b,r):(y="",v=Mn(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ne.length>0&&(p.c=ne),(!r.sheetRows||r.sheetRows>g)&&p.v!==void 0&&(r.dense?(h[g]||(h[g]=[]),h[g][_]=p):h[Gt(_)+dr(g)]=p),p.HRef&&(p.l={Target:Ze(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(F=_+(parseInt(p.MergeAcross,10)|0),H=g+(parseInt(p.MergeDown,10)|0),O.push({s:{c:_,r:g},e:{c:F,r:H}})),!r.sheetStubs)p.MergeAcross?_=F+1:++_;else if(p.MergeAcross||p.MergeDown){for(var de=_;de<=F;++de)for(var xe=g;xe<=H;++xe)(de>_||xe>g)&&(r.dense?(h[xe]||(h[xe]=[]),h[xe][de]={t:"z"}):h[Gt(de)+dr(xe)]={t:"z"});_=F+1}else++_;else p=kH(o[0]),p.Index&&(_=+p.Index-1),_<w.s.c&&(w.s.c=_),_>w.e.c&&(w.e.c=_),o[0].slice(-2)==="/>"&&++_,ne=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(g<w.s.r&&(w.s.r=g),g>w.e.r&&(w.e.r=g),o[0].slice(-2)==="/>"&&(m=Mn(o[0]),m.Index&&(g=+m.Index-1)),_=0,++g):(m=Mn(o[0]),m.Index&&(g=+m.Index-1),Ee={},(m.AutoFitHeight=="0"||m.Height)&&(Ee.hpx=parseInt(m.Height,10),Ee.hpt=hR(Ee.hpx),ce[g]=Ee),m.Hidden=="1"&&(Ee.hidden=!0,ce[g]=Ee));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(d),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(h["!ref"]=Ye(w),r.sheetRows&&r.sheetRows<=w.e.r&&(h["!fullref"]=h["!ref"],w.e.r=r.sheetRows-1,h["!ref"]=Ye(w))),O.length&&(h["!merges"]=O),se.length>0&&(h["!cols"]=se),ce.length>0&&(h["!rows"]=ce),u[d]=h}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=_=0,l.push([o[3],!1]),c=Mn(o[0]),d=Ze(c.Name),h=r.dense?[]:{},O=[],b=[],ce=[],V={name:d,Hidden:0},B.Sheets.push(V);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),se=[],te=!1}break;case"style":o[1]==="/"?CH(T,k,r):k=Mn(o[0]);break;case"numberformat":k.nf=Ze(Mn(o[0]).Format||"General"),vc[k.nf]&&(k.nf=vc[k.nf]);for(var me=0;me!=392&&be[me]!=k.nf;++me);if(me==392){for(me=57;me!=392;++me)if(be[me]==null){ga(k.nf,me);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ue=Mn(o[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!te&&ue.wpx>10){te=!0,Ur=uR;for(var ae=0;ae<se.length;++ae)se[ae]&&Xo(se[ae])}te&&Xo(ue),se[ue.Index-1||se.length]=ue;for(var He=0;He<+ue.Span;++He)se[se.length]=hr(ue);break;case"namedrange":if(o[1]==="/")break;B.Names||(B.Names=[]);var L=Pe(o[0]),pt={Name:L.Name,Ref:Po(L.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(pt.Sheet=B.Sheets.length-1),B.Names.push(pt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?y+=n.slice(P,o.index):P=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=Mn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?dB(U,J,n.slice(M,o.index)):M=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));PH(re),ne.push(re)}else l.push([o[3],!1]),c=Mn(o[0]),re={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Qe=Mn(o[0]);h["!autofilter"]={ref:Po(Qe.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Lw(n,r);var it=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:it=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:it=!1}break;case"excelworkbook":switch(o[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:it=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:it=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(M,o.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2;break}else M=o.index+o[0].length;break;case"header":h["!margins"]||gc(h["!margins"]={},"xlml"),isNaN(+Pe(o[0]).Margin)||(h["!margins"].header=+Pe(o[0]).Margin);break;case"footer":h["!margins"]||gc(h["!margins"]={},"xlml"),isNaN(+Pe(o[0]).Margin)||(h["!margins"].footer=+Pe(o[0]).Margin);break;case"pagemargins":var Ue=Pe(o[0]);h["!margins"]||gc(h["!margins"]={},"xlml"),isNaN(+Ue.Top)||(h["!margins"].top=+Ue.Top),isNaN(+Ue.Left)||(h["!margins"].left=+Ue.Left),isNaN(+Ue.Right)||(h["!margins"].right=+Ue.Right),isNaN(+Ue.Bottom)||(h["!margins"].bottom=+Ue.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:it=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:it=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:it=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:it=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:it=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:it=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:it=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:it=!1}break;case"smarttags":break;default:it=!1;break}if(it||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?SH(j,J,X,n.slice(M,o.index)):(X=o,M=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var I={};return!r.bookSheets&&!r.bookProps&&(I.Sheets=u),I.SheetNames=f,I.Workbook=B,I.SSF=hr(be),I.Props=U,I.Custprops=j,I}function Dg(e,t){switch(D_(t=t||{}),t.type||"base64"){case"base64":return Hp(_n(e),t);case"binary":case"buffer":case"file":return Hp(e,t);case"array":return Hp(ja(e),t)}}function FH(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=WV(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=GV(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var NH=[60,1084,2066,2165,2175];function DH(e,t,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=Fi(r,r.l),c=Og[l],u=0;c!=null&&NH.indexOf(l)>-1;)s=Fi(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+s),a.push(o),r.l+=4+s,c=Og[l=Fi(r,r.l)];var f=ls(a);ar(f,0);var h=0;f.lens=[];for(var d=0;d<a.length;++d)f.lens.push(h),h+=a[d].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,i)}function Zn(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=be[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Wa[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=nu(e.v):e.w=Pa(e.v):e.w=Dn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&hl(be[n]||String(n))){var i=ua(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Of(e,t,r){return{v:e,ixfe:t,t:r}}function OH(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},a={},o=null,l=[],c="",u={},f,h="",d,p,m,v,x={},_=[],g,w,T=[],k=[],y={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},O=function(Be){return Be<8?va[Be]:Be<64&&k[Be-8]||va[Be]},U=function(Be,mt,Xr){var kt=mt.XF.data;if(!(!kt||!kt.patternType||!Xr||!Xr.cellStyles)){mt.s={},mt.s.patternType=kt.patternType;var Xs;(Xs=ou(O(kt.icvFore)))&&(mt.s.fgColor={rgb:Xs}),(Xs=ou(O(kt.icvBack)))&&(mt.s.bgColor={rgb:Xs})}},j=function(Be,mt,Xr){if(!(Ee>1)&&!(Xr.sheetRows&&Be.r>=Xr.sheetRows)){if(Xr.cellStyles&&mt.XF&&mt.XF.data&&U(Be,mt,Xr),delete mt.ixfe,delete mt.XF,f=Be,h=Le(Be),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),Be.r<a.s.r&&(a.s.r=Be.r),Be.c<a.s.c&&(a.s.c=Be.c),Be.r+1>a.e.r&&(a.e.r=Be.r+1),Be.c+1>a.e.c&&(a.e.c=Be.c+1),Xr.cellFormula&&mt.f){for(var kt=0;kt<_.length;++kt)if(!(_[kt][0].s.c>Be.c||_[kt][0].s.r>Be.r)&&!(_[kt][0].e.c<Be.c||_[kt][0].e.r<Be.r)){mt.F=Ye(_[kt][0]),(_[kt][0].s.c!=Be.c||_[kt][0].s.r!=Be.r)&&delete mt.f,mt.f&&(mt.f=""+wr(_[kt][1],a,Be,b,M));break}}Xr.dense?(i[Be.r]||(i[Be.r]=[]),i[Be.r][Be.c]=mt):i[h]=mt}},M={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(M.password=t.password);var X,ne=[],re=[],se=[],ue=[],te=!1,b=[];b.SheetNames=M.snames,b.sharedf=M.sharedf,b.arrayf=M.arrayf,b.names=[],b.XTI=[];var ce=0,Ee=0,F=0,H=[],B=[],V;M.codepage=1200,jn(1200);for(var J=!1;e.l<e.length-1;){var de=e.l,xe=e.read_shift(2);if(xe===0&&ce===10)break;var me=e.l===e.length?0:e.read_shift(2),ae=Og[xe];if(ae&&ae.f){if(t.bookSheets&&ce===133&&xe!==133)break;if(ce=xe,ae.r===2||ae.r==12){var He=e.read_shift(2);if(me-=2,!M.enc&&He!==xe&&((He&255)<<8|He>>8)!==xe)throw new Error("rt mismatch: "+He+"!="+xe);ae.r==12&&(e.l+=10,me-=10)}var L={};if(xe===10?L=ae.f(e,me,M):L=DH(xe,ae,e,me,M),Ee==0&&[9,521,1033,2057].indexOf(ce)===-1)continue;switch(xe){case 34:r.opts.Date1904=y.WBProps.date1904=L;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(M.enc||(e.l=0),M.enc=L,!t.password)throw new Error("File is password-protected");if(L.valid==null)throw new Error("Encryption scheme unsupported");if(!L.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=L;break;case 66:var pt=Number(L);switch(pt){case 21010:pt=1200;break;case 32768:pt=1e4;break;case 32769:pt=1252;break}jn(M.codepage=pt),J=!0;break;case 317:M.rrtabid=L;break;case 25:M.winlocked=L;break;case 439:r.opts.RefreshAll=L;break;case 12:r.opts.CalcCount=L;break;case 16:r.opts.CalcDelta=L;break;case 17:r.opts.CalcIter=L;break;case 13:r.opts.CalcMode=L;break;case 14:r.opts.CalcPrecision=L;break;case 95:r.opts.CalcSaveRecalc=L;break;case 15:M.CalcRefMode=L;break;case 2211:r.opts.FullCalc=L;break;case 129:L.fDialog&&(i["!type"]="dialog"),L.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),L.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:T.push(L);break;case 430:b.push([L]),b[b.length-1].XTI=[];break;case 35:case 547:b[b.length-1].push(L);break;case 24:case 536:V={Name:L.Name,Ref:wr(L.rgce,a,null,b,M)},L.itab>0&&(V.Sheet=L.itab-1),b.names.push(V),b[0]||(b[0]=[],b[0].XTI=[]),b[b.length-1].push(L),L.Name=="_xlnm._FilterDatabase"&&L.itab>0&&L.rgce&&L.rgce[0]&&L.rgce[0][0]&&L.rgce[0][0][0]=="PtgArea3d"&&(B[L.itab-1]={ref:Ye(L.rgce[0][0][1][2])});break;case 22:M.ExternCount=L;break;case 23:b.length==0&&(b[0]=[],b[0].XTI=[]),b[b.length-1].XTI=b[b.length-1].XTI.concat(L),b.XTI=b.XTI.concat(L);break;case 2196:if(M.biff<8)break;V!=null&&(V.Comment=L[1]);break;case 18:i["!protect"]=L;break;case 19:L!==0&&M.WTF&&console.error("Password verifier: "+L);break;case 133:s[L.pos]=L,M.snames.push(L.name);break;case 10:{if(--Ee)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=Ye(a),t.sheetRows&&t.sheetRows<=a.e.r){var Qe=a.e.r;a.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Ye(a),a.e.r=Qe}a.e.r++,a.e.c++}ne.length>0&&(i["!merges"]=ne),re.length>0&&(i["!objects"]=re),se.length>0&&(i["!cols"]=se),ue.length>0&&(i["!rows"]=ue),y.Sheets.push(P)}c===""?u=i:n[c]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[xe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[L.BIFFVer]||8),M.biffguess=L.BIFFVer==0,L.BIFFVer==0&&L.dt==4096&&(M.biff=5,J=!0,jn(M.codepage=28591)),M.biff==8&&L.BIFFVer==0&&L.dt==16&&(M.biff=2),Ee++)break;if(i=t.dense?[]:{},M.biff<8&&!J&&(J=!0,jn(M.codepage=t.codepage||1252)),M.biff<5||L.BIFFVer==0&&L.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var it={pos:e.l-me,name:c};s[it.pos]=it,M.snames.push(c)}else c=(s[de]||{name:""}).name;L.dt==32&&(i["!type"]="chart"),L.dt==64&&(i["!type"]="macro"),ne=[],re=[],M.arrayf=_=[],se=[],ue=[],te=!1,P={Hidden:(s[de]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[L.r]||[])[L.c]:i[Le({c:L.c,r:L.r})])&&++L.c,g={ixfe:L.ixfe,XF:T[L.ixfe]||{},v:L.val,t:"n"},F>0&&(g.z=H[g.ixfe>>8&63]),Zn(g,t,r.opts.Date1904),j({c:L.c,r:L.r},g,t);break;case 5:case 517:g={ixfe:L.ixfe,XF:T[L.ixfe],v:L.val,t:L.t},F>0&&(g.z=H[g.ixfe>>8&63]),Zn(g,t,r.opts.Date1904),j({c:L.c,r:L.r},g,t);break;case 638:g={ixfe:L.ixfe,XF:T[L.ixfe],v:L.rknum,t:"n"},F>0&&(g.z=H[g.ixfe>>8&63]),Zn(g,t,r.opts.Date1904),j({c:L.c,r:L.r},g,t);break;case 189:for(var Ue=L.c;Ue<=L.C;++Ue){var I=L.rkrec[Ue-L.c][0];g={ixfe:I,XF:T[I],v:L.rkrec[Ue-L.c][1],t:"n"},F>0&&(g.z=H[g.ixfe>>8&63]),Zn(g,t,r.opts.Date1904),j({c:Ue,r:L.r},g,t)}break;case 6:case 518:case 1030:{if(L.val=="String"){o=L;break}if(g=Of(L.val,L.cell.ixfe,L.tt),g.XF=T[g.ixfe],t.cellFormula){var W=L.formula;if(W&&W[0]&&W[0][0]&&W[0][0][0]=="PtgExp"){var Y=W[0][0][1][0],we=W[0][0][1][1],pe=Le({r:Y,c:we});x[pe]?g.f=""+wr(L.formula,a,L.cell,b,M):g.F=((t.dense?(i[Y]||[])[we]:i[pe])||{}).F}else g.f=""+wr(L.formula,a,L.cell,b,M)}F>0&&(g.z=H[g.ixfe>>8&63]),Zn(g,t,r.opts.Date1904),j(L.cell,g,t),o=L}break;case 7:case 519:if(o)o.val=L,g=Of(L,o.cell.ixfe,"s"),g.XF=T[g.ixfe],t.cellFormula&&(g.f=""+wr(o.formula,a,o.cell,b,M)),F>0&&(g.z=H[g.ixfe>>8&63]),Zn(g,t,r.opts.Date1904),j(o.cell,g,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(L);var fe=Le(L[0].s);if(d=t.dense?(i[L[0].s.r]||[])[L[0].s.c]:i[fe],t.cellFormula&&d){if(!o||!fe||!d)break;d.f=""+wr(L[1],a,L[0],b,M),d.F=Ye(L[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;x[Le(o.cell)]=L[0],d=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[Le(o.cell)],(d||{}).f=""+wr(L[0],a,f,b,M)}}break;case 253:g=Of(l[L.isst].t,L.ixfe,"s"),l[L.isst].h&&(g.h=l[L.isst].h),g.XF=T[g.ixfe],F>0&&(g.z=H[g.ixfe>>8&63]),Zn(g,t,r.opts.Date1904),j({c:L.c,r:L.r},g,t);break;case 513:t.sheetStubs&&(g={ixfe:L.ixfe,XF:T[L.ixfe],t:"z"},F>0&&(g.z=H[g.ixfe>>8&63]),Zn(g,t,r.opts.Date1904),j({c:L.c,r:L.r},g,t));break;case 190:if(t.sheetStubs)for(var Ce=L.c;Ce<=L.C;++Ce){var $e=L.ixfe[Ce-L.c];g={ixfe:$e,XF:T[$e],t:"z"},F>0&&(g.z=H[g.ixfe>>8&63]),Zn(g,t,r.opts.Date1904),j({c:Ce,r:L.r},g,t)}break;case 214:case 516:case 4:g=Of(L.val,L.ixfe,"s"),g.XF=T[g.ixfe],F>0&&(g.z=H[g.ixfe>>8&63]),Zn(g,t,r.opts.Date1904),j({c:L.c,r:L.r},g,t);break;case 0:case 512:Ee===1&&(a=L);break;case 252:l=L;break;case 1054:if(M.biff==4){H[F++]=L[1];for(var et=0;et<F+163&&be[et]!=L[1];++et);et>=163&&ga(L[1],F+163)}else ga(L[1],L[0]);break;case 30:{H[F++]=L;for(var Lr=0;Lr<F+163&&be[Lr]!=L;++Lr);Lr>=163&&ga(L,F+163)}break;case 229:ne=ne.concat(L);break;case 93:re[L.cmo[0]]=M.lastobj=L;break;case 438:M.lastobj.TxO=L;break;case 127:M.lastobj.ImData=L;break;case 440:for(v=L[0].s.r;v<=L[0].e.r;++v)for(m=L[0].s.c;m<=L[0].e.c;++m)d=t.dense?(i[v]||[])[m]:i[Le({c:m,r:v})],d&&(d.l=L[1]);break;case 2048:for(v=L[0].s.r;v<=L[0].e.r;++v)for(m=L[0].s.c;m<=L[0].e.c;++m)d=t.dense?(i[v]||[])[m]:i[Le({c:m,r:v})],d&&d.l&&(d.l.Tooltip=L[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;d=t.dense?(i[L[0].r]||[])[L[0].c]:i[Le(L[0])];var qs=re[L[2]];d||(t.dense?(i[L[0].r]||(i[L[0].r]=[]),d=i[L[0].r][L[0].c]={t:"z"}):d=i[Le(L[0])]={t:"z"},a.e.r=Math.max(a.e.r,L[0].r),a.s.r=Math.min(a.s.r,L[0].r),a.e.c=Math.max(a.e.c,L[0].c),a.s.c=Math.min(a.s.c,L[0].c)),d.c||(d.c=[]),p={a:L[1],t:qs.TxO.t},d.c.push(p)}break;case 2173:r$(T[L.ixfe],L.ext);break;case 125:{if(!M.cellStyles)break;for(;L.e>=L.s;)se[L.e--]={width:L.w/256,level:L.level||0,hidden:!!(L.flags&1)},te||(te=!0,C_(L.w/256)),Xo(se[L.e+1])}break;case 520:{var jt={};L.level!=null&&(ue[L.r]=jt,jt.level=L.level),L.hidden&&(ue[L.r]=jt,jt.hidden=!0),L.hpt&&(ue[L.r]=jt,jt.hpt=L.hpt,jt.hpx=lu(L.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||gc(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[xe]]=L;break;case 161:i["!margins"]||gc(i["!margins"]={}),i["!margins"].header=L.header,i["!margins"].footer=L.footer;break;case 574:L.RTL&&(y.Views[0].RTL=!0);break;case 146:k=L;break;case 2198:X=L;break;case 140:w=L;break;case 442:c?P.CodeName=L||P.name:y.WBProps.CodeName=L||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+xe.toString(16)),e.l+=me}return r.SheetNames=_i(s).sort(function(qr,Be){return Number(qr)-Number(Be)}).map(function(qr){return s[qr].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&B.forEach(function(qr,Be){r.Sheets[r.SheetNames[Be]]["!autofilter"]=qr}),r.Strings=l,r.SSF=hr(be),M.enc&&(r.Encryption=M.enc),X&&(r.Themes=X),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),b.names.length>0&&(y.Names=b.names),r.Workbook=y,r}var Pw={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function LH(e,t,r){var n=Xe.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=dw(n,JV,Pw.DSI);for(var s in i)t[s]=i[s]}catch(c){if(r.WTF)throw c}var a=Xe.find(e,"/!SummaryInformation");if(a&&a.size>0)try{var o=dw(a,ZV,Pw.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(KC(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function PR(e,t){t||(t={}),D_(t),iC(),t.codepage&&f_(t.codepage);var r,n;if(e.FullPaths){if(Xe.find(e,"/encryption"))throw new Error("File is password-protected");r=Xe.find(e,"!CompObj"),n=Xe.find(e,"/Workbook")||Xe.find(e,"/Book")}else{switch(t.type){case"base64":e=$n(_n(e));break;case"binary":e=$n(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ar(e,0),n={content:e}}var i,s;if(r&&FH(r),t.bookProps&&!t.bookSheets)i={};else{var a=Ke?"buffer":"array";if(n&&n.content)i=OH(n.content,t);else if((s=Xe.find(e,"PerfectOffice_MAIN"))&&s.content)i=pc.to_workbook(s.content,(t.type=a,t));else if((s=Xe.find(e,"NativeContent_MAIN"))&&s.content)i=pc.to_workbook(s.content,(t.type=a,t));else throw(s=Xe.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Xe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=y$(e))}var o={};return e.FullPaths&&LH(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}var _0={0:{f:gz},1:{f:yz},2:{f:Rz},3:{f:kz},4:{f:wz},5:{f:Cz},6:{f:Nz},7:{f:Sz},8:{f:bz},9:{f:Mz},10:{f:Oz},11:{f:Lz},12:{f:Ez},13:{f:Pz},14:{f:Az},15:{f:Tz},16:{f:AR},17:{f:Dz},18:{f:Iz},19:{f:w_},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:uH},40:{},42:{},43:{f:O7},44:{f:D7},45:{f:L7},46:{f:b7},47:{f:M7},48:{},49:{f:VV},50:{},51:{f:i$},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:sR},62:{f:Fz},63:{f:c$},64:{f:Gz},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Dr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Wz},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:xz},148:{f:vz,p:16},151:{f:Uz},152:{},153:{f:lH},154:{},155:{},156:{f:oH},157:{},158:{},159:{T:1,f:ZU},160:{T:-1},161:{T:1,f:Ha},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Vz},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:n$},336:{T:-1},337:{f:s$,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Rg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:iR},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:$z},427:{f:jz},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Hz},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:_z},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Bz},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Rg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:v$},633:{T:1},634:{T:-1},635:{T:1,f:g$},636:{T:-1},637:{f:UV},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Jz},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Kz},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Og={6:{f:jp},10:{f:Qi},12:{f:Lt},13:{f:Lt},14:{f:Rt},15:{f:Rt},16:{f:Ar},17:{f:Rt},18:{f:Rt},19:{f:Lt},20:{f:vw},21:{f:vw},23:{f:iR},24:{f:xw},25:{f:Rt},26:{},27:{},28:{f:pU},29:{},34:{f:Rt},35:{f:_w},38:{f:Ar},39:{f:Ar},40:{f:Ar},41:{f:Ar},42:{f:Rt},43:{f:Rt},47:{f:_7},49:{f:XB},51:{f:Lt},60:{},61:{f:GB},64:{f:Rt},65:{f:qB},66:{f:Lt},77:{},80:{},81:{},82:{},85:{f:Lt},89:{},90:{},91:{},92:{f:VB},93:{f:gU},94:{},95:{f:Rt},96:{},97:{},99:{f:Rt},125:{f:sR},128:{f:sU},129:{f:BB},130:{f:Lt},131:{f:Rt},132:{f:Rt},133:{f:UB},134:{},140:{f:wU},141:{f:Lt},144:{},146:{f:kU},151:{},152:{},153:{},154:{},155:{},156:{f:Lt},157:{},158:{},160:{f:RU},161:{f:SU},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:tU},190:{f:rU},193:{f:Qi},197:{},198:{},199:{},200:{},201:{},202:{f:Rt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Lt},220:{},221:{f:Rt},222:{},224:{f:iU},225:{f:bB},226:{f:Qi},227:{},229:{f:mU},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:$B},253:{f:YB},255:{f:jB},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:JC},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Rt},353:{f:Qi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:oU},431:{f:Rt},432:{},433:{},434:{},437:{},438:{f:xU},439:{f:Rt},440:{f:yU},441:{},442:{f:Wu},443:{},444:{f:Lt},445:{},446:{},448:{f:Qi},449:{f:WB,r:2},450:{f:Qi},512:{f:mw},513:{f:CU},515:{f:aU},516:{f:QB},517:{f:gw},519:{f:PU},520:{f:zB},523:{},545:{f:yw},549:{f:pw},566:{},574:{f:KB},638:{f:eU},659:{},1048:{},1054:{f:JB},1084:{},1212:{f:fU},2048:{f:EU},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ff},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Qi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:AU,r:12},2173:{f:t$,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Rt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:uU,r:12},2197:{},2198:{f:X7,r:12},2199:{},2200:{},2201:{},2202:{f:hU,r:12},2203:{f:Qi},2204:{},2205:{},2206:{},2207:{},2211:{f:HB},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Lt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:IU},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:TU},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:mw},1:{},2:{f:OU},3:{f:DU},4:{f:NU},5:{f:gw},7:{f:LU},8:{},9:{f:Ff},11:{},22:{f:Lt},30:{f:ZB},31:{},32:{},33:{f:yw},36:{},37:{f:pw},50:{f:MU},62:{},52:{},67:{},68:{f:Lt},69:{},86:{},126:{},127:{f:FU},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:bU},223:{},234:{},354:{},421:{},518:{f:jp},521:{f:Ff},536:{f:xw},547:{f:_w},561:{},579:{},1030:{f:jp},1033:{f:Ff},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function bn(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&BC(r)&&e.push(r)}}function Fw(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),a=i.index,o=s&&s.index||e.length,l=oV(e.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,f=0,h=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(a=0;a<l.length;++a){var m=l[a].trim(),v=m.slice(0,3).toLowerCase();if(v=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(v!="<td"&&v!="<th")){var x=m.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var _=x[o].trim();if(_.match(/<t[dh]/i)){for(var g=_,w=0;g.charAt(0)=="<"&&(w=g.indexOf(">"))>-1;)g=g.slice(w+1);for(var T=0;T<p.length;++T){var k=p[T];k.s.c==u&&k.s.r<c&&c<=k.e.r&&(u=k.e.c+1,T=-1)}var y=Pe(_.slice(0,_.indexOf(">")));h=y.colspan?+y.colspan:1,((f=+y.rowspan)>1||h>1)&&p.push({s:{r:c,c:u},e:{r:c+(f||1)-1,c:u+h-1}});var P=y.t||y["data-t"]||"";if(!g.length){u+=h;continue}if(g=SC(g),d.s.r>c&&(d.s.r=c),d.e.r<c&&(d.e.r=c),d.s.c>u&&(d.s.c=u),d.e.c<u&&(d.e.c=u),!g.length){u+=h;continue}var O={t:"s",v:g};r.raw||!g.trim().length||P=="s"||(g==="TRUE"?O={t:"b",v:!0}:g==="FALSE"?O={t:"b",v:!1}:isNaN(Gn(g))?isNaN(qo(g).getDate())||(O={t:"d",v:tr(g)},r.cellDates||(O={t:"n",v:Wr(O.v)}),O.z=r.dateNF||be[14]):O={t:"n",v:Gn(g)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=O):n[Le({r:c,c:u})]=O,u+=h}}}}return n["!ref"]=Ye(d),p.length&&(n["!merges"]=p),n}function MH(e,t,r,n){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=Le({r,c:a}),f=n.dense?(e[r]||[])[a]:e[u],h=f&&f.v!=null&&(f.h||v_(f.w||(Hi(f),f.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(d["data-t"]=f&&f.t||"z",f.v!=null&&(d["data-v"]=f.v),f.z!=null&&(d["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),d.id=(n.id||"sjs")+"-"+u,s.push(wV("td",h,d))}}var p="<tr>";return p+s.join("")+"</tr>"}var bH='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',VH="</body></html>";function BH(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ks(Fw(r[0],t),t);var n=L_();return r.forEach(function(i,s){M_(n,Fw(i,t),"Sheet"+(s+1))}),n}function UH(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function $H(e,t){var r=t||{},n=r.header!=null?r.header:bH,i=r.footer!=null?r.footer:VH,s=[n],a=dl(e["!ref"]);r.dense=Array.isArray(e),s.push(UH(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(MH(e,a,o,r));return s.push("</table>"+i),s.join("")}function FR(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?jr(n.origin):n.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=dl(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var f=[],h=0,d=e["!rows"]||(e["!rows"]=[]),p=0,m=0,v=0,x=0,_=0,g=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&m<l;++p){var w=o[p];if(Nw(w)){if(n.display)continue;d[m]={hidden:!0}}var T=w.children;for(v=x=0;v<T.length;++v){var k=T[v];if(!(n.display&&Nw(k))){var y=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):SC(k.innerHTML),P=k.getAttribute("data-z")||k.getAttribute("z");for(h=0;h<f.length;++h){var O=f[h];O.s.c==x+s&&O.s.r<m+i&&m+i<=O.e.r&&(x=O.e.c+1-s,h=-1)}g=+k.getAttribute("colspan")||1,((_=+k.getAttribute("rowspan")||1)>1||g>1)&&f.push({s:{r:m+i,c:x+s},e:{r:m+i+(_||1)-1,c:x+s+(g||1)-1}});var U={t:"s",v:y},j=k.getAttribute("data-t")||k.getAttribute("t")||"";y!=null&&(y.length==0?U.t=j||"z":n.raw||y.trim().length==0||j=="s"||(y==="TRUE"?U={t:"b",v:!0}:y==="FALSE"?U={t:"b",v:!1}:isNaN(Gn(y))?isNaN(qo(y).getDate())||(U={t:"d",v:tr(y)},n.cellDates||(U={t:"n",v:Wr(U.v)}),U.z=n.dateNF||be[14]):U={t:"n",v:Gn(y)})),U.z===void 0&&P!=null&&(U.z=P);var M="",X=k.getElementsByTagName("A");if(X&&X.length)for(var ne=0;ne<X.length&&!(X[ne].hasAttribute("href")&&(M=X[ne].getAttribute("href"),M.charAt(0)!="#"));++ne);M&&M.charAt(0)!="#"&&(U.l={Target:M}),n.dense?(e[m+i]||(e[m+i]=[]),e[m+i][x+s]=U):e[Le({c:x+s,r:m+i})]=U,c.e.c<x+s&&(c.e.c=x+s),x+=g}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,m-1+i),e["!ref"]=Ye(c),m>=l&&(e["!fullref"]=Ye((c.e.r=o.length-p+m-1+i,c))),e}function NR(e,t){var r=t||{},n=r.dense?[]:{};return FR(n,e,t)}function jH(e,t){return Ks(NR(e,t),t)}function Nw(e){var t="",r=zH(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function zH(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function HH(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ze(t.replace(/<[^>]*>/g,""));return[r]}var Dw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function DR(e,t){var r=t||{},n=__(e),i=[],s,a,o={name:""},l="",c=0,u,f,h={},d=[],p=r.dense?[]:{},m,v,x={value:""},_="",g=0,w=[],T=-1,k=-1,y={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,O={},U=[],j={},M=0,X=0,ne=[],re=1,se=1,ue=[],te={Names:[]},b={},ce=["",""],Ee=[],F={},H="",B=0,V=!1,J=!1,de=0;for(su.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=su.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"工作表":m[1]==="/"?(y.e.c>=y.s.c&&y.e.r>=y.s.r?p["!ref"]=Ye(y):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=y.e.r&&(p["!fullref"]=p["!ref"],y.e.r=r.sheetRows-1,p["!ref"]=Ye(y)),U.length&&(p["!merges"]=U),ne.length&&(p["!rows"]=ne),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),d.push(u.name),h[u.name]=p,J=!1):m[0].charAt(m[0].length-2)!=="/"&&(u=Pe(m[0],!1),T=k=-1,y.s.r=y.s.c=1e7,y.e.r=y.e.c=0,p=r.dense?[]:{},U=[],ne=[],J=!0);break;case"table-row-group":m[1]==="/"?--P:++P;break;case"table-row":case"行":if(m[1]==="/"){T+=re,re=1;break}if(f=Pe(m[0],!1),f.行号?T=f.行号-1:T==-1&&(T=0),re=+f["number-rows-repeated"]||1,re<10)for(de=0;de<re;++de)P>0&&(ne[T+de]={level:P});k=-1;break;case"covered-table-cell":m[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(p[T]||(p[T]=[]),p[T][k]={t:"z"}):p[Le({r:T,c:k})]={t:"z"}),_="",w=[];break;case"table-cell":case"数据":if(m[0].charAt(m[0].length-2)==="/")++k,x=Pe(m[0],!1),se=parseInt(x["number-columns-repeated"]||"1",10),v={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(v.f=Iw(Ze(x.formula))),(x.数据类型||x["value-type"])=="string"&&(v.t="s",v.v=Ze(x["string-value"]||""),r.dense?(p[T]||(p[T]=[]),p[T][k]=v):p[Le({r:T,c:k})]=v),k+=se-1;else if(m[1]!=="/"){++k,_="",g=0,w=[],se=1;var xe=re?T+re-1:T;if(k>y.e.c&&(y.e.c=k),k<y.s.c&&(y.s.c=k),T<y.s.r&&(y.s.r=T),xe>y.e.r&&(y.e.r=xe),x=Pe(m[0],!1),Ee=[],F={},v={t:x.数据类型||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=Ze(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(M=parseInt(x["number-matrix-rows-spanned"],10)||0,X=parseInt(x["number-matrix-columns-spanned"],10)||0,j={s:{r:T,c:k},e:{r:T+M-1,c:k+X-1}},v.F=Ye(j),ue.push([j,v.F])),x.formula)v.f=Iw(x.formula);else for(de=0;de<ue.length;++de)T>=ue[de][0].s.r&&T<=ue[de][0].e.r&&k>=ue[de][0].s.c&&k<=ue[de][0].e.c&&(v.F=ue[de][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(M=parseInt(x["number-rows-spanned"],10)||0,X=parseInt(x["number-columns-spanned"],10)||0,j={s:{r:T,c:k},e:{r:T+M-1,c:k+X-1}},U.push(j)),x["number-columns-repeated"]&&(se=parseInt(x["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=gt(x["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(x.value);break;case"percentage":v.t="n",v.v=parseFloat(x.value);break;case"currency":v.t="n",v.v=parseFloat(x.value);break;case"date":v.t="d",v.v=tr(x["date-value"]),r.cellDates||(v.t="n",v.v=Wr(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=iV(x["time-value"])/86400,r.cellDates&&(v.t="d",v.v=wd(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(x.数据数值);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",x["string-value"]!=null&&(_=Ze(x["string-value"]),w=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(V=!1,v.t==="s"&&(v.v=_||"",w.length&&(v.R=w),V=g==0),b.Target&&(v.l=b),Ee.length>0&&(v.c=Ee,Ee=[]),_&&r.cellText!==!1&&(v.w=_),V&&(v.t="z",delete v.v),(!V||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=T))for(var me=0;me<re;++me){if(se=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(p[T+me]||(p[T+me]=[]),p[T+me][k]=me==0?v:hr(v);--se>0;)p[T+me][k+se]=hr(v);else for(p[Le({r:T+me,c:k})]=v;--se>0;)p[Le({r:T+me,c:k+se})]=hr(v);y.e.c<=k&&(y.e.c=k)}se=parseInt(x["number-columns-repeated"]||"1",10),k+=se-1,se=0,v={},_="",w=[]}b={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;F.t=_,w.length&&(F.R=w),F.a=H,Ee.push(F)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);H="",B=0,_="",g=0,w=[];break;case"creator":m[1]==="/"?H=n.slice(B,m.index):B=m.index+m[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);_="",g=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(O[o.name]=l,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=Pe(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Pe(m[0],!1),l+=Dw[m[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Pe(m[0],!1),l+=Dw[m[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":a=Pe(m[0],!1),ce=zp(a["cell-range-address"]);var ae={Name:a.name,Ref:ce[0]+"!"+ce[1]};J&&(ae.Sheet=d.length),te.Names.push(ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!x||!x["string-value"])){var He=HH(n.slice(g,m.index));_=(_.length>0?_+`
`:"")+He[0]}else Pe(m[0],!1),g=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{ce=zp(Pe(m[0])["target-range-address"]),h[ce[0]]["!autofilter"]={ref:ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(b=Pe(m[0],!1),!b.href)break;b.Target=Ze(b.href),delete b.href,b.Target.charAt(0)=="#"&&b.Target.indexOf(".")>-1?(ce=zp(b.Target.slice(1)),b.Target="#"+ce[0]+"!"+ce[1]):b.Target.match(/^\.\.[\\\/]/)&&(b.Target=b.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(m)}}var L={Sheets:h,SheetNames:d,Workbook:te};return r.bookSheets&&delete L.Sheets,L}function Ow(e,t){t=t||{},Tn(e,"META-INF/manifest.xml")&&aB(Ot(e,"META-INF/manifest.xml"),t);var r=un(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=DR(ot(r),t);return Tn(e,"meta.xml")&&(n.Props=GC(Ot(e,"meta.xml"))),n}function Lw(e,t){return DR(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function F_(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Lg(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ot(ja(e))}function Mg(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function Mw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function WH(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function cu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function qt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Sr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=cu(e,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=cu(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function N_(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function GH(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=cu(e,n),s=Sr(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:qt(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Sr(o.data),c=qt(l[3][0].data);a.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(a.merge=qt(s[3][0].data)>>>0>0),r.push(a)}return r}function KH(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=cu(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Mg(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=Mg(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function qH(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(KH(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Mg(t)}function XH(e,t,r,n){var i=F_(e),s=i.getUint32(4,!0),a=(n>1?12:8)+Mw(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=Mw(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(c=i.getFloat64(a,!0),a+=8),s&64&&(u.setTime(u.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function YH(e,t,r){var n=F_(e),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);i&1&&(l=WH(e,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(a>-1)f={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return f}function QH(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return XH(e,t,r,e[0]);case 5:return YH(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ps(e){var t=Sr(e);return cu(t[1][0].data)}function bw(e,t){var r=Sr(t.data),n=qt(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=Sr(a.data),l=qt(o[1][0].data)>>>0;switch(n){case 1:s[l]=Lg(o[3][0].data);break;case 8:{var c=e[Ps(o[9][0].data)][0],u=Sr(c.data),f=e[Ps(u[1][0].data)][0],h=qt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var d=Sr(f.data);s[l]=d[3].map(function(p){return Lg(p.data)}).join("")}break}}),s}function JH(e,t){var r,n,i,s,a,o,l,c,u,f,h,d,p,m,v=Sr(e),x=qt(v[1][0].data)>>>0,_=qt(v[2][0].data)>>>0,g=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&qt(v[8][0].data)>0||!1,w,T;if((s=(i=v[7])==null?void 0:i[0])!=null&&s.data&&t!=0)w=(o=(a=v[7])==null?void 0:a[0])==null?void 0:o.data,T=(c=(l=v[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=v[4])==null?void 0:u[0])!=null&&f.data&&t!=1)w=(d=(h=v[4])==null?void 0:h[0])==null?void 0:d.data,T=(m=(p=v[3])==null?void 0:p[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=g?4:1,y=F_(w),P=[],O=0;O<w.length/2;++O){var U=y.getUint16(O*2,!0);U<65535&&P.push([O,U])}if(P.length!=_)throw"Expected ".concat(_," cells, found ").concat(P.length);var j=[];for(O=0;O<P.length-1;++O)j[P[O][0]]=T.subarray(P[O][1]*k,P[O+1][1]*k);return P.length>=1&&(j[P[P.length-1][0]]=T.subarray(P[P.length-1][1]*k)),{R:x,cells:j}}function ZH(e,t){var r,n=Sr(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?qt(n[7][0].data)>>>0>0?1:0:-1,s=N_(n[5],function(a){return JH(a,i)});return{nrows:qt(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function eW(e,t,r){var n,i=Sr(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(qt(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(qt(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Ye(s);var a=Sr(i[4][0].data),o=bw(e,e[Ps(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?bw(e,e[Ps(a[17][0].data)][0]):[],c=Sr(a[3][0].data),u=0;c[1].forEach(function(f){var h=Sr(f.data),d=e[Ps(h[2][0].data)][0],p=qt(d.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var m=ZH(e,d);m.data.forEach(function(v,x){v.forEach(function(_,g){var w=Le({r:u+x,c:g}),T=QH(_,o,l);T&&(r[w]=T)})}),u+=m.nrows})}function tW(e,t){var r=Sr(t.data),n={"!ref":"A1"},i=e[Ps(r[2][0].data)],s=qt(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return eW(e,i[0],n),n}function rW(e,t){var r,n=Sr(t.data),i={name:(r=n[1])!=null&&r[0]?Lg(n[1][0].data):"",sheets:[]},s=N_(n[2],Ps);return s.forEach(function(a){e[a].forEach(function(o){var l=qt(o.meta[1][0].data);l==6e3&&i.sheets.push(tW(e,o))})}),i}function nW(e,t){var r=L_(),n=Sr(t.data),i=N_(n[1],Ps);if(i.forEach(function(s){e[s].forEach(function(a){var o=qt(a.meta[1][0].data);if(o==2){var l=rW(e,a);l.sheets.forEach(function(c,u){M_(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Wp(e){var t,r,n,i,s={},a=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=qH(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=GH(c)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){s[f.id]=f.messages,a.push(f.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&qt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(c){var u=qt(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return nW(s,o)}function iW(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function D_(e){iW([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function sW(e){return vo.WS.indexOf(e)>-1?"sheet":e==vo.CS?"chart":e==vo.DS?"dialog":e==vo.MS?"macro":e&&e.length?e:"sheet"}function aW(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,sW(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function oW(e,t,r,n,i,s,a,o,l,c,u,f){try{s[n]=hc(un(e,r,!0),t);var h=Ot(e,t),d;switch(o){case"sheet":d=dH(h,t,i,l,s[n],c,u,f);break;case"chart":if(d=pH(h,t,i,l,s[n],c,u,f),!d||!d["!drawel"])break;var p=Hl(d["!drawel"].Target,t),m=Pg(p),v=h$(un(e,p,!0),hc(un(e,m,!0),p)),x=Hl(v,p),_=Pg(x);d=Yz(un(e,x,!0),x,l,hc(un(e,_,!0),x),c,d);break;case"macro":d=mH(h,t,i,l,s[n],c,u,f);break;case"dialog":d=gH(h,t,i,l,s[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=d;var g=[];s&&s[n]&&_i(s[n]).forEach(function(w){var T="";if(s[n][w].Type==vo.CMNT){T=Hl(s[n][w].Target,t);var k=yH(Ot(e,T,!0),T,l);if(!k||!k.length)return;ww(d,k,!1)}s[n][w].Type==vo.TCMNT&&(T=Hl(s[n][w].Target,t),g=g.concat(p$(Ot(e,T,!0),l)))}),g&&g.length&&ww(d,g,!0,l.people||[])}catch(w){if(l.WTF)throw w}}function En(e){return e.charAt(0)=="/"?e.slice(1):e}function lW(e,t){if(gC(),t=t||{},D_(t),Tn(e,"META-INF/manifest.xml")||Tn(e,"objectdata.xml"))return Ow(e,t);if(Tn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Wp<"u"){if(e.FileIndex)return Wp(e);var r=Xe.utils.cfb_new();return XE(e).forEach(function(ne){cV(r,ne,wC(e,ne))}),Wp(r)}throw new Error("Unsupported NUMBERS file")}if(!Tn(e,"[Content_Types].xml"))throw Tn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Tn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=XE(e),i=iB(un(e,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Ot(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Ot(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(mc=[],i.sst)try{mc=xH(Ot(e,En(i.sst)),i.sst,t)}catch(ne){if(t.WTF)throw ne}t.cellStyles&&i.themes.length&&(l=_H(un(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=vH(Ot(e,En(i.style)),i.style,l,t))}i.links.map(function(ne){try{var re=hc(un(e,Pg(En(ne))),ne);return wH(Ot(e,En(ne)),re,ne,t)}catch{}});var u=hH(Ot(e,En(i.workbooks[0])),i.workbooks[0],t),f={},h="";i.coreprops.length&&(h=Ot(e,En(i.coreprops[0]),!0),h&&(f=GC(h)),i.extprops.length!==0&&(h=Ot(e,En(i.extprops[0]),!0),h&&cB(h,f,t)));var d={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(h=un(e,En(i.custprops[0]),!0),h&&(d=fB(h,t)));var p={};if((t.bookSheets||t.bookProps)&&(u.Sheets?a=u.Sheets.map(function(re){return re.name}):f.Worksheets&&f.SheetNames.length>0&&(a=f.SheetNames),t.bookProps&&(p.Props=f,p.Custprops=d),t.bookSheets&&typeof a<"u"&&(p.SheetNames=a),t.bookSheets?p.SheetNames:t.bookProps))return p;a={};var m={};t.bookDeps&&i.calcchain&&(m=EH(Ot(e,En(i.calcchain)),i.calcchain));var v=0,x={},_,g;{var w=u.Sheets;f.Worksheets=w.length,f.SheetNames=[];for(var T=0;T!=w.length;++T)f.SheetNames[T]=w[T].name}var k=s?"bin":"xml",y=i.workbooks[0].lastIndexOf("/"),P=(i.workbooks[0].slice(0,y+1)+"_rels/"+i.workbooks[0].slice(y+1)+".rels").replace(/^\//,"");Tn(e,P)||(P="xl/_rels/workbook."+k+".rels");var O=hc(un(e,P,!0),P.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=TH(Ot(e,En(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=m$(Ot(e,En(i.people[0])),t)),O&&(O=aW(O,u.Sheets));var U=Ot(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=f.Worksheets;++v){var j="sheet";if(O&&O[v]?(_="xl/"+O[v][1].replace(/[\/]?xl\//,""),Tn(e,_)||(_=O[v][1]),Tn(e,_)||(_=P.replace(/_rels\/.*$/,"")+O[v][1]),j=O[v][2]):(_="xl/worksheets/sheet"+(v+1-U)+"."+k,_=_.replace(/sheet0\./,"sheet.")),g=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(f.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var M=!1,X=0;X!=t.sheets.length;++X)typeof t.sheets[X]=="number"&&t.sheets[X]==v&&(M=1),typeof t.sheets[X]=="string"&&t.sheets[X].toLowerCase()==f.SheetNames[v].toLowerCase()&&(M=1);if(!M)continue e}}oW(e,_,g,f.SheetNames[v],v,x,a,j,t,u,l,c)}return p={Directory:i,Workbook:u,Props:f,Custprops:d,Deps:m,Sheets:a,SheetNames:f.SheetNames,Strings:mc,Styles:c,Themes:l,SSF:hr(be)},t&&t.bookFiles&&(e.files?(p.keys=n,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(ne,re){ne=ne.replace(/^Root Entry[\/]/,""),p.keys.push(ne),p.files[ne]=e.FileIndex[re]}))),t&&t.bookVBA&&(i.vba.length>0?p.vbaraw=Ot(e,En(i.vba[0]),!0):i.defaults&&i.defaults.bin===x$&&(p.vbaraw=Ot(e,"xl/vbaProject.bin",!0))),p}function cW(e,t){var r=t||{},n="Workbook",i=Xe.find(e,n);try{if(n="/!DataSpaces/Version",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(t7(i.content),n="/!DataSpaces/DataSpaceMap",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=n7(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=i7(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);a7(i.content)}catch{}if(n="/EncryptionInfo",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=o7(i.content);if(n="/EncryptedPackage",i=Xe.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function O_(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=_n(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function uW(e,t){return Xe.find(e,"EncryptedPackage")?cW(e,t):PR(e,t)}function fW(e,t){var r,n=e,i=t||{};return i.type||(i.type=Ke&&Buffer.isBuffer(e)?"buffer":"base64"),r=TC(n,i),lW(r,i)}function OR(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Dg(e.slice(r),t);default:break e}return au.to_workbook(e,t)}function hW(e,t){var r="",n=O_(e,t);switch(t.type){case"base64":r=_n(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Fa(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ot(r)),t.type="binary",OR(r,t)}function dW(e,t){var r=e;return t.type=="base64"&&(r=_n(r)),r=os.utils.decode(1200,r.slice(2),"str"),t.type="binary",OR(r,t)}function pW(e){return e.match(/[^\x00-\x7F]/)?Wl(e):e}function Gp(e,t,r,n){return n?(r.type="string",au.to_workbook(e,r)):au.to_workbook(t,r)}function bg(e,t){iC();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return bg(new Uint8Array(e),(r=hr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Fo={},r.dateNF&&(Fo.dateNF=r.dateNF),r.type||(r.type=Ke&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ke?"buffer":"binary",n=rV(e),typeof Uint8Array<"u"&&!Ke&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=pW(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=hr(r),r.type="array",bg(h_(n),r)}switch((i=O_(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return uW(Xe.read(n,r),r);break;case 9:if(i[1]<=8)return PR(n,r);break;case 60:return Dg(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return jU(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return UU.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?fW(n,r):Gp(e,n,r,s);case 239:return i[3]===60?Dg(n,r):Gp(e,n,r,s);case 255:if(i[1]===254)return dW(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return pc.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return pc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Ew.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return x7.to_workbook(n,r);break;case 10:case 13:case 32:return hW(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return VU.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Ew.to_workbook(n,r):Gp(e,n,r,s)}function mW(e,t,r,n,i,s,a,o){var l=dr(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!a||e[r])for(var d=t.s.c;d<=t.e.c;++d){var p=a?e[r][d]:e[n[d]+l];if(p===void 0||p.t===void 0){if(c===void 0)continue;s[d]!=null&&(h[s[d]]=c);continue}var m=p.v;switch(p.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(s[d]!=null){if(m==null)if(p.t=="e"&&m===null)h[s[d]]=null;else if(c!==void 0)h[s[d]]=c;else if(u&&m===null)h[s[d]]=null;else continue;else h[s[d]]=u&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?m:Hi(p,m,o);m!=null&&(f=!1)}}return{row:h,isempty:f}}function Vg(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Ct(u);break;case"number":l=Ct(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var f=dr(l.s.r),h=[],d=[],p=0,m=0,v=Array.isArray(e),x=l.s.r,_=0,g={};v&&!e[x]&&(e[x]=[]);var w=c.skipHidden&&e["!cols"]||[],T=c.skipHidden&&e["!rows"]||[];for(_=l.s.c;_<=l.e.c;++_)if(!(w[_]||{}).hidden)switch(h[_]=Gt(_),r=v?e[x][_]:e[h[_]+f],n){case 1:s[_]=_-l.s.c;break;case 2:s[_]=h[_];break;case 3:s[_]=c.header[_-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Hi(r,null,c),m=g[a]||0,!m)g[a]=1;else{do o=a+"_"+m++;while(g[o]);g[a]=m,g[o]=1}s[_]=o}for(x=l.s.r+i;x<=l.e.r;++x)if(!(T[x]||{}).hidden){var k=mW(e,l,x,h,n,s,v,c);(k.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(d[p++]=k.row)}return d.length=p,d}var Vw=/"/g;function gW(e,t,r,n,i,s,a,o){for(var l=!0,c=[],u="",f=dr(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var d=o.dense?(e[r]||[])[h]:e[n[h]+f];if(d==null)u="";else if(d.v!=null){l=!1,u=""+(o.rawNumbers&&d.t=="n"?d.v:Hi(d,null,o));for(var p=0,m=0;p!==u.length;++p)if((m=u.charCodeAt(p))===i||m===s||m===34||o.forceQuotes){u='"'+u.replace(Vw,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(l=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(Vw,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function LR(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=Ct(e["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(h[p]||{}).hidden||(f[p]=Gt(p));for(var m=0,v=i.s.r;v<=i.e.r;++v)(d[v]||{}).hidden||(u=gW(e,i,v,f,a,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((m++?o:"")+u)));return delete n.dense,r.join("")}function vW(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=LR(e,t);return r}function _W(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=Ct(e["!ref"]),s="",a=[],o,l=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=Gt(o);for(var u=i.s.r;u<=i.e.r;++u)for(s=dr(u),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function MR(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?jr(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var f=Ct(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(a=f.e.r+1,u.e.r=a+t.length-1+i)}else a==-1&&(a=0,u.e.r=t.length-1+i);var h=n.header||[],d=0;t.forEach(function(m,v){_i(m).forEach(function(x){(d=h.indexOf(x))==-1&&(h[d=h.length]=x);var _=m[x],g="z",w="",T=Le({c:o+d,r:a+v+i});c=uu(s,T),_&&typeof _=="object"&&!(_ instanceof Date)?s[T]=_:(typeof _=="number"?g="n":typeof _=="boolean"?g="b":typeof _=="string"?g="s":_ instanceof Date?(g="d",n.cellDates||(g="n",_=Wr(_)),w=n.dateNF||be[14]):_===null&&n.nullError&&(g="e",_=0),c?(c.t=g,c.v=_,delete c.w,delete c.R,w&&(c.z=w)):s[T]=c={t:g,v:_},w&&(c.z=w))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var p=dr(a);if(i)for(d=0;d<h.length;++d)s[Gt(d+o)+p]={t:"s",v:h[d]};return s["!ref"]=Ye(u),s}function xW(e,t){return MR(null,e,t)}function uu(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=jr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?uu(e,Le(t)):uu(e,Le({r:t,c:r||0}))}function yW(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function L_(){return{SheetNames:[],Sheets:{}}}function M_(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(iH(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function EW(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=yW(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function wW(e,t){return e.z=t,e}function bR(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function TW(e,t,r){return bR(e,"#"+t,r)}function kW(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function AW(e,t,r,n){for(var i=typeof t!="string"?t:Ct(t),s=typeof t=="string"?t:Ye(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=uu(e,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var SW={encode_col:Gt,encode_row:dr,encode_cell:Le,encode_range:Ye,decode_col:E_,decode_row:y_,split_cell:bV,decode_cell:jr,decode_range:dl,format_cell:Hi,sheet_add_aoa:$C,sheet_add_json:MR,sheet_add_dom:FR,aoa_to_sheet:pl,json_to_sheet:xW,table_to_sheet:NR,table_to_book:jH,sheet_to_csv:LR,sheet_to_txt:vW,sheet_to_json:Vg,sheet_to_html:$H,sheet_to_formulae:_W,sheet_to_row_object_array:Vg,sheet_get_cell:uu,book_new:L_,book_append_sheet:M_,book_set_sheet_visibility:EW,cell_set_number_format:wW,cell_set_hyperlink:bR,cell_set_internal_link:TW,cell_add_comment:kW,sheet_set_array_formula:AW,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function VR(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=VR(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function vs(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=VR(e))&&(n&&(n+=" "),n+=t);return n}const _c=e=>typeof e=="number"&&!isNaN(e),Da=e=>typeof e=="string",en=e=>typeof e=="function",sh=e=>Da(e)||en(e)?e:null,Kp=e=>ee.isValidElement(e)||Da(e)||en(e)||_c(e);function IW(e,t,r){r===void 0&&(r=300);const{scrollHeight:n,style:i}=e;requestAnimationFrame(()=>{i.minHeight="initial",i.height=n+"px",i.transition=`all ${r}ms`,requestAnimationFrame(()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(t,r)})})}function Sd(e){let{enter:t,exit:r,appendPosition:n=!1,collapse:i=!0,collapseDuration:s=300}=e;return function(a){let{children:o,position:l,preventExitTransition:c,done:u,nodeRef:f,isIn:h}=a;const d=n?`${t}--${l}`:t,p=n?`${r}--${l}`:r,m=ee.useRef(0);return ee.useLayoutEffect(()=>{const v=f.current,x=d.split(" "),_=g=>{g.target===f.current&&(v.dispatchEvent(new Event("d")),v.removeEventListener("animationend",_),v.removeEventListener("animationcancel",_),m.current===0&&g.type!=="animationcancel"&&v.classList.remove(...x))};v.classList.add(...x),v.addEventListener("animationend",_),v.addEventListener("animationcancel",_)},[]),ee.useEffect(()=>{const v=f.current,x=()=>{v.removeEventListener("animationend",x),i?IW(v,u,s):u()};h||(c?x():(m.current=1,v.className+=` ${p}`,v.addEventListener("animationend",x)))},[h]),Se.createElement(Se.Fragment,null,o)}}function Bw(e,t){return e!=null?{content:e.content,containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,status:t}:{}}const kn={list:new Map,emitQueue:new Map,on(e,t){return this.list.has(e)||this.list.set(e,[]),this.list.get(e).push(t),this},off(e,t){if(t){const r=this.list.get(e).filter(n=>n!==t);return this.list.set(e,r),this}return this.list.delete(e),this},cancelEmit(e){const t=this.emitQueue.get(e);return t&&(t.forEach(clearTimeout),this.emitQueue.delete(e)),this},emit(e){this.list.has(e)&&this.list.get(e).forEach(t=>{const r=setTimeout(()=>{t(...[].slice.call(arguments,1))},0);this.emitQueue.has(e)||this.emitQueue.set(e,[]),this.emitQueue.get(e).push(r)})}},Lf=e=>{let{theme:t,type:r,...n}=e;return Se.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:t==="colored"?"currentColor":`var(--toastify-icon-color-${r})`,...n})},qp={info:function(e){return Se.createElement(Lf,{...e},Se.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return Se.createElement(Lf,{...e},Se.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return Se.createElement(Lf,{...e},Se.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return Se.createElement(Lf,{...e},Se.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return Se.createElement("div",{className:"Toastify__spinner"})}};function CW(e){const[,t]=ee.useReducer(d=>d+1,0),[r,n]=ee.useState([]),i=ee.useRef(null),s=ee.useRef(new Map).current,a=d=>r.indexOf(d)!==-1,o=ee.useRef({toastKey:1,displayedToast:0,count:0,queue:[],props:e,containerId:null,isToastActive:a,getToast:d=>s.get(d)}).current;function l(d){let{containerId:p}=d;const{limit:m}=o.props;!m||p&&o.containerId!==p||(o.count-=o.queue.length,o.queue=[])}function c(d){n(p=>d==null?[]:p.filter(m=>m!==d))}function u(){const{toastContent:d,toastProps:p,staleId:m}=o.queue.shift();h(d,p,m)}function f(d,p){let{delay:m,staleId:v,...x}=p;if(!Kp(d)||function(M){return!i.current||o.props.enableMultiContainer&&M.containerId!==o.props.containerId||s.has(M.toastId)&&M.updateId==null}(x))return;const{toastId:_,updateId:g,data:w}=x,{props:T}=o,k=()=>c(_),y=g==null;y&&o.count++;const P={...T,style:T.toastStyle,key:o.toastKey++,...Object.fromEntries(Object.entries(x).filter(M=>{let[X,ne]=M;return ne!=null})),toastId:_,updateId:g,data:w,closeToast:k,isIn:!1,className:sh(x.className||T.toastClassName),bodyClassName:sh(x.bodyClassName||T.bodyClassName),progressClassName:sh(x.progressClassName||T.progressClassName),autoClose:!x.isLoading&&(O=x.autoClose,U=T.autoClose,O===!1||_c(O)&&O>0?O:U),deleteToast(){const M=Bw(s.get(_),"removed");s.delete(_),kn.emit(4,M);const X=o.queue.length;if(o.count=_==null?o.count-o.displayedToast:o.count-1,o.count<0&&(o.count=0),X>0){const ne=_==null?o.props.limit:1;if(X===1||ne===1)o.displayedToast++,u();else{const re=ne>X?X:ne;o.displayedToast=re;for(let se=0;se<re;se++)u()}}else t()}};var O,U;P.iconOut=function(M){let{theme:X,type:ne,isLoading:re,icon:se}=M,ue=null;const te={theme:X,type:ne};return se===!1||(en(se)?ue=se(te):ee.isValidElement(se)?ue=ee.cloneElement(se,te):Da(se)||_c(se)?ue=se:re?ue=qp.spinner():(b=>b in qp)(ne)&&(ue=qp[ne](te))),ue}(P),en(x.onOpen)&&(P.onOpen=x.onOpen),en(x.onClose)&&(P.onClose=x.onClose),P.closeButton=T.closeButton,x.closeButton===!1||Kp(x.closeButton)?P.closeButton=x.closeButton:x.closeButton===!0&&(P.closeButton=!Kp(T.closeButton)||T.closeButton);let j=d;ee.isValidElement(d)&&!Da(d.type)?j=ee.cloneElement(d,{closeToast:k,toastProps:P,data:w}):en(d)&&(j=d({closeToast:k,toastProps:P,data:w})),T.limit&&T.limit>0&&o.count>T.limit&&y?o.queue.push({toastContent:j,toastProps:P,staleId:v}):_c(m)?setTimeout(()=>{h(j,P,v)},m):h(j,P,v)}function h(d,p,m){const{toastId:v}=p;m&&s.delete(m);const x={content:d,props:p};s.set(v,x),n(_=>[..._,v].filter(g=>g!==m)),kn.emit(4,Bw(x,x.props.updateId==null?"added":"updated"))}return ee.useEffect(()=>(o.containerId=e.containerId,kn.cancelEmit(3).on(0,f).on(1,d=>i.current&&c(d)).on(5,l).emit(2,o),()=>{s.clear(),kn.emit(3,o)}),[]),ee.useEffect(()=>{o.props=e,o.isToastActive=a,o.displayedToast=r.length}),{getToastToRender:function(d){const p=new Map,m=Array.from(s.values());return e.newestOnTop&&m.reverse(),m.forEach(v=>{const{position:x}=v.props;p.has(x)||p.set(x,[]),p.get(x).push(v)}),Array.from(p,v=>d(v[0],v[1]))},containerRef:i,isToastActive:a}}function Uw(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientX:e.clientX}function $w(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientY:e.clientY}function RW(e){const[t,r]=ee.useState(!1),[n,i]=ee.useState(!1),s=ee.useRef(null),a=ee.useRef({start:0,x:0,y:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,boundingRect:null,didMove:!1}).current,o=ee.useRef(e),{autoClose:l,pauseOnHover:c,closeToast:u,onClick:f,closeOnClick:h}=e;function d(w){if(e.draggable){w.nativeEvent.type==="touchstart"&&w.nativeEvent.preventDefault(),a.didMove=!1,document.addEventListener("mousemove",x),document.addEventListener("mouseup",_),document.addEventListener("touchmove",x),document.addEventListener("touchend",_);const T=s.current;a.canCloseOnClick=!0,a.canDrag=!0,a.boundingRect=T.getBoundingClientRect(),T.style.transition="",a.x=Uw(w.nativeEvent),a.y=$w(w.nativeEvent),e.draggableDirection==="x"?(a.start=a.x,a.removalDistance=T.offsetWidth*(e.draggablePercent/100)):(a.start=a.y,a.removalDistance=T.offsetHeight*(e.draggablePercent===80?1.5*e.draggablePercent:e.draggablePercent/100))}}function p(w){if(a.boundingRect){const{top:T,bottom:k,left:y,right:P}=a.boundingRect;w.nativeEvent.type!=="touchend"&&e.pauseOnHover&&a.x>=y&&a.x<=P&&a.y>=T&&a.y<=k?v():m()}}function m(){r(!0)}function v(){r(!1)}function x(w){const T=s.current;a.canDrag&&T&&(a.didMove=!0,t&&v(),a.x=Uw(w),a.y=$w(w),a.delta=e.draggableDirection==="x"?a.x-a.start:a.y-a.start,a.start!==a.x&&(a.canCloseOnClick=!1),T.style.transform=`translate${e.draggableDirection}(${a.delta}px)`,T.style.opacity=""+(1-Math.abs(a.delta/a.removalDistance)))}function _(){document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",_),document.removeEventListener("touchmove",x),document.removeEventListener("touchend",_);const w=s.current;if(a.canDrag&&a.didMove&&w){if(a.canDrag=!1,Math.abs(a.delta)>a.removalDistance)return i(!0),void e.closeToast();w.style.transition="transform 0.2s, opacity 0.2s",w.style.transform=`translate${e.draggableDirection}(0)`,w.style.opacity="1"}}ee.useEffect(()=>{o.current=e}),ee.useEffect(()=>(s.current&&s.current.addEventListener("d",m,{once:!0}),en(e.onOpen)&&e.onOpen(ee.isValidElement(e.children)&&e.children.props),()=>{const w=o.current;en(w.onClose)&&w.onClose(ee.isValidElement(w.children)&&w.children.props)}),[]),ee.useEffect(()=>(e.pauseOnFocusLoss&&(document.hasFocus()||v(),window.addEventListener("focus",m),window.addEventListener("blur",v)),()=>{e.pauseOnFocusLoss&&(window.removeEventListener("focus",m),window.removeEventListener("blur",v))}),[e.pauseOnFocusLoss]);const g={onMouseDown:d,onTouchStart:d,onMouseUp:p,onTouchEnd:p};return l&&c&&(g.onMouseEnter=v,g.onMouseLeave=m),h&&(g.onClick=w=>{f&&f(w),a.canCloseOnClick&&u()}),{playToast:m,pauseToast:v,isRunning:t,preventExitTransition:n,toastRef:s,eventHandlers:g}}function BR(e){let{closeToast:t,theme:r,ariaLabel:n="close"}=e;return Se.createElement("button",{className:`Toastify__close-button Toastify__close-button--${r}`,type:"button",onClick:i=>{i.stopPropagation(),t(i)},"aria-label":n},Se.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Se.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function PW(e){let{delay:t,isRunning:r,closeToast:n,type:i="default",hide:s,className:a,style:o,controlledProgress:l,progress:c,rtl:u,isIn:f,theme:h}=e;const d=s||l&&c===0,p={...o,animationDuration:`${t}ms`,animationPlayState:r?"running":"paused",opacity:d?0:1};l&&(p.transform=`scaleX(${c})`);const m=vs("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${h}`,`Toastify__progress-bar--${i}`,{"Toastify__progress-bar--rtl":u}),v=en(a)?a({rtl:u,type:i,defaultClassName:m}):vs(m,a);return Se.createElement("div",{role:"progressbar","aria-hidden":d?"true":"false","aria-label":"notification timer",className:v,style:p,[l&&c>=1?"onTransitionEnd":"onAnimationEnd"]:l&&c<1?null:()=>{f&&n()}})}const FW=e=>{const{isRunning:t,preventExitTransition:r,toastRef:n,eventHandlers:i}=RW(e),{closeButton:s,children:a,autoClose:o,onClick:l,type:c,hideProgressBar:u,closeToast:f,transition:h,position:d,className:p,style:m,bodyClassName:v,bodyStyle:x,progressClassName:_,progressStyle:g,updateId:w,role:T,progress:k,rtl:y,toastId:P,deleteToast:O,isIn:U,isLoading:j,iconOut:M,closeOnClick:X,theme:ne}=e,re=vs("Toastify__toast",`Toastify__toast-theme--${ne}`,`Toastify__toast--${c}`,{"Toastify__toast--rtl":y},{"Toastify__toast--close-on-click":X}),se=en(p)?p({rtl:y,position:d,type:c,defaultClassName:re}):vs(re,p),ue=!!k||!o,te={closeToast:f,type:c,theme:ne};let b=null;return s===!1||(b=en(s)?s(te):ee.isValidElement(s)?ee.cloneElement(s,te):BR(te)),Se.createElement(h,{isIn:U,done:O,position:d,preventExitTransition:r,nodeRef:n},Se.createElement("div",{id:P,onClick:l,className:se,...i,style:m,ref:n},Se.createElement("div",{...U&&{role:T},className:en(v)?v({type:c}):vs("Toastify__toast-body",v),style:x},M!=null&&Se.createElement("div",{className:vs("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!j})},M),Se.createElement("div",null,a)),b,Se.createElement(PW,{...w&&!ue?{key:`pb-${w}`}:{},rtl:y,theme:ne,delay:o,isRunning:t,isIn:U,closeToast:f,hide:u,type:c,style:g,className:_,controlledProgress:ue,progress:k||0})))},Id=function(e,t){return t===void 0&&(t=!1),{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}},NW=Sd(Id("bounce",!0));Sd(Id("slide",!0));Sd(Id("zoom"));Sd(Id("flip"));const fu=ee.forwardRef((e,t)=>{const{getToastToRender:r,containerRef:n,isToastActive:i}=CW(e),{className:s,style:a,rtl:o,containerId:l}=e;function c(u){const f=vs("Toastify__toast-container",`Toastify__toast-container--${u}`,{"Toastify__toast-container--rtl":o});return en(s)?s({position:u,rtl:o,defaultClassName:f}):vs(f,sh(s))}return ee.useEffect(()=>{t&&(t.current=n.current)},[]),Se.createElement("div",{ref:n,className:"Toastify",id:l},r((u,f)=>{const h=f.length?{...a}:{...a,pointerEvents:"none"};return Se.createElement("div",{className:c(u),style:h,key:`container-${u}`},f.map((d,p)=>{let{content:m,props:v}=d;return Se.createElement(FW,{...v,isIn:i(v.toastId),style:{...v.style,"--nth":p+1,"--len":f.length},key:`toast-${v.key}`},m)}))}))});fu.displayName="ToastContainer",fu.defaultProps={position:"top-right",transition:NW,autoClose:5e3,closeButton:BR,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,draggable:!0,draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};let Xp,ta=new Map,Gl=[],DW=1;function UR(){return""+DW++}function OW(e){return e&&(Da(e.toastId)||_c(e.toastId))?e.toastId:UR()}function xc(e,t){return ta.size>0?kn.emit(0,e,t):Gl.push({content:e,options:t}),t.toastId}function x0(e,t){return{...t,type:t&&t.type||e,toastId:OW(t)}}function Mf(e){return(t,r)=>xc(t,x0(e,r))}function We(e,t){return xc(e,x0("default",t))}We.loading=(e,t)=>xc(e,x0("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t})),We.promise=function(e,t,r){let n,{pending:i,error:s,success:a}=t;i&&(n=Da(i)?We.loading(i,r):We.loading(i.render,{...r,...i}));const o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(u,f,h)=>{if(f==null)return void We.dismiss(n);const d={type:u,...o,...r,data:h},p=Da(f)?{render:f}:f;return n?We.update(n,{...d,...p}):We(p.render,{...d,...p}),h},c=en(e)?e():e;return c.then(u=>l("success",a,u)).catch(u=>l("error",s,u)),c},We.success=Mf("success"),We.info=Mf("info"),We.error=Mf("error"),We.warning=Mf("warning"),We.warn=We.warning,We.dark=(e,t)=>xc(e,x0("default",{theme:"dark",...t})),We.dismiss=e=>{ta.size>0?kn.emit(1,e):Gl=Gl.filter(t=>e!=null&&t.options.toastId!==e)},We.clearWaitingQueue=function(e){return e===void 0&&(e={}),kn.emit(5,e)},We.isActive=e=>{let t=!1;return ta.forEach(r=>{r.isToastActive&&r.isToastActive(e)&&(t=!0)}),t},We.update=function(e,t){t===void 0&&(t={}),setTimeout(()=>{const r=function(n,i){let{containerId:s}=i;const a=ta.get(s||Xp);return a&&a.getToast(n)}(e,t);if(r){const{props:n,content:i}=r,s={delay:100,...n,...t,toastId:t.toastId||e,updateId:UR()};s.toastId!==e&&(s.staleId=e);const a=s.render||i;delete s.render,xc(a,s)}},0)},We.done=e=>{We.update(e,{progress:1})},We.onChange=e=>(kn.on(4,e),()=>{kn.off(4,e)}),We.POSITION={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",TOP_CENTER:"top-center",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",BOTTOM_CENTER:"bottom-center"},We.TYPE={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error",DEFAULT:"default"},kn.on(2,e=>{Xp=e.containerId||e,ta.set(Xp,e),Gl.forEach(t=>{kn.emit(0,t.content,t.options)}),Gl=[]}).on(3,e=>{ta.delete(e.containerId||e),ta.size===0&&kn.off(0).off(1).off(5)});const LW=e=>/^\d{4}-W\d{2}$/.test(e);function Yp(e){let t=e.toLowerCase();return t=t.replace(/[áäâà]/g,"a").replace(/[éëêè]/g,"e").replace(/[íïîì]/g,"i").replace(/[óöôò]/g,"o").replace(/[úüûù]/g,"u").replace(/[^\w\s]/g,"").replace(/\s+/g,"_"),t}function MW(){const[e,t]=ee.useState([]),[r,n]=ee.useState(null),i=Qn(),{control:s,handleSubmit:a,reset:o}=yd({defaultValues:{week:"",team:""}}),l=u=>{const f=new FileReader;f.readAsBinaryString(u.target.files[0]),f.onload=h=>{const d=h.target.result,p=bg(d,{type:"binary"}),m=[];["Impacto","Impacto ácido"].forEach(x=>{if(p.SheetNames.includes(x)){const _=p.Sheets[x],g=SW.sheet_to_json(_),w=g.length>0?Object.keys(g[0]):[],T=g.map(k=>{const y={};return w.forEach(P=>{y[Yp(P)]=k[P]}),y});m.push({sheetName:x,data:T})}}),t(m)}},c=async u=>{try{const f=localStorage.getItem("userEmail"),h="RECIBIDO-MSMIN",{week:d,team:p}=u;if(!p||!LW(d)){We.error("Ha ocurrido un error: Debe completar campos de equipo, semana y seleccionar un archivo.");return}const m=e.filter(T=>Yp(T.sheetName)===p),v=[],x=m[0].data,_=Object.values(x[0]).map(T=>Yp(T));x.slice(1).forEach(T=>{const k={};_.forEach((y,P)=>{k[y]=Object.values(T)[P]||null}),k.file_name=`${d}.xlsx`,k.week_name=d,k.uploaded_by=f,k.created_at=new Date,k.team=p,k.impacto_status=h,v.push(k)}),t(v);const w=v.map(T=>G5(T));await Promise.all(w),K5(r,d),We.success("Priorización importada correctamente"),o({week:"",team:""}),setTimeout(()=>{i("/home")},2e3)}catch(f){console.error("Error:",f),We.error(`Ha ocurrido un error: ${f.message}`)}};return N.jsx("form",{onSubmit:a(c),className:"container mt-5",children:N.jsx("div",{className:"d-flex justify-content-center",children:N.jsx("div",{className:"col-md-7",children:N.jsx("div",{className:"card",children:N.jsxs("div",{className:"card-body",children:[N.jsx("h2",{className:"text-center mb-4",children:"CARGAR PRIORIZACIÓN"}),N.jsxs("div",{className:"form-group",children:[N.jsx("label",{htmlFor:"week",children:"Semana:"}),N.jsx(gi,{name:"week",control:s,render:({field:u})=>N.jsx("input",{...u,type:"text",id:"week",placeholder:"Ejemplo: 2023-W37",className:"form-control mb-3",required:!0})})]}),N.jsxs("div",{className:"form-group",children:[N.jsx("label",{htmlFor:"team",children:"Equipo:"}),N.jsx(gi,{name:"team",control:s,render:({field:u})=>N.jsxs("select",{...u,className:"form-control mb-3",id:"team",children:[N.jsx("option",{value:"",defaultValue:!0,children:"Seleccione un equipo"}),N.jsx("option",{value:"impacto",children:"Impacto"}),N.jsx("option",{value:"impacto_acido",children:"Impacto Acido"})]})})]}),N.jsxs("div",{className:"form-group",children:[N.jsx("label",{htmlFor:"file",children:"Archivo:"}),N.jsx(gi,{name:"file",control:s,render:({field:u})=>N.jsx("input",{...u,type:"file",id:"file",className:"form-control mb-3",onChange:f=>{n(f.target.files[0]),l(f)}})})]}),N.jsx("div",{className:"form-group d-flex text-center justify-content-center",children:N.jsx("button",{type:"submit",className:"btn btn-dark btn-block text-center mt-3",children:"CARGAR PRIORIZACIÓN"})}),N.jsx(fu,{class:"custom-toast",position:"top-right",autoClose:3e3,hideProgressBar:!0})]})})})})})}function bW(){const e=Qn(),t=()=>{e("/home")};return N.jsxs(N.Fragment,{children:[N.jsx(Ed,{}),N.jsxs("section",{id:"upload-priorization",children:[N.jsx(MW,{}),N.jsx("div",{className:"d-flex justify-content-center mt-5",children:N.jsx(ju,{text:"VOLVER A PRIORIZACIÓN",icon:"bi bi-arrow-return-left",marginClassName:"mb-5",btnClassName:"btn-link",onClick:t})})]})]})}function $R({documentId:e}){const{control:t,handleSubmit:r,reset:n}=yd({defaultValues:{impacto_status:"",impacto_status_description:""}}),i=Qn(),s=async a=>{try{const o=localStorage.getItem("userEmail"),{impacto_status:l,impacto_status_description:c}=a;if(!l||!c){We.error("Ha ocurrido un error: Debe completar el estado y la descripción.");return}X5(e,{status_updated_by:o,status_updated_date:new Date,impacto_status:l,impacto_status_description:c}),We.success("Estado actualizado exitosamente"),n({impacto_status:"",impacto_status_description:""}),setTimeout(()=>{i("/home")},2e3)}catch(o){console.error("Error:",o),We.error(`Ha ocurrido un error: ${o.message}`)}};return N.jsx("form",{onSubmit:r(s),className:"container mt-5",children:N.jsx("div",{className:"row justify-content-center",children:N.jsx("div",{className:"col-xl",children:N.jsx("div",{className:"card",children:N.jsxs("div",{className:"card-body",children:[N.jsx("h2",{className:"text-center mb-4",children:" ACTUALIZAR ESTADO IMPACTO"}),N.jsxs("div",{className:"form-group",children:[N.jsx("label",{htmlFor:"impacto_status",children:"Ingresar Estado:"}),N.jsx(gi,{name:"impacto_status",control:t,render:({field:a})=>N.jsxs("select",{...a,className:"form-control mb-3",id:"impacto_status",children:[N.jsx("option",{value:"",defaultValue:!0,children:"Seleccione un Estado"}),N.jsx("option",{value:"ACEPTADO",children:"Aceptado"}),N.jsx("option",{value:"RECHAZADO",children:"Rechazado"}),N.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),N.jsx("option",{value:"PROGRAMADO",children:"Programado"}),N.jsx("option",{value:"EJECUTADO",children:"Ejecutado"}),N.jsx("option",{value:"REPETIDO",children:"Repetido"}),N.jsx("option",{value:"OTRO",children:"Otro"})]})})]}),N.jsxs("div",{className:"form-group",children:[N.jsx("label",{htmlFor:"impacto_status_description",children:"Descripción u observación:"}),N.jsx(gi,{name:"impacto_status_description",control:t,render:({field:a})=>N.jsx("textarea",{...a,id:"impacto_status_description",className:"form-control mb-3",placeholder:"Escribe una descripción"})})]}),N.jsx("div",{className:"form-group d-flex text-center justify-content-center",children:N.jsx("button",{type:"submit",className:"btn btn-dark btn-block text-center mt-2 mb-3",children:"ACTUALIZAR ESTADO IMPACTO"})}),N.jsx(fu,{className:"custom-toast",position:"top-right",autoClose:3e3,hideProgressBar:!0})]})})})})})}$R.propTypes={documentId:cn.string.isRequired};function jR({documentId:e}){var s,a;const[t,r]=ee.useState({defaultValues:{impacto_status:"",impacto_status_description:"Sin descripción"}}),[n,i]=ee.useState(!0);return ee.useEffect(()=>{(async()=>{const c=(await J5()).find(u=>u.id===e);r(c),i(!1)})()},[e]),n?N.jsx(c_,{}):N.jsx("div",{className:"row justify-content-center",children:N.jsx("div",{className:"col-xl",children:N.jsx("div",{className:"card",children:N.jsxs("div",{className:"card-body",children:[N.jsx("h2",{className:"text-center mb-4",children:"ESTADO IMPACTO"}),N.jsxs("dl",{className:"dl-horizontal",children:[N.jsx("dt",{children:"Estado:"}),N.jsx("dd",{children:(s=t.data)==null?void 0:s.impacto_status})]}),N.jsx("dt",{children:"Descripción:"}),N.jsx("dd",{children:(a=t.data)==null?void 0:a.impacto_status_description})]})})})})}jR.propTypes={documentId:cn.string.isRequired};function VW(){const e=Qn(),{documentId:t}=lk(),r=()=>{e("/home")};return N.jsxs(N.Fragment,{children:[N.jsx(Ed,{}),N.jsxs("section",{id:"update-status",children:[N.jsx("div",{className:"container",children:N.jsxs("div",{className:"row",children:[N.jsx("div",{className:"col-md-6 mt-5",children:N.jsx(jR,{documentId:t})}),N.jsx("div",{className:"col-md-6",children:N.jsx($R,{documentId:t})})]})}),N.jsx("div",{className:"d-flex justify-content-center mt-5",children:N.jsx(ju,{text:"VOLVER A PRIORIZACIÓN",icon:"bi bi-arrow-return-left",marginClassName:"mb-5",btnClassName:"btn-link",onClick:r})})]})]})}const BW=()=>new Promise((e,t)=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(r=>{const{latitude:n,longitude:i}=r.coords;e(`${n}, ${i}`)},r=>{t(r)}):t(new Error("Geolocation is not available in this browser."))});function zR({documentId:e}){const[t,r]=ee.useState(""),[n,i]=ee.useState(""),[s,a]=ee.useState(!1),[o,l]=ee.useState(!1),c=Qn(),{control:u,handleSubmit:f,reset:h,setValue:d}=yd({defaultValues:{record_description:""}}),{fields:p,append:m,remove:v}=c9({control:u,name:"record_files"});ee.useEffect(()=>{x()||We.error("Speech recognition is not supported in this browser.")},[]);const x=()=>"SpeechRecognition"in window||"webkitSpeechRecognition"in window||"mozSpeechRecognition"in window||"msSpeechRecognition"in window,_=async()=>{try{const y=await BW();r(y)}catch(y){console.error("Error getting GPS coordinates:",y),We.error(`Error getting GPS coordinates: ${y.message}`)}},g=()=>{if(s)w();else try{const y=window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition,P=new y;P.continuous=!0,P.onresult=O=>{const U=O.results[0][0].transcript;i(U),w(),console.log(n)},P.start(),a(!0)}catch(y){console.error("Error starting speech recognition:",y),We.error(`Error starting speech recognition: ${y.message}`)}},w=()=>{a(!1)},T=s?N.jsxs(N.Fragment,{children:[N.jsx("i",{className:"bi bi-mic-mute align-middle"})," DETENER GRABACIÓN POR VOZ"]}):N.jsxs(N.Fragment,{children:[N.jsx("i",{className:"bi bi-mic align-middle"})," INICIAR GRABACIÓN POR VOZ"]}),k=async y=>{try{const P=localStorage.getItem("userEmail");if(!t||!n){We.error("Ha ocurrido un error: Debe completar las coordenadas GPS y la descripción del registro.");return}const O={record_written_by:P,record_creation_date:new Date,record_GPS:t,record_description:n,record_file_names:[]};if(l(!0),y.record_files&&y.record_files.length>0)for(let U=0;U<y.record_files.length;U++){const j=y.record_files[U];await Y5([j]),O.record_file_names.push(j.name)}l(!1),Q5(e,O),We.success("Registro ingresado exitosamente"),h({record_GPS:"",record_description:"",record_files:[]}),setTimeout(()=>{c("/home")},2e3)}catch(P){l(!1),console.error("Error:",P),We.error(`Ha ocurrido un error: ${P.message}`)}};return N.jsxs(N.Fragment,{children:[N.jsx("form",{onSubmit:f(k),className:"container mt-5",children:N.jsx("div",{className:"row justify-content-center",children:N.jsx("div",{className:"col-md-7",children:N.jsxs("div",{className:"card",children:[N.jsxs("div",{className:"card-body",children:[N.jsx("h2",{className:"text-center mb-4",children:" INGRESAR REGISTRO"}),N.jsxs("div",{className:"form-group",children:[N.jsx("label",{htmlFor:"record_GPS",children:"GPS:"}),N.jsx(gi,{name:"record_GPS",control:u,render:({field:y})=>N.jsx("textarea",{...y,id:"record_GPS",className:"form-control",placeholder:"Ingrese las coordenadas GPS.",value:t})}),N.jsx("div",{className:"input-group-append",children:N.jsxs("button",{className:"btn btn-dark mt-2 mb-3",type:"button",onClick:_,children:[N.jsx("i",{className:"bi bi-geo-alt align-middle"})," OBTENER GPS"]})})]}),N.jsxs("div",{className:"form-group",children:[N.jsx("label",{htmlFor:"record_description",children:"Descripción del registro:"}),N.jsx(gi,{name:"record_description",control:u,defaultValue:"",render:({field:y})=>N.jsx("textarea",{...y,id:"record_description",className:"form-control",placeholder:"Ingrese descripción del registro.",value:n,onChange:P=>{i(P.target.value),y.onChange(P)}})})]}),N.jsx("div",{className:"form-group",children:N.jsx("button",{type:"button",className:"btn btn-dark mt-2 mb-3",onClick:g,children:T})}),N.jsxs("div",{className:"form-group mt-2 mb-3 d-flex flex-column ",children:[N.jsxs("label",{children:["Imagen/es ",N.jsx("span",{className:"text-muted",children:"(opcional)"}),":"]}),p.map((y,P)=>N.jsxs("div",{className:"d-flex mb-2",children:[N.jsx(gi,{name:`record_files_${P}`,control:u,render:({field:O})=>N.jsx("input",{...O,type:"file",className:"form-control",onChange:U=>{d(`record_files[${P}]`,U.target.files[0])}})}),N.jsx("button",{type:"button",className:"btn btn-danger ms-2",onClick:()=>v(P),children:N.jsx("i",{className:"bi bi-x-circle align-middle"})})]},y.id)),N.jsx("div",{children:N.jsxs("button",{type:"button",className:"btn btn-success",onClick:()=>m({}),children:[N.jsx("i",{className:"bi bi-plus-circle align-middle"})," AGREGAR"]})})]})]}),N.jsx("div",{className:"form-group d-flex text-center justify-content-center",children:N.jsx("button",{type:"submit",className:"btn btn-dark btn-block mb-4",disabled:o,children:o?N.jsx(N.Fragment,{children:N.jsx(c_,{})}):"INGRESAR REGISTRO"})})]})})})}),N.jsx(fu,{className:"custom-toast",position:"top-right",autoClose:3e3,hideProgressBar:!0})]})}zR.propTypes={documentId:cn.string.isRequired};function UW(){const e=Qn(),{documentId:t}=lk(),r=()=>{e("/home")};return N.jsxs(N.Fragment,{children:[N.jsx(Ed,{}),N.jsxs("section",{id:"enter-record",children:[N.jsx(zR,{documentId:t}),N.jsx("div",{className:"d-flex justify-content-center mt-5",children:N.jsx(ju,{text:"VOLVER A PRIORIZACIÓN",icon:"bi bi-arrow-return-left",marginClassName:"mb-5",btnClassName:"btn-link",onClick:r})})]})]})}function bf({element:e}){return LI()?e:N.jsx(Hm,{to:"/login",replace:!0})}const $W=rk(document.getElementById("root"));$W.render(N.jsx(Se.StrictMode,{children:N.jsx(AN,{children:N.jsxs(xN,{children:[N.jsx(Zs,{path:"/",element:LI()?N.jsx(Hm,{to:"/home",replace:!0}):N.jsx(Hm,{to:"/login"})}),N.jsx(Zs,{path:"/home",element:N.jsx(bf,{element:N.jsx(A9,{})})}),N.jsx(Zs,{path:"/upload-priorization",element:N.jsx(bf,{element:N.jsx(bW,{})})}),N.jsx(Zs,{path:"/update-status/:documentId",element:N.jsx(bf,{element:N.jsx(VW,{})})}),N.jsx(Zs,{path:"/enter-record/:documentId",element:N.jsx(bf,{element:N.jsx(UW,{})})}),N.jsx(Zs,{path:"/login",element:N.jsx(_9,{})})]})})}));
